{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { EventHandler, getValue, closest, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, extend, Browser } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport * as event from '../base/constant';\nimport { Row } from '../models/row';\nimport { RowModelGenerator } from './row-model-generator';\nimport { parentsUntil, addRemoveEventListener, findCellIndex } from '../base/util';\nimport * as literals from '../base/string-literals';\n/**\n * FocusStrategy class\n *\n * @hidden\n */\n\nvar FocusStrategy =\n/** @class */\nfunction () {\n  function FocusStrategy(parent) {\n    this.currentInfo = {};\n    this.oneTime = true;\n    this.swap = {};\n    /** @hidden */\n\n    this.isInfiniteScroll = false;\n    this.forget = false;\n    this.skipFocus = true;\n    this.focusByClick = false;\n    this.prevIndexes = {};\n    this.refMatrix = this.refreshMatrix(true);\n    this.actions = ['downArrow', 'upArrow'];\n    this.isVirtualScroll = false;\n    this.parent = parent;\n    this.rowModelGen = new RowModelGenerator(this.parent);\n    this.addEventListener();\n  }\n\n  FocusStrategy.prototype.focusCheck = function (e) {\n    var target = e.target;\n    this.focusByClick = true;\n    this.skipFocus = target.classList.contains('e-grid');\n  };\n\n  FocusStrategy.prototype.onFocus = function (e) {\n    if (this.parent.isDestroyed || Browser.isDevice || this.parent.enableVirtualization) {\n      return;\n    }\n\n    this.setActive(!this.parent.enableHeaderFocus && this.parent.frozenRows === 0, this.parent.isFrozenGrid());\n\n    if (!this.parent.enableHeaderFocus && !this.parent.getCurrentViewRecords().length && (this.parent.editSettings.mode !== 'Batch' || this.parent.editSettings.mode === 'Batch' && this.parent.editModule && !this.parent.editModule.getBatchChanges()[literals.addedRecords].length)) {\n      this.getContent().matrix.generate(this.rowModelGen.generateRows({\n        rows: [new Row({\n          isDataRow: true\n        })]\n      }), this.getContent().selector, false);\n    }\n\n    var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator());\n    this.getContent().matrix.select(current[0], current[1]);\n\n    if (this.skipFocus && !(e && e.target === this.parent.element)) {\n      this.focus(e);\n      this.skipFocus = false;\n    }\n  };\n\n  FocusStrategy.prototype.passiveFocus = function (e) {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    if (e.target && e.target.classList.contains('e-detailcell')) {\n      this.currentInfo.skipAction = false;\n      addClass([this.currentInfo.element], ['e-focused', 'e-focus']);\n    }\n  };\n\n  FocusStrategy.prototype.onBlur = function (e) {\n    if ((this.parent.isEdit || e && (!e.relatedTarget || closest(e.relatedTarget, '.e-grid')) && !(this.parent.element.classList.contains('e-childgrid') && !this.parent.element.matches(':focus-within'))) && !(isNullOrUndefined(e.relatedTarget) && parseInt(e.target.getAttribute('aria-colindex'), 10) === 0 && parseInt(e.target.getAttribute('index'), 10) === 0)) {\n      return;\n    }\n\n    this.removeFocus();\n    this.skipFocus = true;\n    this.currentInfo.skipAction = false;\n    this.setLastContentCellTabIndex();\n    this.parent.element.tabIndex = 0;\n  };\n\n  FocusStrategy.prototype.setLastContentCellTabIndex = function () {\n    var contentTable = this.parent.getContentTable();\n    var lastCell = contentTable.rows[contentTable.rows.length - 1].lastElementChild;\n    lastCell.tabIndex = 0;\n  };\n\n  FocusStrategy.prototype.onClick = function (e, force) {\n    if (parentsUntil(e.target, 'e-filterbarcell') && (parentsUntil(e.target, 'e-multiselect') || e.target.classList.contains('e-input-group-icon'))) {\n      return;\n    }\n\n    var isContent = !isNullOrUndefined(closest(e.target, '.' + literals.gridContent));\n    var isHeader = !isNullOrUndefined(closest(e.target, '.' + literals.gridHeader));\n    isContent = isContent && isHeader ? !isContent : isContent;\n    var isFrozen = !isNullOrUndefined(closest(e.target, '.' + literals.frozenContent)) || !isNullOrUndefined(closest(e.target, '.' + literals.frozenHeader));\n    var isFrozenRight = false;\n\n    if (this.parent.getFrozenMode() === literals.leftRight) {\n      isFrozenRight = !isNullOrUndefined(closest(e.target, '.e-frozen-right-content')) || !isNullOrUndefined(closest(e.target, '.e-frozen-right-header'));\n      isFrozen = isFrozen && !isFrozenRight;\n    }\n\n    if (!isContent && isNullOrUndefined(closest(e.target, '.' + literals.gridHeader)) || e.target.classList.contains(literals.content) || !isNullOrUndefined(closest(e.target, '.e-unboundcell'))) {\n      return;\n    }\n\n    this.setActive(isContent, isFrozen, isFrozenRight);\n\n    if (!isContent && isNullOrUndefined(closest(e.target, '.' + literals.gridHeader))) {\n      this.clearOutline();\n      return;\n    }\n\n    var beforeArgs = {\n      cancel: false,\n      byKey: false,\n      byClick: !isNullOrUndefined(e.target),\n      clickArgs: e\n    };\n    this.parent.notify(event.beforeCellFocused, beforeArgs);\n\n    if (beforeArgs.cancel || closest(e.target, '.e-inline-edit')) {\n      return;\n    }\n\n    this.setActive(isContent, isFrozen, isFrozenRight);\n\n    if (this.getContent()) {\n      var returnVal = this.getContent().onClick(e, force);\n\n      if (returnVal === false) {\n        return;\n      }\n\n      this.focus();\n    }\n  };\n\n  FocusStrategy.prototype.onKeyPress = function (e) {\n    if (this.parent.allowPaging) {\n      var pagerElement = this.parent.pagerModule.pagerObj.element;\n      var focusablePagerElements = this.parent.pagerModule.pagerObj.getFocusablePagerElements(pagerElement, []);\n\n      if (this.parent.childGrid && this.allowToPaging(e) && focusablePagerElements.length) {\n        focusablePagerElements[0].tabIndex = 0;\n      }\n\n      if (this.parent.pagerModule.pagerObj.checkPagerHasFocus()) {\n        if (e.action === 'shiftTab' && focusablePagerElements.length && focusablePagerElements[0] === e.target) {\n          this.setActive(true);\n          var lastHeaderCellIndex = [this.active.matrix.matrix.length - 1, this.active.matrix.matrix[this.active.matrix.matrix.length - 1].length - 1];\n\n          if (this.active.matrix.matrix[lastHeaderCellIndex[0]][lastHeaderCellIndex[1]] === 0) {\n            lastHeaderCellIndex = findCellIndex(this.active.matrix.matrix, lastHeaderCellIndex, false);\n          }\n\n          this.active.matrix.current = lastHeaderCellIndex;\n          e.preventDefault();\n          this.focus(e);\n          return;\n        }\n\n        if (!(e.action === 'tab' && this.parent.element.classList.contains('e-childgrid') && (!this.parent.pageSettings.pageSizes && focusablePagerElements.length && focusablePagerElements[focusablePagerElements.length - 1] === e.target || this.parent.pagerModule.pagerObj.getDropDownPage() === e.target))) {\n          this.parent.pagerModule.pagerObj.changePagerFocus(e);\n          return;\n        } else {\n          var parentCell = parentsUntil(this.parent.element, 'e-detailcell');\n          removeClass([this.parent.element], ['e-focus']);\n          removeClass([parentCell], ['e-focused']);\n          parentCell.tabIndex = -1;\n        }\n      }\n\n      if (this.parent.pagerModule.pagerObj.element.tabIndex === 0 && (e.keyCode === 38 || e.shiftKey && e.keyCode === 9)) {\n        e.preventDefault();\n        this.getFocusedElement().focus();\n        return;\n      } else if (this.parent.pagerModule.pagerObj.element.tabIndex === 0 && e.keyCode === 9) {\n        e.preventDefault();\n        this.parent.pagerModule.pagerObj.setPagerFocus();\n        return;\n      }\n\n      if (this.parent.pagerModule.pagerObj.checkFirstPagerFocus()) {\n        var lastRow = this.getContent().matrix.rows;\n        var lastColumn = this.getContent().matrix.columns;\n        this.getContent().matrix.current = [lastRow, lastColumn];\n      }\n    }\n\n    if (this.skipOn(e)) {\n      return;\n    }\n\n    if (e.target && parentsUntil(e.target, 'e-gridcontent') && !this.parent.isFrozenGrid()) {\n      var rows = [].slice.call(this.parent.getContentTable().rows);\n      var lastCell = rows[rows.length - 1].lastElementChild;\n\n      if (e.target === lastCell) {\n        this.setActive(true);\n        this.setLastContentCellActive();\n      }\n    }\n\n    if (e.action === 'shiftTab' && e.target && (e.target === this.parent.element || parentsUntil(e.target, 'e-toolbar') || parentsUntil(e.target, 'e-groupdroparea'))) {\n      if (e.target === this.parent.element) {\n        if (this.parent.element.classList.contains('e-childgrid')) {\n          this.focusOutFromChildGrid(e);\n        }\n\n        return;\n      }\n\n      if (parentsUntil(e.target, 'e-groupdroparea')) {\n        e.preventDefault();\n        this.parent.element.focus();\n        return;\n      }\n\n      if (parentsUntil(e.target, 'e-toolbar')) {\n        e.preventDefault();\n\n        if (this.parent.allowGrouping) {\n          var groupModule = this.parent.groupModule;\n          var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n\n          if (focusableGroupedItems.length > 0) {\n            focusableGroupedItems[focusableGroupedItems.length - 1].focus();\n          } else {\n            groupModule.element.focus();\n          }\n        } else {\n          this.parent.element.focus();\n        }\n\n        return;\n      }\n    }\n\n    var focusFirstHeaderCell = false;\n\n    if (e.action === 'tab' && e.target && (e.target === this.parent.element || parentsUntil(e.target, 'e-toolbar') || parentsUntil(e.target, 'e-groupdroparea'))) {\n      if (this.parent.allowGrouping && (e.target === this.parent.element || e.target.classList.contains('e-groupdroparea'))) {\n        var groupModule = this.parent.groupModule;\n        var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n\n        if (focusableGroupedItems.length > 0) {\n          e.preventDefault();\n          focusableGroupedItems[0].focus();\n          return;\n        }\n\n        if (!e.target.classList.contains('e-groupdroparea')) {\n          e.preventDefault();\n          groupModule.element.focus();\n          return;\n        }\n      }\n\n      if ((this.parent.toolbar || this.parent.toolbarTemplate) && (e.target === this.parent.element || parentsUntil(e.target, 'e-groupdroparea') || e.target.classList.contains('e-toolbar'))) {\n        var toolbarElement = this.parent.toolbarModule.toolbar.element;\n        var focusableToolbarItems = toolbarElement.querySelectorAll('.e-toolbar-item:not(.e-overlay):not(.e-hidden)');\n\n        if (focusableToolbarItems.length > 0) {\n          e.preventDefault();\n          focusableToolbarItems[0].querySelector('.e-btn,.e-input').focus();\n          return;\n        }\n\n        if (!e.target.classList.contains('e-toolbar')) {\n          e.preventDefault();\n          toolbarElement.focus();\n          return;\n        }\n      }\n\n      if (e.target === this.parent.element || parentsUntil(e.target, 'e-toolbar') || parentsUntil(e.target, 'e-groupdroparea')) {\n        focusFirstHeaderCell = true;\n      }\n    }\n\n    if (focusFirstHeaderCell) {\n      if (this.parent.isFrozenGrid() && (this.parent.getFrozenMode() === 'Left' || this.parent.getFrozenMode() === literals.leftRight)) {\n        this.setActive(false, true);\n      } else {\n        this.setActive(false);\n      }\n\n      this.active.matrix.current = [0, -1];\n    }\n\n    this.activeKey = e.action;\n    var beforeArgs = {\n      cancel: false,\n      byKey: true,\n      byClick: false,\n      keyArgs: e\n    };\n    this.parent.notify(event.beforeCellFocused, beforeArgs);\n\n    if (beforeArgs.cancel) {\n      return;\n    }\n\n    var bValue = this.getContent().matrix.current;\n    this.currentInfo.outline = true;\n    var swapInfo = this.getContent().jump(e.action, bValue);\n    this.swap = swapInfo;\n\n    if (swapInfo.swap) {\n      this.setActive(!swapInfo.toHeader, swapInfo.toFrozen, swapInfo.toFrozenRight);\n      this.getContent().matrix.current = this.getContent().getNextCurrent(bValue, swapInfo, this.active, e.action);\n      this.prevIndexes = {};\n    }\n\n    this.setActiveByKey(e.action, this.getContent());\n    var returnVal = this.content.lastIdxCell ? false : this.getContent().onKeyPress(e);\n\n    if (e.target && parentsUntil(e.target, 'e-gridheader')) {\n      if (!this.parent.isFrozenGrid()) {\n        if (e.action === 'tab' && bValue.toString() === this.active.matrix.current.toString()) {\n          var nextHeaderCellIndex = findCellIndex(this.active.matrix.matrix, this.active.matrix.current, true);\n          var lastHeaderCellIndex = [this.active.matrix.matrix.length - 1, this.active.matrix.matrix[this.active.matrix.matrix.length - 1].length - 1];\n\n          if (this.active.matrix.matrix[lastHeaderCellIndex[0]][lastHeaderCellIndex[1]] === 0) {\n            lastHeaderCellIndex = findCellIndex(this.active.matrix.matrix, lastHeaderCellIndex, false);\n          }\n\n          if (this.active.matrix.current.toString() === lastHeaderCellIndex.toString()) {\n            returnVal = true;\n            this.setActive(true);\n            var firstContentCellIndex = [0, 0];\n\n            if (this.active.matrix.matrix[firstContentCellIndex[0]][firstContentCellIndex[1]] === 0) {\n              firstContentCellIndex = findCellIndex(this.active.matrix.matrix, [0, 0], true);\n            }\n\n            this.active.matrix.current = firstContentCellIndex;\n          } else if (this.active.matrix.current.toString() !== nextHeaderCellIndex.toString()) {\n            this.active.matrix.current = nextHeaderCellIndex;\n          }\n        }\n\n        if (e.action === 'shiftTab' && bValue.toString() === this.active.matrix.current.toString()) {\n          var previousCellIndex = findCellIndex(this.active.matrix.matrix, this.active.matrix.current, false);\n\n          if (previousCellIndex.toString() === this.active.matrix.current.toString()) {\n            this.focusOutFromHeader(e);\n            return;\n          }\n\n          if (this.active.matrix.current.toString() !== previousCellIndex.toString() && !returnVal) {\n            returnVal = true;\n            this.active.matrix.current = previousCellIndex;\n          }\n        }\n      } else {\n        if (e.action === 'shiftTab' && bValue.toString() === this.active.matrix.current.toString() && !swapInfo.swap) {\n          this.focusOutFromHeader(e);\n          return;\n        }\n      }\n    }\n\n    if (e.target && parentsUntil(e.target, 'e-gridcontent')) {\n      if (!this.parent.isFrozenGrid()) {\n        if (e.action === 'shiftTab' && bValue.toString() === this.active.matrix.current.toString()) {\n          var firstContentCellIndex = [0, 0];\n\n          if (this.active.matrix.matrix[firstContentCellIndex[0]][firstContentCellIndex[1]] === 0) {\n            firstContentCellIndex = findCellIndex(this.active.matrix.matrix, [0, 0], true);\n          }\n\n          if (!returnVal && firstContentCellIndex.toString() === this.active.matrix.current.toString()) {\n            returnVal = true;\n            this.setActive(false);\n            this.setLastContentCellActive();\n          }\n        }\n      }\n    }\n\n    if (returnVal === false) {\n      this.clearIndicator();\n\n      if (e.action === 'shiftTab' && bValue.toString() === [0, 0].toString()) {\n        this.parent.element.tabIndex = -1;\n      }\n\n      if (this.parent.allowPaging && !this.parent.pagerModule.pagerObj.checkPagerHasFocus() && this.allowToPaging(e) && bValue.toString() !== [0, 0].toString()) {\n        e.preventDefault();\n\n        if (e.keyCode === 40) {\n          this.parent.pagerModule.pagerObj.setPagerContainerFocus();\n          return;\n        } else if (e.keyCode === 9) {\n          this.parent.pagerModule.pagerObj.setPagerFocus();\n          return;\n        }\n      }\n\n      if (this.parent.element.classList.contains('e-childgrid')) {\n        this.focusOutFromChildGrid(e);\n      }\n\n      return;\n    }\n\n    e.preventDefault();\n    this.focus(e);\n  };\n\n  FocusStrategy.prototype.setLastContentCellActive = function () {\n    var lastContentCellIndex = [this.active.matrix.matrix.length - 1, this.active.matrix.matrix[this.active.matrix.matrix.length - 1].length - 1];\n\n    if (this.active.matrix.matrix[lastContentCellIndex[0]][lastContentCellIndex[1]] === 0) {\n      lastContentCellIndex = findCellIndex(this.active.matrix.matrix, lastContentCellIndex, false);\n    }\n\n    this.active.matrix.current = lastContentCellIndex;\n  };\n\n  FocusStrategy.prototype.focusOutFromChildGrid = function (e) {\n    var parentTable = parentsUntil(this.parent.element, 'e-table');\n    var parentGrid = parentsUntil(parentTable, 'e-grid').ej2_instances[0];\n    var parentCell = parentsUntil(this.parent.element, 'e-detailcell');\n    var uid = parentsUntil(this.parent.element, 'e-detailrow').getAttribute('data-uid');\n    var parentRows = parentGrid.getRows();\n    var parentRowIndex = parentRows.map(function (m) {\n      return m.getAttribute('data-uid');\n    }).indexOf(uid);\n\n    if (e.action === 'tab' && parentRowIndex >= parentRows.length - 1) {\n      return;\n    }\n\n    removeClass([this.parent.element], ['e-focus']);\n    removeClass([parentCell], ['e-focused']);\n    parentCell.tabIndex = -1;\n    e.preventDefault();\n    var nextFocusCell;\n    parentGrid.focusModule.removeFocus();\n\n    if (e.action === 'shiftTab') {\n      var previousRow = parentRows[parentRowIndex - 1];\n      var rowCells = previousRow.cells;\n\n      for (var i = rowCells.length - 1; i >= 0; i--) {\n        nextFocusCell = rowCells[i];\n\n        if (!nextFocusCell.classList.contains('e-hide')) {\n          parentGrid.focusModule.active.matrix.current = [parentRowIndex - 1, i];\n          break;\n        }\n      }\n    } else {\n      nextFocusCell = parentRows[parentRowIndex + 1].cells[0];\n      parentGrid.focusModule.active.matrix.current = [parentRowIndex + 1, 0];\n    }\n\n    parentGrid.focusModule.currentInfo.element = nextFocusCell;\n    parentGrid.focusModule.currentInfo.elementToFocus = nextFocusCell;\n    addClass([nextFocusCell], ['e-focused', 'e-focus']);\n    nextFocusCell.tabIndex = 0;\n    nextFocusCell.focus();\n  };\n\n  FocusStrategy.prototype.focusOutFromHeader = function (e) {\n    e.preventDefault();\n    this.removeFocus();\n\n    if (this.parent.toolbar || this.parent.toolbarTemplate) {\n      var toolbarElement = this.parent.toolbarModule.toolbar.element;\n      var focusableToolbarItems = toolbarElement.querySelectorAll('.e-toolbar-item:not(.e-overlay):not(.e-hidden)');\n\n      if (focusableToolbarItems.length > 0) {\n        focusableToolbarItems[focusableToolbarItems.length - 1].querySelector('.e-btn,.e-input').focus();\n      } else {\n        toolbarElement.focus();\n      }\n\n      return;\n    }\n\n    if (this.parent.allowGrouping) {\n      var groupModule = this.parent.groupModule;\n      var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n\n      if (focusableGroupedItems.length > 0) {\n        focusableGroupedItems[focusableGroupedItems.length - 1].focus();\n      } else {\n        groupModule.element.focus();\n      }\n\n      return;\n    }\n\n    if (this.parent.element.classList.contains('e-childgrid')) {\n      parentsUntil(this.parent.element, 'e-detailcell').focus();\n    } else {\n      this.parent.element.focus();\n    }\n  };\n\n  FocusStrategy.prototype.allowToPaging = function (e) {\n    if (this.parent.editSettings.mode === 'Batch' && this.parent.editSettings.allowAdding && e.keyCode !== 40) {\n      return false;\n    }\n\n    return true;\n  };\n\n  FocusStrategy.prototype.skipOn = function (e) {\n    var target = e.target;\n\n    if (!target) {\n      return false;\n    }\n\n    if (this.currentInfo.skipAction) {\n      this.clearIndicator();\n      return true;\n    }\n\n    if (['pageUp', 'pageDown', 'altDownArrow'].indexOf(e.action) > -1) {\n      this.clearIndicator();\n      return true;\n    }\n\n    if (this.parent.allowGrouping) {\n      var focusableGroupedItems = this.parent.groupModule.getFocusableGroupedItems();\n\n      if (parentsUntil(e.target, 'e-groupheadercell') && !(e.target === focusableGroupedItems[0] && e.action === 'shiftTab' || e.target === focusableGroupedItems[focusableGroupedItems.length - 1] && e.action === 'tab')) {\n        return true;\n      }\n    }\n\n    if (this.parent.toolbar || this.parent.toolbarTemplate) {\n      var toolbarElement = this.parent.toolbarModule.toolbar.element;\n      var focusableToolbarItems = toolbarElement.querySelectorAll('.e-toolbar-item:not(.e-overlay):not(.e-hidden)');\n\n      if (parentsUntil(e.target, 'e-toolbar-item') && !(focusableToolbarItems.length > 0 && (parentsUntil(e.target, 'e-toolbar-item') === focusableToolbarItems[0] && e.action === 'shiftTab' || parentsUntil(e.target, 'e-toolbar-item') === focusableToolbarItems[focusableToolbarItems.length - 1] && e.action === 'tab'))) {\n        return true;\n      }\n    }\n\n    var th = closest(target, 'th') && !closest(target, 'th').tabIndex;\n\n    if (e.target.classList.contains('e-filterbaroperator') && (e.keyCode === 13 || e.keyCode === 27)) {\n      var inputTarget = closest(e.target, '.e-filterbarcell');\n      inputTarget.querySelector('input').focus();\n    }\n\n    if (th && closest(document.activeElement, '.e-filterbarcell') !== null) {\n      this.removeFocus();\n    }\n\n    var filterCell = closest(document.activeElement, '.e-filterbarcell') !== null;\n\n    if (this.parent.enableHeaderFocus && filterCell) {\n      var matrix = this.active.matrix;\n      var current = matrix.current;\n      filterCell = matrix.matrix[current[0]].lastIndexOf(1) !== current[1];\n    }\n\n    return e.action === 'delete' || this.parent.editSettings.mode !== 'Batch' && (this.parent.isEdit || ['insert', 'f2'].indexOf(e.action) > -1) || filterCell && this.parent.enableHeaderFocus || closest(document.activeElement, '#' + this.parent.element.id + '_searchbar') !== null && ['enter', 'leftArrow', 'rightArrow', 'shiftLeft', 'shiftRight', 'ctrlPlusA'].indexOf(e.action) > -1 || closest(target, '.' + literals.gridContent) === null && closest(target, '.' + literals.gridHeader) === null && !(e.target === this.parent.element || parentsUntil(e.target, 'e-toolbar') || parentsUntil(e.target, 'e-groupdroparea')) || e.action === 'space' && !target.classList.contains(literals.gridChkBox) && closest(target, '.' + literals.gridChkBox) === null && closest(target, '.e-headerchkcelldiv') === null || closest(target, '.e-filter-popup') !== null;\n  };\n\n  FocusStrategy.prototype.focusVirtualElement = function (e) {\n    var _this = this;\n\n    if (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) {\n      var data = {\n        virtualData: {},\n        isAdd: false,\n        isCancel: false\n      };\n      this.parent.notify(event.getVirtualData, data);\n      var isKeyFocus = this.actions.some(function (value) {\n        return value === _this.activeKey;\n      });\n      var isSelected = this.parent.contentModule ? this.parent.contentModule.selectedRowIndex > -1 : false;\n\n      if (data.isAdd || Object.keys(data.virtualData).length || isKeyFocus || data.isCancel || isSelected) {\n        this.parent.notify(event.resetVirtualFocus, {\n          isCancel: false\n        });\n        data.isCancel = false;\n        this.parent.contentModule.selectedRowIndex = -1;\n\n        if (isKeyFocus) {\n          this.activeKey = this.empty;\n          this.parent.notify('virtaul-key-handler', e);\n        } // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n\n        this.currentInfo.elementToFocus.focus({\n          preventScroll: true\n        });\n      } else {\n        if (this.isVirtualScroll || this.isInfiniteScroll) {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          this.currentInfo.elementToFocus.focus({\n            preventScroll: true\n          });\n        } else {\n          this.currentInfo.elementToFocus.focus();\n        }\n      }\n    }\n\n    this.isVirtualScroll = this.isInfiniteScroll = false;\n  };\n\n  FocusStrategy.prototype.getFocusedElement = function () {\n    return this.currentInfo.elementToFocus;\n  };\n\n  FocusStrategy.prototype.getContent = function () {\n    return this.active || this.content;\n  };\n\n  FocusStrategy.prototype.setActive = function (content, isFrozen, isFrozenRight) {\n    this.active = content ? isFrozen ? this.fContent : isFrozenRight ? this.frContent : this.content : isFrozen ? this.fHeader : isFrozenRight ? this.frHeader : this.header;\n  };\n\n  FocusStrategy.prototype.setFocusedElement = function (element, e) {\n    var _this = this;\n\n    this.currentInfo.elementToFocus = element;\n    setTimeout(function () {\n      if (!isNullOrUndefined(_this.currentInfo.elementToFocus)) {\n        if (_this.parent.enableVirtualization || _this.parent.enableInfiniteScrolling) {\n          _this.focusVirtualElement(e);\n        } else {\n          _this.currentInfo.elementToFocus.focus();\n        }\n      }\n    }, 0);\n  };\n\n  FocusStrategy.prototype.focus = function (e) {\n    this.parent.notify(event.virtaulCellFocus, e);\n    this.removeFocus();\n    this.addFocus(this.getContent().getFocusInfo(), e);\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  FocusStrategy.prototype.removeFocus = function (e) {\n    if (!this.currentInfo.element) {\n      return;\n    }\n\n    removeClass([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focused', 'e-focus']);\n    this.currentInfo.element.tabIndex = -1;\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n\n\n  FocusStrategy.prototype.addOutline = function () {\n    var info = this.getContent().getFocusInfo();\n\n    if (info.element) {\n      addClass([info.element], ['e-focused']);\n      addClass([info.elementToFocus], ['e-focus']);\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n\n\n  FocusStrategy.prototype.focusHeader = function () {\n    this.setActive(false, this.parent.isFrozenGrid());\n    this.resetFocus();\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n\n\n  FocusStrategy.prototype.focusContent = function () {\n    this.setActive(true, this.parent.isFrozenGrid());\n    this.resetFocus();\n  };\n\n  FocusStrategy.prototype.resetFocus = function () {\n    var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator());\n    this.getContent().matrix.select(current[0], current[1]);\n    this.focus();\n  };\n\n  FocusStrategy.prototype.addFocus = function (info, e) {\n    this.currentInfo = info;\n    this.currentInfo.outline = info.outline && !isNullOrUndefined(e);\n\n    if (this.isInfiniteScroll) {\n      this.currentInfo.outline = true;\n    }\n\n    if (!info.element) {\n      return;\n    }\n\n    var isFocused = info.elementToFocus.classList.contains('e-focus');\n\n    if (isFocused) {\n      return;\n    }\n\n    if (this.currentInfo.outline) {\n      addClass([info.element], ['e-focused']);\n    }\n\n    addClass([info.elementToFocus], ['e-focus']);\n    info.element.tabIndex = 0;\n\n    if (!isFocused) {\n      this.setFocusedElement(info.elementToFocus, e);\n    }\n\n    this.parent.notify(event.cellFocused, {\n      element: info.elementToFocus,\n      parent: info.element,\n      indexes: this.getContent().matrix.current,\n      byKey: !isNullOrUndefined(e),\n      byClick: isNullOrUndefined(e),\n      keyArgs: e,\n      isJump: this.swap.swap,\n      container: this.getContent().getInfo(e),\n      outline: !isNullOrUndefined(e),\n      swapInfo: this.swap\n    });\n    var _a = this.getContent().matrix.current,\n        rowIndex = _a[0],\n        cellIndex = _a[1];\n    this.prevIndexes = {\n      rowIndex: rowIndex,\n      cellIndex: cellIndex\n    };\n    this.focusedColumnUid = this.parent.getColumnByIndex(cellIndex).uid;\n    this.focusByClick = false;\n  };\n\n  FocusStrategy.prototype.refreshMatrix = function (content) {\n    var _this = this;\n\n    return function (e) {\n      if (content && e.args && e.args.isFrozen && !_this.fContent) {\n        _this.fContent = new FixedContentFocus(_this.parent);\n      } else if (content && !_this.frContent && e.args && e.args.renderFrozenRightContent) {\n        _this.frContent = new FixedRightContentFocus(_this.parent);\n      } else if (content && !_this.content) {\n        _this.content = new ContentFocus(_this.parent);\n      }\n\n      if (!content && e.args && e.args.isFrozen && !_this.fHeader) {\n        _this.fHeader = new FixedHeaderFocus(_this.parent);\n      } else if (!content && e.args && e.args.renderFrozenRightContent && !_this.frHeader) {\n        _this.frHeader = new FixedRightHeaderFocus(_this.parent);\n      } else if (!content && !_this.header) {\n        _this.header = new HeaderFocus(_this.parent);\n      }\n\n      var cFocus = content ? e.args && e.args.isFrozen ? _this.fContent : e.args && e.args.renderFrozenRightContent ? _this.frContent : _this.content : e.args && e.args.isFrozen ? _this.fHeader : e.args && e.args.renderFrozenRightContent ? _this.frHeader : _this.header;\n      var rows = content ? e.rows.slice(_this.parent.frozenRows) : e.rows;\n      var updateRow = content ? e.rows.slice(0, _this.parent.frozenRows) : e.rows;\n\n      if (_this.parent.isCollapseStateEnabled() && content) {\n        rows = rows.filter(function (x) {\n          return x.visible !== false;\n        });\n      }\n\n      var isRowTemplate = !isNullOrUndefined(_this.parent.rowTemplate);\n      var matrix = cFocus.matrix.generate(updateRow, cFocus.selector, isRowTemplate);\n\n      if (e.name === 'batchAdd' && _this.parent.isFrozenGrid()) {\n        var mRows = _this.parent.getMovableRowsObject();\n\n        var newMovableRows = mRows.map(function (row) {\n          return row.clone();\n        });\n        var newFrozenRows = rows.map(function (row) {\n          return row.clone();\n        });\n\n        _this.fContent.matrix.generate(newFrozenRows, _this.fContent.selector, isRowTemplate);\n\n        _this.content.matrix.generate(newMovableRows, _this.content.selector, isRowTemplate);\n\n        if (_this.parent.getFrozenMode() === literals.leftRight) {\n          var frRows = _this.parent.getFrozenRightRowsObject();\n\n          var newfrRows = frRows.map(function (row) {\n            return row.clone();\n          });\n\n          _this.frContent.matrix.generate(newfrRows, _this.frContent.selector, isRowTemplate);\n        }\n      } else {\n        cFocus.matrix.generate(rows, cFocus.selector, isRowTemplate);\n      }\n\n      if (!(_this.parent.isFrozenGrid() && e.args && e.args.requestType === 'sorting')) {\n        cFocus.generateRows(updateRow, {\n          matrix: matrix,\n          handlerInstance: e.args && e.args.isFrozen ? _this.fHeader : e.args && e.args.renderFrozenRightContent ? _this.frHeader : _this.header\n        });\n      }\n\n      if (!Browser.isDevice && e && e.args) {\n        if (!_this.focusByClick && e.args.requestType === 'paging' && !_this.parent.pagerModule.pagerObj.checkPagerHasFocus()) {\n          _this.skipFocus = false;\n\n          _this.parent.element.focus();\n        }\n\n        if (e.args.requestType === 'grouping') {\n          _this.skipFocus = true;\n        }\n      }\n\n      if (e && e.args && e.args.requestType === 'virtualscroll') {\n        if (_this.currentInfo.uid) {\n          var index_1;\n          var bool = e.rows.some(function (row, i) {\n            index_1 = i;\n            return row.uid === _this.currentInfo.uid;\n          });\n\n          if (bool) {\n            _this.content.matrix.current[0] = index_1;\n            _this.content.matrix.current[1] = _this.parent.getColumnIndexByUid(_this.focusedColumnUid) || 0;\n\n            var focusElement = _this.getContent().getFocusInfo().elementToFocus;\n\n            if (focusElement) {\n              var cellPosition = focusElement.getBoundingClientRect();\n\n              var gridPosition = _this.parent.element.getBoundingClientRect();\n\n              if (cellPosition.top >= 0 && cellPosition.left >= 0 && cellPosition.right <= Math.min(gridPosition.right, window.innerWidth || document.documentElement.clientWidth) && cellPosition.bottom <= Math.min(gridPosition.bottom, window.innerHeight || document.documentElement.clientHeight)) {\n                _this.isVirtualScroll = true;\n\n                _this.focus();\n              }\n            }\n          }\n        } else if (e.args.focusElement && e.args.focusElement.classList.contains('e-filtertext')) {\n          var focusElement = _this.parent.element.querySelector('#' + e.args.focusElement.id);\n\n          if (focusElement) {\n            focusElement.focus();\n          }\n        }\n      }\n    };\n  };\n\n  FocusStrategy.prototype.addEventListener = function () {\n    var _this = this;\n\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    EventHandler.add(this.parent.element, 'mousedown', this.focusCheck, this);\n    EventHandler.add(this.parent.element, 'focus', this.onFocus, this);\n    this.parent.element.addEventListener('focus', this.passiveHandler = function (e) {\n      return _this.passiveFocus(e);\n    }, true);\n    EventHandler.add(this.parent.element, 'focusout', this.onBlur, this);\n    this.evtHandlers = [{\n      event: event.keyPressed,\n      handler: this.onKeyPress\n    }, {\n      event: event.click,\n      handler: this.onClick\n    }, {\n      event: event.contentReady,\n      handler: this.refMatrix\n    }, {\n      event: event.partialRefresh,\n      handler: this.refMatrix\n    }, {\n      event: event.refreshExpandandCollapse,\n      handler: this.refMatrix\n    }, {\n      event: event.headerRefreshed,\n      handler: this.refreshMatrix()\n    }, {\n      event: event.closeEdit,\n      handler: this.restoreFocus\n    }, {\n      event: event.restoreFocus,\n      handler: this.restoreFocus\n    }, {\n      event: 'start-edit',\n      handler: this.clearIndicator\n    }, {\n      event: 'start-add',\n      handler: this.clearIndicator\n    }, {\n      event: 'sorting-complete',\n      handler: this.restoreFocus\n    }, {\n      event: 'filtering-complete',\n      handler: this.filterfocus\n    }, {\n      event: 'grouping-complete',\n      handler: this.restoreFocusWithAction\n    }, {\n      event: 'ungrouping-complete',\n      handler: this.restoreFocusWithAction\n    }, {\n      event: event.batchAdd,\n      handler: this.refMatrix\n    }, {\n      event: event.batchCancel,\n      handler: this.refMatrix\n    }, {\n      event: event.batchDelete,\n      handler: this.refMatrix\n    }, {\n      event: event.detailDataBound,\n      handler: this.refMatrix\n    }, {\n      event: event.onEmpty,\n      handler: this.refMatrix\n    }, {\n      event: event.cellFocused,\n      handler: this.internalCellFocus\n    }];\n    addRemoveEventListener(this.parent, this.evtHandlers, true, this);\n  };\n\n  FocusStrategy.prototype.filterfocus = function () {\n    if (this.parent.filterSettings.type !== 'FilterBar') {\n      this.restoreFocus();\n    }\n  };\n\n  FocusStrategy.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    EventHandler.remove(this.parent.element, 'mousedown', this.focusCheck);\n    EventHandler.remove(this.parent.element, 'focus', this.onFocus);\n    EventHandler.remove(this.parent.element, 'focusout', this.onBlur);\n    this.parent.element.removeEventListener('focus', this.passiveHandler, true);\n    addRemoveEventListener(this.parent, this.evtHandlers, false);\n  };\n\n  FocusStrategy.prototype.destroy = function () {\n    this.removeEventListener();\n  };\n\n  FocusStrategy.prototype.restoreFocus = function () {\n    var groupModule = this.parent.groupModule;\n\n    if (this.parent.allowGrouping && groupModule && groupModule.groupSortFocus) {\n      groupModule.groupSortFocus = false;\n      return;\n    }\n\n    this.addFocus(this.getContent().getFocusInfo());\n  };\n\n  FocusStrategy.prototype.restoreFocusWithAction = function (e) {\n    if (!this.parent.enableInfiniteScrolling) {\n      var matrix = this.getContent().matrix;\n      var current = matrix.current;\n\n      switch (e.requestType) {\n        case 'grouping':\n        case 'ungrouping':\n          current[1] = current.length && !this.parent.groupSettings.showGroupedColumn && !isNullOrUndefined(matrix.matrix[current[0]]) ? matrix.matrix[current[0]].indexOf(1) : e.requestType === 'grouping' ? current[1] + 1 : current[1] - 1;\n          break;\n      }\n\n      this.getContent().matrix.current = current;\n      var groupModule = this.parent.groupModule;\n\n      if (this.parent.allowGrouping && groupModule && groupModule.groupCancelFocus) {\n        var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n\n        if (focusableGroupedItems.length) {\n          if (focusableGroupedItems[0].parentElement.getAttribute('ej-mappingname') === e.columnName) {\n            focusableGroupedItems[3].focus();\n          } else {\n            focusableGroupedItems[0].focus();\n          }\n        } else {\n          groupModule.element.focus();\n        }\n\n        groupModule.groupCancelFocus = false;\n        return;\n      }\n\n      this.addFocus(this.getContent().getFocusInfo());\n    }\n  };\n\n  FocusStrategy.prototype.clearOutline = function () {\n    this.getContent().matrix.current = this.getContent().matrix.get(0, -1, [0, 1], 'downArrow', this.getContent().validator());\n    this.clearIndicator();\n  };\n\n  FocusStrategy.prototype.clearIndicator = function () {\n    if (!this.currentInfo.element || !this.currentInfo.elementToFocus) {\n      return;\n    }\n\n    removeClass([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focus', 'e-focused']);\n  };\n\n  FocusStrategy.prototype.getPrevIndexes = function () {\n    var forget = this.forget;\n    this.forget = false;\n    return forget || !Object.keys(this.prevIndexes).length ? {\n      rowIndex: null,\n      cellIndex: null\n    } : this.prevIndexes;\n  };\n\n  FocusStrategy.prototype.forgetPrevious = function () {\n    this.forget = true;\n  };\n\n  FocusStrategy.prototype.setActiveByKey = function (action, active) {\n    var _this = this;\n\n    if (!this.parent.isFrozenGrid() && this.parent.frozenRows === 0) {\n      return;\n    } // eslint-disable-next-line prefer-const\n\n\n    var info;\n    var actions = {\n      'home': function () {\n        return {\n          toHeader: !info.isContent,\n          toFrozen: true\n        };\n      },\n      'end': function () {\n        return {\n          toHeader: !info.isContent,\n          toFrozen: false\n        };\n      },\n      'ctrlHome': function () {\n        return {\n          toHeader: true,\n          toFrozen: _this.parent.isFrozenGrid()\n        };\n      },\n      'ctrlEnd': function () {\n        return {\n          toHeader: false,\n          toFrozen: false\n        };\n      }\n    };\n\n    if (!(action in actions)) {\n      return;\n    }\n\n    info = active.getInfo();\n    var swap = actions[action]();\n    this.setActive(!swap.toHeader, swap.toFrozen);\n    this.getContent().matrix.current = active.matrix.current;\n  };\n\n  FocusStrategy.prototype.internalCellFocus = function (e) {\n    if (!(e.byKey && e.container.isContent && e.keyArgs.action === 'enter' && (e.parent.classList.contains('e-detailcell') || e.parent.classList.contains('e-unboundcell') || e.parent.classList.contains('e-templatecell')))) {\n      return;\n    }\n\n    this.clearIndicator();\n    var focusEle = this.getContent().getFocusable(this.getFocusedElement());\n    this.setFocusedElement(focusEle);\n    this.currentInfo.skipAction = true;\n  };\n\n  return FocusStrategy;\n}();\n\nexport { FocusStrategy };\n/**\n * Create matrix from row collection which act as mental model for cell navigation\n *\n * @hidden\n */\n\nvar Matrix =\n/** @class */\nfunction () {\n  function Matrix() {\n    this.matrix = [];\n    this.current = [];\n  }\n\n  Matrix.prototype.set = function (rowIndex, columnIndex, allow) {\n    rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n    columnIndex = Math.max(0, Math.min(columnIndex, this.columns));\n    this.matrix[rowIndex] = this.matrix[rowIndex] || [];\n    this.matrix[rowIndex][columnIndex] = allow ? 1 : 0;\n  };\n\n  Matrix.prototype.get = function (rowIndex, columnIndex, navigator, action, validator) {\n    var tmp = columnIndex;\n\n    if (rowIndex + navigator[0] < 0) {\n      return [rowIndex, columnIndex];\n    }\n\n    rowIndex = Math.max(0, Math.min(rowIndex + navigator[0], this.rows));\n    var emptyTable = true;\n\n    if (isNullOrUndefined(this.matrix[rowIndex])) {\n      return null;\n    }\n\n    columnIndex = Math.max(0, Math.min(columnIndex + navigator[1], this.matrix[rowIndex].length - 1));\n\n    if (tmp + navigator[1] > this.matrix[rowIndex].length - 1 && validator(rowIndex, columnIndex, action)) {\n      return [rowIndex, tmp];\n    }\n\n    var first = this.first(this.matrix[rowIndex], columnIndex, navigator, true, action);\n    columnIndex = first === null ? tmp : first;\n    var val = getValue(rowIndex + \".\" + columnIndex, this.matrix);\n\n    if (rowIndex === this.rows && (action === 'downArrow' || action === 'enter')) {\n      navigator[0] = -1;\n    }\n\n    if (first === null) {\n      for (var i = 0; i < this.rows; i++) {\n        if (this.matrix[i].some(function (v) {\n          return v === 1;\n        })) {\n          emptyTable = false;\n          break;\n        }\n      }\n\n      if (emptyTable) {\n        rowIndex = this.current[0];\n        return [rowIndex, columnIndex];\n      }\n    }\n\n    return this.inValid(val) || !validator(rowIndex, columnIndex, action) ? this.get(rowIndex, tmp, navigator, action, validator) : [rowIndex, columnIndex];\n  };\n\n  Matrix.prototype.first = function (vector, index, navigator, moveTo, action) {\n    if ((index < 0 || index === vector.length) && this.inValid(vector[index]) && action !== 'upArrow' && action !== 'downArrow' || !vector.some(function (v) {\n      return v === 1;\n    })) {\n      return null;\n    }\n\n    return !this.inValid(vector[index]) ? index : this.first(vector, ['upArrow', 'downArrow', 'shiftUp', 'shiftDown'].indexOf(action) !== -1 ? moveTo ? 0 : ++index : index + navigator[1], navigator, false, action);\n  };\n\n  Matrix.prototype.select = function (rowIndex, columnIndex) {\n    rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n    columnIndex = Math.max(0, Math.min(columnIndex, this.matrix[rowIndex].length - 1));\n    this.current = [rowIndex, columnIndex];\n  };\n\n  Matrix.prototype.generate = function (rows, selector, isRowTemplate) {\n    this.rows = rows.length - 1;\n    this.matrix = [];\n\n    for (var i = 0; i < rows.length; i++) {\n      var cells = rows[i].cells.filter(function (c) {\n        return c.isSpanned !== true;\n      });\n      this.columns = Math.max(cells.length - 1, this.columns | 0);\n      var incrementNumber = 0;\n\n      for (var j = 0; j < cells.length; j++) {\n        if (cells[j].column && cells[j].column.columns) {\n          incrementNumber = this.columnsCount(cells[j].column.columns, incrementNumber);\n        } else {\n          incrementNumber++;\n        }\n\n        this.set(i, j, rows[i].visible === false ? false : selector(rows[i], cells[j], isRowTemplate));\n      }\n\n      this.columns = Math.max(incrementNumber - 1, this.columns | 0);\n    }\n\n    return this.matrix;\n  };\n\n  Matrix.prototype.columnsCount = function (rowColumns, currentColumnCount) {\n    var columns = rowColumns;\n    var incrementNumber = currentColumnCount;\n\n    for (var i = 0; i < columns.length; i++) {\n      if (columns[i].columns) {\n        incrementNumber = this.columnsCount(columns[i].columns, incrementNumber);\n      } else {\n        incrementNumber++;\n      }\n    }\n\n    return incrementNumber;\n  };\n\n  Matrix.prototype.inValid = function (value) {\n    return value === 0 || value === undefined;\n  };\n\n  return Matrix;\n}();\n\nexport { Matrix };\n/**\n * @hidden\n */\n\nvar ContentFocus =\n/** @class */\nfunction () {\n  function ContentFocus(parent) {\n    var _this = this;\n\n    this.matrix = new Matrix();\n    this.lastIdxCell = false;\n    this.parent = parent;\n    this.keyActions = {\n      'rightArrow': [0, 1],\n      'tab': [0, 1],\n      'leftArrow': [0, -1],\n      'shiftTab': [0, -1],\n      'upArrow': [-1, 0],\n      'downArrow': [1, 0],\n      'shiftUp': [-1, 0],\n      'shiftDown': [1, 0],\n      'shiftRight': [0, 1],\n      'shiftLeft': [0, -1],\n      'enter': [1, 0],\n      'shiftEnter': [-1, 0]\n    };\n\n    this.indexesByKey = function (action) {\n      var opt = {\n        'home': [_this.matrix.current[0], -1, 0, 1],\n        'end': [_this.matrix.current[0], _this.matrix.columns + 1, 0, -1],\n        'ctrlHome': [0, -1, 0, 1],\n        'ctrlEnd': [_this.matrix.rows, _this.matrix.columns + 1, 0, -1]\n      };\n      return opt[action] || null;\n    };\n  }\n\n  ContentFocus.prototype.getTable = function () {\n    return this.parent.isFrozenGrid() ? this.parent.getContent().querySelector('.e-movablecontent .e-table') : this.parent.getContentTable();\n  };\n\n  ContentFocus.prototype.onKeyPress = function (e) {\n    var navigator = this.keyActions[e.action];\n    var current = this.getCurrentFromAction(e.action, navigator, e.action in this.keyActions, e);\n\n    if (!current) {\n      return;\n    }\n\n    if ((['tab', 'shiftTab'].indexOf(e.action) > -1 && this.matrix.current || []).toString() === current.toString() || this.parent.allowPaging && !this.parent.pagerModule.pagerObj.checkPagerHasFocus() && this.matrix.current[0] === this.matrix.rows && (this.parent.editSettings.mode === 'Batch' && this.parent.editSettings.allowAdding && e.keyCode === 40 || e.keyCode === 40)) {\n      if (current.toString() === [this.matrix.rows, this.matrix.columns].toString() || current.toString() === [0, 0].toString() || this.matrix.current[0] === this.matrix.rows && this.matrix.current.toString() === current.toString()) {\n        return false;\n      } else {\n        current = this.editNextRow(current[0], current[1], e.action);\n      }\n    }\n\n    this.matrix.select(current[0], current[1]);\n  };\n\n  ContentFocus.prototype.editNextRow = function (rowIndex, cellIndex, action) {\n    var gObj = this.parent;\n    var editNextRow = gObj.editSettings.allowNextRowEdit && (gObj.isEdit || gObj.isLastCellPrimaryKey);\n    var visibleIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[0].field);\n    var cell = this.getTable().rows[rowIndex].cells[cellIndex];\n\n    if (action === 'tab' && editNextRow) {\n      rowIndex++;\n      var index = this.getTable().rows[rowIndex].getElementsByClassName('e-indentcell').length + this.getTable().rows[rowIndex].getElementsByClassName('e-detailrowcollapse').length;\n      cellIndex = visibleIndex + index;\n    }\n\n    if (action === 'shiftTab' && editNextRow) {\n      rowIndex--;\n      cellIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[gObj.getVisibleColumns().length - 1].field);\n    }\n\n    return !cell.classList.contains(literals.rowCell) && !cell.classList.contains('e-headercell') && !cell.classList.contains('e-groupcaption') && !cell.classList.contains('e-filterbarcell') ? this.editNextRow(rowIndex, cellIndex, action) : [rowIndex, cellIndex];\n  };\n\n  ContentFocus.prototype.getCurrentFromAction = function (action, navigator, isPresent, e) {\n    if (navigator === void 0) {\n      navigator = [0, 0];\n    }\n\n    if (!isPresent && !this.indexesByKey(action) || this.matrix.current.length === 0) {\n      return null;\n    }\n\n    if (!this.shouldFocusChange(e)) {\n      return this.matrix.current;\n    } // eslint-disable-next-line\n\n\n    var _a = this.indexesByKey(action) || this.matrix.current.concat(navigator),\n        rowIndex = _a[0],\n        cellIndex = _a[1],\n        rN = _a[2],\n        cN = _a[3];\n\n    if (action === 'ctrlEnd') {\n      var lastContentCellIndex = [this.matrix.matrix.length - 1, this.matrix.matrix[this.matrix.matrix.length - 1].length - 1];\n\n      if (this.matrix.matrix[lastContentCellIndex[0]][lastContentCellIndex[1]] === 0) {\n        lastContentCellIndex = findCellIndex(this.matrix.matrix, lastContentCellIndex, false);\n      }\n\n      rowIndex = lastContentCellIndex[0];\n      cellIndex = lastContentCellIndex[1] + 1;\n    }\n\n    var current = this.matrix.get(rowIndex, cellIndex, [rN, cN], action, this.validator());\n    return current;\n  };\n\n  ContentFocus.prototype.onClick = function (e, force) {\n    var target = e.target;\n    this.target = target;\n    target = target.classList.contains(literals.rowCell) ? target : closest(target, 'td');\n    target = target ? target : closest(e.target, 'td.e-detailrowcollapse') || closest(e.target, 'td.e-detailrowexpand');\n    target = closest(e.target, 'td.e-detailcell') ? isNullOrUndefined(closest(closest(e.target, '.e-grid'), 'td.e-detailcell')) ? null : target : target;\n    target = target && closest(target, 'table').classList.contains(literals.table) ? target : null;\n\n    if (!target) {\n      return false;\n    }\n\n    var _a = [target.parentElement.rowIndex, target.cellIndex],\n        rowIndex = _a[0],\n        cellIndex = _a[1];\n    var _b = this.matrix.current,\n        oRowIndex = _b[0],\n        oCellIndex = _b[1];\n    var val = getValue(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n\n    if (this.matrix.inValid(val) || !force && oRowIndex === rowIndex && oCellIndex === cellIndex || !parentsUntil(e.target, literals.rowCell) && !parentsUntil(e.target, 'e-groupcaption')) {\n      return false;\n    }\n\n    this.matrix.select(rowIndex, cellIndex);\n  };\n\n  ContentFocus.prototype.getFocusInfo = function () {\n    var info = {};\n    var _a = this.matrix.current,\n        _b = _a[0],\n        rowIndex = _b === void 0 ? 0 : _b,\n        _c = _a[1],\n        cellIndex = _c === void 0 ? 0 : _c;\n    this.matrix.current = [rowIndex, cellIndex];\n    info.element = !isNullOrUndefined(this.getTable().rows[rowIndex]) ? this.getTable().rows[rowIndex].cells[cellIndex] : null;\n\n    if (!info.element) {\n      return info;\n    }\n\n    info.elementToFocus = !info.element.classList.contains('e-unboundcell') && !info.element.classList.contains('e-detailcell') ? this.getFocusable(info.element) : info.element;\n    info.elementToFocus = info.element.classList.contains('e-detailcell') && info.element.querySelector('.e-childgrid') ? info.element.querySelector('.e-childgrid') : info.elementToFocus;\n    info.outline = true;\n    info.uid = info.element.parentElement.getAttribute('data-uid');\n    return info;\n  };\n\n  ContentFocus.prototype.getFocusable = function (element) {\n    var query = 'button, [href], input:not([type=\"hidden\"]), select, textarea, [tabindex]:not([tabindex=\"-1\"])';\n    var isTemplate = !isNullOrUndefined(closest(element, '.e-templatecell'));\n\n    if (this.parent.isEdit) {\n      query = 'input:not([type=\"hidden\"]), select:not([aria-hidden=\"true\"]), textarea';\n    }\n\n    var child = [].slice.call(element.querySelectorAll(query));\n    /* Select the first focusable child element\n     * if no child found then select the cell itself.\n     * if Grid is in editable state, check for editable control inside child.\n     */\n\n    return child.length ? isTemplate && child.length > 1 ? this.target : child[0] : element;\n  };\n\n  ContentFocus.prototype.selector = function (row, cell, isRowTemplate) {\n    var types = [CellType.Expand, CellType.GroupCaption, CellType.CaptionSummary, CellType.GroupSummary];\n    return (row.isDataRow && cell.visible && (cell.isDataCell || cell.isTemplate) || row.isDataRow && cell.cellType === CellType.DetailExpand && isNullOrUndefined(cell.visible) || !row.isDataRow && types.indexOf(cell.cellType) > -1 || cell.column && cell.visible && cell.column.type === 'checkbox' || cell.cellType === CellType.CommandColumn || row.isDataRow && isRowTemplate) && !(row.edit === 'delete' && row.isDirty);\n  };\n\n  ContentFocus.prototype.nextRowFocusValidate = function (index) {\n    var lastIndex = index;\n\n    for (var i = index, len = this.matrix.rows; i <= len; i++) {\n      if (this.matrix.matrix[index].indexOf(1) === -1) {\n        index = index + 1;\n      } else {\n        return index;\n      }\n    }\n\n    this.lastIdxCell = true;\n    return lastIndex;\n  };\n\n  ContentFocus.prototype.previousRowFocusValidate = function (index) {\n    var firstIndex = index;\n\n    for (var i = index, len = 0; i >= len; i--) {\n      if (this.matrix.matrix[index].indexOf(1) === -1) {\n        index = index - 1;\n\n        if (index < 0) {\n          this.lastIdxCell = true;\n          return firstIndex;\n        }\n      } else {\n        return index;\n      }\n    }\n\n    return firstIndex;\n  };\n\n  ContentFocus.prototype.jump = function (action, current) {\n    var frozenSwap = this.parent.getFrozenLeftCount() && (action === 'leftArrow' || action === 'shiftTab') && current[1] === 0 || current[0] < this.matrix.matrix.length - 1 && action === 'tab' && this.parent.getFrozenMode() === 'Left' && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n    var right = (action === 'rightArrow' || action === 'tab') && current[1] === this.matrix.columns || action === 'shiftTab' && this.parent.getFrozenMode() === 'Right' && current[1] === this.matrix.matrix[current[0]].indexOf(1);\n    var frSwap = this.parent.getFrozenMode() === literals.leftRight && right;\n\n    if (this.parent.getFrozenMode() === 'Right') {\n      frozenSwap = right;\n    }\n\n    this.lastIdxCell = false;\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n    var headerSwap = (action === 'upArrow' || enterFrozen) && current[0] === 0 || action === 'shiftTab' && this.parent.getFrozenMode() === 'Right' && current[0] === 0 && current[1] === this.matrix.matrix[current[0]].indexOf(1);\n\n    if (!this.parent.isFrozenGrid() && action === 'tab' && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1) && this.matrix.matrix.length - 1 !== current[0]) {\n      this.matrix.current[0] = this.nextRowFocusValidate(this.matrix.current[0] + 1);\n      this.matrix.current[1] = -1;\n      frozenSwap = this.parent.isFrozenGrid();\n    }\n\n    if (!this.parent.isFrozenGrid() && action === 'shiftTab' && current[0] !== 0 && this.matrix.matrix[current[0]].indexOf(1) === current[1]) {\n      this.matrix.current[0] = this.previousRowFocusValidate(this.matrix.current[0] - 1);\n      this.matrix.current[1] = this.matrix.matrix[current[0]].length;\n    }\n\n    var isHeaderFocus = false;\n    var row = document.activeElement.parentElement;\n\n    if ((this.parent.enableVirtualization || this.parent.infiniteScrollSettings.enableCache) && row.classList.contains(literals.row)) {\n      var rowIndex = parseInt(row.getAttribute(literals.ariaRowIndex), 10);\n      isHeaderFocus = rowIndex > 0;\n    }\n\n    if (action === 'shiftTab' && this.parent.getFrozenMode() === 'Right' && current[0] === 0 && current[1] === this.matrix.matrix[current[0]].indexOf(1)) {\n      this.matrix.current[0] = -1;\n    }\n\n    var info = {\n      swap: !isHeaderFocus ? (action === 'upArrow' || enterFrozen) && current[0] === 0 || frozenSwap || frSwap : false,\n      toHeader: headerSwap,\n      toFrozen: frozenSwap,\n      toFrozenRight: frSwap\n    };\n    return info;\n  };\n\n  ContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n\n    var current = [];\n\n    if (this.parent.getFrozenMode() === 'Right' || this.parent.getFrozenMode() === literals.leftRight) {\n      if (action === 'leftArrow' || action === 'shiftTab') {\n        current[0] = previous[0];\n        current[1] = this.matrix.matrix[current[0]].length;\n      }\n\n      if (this.parent.getFrozenMode() === literals.leftRight && (action === 'rightArrow' || action === 'tab')) {\n        current[0] = previous[0];\n        current[1] = -1;\n      }\n\n      if (this.parent.getFrozenMode() === 'Right' && action === 'tab') {\n        current[0] = previous[0] + 1;\n        current[1] = -1;\n      }\n    } else if (action === 'rightArrow' || action === 'tab') {\n      current[0] = previous[0];\n      current[1] = -1;\n    }\n\n    if (action === 'downArrow' || action === 'enter') {\n      current[0] = -1;\n      current[1] = previous[1];\n    }\n\n    if (action === 'shiftTab' && this.parent.getFrozenMode() === 'Left') {\n      current[0] = previous[0] - 1;\n      current[1] = this.matrix.matrix[current[0]].length;\n    }\n\n    return current;\n  };\n\n  ContentFocus.prototype.generateRows = function (rows, optionals) {\n    var _a;\n\n    var matrix = optionals.matrix,\n        handlerInstance = optionals.handlerInstance;\n    var len = handlerInstance.matrix.matrix.length;\n    var defaultLen = this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar' ? len + 1 : len;\n    handlerInstance.matrix.matrix = handlerInstance.matrix.matrix.slice(0, defaultLen); //Header matrix update.\n\n    handlerInstance.matrix.rows = defaultLen;\n\n    (_a = handlerInstance.matrix.matrix).push.apply(_a, matrix);\n\n    handlerInstance.matrix.rows += matrix.length;\n  };\n\n  ContentFocus.prototype.getInfo = function (e) {\n    var info = this.getFocusInfo();\n    var _a = this.matrix.current,\n        rIndex = _a[0],\n        cIndex = _a[1];\n    var isData = info.element.classList.contains(literals.rowCell);\n    var isSelectable = isData || e && e.action !== 'enter' && (info.element.classList.contains('e-detailrowcollapse') || info.element.classList.contains('e-detailrowexpand')); // eslint-disable-next-line\n\n    var _b = [Math.min(parseInt(info.element.parentElement.getAttribute(literals.ariaRowIndex), 10), rIndex), Math.min(parseInt(info.element.getAttribute(literals.ariaColIndex), 10), cIndex)],\n        rowIndex = _b[0],\n        cellIndex = _b[1];\n\n    if (this.parent.allowGrouping && this.parent.groupSettings.enableLazyLoading && isData) {\n      rowIndex = this.parent.getDataRows().indexOf(info.element.parentElement);\n    }\n\n    return {\n      isContent: true,\n      isDataCell: isData,\n      indexes: [rowIndex, cellIndex],\n      isSelectable: isSelectable\n    };\n  };\n\n  ContentFocus.prototype.validator = function () {\n    var table = this.getTable();\n    return function (rowIndex, cellIndex, action) {\n      if (!isNullOrUndefined(table.rows[rowIndex])) {\n        var cell = void 0;\n        cellIndex = table.querySelector('.e-emptyrow') ? 0 : cellIndex;\n\n        if (table.rows[rowIndex].cells[0].classList.contains('e-editcell')) {\n          cell = table.rows[rowIndex].cells[0].querySelectorAll('td')[cellIndex];\n        } else {\n          cell = table.rows[rowIndex].cells[cellIndex];\n        }\n\n        var isCellWidth = cell.getBoundingClientRect().width !== 0;\n\n        if (action === 'enter' || action === 'shiftEnter') {\n          return isCellWidth && cell.classList.contains(literals.rowCell);\n        }\n\n        if ((action === 'shiftUp' || action === 'shiftDown') && cell.classList.contains(literals.rowCell)) {\n          return isCellWidth;\n        } else if (action !== 'shiftUp' && action !== 'shiftDown') {\n          return isCellWidth;\n        }\n      }\n\n      return false;\n    };\n  };\n\n  ContentFocus.prototype.shouldFocusChange = function (e) {\n    var _a = this.matrix.current,\n        _b = _a[0],\n        rIndex = _b === void 0 ? -1 : _b,\n        _c = _a[1],\n        cIndex = _c === void 0 ? -1 : _c;\n\n    if (rIndex < 0 || cIndex < 0) {\n      return true;\n    }\n\n    var cell = getValue(rIndex + \".cells.\" + cIndex, this.getTable().rows);\n\n    if (!cell) {\n      return true;\n    }\n\n    return e.action === 'enter' || e.action === 'shiftEnter' ? cell.classList.contains(literals.rowCell) && !cell.classList.contains('e-unboundcell') && (!cell.classList.contains('e-templatecell') || cell.classList.contains('e-editedbatchcell')) && !cell.classList.contains('e-detailcell') : true;\n  };\n\n  ContentFocus.prototype.getGridSeletion = function () {\n    return this.parent.allowSelection && this.parent.selectionSettings.allowColumnSelection;\n  };\n\n  return ContentFocus;\n}();\n\nexport { ContentFocus };\n/**\n * @hidden\n */\n\nvar HeaderFocus =\n/** @class */\nfunction (_super) {\n  __extends(HeaderFocus, _super);\n\n  function HeaderFocus(parent) {\n    return _super.call(this, parent) || this;\n  }\n\n  HeaderFocus.prototype.getTable = function () {\n    return this.parent.isFrozenGrid() ? this.parent.getHeaderContent().querySelector('.e-movableheader .e-table') : this.parent.getHeaderTable();\n  };\n\n  HeaderFocus.prototype.onClick = function (e) {\n    var target = e.target;\n    this.target = target;\n    target = target.classList.contains('e-headercell') ? target : closest(target, 'th');\n\n    if (!target && this.parent.frozenRows !== 0) {\n      target = e.target.classList.contains(literals.rowCell) ? e.target : closest(e.target, 'td');\n    }\n\n    if (e.target.classList.contains('e-columnheader') || e.target.querySelector('.e-stackedheadercell')) {\n      return false;\n    }\n\n    if (!target) {\n      return;\n    }\n\n    var _a = [target.parentElement.rowIndex, target.cellIndex],\n        rowIndex = _a[0],\n        cellIndex = _a[1];\n    var val = getValue(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n\n    if (this.matrix.inValid(val)) {\n      return false;\n    }\n\n    this.matrix.select(target.parentElement.rowIndex, target.cellIndex);\n  };\n\n  HeaderFocus.prototype.getFocusInfo = function () {\n    var info = {};\n    var _a = this.matrix.current,\n        _b = _a[0],\n        rowIndex = _b === void 0 ? 0 : _b,\n        _c = _a[1],\n        cellIndex = _c === void 0 ? 0 : _c;\n    info.element = this.getTable().rows[rowIndex].cells[cellIndex];\n\n    if (!isNullOrUndefined(info.element)) {\n      info.elementToFocus = this.getFocusable(info.element);\n      info.outline = !info.element.classList.contains('e-filterbarcell');\n    }\n\n    return info;\n  };\n\n  HeaderFocus.prototype.selector = function (row, cell) {\n    return cell.visible && (cell.column.field !== undefined || cell.isTemplate || !isNullOrUndefined(cell.column.template)) || cell.column.type === 'checkbox' || cell.cellType === CellType.StackedHeader;\n  };\n\n  HeaderFocus.prototype.jump = function (action, current) {\n    var frozenSwap = this.parent.getFrozenLeftCount() && (action === 'leftArrow' || action === 'shiftLeft' && this.getGridSeletion() || action === 'shiftTab') && (current[1] === 0 || current[1] === this.matrix.matrix[current[0]].indexOf(1)) || this.parent.getFrozenMode() === 'Left' && action === 'tab' && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n    var right = (action === 'rightArrow' || action === 'shiftRight' && this.getGridSeletion() || action === 'tab') && (current[1] === this.matrix.columns || current[1] === this.matrix.matrix[current[0]].lastIndexOf(1)) || current[0] > 0 && action === 'shiftTab' && this.parent.getFrozenMode() === 'Right' && current[1] === this.matrix.matrix[current[0]].indexOf(1);\n    var frSwap = this.parent.getFrozenMode() === literals.leftRight && right;\n\n    if (this.parent.getFrozenMode() === 'Right') {\n      frozenSwap = right;\n    }\n\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n    var isLastCell;\n    var lastRow;\n    var headerSwap = frozenSwap && !(this.parent.getFrozenMode() === 'Left' && action === 'tab' && current[0] === this.matrix.matrix.length - 1) || frSwap;\n    var fMatrix = this.parent.focusModule.fHeader && this.parent.focusModule.fHeader.matrix.matrix;\n    var isPresent = fMatrix && !isNullOrUndefined(fMatrix[current[0]]);\n\n    if (this.parent.enableHeaderFocus && action === 'tab') {\n      lastRow = this.matrix.matrix.length - 1 === current[0];\n      isLastCell = current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n\n      if (isLastCell) {\n        if (!lastRow) {\n          this.matrix.current[0] = this.matrix.current[0] + 1;\n        } else {\n          this.matrix.current[0] = 0;\n        }\n\n        this.matrix.current[1] = -1;\n      }\n\n      if (this.parent.isFrozenGrid() && lastRow && isLastCell) {\n        frozenSwap = true;\n        headerSwap = false;\n      }\n    }\n\n    if (action === 'tab' && this.parent.getFrozenMode() === 'Left' && current[0] === this.matrix.matrix.length - 1 && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1)) {\n      this.matrix.current[0] = -1;\n    }\n\n    return {\n      swap: (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1 || isPresent && (frozenSwap || frSwap) || action === 'tab' && lastRow && isLastCell,\n      toHeader: headerSwap,\n      toFrozen: frozenSwap,\n      toFrozenRight: frSwap\n    };\n  };\n\n  HeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n\n    var current1 = [];\n\n    if (this.parent.getFrozenMode() === 'Right' || this.parent.getFrozenMode() === literals.leftRight) {\n      if (action === 'leftArrow' || action === 'shiftLeft' && this.getGridSeletion() || action === 'shiftTab') {\n        current1[0] = previous[0];\n        current1[1] = this.matrix.matrix[current1[0]].length;\n      }\n\n      if (this.parent.getFrozenMode() === literals.leftRight && (action === 'rightArrow' || action === 'shiftRight' && this.getGridSeletion() || action === 'tab')) {\n        current1[0] = previous[0];\n        current1[1] = -1;\n      }\n    } else if (action === 'rightArrow' || action === 'shiftRight' && this.getGridSeletion() || action === 'tab') {\n      current1[0] = previous[0];\n      current1[1] = -1;\n    }\n\n    if (action === 'upArrow' || action === 'shiftEnter') {\n      current1[0] = this.matrix.matrix.length;\n      current1[1] = previous[1];\n    }\n\n    if (this.parent.getFrozenMode() === 'Left' && action === 'shiftTab') {\n      current1[0] = previous[0] === -1 ? this.matrix.matrix.length - 1 : previous[0] - 1;\n      current1[1] = this.matrix.matrix[current1[0]].length;\n    }\n\n    if (this.parent.getFrozenMode() === 'Right' && action === 'tab') {\n      current1[0] = previous[0] + 1;\n      current1[1] = -1;\n    }\n\n    return current1;\n  };\n\n  HeaderFocus.prototype.generateRows = function (rows) {\n    var length = this.matrix.matrix.length;\n\n    if (this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar') {\n      this.matrix.rows = ++this.matrix.rows;\n      var cells = rows[0].cells;\n      var incrementNumber = 0;\n      var headerTable = this.getHeaderType() === 'FixedHeaderFocus' && this.parent.getFrozenMode() !== 'Right' ? literals.frozenLeft : this.getHeaderType() === 'FixedHeaderFocus' || this.getHeaderType() === 'FixedRightHeaderFocus' ? literals.frozenRight : 'movable';\n\n      for (var i = 0; i < cells.length; i++) {\n        if (cells[i].column && cells[i].column.columns) {\n          incrementNumber = this.checkFilterColumn(cells[i].column.columns, length, incrementNumber, headerTable);\n        } else {\n          if (!this.parent.isFrozenGrid() || this.parent.isFrozenGrid() && cells[i].column.freezeTable === headerTable) {\n            this.matrix.set(length, incrementNumber, cells[i].visible && cells[i].column.allowFiltering !== false);\n            incrementNumber++;\n          }\n        }\n      }\n    }\n  };\n\n  HeaderFocus.prototype.checkFilterColumn = function (rowColumns, rowIndex, columnIndex, headerTable) {\n    var columns = rowColumns;\n    var incrementNumber = columnIndex;\n\n    for (var i = 0; i < columns.length; i++) {\n      if (columns[i].columns) {\n        incrementNumber = this.checkFilterColumn(columns[i].columns, rowIndex, incrementNumber, headerTable);\n      } else {\n        if (!this.parent.isFrozenGrid() || this.parent.isFrozenGrid() && columns[i].freezeTable === headerTable) {\n          this.matrix.set(rowIndex, incrementNumber, columns[i].visible && columns[i].allowFiltering !== false);\n          incrementNumber++;\n        }\n      }\n    }\n\n    return incrementNumber;\n  };\n\n  HeaderFocus.prototype.getInfo = function (e) {\n    return extend(_super.prototype.getInfo.call(this, e), {\n      isContent: false,\n      isHeader: true\n    });\n  };\n\n  HeaderFocus.prototype.validator = function () {\n    return function () {\n      return true;\n    };\n  };\n\n  HeaderFocus.prototype.shouldFocusChange = function (e) {\n    var _a = this.matrix.current,\n        rowIndex = _a[0],\n        columnIndex = _a[1];\n\n    if (rowIndex < 0 || columnIndex < 0) {\n      return true;\n    }\n\n    var cell = getValue(rowIndex + \".cells.\" + columnIndex, this.getTable().rows);\n\n    if (!cell) {\n      return true;\n    }\n\n    return e.action === 'enter' || e.action === 'altDownArrow' ? !cell.classList.contains('e-headercell') : true;\n  };\n\n  HeaderFocus.prototype.getHeaderType = function () {\n    return 'HeaderFocus';\n  };\n\n  return HeaderFocus;\n}(ContentFocus);\n\nexport { HeaderFocus };\n\nvar FixedContentFocus =\n/** @class */\nfunction (_super) {\n  __extends(FixedContentFocus, _super);\n\n  function FixedContentFocus() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  FixedContentFocus.prototype.getTable = function () {\n    return this.parent.getContent().querySelector('.e-frozencontent .e-table');\n  };\n\n  FixedContentFocus.prototype.jump = function (action, current) {\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n    var toHeader = (action === 'upArrow' || enterFrozen) && current[0] === 0 || action === 'shiftTab' && this.parent.getFrozenMode() !== 'Right' && current[0] === 0 && current[1] === this.matrix.matrix[current[0]].indexOf(1);\n    var fSwap = (action === 'upArrow' || enterFrozen) && current[0] === 0;\n    var frSwap = action === 'shiftTab' && this.parent.getFrozenMode() === literals.leftRight && current[1] === this.matrix.matrix[current[0]].indexOf(1);\n\n    if (this.parent.getFrozenMode() === 'Right') {\n      var swap = toHeader || (action === 'shiftTab' || action === 'leftArrow') && current[1] === 0 || action === 'tab' && current[0] < this.matrix.matrix.length - 1 && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n      return {\n        swap: swap,\n        toHeader: toHeader,\n        toFrozen: fSwap\n      };\n    }\n\n    if (action === 'shiftTab' && current[0] === 0 && current[1] === this.matrix.matrix[current[0]].indexOf(1)) {\n      this.matrix.current[0] = -1;\n    }\n\n    return {\n      swap: toHeader || (action === 'tab' || action === 'rightArrow') && current[1] === this.matrix.columns || action === 'shiftTab' && current[1] === this.matrix.matrix[current[0]].indexOf(1),\n      toHeader: toHeader,\n      toFrozen: fSwap,\n      toFrozenRight: frSwap\n    };\n  };\n\n  FixedContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n\n    var current2 = [];\n\n    if (this.parent.getFrozenMode() === 'Right') {\n      if (action === 'rightArrow' || action === 'tab') {\n        current2[0] = previous[0];\n        current2[1] = -1;\n      }\n\n      if (action === 'shiftTab') {\n        current2[0] = previous[0] - 1;\n        current2[1] = this.matrix.matrix[current2[0]].length;\n      }\n    } else {\n      if (action === 'tab' && this.parent.enableHeaderFocus) {\n        current2[0] = previous[0];\n        current2[1] = -1;\n      }\n\n      if (action === 'leftArrow' || action === 'shiftTab') {\n        current2[0] = previous[0];\n        current2[1] = active.matrix.columns + 1;\n      }\n    }\n\n    if (action === 'downArrow' || action === 'enter') {\n      current2[0] = -1;\n      current2[1] = previous[1];\n    }\n\n    if (action === 'tab' && this.parent.getFrozenMode() !== 'Right') {\n      current2[0] = previous[0] + 1;\n      current2[1] = -1;\n    }\n\n    return current2;\n  };\n\n  return FixedContentFocus;\n}(ContentFocus);\n\nexport { FixedContentFocus };\n\nvar FixedHeaderFocus =\n/** @class */\nfunction (_super) {\n  __extends(FixedHeaderFocus, _super);\n\n  function FixedHeaderFocus() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  FixedHeaderFocus.prototype.jump = function (action, current) {\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n    var hMatrix = this.parent.focusModule.header && this.parent.focusModule.header.matrix.matrix;\n    var isPresent = hMatrix && !isNullOrUndefined(hMatrix[current[0]]);\n\n    if (this.parent.getFrozenMode() === 'Right') {\n      var frSwap_1 = (action === 'leftArrow' || action === 'shiftLeft' && this.getGridSeletion() || action === 'shiftTab') && (current[1] === 0 || current[1] === this.matrix.matrix[current[0]].indexOf(1)) || current[0] < this.matrix.matrix.length - 1 && action === 'tab' && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n      var swap = (action === 'downArrow' || enterFrozen || action === 'tab' && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1)) && current[0] === this.matrix.matrix.length - 1 || isPresent && frSwap_1;\n      var toFrozen = (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1;\n\n      if (action === 'tab' && current[0] === this.matrix.matrix.length - 1 && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1)) {\n        this.matrix.current[0] = -1;\n      }\n\n      return {\n        swap: swap,\n        toHeader: frSwap_1,\n        toFrozen: toFrozen\n      };\n    }\n\n    var frSwap = current[0] > 0 && action === 'shiftTab' && this.parent.getFrozenMode() === literals.leftRight && current[1] === this.matrix.matrix[current[0]].indexOf(1);\n    return {\n      swap: (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1 || (action === 'rightArrow' || action === 'shiftRight' && this.getGridSeletion() || action === 'tab') && (current[1] === this.matrix.columns || current[1] === this.matrix.matrix[current[0]].lastIndexOf(1)) && isPresent || action === 'tab' && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1) || action === 'shiftTab' && current[1] === this.matrix.matrix[current[0]].indexOf(1) && current[0] > 0,\n      toHeader: (action === 'rightArrow' || action === 'shiftRight' && this.getGridSeletion() || action === 'tab') && (current[1] === this.matrix.columns || current[1] === this.matrix.matrix[current[0]].lastIndexOf(1)) || action === 'tab' && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1) || action === 'shiftTab' && current[1] === this.matrix.matrix[current[0]].indexOf(1) && current[0] > 0,\n      toFrozen: (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1,\n      toFrozenRight: frSwap\n    };\n  };\n\n  FixedHeaderFocus.prototype.getTable = function () {\n    return this.parent.getHeaderContent().querySelector('.e-frozenheader .e-table');\n  };\n\n  FixedHeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n\n    var current3 = [];\n\n    if (this.parent.getFrozenMode() === 'Right') {\n      if (action === 'rightArrow' || action === 'shiftRight' && this.getGridSeletion() || action === 'tab') {\n        current3[0] = previous[0];\n        current3[1] = -1;\n      }\n\n      if (action === 'shiftTab') {\n        current3[0] = previous[0] === -1 ? this.matrix.matrix.length - 1 : previous[0] - 1;\n        current3[1] = this.matrix.matrix[current3[0]].length;\n      }\n    } else {\n      if (action === 'leftArrow' || action === 'shiftLeft' && this.getGridSeletion() || action === 'shiftTab') {\n        current3[0] = previous[0];\n        current3[1] = this.matrix.matrix[current3[0]].length;\n      }\n    }\n\n    if (action === 'upArrow' || action === 'shiftEnter') {\n      current3[0] = this.matrix.matrix.length;\n      current3[1] = previous[1];\n    }\n\n    if (action === 'tab' && this.parent.getFrozenMode() !== 'Right') {\n      current3[0] = previous[0] + 1;\n      current3[1] = -1;\n    }\n\n    return current3;\n  };\n\n  FixedHeaderFocus.prototype.getHeaderType = function () {\n    return 'FixedHeaderFocus';\n  };\n\n  return FixedHeaderFocus;\n}(HeaderFocus);\n\nexport { FixedHeaderFocus };\n/** @hidden */\n\nvar SearchBox =\n/** @class */\nfunction () {\n  function SearchBox(searchBox) {\n    this.searchBox = searchBox;\n  }\n\n  SearchBox.prototype.searchFocus = function (args) {\n    args.target.parentElement.classList.add('e-input-focus');\n\n    if (args.target.classList.contains('e-input') && args.target.classList.contains('e-search') && args.target.value) {\n      args.target.parentElement.querySelector('.e-clear-icon').classList.remove('e-clear-icon-hide');\n    }\n  };\n\n  SearchBox.prototype.searchBlur = function (args) {\n    args.target.parentElement.classList.remove('e-input-focus');\n\n    if (args.target.classList.contains('e-search') && args.relatedTarget && !args.relatedTarget.classList.contains('e-sicon e-clear-icon') && !args.relatedTarget.classList.contains('e-sicon')) {\n      args.target.parentElement.querySelector('.e-clear-icon').classList.add('e-clear-icon-hide');\n    }\n  };\n\n  SearchBox.prototype.wireEvent = function () {\n    if (this.searchBox) {\n      EventHandler.add(this.searchBox, 'focus', this.searchFocus, this);\n      EventHandler.add(this.searchBox, 'blur', this.searchBlur, this);\n    }\n  };\n\n  SearchBox.prototype.unWireEvent = function () {\n    if (this.searchBox) {\n      EventHandler.remove(this.searchBox, 'focus', this.searchFocus);\n      EventHandler.remove(this.searchBox, 'blur', this.searchBlur);\n    }\n  };\n\n  return SearchBox;\n}();\n\nexport { SearchBox };\n\nvar FixedRightContentFocus =\n/** @class */\nfunction (_super) {\n  __extends(FixedRightContentFocus, _super);\n\n  function FixedRightContentFocus() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  FixedRightContentFocus.prototype.getTable = function () {\n    return this.parent.getContent().querySelector('.e-frozen-right-content .e-table');\n  };\n\n  FixedRightContentFocus.prototype.jump = function (action, current) {\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n    var toHeader = (action === 'upArrow' || enterFrozen) && current[0] === 0;\n    var toFrozenSwap = this.parent.getFrozenMode() === literals.leftRight && action === 'tab' && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n    return {\n      swap: toHeader || (action === 'shiftTab' || action === 'leftArrow') && current[1] === 0 || action === 'tab' && current[0] < this.matrix.matrix.length - 1 && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1),\n      toHeader: toHeader,\n      toFrozenRight: toHeader,\n      toFrozen: toFrozenSwap\n    };\n  };\n\n  FixedRightContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n\n    var current2 = [];\n\n    if (action === 'rightArrow' || action === 'tab') {\n      current2[0] = previous[0];\n      current2[1] = -1;\n    }\n\n    if (action === 'downArrow' || action === 'enter') {\n      current2[0] = -1;\n      current2[1] = previous[1];\n    }\n\n    if (action === 'shiftTab') {\n      current2[0] = previous[0] - 1;\n      current2[1] = this.matrix.matrix[current2[0]].length;\n    }\n\n    return current2;\n  };\n\n  return FixedRightContentFocus;\n}(ContentFocus);\n\nexport { FixedRightContentFocus };\n\nvar FixedRightHeaderFocus =\n/** @class */\nfunction (_super) {\n  __extends(FixedRightHeaderFocus, _super);\n\n  function FixedRightHeaderFocus() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  FixedRightHeaderFocus.prototype.jump = function (action, current) {\n    var headerMat = this.parent.focusModule.header && this.parent.focusModule.header.matrix.matrix;\n    var isPresent = headerMat && !isNullOrUndefined(headerMat[current[0]]);\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n    var frozenSwap = (action === 'leftArrow' || action === 'shiftLeft' && this.getGridSeletion() || action === 'shiftTab') && (current[1] === 0 || current[1] === this.matrix.matrix[current[0]].indexOf(1)) || current[0] < this.matrix.matrix.length - 1 && action === 'tab' && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n    var swap = (action === 'downArrow' || enterFrozen || action === 'tab' && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1)) && current[0] === this.matrix.matrix.length - 1 || isPresent && frozenSwap;\n    var fSwap = action === 'tab' && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n    var frSwap = (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1;\n\n    if (action === 'tab' && current[0] === this.matrix.matrix.length - 1 && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1)) {\n      this.matrix.current[0] = -1;\n    }\n\n    return {\n      swap: swap,\n      toHeader: frozenSwap,\n      toFrozen: fSwap,\n      toFrozenRight: frSwap\n    };\n  };\n\n  FixedRightHeaderFocus.prototype.getTable = function () {\n    return this.parent.getHeaderContent().querySelector('.e-frozen-right-header .e-table');\n  };\n\n  FixedRightHeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n\n    var current3 = [];\n\n    if (action === 'rightArrow' || action === 'shiftRight' && this.getGridSeletion() || action === 'tab') {\n      current3[0] = previous[0];\n      current3[1] = -1;\n    }\n\n    if (action === 'upArrow' || action === 'shiftEnter') {\n      current3[0] = this.matrix.matrix.length;\n      current3[1] = previous[1];\n    }\n\n    if (action === 'shiftTab') {\n      current3[0] = previous[0] === -1 ? this.matrix.matrix.length - 1 : previous[0] - 1;\n      current3[1] = this.matrix.matrix[current3[0]].length;\n    }\n\n    return current3;\n  };\n\n  FixedRightHeaderFocus.prototype.getHeaderType = function () {\n    return 'FixedRightHeaderFocus';\n  };\n\n  return FixedRightHeaderFocus;\n}(HeaderFocus);\n\nexport { FixedRightHeaderFocus };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","EventHandler","getValue","closest","isNullOrUndefined","addClass","removeClass","extend","Browser","CellType","event","Row","RowModelGenerator","parentsUntil","addRemoveEventListener","findCellIndex","literals","FocusStrategy","parent","currentInfo","oneTime","swap","isInfiniteScroll","forget","skipFocus","focusByClick","prevIndexes","refMatrix","refreshMatrix","actions","isVirtualScroll","rowModelGen","addEventListener","focusCheck","e","target","classList","contains","onFocus","isDestroyed","isDevice","enableVirtualization","setActive","enableHeaderFocus","frozenRows","isFrozenGrid","getCurrentViewRecords","length","editSettings","mode","editModule","getBatchChanges","addedRecords","getContent","matrix","generate","generateRows","rows","isDataRow","selector","current","get","validator","select","element","focus","passiveFocus","skipAction","onBlur","isEdit","relatedTarget","matches","parseInt","getAttribute","removeFocus","setLastContentCellTabIndex","tabIndex","contentTable","getContentTable","lastCell","lastElementChild","onClick","force","isContent","gridContent","isHeader","gridHeader","isFrozen","frozenContent","frozenHeader","isFrozenRight","getFrozenMode","leftRight","content","clearOutline","beforeArgs","cancel","byKey","byClick","clickArgs","notify","beforeCellFocused","returnVal","onKeyPress","allowPaging","pagerElement","pagerModule","pagerObj","focusablePagerElements","getFocusablePagerElements","childGrid","allowToPaging","checkPagerHasFocus","action","lastHeaderCellIndex","active","preventDefault","pageSettings","pageSizes","getDropDownPage","changePagerFocus","parentCell","keyCode","shiftKey","getFocusedElement","setPagerFocus","checkFirstPagerFocus","lastRow","lastColumn","columns","skipOn","slice","call","setLastContentCellActive","focusOutFromChildGrid","allowGrouping","groupModule","focusableGroupedItems","getFocusableGroupedItems","focusFirstHeaderCell","toolbar","toolbarTemplate","toolbarElement","toolbarModule","focusableToolbarItems","querySelectorAll","querySelector","activeKey","keyArgs","bValue","outline","swapInfo","jump","toHeader","toFrozen","toFrozenRight","getNextCurrent","setActiveByKey","lastIdxCell","toString","nextHeaderCellIndex","firstContentCellIndex","previousCellIndex","focusOutFromHeader","clearIndicator","setPagerContainerFocus","lastContentCellIndex","parentTable","parentGrid","ej2_instances","uid","parentRows","getRows","parentRowIndex","map","m","indexOf","nextFocusCell","focusModule","previousRow","rowCells","cells","i","elementToFocus","allowAdding","th","inputTarget","document","activeElement","filterCell","lastIndexOf","id","gridChkBox","focusVirtualElement","_this","enableInfiniteScrolling","data","virtualData","isAdd","isCancel","getVirtualData","isKeyFocus","some","value","isSelected","contentModule","selectedRowIndex","keys","resetVirtualFocus","empty","preventScroll","fContent","frContent","fHeader","frHeader","header","setFocusedElement","setTimeout","virtaulCellFocus","addFocus","getFocusInfo","addOutline","info","focusHeader","resetFocus","focusContent","isFocused","cellFocused","indexes","isJump","container","getInfo","_a","rowIndex","cellIndex","focusedColumnUid","getColumnByIndex","args","FixedContentFocus","renderFrozenRightContent","FixedRightContentFocus","ContentFocus","FixedHeaderFocus","FixedRightHeaderFocus","HeaderFocus","cFocus","updateRow","isCollapseStateEnabled","filter","x","visible","isRowTemplate","rowTemplate","name","mRows","getMovableRowsObject","newMovableRows","row","clone","newFrozenRows","frRows","getFrozenRightRowsObject","newfrRows","requestType","handlerInstance","index_1","bool","getColumnIndexByUid","focusElement","cellPosition","getBoundingClientRect","gridPosition","top","left","right","Math","min","window","innerWidth","documentElement","clientWidth","bottom","innerHeight","clientHeight","add","passiveHandler","evtHandlers","keyPressed","handler","click","contentReady","partialRefresh","refreshExpandandCollapse","headerRefreshed","closeEdit","restoreFocus","filterfocus","restoreFocusWithAction","batchAdd","batchCancel","batchDelete","detailDataBound","onEmpty","internalCellFocus","filterSettings","type","removeEventListener","remove","destroy","groupSortFocus","groupSettings","showGroupedColumn","groupCancelFocus","parentElement","columnName","getPrevIndexes","forgetPrevious","focusEle","getFocusable","Matrix","set","columnIndex","allow","max","navigator","tmp","emptyTable","first","val","v","inValid","vector","index","moveTo","c","isSpanned","incrementNumber","j","column","columnsCount","rowColumns","currentColumnCount","undefined","keyActions","indexesByKey","opt","getTable","getCurrentFromAction","editNextRow","gObj","allowNextRowEdit","isLastCellPrimaryKey","visibleIndex","getColumnIndexByField","getVisibleColumns","field","cell","getElementsByClassName","rowCell","isPresent","shouldFocusChange","concat","rN","cN","table","_b","oRowIndex","oCellIndex","_c","query","isTemplate","child","types","Expand","GroupCaption","CaptionSummary","GroupSummary","isDataCell","cellType","DetailExpand","CommandColumn","edit","isDirty","nextRowFocusValidate","lastIndex","len","previousRowFocusValidate","firstIndex","frozenSwap","getFrozenLeftCount","frSwap","enterFrozen","headerSwap","isHeaderFocus","infiniteScrollSettings","enableCache","ariaRowIndex","previous","optionals","defaultLen","allowFiltering","push","apply","rIndex","cIndex","isData","isSelectable","ariaColIndex","enableLazyLoading","getDataRows","isCellWidth","width","getGridSeletion","allowSelection","selectionSettings","allowColumnSelection","_super","getHeaderContent","getHeaderTable","template","StackedHeader","isLastCell","fMatrix","current1","headerTable","getHeaderType","frozenLeft","frozenRight","checkFilterColumn","freezeTable","arguments","fSwap","current2","hMatrix","frSwap_1","current3","SearchBox","searchBox","searchFocus","searchBlur","wireEvent","unWireEvent","toFrozenSwap","headerMat"],"sources":["/home/morgan/Desktop/Projets/ENT4/Jwt-Auth-pdf/react-jwt-auth/react-jwt-auth/node_modules/@syncfusion/ej2-grids/src/grid/services/focus-strategy.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { EventHandler, getValue, closest, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, extend, Browser } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport * as event from '../base/constant';\nimport { Row } from '../models/row';\nimport { RowModelGenerator } from './row-model-generator';\nimport { parentsUntil, addRemoveEventListener, findCellIndex } from '../base/util';\nimport * as literals from '../base/string-literals';\n/**\n * FocusStrategy class\n *\n * @hidden\n */\nvar FocusStrategy = /** @class */ (function () {\n    function FocusStrategy(parent) {\n        this.currentInfo = {};\n        this.oneTime = true;\n        this.swap = {};\n        /** @hidden */\n        this.isInfiniteScroll = false;\n        this.forget = false;\n        this.skipFocus = true;\n        this.focusByClick = false;\n        this.prevIndexes = {};\n        this.refMatrix = this.refreshMatrix(true);\n        this.actions = ['downArrow', 'upArrow'];\n        this.isVirtualScroll = false;\n        this.parent = parent;\n        this.rowModelGen = new RowModelGenerator(this.parent);\n        this.addEventListener();\n    }\n    FocusStrategy.prototype.focusCheck = function (e) {\n        var target = e.target;\n        this.focusByClick = true;\n        this.skipFocus = target.classList.contains('e-grid');\n    };\n    FocusStrategy.prototype.onFocus = function (e) {\n        if (this.parent.isDestroyed || Browser.isDevice || this.parent.enableVirtualization) {\n            return;\n        }\n        this.setActive(!this.parent.enableHeaderFocus && this.parent.frozenRows === 0, this.parent.isFrozenGrid());\n        if (!this.parent.enableHeaderFocus && !this.parent.getCurrentViewRecords().length && ((this.parent.editSettings.mode !== 'Batch')\n            || (this.parent.editSettings.mode === 'Batch' && this.parent.editModule && !this.parent.editModule.getBatchChanges()[literals.addedRecords].length))) {\n            this.getContent().matrix.\n                generate(this.rowModelGen.generateRows({ rows: [new Row({ isDataRow: true })] }), this.getContent().selector, false);\n        }\n        var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator());\n        this.getContent().matrix.select(current[0], current[1]);\n        if (this.skipFocus && !(e && e.target === this.parent.element)) {\n            this.focus(e);\n            this.skipFocus = false;\n        }\n    };\n    FocusStrategy.prototype.passiveFocus = function (e) {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        if (e.target && e.target.classList.contains('e-detailcell')) {\n            this.currentInfo.skipAction = false;\n            addClass([this.currentInfo.element], ['e-focused', 'e-focus']);\n        }\n    };\n    FocusStrategy.prototype.onBlur = function (e) {\n        if ((this.parent.isEdit || e && (!e.relatedTarget || closest(e.relatedTarget, '.e-grid'))\n            && !(this.parent.element.classList.contains('e-childgrid') && !this.parent.element.matches(':focus-within')))\n            && !(isNullOrUndefined(e.relatedTarget) && parseInt(e.target.getAttribute('aria-colindex'), 10) === 0 &&\n                parseInt(e.target.getAttribute('index'), 10) === 0)) {\n            return;\n        }\n        this.removeFocus();\n        this.skipFocus = true;\n        this.currentInfo.skipAction = false;\n        this.setLastContentCellTabIndex();\n        this.parent.element.tabIndex = 0;\n    };\n    FocusStrategy.prototype.setLastContentCellTabIndex = function () {\n        var contentTable = this.parent.getContentTable();\n        var lastCell = contentTable.rows[contentTable.rows.length - 1].lastElementChild;\n        lastCell.tabIndex = 0;\n    };\n    FocusStrategy.prototype.onClick = function (e, force) {\n        if (parentsUntil(e.target, 'e-filterbarcell') && (parentsUntil(e.target, 'e-multiselect') ||\n            e.target.classList.contains('e-input-group-icon'))) {\n            return;\n        }\n        var isContent = !isNullOrUndefined(closest(e.target, '.' + literals.gridContent));\n        var isHeader = !isNullOrUndefined(closest(e.target, '.' + literals.gridHeader));\n        isContent = isContent && isHeader ? !isContent : isContent;\n        var isFrozen = !isNullOrUndefined(closest(e.target, '.' + literals.frozenContent)) ||\n            !isNullOrUndefined(closest(e.target, '.' + literals.frozenHeader));\n        var isFrozenRight = false;\n        if (this.parent.getFrozenMode() === literals.leftRight) {\n            isFrozenRight = !isNullOrUndefined(closest(e.target, '.e-frozen-right-content')) ||\n                !isNullOrUndefined(closest(e.target, '.e-frozen-right-header'));\n            isFrozen = isFrozen && !isFrozenRight;\n        }\n        if (!isContent && isNullOrUndefined(closest(e.target, '.' + literals.gridHeader)) ||\n            e.target.classList.contains(literals.content) ||\n            !isNullOrUndefined(closest(e.target, '.e-unboundcell'))) {\n            return;\n        }\n        this.setActive(isContent, isFrozen, isFrozenRight);\n        if (!isContent && isNullOrUndefined(closest(e.target, '.' + literals.gridHeader))) {\n            this.clearOutline();\n            return;\n        }\n        var beforeArgs = { cancel: false, byKey: false, byClick: !isNullOrUndefined(e.target), clickArgs: e };\n        this.parent.notify(event.beforeCellFocused, beforeArgs);\n        if (beforeArgs.cancel || closest(e.target, '.e-inline-edit')) {\n            return;\n        }\n        this.setActive(isContent, isFrozen, isFrozenRight);\n        if (this.getContent()) {\n            var returnVal = this.getContent().onClick(e, force);\n            if (returnVal === false) {\n                return;\n            }\n            this.focus();\n        }\n    };\n    FocusStrategy.prototype.onKeyPress = function (e) {\n        if (this.parent.allowPaging) {\n            var pagerElement = this.parent.pagerModule.pagerObj.element;\n            var focusablePagerElements = this.parent.pagerModule.pagerObj.getFocusablePagerElements(pagerElement, []);\n            if (this.parent.childGrid && this.allowToPaging(e) && focusablePagerElements.length) {\n                focusablePagerElements[0].tabIndex = 0;\n            }\n            if (this.parent.pagerModule.pagerObj.checkPagerHasFocus()) {\n                if (e.action === 'shiftTab' && focusablePagerElements.length && focusablePagerElements[0] === e.target) {\n                    this.setActive(true);\n                    var lastHeaderCellIndex = [this.active.matrix.matrix.length - 1,\n                        this.active.matrix.matrix[this.active.matrix.matrix.length - 1].length - 1];\n                    if (this.active.matrix.matrix[lastHeaderCellIndex[0]][lastHeaderCellIndex[1]] === 0) {\n                        lastHeaderCellIndex = findCellIndex(this.active.matrix.matrix, lastHeaderCellIndex, false);\n                    }\n                    this.active.matrix.current = lastHeaderCellIndex;\n                    e.preventDefault();\n                    this.focus(e);\n                    return;\n                }\n                if (!(e.action === 'tab' && this.parent.element.classList.contains('e-childgrid')\n                    && ((!this.parent.pageSettings.pageSizes && focusablePagerElements.length\n                        && focusablePagerElements[focusablePagerElements.length - 1] === e.target)\n                        || (this.parent.pagerModule.pagerObj.getDropDownPage() === e.target)))) {\n                    this.parent.pagerModule.pagerObj.changePagerFocus(e);\n                    return;\n                }\n                else {\n                    var parentCell = parentsUntil(this.parent.element, 'e-detailcell');\n                    removeClass([this.parent.element], ['e-focus']);\n                    removeClass([parentCell], ['e-focused']);\n                    parentCell.tabIndex = -1;\n                }\n            }\n            if (this.parent.pagerModule.pagerObj.element.tabIndex === 0 && (e.keyCode === 38 || (e.shiftKey && e.keyCode === 9))) {\n                e.preventDefault();\n                this.getFocusedElement().focus();\n                return;\n            }\n            else if (this.parent.pagerModule.pagerObj.element.tabIndex === 0 && e.keyCode === 9) {\n                e.preventDefault();\n                this.parent.pagerModule.pagerObj.setPagerFocus();\n                return;\n            }\n            if (this.parent.pagerModule.pagerObj.checkFirstPagerFocus()) {\n                var lastRow = this.getContent().matrix.rows;\n                var lastColumn = this.getContent().matrix.columns;\n                this.getContent().matrix.current = [lastRow, lastColumn];\n            }\n        }\n        if (this.skipOn(e)) {\n            return;\n        }\n        if (e.target && parentsUntil(e.target, 'e-gridcontent') && !this.parent.isFrozenGrid()) {\n            var rows = [].slice.call(this.parent.getContentTable().rows);\n            var lastCell = rows[rows.length - 1].lastElementChild;\n            if (e.target === lastCell) {\n                this.setActive(true);\n                this.setLastContentCellActive();\n            }\n        }\n        if (e.action === 'shiftTab' && e.target && (e.target === this.parent.element || parentsUntil(e.target, 'e-toolbar')\n            || parentsUntil(e.target, 'e-groupdroparea'))) {\n            if (e.target === this.parent.element) {\n                if (this.parent.element.classList.contains('e-childgrid')) {\n                    this.focusOutFromChildGrid(e);\n                }\n                return;\n            }\n            if (parentsUntil(e.target, 'e-groupdroparea')) {\n                e.preventDefault();\n                this.parent.element.focus();\n                return;\n            }\n            if (parentsUntil(e.target, 'e-toolbar')) {\n                e.preventDefault();\n                if (this.parent.allowGrouping) {\n                    var groupModule = this.parent.groupModule;\n                    var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n                    if (focusableGroupedItems.length > 0) {\n                        focusableGroupedItems[focusableGroupedItems.length - 1].focus();\n                    }\n                    else {\n                        groupModule.element.focus();\n                    }\n                }\n                else {\n                    this.parent.element.focus();\n                }\n                return;\n            }\n        }\n        var focusFirstHeaderCell = false;\n        if (e.action === 'tab' && e.target && (e.target === this.parent.element || parentsUntil(e.target, 'e-toolbar')\n            || parentsUntil(e.target, 'e-groupdroparea'))) {\n            if (this.parent.allowGrouping && (e.target === this.parent.element\n                || e.target.classList.contains('e-groupdroparea'))) {\n                var groupModule = this.parent.groupModule;\n                var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n                if (focusableGroupedItems.length > 0) {\n                    e.preventDefault();\n                    focusableGroupedItems[0].focus();\n                    return;\n                }\n                if (!e.target.classList.contains('e-groupdroparea')) {\n                    e.preventDefault();\n                    groupModule.element.focus();\n                    return;\n                }\n            }\n            if ((this.parent.toolbar || this.parent.toolbarTemplate) && (e.target === this.parent.element\n                || parentsUntil(e.target, 'e-groupdroparea')\n                || e.target.classList.contains('e-toolbar'))) {\n                var toolbarElement = this.parent.toolbarModule.toolbar.element;\n                var focusableToolbarItems = toolbarElement\n                    .querySelectorAll('.e-toolbar-item:not(.e-overlay):not(.e-hidden)');\n                if (focusableToolbarItems.length > 0) {\n                    e.preventDefault();\n                    focusableToolbarItems[0].querySelector('.e-btn,.e-input').focus();\n                    return;\n                }\n                if (!e.target.classList.contains('e-toolbar')) {\n                    e.preventDefault();\n                    toolbarElement.focus();\n                    return;\n                }\n            }\n            if (e.target === this.parent.element || parentsUntil(e.target, 'e-toolbar')\n                || parentsUntil(e.target, 'e-groupdroparea')) {\n                focusFirstHeaderCell = true;\n            }\n        }\n        if (focusFirstHeaderCell) {\n            if (this.parent.isFrozenGrid() && (this.parent.getFrozenMode() === 'Left'\n                || this.parent.getFrozenMode() === literals.leftRight)) {\n                this.setActive(false, true);\n            }\n            else {\n                this.setActive(false);\n            }\n            this.active.matrix.current = [0, -1];\n        }\n        this.activeKey = e.action;\n        var beforeArgs = { cancel: false, byKey: true, byClick: false, keyArgs: e };\n        this.parent.notify(event.beforeCellFocused, beforeArgs);\n        if (beforeArgs.cancel) {\n            return;\n        }\n        var bValue = this.getContent().matrix.current;\n        this.currentInfo.outline = true;\n        var swapInfo = this.getContent().jump(e.action, bValue);\n        this.swap = swapInfo;\n        if (swapInfo.swap) {\n            this.setActive(!swapInfo.toHeader, swapInfo.toFrozen, swapInfo.toFrozenRight);\n            this.getContent().matrix.current = this.getContent().getNextCurrent(bValue, swapInfo, this.active, e.action);\n            this.prevIndexes = {};\n        }\n        this.setActiveByKey(e.action, this.getContent());\n        var returnVal = this.content.lastIdxCell ? false : this.getContent().onKeyPress(e);\n        if (e.target && parentsUntil(e.target, 'e-gridheader')) {\n            if (!this.parent.isFrozenGrid()) {\n                if (e.action === 'tab' && bValue.toString() === this.active.matrix.current.toString()) {\n                    var nextHeaderCellIndex = findCellIndex(this.active.matrix.matrix, this.active.matrix.current, true);\n                    var lastHeaderCellIndex = [this.active.matrix.matrix.length - 1,\n                        this.active.matrix.matrix[this.active.matrix.matrix.length - 1].length - 1];\n                    if (this.active.matrix.matrix[lastHeaderCellIndex[0]][lastHeaderCellIndex[1]] === 0) {\n                        lastHeaderCellIndex = findCellIndex(this.active.matrix.matrix, lastHeaderCellIndex, false);\n                    }\n                    if (this.active.matrix.current.toString() === lastHeaderCellIndex.toString()) {\n                        returnVal = true;\n                        this.setActive(true);\n                        var firstContentCellIndex = [0, 0];\n                        if (this.active.matrix.matrix[firstContentCellIndex[0]][firstContentCellIndex[1]] === 0) {\n                            firstContentCellIndex = findCellIndex(this.active.matrix.matrix, [0, 0], true);\n                        }\n                        this.active.matrix.current = firstContentCellIndex;\n                    }\n                    else if (this.active.matrix.current.toString() !== nextHeaderCellIndex.toString()) {\n                        this.active.matrix.current = nextHeaderCellIndex;\n                    }\n                }\n                if (e.action === 'shiftTab' && bValue.toString() === this.active.matrix.current.toString()) {\n                    var previousCellIndex = findCellIndex(this.active.matrix.matrix, this.active.matrix.current, false);\n                    if (previousCellIndex.toString() === this.active.matrix.current.toString()) {\n                        this.focusOutFromHeader(e);\n                        return;\n                    }\n                    if (this.active.matrix.current.toString() !== previousCellIndex.toString() && !returnVal) {\n                        returnVal = true;\n                        this.active.matrix.current = previousCellIndex;\n                    }\n                }\n            }\n            else {\n                if (e.action === 'shiftTab' && bValue.toString() === this.active.matrix.current.toString() && !swapInfo.swap) {\n                    this.focusOutFromHeader(e);\n                    return;\n                }\n            }\n        }\n        if (e.target && parentsUntil(e.target, 'e-gridcontent')) {\n            if (!this.parent.isFrozenGrid()) {\n                if (e.action === 'shiftTab' && bValue.toString() === this.active.matrix.current.toString()) {\n                    var firstContentCellIndex = [0, 0];\n                    if (this.active.matrix.matrix[firstContentCellIndex[0]][firstContentCellIndex[1]] === 0) {\n                        firstContentCellIndex = findCellIndex(this.active.matrix.matrix, [0, 0], true);\n                    }\n                    if (!returnVal && firstContentCellIndex.toString() === this.active.matrix.current.toString()) {\n                        returnVal = true;\n                        this.setActive(false);\n                        this.setLastContentCellActive();\n                    }\n                }\n            }\n        }\n        if (returnVal === false) {\n            this.clearIndicator();\n            if (e.action === 'shiftTab' && bValue.toString() === [0, 0].toString()) {\n                this.parent.element.tabIndex = -1;\n            }\n            if (this.parent.allowPaging && !this.parent.pagerModule.pagerObj.checkPagerHasFocus() && this.allowToPaging(e)\n                && bValue.toString() !== [0, 0].toString()) {\n                e.preventDefault();\n                if (e.keyCode === 40) {\n                    this.parent.pagerModule.pagerObj.setPagerContainerFocus();\n                    return;\n                }\n                else if (e.keyCode === 9) {\n                    this.parent.pagerModule.pagerObj.setPagerFocus();\n                    return;\n                }\n            }\n            if (this.parent.element.classList.contains('e-childgrid')) {\n                this.focusOutFromChildGrid(e);\n            }\n            return;\n        }\n        e.preventDefault();\n        this.focus(e);\n    };\n    FocusStrategy.prototype.setLastContentCellActive = function () {\n        var lastContentCellIndex = [this.active.matrix.matrix.length - 1,\n            this.active.matrix.matrix[this.active.matrix.matrix.length - 1].length - 1];\n        if (this.active.matrix.matrix[lastContentCellIndex[0]][lastContentCellIndex[1]] === 0) {\n            lastContentCellIndex = findCellIndex(this.active.matrix.matrix, lastContentCellIndex, false);\n        }\n        this.active.matrix.current = lastContentCellIndex;\n    };\n    FocusStrategy.prototype.focusOutFromChildGrid = function (e) {\n        var parentTable = parentsUntil(this.parent.element, 'e-table');\n        var parentGrid = parentsUntil(parentTable, 'e-grid').ej2_instances[0];\n        var parentCell = parentsUntil(this.parent.element, 'e-detailcell');\n        var uid = parentsUntil(this.parent.element, 'e-detailrow').getAttribute('data-uid');\n        var parentRows = parentGrid.getRows();\n        var parentRowIndex = parentRows.map(function (m) { return m.getAttribute('data-uid'); }).indexOf(uid);\n        if (e.action === 'tab' && parentRowIndex >= parentRows.length - 1) {\n            return;\n        }\n        removeClass([this.parent.element], ['e-focus']);\n        removeClass([parentCell], ['e-focused']);\n        parentCell.tabIndex = -1;\n        e.preventDefault();\n        var nextFocusCell;\n        parentGrid.focusModule.removeFocus();\n        if (e.action === 'shiftTab') {\n            var previousRow = parentRows[parentRowIndex - 1];\n            var rowCells = previousRow.cells;\n            for (var i = rowCells.length - 1; i >= 0; i--) {\n                nextFocusCell = rowCells[i];\n                if (!nextFocusCell.classList.contains('e-hide')) {\n                    parentGrid.focusModule.active.matrix.current = [parentRowIndex - 1, i];\n                    break;\n                }\n            }\n        }\n        else {\n            nextFocusCell = parentRows[parentRowIndex + 1].cells[0];\n            parentGrid.focusModule.active.matrix.current = [parentRowIndex + 1, 0];\n        }\n        parentGrid.focusModule.currentInfo.element = nextFocusCell;\n        parentGrid.focusModule.currentInfo.elementToFocus = nextFocusCell;\n        addClass([nextFocusCell], ['e-focused', 'e-focus']);\n        nextFocusCell.tabIndex = 0;\n        nextFocusCell.focus();\n    };\n    FocusStrategy.prototype.focusOutFromHeader = function (e) {\n        e.preventDefault();\n        this.removeFocus();\n        if (this.parent.toolbar || this.parent.toolbarTemplate) {\n            var toolbarElement = this.parent.toolbarModule.toolbar.element;\n            var focusableToolbarItems = toolbarElement\n                .querySelectorAll('.e-toolbar-item:not(.e-overlay):not(.e-hidden)');\n            if (focusableToolbarItems.length > 0) {\n                focusableToolbarItems[focusableToolbarItems.length - 1].querySelector('.e-btn,.e-input').focus();\n            }\n            else {\n                toolbarElement.focus();\n            }\n            return;\n        }\n        if (this.parent.allowGrouping) {\n            var groupModule = this.parent.groupModule;\n            var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n            if (focusableGroupedItems.length > 0) {\n                focusableGroupedItems[focusableGroupedItems.length - 1].focus();\n            }\n            else {\n                groupModule.element.focus();\n            }\n            return;\n        }\n        if (this.parent.element.classList.contains('e-childgrid')) {\n            parentsUntil(this.parent.element, 'e-detailcell').focus();\n        }\n        else {\n            this.parent.element.focus();\n        }\n    };\n    FocusStrategy.prototype.allowToPaging = function (e) {\n        if (this.parent.editSettings.mode === 'Batch' && this.parent.editSettings.allowAdding && e.keyCode !== 40) {\n            return false;\n        }\n        return true;\n    };\n    FocusStrategy.prototype.skipOn = function (e) {\n        var target = e.target;\n        if (!target) {\n            return false;\n        }\n        if (this.currentInfo.skipAction) {\n            this.clearIndicator();\n            return true;\n        }\n        if (['pageUp', 'pageDown', 'altDownArrow'].indexOf(e.action) > -1) {\n            this.clearIndicator();\n            return true;\n        }\n        if (this.parent.allowGrouping) {\n            var focusableGroupedItems = this.parent.groupModule.getFocusableGroupedItems();\n            if (parentsUntil(e.target, 'e-groupheadercell')\n                && !((e.target === focusableGroupedItems[0] && e.action === 'shiftTab')\n                    || (e.target === focusableGroupedItems[focusableGroupedItems.length - 1] && e.action === 'tab'))) {\n                return true;\n            }\n        }\n        if (this.parent.toolbar || this.parent.toolbarTemplate) {\n            var toolbarElement = this.parent.toolbarModule.toolbar.element;\n            var focusableToolbarItems = toolbarElement\n                .querySelectorAll('.e-toolbar-item:not(.e-overlay):not(.e-hidden)');\n            if (parentsUntil(e.target, 'e-toolbar-item')\n                && !(focusableToolbarItems.length > 0 && ((parentsUntil(e.target, 'e-toolbar-item') === focusableToolbarItems[0] && e.action === 'shiftTab')\n                    || (parentsUntil(e.target, 'e-toolbar-item') === focusableToolbarItems[focusableToolbarItems.length - 1] && e.action === 'tab')))) {\n                return true;\n            }\n        }\n        var th = closest(target, 'th') && !closest(target, 'th').tabIndex;\n        if (e.target.classList.contains('e-filterbaroperator') && (e.keyCode === 13 || e.keyCode === 27)) {\n            var inputTarget = closest(e.target, '.e-filterbarcell');\n            inputTarget.querySelector('input').focus();\n        }\n        if (th && closest(document.activeElement, '.e-filterbarcell') !== null) {\n            this.removeFocus();\n        }\n        var filterCell = closest(document.activeElement, '.e-filterbarcell') !== null;\n        if (this.parent.enableHeaderFocus && filterCell) {\n            var matrix = this.active.matrix;\n            var current = matrix.current;\n            filterCell = matrix.matrix[current[0]].lastIndexOf(1) !== current[1];\n        }\n        return (e.action === 'delete'\n            || (this.parent.editSettings.mode !== 'Batch' && (this.parent.isEdit || ['insert', 'f2'].indexOf(e.action) > -1))\n            || ((filterCell && this.parent.enableHeaderFocus) ||\n                closest(document.activeElement, '#' + this.parent.element.id + '_searchbar') !== null\n                    && ['enter', 'leftArrow', 'rightArrow',\n                        'shiftLeft', 'shiftRight', 'ctrlPlusA'].indexOf(e.action) > -1)\n            || (closest(target, '.' + literals.gridContent) === null && closest(target, '.' + literals.gridHeader) === null\n                && !(e.target === this.parent.element || parentsUntil(e.target, 'e-toolbar')\n                    || parentsUntil(e.target, 'e-groupdroparea')))\n            || (e.action === 'space' && (!target.classList.contains(literals.gridChkBox) && closest(target, '.' + literals.gridChkBox) === null\n                && closest(target, '.e-headerchkcelldiv') === null))) || closest(target, '.e-filter-popup') !== null;\n    };\n    FocusStrategy.prototype.focusVirtualElement = function (e) {\n        var _this = this;\n        if (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) {\n            var data = { virtualData: {}, isAdd: false, isCancel: false };\n            this.parent.notify(event.getVirtualData, data);\n            var isKeyFocus = this.actions.some(function (value) { return value === _this.activeKey; });\n            var isSelected = this.parent.contentModule ?\n                this.parent.contentModule.selectedRowIndex > -1 : false;\n            if (data.isAdd || Object.keys(data.virtualData).length || isKeyFocus || data.isCancel || isSelected) {\n                this.parent.notify(event.resetVirtualFocus, { isCancel: false });\n                data.isCancel = false;\n                this.parent.contentModule.selectedRowIndex = -1;\n                if (isKeyFocus) {\n                    this.activeKey = this.empty;\n                    this.parent.notify('virtaul-key-handler', e);\n                }\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                this.currentInfo.elementToFocus.focus({ preventScroll: true });\n            }\n            else {\n                if (this.isVirtualScroll || this.isInfiniteScroll) {\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    this.currentInfo.elementToFocus.focus({ preventScroll: true });\n                }\n                else {\n                    this.currentInfo.elementToFocus.focus();\n                }\n            }\n        }\n        this.isVirtualScroll = this.isInfiniteScroll = false;\n    };\n    FocusStrategy.prototype.getFocusedElement = function () {\n        return this.currentInfo.elementToFocus;\n    };\n    FocusStrategy.prototype.getContent = function () {\n        return this.active || this.content;\n    };\n    FocusStrategy.prototype.setActive = function (content, isFrozen, isFrozenRight) {\n        this.active = content ? isFrozen ? this.fContent : isFrozenRight ? this.frContent : this.content :\n            isFrozen ? this.fHeader : isFrozenRight ? this.frHeader : this.header;\n    };\n    FocusStrategy.prototype.setFocusedElement = function (element, e) {\n        var _this = this;\n        this.currentInfo.elementToFocus = element;\n        setTimeout(function () {\n            if (!isNullOrUndefined(_this.currentInfo.elementToFocus)) {\n                if (_this.parent.enableVirtualization || _this.parent.enableInfiniteScrolling) {\n                    _this.focusVirtualElement(e);\n                }\n                else {\n                    _this.currentInfo.elementToFocus.focus();\n                }\n            }\n        }, 0);\n    };\n    FocusStrategy.prototype.focus = function (e) {\n        this.parent.notify(event.virtaulCellFocus, e);\n        this.removeFocus();\n        this.addFocus(this.getContent().getFocusInfo(), e);\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    FocusStrategy.prototype.removeFocus = function (e) {\n        if (!this.currentInfo.element) {\n            return;\n        }\n        removeClass([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focused', 'e-focus']);\n        this.currentInfo.element.tabIndex = -1;\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    FocusStrategy.prototype.addOutline = function () {\n        var info = this.getContent().getFocusInfo();\n        if (info.element) {\n            addClass([info.element], ['e-focused']);\n            addClass([info.elementToFocus], ['e-focus']);\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    FocusStrategy.prototype.focusHeader = function () {\n        this.setActive(false, this.parent.isFrozenGrid());\n        this.resetFocus();\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    FocusStrategy.prototype.focusContent = function () {\n        this.setActive(true, this.parent.isFrozenGrid());\n        this.resetFocus();\n    };\n    FocusStrategy.prototype.resetFocus = function () {\n        var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator());\n        this.getContent().matrix.select(current[0], current[1]);\n        this.focus();\n    };\n    FocusStrategy.prototype.addFocus = function (info, e) {\n        this.currentInfo = info;\n        this.currentInfo.outline = info.outline && !isNullOrUndefined(e);\n        if (this.isInfiniteScroll) {\n            this.currentInfo.outline = true;\n        }\n        if (!info.element) {\n            return;\n        }\n        var isFocused = info.elementToFocus.classList.contains('e-focus');\n        if (isFocused) {\n            return;\n        }\n        if (this.currentInfo.outline) {\n            addClass([info.element], ['e-focused']);\n        }\n        addClass([info.elementToFocus], ['e-focus']);\n        info.element.tabIndex = 0;\n        if (!isFocused) {\n            this.setFocusedElement(info.elementToFocus, e);\n        }\n        this.parent.notify(event.cellFocused, {\n            element: info.elementToFocus,\n            parent: info.element,\n            indexes: this.getContent().matrix.current,\n            byKey: !isNullOrUndefined(e),\n            byClick: isNullOrUndefined(e),\n            keyArgs: e,\n            isJump: this.swap.swap,\n            container: this.getContent().getInfo(e),\n            outline: !isNullOrUndefined(e),\n            swapInfo: this.swap\n        });\n        var _a = this.getContent().matrix.current, rowIndex = _a[0], cellIndex = _a[1];\n        this.prevIndexes = { rowIndex: rowIndex, cellIndex: cellIndex };\n        this.focusedColumnUid = this.parent.getColumnByIndex(cellIndex).uid;\n        this.focusByClick = false;\n    };\n    FocusStrategy.prototype.refreshMatrix = function (content) {\n        var _this = this;\n        return function (e) {\n            if (content && (e.args && e.args.isFrozen) && !_this.fContent) {\n                _this.fContent = new FixedContentFocus(_this.parent);\n            }\n            else if (content && !_this.frContent && (e.args && e.args.renderFrozenRightContent)) {\n                _this.frContent = new FixedRightContentFocus(_this.parent);\n            }\n            else if (content && !_this.content) {\n                _this.content = new ContentFocus(_this.parent);\n            }\n            if (!content && (e.args && e.args.isFrozen) && !_this.fHeader) {\n                _this.fHeader = new FixedHeaderFocus(_this.parent);\n            }\n            else if (!content && (e.args && e.args.renderFrozenRightContent) && !_this.frHeader) {\n                _this.frHeader = new FixedRightHeaderFocus(_this.parent);\n            }\n            else if (!content && !_this.header) {\n                _this.header = new HeaderFocus(_this.parent);\n            }\n            var cFocus = content ? (e.args && e.args.isFrozen) ? _this.fContent : (e.args && e.args.renderFrozenRightContent)\n                ? _this.frContent : _this.content : (e.args && e.args.isFrozen) ? _this.fHeader : (e.args && e.args.renderFrozenRightContent)\n                ? _this.frHeader : _this.header;\n            var rows = content ? e.rows.slice(_this.parent.frozenRows) : e.rows;\n            var updateRow = content ? e.rows.slice(0, _this.parent.frozenRows) : e.rows;\n            if (_this.parent.isCollapseStateEnabled() && content) {\n                rows = rows.filter(function (x) { return x.visible !== false; });\n            }\n            var isRowTemplate = !isNullOrUndefined(_this.parent.rowTemplate);\n            var matrix = cFocus.matrix.generate(updateRow, cFocus.selector, isRowTemplate);\n            if (e.name === 'batchAdd' && _this.parent.isFrozenGrid()) {\n                var mRows = _this.parent.getMovableRowsObject();\n                var newMovableRows = mRows.map(function (row) { return row.clone(); });\n                var newFrozenRows = rows.map(function (row) { return row.clone(); });\n                _this.fContent.matrix.generate(newFrozenRows, _this.fContent.selector, isRowTemplate);\n                _this.content.matrix.generate(newMovableRows, _this.content.selector, isRowTemplate);\n                if (_this.parent.getFrozenMode() === literals.leftRight) {\n                    var frRows = _this.parent.getFrozenRightRowsObject();\n                    var newfrRows = frRows.map(function (row) { return row.clone(); });\n                    _this.frContent.matrix.generate(newfrRows, _this.frContent.selector, isRowTemplate);\n                }\n            }\n            else {\n                cFocus.matrix.generate(rows, cFocus.selector, isRowTemplate);\n            }\n            if (!(_this.parent.isFrozenGrid() && e.args && e.args.requestType === 'sorting')) {\n                cFocus.generateRows(updateRow, {\n                    matrix: matrix, handlerInstance: (e.args && e.args.isFrozen) ? _this.fHeader\n                        : (e.args && e.args.renderFrozenRightContent) ? _this.frHeader : _this.header\n                });\n            }\n            if (!Browser.isDevice && e && e.args) {\n                if (!_this.focusByClick && e.args.requestType === 'paging' && !_this.parent.pagerModule.pagerObj.checkPagerHasFocus()) {\n                    _this.skipFocus = false;\n                    _this.parent.element.focus();\n                }\n                if (e.args.requestType === 'grouping') {\n                    _this.skipFocus = true;\n                }\n            }\n            if (e && e.args && e.args.requestType === 'virtualscroll') {\n                if (_this.currentInfo.uid) {\n                    var index_1;\n                    var bool = e.rows.some(function (row, i) {\n                        index_1 = i;\n                        return row.uid === _this.currentInfo.uid;\n                    });\n                    if (bool) {\n                        _this.content.matrix.current[0] = index_1;\n                        _this.content.matrix.current[1] = _this.parent.getColumnIndexByUid(_this.focusedColumnUid) || 0;\n                        var focusElement = _this.getContent().getFocusInfo().elementToFocus;\n                        if (focusElement) {\n                            var cellPosition = focusElement.getBoundingClientRect();\n                            var gridPosition = _this.parent.element.getBoundingClientRect();\n                            if (cellPosition.top >= 0 && cellPosition.left >= 0 &&\n                                cellPosition.right <= Math.min(gridPosition.right, window.innerWidth ||\n                                    document.documentElement.clientWidth) &&\n                                cellPosition.bottom <= Math.min(gridPosition.bottom, window.innerHeight ||\n                                    document.documentElement.clientHeight)) {\n                                _this.isVirtualScroll = true;\n                                _this.focus();\n                            }\n                        }\n                    }\n                }\n                else if (e.args.focusElement && e.args.focusElement.classList.contains('e-filtertext')) {\n                    var focusElement = _this.parent.element.querySelector('#' + e.args.focusElement.id);\n                    if (focusElement) {\n                        focusElement.focus();\n                    }\n                }\n            }\n        };\n    };\n    FocusStrategy.prototype.addEventListener = function () {\n        var _this = this;\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        EventHandler.add(this.parent.element, 'mousedown', this.focusCheck, this);\n        EventHandler.add(this.parent.element, 'focus', this.onFocus, this);\n        this.parent.element.addEventListener('focus', this.passiveHandler = function (e) { return _this.passiveFocus(e); }, true);\n        EventHandler.add(this.parent.element, 'focusout', this.onBlur, this);\n        this.evtHandlers = [{ event: event.keyPressed, handler: this.onKeyPress },\n            { event: event.click, handler: this.onClick },\n            { event: event.contentReady, handler: this.refMatrix },\n            { event: event.partialRefresh, handler: this.refMatrix },\n            { event: event.refreshExpandandCollapse, handler: this.refMatrix },\n            { event: event.headerRefreshed, handler: this.refreshMatrix() },\n            { event: event.closeEdit, handler: this.restoreFocus },\n            { event: event.restoreFocus, handler: this.restoreFocus },\n            { event: 'start-edit', handler: this.clearIndicator },\n            { event: 'start-add', handler: this.clearIndicator },\n            { event: 'sorting-complete', handler: this.restoreFocus },\n            { event: 'filtering-complete', handler: this.filterfocus },\n            { event: 'grouping-complete', handler: this.restoreFocusWithAction },\n            { event: 'ungrouping-complete', handler: this.restoreFocusWithAction },\n            { event: event.batchAdd, handler: this.refMatrix },\n            { event: event.batchCancel, handler: this.refMatrix },\n            { event: event.batchDelete, handler: this.refMatrix },\n            { event: event.detailDataBound, handler: this.refMatrix },\n            { event: event.onEmpty, handler: this.refMatrix },\n            { event: event.cellFocused, handler: this.internalCellFocus }];\n        addRemoveEventListener(this.parent, this.evtHandlers, true, this);\n    };\n    FocusStrategy.prototype.filterfocus = function () {\n        if (this.parent.filterSettings.type !== 'FilterBar') {\n            this.restoreFocus();\n        }\n    };\n    FocusStrategy.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        EventHandler.remove(this.parent.element, 'mousedown', this.focusCheck);\n        EventHandler.remove(this.parent.element, 'focus', this.onFocus);\n        EventHandler.remove(this.parent.element, 'focusout', this.onBlur);\n        this.parent.element.removeEventListener('focus', this.passiveHandler, true);\n        addRemoveEventListener(this.parent, this.evtHandlers, false);\n    };\n    FocusStrategy.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    FocusStrategy.prototype.restoreFocus = function () {\n        var groupModule = this.parent.groupModule;\n        if (this.parent.allowGrouping && groupModule && groupModule.groupSortFocus) {\n            groupModule.groupSortFocus = false;\n            return;\n        }\n        this.addFocus(this.getContent().getFocusInfo());\n    };\n    FocusStrategy.prototype.restoreFocusWithAction = function (e) {\n        if (!this.parent.enableInfiniteScrolling) {\n            var matrix = this.getContent().matrix;\n            var current = matrix.current;\n            switch (e.requestType) {\n                case 'grouping':\n                case 'ungrouping':\n                    current[1] = current.length &&\n                        !this.parent.groupSettings.showGroupedColumn && !isNullOrUndefined(matrix.matrix[current[0]]) ?\n                        matrix.matrix[current[0]].indexOf(1) : e.requestType === 'grouping' ? current[1] + 1 : current[1] - 1;\n                    break;\n            }\n            this.getContent().matrix.current = current;\n            var groupModule = this.parent.groupModule;\n            if (this.parent.allowGrouping && groupModule && groupModule.groupCancelFocus) {\n                var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n                if (focusableGroupedItems.length) {\n                    if (focusableGroupedItems[0].parentElement.getAttribute('ej-mappingname') === e.columnName) {\n                        focusableGroupedItems[3].focus();\n                    }\n                    else {\n                        focusableGroupedItems[0].focus();\n                    }\n                }\n                else {\n                    groupModule.element.focus();\n                }\n                groupModule.groupCancelFocus = false;\n                return;\n            }\n            this.addFocus(this.getContent().getFocusInfo());\n        }\n    };\n    FocusStrategy.prototype.clearOutline = function () {\n        this.getContent().matrix.current = this.getContent().matrix.get(0, -1, [0, 1], 'downArrow', this.getContent().validator());\n        this.clearIndicator();\n    };\n    FocusStrategy.prototype.clearIndicator = function () {\n        if (!this.currentInfo.element || !this.currentInfo.elementToFocus) {\n            return;\n        }\n        removeClass([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focus', 'e-focused']);\n    };\n    FocusStrategy.prototype.getPrevIndexes = function () {\n        var forget = this.forget;\n        this.forget = false;\n        return forget || !Object.keys(this.prevIndexes).length ? { rowIndex: null, cellIndex: null } : this.prevIndexes;\n    };\n    FocusStrategy.prototype.forgetPrevious = function () {\n        this.forget = true;\n    };\n    FocusStrategy.prototype.setActiveByKey = function (action, active) {\n        var _this = this;\n        if (!this.parent.isFrozenGrid() && this.parent.frozenRows === 0) {\n            return;\n        }\n        // eslint-disable-next-line prefer-const\n        var info;\n        var actions = {\n            'home': function () { return ({ toHeader: !info.isContent, toFrozen: true }); },\n            'end': function () { return ({ toHeader: !info.isContent, toFrozen: false }); },\n            'ctrlHome': function () { return ({ toHeader: true, toFrozen: _this.parent.isFrozenGrid() }); },\n            'ctrlEnd': function () { return ({ toHeader: false, toFrozen: false }); }\n        };\n        if (!(action in actions)) {\n            return;\n        }\n        info = active.getInfo();\n        var swap = actions[action]();\n        this.setActive(!swap.toHeader, swap.toFrozen);\n        this.getContent().matrix.current = active.matrix.current;\n    };\n    FocusStrategy.prototype.internalCellFocus = function (e) {\n        if (!(e.byKey && e.container.isContent && e.keyArgs.action === 'enter'\n            && (e.parent.classList.contains('e-detailcell') ||\n                e.parent.classList.contains('e-unboundcell') || e.parent.classList.contains('e-templatecell')))) {\n            return;\n        }\n        this.clearIndicator();\n        var focusEle = this.getContent().getFocusable(this.getFocusedElement());\n        this.setFocusedElement(focusEle);\n        this.currentInfo.skipAction = true;\n    };\n    return FocusStrategy;\n}());\nexport { FocusStrategy };\n/**\n * Create matrix from row collection which act as mental model for cell navigation\n *\n * @hidden\n */\nvar Matrix = /** @class */ (function () {\n    function Matrix() {\n        this.matrix = [];\n        this.current = [];\n    }\n    Matrix.prototype.set = function (rowIndex, columnIndex, allow) {\n        rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n        columnIndex = Math.max(0, Math.min(columnIndex, this.columns));\n        this.matrix[rowIndex] = this.matrix[rowIndex] || [];\n        this.matrix[rowIndex][columnIndex] = allow ? 1 : 0;\n    };\n    Matrix.prototype.get = function (rowIndex, columnIndex, navigator, action, validator) {\n        var tmp = columnIndex;\n        if (rowIndex + navigator[0] < 0) {\n            return [rowIndex, columnIndex];\n        }\n        rowIndex = Math.max(0, Math.min(rowIndex + navigator[0], this.rows));\n        var emptyTable = true;\n        if (isNullOrUndefined(this.matrix[rowIndex])) {\n            return null;\n        }\n        columnIndex = Math.max(0, Math.min(columnIndex + navigator[1], this.matrix[rowIndex].length - 1));\n        if (tmp + navigator[1] > this.matrix[rowIndex].length - 1 && validator(rowIndex, columnIndex, action)) {\n            return [rowIndex, tmp];\n        }\n        var first = this.first(this.matrix[rowIndex], columnIndex, navigator, true, action);\n        columnIndex = first === null ? tmp : first;\n        var val = getValue(rowIndex + \".\" + columnIndex, this.matrix);\n        if (rowIndex === this.rows && (action === 'downArrow' || action === 'enter')) {\n            navigator[0] = -1;\n        }\n        if (first === null) {\n            for (var i = 0; i < this.rows; i++) {\n                if (this.matrix[i].some(function (v) { return v === 1; })) {\n                    emptyTable = false;\n                    break;\n                }\n            }\n            if (emptyTable) {\n                rowIndex = this.current[0];\n                return [rowIndex, columnIndex];\n            }\n        }\n        return this.inValid(val) || !validator(rowIndex, columnIndex, action) ?\n            this.get(rowIndex, tmp, navigator, action, validator) : [rowIndex, columnIndex];\n    };\n    Matrix.prototype.first = function (vector, index, navigator, moveTo, action) {\n        if (((index < 0 || index === vector.length) && this.inValid(vector[index])\n            && (action !== 'upArrow' && action !== 'downArrow')) || !vector.some(function (v) { return v === 1; })) {\n            return null;\n        }\n        return !this.inValid(vector[index]) ? index :\n            this.first(vector, (['upArrow', 'downArrow', 'shiftUp', 'shiftDown'].indexOf(action) !== -1) ? moveTo ? 0 : ++index : index + navigator[1], navigator, false, action);\n    };\n    Matrix.prototype.select = function (rowIndex, columnIndex) {\n        rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n        columnIndex = Math.max(0, Math.min(columnIndex, this.matrix[rowIndex].length - 1));\n        this.current = [rowIndex, columnIndex];\n    };\n    Matrix.prototype.generate = function (rows, selector, isRowTemplate) {\n        this.rows = rows.length - 1;\n        this.matrix = [];\n        for (var i = 0; i < rows.length; i++) {\n            var cells = rows[i].cells.filter(function (c) { return c.isSpanned !== true; });\n            this.columns = Math.max(cells.length - 1, this.columns | 0);\n            var incrementNumber = 0;\n            for (var j = 0; j < cells.length; j++) {\n                if (cells[j].column && cells[j].column.columns) {\n                    incrementNumber = this.columnsCount(cells[j].column.columns, incrementNumber);\n                }\n                else {\n                    incrementNumber++;\n                }\n                this.set(i, j, rows[i].visible === false ? false : selector(rows[i], cells[j], isRowTemplate));\n            }\n            this.columns = Math.max(incrementNumber - 1, this.columns | 0);\n        }\n        return this.matrix;\n    };\n    Matrix.prototype.columnsCount = function (rowColumns, currentColumnCount) {\n        var columns = rowColumns;\n        var incrementNumber = currentColumnCount;\n        for (var i = 0; i < columns.length; i++) {\n            if (columns[i].columns) {\n                incrementNumber = this.columnsCount(columns[i].columns, incrementNumber);\n            }\n            else {\n                incrementNumber++;\n            }\n        }\n        return incrementNumber;\n    };\n    Matrix.prototype.inValid = function (value) {\n        return value === 0 || value === undefined;\n    };\n    return Matrix;\n}());\nexport { Matrix };\n/**\n * @hidden\n */\nvar ContentFocus = /** @class */ (function () {\n    function ContentFocus(parent) {\n        var _this = this;\n        this.matrix = new Matrix();\n        this.lastIdxCell = false;\n        this.parent = parent;\n        this.keyActions = {\n            'rightArrow': [0, 1],\n            'tab': [0, 1],\n            'leftArrow': [0, -1],\n            'shiftTab': [0, -1],\n            'upArrow': [-1, 0],\n            'downArrow': [1, 0],\n            'shiftUp': [-1, 0],\n            'shiftDown': [1, 0],\n            'shiftRight': [0, 1],\n            'shiftLeft': [0, -1],\n            'enter': [1, 0],\n            'shiftEnter': [-1, 0]\n        };\n        this.indexesByKey = function (action) {\n            var opt = {\n                'home': [_this.matrix.current[0], -1, 0, 1],\n                'end': [_this.matrix.current[0], _this.matrix.columns + 1, 0, -1],\n                'ctrlHome': [0, -1, 0, 1],\n                'ctrlEnd': [_this.matrix.rows, _this.matrix.columns + 1, 0, -1]\n            };\n            return opt[action] || null;\n        };\n    }\n    ContentFocus.prototype.getTable = function () {\n        return (this.parent.isFrozenGrid() ?\n            this.parent.getContent().querySelector('.e-movablecontent .e-table') :\n            this.parent.getContentTable());\n    };\n    ContentFocus.prototype.onKeyPress = function (e) {\n        var navigator = this.keyActions[e.action];\n        var current = this.getCurrentFromAction(e.action, navigator, e.action in this.keyActions, e);\n        if (!current) {\n            return;\n        }\n        if (((['tab', 'shiftTab'].indexOf(e.action) > -1 && this.matrix.current || []).toString() === current.toString())\n            || (this.parent.allowPaging && !this.parent.pagerModule.pagerObj.checkPagerHasFocus()\n                && this.matrix.current[0] === this.matrix.rows && ((this.parent.editSettings.mode === 'Batch'\n                && this.parent.editSettings.allowAdding && e.keyCode === 40) || (e.keyCode === 40)))) {\n            if (current.toString() === [this.matrix.rows, this.matrix.columns].toString() ||\n                current.toString() === [0, 0].toString() || (this.matrix.current[0] === this.matrix.rows &&\n                this.matrix.current.toString() === current.toString())) {\n                return false;\n            }\n            else {\n                current = this.editNextRow(current[0], current[1], e.action);\n            }\n        }\n        this.matrix.select(current[0], current[1]);\n    };\n    ContentFocus.prototype.editNextRow = function (rowIndex, cellIndex, action) {\n        var gObj = this.parent;\n        var editNextRow = gObj.editSettings.allowNextRowEdit && (gObj.isEdit || gObj.isLastCellPrimaryKey);\n        var visibleIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[0].field);\n        var cell = this.getTable().rows[rowIndex].cells[cellIndex];\n        if (action === 'tab' && editNextRow) {\n            rowIndex++;\n            var index = (this.getTable().rows[rowIndex].getElementsByClassName('e-indentcell').length +\n                this.getTable().rows[rowIndex].getElementsByClassName('e-detailrowcollapse').length);\n            cellIndex = visibleIndex + index;\n        }\n        if (action === 'shiftTab' && editNextRow) {\n            rowIndex--;\n            cellIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[gObj.getVisibleColumns().length - 1].field);\n        }\n        return !cell.classList.contains(literals.rowCell) && !cell.classList.contains('e-headercell') &&\n            !cell.classList.contains('e-groupcaption') && !cell.classList.contains('e-filterbarcell') ?\n            this.editNextRow(rowIndex, cellIndex, action) : [rowIndex, cellIndex];\n    };\n    ContentFocus.prototype.getCurrentFromAction = function (action, navigator, isPresent, e) {\n        if (navigator === void 0) { navigator = [0, 0]; }\n        if (!isPresent && !this.indexesByKey(action) || (this.matrix.current.length === 0)) {\n            return null;\n        }\n        if (!this.shouldFocusChange(e)) {\n            return this.matrix.current;\n        }\n        // eslint-disable-next-line\n        var _a = this.indexesByKey(action) || this.matrix.current.concat(navigator), rowIndex = _a[0], cellIndex = _a[1], rN = _a[2], cN = _a[3];\n        if (action === 'ctrlEnd') {\n            var lastContentCellIndex = [this.matrix.matrix.length - 1,\n                this.matrix.matrix[this.matrix.matrix.length - 1].length - 1];\n            if (this.matrix.matrix[lastContentCellIndex[0]][lastContentCellIndex[1]] === 0) {\n                lastContentCellIndex = findCellIndex(this.matrix.matrix, lastContentCellIndex, false);\n            }\n            rowIndex = lastContentCellIndex[0];\n            cellIndex = lastContentCellIndex[1] + 1;\n        }\n        var current = this.matrix.get(rowIndex, cellIndex, [rN, cN], action, this.validator());\n        return current;\n    };\n    ContentFocus.prototype.onClick = function (e, force) {\n        var target = e.target;\n        this.target = target;\n        target = (target.classList.contains(literals.rowCell) ? target : closest(target, 'td'));\n        target = target ? target : closest(e.target, 'td.e-detailrowcollapse')\n            || closest(e.target, 'td.e-detailrowexpand');\n        target = closest(e.target, 'td.e-detailcell') ?\n            isNullOrUndefined(closest(closest(e.target, '.e-grid'), 'td.e-detailcell')) ? null : target : target;\n        target = target && closest(target, 'table').classList.contains(literals.table) ? target : null;\n        if (!target) {\n            return false;\n        }\n        var _a = [target.parentElement.rowIndex, target.cellIndex], rowIndex = _a[0], cellIndex = _a[1];\n        var _b = this.matrix.current, oRowIndex = _b[0], oCellIndex = _b[1];\n        var val = getValue(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n        if (this.matrix.inValid(val) || (!force && oRowIndex === rowIndex && oCellIndex === cellIndex) ||\n            (!parentsUntil(e.target, literals.rowCell) && !parentsUntil(e.target, 'e-groupcaption'))) {\n            return false;\n        }\n        this.matrix.select(rowIndex, cellIndex);\n    };\n    ContentFocus.prototype.getFocusInfo = function () {\n        var info = {};\n        var _a = this.matrix.current, _b = _a[0], rowIndex = _b === void 0 ? 0 : _b, _c = _a[1], cellIndex = _c === void 0 ? 0 : _c;\n        this.matrix.current = [rowIndex, cellIndex];\n        info.element = !isNullOrUndefined(this.getTable().rows[rowIndex]) ? this.getTable().rows[rowIndex].cells[cellIndex] : null;\n        if (!info.element) {\n            return info;\n        }\n        info.elementToFocus = !info.element.classList.contains('e-unboundcell') && !info.element.classList.contains('e-detailcell')\n            ? this.getFocusable(info.element) : info.element;\n        info.elementToFocus = info.element.classList.contains('e-detailcell') && info.element.querySelector('.e-childgrid')\n            ? info.element.querySelector('.e-childgrid') : info.elementToFocus;\n        info.outline = true;\n        info.uid = info.element.parentElement.getAttribute('data-uid');\n        return info;\n    };\n    ContentFocus.prototype.getFocusable = function (element) {\n        var query = 'button, [href], input:not([type=\"hidden\"]), select, textarea, [tabindex]:not([tabindex=\"-1\"])';\n        var isTemplate = !isNullOrUndefined(closest(element, '.e-templatecell'));\n        if (this.parent.isEdit) {\n            query = 'input:not([type=\"hidden\"]), select:not([aria-hidden=\"true\"]), textarea';\n        }\n        var child = [].slice.call(element.querySelectorAll(query));\n        /* Select the first focusable child element\n         * if no child found then select the cell itself.\n         * if Grid is in editable state, check for editable control inside child.\n         */\n        return child.length ? isTemplate && child.length > 1 ? this.target : child[0] : element;\n    };\n    ContentFocus.prototype.selector = function (row, cell, isRowTemplate) {\n        var types = [CellType.Expand, CellType.GroupCaption, CellType.CaptionSummary, CellType.GroupSummary];\n        return ((row.isDataRow && cell.visible && (cell.isDataCell || cell.isTemplate))\n            || (row.isDataRow && cell.cellType === CellType.DetailExpand && isNullOrUndefined(cell.visible))\n            || (!row.isDataRow && types.indexOf(cell.cellType) > -1)\n            || (cell.column && cell.visible && cell.column.type === 'checkbox')\n            || (cell.cellType === CellType.CommandColumn)\n            || (row.isDataRow && isRowTemplate))\n            && !(row.edit === 'delete' && row.isDirty);\n    };\n    ContentFocus.prototype.nextRowFocusValidate = function (index) {\n        var lastIndex = index;\n        for (var i = index, len = this.matrix.rows; i <= len; i++) {\n            if (this.matrix.matrix[index].indexOf(1) === -1) {\n                index = index + 1;\n            }\n            else {\n                return index;\n            }\n        }\n        this.lastIdxCell = true;\n        return lastIndex;\n    };\n    ContentFocus.prototype.previousRowFocusValidate = function (index) {\n        var firstIndex = index;\n        for (var i = index, len = 0; i >= len; i--) {\n            if (this.matrix.matrix[index].indexOf(1) === -1) {\n                index = index - 1;\n                if (index < 0) {\n                    this.lastIdxCell = true;\n                    return firstIndex;\n                }\n            }\n            else {\n                return index;\n            }\n        }\n        return firstIndex;\n    };\n    ContentFocus.prototype.jump = function (action, current) {\n        var frozenSwap = (this.parent.getFrozenLeftCount() &&\n            ((action === 'leftArrow' || action === 'shiftTab') && current[1] === 0))\n            || (current[0] < this.matrix.matrix.length - 1 && action === 'tab' && this.parent.getFrozenMode() === 'Left'\n                && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1));\n        var right = ((action === 'rightArrow' || action === 'tab') && current[1] === this.matrix.columns)\n            || (action === 'shiftTab' && this.parent.getFrozenMode() === 'Right'\n                && current[1] === this.matrix.matrix[current[0]].indexOf(1));\n        var frSwap = this.parent.getFrozenMode() === literals.leftRight && right;\n        if (this.parent.getFrozenMode() === 'Right') {\n            frozenSwap = right;\n        }\n        this.lastIdxCell = false;\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n        var headerSwap = ((action === 'upArrow' || enterFrozen) && current[0] === 0)\n            || (action === 'shiftTab' && this.parent.getFrozenMode() === 'Right' && current[0] === 0\n                && current[1] === this.matrix.matrix[current[0]].indexOf(1));\n        if (!this.parent.isFrozenGrid() && action === 'tab' &&\n            current[1] === this.matrix.matrix[current[0]].lastIndexOf(1) && this.matrix.matrix.length - 1 !== current[0]) {\n            this.matrix.current[0] = this.nextRowFocusValidate(this.matrix.current[0] + 1);\n            this.matrix.current[1] = -1;\n            frozenSwap = this.parent.isFrozenGrid();\n        }\n        if (!this.parent.isFrozenGrid() && action === 'shiftTab' &&\n            current[0] !== 0 && this.matrix.matrix[current[0]].indexOf(1) === current[1]) {\n            this.matrix.current[0] = this.previousRowFocusValidate(this.matrix.current[0] - 1);\n            this.matrix.current[1] = this.matrix.matrix[current[0]].length;\n        }\n        var isHeaderFocus = false;\n        var row = document.activeElement.parentElement;\n        if ((this.parent.enableVirtualization || this.parent.infiniteScrollSettings.enableCache)\n            && row.classList.contains(literals.row)) {\n            var rowIndex = parseInt(row.getAttribute(literals.ariaRowIndex), 10);\n            isHeaderFocus = rowIndex > 0;\n        }\n        if (action === 'shiftTab' && this.parent.getFrozenMode() === 'Right' && current[0] === 0\n            && current[1] === this.matrix.matrix[current[0]].indexOf(1)) {\n            this.matrix.current[0] = -1;\n        }\n        var info = {\n            swap: !isHeaderFocus ? ((action === 'upArrow' || enterFrozen) && current[0] === 0) || frozenSwap || frSwap : false,\n            toHeader: headerSwap,\n            toFrozen: frozenSwap,\n            toFrozenRight: frSwap\n        };\n        return info;\n    };\n    ContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current = [];\n        if (this.parent.getFrozenMode() === 'Right' || this.parent.getFrozenMode() === literals.leftRight) {\n            if (action === 'leftArrow' || action === 'shiftTab') {\n                current[0] = previous[0];\n                current[1] = this.matrix.matrix[current[0]].length;\n            }\n            if (this.parent.getFrozenMode() === literals.leftRight && (action === 'rightArrow' || action === 'tab')) {\n                current[0] = previous[0];\n                current[1] = -1;\n            }\n            if (this.parent.getFrozenMode() === 'Right' && action === 'tab') {\n                current[0] = previous[0] + 1;\n                current[1] = -1;\n            }\n        }\n        else if (action === 'rightArrow' || action === 'tab') {\n            current[0] = previous[0];\n            current[1] = -1;\n        }\n        if (action === 'downArrow' || action === 'enter') {\n            current[0] = -1;\n            current[1] = previous[1];\n        }\n        if (action === 'shiftTab' && this.parent.getFrozenMode() === 'Left') {\n            current[0] = previous[0] - 1;\n            current[1] = this.matrix.matrix[current[0]].length;\n        }\n        return current;\n    };\n    ContentFocus.prototype.generateRows = function (rows, optionals) {\n        var _a;\n        var matrix = optionals.matrix, handlerInstance = optionals.handlerInstance;\n        var len = handlerInstance.matrix.matrix.length;\n        var defaultLen = this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar' ? len + 1 : len;\n        handlerInstance.matrix.matrix = handlerInstance.matrix.matrix.slice(0, defaultLen); //Header matrix update.\n        handlerInstance.matrix.rows = defaultLen;\n        (_a = handlerInstance.matrix.matrix).push.apply(_a, matrix);\n        handlerInstance.matrix.rows += matrix.length;\n    };\n    ContentFocus.prototype.getInfo = function (e) {\n        var info = this.getFocusInfo();\n        var _a = this.matrix.current, rIndex = _a[0], cIndex = _a[1];\n        var isData = info.element.classList.contains(literals.rowCell);\n        var isSelectable = isData || (e && e.action !== 'enter' && (info.element.classList.contains('e-detailrowcollapse')\n            || info.element.classList.contains('e-detailrowexpand')));\n        // eslint-disable-next-line\n        var _b = [Math.min(parseInt(info.element.parentElement.getAttribute(literals.ariaRowIndex), 10), rIndex),\n            Math.min(parseInt(info.element.getAttribute(literals.ariaColIndex), 10), cIndex)], rowIndex = _b[0], cellIndex = _b[1];\n        if (this.parent.allowGrouping && this.parent.groupSettings.enableLazyLoading && isData) {\n            rowIndex = this.parent.getDataRows().indexOf(info.element.parentElement);\n        }\n        return { isContent: true, isDataCell: isData, indexes: [rowIndex, cellIndex], isSelectable: isSelectable };\n    };\n    ContentFocus.prototype.validator = function () {\n        var table = this.getTable();\n        return function (rowIndex, cellIndex, action) {\n            if (!isNullOrUndefined(table.rows[rowIndex])) {\n                var cell = void 0;\n                cellIndex = table.querySelector('.e-emptyrow') ? 0 : cellIndex;\n                if (table.rows[rowIndex].cells[0].classList.contains('e-editcell')) {\n                    cell = table.rows[rowIndex].cells[0].querySelectorAll('td')[cellIndex];\n                }\n                else {\n                    cell = table.rows[rowIndex].cells[cellIndex];\n                }\n                var isCellWidth = cell.getBoundingClientRect().width !== 0;\n                if (action === 'enter' || action === 'shiftEnter') {\n                    return isCellWidth && cell.classList.contains(literals.rowCell);\n                }\n                if ((action === 'shiftUp' || action === 'shiftDown') && cell.classList.contains(literals.rowCell)) {\n                    return isCellWidth;\n                }\n                else if (action !== 'shiftUp' && action !== 'shiftDown') {\n                    return isCellWidth;\n                }\n            }\n            return false;\n        };\n    };\n    ContentFocus.prototype.shouldFocusChange = function (e) {\n        var _a = this.matrix.current, _b = _a[0], rIndex = _b === void 0 ? -1 : _b, _c = _a[1], cIndex = _c === void 0 ? -1 : _c;\n        if (rIndex < 0 || cIndex < 0) {\n            return true;\n        }\n        var cell = getValue(rIndex + \".cells.\" + cIndex, this.getTable().rows);\n        if (!cell) {\n            return true;\n        }\n        return e.action === 'enter' || e.action === 'shiftEnter' ?\n            cell.classList.contains(literals.rowCell) && !cell.classList.contains('e-unboundcell')\n                && (!cell.classList.contains('e-templatecell') || cell.classList.contains('e-editedbatchcell'))\n                && !cell.classList.contains('e-detailcell') : true;\n    };\n    ContentFocus.prototype.getGridSeletion = function () {\n        return this.parent.allowSelection && this.parent.selectionSettings.allowColumnSelection;\n    };\n    return ContentFocus;\n}());\nexport { ContentFocus };\n/**\n * @hidden\n */\nvar HeaderFocus = /** @class */ (function (_super) {\n    __extends(HeaderFocus, _super);\n    function HeaderFocus(parent) {\n        return _super.call(this, parent) || this;\n    }\n    HeaderFocus.prototype.getTable = function () {\n        return (this.parent.isFrozenGrid() ?\n            this.parent.getHeaderContent().querySelector('.e-movableheader .e-table') :\n            this.parent.getHeaderTable());\n    };\n    HeaderFocus.prototype.onClick = function (e) {\n        var target = e.target;\n        this.target = target;\n        target = (target.classList.contains('e-headercell') ? target : closest(target, 'th'));\n        if (!target && this.parent.frozenRows !== 0) {\n            target = (e.target.classList.contains(literals.rowCell) ? e.target :\n                closest(e.target, 'td'));\n        }\n        if (e.target.classList.contains('e-columnheader') ||\n            e.target.querySelector('.e-stackedheadercell')) {\n            return false;\n        }\n        if (!target) {\n            return;\n        }\n        var _a = [target.parentElement.rowIndex, target.cellIndex], rowIndex = _a[0], cellIndex = _a[1];\n        var val = getValue(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n        if (this.matrix.inValid(val)) {\n            return false;\n        }\n        this.matrix.select(target.parentElement.rowIndex, target.cellIndex);\n    };\n    HeaderFocus.prototype.getFocusInfo = function () {\n        var info = {};\n        var _a = this.matrix.current, _b = _a[0], rowIndex = _b === void 0 ? 0 : _b, _c = _a[1], cellIndex = _c === void 0 ? 0 : _c;\n        info.element = this.getTable().rows[rowIndex].cells[cellIndex];\n        if (!isNullOrUndefined(info.element)) {\n            info.elementToFocus = this.getFocusable(info.element);\n            info.outline = !info.element.classList.contains('e-filterbarcell');\n        }\n        return info;\n    };\n    HeaderFocus.prototype.selector = function (row, cell) {\n        return (cell.visible && (cell.column.field !== undefined || cell.isTemplate || !isNullOrUndefined(cell.column.template))) ||\n            cell.column.type === 'checkbox' || cell.cellType === CellType.StackedHeader;\n    };\n    HeaderFocus.prototype.jump = function (action, current) {\n        var frozenSwap = (this.parent.getFrozenLeftCount() &&\n            (action === 'leftArrow' || (action === 'shiftLeft' && this.getGridSeletion()) || action === 'shiftTab') && (current[1] === 0\n            || current[1] === this.matrix.matrix[current[0]].indexOf(1))) || (this.parent.getFrozenMode() === 'Left' && action === 'tab'\n            && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1));\n        var right = ((action === 'rightArrow' || (action === 'shiftRight' && this.getGridSeletion())\n            || action === 'tab') && (current[1] === this.matrix.columns || current[1] === this.matrix.matrix[current[0]].lastIndexOf(1)))\n            || (current[0] > 0 && action === 'shiftTab' && this.parent.getFrozenMode() === 'Right'\n                && current[1] === this.matrix.matrix[current[0]].indexOf(1));\n        var frSwap = this.parent.getFrozenMode() === literals.leftRight && right;\n        if (this.parent.getFrozenMode() === 'Right') {\n            frozenSwap = right;\n        }\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n        var isLastCell;\n        var lastRow;\n        var headerSwap = frozenSwap && !(this.parent.getFrozenMode() === 'Left' && action === 'tab'\n            && current[0] === this.matrix.matrix.length - 1) || frSwap;\n        var fMatrix = this.parent.focusModule.fHeader && this.parent.focusModule.fHeader.matrix.matrix;\n        var isPresent = fMatrix && !isNullOrUndefined(fMatrix[current[0]]);\n        if (this.parent.enableHeaderFocus && action === 'tab') {\n            lastRow = this.matrix.matrix.length - 1 === current[0];\n            isLastCell = current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n            if (isLastCell) {\n                if (!lastRow) {\n                    this.matrix.current[0] = this.matrix.current[0] + 1;\n                }\n                else {\n                    this.matrix.current[0] = 0;\n                }\n                this.matrix.current[1] = -1;\n            }\n            if (this.parent.isFrozenGrid() && lastRow && isLastCell) {\n                frozenSwap = true;\n                headerSwap = false;\n            }\n        }\n        if (action === 'tab' && this.parent.getFrozenMode() === 'Left' && current[0] === this.matrix.matrix.length - 1\n            && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1)) {\n            this.matrix.current[0] = -1;\n        }\n        return {\n            swap: ((action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1) ||\n                (isPresent && (frozenSwap || frSwap)) || (action === 'tab' && lastRow && isLastCell),\n            toHeader: headerSwap,\n            toFrozen: frozenSwap,\n            toFrozenRight: frSwap\n        };\n    };\n    HeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current1 = [];\n        if (this.parent.getFrozenMode() === 'Right' || this.parent.getFrozenMode() === literals.leftRight) {\n            if (action === 'leftArrow' || (action === 'shiftLeft' && this.getGridSeletion()) || action === 'shiftTab') {\n                current1[0] = previous[0];\n                current1[1] = this.matrix.matrix[current1[0]].length;\n            }\n            if (this.parent.getFrozenMode() === literals.leftRight\n                && (action === 'rightArrow' || (action === 'shiftRight' && this.getGridSeletion()) || action === 'tab')) {\n                current1[0] = previous[0];\n                current1[1] = -1;\n            }\n        }\n        else if (action === 'rightArrow' || (action === 'shiftRight' && this.getGridSeletion()) || action === 'tab') {\n            current1[0] = previous[0];\n            current1[1] = -1;\n        }\n        if (action === 'upArrow' || action === 'shiftEnter') {\n            current1[0] = this.matrix.matrix.length;\n            current1[1] = previous[1];\n        }\n        if (this.parent.getFrozenMode() === 'Left' && action === 'shiftTab') {\n            current1[0] = previous[0] === -1 ? this.matrix.matrix.length - 1 : previous[0] - 1;\n            current1[1] = this.matrix.matrix[current1[0]].length;\n        }\n        if (this.parent.getFrozenMode() === 'Right' && action === 'tab') {\n            current1[0] = previous[0] + 1;\n            current1[1] = -1;\n        }\n        return current1;\n    };\n    HeaderFocus.prototype.generateRows = function (rows) {\n        var length = this.matrix.matrix.length;\n        if (this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar') {\n            this.matrix.rows = ++this.matrix.rows;\n            var cells = rows[0].cells;\n            var incrementNumber = 0;\n            var headerTable = this.getHeaderType() === 'FixedHeaderFocus' && this.parent.getFrozenMode() !== 'Right' ? literals.frozenLeft :\n                this.getHeaderType() === 'FixedHeaderFocus' || this.getHeaderType() === 'FixedRightHeaderFocus' ? literals.frozenRight : 'movable';\n            for (var i = 0; i < cells.length; i++) {\n                if (cells[i].column && cells[i].column.columns) {\n                    incrementNumber = this.checkFilterColumn(cells[i].column.columns, length, incrementNumber, headerTable);\n                }\n                else {\n                    if (!this.parent.isFrozenGrid() || (this.parent.isFrozenGrid() && cells[i].column.freezeTable === headerTable)) {\n                        this.matrix.set(length, incrementNumber, cells[i].visible && cells[i].column.allowFiltering !== false);\n                        incrementNumber++;\n                    }\n                }\n            }\n        }\n    };\n    HeaderFocus.prototype.checkFilterColumn = function (rowColumns, rowIndex, columnIndex, headerTable) {\n        var columns = rowColumns;\n        var incrementNumber = columnIndex;\n        for (var i = 0; i < columns.length; i++) {\n            if (columns[i].columns) {\n                incrementNumber = this.checkFilterColumn(columns[i].columns, rowIndex, incrementNumber, headerTable);\n            }\n            else {\n                if (!this.parent.isFrozenGrid() || (this.parent.isFrozenGrid() && columns[i].freezeTable === headerTable)) {\n                    this.matrix.set(rowIndex, incrementNumber, columns[i].visible && columns[i].allowFiltering !== false);\n                    incrementNumber++;\n                }\n            }\n        }\n        return incrementNumber;\n    };\n    HeaderFocus.prototype.getInfo = function (e) {\n        return extend(_super.prototype.getInfo.call(this, e), { isContent: false, isHeader: true });\n    };\n    HeaderFocus.prototype.validator = function () {\n        return function () { return true; };\n    };\n    HeaderFocus.prototype.shouldFocusChange = function (e) {\n        var _a = this.matrix.current, rowIndex = _a[0], columnIndex = _a[1];\n        if (rowIndex < 0 || columnIndex < 0) {\n            return true;\n        }\n        var cell = getValue(rowIndex + \".cells.\" + columnIndex, this.getTable().rows);\n        if (!cell) {\n            return true;\n        }\n        return e.action === 'enter' || e.action === 'altDownArrow' ? !cell.classList.contains('e-headercell') : true;\n    };\n    HeaderFocus.prototype.getHeaderType = function () {\n        return 'HeaderFocus';\n    };\n    return HeaderFocus;\n}(ContentFocus));\nexport { HeaderFocus };\nvar FixedContentFocus = /** @class */ (function (_super) {\n    __extends(FixedContentFocus, _super);\n    function FixedContentFocus() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    FixedContentFocus.prototype.getTable = function () {\n        return this.parent.getContent().querySelector('.e-frozencontent .e-table');\n    };\n    FixedContentFocus.prototype.jump = function (action, current) {\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n        var toHeader = ((action === 'upArrow' || enterFrozen) && current[0] === 0)\n            || (action === 'shiftTab' && this.parent.getFrozenMode() !== 'Right'\n                && current[0] === 0 && current[1] === this.matrix.matrix[current[0]].indexOf(1));\n        var fSwap = (action === 'upArrow' || enterFrozen) && current[0] === 0;\n        var frSwap = action === 'shiftTab' && this.parent.getFrozenMode() === literals.leftRight\n            && current[1] === this.matrix.matrix[current[0]].indexOf(1);\n        if (this.parent.getFrozenMode() === 'Right') {\n            var swap = toHeader || ((action === 'shiftTab' || action === 'leftArrow') && current[1] === 0)\n                || (action === 'tab' && current[0] < this.matrix.matrix.length - 1\n                    && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1));\n            return { swap: swap, toHeader: toHeader, toFrozen: fSwap };\n        }\n        if (action === 'shiftTab' && current[0] === 0 && current[1] === this.matrix.matrix[current[0]].indexOf(1)) {\n            this.matrix.current[0] = -1;\n        }\n        return {\n            swap: toHeader || ((action === 'tab' || action === 'rightArrow') && current[1] === this.matrix.columns)\n                || (action === 'shiftTab' && current[1] === this.matrix.matrix[current[0]].indexOf(1)),\n            toHeader: toHeader,\n            toFrozen: fSwap,\n            toFrozenRight: frSwap\n        };\n    };\n    FixedContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current2 = [];\n        if (this.parent.getFrozenMode() === 'Right') {\n            if (action === 'rightArrow' || action === 'tab') {\n                current2[0] = previous[0];\n                current2[1] = -1;\n            }\n            if (action === 'shiftTab') {\n                current2[0] = previous[0] - 1;\n                current2[1] = this.matrix.matrix[current2[0]].length;\n            }\n        }\n        else {\n            if (action === 'tab' && this.parent.enableHeaderFocus) {\n                current2[0] = previous[0];\n                current2[1] = -1;\n            }\n            if (action === 'leftArrow' || action === 'shiftTab') {\n                current2[0] = previous[0];\n                current2[1] = active.matrix.columns + 1;\n            }\n        }\n        if (action === 'downArrow' || action === 'enter') {\n            current2[0] = -1;\n            current2[1] = previous[1];\n        }\n        if (action === 'tab' && this.parent.getFrozenMode() !== 'Right') {\n            current2[0] = previous[0] + 1;\n            current2[1] = -1;\n        }\n        return current2;\n    };\n    return FixedContentFocus;\n}(ContentFocus));\nexport { FixedContentFocus };\nvar FixedHeaderFocus = /** @class */ (function (_super) {\n    __extends(FixedHeaderFocus, _super);\n    function FixedHeaderFocus() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    FixedHeaderFocus.prototype.jump = function (action, current) {\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n        var hMatrix = this.parent.focusModule.header && this.parent.focusModule.header.matrix.matrix;\n        var isPresent = hMatrix && !isNullOrUndefined(hMatrix[current[0]]);\n        if (this.parent.getFrozenMode() === 'Right') {\n            var frSwap_1 = ((action === 'leftArrow' || (action === 'shiftLeft' && this.getGridSeletion())\n                || action === 'shiftTab') && (current[1] === 0 || current[1] === this.matrix.matrix[current[0]].indexOf(1)))\n                || (current[0] < this.matrix.matrix.length - 1 && action === 'tab'\n                    && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1));\n            var swap = ((action === 'downArrow' || enterFrozen || (action === 'tab'\n                && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1))) && current[0] === this.matrix.matrix.length - 1) ||\n                (isPresent && frSwap_1);\n            var toFrozen = (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1;\n            if (action === 'tab' && current[0] === this.matrix.matrix.length - 1\n                && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1)) {\n                this.matrix.current[0] = -1;\n            }\n            return { swap: swap, toHeader: frSwap_1, toFrozen: toFrozen };\n        }\n        var frSwap = current[0] > 0 && action === 'shiftTab' && this.parent.getFrozenMode() === literals.leftRight\n            && current[1] === this.matrix.matrix[current[0]].indexOf(1);\n        return {\n            swap: (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1 || ((action === 'rightArrow' ||\n                (action === 'shiftRight' && this.getGridSeletion()) || action === 'tab') &&\n                (current[1] === this.matrix.columns || current[1] === this.matrix.matrix[current[0]].lastIndexOf(1)) && isPresent)\n                || (action === 'tab' && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1))\n                || (action === 'shiftTab' && current[1] === this.matrix.matrix[current[0]].indexOf(1) && current[0] > 0),\n            toHeader: (action === 'rightArrow' || (action === 'shiftRight' && this.getGridSeletion()) || action === 'tab') &&\n                (current[1] === this.matrix.columns || current[1] === this.matrix.matrix[current[0]].lastIndexOf(1))\n                || (action === 'tab' && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1))\n                || (action === 'shiftTab' && current[1] === this.matrix.matrix[current[0]].indexOf(1) && current[0] > 0),\n            toFrozen: (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1,\n            toFrozenRight: frSwap\n        };\n    };\n    FixedHeaderFocus.prototype.getTable = function () {\n        return (this.parent.getHeaderContent().querySelector('.e-frozenheader .e-table'));\n    };\n    FixedHeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current3 = [];\n        if (this.parent.getFrozenMode() === 'Right') {\n            if (action === 'rightArrow' || (action === 'shiftRight' && this.getGridSeletion()) || action === 'tab') {\n                current3[0] = previous[0];\n                current3[1] = -1;\n            }\n            if (action === 'shiftTab') {\n                current3[0] = previous[0] === -1 ? this.matrix.matrix.length - 1 : previous[0] - 1;\n                current3[1] = this.matrix.matrix[current3[0]].length;\n            }\n        }\n        else {\n            if (action === 'leftArrow' || (action === 'shiftLeft' && this.getGridSeletion()) || action === 'shiftTab') {\n                current3[0] = previous[0];\n                current3[1] = this.matrix.matrix[current3[0]].length;\n            }\n        }\n        if (action === 'upArrow' || action === 'shiftEnter') {\n            current3[0] = this.matrix.matrix.length;\n            current3[1] = previous[1];\n        }\n        if (action === 'tab' && this.parent.getFrozenMode() !== 'Right') {\n            current3[0] = previous[0] + 1;\n            current3[1] = -1;\n        }\n        return current3;\n    };\n    FixedHeaderFocus.prototype.getHeaderType = function () {\n        return 'FixedHeaderFocus';\n    };\n    return FixedHeaderFocus;\n}(HeaderFocus));\nexport { FixedHeaderFocus };\n/** @hidden */\nvar SearchBox = /** @class */ (function () {\n    function SearchBox(searchBox) {\n        this.searchBox = searchBox;\n    }\n    SearchBox.prototype.searchFocus = function (args) {\n        args.target.parentElement.classList.add('e-input-focus');\n        if (args.target.classList.contains('e-input') && args.target.classList.contains('e-search') && args.target.value) {\n            args.target.parentElement.querySelector('.e-clear-icon').classList.remove('e-clear-icon-hide');\n        }\n    };\n    SearchBox.prototype.searchBlur = function (args) {\n        args.target.parentElement.classList.remove('e-input-focus');\n        if (args.target.classList.contains('e-search') && args.relatedTarget && !(args.relatedTarget.classList.contains('e-sicon e-clear-icon'))\n            && !(args.relatedTarget.classList.contains('e-sicon'))) {\n            args.target.parentElement.querySelector('.e-clear-icon').classList.add('e-clear-icon-hide');\n        }\n    };\n    SearchBox.prototype.wireEvent = function () {\n        if (this.searchBox) {\n            EventHandler.add(this.searchBox, 'focus', this.searchFocus, this);\n            EventHandler.add(this.searchBox, 'blur', this.searchBlur, this);\n        }\n    };\n    SearchBox.prototype.unWireEvent = function () {\n        if (this.searchBox) {\n            EventHandler.remove(this.searchBox, 'focus', this.searchFocus);\n            EventHandler.remove(this.searchBox, 'blur', this.searchBlur);\n        }\n    };\n    return SearchBox;\n}());\nexport { SearchBox };\nvar FixedRightContentFocus = /** @class */ (function (_super) {\n    __extends(FixedRightContentFocus, _super);\n    function FixedRightContentFocus() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    FixedRightContentFocus.prototype.getTable = function () {\n        return this.parent.getContent().querySelector('.e-frozen-right-content .e-table');\n    };\n    FixedRightContentFocus.prototype.jump = function (action, current) {\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n        var toHeader = (action === 'upArrow' || enterFrozen) && current[0] === 0;\n        var toFrozenSwap = this.parent.getFrozenMode() === literals.leftRight && action === 'tab'\n            && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n        return {\n            swap: toHeader || ((action === 'shiftTab' || action === 'leftArrow') && current[1] === 0)\n                || (action === 'tab' && current[0] < this.matrix.matrix.length - 1\n                    && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1)),\n            toHeader: toHeader,\n            toFrozenRight: toHeader,\n            toFrozen: toFrozenSwap\n        };\n    };\n    FixedRightContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current2 = [];\n        if (action === 'rightArrow' || action === 'tab') {\n            current2[0] = previous[0];\n            current2[1] = -1;\n        }\n        if (action === 'downArrow' || action === 'enter') {\n            current2[0] = -1;\n            current2[1] = previous[1];\n        }\n        if (action === 'shiftTab') {\n            current2[0] = previous[0] - 1;\n            current2[1] = this.matrix.matrix[current2[0]].length;\n        }\n        return current2;\n    };\n    return FixedRightContentFocus;\n}(ContentFocus));\nexport { FixedRightContentFocus };\nvar FixedRightHeaderFocus = /** @class */ (function (_super) {\n    __extends(FixedRightHeaderFocus, _super);\n    function FixedRightHeaderFocus() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    FixedRightHeaderFocus.prototype.jump = function (action, current) {\n        var headerMat = this.parent.focusModule.header && this.parent.focusModule.header.matrix.matrix;\n        var isPresent = headerMat && !isNullOrUndefined(headerMat[current[0]]);\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n        var frozenSwap = (action === 'leftArrow' || (action === 'shiftLeft' && this.getGridSeletion())\n            || action === 'shiftTab') && (current[1] === 0 || current[1] === this.matrix.matrix[current[0]].indexOf(1))\n            || (current[0] < this.matrix.matrix.length - 1 && action === 'tab'\n                && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1));\n        var swap = ((action === 'downArrow' || enterFrozen || (action === 'tab'\n            && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1))) && current[0] === this.matrix.matrix.length - 1) ||\n            (isPresent && frozenSwap);\n        var fSwap = action === 'tab' && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n        var frSwap = (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1;\n        if (action === 'tab' && current[0] === this.matrix.matrix.length - 1\n            && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1)) {\n            this.matrix.current[0] = -1;\n        }\n        return { swap: swap, toHeader: frozenSwap, toFrozen: fSwap, toFrozenRight: frSwap };\n    };\n    FixedRightHeaderFocus.prototype.getTable = function () {\n        return (this.parent.getHeaderContent().querySelector('.e-frozen-right-header .e-table'));\n    };\n    FixedRightHeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current3 = [];\n        if (action === 'rightArrow' || (action === 'shiftRight' && this.getGridSeletion()) || action === 'tab') {\n            current3[0] = previous[0];\n            current3[1] = -1;\n        }\n        if (action === 'upArrow' || action === 'shiftEnter') {\n            current3[0] = this.matrix.matrix.length;\n            current3[1] = previous[1];\n        }\n        if (action === 'shiftTab') {\n            current3[0] = previous[0] === -1 ? this.matrix.matrix.length - 1 : previous[0] - 1;\n            current3[1] = this.matrix.matrix[current3[0]].length;\n        }\n        return current3;\n    };\n    FixedRightHeaderFocus.prototype.getHeaderType = function () {\n        return 'FixedRightHeaderFocus';\n    };\n    return FixedRightHeaderFocus;\n}(HeaderFocus));\nexport { FixedRightHeaderFocus };\n"],"mappings":"AAAA,IAAIA,SAAS,GAAI,QAAQ,KAAKA,SAAd,IAA6B,YAAY;EACrD,IAAIC,aAAa,GAAG,UAAUC,CAAV,EAAaC,CAAb,EAAgB;IAChCF,aAAa,GAAGG,MAAM,CAACC,cAAP,IACX;MAAEC,SAAS,EAAE;IAAb,aAA6BC,KAA7B,IAAsC,UAAUL,CAAV,EAAaC,CAAb,EAAgB;MAAED,CAAC,CAACI,SAAF,GAAcH,CAAd;IAAkB,CAD/D,IAEZ,UAAUD,CAAV,EAAaC,CAAb,EAAgB;MAAE,KAAK,IAAIK,CAAT,IAAcL,CAAd,EAAiB,IAAIA,CAAC,CAACM,cAAF,CAAiBD,CAAjB,CAAJ,EAAyBN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;IAAc,CAF9E;;IAGA,OAAOP,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAApB;EACH,CALD;;EAMA,OAAO,UAAUD,CAAV,EAAaC,CAAb,EAAgB;IACnBF,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAAb;;IACA,SAASO,EAAT,GAAc;MAAE,KAAKC,WAAL,GAAmBT,CAAnB;IAAuB;;IACvCA,CAAC,CAACU,SAAF,GAAcT,CAAC,KAAK,IAAN,GAAaC,MAAM,CAACS,MAAP,CAAcV,CAAd,CAAb,IAAiCO,EAAE,CAACE,SAAH,GAAeT,CAAC,CAACS,SAAjB,EAA4B,IAAIF,EAAJ,EAA7D,CAAd;EACH,CAJD;AAKH,CAZ2C,EAA5C;;AAaA,SAASI,YAAT,EAAuBC,QAAvB,EAAiCC,OAAjC,EAA0CC,iBAA1C,QAAmE,sBAAnE;AACA,SAASC,QAAT,EAAmBC,WAAnB,EAAgCC,MAAhC,EAAwCC,OAAxC,QAAuD,sBAAvD;AACA,SAASC,QAAT,QAAyB,cAAzB;AACA,OAAO,KAAKC,KAAZ,MAAuB,kBAAvB;AACA,SAASC,GAAT,QAAoB,eAApB;AACA,SAASC,iBAAT,QAAkC,uBAAlC;AACA,SAASC,YAAT,EAAuBC,sBAAvB,EAA+CC,aAA/C,QAAoE,cAApE;AACA,OAAO,KAAKC,QAAZ,MAA0B,yBAA1B;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIC,aAAa;AAAG;AAAe,YAAY;EAC3C,SAASA,aAAT,CAAuBC,MAAvB,EAA+B;IAC3B,KAAKC,WAAL,GAAmB,EAAnB;IACA,KAAKC,OAAL,GAAe,IAAf;IACA,KAAKC,IAAL,GAAY,EAAZ;IACA;;IACA,KAAKC,gBAAL,GAAwB,KAAxB;IACA,KAAKC,MAAL,GAAc,KAAd;IACA,KAAKC,SAAL,GAAiB,IAAjB;IACA,KAAKC,YAAL,GAAoB,KAApB;IACA,KAAKC,WAAL,GAAmB,EAAnB;IACA,KAAKC,SAAL,GAAiB,KAAKC,aAAL,CAAmB,IAAnB,CAAjB;IACA,KAAKC,OAAL,GAAe,CAAC,WAAD,EAAc,SAAd,CAAf;IACA,KAAKC,eAAL,GAAuB,KAAvB;IACA,KAAKZ,MAAL,GAAcA,MAAd;IACA,KAAKa,WAAL,GAAmB,IAAInB,iBAAJ,CAAsB,KAAKM,MAA3B,CAAnB;IACA,KAAKc,gBAAL;EACH;;EACDf,aAAa,CAAClB,SAAd,CAAwBkC,UAAxB,GAAqC,UAAUC,CAAV,EAAa;IAC9C,IAAIC,MAAM,GAAGD,CAAC,CAACC,MAAf;IACA,KAAKV,YAAL,GAAoB,IAApB;IACA,KAAKD,SAAL,GAAiBW,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0B,QAA1B,CAAjB;EACH,CAJD;;EAKApB,aAAa,CAAClB,SAAd,CAAwBuC,OAAxB,GAAkC,UAAUJ,CAAV,EAAa;IAC3C,IAAI,KAAKhB,MAAL,CAAYqB,WAAZ,IAA2B/B,OAAO,CAACgC,QAAnC,IAA+C,KAAKtB,MAAL,CAAYuB,oBAA/D,EAAqF;MACjF;IACH;;IACD,KAAKC,SAAL,CAAe,CAAC,KAAKxB,MAAL,CAAYyB,iBAAb,IAAkC,KAAKzB,MAAL,CAAY0B,UAAZ,KAA2B,CAA5E,EAA+E,KAAK1B,MAAL,CAAY2B,YAAZ,EAA/E;;IACA,IAAI,CAAC,KAAK3B,MAAL,CAAYyB,iBAAb,IAAkC,CAAC,KAAKzB,MAAL,CAAY4B,qBAAZ,GAAoCC,MAAvE,KAAmF,KAAK7B,MAAL,CAAY8B,YAAZ,CAAyBC,IAAzB,KAAkC,OAAnC,IAC9E,KAAK/B,MAAL,CAAY8B,YAAZ,CAAyBC,IAAzB,KAAkC,OAAlC,IAA6C,KAAK/B,MAAL,CAAYgC,UAAzD,IAAuE,CAAC,KAAKhC,MAAL,CAAYgC,UAAZ,CAAuBC,eAAvB,GAAyCnC,QAAQ,CAACoC,YAAlD,EAAgEL,MAD5I,CAAJ,EAC0J;MACtJ,KAAKM,UAAL,GAAkBC,MAAlB,CACIC,QADJ,CACa,KAAKxB,WAAL,CAAiByB,YAAjB,CAA8B;QAAEC,IAAI,EAAE,CAAC,IAAI9C,GAAJ,CAAQ;UAAE+C,SAAS,EAAE;QAAb,CAAR,CAAD;MAAR,CAA9B,CADb,EACsF,KAAKL,UAAL,GAAkBM,QADxG,EACkH,KADlH;IAEH;;IACD,IAAIC,OAAO,GAAG,KAAKP,UAAL,GAAkBC,MAAlB,CAAyBO,GAAzB,CAA6B,CAA7B,EAAgC,CAAC,CAAjC,EAAoC,CAAC,CAAD,EAAI,CAAJ,CAApC,EAA4C,IAA5C,EAAkD,KAAKR,UAAL,GAAkBS,SAAlB,EAAlD,CAAd;IACA,KAAKT,UAAL,GAAkBC,MAAlB,CAAyBS,MAAzB,CAAgCH,OAAO,CAAC,CAAD,CAAvC,EAA4CA,OAAO,CAAC,CAAD,CAAnD;;IACA,IAAI,KAAKpC,SAAL,IAAkB,EAAEU,CAAC,IAAIA,CAAC,CAACC,MAAF,KAAa,KAAKjB,MAAL,CAAY8C,OAAhC,CAAtB,EAAgE;MAC5D,KAAKC,KAAL,CAAW/B,CAAX;MACA,KAAKV,SAAL,GAAiB,KAAjB;IACH;EACJ,CAhBD;;EAiBAP,aAAa,CAAClB,SAAd,CAAwBmE,YAAxB,GAAuC,UAAUhC,CAAV,EAAa;IAChD,IAAI,KAAKhB,MAAL,CAAYqB,WAAhB,EAA6B;MACzB;IACH;;IACD,IAAIL,CAAC,CAACC,MAAF,IAAYD,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4B,cAA5B,CAAhB,EAA6D;MACzD,KAAKlB,WAAL,CAAiBgD,UAAjB,GAA8B,KAA9B;MACA9D,QAAQ,CAAC,CAAC,KAAKc,WAAL,CAAiB6C,OAAlB,CAAD,EAA6B,CAAC,WAAD,EAAc,SAAd,CAA7B,CAAR;IACH;EACJ,CARD;;EASA/C,aAAa,CAAClB,SAAd,CAAwBqE,MAAxB,GAAiC,UAAUlC,CAAV,EAAa;IAC1C,IAAI,CAAC,KAAKhB,MAAL,CAAYmD,MAAZ,IAAsBnC,CAAC,KAAK,CAACA,CAAC,CAACoC,aAAH,IAAoBnE,OAAO,CAAC+B,CAAC,CAACoC,aAAH,EAAkB,SAAlB,CAAhC,CAAD,IACpB,EAAE,KAAKpD,MAAL,CAAY8C,OAAZ,CAAoB5B,SAApB,CAA8BC,QAA9B,CAAuC,aAAvC,KAAyD,CAAC,KAAKnB,MAAL,CAAY8C,OAAZ,CAAoBO,OAApB,CAA4B,eAA5B,CAA5D,CADH,KAEG,EAAEnE,iBAAiB,CAAC8B,CAAC,CAACoC,aAAH,CAAjB,IAAsCE,QAAQ,CAACtC,CAAC,CAACC,MAAF,CAASsC,YAAT,CAAsB,eAAtB,CAAD,EAAyC,EAAzC,CAAR,KAAyD,CAA/F,IACDD,QAAQ,CAACtC,CAAC,CAACC,MAAF,CAASsC,YAAT,CAAsB,OAAtB,CAAD,EAAiC,EAAjC,CAAR,KAAiD,CADlD,CAFP,EAG6D;MACzD;IACH;;IACD,KAAKC,WAAL;IACA,KAAKlD,SAAL,GAAiB,IAAjB;IACA,KAAKL,WAAL,CAAiBgD,UAAjB,GAA8B,KAA9B;IACA,KAAKQ,0BAAL;IACA,KAAKzD,MAAL,CAAY8C,OAAZ,CAAoBY,QAApB,GAA+B,CAA/B;EACH,CAZD;;EAaA3D,aAAa,CAAClB,SAAd,CAAwB4E,0BAAxB,GAAqD,YAAY;IAC7D,IAAIE,YAAY,GAAG,KAAK3D,MAAL,CAAY4D,eAAZ,EAAnB;IACA,IAAIC,QAAQ,GAAGF,YAAY,CAACpB,IAAb,CAAkBoB,YAAY,CAACpB,IAAb,CAAkBV,MAAlB,GAA2B,CAA7C,EAAgDiC,gBAA/D;IACAD,QAAQ,CAACH,QAAT,GAAoB,CAApB;EACH,CAJD;;EAKA3D,aAAa,CAAClB,SAAd,CAAwBkF,OAAxB,GAAkC,UAAU/C,CAAV,EAAagD,KAAb,EAAoB;IAClD,IAAIrE,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,iBAAX,CAAZ,KAA8CtB,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,eAAX,CAAZ,IAC9CD,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4B,oBAA5B,CADA,CAAJ,EACwD;MACpD;IACH;;IACD,IAAI8C,SAAS,GAAG,CAAC/E,iBAAiB,CAACD,OAAO,CAAC+B,CAAC,CAACC,MAAH,EAAW,MAAMnB,QAAQ,CAACoE,WAA1B,CAAR,CAAlC;IACA,IAAIC,QAAQ,GAAG,CAACjF,iBAAiB,CAACD,OAAO,CAAC+B,CAAC,CAACC,MAAH,EAAW,MAAMnB,QAAQ,CAACsE,UAA1B,CAAR,CAAjC;IACAH,SAAS,GAAGA,SAAS,IAAIE,QAAb,GAAwB,CAACF,SAAzB,GAAqCA,SAAjD;IACA,IAAII,QAAQ,GAAG,CAACnF,iBAAiB,CAACD,OAAO,CAAC+B,CAAC,CAACC,MAAH,EAAW,MAAMnB,QAAQ,CAACwE,aAA1B,CAAR,CAAlB,IACX,CAACpF,iBAAiB,CAACD,OAAO,CAAC+B,CAAC,CAACC,MAAH,EAAW,MAAMnB,QAAQ,CAACyE,YAA1B,CAAR,CADtB;IAEA,IAAIC,aAAa,GAAG,KAApB;;IACA,IAAI,KAAKxE,MAAL,CAAYyE,aAAZ,OAAgC3E,QAAQ,CAAC4E,SAA7C,EAAwD;MACpDF,aAAa,GAAG,CAACtF,iBAAiB,CAACD,OAAO,CAAC+B,CAAC,CAACC,MAAH,EAAW,yBAAX,CAAR,CAAlB,IACZ,CAAC/B,iBAAiB,CAACD,OAAO,CAAC+B,CAAC,CAACC,MAAH,EAAW,wBAAX,CAAR,CADtB;MAEAoD,QAAQ,GAAGA,QAAQ,IAAI,CAACG,aAAxB;IACH;;IACD,IAAI,CAACP,SAAD,IAAc/E,iBAAiB,CAACD,OAAO,CAAC+B,CAAC,CAACC,MAAH,EAAW,MAAMnB,QAAQ,CAACsE,UAA1B,CAAR,CAA/B,IACApD,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4BrB,QAAQ,CAAC6E,OAArC,CADA,IAEA,CAACzF,iBAAiB,CAACD,OAAO,CAAC+B,CAAC,CAACC,MAAH,EAAW,gBAAX,CAAR,CAFtB,EAE6D;MACzD;IACH;;IACD,KAAKO,SAAL,CAAeyC,SAAf,EAA0BI,QAA1B,EAAoCG,aAApC;;IACA,IAAI,CAACP,SAAD,IAAc/E,iBAAiB,CAACD,OAAO,CAAC+B,CAAC,CAACC,MAAH,EAAW,MAAMnB,QAAQ,CAACsE,UAA1B,CAAR,CAAnC,EAAmF;MAC/E,KAAKQ,YAAL;MACA;IACH;;IACD,IAAIC,UAAU,GAAG;MAAEC,MAAM,EAAE,KAAV;MAAiBC,KAAK,EAAE,KAAxB;MAA+BC,OAAO,EAAE,CAAC9F,iBAAiB,CAAC8B,CAAC,CAACC,MAAH,CAA1D;MAAsEgE,SAAS,EAAEjE;IAAjF,CAAjB;IACA,KAAKhB,MAAL,CAAYkF,MAAZ,CAAmB1F,KAAK,CAAC2F,iBAAzB,EAA4CN,UAA5C;;IACA,IAAIA,UAAU,CAACC,MAAX,IAAqB7F,OAAO,CAAC+B,CAAC,CAACC,MAAH,EAAW,gBAAX,CAAhC,EAA8D;MAC1D;IACH;;IACD,KAAKO,SAAL,CAAeyC,SAAf,EAA0BI,QAA1B,EAAoCG,aAApC;;IACA,IAAI,KAAKrC,UAAL,EAAJ,EAAuB;MACnB,IAAIiD,SAAS,GAAG,KAAKjD,UAAL,GAAkB4B,OAAlB,CAA0B/C,CAA1B,EAA6BgD,KAA7B,CAAhB;;MACA,IAAIoB,SAAS,KAAK,KAAlB,EAAyB;QACrB;MACH;;MACD,KAAKrC,KAAL;IACH;EACJ,CAvCD;;EAwCAhD,aAAa,CAAClB,SAAd,CAAwBwG,UAAxB,GAAqC,UAAUrE,CAAV,EAAa;IAC9C,IAAI,KAAKhB,MAAL,CAAYsF,WAAhB,EAA6B;MACzB,IAAIC,YAAY,GAAG,KAAKvF,MAAL,CAAYwF,WAAZ,CAAwBC,QAAxB,CAAiC3C,OAApD;MACA,IAAI4C,sBAAsB,GAAG,KAAK1F,MAAL,CAAYwF,WAAZ,CAAwBC,QAAxB,CAAiCE,yBAAjC,CAA2DJ,YAA3D,EAAyE,EAAzE,CAA7B;;MACA,IAAI,KAAKvF,MAAL,CAAY4F,SAAZ,IAAyB,KAAKC,aAAL,CAAmB7E,CAAnB,CAAzB,IAAkD0E,sBAAsB,CAAC7D,MAA7E,EAAqF;QACjF6D,sBAAsB,CAAC,CAAD,CAAtB,CAA0BhC,QAA1B,GAAqC,CAArC;MACH;;MACD,IAAI,KAAK1D,MAAL,CAAYwF,WAAZ,CAAwBC,QAAxB,CAAiCK,kBAAjC,EAAJ,EAA2D;QACvD,IAAI9E,CAAC,CAAC+E,MAAF,KAAa,UAAb,IAA2BL,sBAAsB,CAAC7D,MAAlD,IAA4D6D,sBAAsB,CAAC,CAAD,CAAtB,KAA8B1E,CAAC,CAACC,MAAhG,EAAwG;UACpG,KAAKO,SAAL,CAAe,IAAf;UACA,IAAIwE,mBAAmB,GAAG,CAAC,KAAKC,MAAL,CAAY7D,MAAZ,CAAmBA,MAAnB,CAA0BP,MAA1B,GAAmC,CAApC,EACtB,KAAKoE,MAAL,CAAY7D,MAAZ,CAAmBA,MAAnB,CAA0B,KAAK6D,MAAL,CAAY7D,MAAZ,CAAmBA,MAAnB,CAA0BP,MAA1B,GAAmC,CAA7D,EAAgEA,MAAhE,GAAyE,CADnD,CAA1B;;UAEA,IAAI,KAAKoE,MAAL,CAAY7D,MAAZ,CAAmBA,MAAnB,CAA0B4D,mBAAmB,CAAC,CAAD,CAA7C,EAAkDA,mBAAmB,CAAC,CAAD,CAArE,MAA8E,CAAlF,EAAqF;YACjFA,mBAAmB,GAAGnG,aAAa,CAAC,KAAKoG,MAAL,CAAY7D,MAAZ,CAAmBA,MAApB,EAA4B4D,mBAA5B,EAAiD,KAAjD,CAAnC;UACH;;UACD,KAAKC,MAAL,CAAY7D,MAAZ,CAAmBM,OAAnB,GAA6BsD,mBAA7B;UACAhF,CAAC,CAACkF,cAAF;UACA,KAAKnD,KAAL,CAAW/B,CAAX;UACA;QACH;;QACD,IAAI,EAAEA,CAAC,CAAC+E,MAAF,KAAa,KAAb,IAAsB,KAAK/F,MAAL,CAAY8C,OAAZ,CAAoB5B,SAApB,CAA8BC,QAA9B,CAAuC,aAAvC,CAAtB,KACG,CAAC,KAAKnB,MAAL,CAAYmG,YAAZ,CAAyBC,SAA1B,IAAuCV,sBAAsB,CAAC7D,MAA9D,IACE6D,sBAAsB,CAACA,sBAAsB,CAAC7D,MAAvB,GAAgC,CAAjC,CAAtB,KAA8Db,CAAC,CAACC,MADnE,IAEI,KAAKjB,MAAL,CAAYwF,WAAZ,CAAwBC,QAAxB,CAAiCY,eAAjC,OAAuDrF,CAAC,CAACC,MAH/D,CAAF,CAAJ,EAGgF;UAC5E,KAAKjB,MAAL,CAAYwF,WAAZ,CAAwBC,QAAxB,CAAiCa,gBAAjC,CAAkDtF,CAAlD;UACA;QACH,CAND,MAOK;UACD,IAAIuF,UAAU,GAAG5G,YAAY,CAAC,KAAKK,MAAL,CAAY8C,OAAb,EAAsB,cAAtB,CAA7B;UACA1D,WAAW,CAAC,CAAC,KAAKY,MAAL,CAAY8C,OAAb,CAAD,EAAwB,CAAC,SAAD,CAAxB,CAAX;UACA1D,WAAW,CAAC,CAACmH,UAAD,CAAD,EAAe,CAAC,WAAD,CAAf,CAAX;UACAA,UAAU,CAAC7C,QAAX,GAAsB,CAAC,CAAvB;QACH;MACJ;;MACD,IAAI,KAAK1D,MAAL,CAAYwF,WAAZ,CAAwBC,QAAxB,CAAiC3C,OAAjC,CAAyCY,QAAzC,KAAsD,CAAtD,KAA4D1C,CAAC,CAACwF,OAAF,KAAc,EAAd,IAAqBxF,CAAC,CAACyF,QAAF,IAAczF,CAAC,CAACwF,OAAF,KAAc,CAA7G,CAAJ,EAAsH;QAClHxF,CAAC,CAACkF,cAAF;QACA,KAAKQ,iBAAL,GAAyB3D,KAAzB;QACA;MACH,CAJD,MAKK,IAAI,KAAK/C,MAAL,CAAYwF,WAAZ,CAAwBC,QAAxB,CAAiC3C,OAAjC,CAAyCY,QAAzC,KAAsD,CAAtD,IAA2D1C,CAAC,CAACwF,OAAF,KAAc,CAA7E,EAAgF;QACjFxF,CAAC,CAACkF,cAAF;QACA,KAAKlG,MAAL,CAAYwF,WAAZ,CAAwBC,QAAxB,CAAiCkB,aAAjC;QACA;MACH;;MACD,IAAI,KAAK3G,MAAL,CAAYwF,WAAZ,CAAwBC,QAAxB,CAAiCmB,oBAAjC,EAAJ,EAA6D;QACzD,IAAIC,OAAO,GAAG,KAAK1E,UAAL,GAAkBC,MAAlB,CAAyBG,IAAvC;QACA,IAAIuE,UAAU,GAAG,KAAK3E,UAAL,GAAkBC,MAAlB,CAAyB2E,OAA1C;QACA,KAAK5E,UAAL,GAAkBC,MAAlB,CAAyBM,OAAzB,GAAmC,CAACmE,OAAD,EAAUC,UAAV,CAAnC;MACH;IACJ;;IACD,IAAI,KAAKE,MAAL,CAAYhG,CAAZ,CAAJ,EAAoB;MAChB;IACH;;IACD,IAAIA,CAAC,CAACC,MAAF,IAAYtB,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,eAAX,CAAxB,IAAuD,CAAC,KAAKjB,MAAL,CAAY2B,YAAZ,EAA5D,EAAwF;MACpF,IAAIY,IAAI,GAAG,GAAG0E,KAAH,CAASC,IAAT,CAAc,KAAKlH,MAAL,CAAY4D,eAAZ,GAA8BrB,IAA5C,CAAX;MACA,IAAIsB,QAAQ,GAAGtB,IAAI,CAACA,IAAI,CAACV,MAAL,GAAc,CAAf,CAAJ,CAAsBiC,gBAArC;;MACA,IAAI9C,CAAC,CAACC,MAAF,KAAa4C,QAAjB,EAA2B;QACvB,KAAKrC,SAAL,CAAe,IAAf;QACA,KAAK2F,wBAAL;MACH;IACJ;;IACD,IAAInG,CAAC,CAAC+E,MAAF,KAAa,UAAb,IAA2B/E,CAAC,CAACC,MAA7B,KAAwCD,CAAC,CAACC,MAAF,KAAa,KAAKjB,MAAL,CAAY8C,OAAzB,IAAoCnD,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,WAAX,CAAhD,IACrCtB,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,iBAAX,CADf,CAAJ,EACmD;MAC/C,IAAID,CAAC,CAACC,MAAF,KAAa,KAAKjB,MAAL,CAAY8C,OAA7B,EAAsC;QAClC,IAAI,KAAK9C,MAAL,CAAY8C,OAAZ,CAAoB5B,SAApB,CAA8BC,QAA9B,CAAuC,aAAvC,CAAJ,EAA2D;UACvD,KAAKiG,qBAAL,CAA2BpG,CAA3B;QACH;;QACD;MACH;;MACD,IAAIrB,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,iBAAX,CAAhB,EAA+C;QAC3CD,CAAC,CAACkF,cAAF;QACA,KAAKlG,MAAL,CAAY8C,OAAZ,CAAoBC,KAApB;QACA;MACH;;MACD,IAAIpD,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,WAAX,CAAhB,EAAyC;QACrCD,CAAC,CAACkF,cAAF;;QACA,IAAI,KAAKlG,MAAL,CAAYqH,aAAhB,EAA+B;UAC3B,IAAIC,WAAW,GAAG,KAAKtH,MAAL,CAAYsH,WAA9B;UACA,IAAIC,qBAAqB,GAAGD,WAAW,CAACE,wBAAZ,EAA5B;;UACA,IAAID,qBAAqB,CAAC1F,MAAtB,GAA+B,CAAnC,EAAsC;YAClC0F,qBAAqB,CAACA,qBAAqB,CAAC1F,MAAtB,GAA+B,CAAhC,CAArB,CAAwDkB,KAAxD;UACH,CAFD,MAGK;YACDuE,WAAW,CAACxE,OAAZ,CAAoBC,KAApB;UACH;QACJ,CATD,MAUK;UACD,KAAK/C,MAAL,CAAY8C,OAAZ,CAAoBC,KAApB;QACH;;QACD;MACH;IACJ;;IACD,IAAI0E,oBAAoB,GAAG,KAA3B;;IACA,IAAIzG,CAAC,CAAC+E,MAAF,KAAa,KAAb,IAAsB/E,CAAC,CAACC,MAAxB,KAAmCD,CAAC,CAACC,MAAF,KAAa,KAAKjB,MAAL,CAAY8C,OAAzB,IAAoCnD,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,WAAX,CAAhD,IAChCtB,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,iBAAX,CADf,CAAJ,EACmD;MAC/C,IAAI,KAAKjB,MAAL,CAAYqH,aAAZ,KAA8BrG,CAAC,CAACC,MAAF,KAAa,KAAKjB,MAAL,CAAY8C,OAAzB,IAC3B9B,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4B,iBAA5B,CADH,CAAJ,EACwD;QACpD,IAAImG,WAAW,GAAG,KAAKtH,MAAL,CAAYsH,WAA9B;QACA,IAAIC,qBAAqB,GAAGD,WAAW,CAACE,wBAAZ,EAA5B;;QACA,IAAID,qBAAqB,CAAC1F,MAAtB,GAA+B,CAAnC,EAAsC;UAClCb,CAAC,CAACkF,cAAF;UACAqB,qBAAqB,CAAC,CAAD,CAArB,CAAyBxE,KAAzB;UACA;QACH;;QACD,IAAI,CAAC/B,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4B,iBAA5B,CAAL,EAAqD;UACjDH,CAAC,CAACkF,cAAF;UACAoB,WAAW,CAACxE,OAAZ,CAAoBC,KAApB;UACA;QACH;MACJ;;MACD,IAAI,CAAC,KAAK/C,MAAL,CAAY0H,OAAZ,IAAuB,KAAK1H,MAAL,CAAY2H,eAApC,MAAyD3G,CAAC,CAACC,MAAF,KAAa,KAAKjB,MAAL,CAAY8C,OAAzB,IACtDnD,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,iBAAX,CAD0C,IAEtDD,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4B,WAA5B,CAFH,CAAJ,EAEkD;QAC9C,IAAIyG,cAAc,GAAG,KAAK5H,MAAL,CAAY6H,aAAZ,CAA0BH,OAA1B,CAAkC5E,OAAvD;QACA,IAAIgF,qBAAqB,GAAGF,cAAc,CACrCG,gBADuB,CACN,gDADM,CAA5B;;QAEA,IAAID,qBAAqB,CAACjG,MAAtB,GAA+B,CAAnC,EAAsC;UAClCb,CAAC,CAACkF,cAAF;UACA4B,qBAAqB,CAAC,CAAD,CAArB,CAAyBE,aAAzB,CAAuC,iBAAvC,EAA0DjF,KAA1D;UACA;QACH;;QACD,IAAI,CAAC/B,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4B,WAA5B,CAAL,EAA+C;UAC3CH,CAAC,CAACkF,cAAF;UACA0B,cAAc,CAAC7E,KAAf;UACA;QACH;MACJ;;MACD,IAAI/B,CAAC,CAACC,MAAF,KAAa,KAAKjB,MAAL,CAAY8C,OAAzB,IAAoCnD,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,WAAX,CAAhD,IACGtB,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,iBAAX,CADnB,EACkD;QAC9CwG,oBAAoB,GAAG,IAAvB;MACH;IACJ;;IACD,IAAIA,oBAAJ,EAA0B;MACtB,IAAI,KAAKzH,MAAL,CAAY2B,YAAZ,OAA+B,KAAK3B,MAAL,CAAYyE,aAAZ,OAAgC,MAAhC,IAC5B,KAAKzE,MAAL,CAAYyE,aAAZ,OAAgC3E,QAAQ,CAAC4E,SAD5C,CAAJ,EAC4D;QACxD,KAAKlD,SAAL,CAAe,KAAf,EAAsB,IAAtB;MACH,CAHD,MAIK;QACD,KAAKA,SAAL,CAAe,KAAf;MACH;;MACD,KAAKyE,MAAL,CAAY7D,MAAZ,CAAmBM,OAAnB,GAA6B,CAAC,CAAD,EAAI,CAAC,CAAL,CAA7B;IACH;;IACD,KAAKuF,SAAL,GAAiBjH,CAAC,CAAC+E,MAAnB;IACA,IAAIlB,UAAU,GAAG;MAAEC,MAAM,EAAE,KAAV;MAAiBC,KAAK,EAAE,IAAxB;MAA8BC,OAAO,EAAE,KAAvC;MAA8CkD,OAAO,EAAElH;IAAvD,CAAjB;IACA,KAAKhB,MAAL,CAAYkF,MAAZ,CAAmB1F,KAAK,CAAC2F,iBAAzB,EAA4CN,UAA5C;;IACA,IAAIA,UAAU,CAACC,MAAf,EAAuB;MACnB;IACH;;IACD,IAAIqD,MAAM,GAAG,KAAKhG,UAAL,GAAkBC,MAAlB,CAAyBM,OAAtC;IACA,KAAKzC,WAAL,CAAiBmI,OAAjB,GAA2B,IAA3B;IACA,IAAIC,QAAQ,GAAG,KAAKlG,UAAL,GAAkBmG,IAAlB,CAAuBtH,CAAC,CAAC+E,MAAzB,EAAiCoC,MAAjC,CAAf;IACA,KAAKhI,IAAL,GAAYkI,QAAZ;;IACA,IAAIA,QAAQ,CAAClI,IAAb,EAAmB;MACf,KAAKqB,SAAL,CAAe,CAAC6G,QAAQ,CAACE,QAAzB,EAAmCF,QAAQ,CAACG,QAA5C,EAAsDH,QAAQ,CAACI,aAA/D;MACA,KAAKtG,UAAL,GAAkBC,MAAlB,CAAyBM,OAAzB,GAAmC,KAAKP,UAAL,GAAkBuG,cAAlB,CAAiCP,MAAjC,EAAyCE,QAAzC,EAAmD,KAAKpC,MAAxD,EAAgEjF,CAAC,CAAC+E,MAAlE,CAAnC;MACA,KAAKvF,WAAL,GAAmB,EAAnB;IACH;;IACD,KAAKmI,cAAL,CAAoB3H,CAAC,CAAC+E,MAAtB,EAA8B,KAAK5D,UAAL,EAA9B;IACA,IAAIiD,SAAS,GAAG,KAAKT,OAAL,CAAaiE,WAAb,GAA2B,KAA3B,GAAmC,KAAKzG,UAAL,GAAkBkD,UAAlB,CAA6BrE,CAA7B,CAAnD;;IACA,IAAIA,CAAC,CAACC,MAAF,IAAYtB,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,cAAX,CAA5B,EAAwD;MACpD,IAAI,CAAC,KAAKjB,MAAL,CAAY2B,YAAZ,EAAL,EAAiC;QAC7B,IAAIX,CAAC,CAAC+E,MAAF,KAAa,KAAb,IAAsBoC,MAAM,CAACU,QAAP,OAAsB,KAAK5C,MAAL,CAAY7D,MAAZ,CAAmBM,OAAnB,CAA2BmG,QAA3B,EAAhD,EAAuF;UACnF,IAAIC,mBAAmB,GAAGjJ,aAAa,CAAC,KAAKoG,MAAL,CAAY7D,MAAZ,CAAmBA,MAApB,EAA4B,KAAK6D,MAAL,CAAY7D,MAAZ,CAAmBM,OAA/C,EAAwD,IAAxD,CAAvC;UACA,IAAIsD,mBAAmB,GAAG,CAAC,KAAKC,MAAL,CAAY7D,MAAZ,CAAmBA,MAAnB,CAA0BP,MAA1B,GAAmC,CAApC,EACtB,KAAKoE,MAAL,CAAY7D,MAAZ,CAAmBA,MAAnB,CAA0B,KAAK6D,MAAL,CAAY7D,MAAZ,CAAmBA,MAAnB,CAA0BP,MAA1B,GAAmC,CAA7D,EAAgEA,MAAhE,GAAyE,CADnD,CAA1B;;UAEA,IAAI,KAAKoE,MAAL,CAAY7D,MAAZ,CAAmBA,MAAnB,CAA0B4D,mBAAmB,CAAC,CAAD,CAA7C,EAAkDA,mBAAmB,CAAC,CAAD,CAArE,MAA8E,CAAlF,EAAqF;YACjFA,mBAAmB,GAAGnG,aAAa,CAAC,KAAKoG,MAAL,CAAY7D,MAAZ,CAAmBA,MAApB,EAA4B4D,mBAA5B,EAAiD,KAAjD,CAAnC;UACH;;UACD,IAAI,KAAKC,MAAL,CAAY7D,MAAZ,CAAmBM,OAAnB,CAA2BmG,QAA3B,OAA0C7C,mBAAmB,CAAC6C,QAApB,EAA9C,EAA8E;YAC1EzD,SAAS,GAAG,IAAZ;YACA,KAAK5D,SAAL,CAAe,IAAf;YACA,IAAIuH,qBAAqB,GAAG,CAAC,CAAD,EAAI,CAAJ,CAA5B;;YACA,IAAI,KAAK9C,MAAL,CAAY7D,MAAZ,CAAmBA,MAAnB,CAA0B2G,qBAAqB,CAAC,CAAD,CAA/C,EAAoDA,qBAAqB,CAAC,CAAD,CAAzE,MAAkF,CAAtF,EAAyF;cACrFA,qBAAqB,GAAGlJ,aAAa,CAAC,KAAKoG,MAAL,CAAY7D,MAAZ,CAAmBA,MAApB,EAA4B,CAAC,CAAD,EAAI,CAAJ,CAA5B,EAAoC,IAApC,CAArC;YACH;;YACD,KAAK6D,MAAL,CAAY7D,MAAZ,CAAmBM,OAAnB,GAA6BqG,qBAA7B;UACH,CARD,MASK,IAAI,KAAK9C,MAAL,CAAY7D,MAAZ,CAAmBM,OAAnB,CAA2BmG,QAA3B,OAA0CC,mBAAmB,CAACD,QAApB,EAA9C,EAA8E;YAC/E,KAAK5C,MAAL,CAAY7D,MAAZ,CAAmBM,OAAnB,GAA6BoG,mBAA7B;UACH;QACJ;;QACD,IAAI9H,CAAC,CAAC+E,MAAF,KAAa,UAAb,IAA2BoC,MAAM,CAACU,QAAP,OAAsB,KAAK5C,MAAL,CAAY7D,MAAZ,CAAmBM,OAAnB,CAA2BmG,QAA3B,EAArD,EAA4F;UACxF,IAAIG,iBAAiB,GAAGnJ,aAAa,CAAC,KAAKoG,MAAL,CAAY7D,MAAZ,CAAmBA,MAApB,EAA4B,KAAK6D,MAAL,CAAY7D,MAAZ,CAAmBM,OAA/C,EAAwD,KAAxD,CAArC;;UACA,IAAIsG,iBAAiB,CAACH,QAAlB,OAAiC,KAAK5C,MAAL,CAAY7D,MAAZ,CAAmBM,OAAnB,CAA2BmG,QAA3B,EAArC,EAA4E;YACxE,KAAKI,kBAAL,CAAwBjI,CAAxB;YACA;UACH;;UACD,IAAI,KAAKiF,MAAL,CAAY7D,MAAZ,CAAmBM,OAAnB,CAA2BmG,QAA3B,OAA0CG,iBAAiB,CAACH,QAAlB,EAA1C,IAA0E,CAACzD,SAA/E,EAA0F;YACtFA,SAAS,GAAG,IAAZ;YACA,KAAKa,MAAL,CAAY7D,MAAZ,CAAmBM,OAAnB,GAA6BsG,iBAA7B;UACH;QACJ;MACJ,CAhCD,MAiCK;QACD,IAAIhI,CAAC,CAAC+E,MAAF,KAAa,UAAb,IAA2BoC,MAAM,CAACU,QAAP,OAAsB,KAAK5C,MAAL,CAAY7D,MAAZ,CAAmBM,OAAnB,CAA2BmG,QAA3B,EAAjD,IAA0F,CAACR,QAAQ,CAAClI,IAAxG,EAA8G;UAC1G,KAAK8I,kBAAL,CAAwBjI,CAAxB;UACA;QACH;MACJ;IACJ;;IACD,IAAIA,CAAC,CAACC,MAAF,IAAYtB,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,eAAX,CAA5B,EAAyD;MACrD,IAAI,CAAC,KAAKjB,MAAL,CAAY2B,YAAZ,EAAL,EAAiC;QAC7B,IAAIX,CAAC,CAAC+E,MAAF,KAAa,UAAb,IAA2BoC,MAAM,CAACU,QAAP,OAAsB,KAAK5C,MAAL,CAAY7D,MAAZ,CAAmBM,OAAnB,CAA2BmG,QAA3B,EAArD,EAA4F;UACxF,IAAIE,qBAAqB,GAAG,CAAC,CAAD,EAAI,CAAJ,CAA5B;;UACA,IAAI,KAAK9C,MAAL,CAAY7D,MAAZ,CAAmBA,MAAnB,CAA0B2G,qBAAqB,CAAC,CAAD,CAA/C,EAAoDA,qBAAqB,CAAC,CAAD,CAAzE,MAAkF,CAAtF,EAAyF;YACrFA,qBAAqB,GAAGlJ,aAAa,CAAC,KAAKoG,MAAL,CAAY7D,MAAZ,CAAmBA,MAApB,EAA4B,CAAC,CAAD,EAAI,CAAJ,CAA5B,EAAoC,IAApC,CAArC;UACH;;UACD,IAAI,CAACgD,SAAD,IAAc2D,qBAAqB,CAACF,QAAtB,OAAqC,KAAK5C,MAAL,CAAY7D,MAAZ,CAAmBM,OAAnB,CAA2BmG,QAA3B,EAAvD,EAA8F;YAC1FzD,SAAS,GAAG,IAAZ;YACA,KAAK5D,SAAL,CAAe,KAAf;YACA,KAAK2F,wBAAL;UACH;QACJ;MACJ;IACJ;;IACD,IAAI/B,SAAS,KAAK,KAAlB,EAAyB;MACrB,KAAK8D,cAAL;;MACA,IAAIlI,CAAC,CAAC+E,MAAF,KAAa,UAAb,IAA2BoC,MAAM,CAACU,QAAP,OAAsB,CAAC,CAAD,EAAI,CAAJ,EAAOA,QAAP,EAArD,EAAwE;QACpE,KAAK7I,MAAL,CAAY8C,OAAZ,CAAoBY,QAApB,GAA+B,CAAC,CAAhC;MACH;;MACD,IAAI,KAAK1D,MAAL,CAAYsF,WAAZ,IAA2B,CAAC,KAAKtF,MAAL,CAAYwF,WAAZ,CAAwBC,QAAxB,CAAiCK,kBAAjC,EAA5B,IAAqF,KAAKD,aAAL,CAAmB7E,CAAnB,CAArF,IACGmH,MAAM,CAACU,QAAP,OAAsB,CAAC,CAAD,EAAI,CAAJ,EAAOA,QAAP,EAD7B,EACgD;QAC5C7H,CAAC,CAACkF,cAAF;;QACA,IAAIlF,CAAC,CAACwF,OAAF,KAAc,EAAlB,EAAsB;UAClB,KAAKxG,MAAL,CAAYwF,WAAZ,CAAwBC,QAAxB,CAAiC0D,sBAAjC;UACA;QACH,CAHD,MAIK,IAAInI,CAAC,CAACwF,OAAF,KAAc,CAAlB,EAAqB;UACtB,KAAKxG,MAAL,CAAYwF,WAAZ,CAAwBC,QAAxB,CAAiCkB,aAAjC;UACA;QACH;MACJ;;MACD,IAAI,KAAK3G,MAAL,CAAY8C,OAAZ,CAAoB5B,SAApB,CAA8BC,QAA9B,CAAuC,aAAvC,CAAJ,EAA2D;QACvD,KAAKiG,qBAAL,CAA2BpG,CAA3B;MACH;;MACD;IACH;;IACDA,CAAC,CAACkF,cAAF;IACA,KAAKnD,KAAL,CAAW/B,CAAX;EACH,CA/OD;;EAgPAjB,aAAa,CAAClB,SAAd,CAAwBsI,wBAAxB,GAAmD,YAAY;IAC3D,IAAIiC,oBAAoB,GAAG,CAAC,KAAKnD,MAAL,CAAY7D,MAAZ,CAAmBA,MAAnB,CAA0BP,MAA1B,GAAmC,CAApC,EACvB,KAAKoE,MAAL,CAAY7D,MAAZ,CAAmBA,MAAnB,CAA0B,KAAK6D,MAAL,CAAY7D,MAAZ,CAAmBA,MAAnB,CAA0BP,MAA1B,GAAmC,CAA7D,EAAgEA,MAAhE,GAAyE,CADlD,CAA3B;;IAEA,IAAI,KAAKoE,MAAL,CAAY7D,MAAZ,CAAmBA,MAAnB,CAA0BgH,oBAAoB,CAAC,CAAD,CAA9C,EAAmDA,oBAAoB,CAAC,CAAD,CAAvE,MAAgF,CAApF,EAAuF;MACnFA,oBAAoB,GAAGvJ,aAAa,CAAC,KAAKoG,MAAL,CAAY7D,MAAZ,CAAmBA,MAApB,EAA4BgH,oBAA5B,EAAkD,KAAlD,CAApC;IACH;;IACD,KAAKnD,MAAL,CAAY7D,MAAZ,CAAmBM,OAAnB,GAA6B0G,oBAA7B;EACH,CAPD;;EAQArJ,aAAa,CAAClB,SAAd,CAAwBuI,qBAAxB,GAAgD,UAAUpG,CAAV,EAAa;IACzD,IAAIqI,WAAW,GAAG1J,YAAY,CAAC,KAAKK,MAAL,CAAY8C,OAAb,EAAsB,SAAtB,CAA9B;IACA,IAAIwG,UAAU,GAAG3J,YAAY,CAAC0J,WAAD,EAAc,QAAd,CAAZ,CAAoCE,aAApC,CAAkD,CAAlD,CAAjB;IACA,IAAIhD,UAAU,GAAG5G,YAAY,CAAC,KAAKK,MAAL,CAAY8C,OAAb,EAAsB,cAAtB,CAA7B;IACA,IAAI0G,GAAG,GAAG7J,YAAY,CAAC,KAAKK,MAAL,CAAY8C,OAAb,EAAsB,aAAtB,CAAZ,CAAiDS,YAAjD,CAA8D,UAA9D,CAAV;IACA,IAAIkG,UAAU,GAAGH,UAAU,CAACI,OAAX,EAAjB;IACA,IAAIC,cAAc,GAAGF,UAAU,CAACG,GAAX,CAAe,UAAUC,CAAV,EAAa;MAAE,OAAOA,CAAC,CAACtG,YAAF,CAAe,UAAf,CAAP;IAAoC,CAAlE,EAAoEuG,OAApE,CAA4EN,GAA5E,CAArB;;IACA,IAAIxI,CAAC,CAAC+E,MAAF,KAAa,KAAb,IAAsB4D,cAAc,IAAIF,UAAU,CAAC5H,MAAX,GAAoB,CAAhE,EAAmE;MAC/D;IACH;;IACDzC,WAAW,CAAC,CAAC,KAAKY,MAAL,CAAY8C,OAAb,CAAD,EAAwB,CAAC,SAAD,CAAxB,CAAX;IACA1D,WAAW,CAAC,CAACmH,UAAD,CAAD,EAAe,CAAC,WAAD,CAAf,CAAX;IACAA,UAAU,CAAC7C,QAAX,GAAsB,CAAC,CAAvB;IACA1C,CAAC,CAACkF,cAAF;IACA,IAAI6D,aAAJ;IACAT,UAAU,CAACU,WAAX,CAAuBxG,WAAvB;;IACA,IAAIxC,CAAC,CAAC+E,MAAF,KAAa,UAAjB,EAA6B;MACzB,IAAIkE,WAAW,GAAGR,UAAU,CAACE,cAAc,GAAG,CAAlB,CAA5B;MACA,IAAIO,QAAQ,GAAGD,WAAW,CAACE,KAA3B;;MACA,KAAK,IAAIC,CAAC,GAAGF,QAAQ,CAACrI,MAAT,GAAkB,CAA/B,EAAkCuI,CAAC,IAAI,CAAvC,EAA0CA,CAAC,EAA3C,EAA+C;QAC3CL,aAAa,GAAGG,QAAQ,CAACE,CAAD,CAAxB;;QACA,IAAI,CAACL,aAAa,CAAC7I,SAAd,CAAwBC,QAAxB,CAAiC,QAAjC,CAAL,EAAiD;UAC7CmI,UAAU,CAACU,WAAX,CAAuB/D,MAAvB,CAA8B7D,MAA9B,CAAqCM,OAArC,GAA+C,CAACiH,cAAc,GAAG,CAAlB,EAAqBS,CAArB,CAA/C;UACA;QACH;MACJ;IACJ,CAVD,MAWK;MACDL,aAAa,GAAGN,UAAU,CAACE,cAAc,GAAG,CAAlB,CAAV,CAA+BQ,KAA/B,CAAqC,CAArC,CAAhB;MACAb,UAAU,CAACU,WAAX,CAAuB/D,MAAvB,CAA8B7D,MAA9B,CAAqCM,OAArC,GAA+C,CAACiH,cAAc,GAAG,CAAlB,EAAqB,CAArB,CAA/C;IACH;;IACDL,UAAU,CAACU,WAAX,CAAuB/J,WAAvB,CAAmC6C,OAAnC,GAA6CiH,aAA7C;IACAT,UAAU,CAACU,WAAX,CAAuB/J,WAAvB,CAAmCoK,cAAnC,GAAoDN,aAApD;IACA5K,QAAQ,CAAC,CAAC4K,aAAD,CAAD,EAAkB,CAAC,WAAD,EAAc,SAAd,CAAlB,CAAR;IACAA,aAAa,CAACrG,QAAd,GAAyB,CAAzB;IACAqG,aAAa,CAAChH,KAAd;EACH,CApCD;;EAqCAhD,aAAa,CAAClB,SAAd,CAAwBoK,kBAAxB,GAA6C,UAAUjI,CAAV,EAAa;IACtDA,CAAC,CAACkF,cAAF;IACA,KAAK1C,WAAL;;IACA,IAAI,KAAKxD,MAAL,CAAY0H,OAAZ,IAAuB,KAAK1H,MAAL,CAAY2H,eAAvC,EAAwD;MACpD,IAAIC,cAAc,GAAG,KAAK5H,MAAL,CAAY6H,aAAZ,CAA0BH,OAA1B,CAAkC5E,OAAvD;MACA,IAAIgF,qBAAqB,GAAGF,cAAc,CACrCG,gBADuB,CACN,gDADM,CAA5B;;MAEA,IAAID,qBAAqB,CAACjG,MAAtB,GAA+B,CAAnC,EAAsC;QAClCiG,qBAAqB,CAACA,qBAAqB,CAACjG,MAAtB,GAA+B,CAAhC,CAArB,CAAwDmG,aAAxD,CAAsE,iBAAtE,EAAyFjF,KAAzF;MACH,CAFD,MAGK;QACD6E,cAAc,CAAC7E,KAAf;MACH;;MACD;IACH;;IACD,IAAI,KAAK/C,MAAL,CAAYqH,aAAhB,EAA+B;MAC3B,IAAIC,WAAW,GAAG,KAAKtH,MAAL,CAAYsH,WAA9B;MACA,IAAIC,qBAAqB,GAAGD,WAAW,CAACE,wBAAZ,EAA5B;;MACA,IAAID,qBAAqB,CAAC1F,MAAtB,GAA+B,CAAnC,EAAsC;QAClC0F,qBAAqB,CAACA,qBAAqB,CAAC1F,MAAtB,GAA+B,CAAhC,CAArB,CAAwDkB,KAAxD;MACH,CAFD,MAGK;QACDuE,WAAW,CAACxE,OAAZ,CAAoBC,KAApB;MACH;;MACD;IACH;;IACD,IAAI,KAAK/C,MAAL,CAAY8C,OAAZ,CAAoB5B,SAApB,CAA8BC,QAA9B,CAAuC,aAAvC,CAAJ,EAA2D;MACvDxB,YAAY,CAAC,KAAKK,MAAL,CAAY8C,OAAb,EAAsB,cAAtB,CAAZ,CAAkDC,KAAlD;IACH,CAFD,MAGK;MACD,KAAK/C,MAAL,CAAY8C,OAAZ,CAAoBC,KAApB;IACH;EACJ,CAhCD;;EAiCAhD,aAAa,CAAClB,SAAd,CAAwBgH,aAAxB,GAAwC,UAAU7E,CAAV,EAAa;IACjD,IAAI,KAAKhB,MAAL,CAAY8B,YAAZ,CAAyBC,IAAzB,KAAkC,OAAlC,IAA6C,KAAK/B,MAAL,CAAY8B,YAAZ,CAAyBwI,WAAtE,IAAqFtJ,CAAC,CAACwF,OAAF,KAAc,EAAvG,EAA2G;MACvG,OAAO,KAAP;IACH;;IACD,OAAO,IAAP;EACH,CALD;;EAMAzG,aAAa,CAAClB,SAAd,CAAwBmI,MAAxB,GAAiC,UAAUhG,CAAV,EAAa;IAC1C,IAAIC,MAAM,GAAGD,CAAC,CAACC,MAAf;;IACA,IAAI,CAACA,MAAL,EAAa;MACT,OAAO,KAAP;IACH;;IACD,IAAI,KAAKhB,WAAL,CAAiBgD,UAArB,EAAiC;MAC7B,KAAKiG,cAAL;MACA,OAAO,IAAP;IACH;;IACD,IAAI,CAAC,QAAD,EAAW,UAAX,EAAuB,cAAvB,EAAuCY,OAAvC,CAA+C9I,CAAC,CAAC+E,MAAjD,IAA2D,CAAC,CAAhE,EAAmE;MAC/D,KAAKmD,cAAL;MACA,OAAO,IAAP;IACH;;IACD,IAAI,KAAKlJ,MAAL,CAAYqH,aAAhB,EAA+B;MAC3B,IAAIE,qBAAqB,GAAG,KAAKvH,MAAL,CAAYsH,WAAZ,CAAwBE,wBAAxB,EAA5B;;MACA,IAAI7H,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,mBAAX,CAAZ,IACG,EAAGD,CAAC,CAACC,MAAF,KAAasG,qBAAqB,CAAC,CAAD,CAAlC,IAAyCvG,CAAC,CAAC+E,MAAF,KAAa,UAAvD,IACG/E,CAAC,CAACC,MAAF,KAAasG,qBAAqB,CAACA,qBAAqB,CAAC1F,MAAtB,GAA+B,CAAhC,CAAlC,IAAwEb,CAAC,CAAC+E,MAAF,KAAa,KAD1F,CADP,EAE0G;QACtG,OAAO,IAAP;MACH;IACJ;;IACD,IAAI,KAAK/F,MAAL,CAAY0H,OAAZ,IAAuB,KAAK1H,MAAL,CAAY2H,eAAvC,EAAwD;MACpD,IAAIC,cAAc,GAAG,KAAK5H,MAAL,CAAY6H,aAAZ,CAA0BH,OAA1B,CAAkC5E,OAAvD;MACA,IAAIgF,qBAAqB,GAAGF,cAAc,CACrCG,gBADuB,CACN,gDADM,CAA5B;;MAEA,IAAIpI,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,gBAAX,CAAZ,IACG,EAAE6G,qBAAqB,CAACjG,MAAtB,GAA+B,CAA/B,KAAsClC,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,gBAAX,CAAZ,KAA6C6G,qBAAqB,CAAC,CAAD,CAAlE,IAAyE9G,CAAC,CAAC+E,MAAF,KAAa,UAAvF,IAClCpG,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,gBAAX,CAAZ,KAA6C6G,qBAAqB,CAACA,qBAAqB,CAACjG,MAAtB,GAA+B,CAAhC,CAAlE,IAAwGb,CAAC,CAAC+E,MAAF,KAAa,KADxH,CAAF,CADP,EAE2I;QACvI,OAAO,IAAP;MACH;IACJ;;IACD,IAAIwE,EAAE,GAAGtL,OAAO,CAACgC,MAAD,EAAS,IAAT,CAAP,IAAyB,CAAChC,OAAO,CAACgC,MAAD,EAAS,IAAT,CAAP,CAAsByC,QAAzD;;IACA,IAAI1C,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4B,qBAA5B,MAAuDH,CAAC,CAACwF,OAAF,KAAc,EAAd,IAAoBxF,CAAC,CAACwF,OAAF,KAAc,EAAzF,CAAJ,EAAkG;MAC9F,IAAIgE,WAAW,GAAGvL,OAAO,CAAC+B,CAAC,CAACC,MAAH,EAAW,kBAAX,CAAzB;MACAuJ,WAAW,CAACxC,aAAZ,CAA0B,OAA1B,EAAmCjF,KAAnC;IACH;;IACD,IAAIwH,EAAE,IAAItL,OAAO,CAACwL,QAAQ,CAACC,aAAV,EAAyB,kBAAzB,CAAP,KAAwD,IAAlE,EAAwE;MACpE,KAAKlH,WAAL;IACH;;IACD,IAAImH,UAAU,GAAG1L,OAAO,CAACwL,QAAQ,CAACC,aAAV,EAAyB,kBAAzB,CAAP,KAAwD,IAAzE;;IACA,IAAI,KAAK1K,MAAL,CAAYyB,iBAAZ,IAAiCkJ,UAArC,EAAiD;MAC7C,IAAIvI,MAAM,GAAG,KAAK6D,MAAL,CAAY7D,MAAzB;MACA,IAAIM,OAAO,GAAGN,MAAM,CAACM,OAArB;MACAiI,UAAU,GAAGvI,MAAM,CAACA,MAAP,CAAcM,OAAO,CAAC,CAAD,CAArB,EAA0BkI,WAA1B,CAAsC,CAAtC,MAA6ClI,OAAO,CAAC,CAAD,CAAjE;IACH;;IACD,OAAQ1B,CAAC,CAAC+E,MAAF,KAAa,QAAb,IACA,KAAK/F,MAAL,CAAY8B,YAAZ,CAAyBC,IAAzB,KAAkC,OAAlC,KAA8C,KAAK/B,MAAL,CAAYmD,MAAZ,IAAsB,CAAC,QAAD,EAAW,IAAX,EAAiB2G,OAAjB,CAAyB9I,CAAC,CAAC+E,MAA3B,IAAqC,CAAC,CAA1G,CADA,IAEC4E,UAAU,IAAI,KAAK3K,MAAL,CAAYyB,iBAA3B,IACAxC,OAAO,CAACwL,QAAQ,CAACC,aAAV,EAAyB,MAAM,KAAK1K,MAAL,CAAY8C,OAAZ,CAAoB+H,EAA1B,GAA+B,YAAxD,CAAP,KAAiF,IAAjF,IACO,CAAC,OAAD,EAAU,WAAV,EAAuB,YAAvB,EACC,WADD,EACc,YADd,EAC4B,WAD5B,EACyCf,OADzC,CACiD9I,CAAC,CAAC+E,MADnD,IAC6D,CAAC,CALrE,IAMA9G,OAAO,CAACgC,MAAD,EAAS,MAAMnB,QAAQ,CAACoE,WAAxB,CAAP,KAAgD,IAAhD,IAAwDjF,OAAO,CAACgC,MAAD,EAAS,MAAMnB,QAAQ,CAACsE,UAAxB,CAAP,KAA+C,IAAvG,IACG,EAAEpD,CAAC,CAACC,MAAF,KAAa,KAAKjB,MAAL,CAAY8C,OAAzB,IAAoCnD,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,WAAX,CAAhD,IACEtB,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,iBAAX,CADhB,CAPH,IASAD,CAAC,CAAC+E,MAAF,KAAa,OAAb,IAAyB,CAAC9E,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0BrB,QAAQ,CAACgL,UAAnC,CAAD,IAAmD7L,OAAO,CAACgC,MAAD,EAAS,MAAMnB,QAAQ,CAACgL,UAAxB,CAAP,KAA+C,IAAlG,IACtB7L,OAAO,CAACgC,MAAD,EAAS,qBAAT,CAAP,KAA2C,IAV/C,IAU0DhC,OAAO,CAACgC,MAAD,EAAS,iBAAT,CAAP,KAAuC,IAVxG;EAWH,CAxDD;;EAyDAlB,aAAa,CAAClB,SAAd,CAAwBkM,mBAAxB,GAA8C,UAAU/J,CAAV,EAAa;IACvD,IAAIgK,KAAK,GAAG,IAAZ;;IACA,IAAI,KAAKhL,MAAL,CAAYuB,oBAAZ,IAAoC,KAAKvB,MAAL,CAAYiL,uBAApD,EAA6E;MACzE,IAAIC,IAAI,GAAG;QAAEC,WAAW,EAAE,EAAf;QAAmBC,KAAK,EAAE,KAA1B;QAAiCC,QAAQ,EAAE;MAA3C,CAAX;MACA,KAAKrL,MAAL,CAAYkF,MAAZ,CAAmB1F,KAAK,CAAC8L,cAAzB,EAAyCJ,IAAzC;MACA,IAAIK,UAAU,GAAG,KAAK5K,OAAL,CAAa6K,IAAb,CAAkB,UAAUC,KAAV,EAAiB;QAAE,OAAOA,KAAK,KAAKT,KAAK,CAAC/C,SAAvB;MAAmC,CAAxE,CAAjB;MACA,IAAIyD,UAAU,GAAG,KAAK1L,MAAL,CAAY2L,aAAZ,GACb,KAAK3L,MAAL,CAAY2L,aAAZ,CAA0BC,gBAA1B,GAA6C,CAAC,CADjC,GACqC,KADtD;;MAEA,IAAIV,IAAI,CAACE,KAAL,IAAc/M,MAAM,CAACwN,IAAP,CAAYX,IAAI,CAACC,WAAjB,EAA8BtJ,MAA5C,IAAsD0J,UAAtD,IAAoEL,IAAI,CAACG,QAAzE,IAAqFK,UAAzF,EAAqG;QACjG,KAAK1L,MAAL,CAAYkF,MAAZ,CAAmB1F,KAAK,CAACsM,iBAAzB,EAA4C;UAAET,QAAQ,EAAE;QAAZ,CAA5C;QACAH,IAAI,CAACG,QAAL,GAAgB,KAAhB;QACA,KAAKrL,MAAL,CAAY2L,aAAZ,CAA0BC,gBAA1B,GAA6C,CAAC,CAA9C;;QACA,IAAIL,UAAJ,EAAgB;UACZ,KAAKtD,SAAL,GAAiB,KAAK8D,KAAtB;UACA,KAAK/L,MAAL,CAAYkF,MAAZ,CAAmB,qBAAnB,EAA0ClE,CAA1C;QACH,CAPgG,CAQjG;;;QACA,KAAKf,WAAL,CAAiBoK,cAAjB,CAAgCtH,KAAhC,CAAsC;UAAEiJ,aAAa,EAAE;QAAjB,CAAtC;MACH,CAVD,MAWK;QACD,IAAI,KAAKpL,eAAL,IAAwB,KAAKR,gBAAjC,EAAmD;UAC/C;UACA,KAAKH,WAAL,CAAiBoK,cAAjB,CAAgCtH,KAAhC,CAAsC;YAAEiJ,aAAa,EAAE;UAAjB,CAAtC;QACH,CAHD,MAIK;UACD,KAAK/L,WAAL,CAAiBoK,cAAjB,CAAgCtH,KAAhC;QACH;MACJ;IACJ;;IACD,KAAKnC,eAAL,GAAuB,KAAKR,gBAAL,GAAwB,KAA/C;EACH,CA9BD;;EA+BAL,aAAa,CAAClB,SAAd,CAAwB6H,iBAAxB,GAA4C,YAAY;IACpD,OAAO,KAAKzG,WAAL,CAAiBoK,cAAxB;EACH,CAFD;;EAGAtK,aAAa,CAAClB,SAAd,CAAwBsD,UAAxB,GAAqC,YAAY;IAC7C,OAAO,KAAK8D,MAAL,IAAe,KAAKtB,OAA3B;EACH,CAFD;;EAGA5E,aAAa,CAAClB,SAAd,CAAwB2C,SAAxB,GAAoC,UAAUmD,OAAV,EAAmBN,QAAnB,EAA6BG,aAA7B,EAA4C;IAC5E,KAAKyB,MAAL,GAActB,OAAO,GAAGN,QAAQ,GAAG,KAAK4H,QAAR,GAAmBzH,aAAa,GAAG,KAAK0H,SAAR,GAAoB,KAAKvH,OAApE,GACjBN,QAAQ,GAAG,KAAK8H,OAAR,GAAkB3H,aAAa,GAAG,KAAK4H,QAAR,GAAmB,KAAKC,MADnE;EAEH,CAHD;;EAIAtM,aAAa,CAAClB,SAAd,CAAwByN,iBAAxB,GAA4C,UAAUxJ,OAAV,EAAmB9B,CAAnB,EAAsB;IAC9D,IAAIgK,KAAK,GAAG,IAAZ;;IACA,KAAK/K,WAAL,CAAiBoK,cAAjB,GAAkCvH,OAAlC;IACAyJ,UAAU,CAAC,YAAY;MACnB,IAAI,CAACrN,iBAAiB,CAAC8L,KAAK,CAAC/K,WAAN,CAAkBoK,cAAnB,CAAtB,EAA0D;QACtD,IAAIW,KAAK,CAAChL,MAAN,CAAauB,oBAAb,IAAqCyJ,KAAK,CAAChL,MAAN,CAAaiL,uBAAtD,EAA+E;UAC3ED,KAAK,CAACD,mBAAN,CAA0B/J,CAA1B;QACH,CAFD,MAGK;UACDgK,KAAK,CAAC/K,WAAN,CAAkBoK,cAAlB,CAAiCtH,KAAjC;QACH;MACJ;IACJ,CATS,EASP,CATO,CAAV;EAUH,CAbD;;EAcAhD,aAAa,CAAClB,SAAd,CAAwBkE,KAAxB,GAAgC,UAAU/B,CAAV,EAAa;IACzC,KAAKhB,MAAL,CAAYkF,MAAZ,CAAmB1F,KAAK,CAACgN,gBAAzB,EAA2CxL,CAA3C;IACA,KAAKwC,WAAL;IACA,KAAKiJ,QAAL,CAAc,KAAKtK,UAAL,GAAkBuK,YAAlB,EAAd,EAAgD1L,CAAhD;EACH,CAJD,CA/hB2C,CAoiB3C;;;EACAjB,aAAa,CAAClB,SAAd,CAAwB2E,WAAxB,GAAsC,UAAUxC,CAAV,EAAa;IAC/C,IAAI,CAAC,KAAKf,WAAL,CAAiB6C,OAAtB,EAA+B;MAC3B;IACH;;IACD1D,WAAW,CAAC,CAAC,KAAKa,WAAL,CAAiB6C,OAAlB,EAA2B,KAAK7C,WAAL,CAAiBoK,cAA5C,CAAD,EAA8D,CAAC,WAAD,EAAc,SAAd,CAA9D,CAAX;IACA,KAAKpK,WAAL,CAAiB6C,OAAjB,CAAyBY,QAAzB,GAAoC,CAAC,CAArC;EACH,CAND;EAOA;AACJ;AACA;;;EACI3D,aAAa,CAAClB,SAAd,CAAwB8N,UAAxB,GAAqC,YAAY;IAC7C,IAAIC,IAAI,GAAG,KAAKzK,UAAL,GAAkBuK,YAAlB,EAAX;;IACA,IAAIE,IAAI,CAAC9J,OAAT,EAAkB;MACd3D,QAAQ,CAAC,CAACyN,IAAI,CAAC9J,OAAN,CAAD,EAAiB,CAAC,WAAD,CAAjB,CAAR;MACA3D,QAAQ,CAAC,CAACyN,IAAI,CAACvC,cAAN,CAAD,EAAwB,CAAC,SAAD,CAAxB,CAAR;IACH;EACJ,CAND;EAOA;AACJ;AACA;;;EACItK,aAAa,CAAClB,SAAd,CAAwBgO,WAAxB,GAAsC,YAAY;IAC9C,KAAKrL,SAAL,CAAe,KAAf,EAAsB,KAAKxB,MAAL,CAAY2B,YAAZ,EAAtB;IACA,KAAKmL,UAAL;EACH,CAHD;EAIA;AACJ;AACA;;;EACI/M,aAAa,CAAClB,SAAd,CAAwBkO,YAAxB,GAAuC,YAAY;IAC/C,KAAKvL,SAAL,CAAe,IAAf,EAAqB,KAAKxB,MAAL,CAAY2B,YAAZ,EAArB;IACA,KAAKmL,UAAL;EACH,CAHD;;EAIA/M,aAAa,CAAClB,SAAd,CAAwBiO,UAAxB,GAAqC,YAAY;IAC7C,IAAIpK,OAAO,GAAG,KAAKP,UAAL,GAAkBC,MAAlB,CAAyBO,GAAzB,CAA6B,CAA7B,EAAgC,CAAC,CAAjC,EAAoC,CAAC,CAAD,EAAI,CAAJ,CAApC,EAA4C,IAA5C,EAAkD,KAAKR,UAAL,GAAkBS,SAAlB,EAAlD,CAAd;IACA,KAAKT,UAAL,GAAkBC,MAAlB,CAAyBS,MAAzB,CAAgCH,OAAO,CAAC,CAAD,CAAvC,EAA4CA,OAAO,CAAC,CAAD,CAAnD;IACA,KAAKK,KAAL;EACH,CAJD;;EAKAhD,aAAa,CAAClB,SAAd,CAAwB4N,QAAxB,GAAmC,UAAUG,IAAV,EAAgB5L,CAAhB,EAAmB;IAClD,KAAKf,WAAL,GAAmB2M,IAAnB;IACA,KAAK3M,WAAL,CAAiBmI,OAAjB,GAA2BwE,IAAI,CAACxE,OAAL,IAAgB,CAAClJ,iBAAiB,CAAC8B,CAAD,CAA7D;;IACA,IAAI,KAAKZ,gBAAT,EAA2B;MACvB,KAAKH,WAAL,CAAiBmI,OAAjB,GAA2B,IAA3B;IACH;;IACD,IAAI,CAACwE,IAAI,CAAC9J,OAAV,EAAmB;MACf;IACH;;IACD,IAAIkK,SAAS,GAAGJ,IAAI,CAACvC,cAAL,CAAoBnJ,SAApB,CAA8BC,QAA9B,CAAuC,SAAvC,CAAhB;;IACA,IAAI6L,SAAJ,EAAe;MACX;IACH;;IACD,IAAI,KAAK/M,WAAL,CAAiBmI,OAArB,EAA8B;MAC1BjJ,QAAQ,CAAC,CAACyN,IAAI,CAAC9J,OAAN,CAAD,EAAiB,CAAC,WAAD,CAAjB,CAAR;IACH;;IACD3D,QAAQ,CAAC,CAACyN,IAAI,CAACvC,cAAN,CAAD,EAAwB,CAAC,SAAD,CAAxB,CAAR;IACAuC,IAAI,CAAC9J,OAAL,CAAaY,QAAb,GAAwB,CAAxB;;IACA,IAAI,CAACsJ,SAAL,EAAgB;MACZ,KAAKV,iBAAL,CAAuBM,IAAI,CAACvC,cAA5B,EAA4CrJ,CAA5C;IACH;;IACD,KAAKhB,MAAL,CAAYkF,MAAZ,CAAmB1F,KAAK,CAACyN,WAAzB,EAAsC;MAClCnK,OAAO,EAAE8J,IAAI,CAACvC,cADoB;MAElCrK,MAAM,EAAE4M,IAAI,CAAC9J,OAFqB;MAGlCoK,OAAO,EAAE,KAAK/K,UAAL,GAAkBC,MAAlB,CAAyBM,OAHA;MAIlCqC,KAAK,EAAE,CAAC7F,iBAAiB,CAAC8B,CAAD,CAJS;MAKlCgE,OAAO,EAAE9F,iBAAiB,CAAC8B,CAAD,CALQ;MAMlCkH,OAAO,EAAElH,CANyB;MAOlCmM,MAAM,EAAE,KAAKhN,IAAL,CAAUA,IAPgB;MAQlCiN,SAAS,EAAE,KAAKjL,UAAL,GAAkBkL,OAAlB,CAA0BrM,CAA1B,CARuB;MASlCoH,OAAO,EAAE,CAAClJ,iBAAiB,CAAC8B,CAAD,CATO;MAUlCqH,QAAQ,EAAE,KAAKlI;IAVmB,CAAtC;IAYA,IAAImN,EAAE,GAAG,KAAKnL,UAAL,GAAkBC,MAAlB,CAAyBM,OAAlC;IAAA,IAA2C6K,QAAQ,GAAGD,EAAE,CAAC,CAAD,CAAxD;IAAA,IAA6DE,SAAS,GAAGF,EAAE,CAAC,CAAD,CAA3E;IACA,KAAK9M,WAAL,GAAmB;MAAE+M,QAAQ,EAAEA,QAAZ;MAAsBC,SAAS,EAAEA;IAAjC,CAAnB;IACA,KAAKC,gBAAL,GAAwB,KAAKzN,MAAL,CAAY0N,gBAAZ,CAA6BF,SAA7B,EAAwChE,GAAhE;IACA,KAAKjJ,YAAL,GAAoB,KAApB;EACH,CArCD;;EAsCAR,aAAa,CAAClB,SAAd,CAAwB6B,aAAxB,GAAwC,UAAUiE,OAAV,EAAmB;IACvD,IAAIqG,KAAK,GAAG,IAAZ;;IACA,OAAO,UAAUhK,CAAV,EAAa;MAChB,IAAI2D,OAAO,IAAK3D,CAAC,CAAC2M,IAAF,IAAU3M,CAAC,CAAC2M,IAAF,CAAOtJ,QAA7B,IAA0C,CAAC2G,KAAK,CAACiB,QAArD,EAA+D;QAC3DjB,KAAK,CAACiB,QAAN,GAAiB,IAAI2B,iBAAJ,CAAsB5C,KAAK,CAAChL,MAA5B,CAAjB;MACH,CAFD,MAGK,IAAI2E,OAAO,IAAI,CAACqG,KAAK,CAACkB,SAAlB,IAAgClL,CAAC,CAAC2M,IAAF,IAAU3M,CAAC,CAAC2M,IAAF,CAAOE,wBAArD,EAAgF;QACjF7C,KAAK,CAACkB,SAAN,GAAkB,IAAI4B,sBAAJ,CAA2B9C,KAAK,CAAChL,MAAjC,CAAlB;MACH,CAFI,MAGA,IAAI2E,OAAO,IAAI,CAACqG,KAAK,CAACrG,OAAtB,EAA+B;QAChCqG,KAAK,CAACrG,OAAN,GAAgB,IAAIoJ,YAAJ,CAAiB/C,KAAK,CAAChL,MAAvB,CAAhB;MACH;;MACD,IAAI,CAAC2E,OAAD,IAAa3D,CAAC,CAAC2M,IAAF,IAAU3M,CAAC,CAAC2M,IAAF,CAAOtJ,QAA9B,IAA2C,CAAC2G,KAAK,CAACmB,OAAtD,EAA+D;QAC3DnB,KAAK,CAACmB,OAAN,GAAgB,IAAI6B,gBAAJ,CAAqBhD,KAAK,CAAChL,MAA3B,CAAhB;MACH,CAFD,MAGK,IAAI,CAAC2E,OAAD,IAAa3D,CAAC,CAAC2M,IAAF,IAAU3M,CAAC,CAAC2M,IAAF,CAAOE,wBAA9B,IAA2D,CAAC7C,KAAK,CAACoB,QAAtE,EAAgF;QACjFpB,KAAK,CAACoB,QAAN,GAAiB,IAAI6B,qBAAJ,CAA0BjD,KAAK,CAAChL,MAAhC,CAAjB;MACH,CAFI,MAGA,IAAI,CAAC2E,OAAD,IAAY,CAACqG,KAAK,CAACqB,MAAvB,EAA+B;QAChCrB,KAAK,CAACqB,MAAN,GAAe,IAAI6B,WAAJ,CAAgBlD,KAAK,CAAChL,MAAtB,CAAf;MACH;;MACD,IAAImO,MAAM,GAAGxJ,OAAO,GAAI3D,CAAC,CAAC2M,IAAF,IAAU3M,CAAC,CAAC2M,IAAF,CAAOtJ,QAAlB,GAA8B2G,KAAK,CAACiB,QAApC,GAAgDjL,CAAC,CAAC2M,IAAF,IAAU3M,CAAC,CAAC2M,IAAF,CAAOE,wBAAlB,GAChE7C,KAAK,CAACkB,SAD0D,GAC9ClB,KAAK,CAACrG,OADV,GACqB3D,CAAC,CAAC2M,IAAF,IAAU3M,CAAC,CAAC2M,IAAF,CAAOtJ,QAAlB,GAA8B2G,KAAK,CAACmB,OAApC,GAA+CnL,CAAC,CAAC2M,IAAF,IAAU3M,CAAC,CAAC2M,IAAF,CAAOE,wBAAlB,GAChF7C,KAAK,CAACoB,QAD0E,GAC/DpB,KAAK,CAACqB,MAF7B;MAGA,IAAI9J,IAAI,GAAGoC,OAAO,GAAG3D,CAAC,CAACuB,IAAF,CAAO0E,KAAP,CAAa+D,KAAK,CAAChL,MAAN,CAAa0B,UAA1B,CAAH,GAA2CV,CAAC,CAACuB,IAA/D;MACA,IAAI6L,SAAS,GAAGzJ,OAAO,GAAG3D,CAAC,CAACuB,IAAF,CAAO0E,KAAP,CAAa,CAAb,EAAgB+D,KAAK,CAAChL,MAAN,CAAa0B,UAA7B,CAAH,GAA8CV,CAAC,CAACuB,IAAvE;;MACA,IAAIyI,KAAK,CAAChL,MAAN,CAAaqO,sBAAb,MAAyC1J,OAA7C,EAAsD;QAClDpC,IAAI,GAAGA,IAAI,CAAC+L,MAAL,CAAY,UAAUC,CAAV,EAAa;UAAE,OAAOA,CAAC,CAACC,OAAF,KAAc,KAArB;QAA6B,CAAxD,CAAP;MACH;;MACD,IAAIC,aAAa,GAAG,CAACvP,iBAAiB,CAAC8L,KAAK,CAAChL,MAAN,CAAa0O,WAAd,CAAtC;MACA,IAAItM,MAAM,GAAG+L,MAAM,CAAC/L,MAAP,CAAcC,QAAd,CAAuB+L,SAAvB,EAAkCD,MAAM,CAAC1L,QAAzC,EAAmDgM,aAAnD,CAAb;;MACA,IAAIzN,CAAC,CAAC2N,IAAF,KAAW,UAAX,IAAyB3D,KAAK,CAAChL,MAAN,CAAa2B,YAAb,EAA7B,EAA0D;QACtD,IAAIiN,KAAK,GAAG5D,KAAK,CAAChL,MAAN,CAAa6O,oBAAb,EAAZ;;QACA,IAAIC,cAAc,GAAGF,KAAK,CAAChF,GAAN,CAAU,UAAUmF,GAAV,EAAe;UAAE,OAAOA,GAAG,CAACC,KAAJ,EAAP;QAAqB,CAAhD,CAArB;QACA,IAAIC,aAAa,GAAG1M,IAAI,CAACqH,GAAL,CAAS,UAAUmF,GAAV,EAAe;UAAE,OAAOA,GAAG,CAACC,KAAJ,EAAP;QAAqB,CAA/C,CAApB;;QACAhE,KAAK,CAACiB,QAAN,CAAe7J,MAAf,CAAsBC,QAAtB,CAA+B4M,aAA/B,EAA8CjE,KAAK,CAACiB,QAAN,CAAexJ,QAA7D,EAAuEgM,aAAvE;;QACAzD,KAAK,CAACrG,OAAN,CAAcvC,MAAd,CAAqBC,QAArB,CAA8ByM,cAA9B,EAA8C9D,KAAK,CAACrG,OAAN,CAAclC,QAA5D,EAAsEgM,aAAtE;;QACA,IAAIzD,KAAK,CAAChL,MAAN,CAAayE,aAAb,OAAiC3E,QAAQ,CAAC4E,SAA9C,EAAyD;UACrD,IAAIwK,MAAM,GAAGlE,KAAK,CAAChL,MAAN,CAAamP,wBAAb,EAAb;;UACA,IAAIC,SAAS,GAAGF,MAAM,CAACtF,GAAP,CAAW,UAAUmF,GAAV,EAAe;YAAE,OAAOA,GAAG,CAACC,KAAJ,EAAP;UAAqB,CAAjD,CAAhB;;UACAhE,KAAK,CAACkB,SAAN,CAAgB9J,MAAhB,CAAuBC,QAAvB,CAAgC+M,SAAhC,EAA2CpE,KAAK,CAACkB,SAAN,CAAgBzJ,QAA3D,EAAqEgM,aAArE;QACH;MACJ,CAXD,MAYK;QACDN,MAAM,CAAC/L,MAAP,CAAcC,QAAd,CAAuBE,IAAvB,EAA6B4L,MAAM,CAAC1L,QAApC,EAA8CgM,aAA9C;MACH;;MACD,IAAI,EAAEzD,KAAK,CAAChL,MAAN,CAAa2B,YAAb,MAA+BX,CAAC,CAAC2M,IAAjC,IAAyC3M,CAAC,CAAC2M,IAAF,CAAO0B,WAAP,KAAuB,SAAlE,CAAJ,EAAkF;QAC9ElB,MAAM,CAAC7L,YAAP,CAAoB8L,SAApB,EAA+B;UAC3BhM,MAAM,EAAEA,MADmB;UACXkN,eAAe,EAAGtO,CAAC,CAAC2M,IAAF,IAAU3M,CAAC,CAAC2M,IAAF,CAAOtJ,QAAlB,GAA8B2G,KAAK,CAACmB,OAApC,GAC1BnL,CAAC,CAAC2M,IAAF,IAAU3M,CAAC,CAAC2M,IAAF,CAAOE,wBAAlB,GAA8C7C,KAAK,CAACoB,QAApD,GAA+DpB,KAAK,CAACqB;QAFhD,CAA/B;MAIH;;MACD,IAAI,CAAC/M,OAAO,CAACgC,QAAT,IAAqBN,CAArB,IAA0BA,CAAC,CAAC2M,IAAhC,EAAsC;QAClC,IAAI,CAAC3C,KAAK,CAACzK,YAAP,IAAuBS,CAAC,CAAC2M,IAAF,CAAO0B,WAAP,KAAuB,QAA9C,IAA0D,CAACrE,KAAK,CAAChL,MAAN,CAAawF,WAAb,CAAyBC,QAAzB,CAAkCK,kBAAlC,EAA/D,EAAuH;UACnHkF,KAAK,CAAC1K,SAAN,GAAkB,KAAlB;;UACA0K,KAAK,CAAChL,MAAN,CAAa8C,OAAb,CAAqBC,KAArB;QACH;;QACD,IAAI/B,CAAC,CAAC2M,IAAF,CAAO0B,WAAP,KAAuB,UAA3B,EAAuC;UACnCrE,KAAK,CAAC1K,SAAN,GAAkB,IAAlB;QACH;MACJ;;MACD,IAAIU,CAAC,IAAIA,CAAC,CAAC2M,IAAP,IAAe3M,CAAC,CAAC2M,IAAF,CAAO0B,WAAP,KAAuB,eAA1C,EAA2D;QACvD,IAAIrE,KAAK,CAAC/K,WAAN,CAAkBuJ,GAAtB,EAA2B;UACvB,IAAI+F,OAAJ;UACA,IAAIC,IAAI,GAAGxO,CAAC,CAACuB,IAAF,CAAOiJ,IAAP,CAAY,UAAUuD,GAAV,EAAe3E,CAAf,EAAkB;YACrCmF,OAAO,GAAGnF,CAAV;YACA,OAAO2E,GAAG,CAACvF,GAAJ,KAAYwB,KAAK,CAAC/K,WAAN,CAAkBuJ,GAArC;UACH,CAHU,CAAX;;UAIA,IAAIgG,IAAJ,EAAU;YACNxE,KAAK,CAACrG,OAAN,CAAcvC,MAAd,CAAqBM,OAArB,CAA6B,CAA7B,IAAkC6M,OAAlC;YACAvE,KAAK,CAACrG,OAAN,CAAcvC,MAAd,CAAqBM,OAArB,CAA6B,CAA7B,IAAkCsI,KAAK,CAAChL,MAAN,CAAayP,mBAAb,CAAiCzE,KAAK,CAACyC,gBAAvC,KAA4D,CAA9F;;YACA,IAAIiC,YAAY,GAAG1E,KAAK,CAAC7I,UAAN,GAAmBuK,YAAnB,GAAkCrC,cAArD;;YACA,IAAIqF,YAAJ,EAAkB;cACd,IAAIC,YAAY,GAAGD,YAAY,CAACE,qBAAb,EAAnB;;cACA,IAAIC,YAAY,GAAG7E,KAAK,CAAChL,MAAN,CAAa8C,OAAb,CAAqB8M,qBAArB,EAAnB;;cACA,IAAID,YAAY,CAACG,GAAb,IAAoB,CAApB,IAAyBH,YAAY,CAACI,IAAb,IAAqB,CAA9C,IACAJ,YAAY,CAACK,KAAb,IAAsBC,IAAI,CAACC,GAAL,CAASL,YAAY,CAACG,KAAtB,EAA6BG,MAAM,CAACC,UAAP,IAC/C3F,QAAQ,CAAC4F,eAAT,CAAyBC,WADP,CADtB,IAGAX,YAAY,CAACY,MAAb,IAAuBN,IAAI,CAACC,GAAL,CAASL,YAAY,CAACU,MAAtB,EAA8BJ,MAAM,CAACK,WAAP,IACjD/F,QAAQ,CAAC4F,eAAT,CAAyBI,YADN,CAH3B,EAIgD;gBAC5CzF,KAAK,CAACpK,eAAN,GAAwB,IAAxB;;gBACAoK,KAAK,CAACjI,KAAN;cACH;YACJ;UACJ;QACJ,CAvBD,MAwBK,IAAI/B,CAAC,CAAC2M,IAAF,CAAO+B,YAAP,IAAuB1O,CAAC,CAAC2M,IAAF,CAAO+B,YAAP,CAAoBxO,SAApB,CAA8BC,QAA9B,CAAuC,cAAvC,CAA3B,EAAmF;UACpF,IAAIuO,YAAY,GAAG1E,KAAK,CAAChL,MAAN,CAAa8C,OAAb,CAAqBkF,aAArB,CAAmC,MAAMhH,CAAC,CAAC2M,IAAF,CAAO+B,YAAP,CAAoB7E,EAA7D,CAAnB;;UACA,IAAI6E,YAAJ,EAAkB;YACdA,YAAY,CAAC3M,KAAb;UACH;QACJ;MACJ;IACJ,CA3FD;EA4FH,CA9FD;;EA+FAhD,aAAa,CAAClB,SAAd,CAAwBiC,gBAAxB,GAA2C,YAAY;IACnD,IAAIkK,KAAK,GAAG,IAAZ;;IACA,IAAI,KAAKhL,MAAL,CAAYqB,WAAhB,EAA6B;MACzB;IACH;;IACDtC,YAAY,CAAC2R,GAAb,CAAiB,KAAK1Q,MAAL,CAAY8C,OAA7B,EAAsC,WAAtC,EAAmD,KAAK/B,UAAxD,EAAoE,IAApE;IACAhC,YAAY,CAAC2R,GAAb,CAAiB,KAAK1Q,MAAL,CAAY8C,OAA7B,EAAsC,OAAtC,EAA+C,KAAK1B,OAApD,EAA6D,IAA7D;IACA,KAAKpB,MAAL,CAAY8C,OAAZ,CAAoBhC,gBAApB,CAAqC,OAArC,EAA8C,KAAK6P,cAAL,GAAsB,UAAU3P,CAAV,EAAa;MAAE,OAAOgK,KAAK,CAAChI,YAAN,CAAmBhC,CAAnB,CAAP;IAA+B,CAAlH,EAAoH,IAApH;IACAjC,YAAY,CAAC2R,GAAb,CAAiB,KAAK1Q,MAAL,CAAY8C,OAA7B,EAAsC,UAAtC,EAAkD,KAAKI,MAAvD,EAA+D,IAA/D;IACA,KAAK0N,WAAL,GAAmB,CAAC;MAAEpR,KAAK,EAAEA,KAAK,CAACqR,UAAf;MAA2BC,OAAO,EAAE,KAAKzL;IAAzC,CAAD,EACf;MAAE7F,KAAK,EAAEA,KAAK,CAACuR,KAAf;MAAsBD,OAAO,EAAE,KAAK/M;IAApC,CADe,EAEf;MAAEvE,KAAK,EAAEA,KAAK,CAACwR,YAAf;MAA6BF,OAAO,EAAE,KAAKrQ;IAA3C,CAFe,EAGf;MAAEjB,KAAK,EAAEA,KAAK,CAACyR,cAAf;MAA+BH,OAAO,EAAE,KAAKrQ;IAA7C,CAHe,EAIf;MAAEjB,KAAK,EAAEA,KAAK,CAAC0R,wBAAf;MAAyCJ,OAAO,EAAE,KAAKrQ;IAAvD,CAJe,EAKf;MAAEjB,KAAK,EAAEA,KAAK,CAAC2R,eAAf;MAAgCL,OAAO,EAAE,KAAKpQ,aAAL;IAAzC,CALe,EAMf;MAAElB,KAAK,EAAEA,KAAK,CAAC4R,SAAf;MAA0BN,OAAO,EAAE,KAAKO;IAAxC,CANe,EAOf;MAAE7R,KAAK,EAAEA,KAAK,CAAC6R,YAAf;MAA6BP,OAAO,EAAE,KAAKO;IAA3C,CAPe,EAQf;MAAE7R,KAAK,EAAE,YAAT;MAAuBsR,OAAO,EAAE,KAAK5H;IAArC,CARe,EASf;MAAE1J,KAAK,EAAE,WAAT;MAAsBsR,OAAO,EAAE,KAAK5H;IAApC,CATe,EAUf;MAAE1J,KAAK,EAAE,kBAAT;MAA6BsR,OAAO,EAAE,KAAKO;IAA3C,CAVe,EAWf;MAAE7R,KAAK,EAAE,oBAAT;MAA+BsR,OAAO,EAAE,KAAKQ;IAA7C,CAXe,EAYf;MAAE9R,KAAK,EAAE,mBAAT;MAA8BsR,OAAO,EAAE,KAAKS;IAA5C,CAZe,EAaf;MAAE/R,KAAK,EAAE,qBAAT;MAAgCsR,OAAO,EAAE,KAAKS;IAA9C,CAbe,EAcf;MAAE/R,KAAK,EAAEA,KAAK,CAACgS,QAAf;MAAyBV,OAAO,EAAE,KAAKrQ;IAAvC,CAde,EAef;MAAEjB,KAAK,EAAEA,KAAK,CAACiS,WAAf;MAA4BX,OAAO,EAAE,KAAKrQ;IAA1C,CAfe,EAgBf;MAAEjB,KAAK,EAAEA,KAAK,CAACkS,WAAf;MAA4BZ,OAAO,EAAE,KAAKrQ;IAA1C,CAhBe,EAiBf;MAAEjB,KAAK,EAAEA,KAAK,CAACmS,eAAf;MAAgCb,OAAO,EAAE,KAAKrQ;IAA9C,CAjBe,EAkBf;MAAEjB,KAAK,EAAEA,KAAK,CAACoS,OAAf;MAAwBd,OAAO,EAAE,KAAKrQ;IAAtC,CAlBe,EAmBf;MAAEjB,KAAK,EAAEA,KAAK,CAACyN,WAAf;MAA4B6D,OAAO,EAAE,KAAKe;IAA1C,CAnBe,CAAnB;IAoBAjS,sBAAsB,CAAC,KAAKI,MAAN,EAAc,KAAK4Q,WAAnB,EAAgC,IAAhC,EAAsC,IAAtC,CAAtB;EACH,CA9BD;;EA+BA7Q,aAAa,CAAClB,SAAd,CAAwByS,WAAxB,GAAsC,YAAY;IAC9C,IAAI,KAAKtR,MAAL,CAAY8R,cAAZ,CAA2BC,IAA3B,KAAoC,WAAxC,EAAqD;MACjD,KAAKV,YAAL;IACH;EACJ,CAJD;;EAKAtR,aAAa,CAAClB,SAAd,CAAwBmT,mBAAxB,GAA8C,YAAY;IACtD,IAAI,KAAKhS,MAAL,CAAYqB,WAAhB,EAA6B;MACzB;IACH;;IACDtC,YAAY,CAACkT,MAAb,CAAoB,KAAKjS,MAAL,CAAY8C,OAAhC,EAAyC,WAAzC,EAAsD,KAAK/B,UAA3D;IACAhC,YAAY,CAACkT,MAAb,CAAoB,KAAKjS,MAAL,CAAY8C,OAAhC,EAAyC,OAAzC,EAAkD,KAAK1B,OAAvD;IACArC,YAAY,CAACkT,MAAb,CAAoB,KAAKjS,MAAL,CAAY8C,OAAhC,EAAyC,UAAzC,EAAqD,KAAKI,MAA1D;IACA,KAAKlD,MAAL,CAAY8C,OAAZ,CAAoBkP,mBAApB,CAAwC,OAAxC,EAAiD,KAAKrB,cAAtD,EAAsE,IAAtE;IACA/Q,sBAAsB,CAAC,KAAKI,MAAN,EAAc,KAAK4Q,WAAnB,EAAgC,KAAhC,CAAtB;EACH,CATD;;EAUA7Q,aAAa,CAAClB,SAAd,CAAwBqT,OAAxB,GAAkC,YAAY;IAC1C,KAAKF,mBAAL;EACH,CAFD;;EAGAjS,aAAa,CAAClB,SAAd,CAAwBwS,YAAxB,GAAuC,YAAY;IAC/C,IAAI/J,WAAW,GAAG,KAAKtH,MAAL,CAAYsH,WAA9B;;IACA,IAAI,KAAKtH,MAAL,CAAYqH,aAAZ,IAA6BC,WAA7B,IAA4CA,WAAW,CAAC6K,cAA5D,EAA4E;MACxE7K,WAAW,CAAC6K,cAAZ,GAA6B,KAA7B;MACA;IACH;;IACD,KAAK1F,QAAL,CAAc,KAAKtK,UAAL,GAAkBuK,YAAlB,EAAd;EACH,CAPD;;EAQA3M,aAAa,CAAClB,SAAd,CAAwB0S,sBAAxB,GAAiD,UAAUvQ,CAAV,EAAa;IAC1D,IAAI,CAAC,KAAKhB,MAAL,CAAYiL,uBAAjB,EAA0C;MACtC,IAAI7I,MAAM,GAAG,KAAKD,UAAL,GAAkBC,MAA/B;MACA,IAAIM,OAAO,GAAGN,MAAM,CAACM,OAArB;;MACA,QAAQ1B,CAAC,CAACqO,WAAV;QACI,KAAK,UAAL;QACA,KAAK,YAAL;UACI3M,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAACb,MAAR,IACT,CAAC,KAAK7B,MAAL,CAAYoS,aAAZ,CAA0BC,iBADlB,IACuC,CAACnT,iBAAiB,CAACkD,MAAM,CAACA,MAAP,CAAcM,OAAO,CAAC,CAAD,CAArB,CAAD,CADzD,GAETN,MAAM,CAACA,MAAP,CAAcM,OAAO,CAAC,CAAD,CAArB,EAA0BoH,OAA1B,CAAkC,CAAlC,CAFS,GAE8B9I,CAAC,CAACqO,WAAF,KAAkB,UAAlB,GAA+B3M,OAAO,CAAC,CAAD,CAAP,GAAa,CAA5C,GAAgDA,OAAO,CAAC,CAAD,CAAP,GAAa,CAFxG;UAGA;MANR;;MAQA,KAAKP,UAAL,GAAkBC,MAAlB,CAAyBM,OAAzB,GAAmCA,OAAnC;MACA,IAAI4E,WAAW,GAAG,KAAKtH,MAAL,CAAYsH,WAA9B;;MACA,IAAI,KAAKtH,MAAL,CAAYqH,aAAZ,IAA6BC,WAA7B,IAA4CA,WAAW,CAACgL,gBAA5D,EAA8E;QAC1E,IAAI/K,qBAAqB,GAAGD,WAAW,CAACE,wBAAZ,EAA5B;;QACA,IAAID,qBAAqB,CAAC1F,MAA1B,EAAkC;UAC9B,IAAI0F,qBAAqB,CAAC,CAAD,CAArB,CAAyBgL,aAAzB,CAAuChP,YAAvC,CAAoD,gBAApD,MAA0EvC,CAAC,CAACwR,UAAhF,EAA4F;YACxFjL,qBAAqB,CAAC,CAAD,CAArB,CAAyBxE,KAAzB;UACH,CAFD,MAGK;YACDwE,qBAAqB,CAAC,CAAD,CAArB,CAAyBxE,KAAzB;UACH;QACJ,CAPD,MAQK;UACDuE,WAAW,CAACxE,OAAZ,CAAoBC,KAApB;QACH;;QACDuE,WAAW,CAACgL,gBAAZ,GAA+B,KAA/B;QACA;MACH;;MACD,KAAK7F,QAAL,CAAc,KAAKtK,UAAL,GAAkBuK,YAAlB,EAAd;IACH;EACJ,CAhCD;;EAiCA3M,aAAa,CAAClB,SAAd,CAAwB+F,YAAxB,GAAuC,YAAY;IAC/C,KAAKzC,UAAL,GAAkBC,MAAlB,CAAyBM,OAAzB,GAAmC,KAAKP,UAAL,GAAkBC,MAAlB,CAAyBO,GAAzB,CAA6B,CAA7B,EAAgC,CAAC,CAAjC,EAAoC,CAAC,CAAD,EAAI,CAAJ,CAApC,EAA4C,WAA5C,EAAyD,KAAKR,UAAL,GAAkBS,SAAlB,EAAzD,CAAnC;IACA,KAAKsG,cAAL;EACH,CAHD;;EAIAnJ,aAAa,CAAClB,SAAd,CAAwBqK,cAAxB,GAAyC,YAAY;IACjD,IAAI,CAAC,KAAKjJ,WAAL,CAAiB6C,OAAlB,IAA6B,CAAC,KAAK7C,WAAL,CAAiBoK,cAAnD,EAAmE;MAC/D;IACH;;IACDjL,WAAW,CAAC,CAAC,KAAKa,WAAL,CAAiB6C,OAAlB,EAA2B,KAAK7C,WAAL,CAAiBoK,cAA5C,CAAD,EAA8D,CAAC,SAAD,EAAY,WAAZ,CAA9D,CAAX;EACH,CALD;;EAMAtK,aAAa,CAAClB,SAAd,CAAwB4T,cAAxB,GAAyC,YAAY;IACjD,IAAIpS,MAAM,GAAG,KAAKA,MAAlB;IACA,KAAKA,MAAL,GAAc,KAAd;IACA,OAAOA,MAAM,IAAI,CAAChC,MAAM,CAACwN,IAAP,CAAY,KAAKrL,WAAjB,EAA8BqB,MAAzC,GAAkD;MAAE0L,QAAQ,EAAE,IAAZ;MAAkBC,SAAS,EAAE;IAA7B,CAAlD,GAAwF,KAAKhN,WAApG;EACH,CAJD;;EAKAT,aAAa,CAAClB,SAAd,CAAwB6T,cAAxB,GAAyC,YAAY;IACjD,KAAKrS,MAAL,GAAc,IAAd;EACH,CAFD;;EAGAN,aAAa,CAAClB,SAAd,CAAwB8J,cAAxB,GAAyC,UAAU5C,MAAV,EAAkBE,MAAlB,EAA0B;IAC/D,IAAI+E,KAAK,GAAG,IAAZ;;IACA,IAAI,CAAC,KAAKhL,MAAL,CAAY2B,YAAZ,EAAD,IAA+B,KAAK3B,MAAL,CAAY0B,UAAZ,KAA2B,CAA9D,EAAiE;MAC7D;IACH,CAJ8D,CAK/D;;;IACA,IAAIkL,IAAJ;IACA,IAAIjM,OAAO,GAAG;MACV,QAAQ,YAAY;QAAE,OAAQ;UAAE4H,QAAQ,EAAE,CAACqE,IAAI,CAAC3I,SAAlB;UAA6BuE,QAAQ,EAAE;QAAvC,CAAR;MAAyD,CADrE;MAEV,OAAO,YAAY;QAAE,OAAQ;UAAED,QAAQ,EAAE,CAACqE,IAAI,CAAC3I,SAAlB;UAA6BuE,QAAQ,EAAE;QAAvC,CAAR;MAA0D,CAFrE;MAGV,YAAY,YAAY;QAAE,OAAQ;UAAED,QAAQ,EAAE,IAAZ;UAAkBC,QAAQ,EAAEwC,KAAK,CAAChL,MAAN,CAAa2B,YAAb;QAA5B,CAAR;MAAqE,CAHrF;MAIV,WAAW,YAAY;QAAE,OAAQ;UAAE4G,QAAQ,EAAE,KAAZ;UAAmBC,QAAQ,EAAE;QAA7B,CAAR;MAAgD;IAJ/D,CAAd;;IAMA,IAAI,EAAEzC,MAAM,IAAIpF,OAAZ,CAAJ,EAA0B;MACtB;IACH;;IACDiM,IAAI,GAAG3G,MAAM,CAACoH,OAAP,EAAP;IACA,IAAIlN,IAAI,GAAGQ,OAAO,CAACoF,MAAD,CAAP,EAAX;IACA,KAAKvE,SAAL,CAAe,CAACrB,IAAI,CAACoI,QAArB,EAA+BpI,IAAI,CAACqI,QAApC;IACA,KAAKrG,UAAL,GAAkBC,MAAlB,CAAyBM,OAAzB,GAAmCuD,MAAM,CAAC7D,MAAP,CAAcM,OAAjD;EACH,CApBD;;EAqBA3C,aAAa,CAAClB,SAAd,CAAwBgT,iBAAxB,GAA4C,UAAU7Q,CAAV,EAAa;IACrD,IAAI,EAAEA,CAAC,CAAC+D,KAAF,IAAW/D,CAAC,CAACoM,SAAF,CAAYnJ,SAAvB,IAAoCjD,CAAC,CAACkH,OAAF,CAAUnC,MAAV,KAAqB,OAAzD,KACE/E,CAAC,CAAChB,MAAF,CAASkB,SAAT,CAAmBC,QAAnB,CAA4B,cAA5B,KACAH,CAAC,CAAChB,MAAF,CAASkB,SAAT,CAAmBC,QAAnB,CAA4B,eAA5B,CADA,IACgDH,CAAC,CAAChB,MAAF,CAASkB,SAAT,CAAmBC,QAAnB,CAA4B,gBAA5B,CAFlD,CAAF,CAAJ,EAEyG;MACrG;IACH;;IACD,KAAK+H,cAAL;IACA,IAAIyJ,QAAQ,GAAG,KAAKxQ,UAAL,GAAkByQ,YAAlB,CAA+B,KAAKlM,iBAAL,EAA/B,CAAf;IACA,KAAK4F,iBAAL,CAAuBqG,QAAvB;IACA,KAAK1S,WAAL,CAAiBgD,UAAjB,GAA8B,IAA9B;EACH,CAVD;;EAWA,OAAOlD,aAAP;AACH,CA31BkC,EAAnC;;AA41BA,SAASA,aAAT;AACA;AACA;AACA;AACA;AACA;;AACA,IAAI8S,MAAM;AAAG;AAAe,YAAY;EACpC,SAASA,MAAT,GAAkB;IACd,KAAKzQ,MAAL,GAAc,EAAd;IACA,KAAKM,OAAL,GAAe,EAAf;EACH;;EACDmQ,MAAM,CAAChU,SAAP,CAAiBiU,GAAjB,GAAuB,UAAUvF,QAAV,EAAoBwF,WAApB,EAAiCC,KAAjC,EAAwC;IAC3DzF,QAAQ,GAAG0C,IAAI,CAACgD,GAAL,CAAS,CAAT,EAAYhD,IAAI,CAACC,GAAL,CAAS3C,QAAT,EAAmB,KAAKhL,IAAxB,CAAZ,CAAX;IACAwQ,WAAW,GAAG9C,IAAI,CAACgD,GAAL,CAAS,CAAT,EAAYhD,IAAI,CAACC,GAAL,CAAS6C,WAAT,EAAsB,KAAKhM,OAA3B,CAAZ,CAAd;IACA,KAAK3E,MAAL,CAAYmL,QAAZ,IAAwB,KAAKnL,MAAL,CAAYmL,QAAZ,KAAyB,EAAjD;IACA,KAAKnL,MAAL,CAAYmL,QAAZ,EAAsBwF,WAAtB,IAAqCC,KAAK,GAAG,CAAH,GAAO,CAAjD;EACH,CALD;;EAMAH,MAAM,CAAChU,SAAP,CAAiB8D,GAAjB,GAAuB,UAAU4K,QAAV,EAAoBwF,WAApB,EAAiCG,SAAjC,EAA4CnN,MAA5C,EAAoDnD,SAApD,EAA+D;IAClF,IAAIuQ,GAAG,GAAGJ,WAAV;;IACA,IAAIxF,QAAQ,GAAG2F,SAAS,CAAC,CAAD,CAApB,GAA0B,CAA9B,EAAiC;MAC7B,OAAO,CAAC3F,QAAD,EAAWwF,WAAX,CAAP;IACH;;IACDxF,QAAQ,GAAG0C,IAAI,CAACgD,GAAL,CAAS,CAAT,EAAYhD,IAAI,CAACC,GAAL,CAAS3C,QAAQ,GAAG2F,SAAS,CAAC,CAAD,CAA7B,EAAkC,KAAK3Q,IAAvC,CAAZ,CAAX;IACA,IAAI6Q,UAAU,GAAG,IAAjB;;IACA,IAAIlU,iBAAiB,CAAC,KAAKkD,MAAL,CAAYmL,QAAZ,CAAD,CAArB,EAA8C;MAC1C,OAAO,IAAP;IACH;;IACDwF,WAAW,GAAG9C,IAAI,CAACgD,GAAL,CAAS,CAAT,EAAYhD,IAAI,CAACC,GAAL,CAAS6C,WAAW,GAAGG,SAAS,CAAC,CAAD,CAAhC,EAAqC,KAAK9Q,MAAL,CAAYmL,QAAZ,EAAsB1L,MAAtB,GAA+B,CAApE,CAAZ,CAAd;;IACA,IAAIsR,GAAG,GAAGD,SAAS,CAAC,CAAD,CAAf,GAAqB,KAAK9Q,MAAL,CAAYmL,QAAZ,EAAsB1L,MAAtB,GAA+B,CAApD,IAAyDe,SAAS,CAAC2K,QAAD,EAAWwF,WAAX,EAAwBhN,MAAxB,CAAtE,EAAuG;MACnG,OAAO,CAACwH,QAAD,EAAW4F,GAAX,CAAP;IACH;;IACD,IAAIE,KAAK,GAAG,KAAKA,KAAL,CAAW,KAAKjR,MAAL,CAAYmL,QAAZ,CAAX,EAAkCwF,WAAlC,EAA+CG,SAA/C,EAA0D,IAA1D,EAAgEnN,MAAhE,CAAZ;IACAgN,WAAW,GAAGM,KAAK,KAAK,IAAV,GAAiBF,GAAjB,GAAuBE,KAArC;IACA,IAAIC,GAAG,GAAGtU,QAAQ,CAACuO,QAAQ,GAAG,GAAX,GAAiBwF,WAAlB,EAA+B,KAAK3Q,MAApC,CAAlB;;IACA,IAAImL,QAAQ,KAAK,KAAKhL,IAAlB,KAA2BwD,MAAM,KAAK,WAAX,IAA0BA,MAAM,KAAK,OAAhE,CAAJ,EAA8E;MAC1EmN,SAAS,CAAC,CAAD,CAAT,GAAe,CAAC,CAAhB;IACH;;IACD,IAAIG,KAAK,KAAK,IAAd,EAAoB;MAChB,KAAK,IAAIjJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK7H,IAAzB,EAA+B6H,CAAC,EAAhC,EAAoC;QAChC,IAAI,KAAKhI,MAAL,CAAYgI,CAAZ,EAAeoB,IAAf,CAAoB,UAAU+H,CAAV,EAAa;UAAE,OAAOA,CAAC,KAAK,CAAb;QAAiB,CAApD,CAAJ,EAA2D;UACvDH,UAAU,GAAG,KAAb;UACA;QACH;MACJ;;MACD,IAAIA,UAAJ,EAAgB;QACZ7F,QAAQ,GAAG,KAAK7K,OAAL,CAAa,CAAb,CAAX;QACA,OAAO,CAAC6K,QAAD,EAAWwF,WAAX,CAAP;MACH;IACJ;;IACD,OAAO,KAAKS,OAAL,CAAaF,GAAb,KAAqB,CAAC1Q,SAAS,CAAC2K,QAAD,EAAWwF,WAAX,EAAwBhN,MAAxB,CAA/B,GACH,KAAKpD,GAAL,CAAS4K,QAAT,EAAmB4F,GAAnB,EAAwBD,SAAxB,EAAmCnN,MAAnC,EAA2CnD,SAA3C,CADG,GACqD,CAAC2K,QAAD,EAAWwF,WAAX,CAD5D;EAEH,CAlCD;;EAmCAF,MAAM,CAAChU,SAAP,CAAiBwU,KAAjB,GAAyB,UAAUI,MAAV,EAAkBC,KAAlB,EAAyBR,SAAzB,EAAoCS,MAApC,EAA4C5N,MAA5C,EAAoD;IACzE,IAAK,CAAC2N,KAAK,GAAG,CAAR,IAAaA,KAAK,KAAKD,MAAM,CAAC5R,MAA/B,KAA0C,KAAK2R,OAAL,CAAaC,MAAM,CAACC,KAAD,CAAnB,CAA1C,IACG3N,MAAM,KAAK,SAAX,IAAwBA,MAAM,KAAK,WADvC,IACwD,CAAC0N,MAAM,CAACjI,IAAP,CAAY,UAAU+H,CAAV,EAAa;MAAE,OAAOA,CAAC,KAAK,CAAb;IAAiB,CAA5C,CAD7D,EAC4G;MACxG,OAAO,IAAP;IACH;;IACD,OAAO,CAAC,KAAKC,OAAL,CAAaC,MAAM,CAACC,KAAD,CAAnB,CAAD,GAA+BA,KAA/B,GACH,KAAKL,KAAL,CAAWI,MAAX,EAAoB,CAAC,SAAD,EAAY,WAAZ,EAAyB,SAAzB,EAAoC,WAApC,EAAiD3J,OAAjD,CAAyD/D,MAAzD,MAAqE,CAAC,CAAvE,GAA4E4N,MAAM,GAAG,CAAH,GAAO,EAAED,KAA3F,GAAmGA,KAAK,GAAGR,SAAS,CAAC,CAAD,CAAvI,EAA4IA,SAA5I,EAAuJ,KAAvJ,EAA8JnN,MAA9J,CADJ;EAEH,CAPD;;EAQA8M,MAAM,CAAChU,SAAP,CAAiBgE,MAAjB,GAA0B,UAAU0K,QAAV,EAAoBwF,WAApB,EAAiC;IACvDxF,QAAQ,GAAG0C,IAAI,CAACgD,GAAL,CAAS,CAAT,EAAYhD,IAAI,CAACC,GAAL,CAAS3C,QAAT,EAAmB,KAAKhL,IAAxB,CAAZ,CAAX;IACAwQ,WAAW,GAAG9C,IAAI,CAACgD,GAAL,CAAS,CAAT,EAAYhD,IAAI,CAACC,GAAL,CAAS6C,WAAT,EAAsB,KAAK3Q,MAAL,CAAYmL,QAAZ,EAAsB1L,MAAtB,GAA+B,CAArD,CAAZ,CAAd;IACA,KAAKa,OAAL,GAAe,CAAC6K,QAAD,EAAWwF,WAAX,CAAf;EACH,CAJD;;EAKAF,MAAM,CAAChU,SAAP,CAAiBwD,QAAjB,GAA4B,UAAUE,IAAV,EAAgBE,QAAhB,EAA0BgM,aAA1B,EAAyC;IACjE,KAAKlM,IAAL,GAAYA,IAAI,CAACV,MAAL,GAAc,CAA1B;IACA,KAAKO,MAAL,GAAc,EAAd;;IACA,KAAK,IAAIgI,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG7H,IAAI,CAACV,MAAzB,EAAiCuI,CAAC,EAAlC,EAAsC;MAClC,IAAID,KAAK,GAAG5H,IAAI,CAAC6H,CAAD,CAAJ,CAAQD,KAAR,CAAcmE,MAAd,CAAqB,UAAUsF,CAAV,EAAa;QAAE,OAAOA,CAAC,CAACC,SAAF,KAAgB,IAAvB;MAA8B,CAAlE,CAAZ;MACA,KAAK9M,OAAL,GAAekJ,IAAI,CAACgD,GAAL,CAAS9I,KAAK,CAACtI,MAAN,GAAe,CAAxB,EAA2B,KAAKkF,OAAL,GAAe,CAA1C,CAAf;MACA,IAAI+M,eAAe,GAAG,CAAtB;;MACA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG5J,KAAK,CAACtI,MAA1B,EAAkCkS,CAAC,EAAnC,EAAuC;QACnC,IAAI5J,KAAK,CAAC4J,CAAD,CAAL,CAASC,MAAT,IAAmB7J,KAAK,CAAC4J,CAAD,CAAL,CAASC,MAAT,CAAgBjN,OAAvC,EAAgD;UAC5C+M,eAAe,GAAG,KAAKG,YAAL,CAAkB9J,KAAK,CAAC4J,CAAD,CAAL,CAASC,MAAT,CAAgBjN,OAAlC,EAA2C+M,eAA3C,CAAlB;QACH,CAFD,MAGK;UACDA,eAAe;QAClB;;QACD,KAAKhB,GAAL,CAAS1I,CAAT,EAAY2J,CAAZ,EAAexR,IAAI,CAAC6H,CAAD,CAAJ,CAAQoE,OAAR,KAAoB,KAApB,GAA4B,KAA5B,GAAoC/L,QAAQ,CAACF,IAAI,CAAC6H,CAAD,CAAL,EAAUD,KAAK,CAAC4J,CAAD,CAAf,EAAoBtF,aAApB,CAA3D;MACH;;MACD,KAAK1H,OAAL,GAAekJ,IAAI,CAACgD,GAAL,CAASa,eAAe,GAAG,CAA3B,EAA8B,KAAK/M,OAAL,GAAe,CAA7C,CAAf;IACH;;IACD,OAAO,KAAK3E,MAAZ;EACH,CAnBD;;EAoBAyQ,MAAM,CAAChU,SAAP,CAAiBoV,YAAjB,GAAgC,UAAUC,UAAV,EAAsBC,kBAAtB,EAA0C;IACtE,IAAIpN,OAAO,GAAGmN,UAAd;IACA,IAAIJ,eAAe,GAAGK,kBAAtB;;IACA,KAAK,IAAI/J,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGrD,OAAO,CAAClF,MAA5B,EAAoCuI,CAAC,EAArC,EAAyC;MACrC,IAAIrD,OAAO,CAACqD,CAAD,CAAP,CAAWrD,OAAf,EAAwB;QACpB+M,eAAe,GAAG,KAAKG,YAAL,CAAkBlN,OAAO,CAACqD,CAAD,CAAP,CAAWrD,OAA7B,EAAsC+M,eAAtC,CAAlB;MACH,CAFD,MAGK;QACDA,eAAe;MAClB;IACJ;;IACD,OAAOA,eAAP;EACH,CAZD;;EAaAjB,MAAM,CAAChU,SAAP,CAAiB2U,OAAjB,GAA2B,UAAU/H,KAAV,EAAiB;IACxC,OAAOA,KAAK,KAAK,CAAV,IAAeA,KAAK,KAAK2I,SAAhC;EACH,CAFD;;EAGA,OAAOvB,MAAP;AACH,CAhG2B,EAA5B;;AAiGA,SAASA,MAAT;AACA;AACA;AACA;;AACA,IAAI9E,YAAY;AAAG;AAAe,YAAY;EAC1C,SAASA,YAAT,CAAsB/N,MAAtB,EAA8B;IAC1B,IAAIgL,KAAK,GAAG,IAAZ;;IACA,KAAK5I,MAAL,GAAc,IAAIyQ,MAAJ,EAAd;IACA,KAAKjK,WAAL,GAAmB,KAAnB;IACA,KAAK5I,MAAL,GAAcA,MAAd;IACA,KAAKqU,UAAL,GAAkB;MACd,cAAc,CAAC,CAAD,EAAI,CAAJ,CADA;MAEd,OAAO,CAAC,CAAD,EAAI,CAAJ,CAFO;MAGd,aAAa,CAAC,CAAD,EAAI,CAAC,CAAL,CAHC;MAId,YAAY,CAAC,CAAD,EAAI,CAAC,CAAL,CAJE;MAKd,WAAW,CAAC,CAAC,CAAF,EAAK,CAAL,CALG;MAMd,aAAa,CAAC,CAAD,EAAI,CAAJ,CANC;MAOd,WAAW,CAAC,CAAC,CAAF,EAAK,CAAL,CAPG;MAQd,aAAa,CAAC,CAAD,EAAI,CAAJ,CARC;MASd,cAAc,CAAC,CAAD,EAAI,CAAJ,CATA;MAUd,aAAa,CAAC,CAAD,EAAI,CAAC,CAAL,CAVC;MAWd,SAAS,CAAC,CAAD,EAAI,CAAJ,CAXK;MAYd,cAAc,CAAC,CAAC,CAAF,EAAK,CAAL;IAZA,CAAlB;;IAcA,KAAKC,YAAL,GAAoB,UAAUvO,MAAV,EAAkB;MAClC,IAAIwO,GAAG,GAAG;QACN,QAAQ,CAACvJ,KAAK,CAAC5I,MAAN,CAAaM,OAAb,CAAqB,CAArB,CAAD,EAA0B,CAAC,CAA3B,EAA8B,CAA9B,EAAiC,CAAjC,CADF;QAEN,OAAO,CAACsI,KAAK,CAAC5I,MAAN,CAAaM,OAAb,CAAqB,CAArB,CAAD,EAA0BsI,KAAK,CAAC5I,MAAN,CAAa2E,OAAb,GAAuB,CAAjD,EAAoD,CAApD,EAAuD,CAAC,CAAxD,CAFD;QAGN,YAAY,CAAC,CAAD,EAAI,CAAC,CAAL,EAAQ,CAAR,EAAW,CAAX,CAHN;QAIN,WAAW,CAACiE,KAAK,CAAC5I,MAAN,CAAaG,IAAd,EAAoByI,KAAK,CAAC5I,MAAN,CAAa2E,OAAb,GAAuB,CAA3C,EAA8C,CAA9C,EAAiD,CAAC,CAAlD;MAJL,CAAV;MAMA,OAAOwN,GAAG,CAACxO,MAAD,CAAH,IAAe,IAAtB;IACH,CARD;EASH;;EACDgI,YAAY,CAAClP,SAAb,CAAuB2V,QAAvB,GAAkC,YAAY;IAC1C,OAAQ,KAAKxU,MAAL,CAAY2B,YAAZ,KACJ,KAAK3B,MAAL,CAAYmC,UAAZ,GAAyB6F,aAAzB,CAAuC,4BAAvC,CADI,GAEJ,KAAKhI,MAAL,CAAY4D,eAAZ,EAFJ;EAGH,CAJD;;EAKAmK,YAAY,CAAClP,SAAb,CAAuBwG,UAAvB,GAAoC,UAAUrE,CAAV,EAAa;IAC7C,IAAIkS,SAAS,GAAG,KAAKmB,UAAL,CAAgBrT,CAAC,CAAC+E,MAAlB,CAAhB;IACA,IAAIrD,OAAO,GAAG,KAAK+R,oBAAL,CAA0BzT,CAAC,CAAC+E,MAA5B,EAAoCmN,SAApC,EAA+ClS,CAAC,CAAC+E,MAAF,IAAY,KAAKsO,UAAhE,EAA4ErT,CAA5E,CAAd;;IACA,IAAI,CAAC0B,OAAL,EAAc;MACV;IACH;;IACD,IAAK,CAAC,CAAC,KAAD,EAAQ,UAAR,EAAoBoH,OAApB,CAA4B9I,CAAC,CAAC+E,MAA9B,IAAwC,CAAC,CAAzC,IAA8C,KAAK3D,MAAL,CAAYM,OAA1D,IAAqE,EAAtE,EAA0EmG,QAA1E,OAAyFnG,OAAO,CAACmG,QAAR,EAA1F,IACI,KAAK7I,MAAL,CAAYsF,WAAZ,IAA2B,CAAC,KAAKtF,MAAL,CAAYwF,WAAZ,CAAwBC,QAAxB,CAAiCK,kBAAjC,EAA5B,IACG,KAAK1D,MAAL,CAAYM,OAAZ,CAAoB,CAApB,MAA2B,KAAKN,MAAL,CAAYG,IAD1C,KACoD,KAAKvC,MAAL,CAAY8B,YAAZ,CAAyBC,IAAzB,KAAkC,OAAlC,IACjD,KAAK/B,MAAL,CAAY8B,YAAZ,CAAyBwI,WADwB,IACTtJ,CAAC,CAACwF,OAAF,KAAc,EADN,IACcxF,CAAC,CAACwF,OAAF,KAAc,EAF/E,CADR,EAG8F;MAC1F,IAAI9D,OAAO,CAACmG,QAAR,OAAuB,CAAC,KAAKzG,MAAL,CAAYG,IAAb,EAAmB,KAAKH,MAAL,CAAY2E,OAA/B,EAAwC8B,QAAxC,EAAvB,IACAnG,OAAO,CAACmG,QAAR,OAAuB,CAAC,CAAD,EAAI,CAAJ,EAAOA,QAAP,EADvB,IAC6C,KAAKzG,MAAL,CAAYM,OAAZ,CAAoB,CAApB,MAA2B,KAAKN,MAAL,CAAYG,IAAvC,IAC7C,KAAKH,MAAL,CAAYM,OAAZ,CAAoBmG,QAApB,OAAmCnG,OAAO,CAACmG,QAAR,EAFvC,EAE4D;QACxD,OAAO,KAAP;MACH,CAJD,MAKK;QACDnG,OAAO,GAAG,KAAKgS,WAAL,CAAiBhS,OAAO,CAAC,CAAD,CAAxB,EAA6BA,OAAO,CAAC,CAAD,CAApC,EAAyC1B,CAAC,CAAC+E,MAA3C,CAAV;MACH;IACJ;;IACD,KAAK3D,MAAL,CAAYS,MAAZ,CAAmBH,OAAO,CAAC,CAAD,CAA1B,EAA+BA,OAAO,CAAC,CAAD,CAAtC;EACH,CApBD;;EAqBAqL,YAAY,CAAClP,SAAb,CAAuB6V,WAAvB,GAAqC,UAAUnH,QAAV,EAAoBC,SAApB,EAA+BzH,MAA/B,EAAuC;IACxE,IAAI4O,IAAI,GAAG,KAAK3U,MAAhB;IACA,IAAI0U,WAAW,GAAGC,IAAI,CAAC7S,YAAL,CAAkB8S,gBAAlB,KAAuCD,IAAI,CAACxR,MAAL,IAAewR,IAAI,CAACE,oBAA3D,CAAlB;IACA,IAAIC,YAAY,GAAGH,IAAI,CAACI,qBAAL,CAA2BJ,IAAI,CAACK,iBAAL,GAAyB,CAAzB,EAA4BC,KAAvD,CAAnB;IACA,IAAIC,IAAI,GAAG,KAAKV,QAAL,GAAgBjS,IAAhB,CAAqBgL,QAArB,EAA+BpD,KAA/B,CAAqCqD,SAArC,CAAX;;IACA,IAAIzH,MAAM,KAAK,KAAX,IAAoB2O,WAAxB,EAAqC;MACjCnH,QAAQ;MACR,IAAImG,KAAK,GAAI,KAAKc,QAAL,GAAgBjS,IAAhB,CAAqBgL,QAArB,EAA+B4H,sBAA/B,CAAsD,cAAtD,EAAsEtT,MAAtE,GACT,KAAK2S,QAAL,GAAgBjS,IAAhB,CAAqBgL,QAArB,EAA+B4H,sBAA/B,CAAsD,qBAAtD,EAA6EtT,MADjF;MAEA2L,SAAS,GAAGsH,YAAY,GAAGpB,KAA3B;IACH;;IACD,IAAI3N,MAAM,KAAK,UAAX,IAAyB2O,WAA7B,EAA0C;MACtCnH,QAAQ;MACRC,SAAS,GAAGmH,IAAI,CAACI,qBAAL,CAA2BJ,IAAI,CAACK,iBAAL,GAAyBL,IAAI,CAACK,iBAAL,GAAyBnT,MAAzB,GAAkC,CAA3D,EAA8DoT,KAAzF,CAAZ;IACH;;IACD,OAAO,CAACC,IAAI,CAAChU,SAAL,CAAeC,QAAf,CAAwBrB,QAAQ,CAACsV,OAAjC,CAAD,IAA8C,CAACF,IAAI,CAAChU,SAAL,CAAeC,QAAf,CAAwB,cAAxB,CAA/C,IACH,CAAC+T,IAAI,CAAChU,SAAL,CAAeC,QAAf,CAAwB,gBAAxB,CADE,IAC2C,CAAC+T,IAAI,CAAChU,SAAL,CAAeC,QAAf,CAAwB,iBAAxB,CAD5C,GAEH,KAAKuT,WAAL,CAAiBnH,QAAjB,EAA2BC,SAA3B,EAAsCzH,MAAtC,CAFG,GAE6C,CAACwH,QAAD,EAAWC,SAAX,CAFpD;EAGH,CAlBD;;EAmBAO,YAAY,CAAClP,SAAb,CAAuB4V,oBAAvB,GAA8C,UAAU1O,MAAV,EAAkBmN,SAAlB,EAA6BmC,SAA7B,EAAwCrU,CAAxC,EAA2C;IACrF,IAAIkS,SAAS,KAAK,KAAK,CAAvB,EAA0B;MAAEA,SAAS,GAAG,CAAC,CAAD,EAAI,CAAJ,CAAZ;IAAqB;;IACjD,IAAI,CAACmC,SAAD,IAAc,CAAC,KAAKf,YAAL,CAAkBvO,MAAlB,CAAf,IAA6C,KAAK3D,MAAL,CAAYM,OAAZ,CAAoBb,MAApB,KAA+B,CAAhF,EAAoF;MAChF,OAAO,IAAP;IACH;;IACD,IAAI,CAAC,KAAKyT,iBAAL,CAAuBtU,CAAvB,CAAL,EAAgC;MAC5B,OAAO,KAAKoB,MAAL,CAAYM,OAAnB;IACH,CAPoF,CAQrF;;;IACA,IAAI4K,EAAE,GAAG,KAAKgH,YAAL,CAAkBvO,MAAlB,KAA6B,KAAK3D,MAAL,CAAYM,OAAZ,CAAoB6S,MAApB,CAA2BrC,SAA3B,CAAtC;IAAA,IAA6E3F,QAAQ,GAAGD,EAAE,CAAC,CAAD,CAA1F;IAAA,IAA+FE,SAAS,GAAGF,EAAE,CAAC,CAAD,CAA7G;IAAA,IAAkHkI,EAAE,GAAGlI,EAAE,CAAC,CAAD,CAAzH;IAAA,IAA8HmI,EAAE,GAAGnI,EAAE,CAAC,CAAD,CAArI;;IACA,IAAIvH,MAAM,KAAK,SAAf,EAA0B;MACtB,IAAIqD,oBAAoB,GAAG,CAAC,KAAKhH,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAA7B,EACvB,KAAKO,MAAL,CAAYA,MAAZ,CAAmB,KAAKA,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAA/C,EAAkDA,MAAlD,GAA2D,CADpC,CAA3B;;MAEA,IAAI,KAAKO,MAAL,CAAYA,MAAZ,CAAmBgH,oBAAoB,CAAC,CAAD,CAAvC,EAA4CA,oBAAoB,CAAC,CAAD,CAAhE,MAAyE,CAA7E,EAAgF;QAC5EA,oBAAoB,GAAGvJ,aAAa,CAAC,KAAKuC,MAAL,CAAYA,MAAb,EAAqBgH,oBAArB,EAA2C,KAA3C,CAApC;MACH;;MACDmE,QAAQ,GAAGnE,oBAAoB,CAAC,CAAD,CAA/B;MACAoE,SAAS,GAAGpE,oBAAoB,CAAC,CAAD,CAApB,GAA0B,CAAtC;IACH;;IACD,IAAI1G,OAAO,GAAG,KAAKN,MAAL,CAAYO,GAAZ,CAAgB4K,QAAhB,EAA0BC,SAA1B,EAAqC,CAACgI,EAAD,EAAKC,EAAL,CAArC,EAA+C1P,MAA/C,EAAuD,KAAKnD,SAAL,EAAvD,CAAd;IACA,OAAOF,OAAP;EACH,CArBD;;EAsBAqL,YAAY,CAAClP,SAAb,CAAuBkF,OAAvB,GAAiC,UAAU/C,CAAV,EAAagD,KAAb,EAAoB;IACjD,IAAI/C,MAAM,GAAGD,CAAC,CAACC,MAAf;IACA,KAAKA,MAAL,GAAcA,MAAd;IACAA,MAAM,GAAIA,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0BrB,QAAQ,CAACsV,OAAnC,IAA8CnU,MAA9C,GAAuDhC,OAAO,CAACgC,MAAD,EAAS,IAAT,CAAxE;IACAA,MAAM,GAAGA,MAAM,GAAGA,MAAH,GAAYhC,OAAO,CAAC+B,CAAC,CAACC,MAAH,EAAW,wBAAX,CAAP,IACpBhC,OAAO,CAAC+B,CAAC,CAACC,MAAH,EAAW,sBAAX,CADd;IAEAA,MAAM,GAAGhC,OAAO,CAAC+B,CAAC,CAACC,MAAH,EAAW,iBAAX,CAAP,GACL/B,iBAAiB,CAACD,OAAO,CAACA,OAAO,CAAC+B,CAAC,CAACC,MAAH,EAAW,SAAX,CAAR,EAA+B,iBAA/B,CAAR,CAAjB,GAA8E,IAA9E,GAAqFA,MADhF,GACyFA,MADlG;IAEAA,MAAM,GAAGA,MAAM,IAAIhC,OAAO,CAACgC,MAAD,EAAS,OAAT,CAAP,CAAyBC,SAAzB,CAAmCC,QAAnC,CAA4CrB,QAAQ,CAAC4V,KAArD,CAAV,GAAwEzU,MAAxE,GAAiF,IAA1F;;IACA,IAAI,CAACA,MAAL,EAAa;MACT,OAAO,KAAP;IACH;;IACD,IAAIqM,EAAE,GAAG,CAACrM,MAAM,CAACsR,aAAP,CAAqBhF,QAAtB,EAAgCtM,MAAM,CAACuM,SAAvC,CAAT;IAAA,IAA4DD,QAAQ,GAAGD,EAAE,CAAC,CAAD,CAAzE;IAAA,IAA8EE,SAAS,GAAGF,EAAE,CAAC,CAAD,CAA5F;IACA,IAAIqI,EAAE,GAAG,KAAKvT,MAAL,CAAYM,OAArB;IAAA,IAA8BkT,SAAS,GAAGD,EAAE,CAAC,CAAD,CAA5C;IAAA,IAAiDE,UAAU,GAAGF,EAAE,CAAC,CAAD,CAAhE;IACA,IAAIrC,GAAG,GAAGtU,QAAQ,CAACuO,QAAQ,GAAG,GAAX,GAAiBC,SAAlB,EAA6B,KAAKpL,MAAL,CAAYA,MAAzC,CAAlB;;IACA,IAAI,KAAKA,MAAL,CAAYoR,OAAZ,CAAoBF,GAApB,KAA6B,CAACtP,KAAD,IAAU4R,SAAS,KAAKrI,QAAxB,IAAoCsI,UAAU,KAAKrI,SAAhF,IACC,CAAC7N,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAWnB,QAAQ,CAACsV,OAApB,CAAb,IAA6C,CAACzV,YAAY,CAACqB,CAAC,CAACC,MAAH,EAAW,gBAAX,CAD/D,EAC8F;MAC1F,OAAO,KAAP;IACH;;IACD,KAAKmB,MAAL,CAAYS,MAAZ,CAAmB0K,QAAnB,EAA6BC,SAA7B;EACH,CApBD;;EAqBAO,YAAY,CAAClP,SAAb,CAAuB6N,YAAvB,GAAsC,YAAY;IAC9C,IAAIE,IAAI,GAAG,EAAX;IACA,IAAIU,EAAE,GAAG,KAAKlL,MAAL,CAAYM,OAArB;IAAA,IAA8BiT,EAAE,GAAGrI,EAAE,CAAC,CAAD,CAArC;IAAA,IAA0CC,QAAQ,GAAGoI,EAAE,KAAK,KAAK,CAAZ,GAAgB,CAAhB,GAAoBA,EAAzE;IAAA,IAA6EG,EAAE,GAAGxI,EAAE,CAAC,CAAD,CAApF;IAAA,IAAyFE,SAAS,GAAGsI,EAAE,KAAK,KAAK,CAAZ,GAAgB,CAAhB,GAAoBA,EAAzH;IACA,KAAK1T,MAAL,CAAYM,OAAZ,GAAsB,CAAC6K,QAAD,EAAWC,SAAX,CAAtB;IACAZ,IAAI,CAAC9J,OAAL,GAAe,CAAC5D,iBAAiB,CAAC,KAAKsV,QAAL,GAAgBjS,IAAhB,CAAqBgL,QAArB,CAAD,CAAlB,GAAqD,KAAKiH,QAAL,GAAgBjS,IAAhB,CAAqBgL,QAArB,EAA+BpD,KAA/B,CAAqCqD,SAArC,CAArD,GAAuG,IAAtH;;IACA,IAAI,CAACZ,IAAI,CAAC9J,OAAV,EAAmB;MACf,OAAO8J,IAAP;IACH;;IACDA,IAAI,CAACvC,cAAL,GAAsB,CAACuC,IAAI,CAAC9J,OAAL,CAAa5B,SAAb,CAAuBC,QAAvB,CAAgC,eAAhC,CAAD,IAAqD,CAACyL,IAAI,CAAC9J,OAAL,CAAa5B,SAAb,CAAuBC,QAAvB,CAAgC,cAAhC,CAAtD,GAChB,KAAKyR,YAAL,CAAkBhG,IAAI,CAAC9J,OAAvB,CADgB,GACkB8J,IAAI,CAAC9J,OAD7C;IAEA8J,IAAI,CAACvC,cAAL,GAAsBuC,IAAI,CAAC9J,OAAL,CAAa5B,SAAb,CAAuBC,QAAvB,CAAgC,cAAhC,KAAmDyL,IAAI,CAAC9J,OAAL,CAAakF,aAAb,CAA2B,cAA3B,CAAnD,GAChB4E,IAAI,CAAC9J,OAAL,CAAakF,aAAb,CAA2B,cAA3B,CADgB,GAC6B4E,IAAI,CAACvC,cADxD;IAEAuC,IAAI,CAACxE,OAAL,GAAe,IAAf;IACAwE,IAAI,CAACpD,GAAL,GAAWoD,IAAI,CAAC9J,OAAL,CAAayP,aAAb,CAA2BhP,YAA3B,CAAwC,UAAxC,CAAX;IACA,OAAOqJ,IAAP;EACH,CAfD;;EAgBAmB,YAAY,CAAClP,SAAb,CAAuB+T,YAAvB,GAAsC,UAAU9P,OAAV,EAAmB;IACrD,IAAIiT,KAAK,GAAG,+FAAZ;IACA,IAAIC,UAAU,GAAG,CAAC9W,iBAAiB,CAACD,OAAO,CAAC6D,OAAD,EAAU,iBAAV,CAAR,CAAnC;;IACA,IAAI,KAAK9C,MAAL,CAAYmD,MAAhB,EAAwB;MACpB4S,KAAK,GAAG,wEAAR;IACH;;IACD,IAAIE,KAAK,GAAG,GAAGhP,KAAH,CAASC,IAAT,CAAcpE,OAAO,CAACiF,gBAAR,CAAyBgO,KAAzB,CAAd,CAAZ;IACA;AACR;AACA;AACA;;IACQ,OAAOE,KAAK,CAACpU,MAAN,GAAemU,UAAU,IAAIC,KAAK,CAACpU,MAAN,GAAe,CAA7B,GAAiC,KAAKZ,MAAtC,GAA+CgV,KAAK,CAAC,CAAD,CAAnE,GAAyEnT,OAAhF;EACH,CAZD;;EAaAiL,YAAY,CAAClP,SAAb,CAAuB4D,QAAvB,GAAkC,UAAUsM,GAAV,EAAemG,IAAf,EAAqBzG,aAArB,EAAoC;IAClE,IAAIyH,KAAK,GAAG,CAAC3W,QAAQ,CAAC4W,MAAV,EAAkB5W,QAAQ,CAAC6W,YAA3B,EAAyC7W,QAAQ,CAAC8W,cAAlD,EAAkE9W,QAAQ,CAAC+W,YAA3E,CAAZ;IACA,OAAO,CAAEvH,GAAG,CAACvM,SAAJ,IAAiB0S,IAAI,CAAC1G,OAAtB,KAAkC0G,IAAI,CAACqB,UAAL,IAAmBrB,IAAI,CAACc,UAA1D,CAAD,IACAjH,GAAG,CAACvM,SAAJ,IAAiB0S,IAAI,CAACsB,QAAL,KAAkBjX,QAAQ,CAACkX,YAA5C,IAA4DvX,iBAAiB,CAACgW,IAAI,CAAC1G,OAAN,CAD7E,IAEA,CAACO,GAAG,CAACvM,SAAL,IAAkB0T,KAAK,CAACpM,OAAN,CAAcoL,IAAI,CAACsB,QAAnB,IAA+B,CAAC,CAFlD,IAGAtB,IAAI,CAAClB,MAAL,IAAekB,IAAI,CAAC1G,OAApB,IAA+B0G,IAAI,CAAClB,MAAL,CAAYjC,IAAZ,KAAqB,UAHpD,IAIAmD,IAAI,CAACsB,QAAL,KAAkBjX,QAAQ,CAACmX,aAJ3B,IAKA3H,GAAG,CAACvM,SAAJ,IAAiBiM,aALlB,KAMA,EAAEM,GAAG,CAAC4H,IAAJ,KAAa,QAAb,IAAyB5H,GAAG,CAAC6H,OAA/B,CANP;EAOH,CATD;;EAUA7I,YAAY,CAAClP,SAAb,CAAuBgY,oBAAvB,GAA8C,UAAUnD,KAAV,EAAiB;IAC3D,IAAIoD,SAAS,GAAGpD,KAAhB;;IACA,KAAK,IAAItJ,CAAC,GAAGsJ,KAAR,EAAeqD,GAAG,GAAG,KAAK3U,MAAL,CAAYG,IAAtC,EAA4C6H,CAAC,IAAI2M,GAAjD,EAAsD3M,CAAC,EAAvD,EAA2D;MACvD,IAAI,KAAKhI,MAAL,CAAYA,MAAZ,CAAmBsR,KAAnB,EAA0B5J,OAA1B,CAAkC,CAAlC,MAAyC,CAAC,CAA9C,EAAiD;QAC7C4J,KAAK,GAAGA,KAAK,GAAG,CAAhB;MACH,CAFD,MAGK;QACD,OAAOA,KAAP;MACH;IACJ;;IACD,KAAK9K,WAAL,GAAmB,IAAnB;IACA,OAAOkO,SAAP;EACH,CAZD;;EAaA/I,YAAY,CAAClP,SAAb,CAAuBmY,wBAAvB,GAAkD,UAAUtD,KAAV,EAAiB;IAC/D,IAAIuD,UAAU,GAAGvD,KAAjB;;IACA,KAAK,IAAItJ,CAAC,GAAGsJ,KAAR,EAAeqD,GAAG,GAAG,CAA1B,EAA6B3M,CAAC,IAAI2M,GAAlC,EAAuC3M,CAAC,EAAxC,EAA4C;MACxC,IAAI,KAAKhI,MAAL,CAAYA,MAAZ,CAAmBsR,KAAnB,EAA0B5J,OAA1B,CAAkC,CAAlC,MAAyC,CAAC,CAA9C,EAAiD;QAC7C4J,KAAK,GAAGA,KAAK,GAAG,CAAhB;;QACA,IAAIA,KAAK,GAAG,CAAZ,EAAe;UACX,KAAK9K,WAAL,GAAmB,IAAnB;UACA,OAAOqO,UAAP;QACH;MACJ,CAND,MAOK;QACD,OAAOvD,KAAP;MACH;IACJ;;IACD,OAAOuD,UAAP;EACH,CAfD;;EAgBAlJ,YAAY,CAAClP,SAAb,CAAuByJ,IAAvB,GAA8B,UAAUvC,MAAV,EAAkBrD,OAAlB,EAA2B;IACrD,IAAIwU,UAAU,GAAI,KAAKlX,MAAL,CAAYmX,kBAAZ,MACb,CAACpR,MAAM,KAAK,WAAX,IAA0BA,MAAM,KAAK,UAAtC,KAAqDrD,OAAO,CAAC,CAAD,CAAP,KAAe,CADxD,IAETA,OAAO,CAAC,CAAD,CAAP,GAAa,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAAzC,IAA8CkE,MAAM,KAAK,KAAzD,IAAkE,KAAK/F,MAAL,CAAYyE,aAAZ,OAAgC,MAAlG,IACG/B,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CAH1B;IAIA,IAAIoF,KAAK,GAAI,CAACjK,MAAM,KAAK,YAAX,IAA2BA,MAAM,KAAK,KAAvC,KAAiDrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAY2E,OAA7E,IACJhB,MAAM,KAAK,UAAX,IAAyB,KAAK/F,MAAL,CAAYyE,aAAZ,OAAgC,OAAzD,IACG/B,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BoH,OAA/B,CAAuC,CAAvC,CAF1B;IAGA,IAAIsN,MAAM,GAAG,KAAKpX,MAAL,CAAYyE,aAAZ,OAAgC3E,QAAQ,CAAC4E,SAAzC,IAAsDsL,KAAnE;;IACA,IAAI,KAAKhQ,MAAL,CAAYyE,aAAZ,OAAgC,OAApC,EAA6C;MACzCyS,UAAU,GAAGlH,KAAb;IACH;;IACD,KAAKpH,WAAL,GAAmB,KAAnB;IACA,IAAIyO,WAAW,GAAG,KAAKrX,MAAL,CAAY0B,UAAZ,KAA2B,CAA3B,IAAgCqE,MAAM,KAAK,YAA7D;IACA,IAAIuR,UAAU,GAAI,CAACvR,MAAM,KAAK,SAAX,IAAwBsR,WAAzB,KAAyC3U,OAAO,CAAC,CAAD,CAAP,KAAe,CAAzD,IACTqD,MAAM,KAAK,UAAX,IAAyB,KAAK/F,MAAL,CAAYyE,aAAZ,OAAgC,OAAzD,IAAoE/B,OAAO,CAAC,CAAD,CAAP,KAAe,CAAnF,IACGA,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BoH,OAA/B,CAAuC,CAAvC,CAF1B;;IAGA,IAAI,CAAC,KAAK9J,MAAL,CAAY2B,YAAZ,EAAD,IAA+BoE,MAAM,KAAK,KAA1C,IACArD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CADf,IACgE,KAAKxI,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAA5B,KAAkCa,OAAO,CAAC,CAAD,CAD7G,EACkH;MAC9G,KAAKN,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,KAAKmU,oBAAL,CAA0B,KAAKzU,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,CAAnD,CAAzB;MACA,KAAKN,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,CAAC,CAA1B;MACAwU,UAAU,GAAG,KAAKlX,MAAL,CAAY2B,YAAZ,EAAb;IACH;;IACD,IAAI,CAAC,KAAK3B,MAAL,CAAY2B,YAAZ,EAAD,IAA+BoE,MAAM,KAAK,UAA1C,IACArD,OAAO,CAAC,CAAD,CAAP,KAAe,CADf,IACoB,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BoH,OAA/B,CAAuC,CAAvC,MAA8CpH,OAAO,CAAC,CAAD,CAD7E,EACkF;MAC9E,KAAKN,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,KAAKsU,wBAAL,CAA8B,KAAK5U,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,CAAvD,CAAzB;MACA,KAAKN,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+Bb,MAAxD;IACH;;IACD,IAAI0V,aAAa,GAAG,KAApB;IACA,IAAIxI,GAAG,GAAGtE,QAAQ,CAACC,aAAT,CAAuB6H,aAAjC;;IACA,IAAI,CAAC,KAAKvS,MAAL,CAAYuB,oBAAZ,IAAoC,KAAKvB,MAAL,CAAYwX,sBAAZ,CAAmCC,WAAxE,KACG1I,GAAG,CAAC7N,SAAJ,CAAcC,QAAd,CAAuBrB,QAAQ,CAACiP,GAAhC,CADP,EAC6C;MACzC,IAAIxB,QAAQ,GAAGjK,QAAQ,CAACyL,GAAG,CAACxL,YAAJ,CAAiBzD,QAAQ,CAAC4X,YAA1B,CAAD,EAA0C,EAA1C,CAAvB;MACAH,aAAa,GAAGhK,QAAQ,GAAG,CAA3B;IACH;;IACD,IAAIxH,MAAM,KAAK,UAAX,IAAyB,KAAK/F,MAAL,CAAYyE,aAAZ,OAAgC,OAAzD,IAAoE/B,OAAO,CAAC,CAAD,CAAP,KAAe,CAAnF,IACGA,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BoH,OAA/B,CAAuC,CAAvC,CADtB,EACiE;MAC7D,KAAK1H,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,CAAC,CAA1B;IACH;;IACD,IAAIkK,IAAI,GAAG;MACPzM,IAAI,EAAE,CAACoX,aAAD,GAAkB,CAACxR,MAAM,KAAK,SAAX,IAAwBsR,WAAzB,KAAyC3U,OAAO,CAAC,CAAD,CAAP,KAAe,CAAzD,IAA+DwU,UAA/D,IAA6EE,MAA9F,GAAuG,KADtG;MAEP7O,QAAQ,EAAE+O,UAFH;MAGP9O,QAAQ,EAAE0O,UAHH;MAIPzO,aAAa,EAAE2O;IAJR,CAAX;IAMA,OAAOxK,IAAP;EACH,CA9CD;;EA+CAmB,YAAY,CAAClP,SAAb,CAAuB6J,cAAvB,GAAwC,UAAUiP,QAAV,EAAoBxX,IAApB,EAA0B8F,MAA1B,EAAkCF,MAAlC,EAA0C;IAC9E,IAAI4R,QAAQ,KAAK,KAAK,CAAtB,EAAyB;MAAEA,QAAQ,GAAG,EAAX;IAAgB;;IAC3C,IAAIjV,OAAO,GAAG,EAAd;;IACA,IAAI,KAAK1C,MAAL,CAAYyE,aAAZ,OAAgC,OAAhC,IAA2C,KAAKzE,MAAL,CAAYyE,aAAZ,OAAgC3E,QAAQ,CAAC4E,SAAxF,EAAmG;MAC/F,IAAIqB,MAAM,KAAK,WAAX,IAA0BA,MAAM,KAAK,UAAzC,EAAqD;QACjDrD,OAAO,CAAC,CAAD,CAAP,GAAaiV,QAAQ,CAAC,CAAD,CAArB;QACAjV,OAAO,CAAC,CAAD,CAAP,GAAa,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+Bb,MAA5C;MACH;;MACD,IAAI,KAAK7B,MAAL,CAAYyE,aAAZ,OAAgC3E,QAAQ,CAAC4E,SAAzC,KAAuDqB,MAAM,KAAK,YAAX,IAA2BA,MAAM,KAAK,KAA7F,CAAJ,EAAyG;QACrGrD,OAAO,CAAC,CAAD,CAAP,GAAaiV,QAAQ,CAAC,CAAD,CAArB;QACAjV,OAAO,CAAC,CAAD,CAAP,GAAa,CAAC,CAAd;MACH;;MACD,IAAI,KAAK1C,MAAL,CAAYyE,aAAZ,OAAgC,OAAhC,IAA2CsB,MAAM,KAAK,KAA1D,EAAiE;QAC7DrD,OAAO,CAAC,CAAD,CAAP,GAAaiV,QAAQ,CAAC,CAAD,CAAR,GAAc,CAA3B;QACAjV,OAAO,CAAC,CAAD,CAAP,GAAa,CAAC,CAAd;MACH;IACJ,CAbD,MAcK,IAAIqD,MAAM,KAAK,YAAX,IAA2BA,MAAM,KAAK,KAA1C,EAAiD;MAClDrD,OAAO,CAAC,CAAD,CAAP,GAAaiV,QAAQ,CAAC,CAAD,CAArB;MACAjV,OAAO,CAAC,CAAD,CAAP,GAAa,CAAC,CAAd;IACH;;IACD,IAAIqD,MAAM,KAAK,WAAX,IAA0BA,MAAM,KAAK,OAAzC,EAAkD;MAC9CrD,OAAO,CAAC,CAAD,CAAP,GAAa,CAAC,CAAd;MACAA,OAAO,CAAC,CAAD,CAAP,GAAaiV,QAAQ,CAAC,CAAD,CAArB;IACH;;IACD,IAAI5R,MAAM,KAAK,UAAX,IAAyB,KAAK/F,MAAL,CAAYyE,aAAZ,OAAgC,MAA7D,EAAqE;MACjE/B,OAAO,CAAC,CAAD,CAAP,GAAaiV,QAAQ,CAAC,CAAD,CAAR,GAAc,CAA3B;MACAjV,OAAO,CAAC,CAAD,CAAP,GAAa,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+Bb,MAA5C;IACH;;IACD,OAAOa,OAAP;EACH,CA9BD;;EA+BAqL,YAAY,CAAClP,SAAb,CAAuByD,YAAvB,GAAsC,UAAUC,IAAV,EAAgBqV,SAAhB,EAA2B;IAC7D,IAAItK,EAAJ;;IACA,IAAIlL,MAAM,GAAGwV,SAAS,CAACxV,MAAvB;IAAA,IAA+BkN,eAAe,GAAGsI,SAAS,CAACtI,eAA3D;IACA,IAAIyH,GAAG,GAAGzH,eAAe,CAAClN,MAAhB,CAAuBA,MAAvB,CAA8BP,MAAxC;IACA,IAAIgW,UAAU,GAAG,KAAK7X,MAAL,CAAY8X,cAAZ,IAA8B,KAAK9X,MAAL,CAAY8R,cAAZ,CAA2BC,IAA3B,KAAoC,WAAlE,GAAgFgF,GAAG,GAAG,CAAtF,GAA0FA,GAA3G;IACAzH,eAAe,CAAClN,MAAhB,CAAuBA,MAAvB,GAAgCkN,eAAe,CAAClN,MAAhB,CAAuBA,MAAvB,CAA8B6E,KAA9B,CAAoC,CAApC,EAAuC4Q,UAAvC,CAAhC,CAL6D,CAKuB;;IACpFvI,eAAe,CAAClN,MAAhB,CAAuBG,IAAvB,GAA8BsV,UAA9B;;IACA,CAACvK,EAAE,GAAGgC,eAAe,CAAClN,MAAhB,CAAuBA,MAA7B,EAAqC2V,IAArC,CAA0CC,KAA1C,CAAgD1K,EAAhD,EAAoDlL,MAApD;;IACAkN,eAAe,CAAClN,MAAhB,CAAuBG,IAAvB,IAA+BH,MAAM,CAACP,MAAtC;EACH,CATD;;EAUAkM,YAAY,CAAClP,SAAb,CAAuBwO,OAAvB,GAAiC,UAAUrM,CAAV,EAAa;IAC1C,IAAI4L,IAAI,GAAG,KAAKF,YAAL,EAAX;IACA,IAAIY,EAAE,GAAG,KAAKlL,MAAL,CAAYM,OAArB;IAAA,IAA8BuV,MAAM,GAAG3K,EAAE,CAAC,CAAD,CAAzC;IAAA,IAA8C4K,MAAM,GAAG5K,EAAE,CAAC,CAAD,CAAzD;IACA,IAAI6K,MAAM,GAAGvL,IAAI,CAAC9J,OAAL,CAAa5B,SAAb,CAAuBC,QAAvB,CAAgCrB,QAAQ,CAACsV,OAAzC,CAAb;IACA,IAAIgD,YAAY,GAAGD,MAAM,IAAKnX,CAAC,IAAIA,CAAC,CAAC+E,MAAF,KAAa,OAAlB,KAA8B6G,IAAI,CAAC9J,OAAL,CAAa5B,SAAb,CAAuBC,QAAvB,CAAgC,qBAAhC,KACrDyL,IAAI,CAAC9J,OAAL,CAAa5B,SAAb,CAAuBC,QAAvB,CAAgC,mBAAhC,CADuB,CAA9B,CAJ0C,CAM1C;;IACA,IAAIwU,EAAE,GAAG,CAAC1F,IAAI,CAACC,GAAL,CAAS5M,QAAQ,CAACsJ,IAAI,CAAC9J,OAAL,CAAayP,aAAb,CAA2BhP,YAA3B,CAAwCzD,QAAQ,CAAC4X,YAAjD,CAAD,EAAiE,EAAjE,CAAjB,EAAuFO,MAAvF,CAAD,EACLhI,IAAI,CAACC,GAAL,CAAS5M,QAAQ,CAACsJ,IAAI,CAAC9J,OAAL,CAAaS,YAAb,CAA0BzD,QAAQ,CAACuY,YAAnC,CAAD,EAAmD,EAAnD,CAAjB,EAAyEH,MAAzE,CADK,CAAT;IAAA,IACuF3K,QAAQ,GAAGoI,EAAE,CAAC,CAAD,CADpG;IAAA,IACyGnI,SAAS,GAAGmI,EAAE,CAAC,CAAD,CADvH;;IAEA,IAAI,KAAK3V,MAAL,CAAYqH,aAAZ,IAA6B,KAAKrH,MAAL,CAAYoS,aAAZ,CAA0BkG,iBAAvD,IAA4EH,MAAhF,EAAwF;MACpF5K,QAAQ,GAAG,KAAKvN,MAAL,CAAYuY,WAAZ,GAA0BzO,OAA1B,CAAkC8C,IAAI,CAAC9J,OAAL,CAAayP,aAA/C,CAAX;IACH;;IACD,OAAO;MAAEtO,SAAS,EAAE,IAAb;MAAmBsS,UAAU,EAAE4B,MAA/B;MAAuCjL,OAAO,EAAE,CAACK,QAAD,EAAWC,SAAX,CAAhD;MAAuE4K,YAAY,EAAEA;IAArF,CAAP;EACH,CAbD;;EAcArK,YAAY,CAAClP,SAAb,CAAuB+D,SAAvB,GAAmC,YAAY;IAC3C,IAAI8S,KAAK,GAAG,KAAKlB,QAAL,EAAZ;IACA,OAAO,UAAUjH,QAAV,EAAoBC,SAApB,EAA+BzH,MAA/B,EAAuC;MAC1C,IAAI,CAAC7G,iBAAiB,CAACwW,KAAK,CAACnT,IAAN,CAAWgL,QAAX,CAAD,CAAtB,EAA8C;QAC1C,IAAI2H,IAAI,GAAG,KAAK,CAAhB;QACA1H,SAAS,GAAGkI,KAAK,CAAC1N,aAAN,CAAoB,aAApB,IAAqC,CAArC,GAAyCwF,SAArD;;QACA,IAAIkI,KAAK,CAACnT,IAAN,CAAWgL,QAAX,EAAqBpD,KAArB,CAA2B,CAA3B,EAA8BjJ,SAA9B,CAAwCC,QAAxC,CAAiD,YAAjD,CAAJ,EAAoE;UAChE+T,IAAI,GAAGQ,KAAK,CAACnT,IAAN,CAAWgL,QAAX,EAAqBpD,KAArB,CAA2B,CAA3B,EAA8BpC,gBAA9B,CAA+C,IAA/C,EAAqDyF,SAArD,CAAP;QACH,CAFD,MAGK;UACD0H,IAAI,GAAGQ,KAAK,CAACnT,IAAN,CAAWgL,QAAX,EAAqBpD,KAArB,CAA2BqD,SAA3B,CAAP;QACH;;QACD,IAAIgL,WAAW,GAAGtD,IAAI,CAACtF,qBAAL,GAA6B6I,KAA7B,KAAuC,CAAzD;;QACA,IAAI1S,MAAM,KAAK,OAAX,IAAsBA,MAAM,KAAK,YAArC,EAAmD;UAC/C,OAAOyS,WAAW,IAAItD,IAAI,CAAChU,SAAL,CAAeC,QAAf,CAAwBrB,QAAQ,CAACsV,OAAjC,CAAtB;QACH;;QACD,IAAI,CAACrP,MAAM,KAAK,SAAX,IAAwBA,MAAM,KAAK,WAApC,KAAoDmP,IAAI,CAAChU,SAAL,CAAeC,QAAf,CAAwBrB,QAAQ,CAACsV,OAAjC,CAAxD,EAAmG;UAC/F,OAAOoD,WAAP;QACH,CAFD,MAGK,IAAIzS,MAAM,KAAK,SAAX,IAAwBA,MAAM,KAAK,WAAvC,EAAoD;UACrD,OAAOyS,WAAP;QACH;MACJ;;MACD,OAAO,KAAP;IACH,CAtBD;EAuBH,CAzBD;;EA0BAzK,YAAY,CAAClP,SAAb,CAAuByW,iBAAvB,GAA2C,UAAUtU,CAAV,EAAa;IACpD,IAAIsM,EAAE,GAAG,KAAKlL,MAAL,CAAYM,OAArB;IAAA,IAA8BiT,EAAE,GAAGrI,EAAE,CAAC,CAAD,CAArC;IAAA,IAA0C2K,MAAM,GAAGtC,EAAE,KAAK,KAAK,CAAZ,GAAgB,CAAC,CAAjB,GAAqBA,EAAxE;IAAA,IAA4EG,EAAE,GAAGxI,EAAE,CAAC,CAAD,CAAnF;IAAA,IAAwF4K,MAAM,GAAGpC,EAAE,KAAK,KAAK,CAAZ,GAAgB,CAAC,CAAjB,GAAqBA,EAAtH;;IACA,IAAImC,MAAM,GAAG,CAAT,IAAcC,MAAM,GAAG,CAA3B,EAA8B;MAC1B,OAAO,IAAP;IACH;;IACD,IAAIhD,IAAI,GAAGlW,QAAQ,CAACiZ,MAAM,GAAG,SAAT,GAAqBC,MAAtB,EAA8B,KAAK1D,QAAL,GAAgBjS,IAA9C,CAAnB;;IACA,IAAI,CAAC2S,IAAL,EAAW;MACP,OAAO,IAAP;IACH;;IACD,OAAOlU,CAAC,CAAC+E,MAAF,KAAa,OAAb,IAAwB/E,CAAC,CAAC+E,MAAF,KAAa,YAArC,GACHmP,IAAI,CAAChU,SAAL,CAAeC,QAAf,CAAwBrB,QAAQ,CAACsV,OAAjC,KAA6C,CAACF,IAAI,CAAChU,SAAL,CAAeC,QAAf,CAAwB,eAAxB,CAA9C,KACQ,CAAC+T,IAAI,CAAChU,SAAL,CAAeC,QAAf,CAAwB,gBAAxB,CAAD,IAA8C+T,IAAI,CAAChU,SAAL,CAAeC,QAAf,CAAwB,mBAAxB,CADtD,KAEO,CAAC+T,IAAI,CAAChU,SAAL,CAAeC,QAAf,CAAwB,cAAxB,CAHL,GAG+C,IAHtD;EAIH,CAbD;;EAcA4M,YAAY,CAAClP,SAAb,CAAuB6Z,eAAvB,GAAyC,YAAY;IACjD,OAAO,KAAK1Y,MAAL,CAAY2Y,cAAZ,IAA8B,KAAK3Y,MAAL,CAAY4Y,iBAAZ,CAA8BC,oBAAnE;EACH,CAFD;;EAGA,OAAO9K,YAAP;AACH,CA5UiC,EAAlC;;AA6UA,SAASA,YAAT;AACA;AACA;AACA;;AACA,IAAIG,WAAW;AAAG;AAAe,UAAU4K,MAAV,EAAkB;EAC/C7a,SAAS,CAACiQ,WAAD,EAAc4K,MAAd,CAAT;;EACA,SAAS5K,WAAT,CAAqBlO,MAArB,EAA6B;IACzB,OAAO8Y,MAAM,CAAC5R,IAAP,CAAY,IAAZ,EAAkBlH,MAAlB,KAA6B,IAApC;EACH;;EACDkO,WAAW,CAACrP,SAAZ,CAAsB2V,QAAtB,GAAiC,YAAY;IACzC,OAAQ,KAAKxU,MAAL,CAAY2B,YAAZ,KACJ,KAAK3B,MAAL,CAAY+Y,gBAAZ,GAA+B/Q,aAA/B,CAA6C,2BAA7C,CADI,GAEJ,KAAKhI,MAAL,CAAYgZ,cAAZ,EAFJ;EAGH,CAJD;;EAKA9K,WAAW,CAACrP,SAAZ,CAAsBkF,OAAtB,GAAgC,UAAU/C,CAAV,EAAa;IACzC,IAAIC,MAAM,GAAGD,CAAC,CAACC,MAAf;IACA,KAAKA,MAAL,GAAcA,MAAd;IACAA,MAAM,GAAIA,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0B,cAA1B,IAA4CF,MAA5C,GAAqDhC,OAAO,CAACgC,MAAD,EAAS,IAAT,CAAtE;;IACA,IAAI,CAACA,MAAD,IAAW,KAAKjB,MAAL,CAAY0B,UAAZ,KAA2B,CAA1C,EAA6C;MACzCT,MAAM,GAAID,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4BrB,QAAQ,CAACsV,OAArC,IAAgDpU,CAAC,CAACC,MAAlD,GACNhC,OAAO,CAAC+B,CAAC,CAACC,MAAH,EAAW,IAAX,CADX;IAEH;;IACD,IAAID,CAAC,CAACC,MAAF,CAASC,SAAT,CAAmBC,QAAnB,CAA4B,gBAA5B,KACAH,CAAC,CAACC,MAAF,CAAS+G,aAAT,CAAuB,sBAAvB,CADJ,EACoD;MAChD,OAAO,KAAP;IACH;;IACD,IAAI,CAAC/G,MAAL,EAAa;MACT;IACH;;IACD,IAAIqM,EAAE,GAAG,CAACrM,MAAM,CAACsR,aAAP,CAAqBhF,QAAtB,EAAgCtM,MAAM,CAACuM,SAAvC,CAAT;IAAA,IAA4DD,QAAQ,GAAGD,EAAE,CAAC,CAAD,CAAzE;IAAA,IAA8EE,SAAS,GAAGF,EAAE,CAAC,CAAD,CAA5F;IACA,IAAIgG,GAAG,GAAGtU,QAAQ,CAACuO,QAAQ,GAAG,GAAX,GAAiBC,SAAlB,EAA6B,KAAKpL,MAAL,CAAYA,MAAzC,CAAlB;;IACA,IAAI,KAAKA,MAAL,CAAYoR,OAAZ,CAAoBF,GAApB,CAAJ,EAA8B;MAC1B,OAAO,KAAP;IACH;;IACD,KAAKlR,MAAL,CAAYS,MAAZ,CAAmB5B,MAAM,CAACsR,aAAP,CAAqBhF,QAAxC,EAAkDtM,MAAM,CAACuM,SAAzD;EACH,CArBD;;EAsBAU,WAAW,CAACrP,SAAZ,CAAsB6N,YAAtB,GAAqC,YAAY;IAC7C,IAAIE,IAAI,GAAG,EAAX;IACA,IAAIU,EAAE,GAAG,KAAKlL,MAAL,CAAYM,OAArB;IAAA,IAA8BiT,EAAE,GAAGrI,EAAE,CAAC,CAAD,CAArC;IAAA,IAA0CC,QAAQ,GAAGoI,EAAE,KAAK,KAAK,CAAZ,GAAgB,CAAhB,GAAoBA,EAAzE;IAAA,IAA6EG,EAAE,GAAGxI,EAAE,CAAC,CAAD,CAApF;IAAA,IAAyFE,SAAS,GAAGsI,EAAE,KAAK,KAAK,CAAZ,GAAgB,CAAhB,GAAoBA,EAAzH;IACAlJ,IAAI,CAAC9J,OAAL,GAAe,KAAK0R,QAAL,GAAgBjS,IAAhB,CAAqBgL,QAArB,EAA+BpD,KAA/B,CAAqCqD,SAArC,CAAf;;IACA,IAAI,CAACtO,iBAAiB,CAAC0N,IAAI,CAAC9J,OAAN,CAAtB,EAAsC;MAClC8J,IAAI,CAACvC,cAAL,GAAsB,KAAKuI,YAAL,CAAkBhG,IAAI,CAAC9J,OAAvB,CAAtB;MACA8J,IAAI,CAACxE,OAAL,GAAe,CAACwE,IAAI,CAAC9J,OAAL,CAAa5B,SAAb,CAAuBC,QAAvB,CAAgC,iBAAhC,CAAhB;IACH;;IACD,OAAOyL,IAAP;EACH,CATD;;EAUAsB,WAAW,CAACrP,SAAZ,CAAsB4D,QAAtB,GAAiC,UAAUsM,GAAV,EAAemG,IAAf,EAAqB;IAClD,OAAQA,IAAI,CAAC1G,OAAL,KAAiB0G,IAAI,CAAClB,MAAL,CAAYiB,KAAZ,KAAsBb,SAAtB,IAAmCc,IAAI,CAACc,UAAxC,IAAsD,CAAC9W,iBAAiB,CAACgW,IAAI,CAAClB,MAAL,CAAYiF,QAAb,CAAzF,CAAD,IACH/D,IAAI,CAAClB,MAAL,CAAYjC,IAAZ,KAAqB,UADlB,IACgCmD,IAAI,CAACsB,QAAL,KAAkBjX,QAAQ,CAAC2Z,aADlE;EAEH,CAHD;;EAIAhL,WAAW,CAACrP,SAAZ,CAAsByJ,IAAtB,GAA6B,UAAUvC,MAAV,EAAkBrD,OAAlB,EAA2B;IACpD,IAAIwU,UAAU,GAAI,KAAKlX,MAAL,CAAYmX,kBAAZ,OACbpR,MAAM,KAAK,WAAX,IAA2BA,MAAM,KAAK,WAAX,IAA0B,KAAK2S,eAAL,EAArD,IAAgF3S,MAAM,KAAK,UAD9E,MAC8FrD,OAAO,CAAC,CAAD,CAAP,KAAe,CAAf,IACzGA,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BoH,OAA/B,CAAuC,CAAvC,CAFJ,CAAD,IAEqD,KAAK9J,MAAL,CAAYyE,aAAZ,OAAgC,MAAhC,IAA0CsB,MAAM,KAAK,KAArD,IAC/DrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CAHtB;IAIA,IAAIoF,KAAK,GAAI,CAACjK,MAAM,KAAK,YAAX,IAA4BA,MAAM,KAAK,YAAX,IAA2B,KAAK2S,eAAL,EAAvD,IACP3S,MAAM,KAAK,KADL,MACgBrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAY2E,OAA3B,IAAsCrE,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CADrE,CAAD,IAEJlI,OAAO,CAAC,CAAD,CAAP,GAAa,CAAb,IAAkBqD,MAAM,KAAK,UAA7B,IAA2C,KAAK/F,MAAL,CAAYyE,aAAZ,OAAgC,OAA3E,IACG/B,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BoH,OAA/B,CAAuC,CAAvC,CAH1B;IAIA,IAAIsN,MAAM,GAAG,KAAKpX,MAAL,CAAYyE,aAAZ,OAAgC3E,QAAQ,CAAC4E,SAAzC,IAAsDsL,KAAnE;;IACA,IAAI,KAAKhQ,MAAL,CAAYyE,aAAZ,OAAgC,OAApC,EAA6C;MACzCyS,UAAU,GAAGlH,KAAb;IACH;;IACD,IAAIqH,WAAW,GAAG,KAAKrX,MAAL,CAAY0B,UAAZ,KAA2B,CAA3B,IAAgCqE,MAAM,KAAK,OAA7D;IACA,IAAIoT,UAAJ;IACA,IAAItS,OAAJ;IACA,IAAIyQ,UAAU,GAAGJ,UAAU,IAAI,EAAE,KAAKlX,MAAL,CAAYyE,aAAZ,OAAgC,MAAhC,IAA0CsB,MAAM,KAAK,KAArD,IAC1BrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CADnB,CAAd,IACuCuV,MADxD;IAEA,IAAIgC,OAAO,GAAG,KAAKpZ,MAAL,CAAYgK,WAAZ,CAAwBmC,OAAxB,IAAmC,KAAKnM,MAAL,CAAYgK,WAAZ,CAAwBmC,OAAxB,CAAgC/J,MAAhC,CAAuCA,MAAxF;IACA,IAAIiT,SAAS,GAAG+D,OAAO,IAAI,CAACla,iBAAiB,CAACka,OAAO,CAAC1W,OAAO,CAAC,CAAD,CAAR,CAAR,CAA7C;;IACA,IAAI,KAAK1C,MAAL,CAAYyB,iBAAZ,IAAiCsE,MAAM,KAAK,KAAhD,EAAuD;MACnDc,OAAO,GAAG,KAAKzE,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAA5B,KAAkCa,OAAO,CAAC,CAAD,CAAnD;MACAyW,UAAU,GAAGzW,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CAA5B;;MACA,IAAIuO,UAAJ,EAAgB;QACZ,IAAI,CAACtS,OAAL,EAAc;UACV,KAAKzE,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,KAAKN,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,CAAlD;QACH,CAFD,MAGK;UACD,KAAKN,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,CAAzB;QACH;;QACD,KAAKN,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,CAAC,CAA1B;MACH;;MACD,IAAI,KAAK1C,MAAL,CAAY2B,YAAZ,MAA8BkF,OAA9B,IAAyCsS,UAA7C,EAAyD;QACrDjC,UAAU,GAAG,IAAb;QACAI,UAAU,GAAG,KAAb;MACH;IACJ;;IACD,IAAIvR,MAAM,KAAK,KAAX,IAAoB,KAAK/F,MAAL,CAAYyE,aAAZ,OAAgC,MAApD,IAA8D/B,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAAzG,IACGa,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CADtB,EACqE;MACjE,KAAKxI,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,CAAC,CAA1B;IACH;;IACD,OAAO;MACHvC,IAAI,EAAG,CAAC4F,MAAM,KAAK,WAAX,IAA0BsR,WAA3B,KAA2C3U,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAAvF,IACDwT,SAAS,KAAK6B,UAAU,IAAIE,MAAnB,CADR,IACwCrR,MAAM,KAAK,KAAX,IAAoBc,OAApB,IAA+BsS,UAF1E;MAGH5Q,QAAQ,EAAE+O,UAHP;MAIH9O,QAAQ,EAAE0O,UAJP;MAKHzO,aAAa,EAAE2O;IALZ,CAAP;EAOH,CAhDD;;EAiDAlJ,WAAW,CAACrP,SAAZ,CAAsB6J,cAAtB,GAAuC,UAAUiP,QAAV,EAAoBxX,IAApB,EAA0B8F,MAA1B,EAAkCF,MAAlC,EAA0C;IAC7E,IAAI4R,QAAQ,KAAK,KAAK,CAAtB,EAAyB;MAAEA,QAAQ,GAAG,EAAX;IAAgB;;IAC3C,IAAI0B,QAAQ,GAAG,EAAf;;IACA,IAAI,KAAKrZ,MAAL,CAAYyE,aAAZ,OAAgC,OAAhC,IAA2C,KAAKzE,MAAL,CAAYyE,aAAZ,OAAgC3E,QAAQ,CAAC4E,SAAxF,EAAmG;MAC/F,IAAIqB,MAAM,KAAK,WAAX,IAA2BA,MAAM,KAAK,WAAX,IAA0B,KAAK2S,eAAL,EAArD,IAAgF3S,MAAM,KAAK,UAA/F,EAA2G;QACvGsT,QAAQ,CAAC,CAAD,CAAR,GAAc1B,QAAQ,CAAC,CAAD,CAAtB;QACA0B,QAAQ,CAAC,CAAD,CAAR,GAAc,KAAKjX,MAAL,CAAYA,MAAZ,CAAmBiX,QAAQ,CAAC,CAAD,CAA3B,EAAgCxX,MAA9C;MACH;;MACD,IAAI,KAAK7B,MAAL,CAAYyE,aAAZ,OAAgC3E,QAAQ,CAAC4E,SAAzC,KACIqB,MAAM,KAAK,YAAX,IAA4BA,MAAM,KAAK,YAAX,IAA2B,KAAK2S,eAAL,EAAvD,IAAkF3S,MAAM,KAAK,KADjG,CAAJ,EAC6G;QACzGsT,QAAQ,CAAC,CAAD,CAAR,GAAc1B,QAAQ,CAAC,CAAD,CAAtB;QACA0B,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;MACH;IACJ,CAVD,MAWK,IAAItT,MAAM,KAAK,YAAX,IAA4BA,MAAM,KAAK,YAAX,IAA2B,KAAK2S,eAAL,EAAvD,IAAkF3S,MAAM,KAAK,KAAjG,EAAwG;MACzGsT,QAAQ,CAAC,CAAD,CAAR,GAAc1B,QAAQ,CAAC,CAAD,CAAtB;MACA0B,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;IACH;;IACD,IAAItT,MAAM,KAAK,SAAX,IAAwBA,MAAM,KAAK,YAAvC,EAAqD;MACjDsT,QAAQ,CAAC,CAAD,CAAR,GAAc,KAAKjX,MAAL,CAAYA,MAAZ,CAAmBP,MAAjC;MACAwX,QAAQ,CAAC,CAAD,CAAR,GAAc1B,QAAQ,CAAC,CAAD,CAAtB;IACH;;IACD,IAAI,KAAK3X,MAAL,CAAYyE,aAAZ,OAAgC,MAAhC,IAA0CsB,MAAM,KAAK,UAAzD,EAAqE;MACjEsT,QAAQ,CAAC,CAAD,CAAR,GAAc1B,QAAQ,CAAC,CAAD,CAAR,KAAgB,CAAC,CAAjB,GAAqB,KAAKvV,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAAjD,GAAqD8V,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAjF;MACA0B,QAAQ,CAAC,CAAD,CAAR,GAAc,KAAKjX,MAAL,CAAYA,MAAZ,CAAmBiX,QAAQ,CAAC,CAAD,CAA3B,EAAgCxX,MAA9C;IACH;;IACD,IAAI,KAAK7B,MAAL,CAAYyE,aAAZ,OAAgC,OAAhC,IAA2CsB,MAAM,KAAK,KAA1D,EAAiE;MAC7DsT,QAAQ,CAAC,CAAD,CAAR,GAAc1B,QAAQ,CAAC,CAAD,CAAR,GAAc,CAA5B;MACA0B,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;IACH;;IACD,OAAOA,QAAP;EACH,CA/BD;;EAgCAnL,WAAW,CAACrP,SAAZ,CAAsByD,YAAtB,GAAqC,UAAUC,IAAV,EAAgB;IACjD,IAAIV,MAAM,GAAG,KAAKO,MAAL,CAAYA,MAAZ,CAAmBP,MAAhC;;IACA,IAAI,KAAK7B,MAAL,CAAY8X,cAAZ,IAA8B,KAAK9X,MAAL,CAAY8R,cAAZ,CAA2BC,IAA3B,KAAoC,WAAtE,EAAmF;MAC/E,KAAK3P,MAAL,CAAYG,IAAZ,GAAmB,EAAE,KAAKH,MAAL,CAAYG,IAAjC;MACA,IAAI4H,KAAK,GAAG5H,IAAI,CAAC,CAAD,CAAJ,CAAQ4H,KAApB;MACA,IAAI2J,eAAe,GAAG,CAAtB;MACA,IAAIwF,WAAW,GAAG,KAAKC,aAAL,OAAyB,kBAAzB,IAA+C,KAAKvZ,MAAL,CAAYyE,aAAZ,OAAgC,OAA/E,GAAyF3E,QAAQ,CAAC0Z,UAAlG,GACd,KAAKD,aAAL,OAAyB,kBAAzB,IAA+C,KAAKA,aAAL,OAAyB,uBAAxE,GAAkGzZ,QAAQ,CAAC2Z,WAA3G,GAAyH,SAD7H;;MAEA,KAAK,IAAIrP,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,KAAK,CAACtI,MAA1B,EAAkCuI,CAAC,EAAnC,EAAuC;QACnC,IAAID,KAAK,CAACC,CAAD,CAAL,CAAS4J,MAAT,IAAmB7J,KAAK,CAACC,CAAD,CAAL,CAAS4J,MAAT,CAAgBjN,OAAvC,EAAgD;UAC5C+M,eAAe,GAAG,KAAK4F,iBAAL,CAAuBvP,KAAK,CAACC,CAAD,CAAL,CAAS4J,MAAT,CAAgBjN,OAAvC,EAAgDlF,MAAhD,EAAwDiS,eAAxD,EAAyEwF,WAAzE,CAAlB;QACH,CAFD,MAGK;UACD,IAAI,CAAC,KAAKtZ,MAAL,CAAY2B,YAAZ,EAAD,IAAgC,KAAK3B,MAAL,CAAY2B,YAAZ,MAA8BwI,KAAK,CAACC,CAAD,CAAL,CAAS4J,MAAT,CAAgB2F,WAAhB,KAAgCL,WAAlG,EAAgH;YAC5G,KAAKlX,MAAL,CAAY0Q,GAAZ,CAAgBjR,MAAhB,EAAwBiS,eAAxB,EAAyC3J,KAAK,CAACC,CAAD,CAAL,CAASoE,OAAT,IAAoBrE,KAAK,CAACC,CAAD,CAAL,CAAS4J,MAAT,CAAgB8D,cAAhB,KAAmC,KAAhG;YACAhE,eAAe;UAClB;QACJ;MACJ;IACJ;EACJ,CApBD;;EAqBA5F,WAAW,CAACrP,SAAZ,CAAsB6a,iBAAtB,GAA0C,UAAUxF,UAAV,EAAsB3G,QAAtB,EAAgCwF,WAAhC,EAA6CuG,WAA7C,EAA0D;IAChG,IAAIvS,OAAO,GAAGmN,UAAd;IACA,IAAIJ,eAAe,GAAGf,WAAtB;;IACA,KAAK,IAAI3I,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGrD,OAAO,CAAClF,MAA5B,EAAoCuI,CAAC,EAArC,EAAyC;MACrC,IAAIrD,OAAO,CAACqD,CAAD,CAAP,CAAWrD,OAAf,EAAwB;QACpB+M,eAAe,GAAG,KAAK4F,iBAAL,CAAuB3S,OAAO,CAACqD,CAAD,CAAP,CAAWrD,OAAlC,EAA2CwG,QAA3C,EAAqDuG,eAArD,EAAsEwF,WAAtE,CAAlB;MACH,CAFD,MAGK;QACD,IAAI,CAAC,KAAKtZ,MAAL,CAAY2B,YAAZ,EAAD,IAAgC,KAAK3B,MAAL,CAAY2B,YAAZ,MAA8BoF,OAAO,CAACqD,CAAD,CAAP,CAAWuP,WAAX,KAA2BL,WAA7F,EAA2G;UACvG,KAAKlX,MAAL,CAAY0Q,GAAZ,CAAgBvF,QAAhB,EAA0BuG,eAA1B,EAA2C/M,OAAO,CAACqD,CAAD,CAAP,CAAWoE,OAAX,IAAsBzH,OAAO,CAACqD,CAAD,CAAP,CAAW0N,cAAX,KAA8B,KAA/F;UACAhE,eAAe;QAClB;MACJ;IACJ;;IACD,OAAOA,eAAP;EACH,CAfD;;EAgBA5F,WAAW,CAACrP,SAAZ,CAAsBwO,OAAtB,GAAgC,UAAUrM,CAAV,EAAa;IACzC,OAAO3B,MAAM,CAACyZ,MAAM,CAACja,SAAP,CAAiBwO,OAAjB,CAAyBnG,IAAzB,CAA8B,IAA9B,EAAoClG,CAApC,CAAD,EAAyC;MAAEiD,SAAS,EAAE,KAAb;MAAoBE,QAAQ,EAAE;IAA9B,CAAzC,CAAb;EACH,CAFD;;EAGA+J,WAAW,CAACrP,SAAZ,CAAsB+D,SAAtB,GAAkC,YAAY;IAC1C,OAAO,YAAY;MAAE,OAAO,IAAP;IAAc,CAAnC;EACH,CAFD;;EAGAsL,WAAW,CAACrP,SAAZ,CAAsByW,iBAAtB,GAA0C,UAAUtU,CAAV,EAAa;IACnD,IAAIsM,EAAE,GAAG,KAAKlL,MAAL,CAAYM,OAArB;IAAA,IAA8B6K,QAAQ,GAAGD,EAAE,CAAC,CAAD,CAA3C;IAAA,IAAgDyF,WAAW,GAAGzF,EAAE,CAAC,CAAD,CAAhE;;IACA,IAAIC,QAAQ,GAAG,CAAX,IAAgBwF,WAAW,GAAG,CAAlC,EAAqC;MACjC,OAAO,IAAP;IACH;;IACD,IAAImC,IAAI,GAAGlW,QAAQ,CAACuO,QAAQ,GAAG,SAAX,GAAuBwF,WAAxB,EAAqC,KAAKyB,QAAL,GAAgBjS,IAArD,CAAnB;;IACA,IAAI,CAAC2S,IAAL,EAAW;MACP,OAAO,IAAP;IACH;;IACD,OAAOlU,CAAC,CAAC+E,MAAF,KAAa,OAAb,IAAwB/E,CAAC,CAAC+E,MAAF,KAAa,cAArC,GAAsD,CAACmP,IAAI,CAAChU,SAAL,CAAeC,QAAf,CAAwB,cAAxB,CAAvD,GAAiG,IAAxG;EACH,CAVD;;EAWA+M,WAAW,CAACrP,SAAZ,CAAsB0a,aAAtB,GAAsC,YAAY;IAC9C,OAAO,aAAP;EACH,CAFD;;EAGA,OAAOrL,WAAP;AACH,CAzLgC,CAyL/BH,YAzL+B,CAAjC;;AA0LA,SAASG,WAAT;;AACA,IAAIN,iBAAiB;AAAG;AAAe,UAAUkL,MAAV,EAAkB;EACrD7a,SAAS,CAAC2P,iBAAD,EAAoBkL,MAApB,CAAT;;EACA,SAASlL,iBAAT,GAA6B;IACzB,OAAOkL,MAAM,KAAK,IAAX,IAAmBA,MAAM,CAACd,KAAP,CAAa,IAAb,EAAmB4B,SAAnB,CAAnB,IAAoD,IAA3D;EACH;;EACDhM,iBAAiB,CAAC/O,SAAlB,CAA4B2V,QAA5B,GAAuC,YAAY;IAC/C,OAAO,KAAKxU,MAAL,CAAYmC,UAAZ,GAAyB6F,aAAzB,CAAuC,2BAAvC,CAAP;EACH,CAFD;;EAGA4F,iBAAiB,CAAC/O,SAAlB,CAA4ByJ,IAA5B,GAAmC,UAAUvC,MAAV,EAAkBrD,OAAlB,EAA2B;IAC1D,IAAI2U,WAAW,GAAG,KAAKrX,MAAL,CAAY0B,UAAZ,KAA2B,CAA3B,IAAgCqE,MAAM,KAAK,YAA7D;IACA,IAAIwC,QAAQ,GAAI,CAACxC,MAAM,KAAK,SAAX,IAAwBsR,WAAzB,KAAyC3U,OAAO,CAAC,CAAD,CAAP,KAAe,CAAzD,IACPqD,MAAM,KAAK,UAAX,IAAyB,KAAK/F,MAAL,CAAYyE,aAAZ,OAAgC,OAAzD,IACG/B,OAAO,CAAC,CAAD,CAAP,KAAe,CADlB,IACuBA,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BoH,OAA/B,CAAuC,CAAvC,CAF9C;IAGA,IAAI+P,KAAK,GAAG,CAAC9T,MAAM,KAAK,SAAX,IAAwBsR,WAAzB,KAAyC3U,OAAO,CAAC,CAAD,CAAP,KAAe,CAApE;IACA,IAAI0U,MAAM,GAAGrR,MAAM,KAAK,UAAX,IAAyB,KAAK/F,MAAL,CAAYyE,aAAZ,OAAgC3E,QAAQ,CAAC4E,SAAlE,IACNhC,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BoH,OAA/B,CAAuC,CAAvC,CADtB;;IAEA,IAAI,KAAK9J,MAAL,CAAYyE,aAAZ,OAAgC,OAApC,EAA6C;MACzC,IAAItE,IAAI,GAAGoI,QAAQ,IAAK,CAACxC,MAAM,KAAK,UAAX,IAAyBA,MAAM,KAAK,WAArC,KAAqDrD,OAAO,CAAC,CAAD,CAAP,KAAe,CAAjF,IACHqD,MAAM,KAAK,KAAX,IAAoBrD,OAAO,CAAC,CAAD,CAAP,GAAa,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAA7D,IACGa,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CAF1B;MAGA,OAAO;QAAEzK,IAAI,EAAEA,IAAR;QAAcoI,QAAQ,EAAEA,QAAxB;QAAkCC,QAAQ,EAAEqR;MAA5C,CAAP;IACH;;IACD,IAAI9T,MAAM,KAAK,UAAX,IAAyBrD,OAAO,CAAC,CAAD,CAAP,KAAe,CAAxC,IAA6CA,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BoH,OAA/B,CAAuC,CAAvC,CAAhE,EAA2G;MACvG,KAAK1H,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,CAAC,CAA1B;IACH;;IACD,OAAO;MACHvC,IAAI,EAAEoI,QAAQ,IAAK,CAACxC,MAAM,KAAK,KAAX,IAAoBA,MAAM,KAAK,YAAhC,KAAiDrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAY2E,OAAzF,IACEhB,MAAM,KAAK,UAAX,IAAyBrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BoH,OAA/B,CAAuC,CAAvC,CAF7C;MAGHvB,QAAQ,EAAEA,QAHP;MAIHC,QAAQ,EAAEqR,KAJP;MAKHpR,aAAa,EAAE2O;IALZ,CAAP;EAOH,CAxBD;;EAyBAxJ,iBAAiB,CAAC/O,SAAlB,CAA4B6J,cAA5B,GAA6C,UAAUiP,QAAV,EAAoBxX,IAApB,EAA0B8F,MAA1B,EAAkCF,MAAlC,EAA0C;IACnF,IAAI4R,QAAQ,KAAK,KAAK,CAAtB,EAAyB;MAAEA,QAAQ,GAAG,EAAX;IAAgB;;IAC3C,IAAImC,QAAQ,GAAG,EAAf;;IACA,IAAI,KAAK9Z,MAAL,CAAYyE,aAAZ,OAAgC,OAApC,EAA6C;MACzC,IAAIsB,MAAM,KAAK,YAAX,IAA2BA,MAAM,KAAK,KAA1C,EAAiD;QAC7C+T,QAAQ,CAAC,CAAD,CAAR,GAAcnC,QAAQ,CAAC,CAAD,CAAtB;QACAmC,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;MACH;;MACD,IAAI/T,MAAM,KAAK,UAAf,EAA2B;QACvB+T,QAAQ,CAAC,CAAD,CAAR,GAAcnC,QAAQ,CAAC,CAAD,CAAR,GAAc,CAA5B;QACAmC,QAAQ,CAAC,CAAD,CAAR,GAAc,KAAK1X,MAAL,CAAYA,MAAZ,CAAmB0X,QAAQ,CAAC,CAAD,CAA3B,EAAgCjY,MAA9C;MACH;IACJ,CATD,MAUK;MACD,IAAIkE,MAAM,KAAK,KAAX,IAAoB,KAAK/F,MAAL,CAAYyB,iBAApC,EAAuD;QACnDqY,QAAQ,CAAC,CAAD,CAAR,GAAcnC,QAAQ,CAAC,CAAD,CAAtB;QACAmC,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;MACH;;MACD,IAAI/T,MAAM,KAAK,WAAX,IAA0BA,MAAM,KAAK,UAAzC,EAAqD;QACjD+T,QAAQ,CAAC,CAAD,CAAR,GAAcnC,QAAQ,CAAC,CAAD,CAAtB;QACAmC,QAAQ,CAAC,CAAD,CAAR,GAAc7T,MAAM,CAAC7D,MAAP,CAAc2E,OAAd,GAAwB,CAAtC;MACH;IACJ;;IACD,IAAIhB,MAAM,KAAK,WAAX,IAA0BA,MAAM,KAAK,OAAzC,EAAkD;MAC9C+T,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;MACAA,QAAQ,CAAC,CAAD,CAAR,GAAcnC,QAAQ,CAAC,CAAD,CAAtB;IACH;;IACD,IAAI5R,MAAM,KAAK,KAAX,IAAoB,KAAK/F,MAAL,CAAYyE,aAAZ,OAAgC,OAAxD,EAAiE;MAC7DqV,QAAQ,CAAC,CAAD,CAAR,GAAcnC,QAAQ,CAAC,CAAD,CAAR,GAAc,CAA5B;MACAmC,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;IACH;;IACD,OAAOA,QAAP;EACH,CAhCD;;EAiCA,OAAOlM,iBAAP;AACH,CAnEsC,CAmErCG,YAnEqC,CAAvC;;AAoEA,SAASH,iBAAT;;AACA,IAAII,gBAAgB;AAAG;AAAe,UAAU8K,MAAV,EAAkB;EACpD7a,SAAS,CAAC+P,gBAAD,EAAmB8K,MAAnB,CAAT;;EACA,SAAS9K,gBAAT,GAA4B;IACxB,OAAO8K,MAAM,KAAK,IAAX,IAAmBA,MAAM,CAACd,KAAP,CAAa,IAAb,EAAmB4B,SAAnB,CAAnB,IAAoD,IAA3D;EACH;;EACD5L,gBAAgB,CAACnP,SAAjB,CAA2ByJ,IAA3B,GAAkC,UAAUvC,MAAV,EAAkBrD,OAAlB,EAA2B;IACzD,IAAI2U,WAAW,GAAG,KAAKrX,MAAL,CAAY0B,UAAZ,KAA2B,CAA3B,IAAgCqE,MAAM,KAAK,OAA7D;IACA,IAAIgU,OAAO,GAAG,KAAK/Z,MAAL,CAAYgK,WAAZ,CAAwBqC,MAAxB,IAAkC,KAAKrM,MAAL,CAAYgK,WAAZ,CAAwBqC,MAAxB,CAA+BjK,MAA/B,CAAsCA,MAAtF;IACA,IAAIiT,SAAS,GAAG0E,OAAO,IAAI,CAAC7a,iBAAiB,CAAC6a,OAAO,CAACrX,OAAO,CAAC,CAAD,CAAR,CAAR,CAA7C;;IACA,IAAI,KAAK1C,MAAL,CAAYyE,aAAZ,OAAgC,OAApC,EAA6C;MACzC,IAAIuV,QAAQ,GAAI,CAACjU,MAAM,KAAK,WAAX,IAA2BA,MAAM,KAAK,WAAX,IAA0B,KAAK2S,eAAL,EAArD,IACV3S,MAAM,KAAK,UADF,MACkBrD,OAAO,CAAC,CAAD,CAAP,KAAe,CAAf,IAAoBA,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BoH,OAA/B,CAAuC,CAAvC,CADrD,CAAD,IAEPpH,OAAO,CAAC,CAAD,CAAP,GAAa,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAAzC,IAA8CkE,MAAM,KAAK,KAAzD,IACGrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CAH1B;MAIA,IAAIzK,IAAI,GAAI,CAAC4F,MAAM,KAAK,WAAX,IAA0BsR,WAA1B,IAA0CtR,MAAM,KAAK,KAAX,IAChDrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CADV,KAC6DlI,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CADzG,IAENwT,SAAS,IAAI2E,QAFlB;MAGA,IAAIxR,QAAQ,GAAG,CAACzC,MAAM,KAAK,WAAX,IAA0BsR,WAA3B,KAA2C3U,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAArG;;MACA,IAAIkE,MAAM,KAAK,KAAX,IAAoBrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAA/D,IACGa,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CADtB,EACqE;QACjE,KAAKxI,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,CAAC,CAA1B;MACH;;MACD,OAAO;QAAEvC,IAAI,EAAEA,IAAR;QAAcoI,QAAQ,EAAEyR,QAAxB;QAAkCxR,QAAQ,EAAEA;MAA5C,CAAP;IACH;;IACD,IAAI4O,MAAM,GAAG1U,OAAO,CAAC,CAAD,CAAP,GAAa,CAAb,IAAkBqD,MAAM,KAAK,UAA7B,IAA2C,KAAK/F,MAAL,CAAYyE,aAAZ,OAAgC3E,QAAQ,CAAC4E,SAApF,IACNhC,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BoH,OAA/B,CAAuC,CAAvC,CADtB;IAEA,OAAO;MACH3J,IAAI,EAAE,CAAC4F,MAAM,KAAK,WAAX,IAA0BsR,WAA3B,KAA2C3U,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAAtF,IAA4F,CAACkE,MAAM,KAAK,YAAX,IAC9FA,MAAM,KAAK,YAAX,IAA2B,KAAK2S,eAAL,EADmE,IACxC3S,MAAM,KAAK,KAD4B,MAE7FrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAY2E,OAA3B,IAAsCrE,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CAFwC,KAEUyK,SAFtG,IAGEtP,MAAM,KAAK,KAAX,IAAoBrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CAHrC,IAIE7E,MAAM,KAAK,UAAX,IAAyBrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BoH,OAA/B,CAAuC,CAAvC,CAAxC,IAAqFpH,OAAO,CAAC,CAAD,CAAP,GAAa,CALvG;MAMH6F,QAAQ,EAAE,CAACxC,MAAM,KAAK,YAAX,IAA4BA,MAAM,KAAK,YAAX,IAA2B,KAAK2S,eAAL,EAAvD,IAAkF3S,MAAM,KAAK,KAA9F,MACLrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAY2E,OAA3B,IAAsCrE,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CADhD,KAEF7E,MAAM,KAAK,KAAX,IAAoBrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CAFjC,IAGF7E,MAAM,KAAK,UAAX,IAAyBrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BoH,OAA/B,CAAuC,CAAvC,CAAxC,IAAqFpH,OAAO,CAAC,CAAD,CAAP,GAAa,CATvG;MAUH8F,QAAQ,EAAE,CAACzC,MAAM,KAAK,WAAX,IAA0BsR,WAA3B,KAA2C3U,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAV7F;MAWH4G,aAAa,EAAE2O;IAXZ,CAAP;EAaH,CAlCD;;EAmCApJ,gBAAgB,CAACnP,SAAjB,CAA2B2V,QAA3B,GAAsC,YAAY;IAC9C,OAAQ,KAAKxU,MAAL,CAAY+Y,gBAAZ,GAA+B/Q,aAA/B,CAA6C,0BAA7C,CAAR;EACH,CAFD;;EAGAgG,gBAAgB,CAACnP,SAAjB,CAA2B6J,cAA3B,GAA4C,UAAUiP,QAAV,EAAoBxX,IAApB,EAA0B8F,MAA1B,EAAkCF,MAAlC,EAA0C;IAClF,IAAI4R,QAAQ,KAAK,KAAK,CAAtB,EAAyB;MAAEA,QAAQ,GAAG,EAAX;IAAgB;;IAC3C,IAAIsC,QAAQ,GAAG,EAAf;;IACA,IAAI,KAAKja,MAAL,CAAYyE,aAAZ,OAAgC,OAApC,EAA6C;MACzC,IAAIsB,MAAM,KAAK,YAAX,IAA4BA,MAAM,KAAK,YAAX,IAA2B,KAAK2S,eAAL,EAAvD,IAAkF3S,MAAM,KAAK,KAAjG,EAAwG;QACpGkU,QAAQ,CAAC,CAAD,CAAR,GAActC,QAAQ,CAAC,CAAD,CAAtB;QACAsC,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;MACH;;MACD,IAAIlU,MAAM,KAAK,UAAf,EAA2B;QACvBkU,QAAQ,CAAC,CAAD,CAAR,GAActC,QAAQ,CAAC,CAAD,CAAR,KAAgB,CAAC,CAAjB,GAAqB,KAAKvV,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAAjD,GAAqD8V,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAjF;QACAsC,QAAQ,CAAC,CAAD,CAAR,GAAc,KAAK7X,MAAL,CAAYA,MAAZ,CAAmB6X,QAAQ,CAAC,CAAD,CAA3B,EAAgCpY,MAA9C;MACH;IACJ,CATD,MAUK;MACD,IAAIkE,MAAM,KAAK,WAAX,IAA2BA,MAAM,KAAK,WAAX,IAA0B,KAAK2S,eAAL,EAArD,IAAgF3S,MAAM,KAAK,UAA/F,EAA2G;QACvGkU,QAAQ,CAAC,CAAD,CAAR,GAActC,QAAQ,CAAC,CAAD,CAAtB;QACAsC,QAAQ,CAAC,CAAD,CAAR,GAAc,KAAK7X,MAAL,CAAYA,MAAZ,CAAmB6X,QAAQ,CAAC,CAAD,CAA3B,EAAgCpY,MAA9C;MACH;IACJ;;IACD,IAAIkE,MAAM,KAAK,SAAX,IAAwBA,MAAM,KAAK,YAAvC,EAAqD;MACjDkU,QAAQ,CAAC,CAAD,CAAR,GAAc,KAAK7X,MAAL,CAAYA,MAAZ,CAAmBP,MAAjC;MACAoY,QAAQ,CAAC,CAAD,CAAR,GAActC,QAAQ,CAAC,CAAD,CAAtB;IACH;;IACD,IAAI5R,MAAM,KAAK,KAAX,IAAoB,KAAK/F,MAAL,CAAYyE,aAAZ,OAAgC,OAAxD,EAAiE;MAC7DwV,QAAQ,CAAC,CAAD,CAAR,GAActC,QAAQ,CAAC,CAAD,CAAR,GAAc,CAA5B;MACAsC,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;IACH;;IACD,OAAOA,QAAP;EACH,CA5BD;;EA6BAjM,gBAAgB,CAACnP,SAAjB,CAA2B0a,aAA3B,GAA2C,YAAY;IACnD,OAAO,kBAAP;EACH,CAFD;;EAGA,OAAOvL,gBAAP;AACH,CA5EqC,CA4EpCE,WA5EoC,CAAtC;;AA6EA,SAASF,gBAAT;AACA;;AACA,IAAIkM,SAAS;AAAG;AAAe,YAAY;EACvC,SAASA,SAAT,CAAmBC,SAAnB,EAA8B;IAC1B,KAAKA,SAAL,GAAiBA,SAAjB;EACH;;EACDD,SAAS,CAACrb,SAAV,CAAoBub,WAApB,GAAkC,UAAUzM,IAAV,EAAgB;IAC9CA,IAAI,CAAC1M,MAAL,CAAYsR,aAAZ,CAA0BrR,SAA1B,CAAoCwP,GAApC,CAAwC,eAAxC;;IACA,IAAI/C,IAAI,CAAC1M,MAAL,CAAYC,SAAZ,CAAsBC,QAAtB,CAA+B,SAA/B,KAA6CwM,IAAI,CAAC1M,MAAL,CAAYC,SAAZ,CAAsBC,QAAtB,CAA+B,UAA/B,CAA7C,IAA2FwM,IAAI,CAAC1M,MAAL,CAAYwK,KAA3G,EAAkH;MAC9GkC,IAAI,CAAC1M,MAAL,CAAYsR,aAAZ,CAA0BvK,aAA1B,CAAwC,eAAxC,EAAyD9G,SAAzD,CAAmE+Q,MAAnE,CAA0E,mBAA1E;IACH;EACJ,CALD;;EAMAiI,SAAS,CAACrb,SAAV,CAAoBwb,UAApB,GAAiC,UAAU1M,IAAV,EAAgB;IAC7CA,IAAI,CAAC1M,MAAL,CAAYsR,aAAZ,CAA0BrR,SAA1B,CAAoC+Q,MAApC,CAA2C,eAA3C;;IACA,IAAItE,IAAI,CAAC1M,MAAL,CAAYC,SAAZ,CAAsBC,QAAtB,CAA+B,UAA/B,KAA8CwM,IAAI,CAACvK,aAAnD,IAAoE,CAAEuK,IAAI,CAACvK,aAAL,CAAmBlC,SAAnB,CAA6BC,QAA7B,CAAsC,sBAAtC,CAAtE,IACG,CAAEwM,IAAI,CAACvK,aAAL,CAAmBlC,SAAnB,CAA6BC,QAA7B,CAAsC,SAAtC,CADT,EAC4D;MACxDwM,IAAI,CAAC1M,MAAL,CAAYsR,aAAZ,CAA0BvK,aAA1B,CAAwC,eAAxC,EAAyD9G,SAAzD,CAAmEwP,GAAnE,CAAuE,mBAAvE;IACH;EACJ,CAND;;EAOAwJ,SAAS,CAACrb,SAAV,CAAoByb,SAApB,GAAgC,YAAY;IACxC,IAAI,KAAKH,SAAT,EAAoB;MAChBpb,YAAY,CAAC2R,GAAb,CAAiB,KAAKyJ,SAAtB,EAAiC,OAAjC,EAA0C,KAAKC,WAA/C,EAA4D,IAA5D;MACArb,YAAY,CAAC2R,GAAb,CAAiB,KAAKyJ,SAAtB,EAAiC,MAAjC,EAAyC,KAAKE,UAA9C,EAA0D,IAA1D;IACH;EACJ,CALD;;EAMAH,SAAS,CAACrb,SAAV,CAAoB0b,WAApB,GAAkC,YAAY;IAC1C,IAAI,KAAKJ,SAAT,EAAoB;MAChBpb,YAAY,CAACkT,MAAb,CAAoB,KAAKkI,SAAzB,EAAoC,OAApC,EAA6C,KAAKC,WAAlD;MACArb,YAAY,CAACkT,MAAb,CAAoB,KAAKkI,SAAzB,EAAoC,MAApC,EAA4C,KAAKE,UAAjD;IACH;EACJ,CALD;;EAMA,OAAOH,SAAP;AACH,CA9B8B,EAA/B;;AA+BA,SAASA,SAAT;;AACA,IAAIpM,sBAAsB;AAAG;AAAe,UAAUgL,MAAV,EAAkB;EAC1D7a,SAAS,CAAC6P,sBAAD,EAAyBgL,MAAzB,CAAT;;EACA,SAAShL,sBAAT,GAAkC;IAC9B,OAAOgL,MAAM,KAAK,IAAX,IAAmBA,MAAM,CAACd,KAAP,CAAa,IAAb,EAAmB4B,SAAnB,CAAnB,IAAoD,IAA3D;EACH;;EACD9L,sBAAsB,CAACjP,SAAvB,CAAiC2V,QAAjC,GAA4C,YAAY;IACpD,OAAO,KAAKxU,MAAL,CAAYmC,UAAZ,GAAyB6F,aAAzB,CAAuC,kCAAvC,CAAP;EACH,CAFD;;EAGA8F,sBAAsB,CAACjP,SAAvB,CAAiCyJ,IAAjC,GAAwC,UAAUvC,MAAV,EAAkBrD,OAAlB,EAA2B;IAC/D,IAAI2U,WAAW,GAAG,KAAKrX,MAAL,CAAY0B,UAAZ,KAA2B,CAA3B,IAAgCqE,MAAM,KAAK,YAA7D;IACA,IAAIwC,QAAQ,GAAG,CAACxC,MAAM,KAAK,SAAX,IAAwBsR,WAAzB,KAAyC3U,OAAO,CAAC,CAAD,CAAP,KAAe,CAAvE;IACA,IAAI8X,YAAY,GAAG,KAAKxa,MAAL,CAAYyE,aAAZ,OAAgC3E,QAAQ,CAAC4E,SAAzC,IAAsDqB,MAAM,KAAK,KAAjE,IACZrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CADtB;IAEA,OAAO;MACHzK,IAAI,EAAEoI,QAAQ,IAAK,CAACxC,MAAM,KAAK,UAAX,IAAyBA,MAAM,KAAK,WAArC,KAAqDrD,OAAO,CAAC,CAAD,CAAP,KAAe,CAAjF,IACEqD,MAAM,KAAK,KAAX,IAAoBrD,OAAO,CAAC,CAAD,CAAP,GAAa,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAA7D,IACGa,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CAHvB;MAIHrC,QAAQ,EAAEA,QAJP;MAKHE,aAAa,EAAEF,QALZ;MAMHC,QAAQ,EAAEgS;IANP,CAAP;EAQH,CAbD;;EAcA1M,sBAAsB,CAACjP,SAAvB,CAAiC6J,cAAjC,GAAkD,UAAUiP,QAAV,EAAoBxX,IAApB,EAA0B8F,MAA1B,EAAkCF,MAAlC,EAA0C;IACxF,IAAI4R,QAAQ,KAAK,KAAK,CAAtB,EAAyB;MAAEA,QAAQ,GAAG,EAAX;IAAgB;;IAC3C,IAAImC,QAAQ,GAAG,EAAf;;IACA,IAAI/T,MAAM,KAAK,YAAX,IAA2BA,MAAM,KAAK,KAA1C,EAAiD;MAC7C+T,QAAQ,CAAC,CAAD,CAAR,GAAcnC,QAAQ,CAAC,CAAD,CAAtB;MACAmC,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;IACH;;IACD,IAAI/T,MAAM,KAAK,WAAX,IAA0BA,MAAM,KAAK,OAAzC,EAAkD;MAC9C+T,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;MACAA,QAAQ,CAAC,CAAD,CAAR,GAAcnC,QAAQ,CAAC,CAAD,CAAtB;IACH;;IACD,IAAI5R,MAAM,KAAK,UAAf,EAA2B;MACvB+T,QAAQ,CAAC,CAAD,CAAR,GAAcnC,QAAQ,CAAC,CAAD,CAAR,GAAc,CAA5B;MACAmC,QAAQ,CAAC,CAAD,CAAR,GAAc,KAAK1X,MAAL,CAAYA,MAAZ,CAAmB0X,QAAQ,CAAC,CAAD,CAA3B,EAAgCjY,MAA9C;IACH;;IACD,OAAOiY,QAAP;EACH,CAhBD;;EAiBA,OAAOhM,sBAAP;AACH,CAxC2C,CAwC1CC,YAxC0C,CAA5C;;AAyCA,SAASD,sBAAT;;AACA,IAAIG,qBAAqB;AAAG;AAAe,UAAU6K,MAAV,EAAkB;EACzD7a,SAAS,CAACgQ,qBAAD,EAAwB6K,MAAxB,CAAT;;EACA,SAAS7K,qBAAT,GAAiC;IAC7B,OAAO6K,MAAM,KAAK,IAAX,IAAmBA,MAAM,CAACd,KAAP,CAAa,IAAb,EAAmB4B,SAAnB,CAAnB,IAAoD,IAA3D;EACH;;EACD3L,qBAAqB,CAACpP,SAAtB,CAAgCyJ,IAAhC,GAAuC,UAAUvC,MAAV,EAAkBrD,OAAlB,EAA2B;IAC9D,IAAI+X,SAAS,GAAG,KAAKza,MAAL,CAAYgK,WAAZ,CAAwBqC,MAAxB,IAAkC,KAAKrM,MAAL,CAAYgK,WAAZ,CAAwBqC,MAAxB,CAA+BjK,MAA/B,CAAsCA,MAAxF;IACA,IAAIiT,SAAS,GAAGoF,SAAS,IAAI,CAACvb,iBAAiB,CAACub,SAAS,CAAC/X,OAAO,CAAC,CAAD,CAAR,CAAV,CAA/C;IACA,IAAI2U,WAAW,GAAG,KAAKrX,MAAL,CAAY0B,UAAZ,KAA2B,CAA3B,IAAgCqE,MAAM,KAAK,OAA7D;IACA,IAAImR,UAAU,GAAG,CAACnR,MAAM,KAAK,WAAX,IAA2BA,MAAM,KAAK,WAAX,IAA0B,KAAK2S,eAAL,EAArD,IACX3S,MAAM,KAAK,UADD,MACiBrD,OAAO,CAAC,CAAD,CAAP,KAAe,CAAf,IAAoBA,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BoH,OAA/B,CAAuC,CAAvC,CADpD,KAETpH,OAAO,CAAC,CAAD,CAAP,GAAa,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAAzC,IAA8CkE,MAAM,KAAK,KAAzD,IACGrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CAH1B;IAIA,IAAIzK,IAAI,GAAI,CAAC4F,MAAM,KAAK,WAAX,IAA0BsR,WAA1B,IAA0CtR,MAAM,KAAK,KAAX,IAChDrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CADV,KAC6DlI,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CADzG,IAENwT,SAAS,IAAI6B,UAFlB;IAGA,IAAI2C,KAAK,GAAG9T,MAAM,KAAK,KAAX,IAAoBrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CAA/C;IACA,IAAIwM,MAAM,GAAG,CAACrR,MAAM,KAAK,WAAX,IAA0BsR,WAA3B,KAA2C3U,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAAnG;;IACA,IAAIkE,MAAM,KAAK,KAAX,IAAoBrD,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAA/D,IACGa,OAAO,CAAC,CAAD,CAAP,KAAe,KAAKN,MAAL,CAAYA,MAAZ,CAAmBM,OAAO,CAAC,CAAD,CAA1B,EAA+BkI,WAA/B,CAA2C,CAA3C,CADtB,EACqE;MACjE,KAAKxI,MAAL,CAAYM,OAAZ,CAAoB,CAApB,IAAyB,CAAC,CAA1B;IACH;;IACD,OAAO;MAAEvC,IAAI,EAAEA,IAAR;MAAcoI,QAAQ,EAAE2O,UAAxB;MAAoC1O,QAAQ,EAAEqR,KAA9C;MAAqDpR,aAAa,EAAE2O;IAApE,CAAP;EACH,CAlBD;;EAmBAnJ,qBAAqB,CAACpP,SAAtB,CAAgC2V,QAAhC,GAA2C,YAAY;IACnD,OAAQ,KAAKxU,MAAL,CAAY+Y,gBAAZ,GAA+B/Q,aAA/B,CAA6C,iCAA7C,CAAR;EACH,CAFD;;EAGAiG,qBAAqB,CAACpP,SAAtB,CAAgC6J,cAAhC,GAAiD,UAAUiP,QAAV,EAAoBxX,IAApB,EAA0B8F,MAA1B,EAAkCF,MAAlC,EAA0C;IACvF,IAAI4R,QAAQ,KAAK,KAAK,CAAtB,EAAyB;MAAEA,QAAQ,GAAG,EAAX;IAAgB;;IAC3C,IAAIsC,QAAQ,GAAG,EAAf;;IACA,IAAIlU,MAAM,KAAK,YAAX,IAA4BA,MAAM,KAAK,YAAX,IAA2B,KAAK2S,eAAL,EAAvD,IAAkF3S,MAAM,KAAK,KAAjG,EAAwG;MACpGkU,QAAQ,CAAC,CAAD,CAAR,GAActC,QAAQ,CAAC,CAAD,CAAtB;MACAsC,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAC,CAAf;IACH;;IACD,IAAIlU,MAAM,KAAK,SAAX,IAAwBA,MAAM,KAAK,YAAvC,EAAqD;MACjDkU,QAAQ,CAAC,CAAD,CAAR,GAAc,KAAK7X,MAAL,CAAYA,MAAZ,CAAmBP,MAAjC;MACAoY,QAAQ,CAAC,CAAD,CAAR,GAActC,QAAQ,CAAC,CAAD,CAAtB;IACH;;IACD,IAAI5R,MAAM,KAAK,UAAf,EAA2B;MACvBkU,QAAQ,CAAC,CAAD,CAAR,GAActC,QAAQ,CAAC,CAAD,CAAR,KAAgB,CAAC,CAAjB,GAAqB,KAAKvV,MAAL,CAAYA,MAAZ,CAAmBP,MAAnB,GAA4B,CAAjD,GAAqD8V,QAAQ,CAAC,CAAD,CAAR,GAAc,CAAjF;MACAsC,QAAQ,CAAC,CAAD,CAAR,GAAc,KAAK7X,MAAL,CAAYA,MAAZ,CAAmB6X,QAAQ,CAAC,CAAD,CAA3B,EAAgCpY,MAA9C;IACH;;IACD,OAAOoY,QAAP;EACH,CAhBD;;EAiBAhM,qBAAqB,CAACpP,SAAtB,CAAgC0a,aAAhC,GAAgD,YAAY;IACxD,OAAO,uBAAP;EACH,CAFD;;EAGA,OAAOtL,qBAAP;AACH,CAhD0C,CAgDzCC,WAhDyC,CAA3C;;AAiDA,SAASD,qBAAT"},"metadata":{},"sourceType":"module"}