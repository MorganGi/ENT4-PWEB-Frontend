{"ast":null,"code":"import { createElement, isNullOrUndefined, isBlazor } from '@syncfusion/ej2-base';\nimport { Dialog } from '@syncfusion/ej2-popups';\nimport { splitArrayCollection, processPathData, getPathString } from '@syncfusion/ej2-drawings';\nimport { TextBox } from '@syncfusion/ej2-inputs';\nimport { cloneObject } from '../drawing/drawing-util';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { Tab } from '@syncfusion/ej2-navigations';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { DisplayMode } from './types';\n/**\n * @hidden\n */\n\nvar Signature =\n/** @class */\nfunction () {\n  /**\n   * Initialize the constructor of blazorUIadapater.\n   * @private\n   * @param { PdfViewer } pdfViewer - Specified PdfViewer class.\n   * @param { PdfViewerBase } pdfViewerBase - The pdfViewerBase.\n   */\n  function Signature(pdfViewer, pdfViewerBase) {\n    var _this = this;\n\n    this.mouseMoving = true;\n    this.canvasTouched = false; // eslint-disable-next-line\n\n    this.newObject = [];\n    /**\n     * @private\n     */\n\n    this.outputString = '';\n    /**\n     * @private\n     */\n\n    this.drawOutputString = '';\n    /**\n    * @private\n    */\n\n    this.imageOutputString = '';\n    /**\n     * @private\n     */\n    // eslint-disable-next-line\n\n    this.signaturecollection = [];\n    /**\n     * @private\n     */\n    // eslint-disable-next-line\n\n    this.outputcollection = [];\n    /**\n     * @private\n     */\n    // eslint-disable-next-line\n\n    this.signAnnotationIndex = []; // eslint-disable-next-line\n\n    this.fontsign = []; // eslint-disable-next-line\n\n    this.signfontStyle = [];\n    this.isSaveSignature = false;\n    this.isInitialFiledSaveSignature = false;\n    this.isSignatureFieldsSaveSignature = false; // eslint-disable-next-line\n\n    this.saveSignatureString = '';\n    /**\n     * @private\n     */\n    // eslint-disable-next-line\n\n    this.saveImageString = '';\n    this.signatureImageString = '';\n    /**\n     * @private\n     */\n    // eslint-disable-next-line\n\n    this.maxSaveLimit = 5;\n\n    this.select = function (e) {\n      if (this.canvasTouched) {\n        this.mouseMoving = true;\n        this.canvasTouched = false;\n      }\n\n      if (e.isSwiped && this.signaturetype == 'Draw' && this.mouseMoving) {\n        e.cancel = true;\n        this.mouseMoving = false;\n      }\n    }; // eslint-disable-next-line\n\n\n    this.addStampImage = function (args) {\n      // eslint-disable-next-line\n      var proxy = _this; // eslint-disable-next-line\n\n      var upoadedFiles = args.target.files;\n\n      if (args.target.files[0] !== null) {\n        var uploadedFile = upoadedFiles[0];\n\n        if (uploadedFile.type.split('/')[0] === 'image') {\n          var reader = new FileReader(); // eslint-disable-next-line\n\n          reader.onload = function (e) {\n            // eslint-disable-next-line\n            var canvas = document.getElementById(_this.pdfViewer.element.id + '_signatureuploadCanvas_'); // eslint-disable-next-line\n\n            var context = canvas.getContext('2d'); // eslint-disable-next-line\n\n            var image = new Image(); // eslint-disable-next-line\n\n            var proxy = _this;\n\n            image.onload = function () {\n              // eslint-disable-next-line\n              var signbutton = document.getElementById(_this.pdfViewer.element.id + '_e-pv-upload-button');\n              signbutton.style.visibility = 'hidden';\n              context.drawImage(image, 0, 0, canvas.width, canvas.height);\n              proxy.enableCreateButton(false);\n              proxy.outputString = image.src;\n              proxy.signatureImageHeight = image.naturalHeight;\n              proxy.signatureImageWidth = image.naturalWidth;\n            };\n\n            image.src = e.currentTarget.result;\n            proxy.outputString = e.currentTarget.result;\n          };\n\n          reader.readAsDataURL(uploadedFile);\n        }\n      }\n\n      args.target.value = '';\n      args.currentTarget.value = '';\n    };\n\n    this.pdfViewer = pdfViewer;\n    this.pdfViewerBase = pdfViewerBase;\n  }\n  /**\n   * @private\n   * @returns {void}\n   */\n\n\n  Signature.prototype.createSignaturePanel = function () {\n    var _this = this;\n\n    var maximumWidth = 750;\n\n    if (!isBlazor()) {\n      var elementID = this.pdfViewer.element.id;\n      var dialogDiv = createElement('div', {\n        id: elementID + '_signature_window',\n        className: 'e-pv-signature-window'\n      });\n      dialogDiv.style.display = 'block';\n      this.pdfViewerBase.pageContainer.appendChild(dialogDiv);\n      var appearanceTab = this.createSignatureCanvas();\n      var signaturePanelHeader = void 0;\n\n      if (!this.pdfViewerBase.isToolbarSignClicked) {\n        if (this.pdfViewerBase.isInitialField) {\n          signaturePanelHeader = this.pdfViewer.localeObj.getConstant('HandwrittenInitialDialogHeaderText');\n        } else {\n          signaturePanelHeader = this.pdfViewer.localeObj.getConstant('HandwrittenSignatureDialogHeaderText');\n        }\n      } else {\n        if (this.pdfViewerBase.isInitialField) {\n          signaturePanelHeader = this.pdfViewer.localeObj.getConstant('InitialFieldDialogHeaderText');\n        } else {\n          signaturePanelHeader = this.pdfViewer.localeObj.getConstant('SignatureFieldDialogHeaderText');\n        }\n      }\n\n      if (this.signatureDialog) {\n        this.signatureDialog.content = appearanceTab;\n      } else {\n        this.signatureDialog = new Dialog({\n          // eslint-disable-next-line max-len\n          showCloseIcon: true,\n          closeOnEscape: false,\n          isModal: true,\n          header: signaturePanelHeader,\n          cssClass: 'e-pv-signature-dialog-height',\n          target: this.pdfViewer.element,\n          content: appearanceTab,\n          width: '750px',\n          visible: true,\n          allowDragging: true,\n          beforeClose: function () {\n            _this.clearSignatureCanvas();\n\n            _this.signatureDialog.destroy();\n\n            _this.signatureDialog = null;\n\n            if (_this.tabObj) {\n              _this.tabObj.destroy();\n            } // eslint-disable-next-line\n\n\n            var signatureWindow = document.getElementById(_this.pdfViewer.element.id + '_signature_window');\n\n            if (signatureWindow) {\n              // eslint-disable-next-line\n              signatureWindow.parentNode ? signatureWindow.parentNode.removeChild(signatureWindow) : signatureWindow.parentElement.removeChild(signatureWindow);\n            } // eslint-disable-next-line max-len\n\n\n            if (!_this.pdfViewerBase.isToolbarSignClicked && !_this.pdfViewerBase.drawSignatureWithTool && !isNullOrUndefined(_this.pdfViewer.formFieldsModule.currentTarget)) {\n              _this.pdfViewer.fireFocusOutFormField(_this.pdfViewer.formFieldsModule.currentTarget.name, '');\n            }\n\n            _this.pdfViewerBase.isToolbarSignClicked = false;\n\n            _this.pdfViewer.formFieldsModule.setFocus();\n          }\n        });\n        this.signatureDialog.buttons = [// eslint-disable-next-line max-len\n        {\n          buttonModel: {\n            content: this.pdfViewer.localeObj.getConstant('Clear'),\n            disabled: true,\n            cssClass: 'e-pv-clearbtn'\n          },\n          click: this.clearSignatureCanvas.bind(this)\n        }, // eslint-disable-next-line max-len\n        {\n          buttonModel: {\n            content: this.pdfViewer.localeObj.getConstant('Cancel')\n          },\n          click: this.closeSignaturePanel.bind(this)\n        }, // eslint-disable-next-line max-len\n        {\n          buttonModel: {\n            content: this.pdfViewer.localeObj.getConstant('Create'),\n            isPrimary: true,\n            disabled: true,\n            cssClass: 'e-pv-createbtn'\n          },\n          click: this.addSignatureInPage.bind(this)\n        }];\n        this.signatureDialog.appendTo(dialogDiv);\n      }\n\n      if (this.pdfViewer.element.offsetWidth < maximumWidth) this.updateCanvasSize();\n\n      if (this.pdfViewer.enableRtl) {\n        this.signatureDialog.enableRtl = this.pdfViewer.enableRtl;\n      }\n\n      var checkboxItem = this.signatureDialog.content.ej2_instances[0].items[0];\n\n      if (checkboxItem.header.label === 'DRAW') {\n        var drawCheckbox = document.getElementById(\"checkbox\");\n        this.hideSignatureCheckbox(drawCheckbox);\n      } else if (checkboxItem.header.label === 'TYPE') {\n        var typeCheckbox = document.getElementById(\"checkbox1\");\n        this.hideSignatureCheckbox(typeCheckbox);\n      } else {\n        var imageCheckbox = document.getElementById(\"checkbox2\");\n        this.hideSignatureCheckbox(imageCheckbox);\n      }\n    } else {\n      // eslint-disable-next-line\n      var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n\n      if (canvas) {\n        if (!this.pdfViewerBase.pageContainer.querySelector('.e-pv-signature-window')) {\n          var elementID = this.pdfViewer.element.id; // eslint-disable-next-line max-len\n\n          var dialogDiv = createElement('div', {\n            id: elementID + '_signature_window',\n            className: 'e-pv-signature-window'\n          });\n          dialogDiv.style.display = 'block';\n          this.pdfViewerBase.pageContainer.appendChild(dialogDiv);\n        }\n\n        canvas.addEventListener('mousedown', this.signaturePanelMouseDown.bind(this));\n        canvas.addEventListener('mousemove', this.signaturePanelMouseMove.bind(this));\n        canvas.addEventListener('mouseup', this.signaturePanelMouseUp.bind(this));\n        canvas.addEventListener('mouseleave', this.signaturePanelMouseUp.bind(this));\n        canvas.addEventListener('touchstart', this.signaturePanelMouseDown.bind(this));\n        canvas.addEventListener('touchmove', this.signaturePanelMouseMove.bind(this));\n        canvas.addEventListener('touchend', this.signaturePanelMouseUp.bind(this));\n        this.clearSignatureCanvas();\n      }\n\n      this.pdfViewer._dotnetInstance.invokeMethodAsync('OpenSignaturePanel', this.pdfViewerBase.isToolbarSignClicked);\n    }\n\n    this.drawSavedSignature();\n  };\n\n  Signature.prototype.drawSavedSignature = function () {\n    if (!this.pdfViewerBase.isToolbarSignClicked && this.isSaveSignature) {\n      this.outputString = this.saveSignatureString; // eslint-disable-next-line\n\n      var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_'); // eslint-disable-next-line\n\n      var context_1 = canvas.getContext('2d'); // eslint-disable-next-line\n\n      var image_1 = new Image();\n\n      image_1.onload = function () {\n        context_1.drawImage(image_1, 0, 0);\n      };\n\n      image_1.src = this.signatureImageString; // eslint-disable-next-line\n\n      var checkbox = document.getElementById(this.pdfViewer.element.id + '_signatureCheckBox');\n\n      if (checkbox) {\n        checkbox.checked = true;\n      }\n\n      this.enableCreateButton(false);\n      this.enableClearbutton(false);\n    }\n  };\n\n  Signature.prototype.hideSignatureCheckbox = function (checkbox) {\n    if (this.pdfViewerBase.isToolbarSignClicked) {\n      if (this.pdfViewerBase.isInitialField) {\n        if (this.pdfViewer.handWrittenSignatureSettings.initialDialogSettings.hideSaveSignature) {\n          this.hideCheckboxParent(checkbox);\n        }\n      } else if (this.pdfViewer.handWrittenSignatureSettings.signatureDialogSettings.hideSaveSignature) {\n        this.hideCheckboxParent(checkbox);\n      }\n    } else {\n      if (this.pdfViewerBase.isInitialField) {\n        if (this.pdfViewer.initialFieldSettings.initialDialogSettings.hideSaveSignature) {\n          this.hideCheckboxParent(checkbox);\n        }\n      } else {\n        if (this.pdfViewer.signatureFieldSettings.signatureDialogSettings.hideSaveSignature) {\n          this.hideCheckboxParent(checkbox);\n        }\n      }\n    }\n  };\n\n  Signature.prototype.saveSignatureCheckbox = function () {\n    if (this.pdfViewerBase.isToolbarSignClicked) {\n      return false;\n    } else {\n      if (this.pdfViewerBase.isInitialField) {\n        if (this.pdfViewer.initialFieldSettings.initialDialogSettings.hideSaveSignature) {\n          return false;\n        } else {\n          return this.isInitialFiledSaveSignature;\n        }\n      } else {\n        if (this.pdfViewer.signatureFieldSettings.signatureDialogSettings.hideSaveSignature) {\n          return false;\n        } else {\n          return this.isSignatureFieldsSaveSignature;\n        }\n      }\n    }\n  };\n\n  Signature.prototype.hideCheckboxParent = function (checkbox) {\n    if (checkbox) {\n      checkbox.parentElement.style.display = 'none';\n    }\n  };\n\n  Signature.prototype.saveSignatureImage = function () {\n    // eslint-disable-next-line\n    var checkbox = document.getElementById(this.pdfViewer.element.id + '_signatureCheckBox');\n\n    if (checkbox && checkbox.checked) {\n      if (this.outputString !== '') {\n        this.isSaveSignature = true;\n        this.saveSignatureString = this.outputString; // eslint-disable-next-line\n\n        var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n        this.saveImageString = canvas.toDataURL();\n        this.signatureImageString = this.saveImageString;\n      }\n    } else {\n      if (this.isSaveSignature) {\n        this.isSaveSignature = false;\n        this.saveSignatureString = '';\n        this.saveImageString = '';\n        this.signatureImageString = '';\n      }\n\n      this.clearSignatureCanvas();\n    }\n  };\n  /**\n   * @param type\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  Signature.prototype.addSignature = function (type) {\n    var annot;\n\n    if (this.pdfViewerBase.isToolbarSignClicked) {\n      var annotationName = this.pdfViewer.annotation.createGUID();\n      this.pdfViewerBase.currentSignatureAnnot = null;\n      this.pdfViewerBase.isSignatureAdded = true;\n      var pageIndex = this.pdfViewerBase.currentPageNumber - 1; // eslint-disable-next-line max-len\n\n      var thickness = this.pdfViewer.handWrittenSignatureSettings.thickness ? this.pdfViewer.handWrittenSignatureSettings.thickness : 1; // eslint-disable-next-line max-len\n\n      var opacity = this.pdfViewer.handWrittenSignatureSettings.opacity ? this.pdfViewer.handWrittenSignatureSettings.opacity : 1; // eslint-disable-next-line max-len\n\n      var strokeColor = this.pdfViewer.handWrittenSignatureSettings.strokeColor ? this.pdfViewer.handWrittenSignatureSettings.strokeColor : '#000000';\n      var fontSize = 16;\n      var fontFamily = 'Helvetica';\n      var signatureBounds = this.pdfViewer.formFieldsModule.updateSignatureAspectRatio(this.outputString, true); // eslint-disable-next-line\n\n      var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n      this.saveImageString = canvas.toDataURL();\n      this.signatureImageString = this.saveImageString;\n      annot = {\n        // eslint-disable-next-line max-len\n        id: 'sign' + this.pdfViewerBase.signatureCount,\n        bounds: signatureBounds,\n        pageIndex: pageIndex,\n        data: this.outputString,\n        fontFamily: fontFamily,\n        fontSize: fontSize,\n        shapeAnnotationType: 'HandWrittenSignature',\n        opacity: opacity,\n        strokeColor: strokeColor,\n        thickness: thickness,\n        signatureName: annotationName\n      };\n      this.pdfViewerBase.currentSignatureAnnot = annot; // eslint-disable-next-line\n\n      var checkbox = void 0;\n\n      if (isBlazor()) {\n        checkbox = document.getElementById(this.pdfViewer.element.id + '_signatureCheckBox');\n      } else {\n        checkbox = document.getElementById('checkbox');\n      }\n\n      if (checkbox && checkbox.checked) {\n        this.addSignatureCollection();\n      }\n\n      this.hideSignaturePanel();\n      this.pdfViewerBase.isToolbarSignClicked = false;\n    } else {\n      // eslint-disable-next-line\n      var checkbox = void 0;\n\n      if (isBlazor()) {\n        checkbox = document.getElementById(this.pdfViewer.element.id + '_signatureCheckBox');\n      } else {\n        checkbox = document.getElementById('checkbox');\n      }\n\n      var isSignatureAdded = false;\n\n      if (isBlazor() && type) {\n        if (type[0] === 'Image') {\n          this.imageAddSignature();\n          isSignatureAdded = true;\n          this.outputString = '';\n        } else if (type[0] === 'Type') {\n          this.typeAddSignature();\n          isSignatureAdded = true;\n          this.outputString = '';\n        }\n      }\n\n      if (!isSignatureAdded) {\n        // eslint-disable-next-line\n        var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n        this.saveImageString = canvas.toDataURL();\n\n        if (checkbox && checkbox.checked) {\n          this.isSaveSignature = true;\n          this.saveSignatureString = this.outputString;\n          this.checkSaveFiledSign(this.pdfViewerBase.isInitialField, true);\n        } else {\n          this.isSaveSignature = false;\n          this.saveSignatureString = '';\n          this.checkSaveFiledSign(this.pdfViewerBase.isInitialField, false);\n        }\n\n        this.signatureImageString = this.saveImageString;\n        this.pdfViewer.formFieldsModule.drawSignature(null, null, this.pdfViewerBase.currentTarget, null);\n        isSignatureAdded = true;\n      }\n    }\n  };\n\n  Signature.prototype.checkSaveFiledSign = function (initialField, saveSign) {\n    if (initialField) {\n      this.isInitialFiledSaveSignature = saveSign;\n    } else {\n      this.isSignatureFieldsSaveSignature = saveSign;\n    }\n  };\n\n  Signature.prototype.addSignatureInPage = function () {\n    if (this.signaturetype === 'Draw') {\n      this.addSignature();\n    } else if (this.signaturetype === 'Type') {\n      this.typeAddSignature();\n    } else {\n      this.imageAddSignature();\n    }\n\n    this.drawOutputString = '';\n    this.imageOutputString = '';\n  };\n\n  Signature.prototype.typeAddSignature = function () {\n    if (this.pdfViewerBase.isToolbarSignClicked) {\n      var zoomvalue = this.pdfViewerBase.getZoomFactor(); // eslint-disable-next-line\n\n      var annot = null;\n      var annotationName = this.pdfViewer.annotation.createGUID();\n      this.pdfViewerBase.currentSignatureAnnot = null;\n      this.pdfViewerBase.isSignatureAdded = true;\n      var pageIndex = this.pdfViewerBase.currentPageNumber - 1;\n      var pageDiv = document.getElementById(this.pdfViewer.element.id + '_pageDiv_' + pageIndex);\n      var thickness = this.pdfViewer.handWrittenSignatureSettings.thickness ? this.pdfViewer.handWrittenSignatureSettings.thickness : 1;\n      var opacity = this.pdfViewer.handWrittenSignatureSettings.opacity ? this.pdfViewer.handWrittenSignatureSettings.opacity : 1;\n      var strokeColor = this.pdfViewer.handWrittenSignatureSettings.strokeColor ? this.pdfViewer.handWrittenSignatureSettings.strokeColor : '#000000';\n      var fontSize = 16;\n      var currentLeft = 0;\n      var currentTop = 0;\n      var currentHeight = 65;\n      var currentWidth = 200;\n      currentLeft = (parseFloat(pageDiv.style.width) / 2 - currentWidth / 2) / zoomvalue;\n      currentTop = (parseFloat(pageDiv.style.height) / 2 - currentHeight / 2) / zoomvalue;\n      var zoomFactor = this.pdfViewerBase.getZoomFactor();\n\n      if (!this.signtypevalue) {\n        this.updateSignatureTypeValue(true);\n      }\n\n      var inputValue = this.signtypevalue;\n      annot = {\n        // eslint-disable-next-line max-len\n        id: 'Typesign' + this.pdfViewerBase.signatureCount,\n        bounds: {\n          left: currentLeft / zoomFactor,\n          top: currentTop / zoomFactor,\n          x: currentLeft / zoomFactor,\n          // eslint-disable-next-line max-len\n          y: currentTop / zoomFactor,\n          width: currentWidth,\n          height: currentHeight\n        },\n        pageIndex: pageIndex,\n        dynamicText: inputValue,\n        data: this.pdfViewerBase.signatureModule.outputString,\n        shapeAnnotationType: 'SignatureText',\n        opacity: opacity,\n        strokeColor: strokeColor,\n        thickness: thickness,\n        fontSize: fontSize,\n        fontFamily: this.fontName,\n        signatureName: annotationName\n      };\n      this.pdfViewerBase.currentSignatureAnnot = annot; // eslint-disable-next-line\n\n      var checkbox = void 0;\n\n      if (isBlazor()) {\n        checkbox = document.getElementById(this.pdfViewer.element.id + '_signatureCheckBox');\n      } else {\n        checkbox = document.getElementById('checkbox1');\n      }\n\n      if (checkbox && checkbox.checked) {\n        this.addSignatureCollection();\n      }\n\n      this.signtypevalue = '';\n      this.hideSignaturePanel();\n      this.pdfViewerBase.isToolbarSignClicked = false;\n    } else {\n      if (this.outputString === '') {\n        this.updateSignatureTypeValue();\n      }\n\n      this.pdfViewer.formFieldsModule.drawSignature('Type', '', this.pdfViewerBase.currentTarget);\n      this.hideSignaturePanel();\n    }\n  };\n\n  Signature.prototype.imageAddSignature = function () {\n    if (this.pdfViewerBase.isToolbarSignClicked) {\n      var zoomvalue = this.pdfViewerBase.getZoomFactor(); // eslint-disable-next-line\n\n      var annot = null;\n      var annotationName = this.pdfViewer.annotation.createGUID();\n      this.pdfViewerBase.currentSignatureAnnot = null;\n      this.pdfViewerBase.isSignatureAdded = true;\n      var pageIndex = this.pdfViewerBase.currentPageNumber - 1;\n      var pageDiv = document.getElementById(this.pdfViewer.element.id + '_pageDiv_' + pageIndex);\n      var thickness = this.pdfViewer.handWrittenSignatureSettings.thickness ? this.pdfViewer.handWrittenSignatureSettings.thickness : 1;\n      var opacity = this.pdfViewer.handWrittenSignatureSettings.opacity ? this.pdfViewer.handWrittenSignatureSettings.opacity : 1;\n      var strokeColor = this.pdfViewer.handWrittenSignatureSettings.strokeColor ? this.pdfViewer.handWrittenSignatureSettings.strokeColor : '#000000';\n      var fontSize = 16;\n      var currentLeft = 0;\n      var currentTop = 0;\n      var standardImageRatio = 100;\n      var currentHeight = 0;\n      var currentWidth = 0; // eslint-disable-next-line max-len\n\n      if (this.signatureImageHeight >= this.signatureImageWidth) {\n        currentHeight = this.signatureImageHeight / this.signatureImageHeight * standardImageRatio;\n        currentWidth = this.signatureImageWidth / this.signatureImageHeight * standardImageRatio;\n      } else {\n        currentHeight = this.signatureImageHeight / this.signatureImageWidth * standardImageRatio;\n        currentWidth = this.signatureImageWidth / this.signatureImageWidth * standardImageRatio;\n      }\n\n      currentLeft = (parseFloat(pageDiv.style.width) / 2 - currentWidth / 2) / zoomvalue;\n      currentTop = (parseFloat(pageDiv.style.height) / 2 - currentHeight / 2) / zoomvalue;\n      var zoomFactor = this.pdfViewerBase.getZoomFactor();\n      var inputValue = this.signtypevalue;\n      annot = {\n        // eslint-disable-next-line max-len\n        id: 'Typesign' + this.pdfViewerBase.signatureCount,\n        bounds: {\n          left: currentLeft / zoomFactor,\n          top: currentTop / zoomFactor,\n          x: currentLeft / zoomFactor,\n          // eslint-disable-next-line max-len\n          y: currentTop / zoomFactor,\n          width: currentWidth,\n          height: currentHeight\n        },\n        pageIndex: pageIndex,\n        dynamicText: inputValue,\n        data: this.pdfViewerBase.signatureModule.outputString,\n        shapeAnnotationType: 'SignatureImage',\n        opacity: opacity,\n        strokeColor: strokeColor,\n        thickness: thickness,\n        fontSize: fontSize,\n        fontFamily: this.fontName,\n        signatureName: annotationName\n      };\n      this.pdfViewerBase.currentSignatureAnnot = annot; // eslint-disable-next-line\n\n      var checkbox = void 0;\n\n      if (isBlazor()) {\n        checkbox = document.getElementById(this.pdfViewer.element.id + '_signatureCheckBox');\n      } else {\n        checkbox = document.getElementById('checkbox2');\n      }\n\n      if (checkbox && checkbox.checked) {\n        this.addSignatureCollection();\n      }\n\n      this.hideSignaturePanel();\n      this.pdfViewerBase.isToolbarSignClicked = false;\n    } else {\n      this.pdfViewer.formFieldsModule.drawSignature('Image', '', this.pdfViewerBase.currentTarget);\n      this.hideSignaturePanel();\n    }\n  };\n\n  Signature.prototype.updateSignatureTypeValue = function (isType) {\n    // eslint-disable-next-line\n    var fontElements = document.querySelectorAll('.e-pv-font-sign');\n\n    if (fontElements) {\n      for (var j = 0; j < fontElements.length; j++) {\n        if (fontElements[j] && fontElements[j].style.borderColor === 'red') {\n          if (isType) {\n            this.signtypevalue = fontElements[j].textContent;\n            this.outputString = fontElements[j].textContent;\n          } else {\n            this.outputString = fontElements[j].textContent;\n          }\n\n          try {\n            this.fontName = JSON.parse(fontElements[j].style.fontFamily);\n          } catch (e) {\n            this.fontName = fontElements[j].style.fontFamily;\n          }\n        }\n      }\n    }\n  };\n  /**\n   * @private\n   * @returns {void}\n   */\n\n\n  Signature.prototype.hideSignaturePanel = function () {\n    if (this.signatureDialog) {\n      this.signatureDialog.hide();\n    }\n  };\n\n  Signature.prototype.bindTypeSignatureClickEvent = function () {\n    if (isBlazor()) {\n      for (var i = 0; i < 4; i++) {\n        // eslint-disable-next-line\n        var fontElement = document.querySelector('#' + this.pdfViewer.element.id + '_font_signature' + i);\n\n        if (fontElement) {\n          fontElement.addEventListener('click', this.typeSignatureclicked.bind(this));\n        }\n      }\n    }\n  };\n\n  Signature.prototype.bindDrawSignatureClickEvent = function () {\n    // eslint-disable-next-line\n    var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n\n    if (canvas) {\n      canvas.addEventListener('mousedown', this.signaturePanelMouseDown.bind(this));\n      canvas.addEventListener('mousemove', this.signaturePanelMouseMove.bind(this));\n      canvas.addEventListener('mouseup', this.signaturePanelMouseUp.bind(this));\n      canvas.addEventListener('mouseleave', this.signaturePanelMouseUp.bind(this));\n      canvas.addEventListener('touchstart', this.signaturePanelMouseDown.bind(this));\n      canvas.addEventListener('touchmove', this.signaturePanelMouseMove.bind(this));\n      canvas.addEventListener('touchend', this.signaturePanelMouseUp.bind(this));\n    }\n  }; // eslint-disable-next-line\n\n\n  Signature.prototype.typeSignatureclicked = function (event) {\n    var eventTarget = event.target;\n\n    if (eventTarget) {\n      for (var i = 0; i < 4; i++) {\n        // eslint-disable-next-line\n        var fontElement = document.querySelector('#' + this.pdfViewer.element.id + '_font_signature' + i);\n\n        if (fontElement) {\n          fontElement.style.borderColor = '';\n        }\n      }\n\n      eventTarget.style.borderColor = 'red';\n      this.outputString = eventTarget.textContent;\n\n      try {\n        this.fontName = JSON.parse(eventTarget.style.fontFamily);\n      } catch (e) {\n        this.fontName = eventTarget.style.fontFamily;\n      }\n\n      this.enableCreateButton(false);\n    }\n  }; // eslint-disable-next-line\n\n\n  Signature.prototype.createSignatureCanvas = function () {\n    // eslint-disable-next-line\n    var previousField = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_'); // eslint-disable-next-line\n\n    var field = document.getElementById(this.pdfViewer.element.id + 'Signature_appearance');\n\n    if (previousField) {\n      previousField.remove();\n    }\n\n    if (field) {\n      field.remove();\n    } // eslint-disable-next-line max-len\n\n\n    var appearanceDiv = createElement('div', {\n      id: this.pdfViewer.element.id + 'Signature_appearance',\n      className: 'e-pv-signature-apperance',\n      styles: 'margin-top:30px'\n    }); // eslint-disable-next-line max-len\n\n    var canvas = createElement('canvas', {\n      id: this.pdfViewer.element.id + '_signatureCanvas_',\n      className: 'e-pv-signature-canvas'\n    });\n\n    if (this.pdfViewer.element.offsetWidth > 750) {\n      canvas.width = 714;\n    } else {\n      canvas.width = this.pdfViewer.element.offsetWidth - 35;\n    }\n\n    canvas.classList.add('e-pv-canvas-signature');\n    canvas.height = 305;\n    canvas.style.height = '305px';\n    canvas.style.border = '1px dotted #bdbdbd';\n    canvas.style.backgroundColor = 'white';\n    canvas.style.boxSizing = 'border-box';\n    canvas.style.borderRadius = '2px';\n    canvas.addEventListener('mousedown', this.signaturePanelMouseDown.bind(this));\n    canvas.addEventListener('mousemove', this.signaturePanelMouseMove.bind(this));\n    canvas.addEventListener('mouseup', this.signaturePanelMouseUp.bind(this));\n    canvas.addEventListener('mouseleave', this.signaturePanelMouseLeave.bind(this));\n    canvas.addEventListener('touchstart', this.signaturePanelMouseDown.bind(this));\n    canvas.addEventListener('touchmove', this.signaturePanelMouseMove.bind(this));\n    canvas.addEventListener('touchend', this.signaturePanelMouseUp.bind(this));\n    appearanceDiv.appendChild(canvas); // eslint-disable-next-line\n\n    var checkBoxObj; // eslint-disable-next-line\n\n    var input;\n    var saveCheckBoxContent;\n\n    if (this.pdfViewerBase.isToolbarSignClicked && !this.pdfViewerBase.isInitialField) {\n      saveCheckBoxContent = this.pdfViewer.localeObj.getConstant('Save Signature');\n    } else {\n      saveCheckBoxContent = this.pdfViewerBase.isInitialField ? this.pdfViewer.localeObj.getConstant('Save Initial') : this.pdfViewer.localeObj.getConstant('Save Signature');\n    }\n\n    if (!this.pdfViewer.hideSaveSignature) {\n      // eslint-disable-next-line\n      input = document.createElement('input');\n      input.type = 'checkbox';\n      input.id = 'checkbox';\n      appearanceDiv.appendChild(input);\n      checkBoxObj = new CheckBox({\n        label: saveCheckBoxContent,\n        disabled: false,\n        checked: false\n      });\n      checkBoxObj.appendTo(input);\n    }\n\n    this.isSaveSignature = this.saveSignatureCheckbox();\n\n    if (this.isSaveSignature) {\n      checkBoxObj.checked = true;\n    } //if (!this.pdfViewerBase.isToolbarSignClicked) {\n    // eslint-disable-next-line\n\n\n    var typeDiv = createElement('div', {\n      id: this.pdfViewer.element.id + 'type_appearance',\n      className: 'e-pv-signature-apperance',\n      styles: 'margin-top:6px'\n    }); // eslint-disable-next-line\n\n    var inputText = document.createElement('input');\n    inputText.type = 'text';\n    inputText.id = this.pdfViewer.element.id + '_e-pv-Signtext-box';\n    typeDiv.appendChild(inputText); // eslint-disable-next-line\n\n    var inputobj = new TextBox({\n      placeholder: this.pdfViewer.localeObj.getConstant('Enter Signature as Name'),\n      floatLabelType: 'Auto'\n    });\n    inputobj.appendTo(inputText); // eslint-disable-next-line\n\n    var fontDiv = createElement('div', {\n      id: this.pdfViewer.element.id + '_font_appearance',\n      className: 'e-pv-font-appearance-style'\n    });\n    fontDiv.classList.add('e-pv-canvas-signature');\n    fontDiv.style.height = '270px';\n    fontDiv.style.border = '1px dotted #bdbdbd';\n    fontDiv.style.boxSizing = 'border-box';\n    fontDiv.style.borderRadius = '2px';\n    fontDiv.style.backgroundColor = 'white';\n    fontDiv.style.color = 'black';\n    fontDiv.style.marginTop = '8px';\n    typeDiv.appendChild(fontDiv);\n    input = document.createElement('input');\n    input.type = 'checkbox';\n    input.id = 'checkbox1';\n    typeDiv.appendChild(input);\n    checkBoxObj = new CheckBox({\n      label: saveCheckBoxContent,\n      disabled: false,\n      checked: false\n    });\n    checkBoxObj.appendTo(input);\n    inputobj.addEventListener('input', this.renderSignatureText.bind(this));\n    this.enableCreateButton(true); // eslint-disable-next-line\n\n    var tab = createElement('div', {\n      id: this.pdfViewer.element.id + 'Signature_tab'\n    });\n    var uploadDiv = createElement('div', {\n      id: this.pdfViewer.element.id + 'upload_appearance',\n      className: 'e-pv-signature-apperance',\n      styles: 'padding-top:30px'\n    }); // eslint-disable-next-line\n\n    var button = document.createElement('div');\n    button.id = this.pdfViewer.element.id + '_e-pv-upload-button';\n    uploadDiv.appendChild(button); // eslint-disable-next-line\n\n    var uploadButton = new Button({\n      cssClass: 'e-pv-sign-upload',\n      content: this.pdfViewer.localeObj.getConstant('Browse Signature Image')\n    });\n    uploadButton.appendTo(button);\n    uploadButton.element.style.position = 'absolute'; // eslint-disable-next-line max-len\n\n    var uploadCanvas = createElement('canvas', {\n      id: this.pdfViewer.element.id + '_signatureuploadCanvas_',\n      className: 'e-pv-signature-uploadcanvas'\n    });\n\n    if (this.pdfViewer.element.offsetWidth > 750) {\n      uploadCanvas.width = 714;\n    } else {\n      uploadCanvas.width = this.pdfViewer.element.offsetWidth - 35;\n    }\n\n    uploadCanvas.classList.add('e-pv-canvas-signature');\n    uploadCanvas.height = 305;\n    uploadCanvas.style.height = '305px';\n    uploadButton.element.style.left = uploadCanvas.width / 2 - 50 + 'px';\n    uploadButton.element.style.top = parseFloat(uploadCanvas.style.height) / 2 + 20 + 'px';\n    uploadCanvas.style.border = '1px dotted #bdbdbd';\n    uploadCanvas.style.backgroundColor = 'white';\n    uploadCanvas.style.boxSizing = 'border-box';\n    uploadCanvas.style.borderRadius = '2px';\n    uploadCanvas.style.zIndex = '0';\n    uploadDiv.appendChild(uploadCanvas);\n    input = document.createElement('input');\n    input.type = 'checkbox';\n    input.id = 'checkbox2';\n    uploadDiv.appendChild(input);\n    checkBoxObj = new CheckBox({\n      label: saveCheckBoxContent,\n      disabled: false,\n      checked: false\n    });\n    checkBoxObj.appendTo(input);\n    button.addEventListener('click', this.uploadSignatureImage.bind(this)); // eslint-disable-next-line max-len\n\n    this.signfontStyle = [{\n      FontName: 'Helvetica'\n    }, {\n      FontName: 'Times New Roman'\n    }, {\n      FontName: 'Courier'\n    }, {\n      FontName: 'Symbol'\n    }]; // eslint-disable-next-line\n\n    var fontSignature = [];\n\n    if (this.pdfViewerBase.isToolbarSignClicked && !isNullOrUndefined(this.pdfViewer.handWrittenSignatureSettings.typeSignatureFonts)) {\n      for (var j = 0; j < 4; j++) {\n        if (!isNullOrUndefined(this.pdfViewer.handWrittenSignatureSettings.typeSignatureFonts[j])) {\n          this.signfontStyle[j].FontName = this.pdfViewer.handWrittenSignatureSettings.typeSignatureFonts[j];\n        }\n      }\n    }\n\n    for (var i = 0; i < this.signfontStyle.length; i++) {\n      fontSignature[i] = document.createElement('div');\n      fontSignature[i].id = '_font_signature' + i + '';\n      fontSignature[i].classList.add('e-pv-font-sign');\n    }\n\n    this.fontsign = fontSignature; // eslint-disable-next-line\n\n    var proxy = this;\n    var items = [];\n\n    if (this.pdfViewerBase.isToolbarSignClicked) {\n      if (this.pdfViewerBase.isInitialField) {\n        items = this.showHideSignatureTab(this.pdfViewer.handWrittenSignatureSettings.initialDialogSettings.displayMode, appearanceDiv, typeDiv, uploadDiv);\n      } else {\n        items = this.showHideSignatureTab(this.pdfViewer.handWrittenSignatureSettings.signatureDialogSettings.displayMode, appearanceDiv, typeDiv, uploadDiv);\n      }\n    } else {\n      if (this.pdfViewerBase.isInitialField) {\n        items = this.showHideSignatureTab(this.pdfViewer.initialFieldSettings.initialDialogSettings.displayMode, appearanceDiv, typeDiv, uploadDiv);\n      } else {\n        items = this.showHideSignatureTab(this.pdfViewer.signatureFieldSettings.signatureDialogSettings.displayMode, appearanceDiv, typeDiv, uploadDiv);\n      }\n    } // eslint-disable-next-line\n\n\n    this.tabObj = new Tab({\n      selected: function (args) {\n        proxy.handleSelectEvent(args);\n      },\n      selecting: function (args) {\n        proxy.select(args);\n      },\n      items: items\n    });\n    this.tabObj.appendTo(tab);\n\n    if (tab && tab.lastElementChild) {\n      tab.lastElementChild.style.overflow = 'hidden';\n    }\n\n    if (items[0].header.label === 'DRAW') {\n      this.signaturetype = 'Draw';\n    } else if (items[0].header.label === 'TYPE') {\n      this.signaturetype = 'Type';\n    } else {\n      this.signaturetype = 'Image';\n    }\n\n    return tab; // } else {\n    //     return appearanceDiv;\n    // }\n  };\n\n  Signature.prototype.handleSelectEvent = function (e) {\n    // eslint-disable-next-line\n    var headerText = '';\n    var maximumWidth = 750;\n    var tabInstance = document.getElementById(this.pdfViewer.element.id + 'Signature_tab').ej2_instances[0];\n\n    if (tabInstance) {\n      if (tabInstance.items.length > 0) {\n        for (var i = 0; i < tabInstance.items.length; i++) {\n          var headerValue = tabInstance.items[i].header.text;\n\n          if (headerValue === e.selectedItem.textContent) {\n            headerText = tabInstance.items[i].header.label;\n          }\n        }\n      }\n    }\n\n    var checkbox = document.getElementById('checkbox');\n\n    if (checkbox && checkbox.checked) {\n      if (e.previousIndex === 0 && this.outputString !== '') {\n        this.isSaveSignature = true;\n        this.saveSignatureString = this.outputString; // eslint-disable-next-line\n\n        var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n        this.saveImageString = canvas.toDataURL();\n        this.signatureImageString = this.saveImageString;\n      }\n    } else {\n      if (this.isSaveSignature) {\n        this.isSaveSignature = false;\n        this.saveSignatureString = '';\n        this.saveImageString = '';\n        this.signatureImageString = '';\n      }\n    }\n\n    this.clearSignatureCanvas(e); // eslint-disable-next-line\n\n    if (headerText.toLocaleLowerCase() === 'draw') {\n      this.signaturetype = 'Draw';\n      this.enableCreateSignatureButton();\n      var drawCheckbox = document.getElementById(\"checkbox\");\n      this.hideSignatureCheckbox(drawCheckbox);\n    } else if (headerText.toLocaleLowerCase() === 'type') {\n      this.updateSignatureTypeValue();\n      this.signaturetype = 'Type';\n      this.enableCreateSignatureButton();\n      var typeCheckbox = document.getElementById(\"checkbox1\");\n      this.hideSignatureCheckbox(typeCheckbox);\n    } else if (headerText.toLocaleLowerCase() === 'upload') {\n      this.signaturetype = 'Image';\n      this.enableCreateSignatureButton();\n      var imageCheckbox = document.getElementById(\"checkbox2\");\n      this.hideSignatureCheckbox(imageCheckbox);\n    }\n\n    if (this.pdfViewer.element.offsetWidth < maximumWidth) this.updateCanvasSize();\n  };\n\n  Signature.prototype.enableCreateSignatureButton = function () {\n    if (this.outputString !== \"\") {\n      this.enableCreateButton(false);\n    } else {\n      this.enableCreateButton(true);\n    }\n  };\n\n  Signature.prototype.showHideSignatureTab = function (displayMode, appearanceDiv, typeDiv, uploadDiv) {\n    var items = [];\n\n    if (displayMode & DisplayMode.Draw) {\n      items.push({\n        header: {\n          'text': this.pdfViewer.localeObj.getConstant('Draw-hand Signature'),\n          'label': 'DRAW'\n        },\n        content: appearanceDiv\n      });\n    }\n\n    if (displayMode & DisplayMode.Text) {\n      items.push({\n        header: {\n          'text': this.pdfViewer.localeObj.getConstant('Type Signature'),\n          'label': 'TYPE'\n        },\n        content: typeDiv\n      });\n    }\n\n    if (displayMode & DisplayMode.Upload) {\n      items.push({\n        header: {\n          'text': this.pdfViewer.localeObj.getConstant('Upload Signature'),\n          'label': 'UPLOAD'\n        },\n        content: uploadDiv\n      });\n    }\n\n    return items;\n  };\n  /**\n   * @private\n   * @returns {void}\n   */\n\n\n  Signature.prototype.createSignatureFileElement = function () {\n    // eslint-disable-next-line\n    var signImage = createElement('input', {\n      id: this.pdfViewer.element.id + '_signElement',\n      attrs: {\n        'type': 'file'\n      }\n    });\n    signImage.setAttribute('accept', '.jpg,.jpeg,.png');\n    signImage.style.position = 'absolute';\n    signImage.style.left = '0px';\n    signImage.style.top = '0px';\n    signImage.style.visibility = 'hidden';\n    document.body.appendChild(signImage);\n    signImage.addEventListener('change', this.addStampImage);\n  };\n\n  Signature.prototype.uploadSignatureImage = function () {\n    // eslint-disable-next-line\n    var signImage = document.getElementById(this.pdfViewer.element.id + '_signElement');\n\n    if (signImage) {\n      signImage.click();\n    }\n  };\n\n  Signature.prototype.renderSignatureText = function () {\n    var maximumWidth = 750; // eslint-disable-next-line\n\n    var fontDiv = document.getElementById(this.pdfViewer.element.id + '_font_appearance'); // eslint-disable-next-line\n\n    var textBox = document.getElementById(this.pdfViewer.element.id + '_e-pv-Signtext-box');\n\n    for (var i = 0; i < this.signfontStyle.length; i++) {\n      this.fontsign[i].innerHTML = textBox.value;\n      this.fontsign[i].style.fontFamily = this.signfontStyle[i].FontName;\n\n      if (this.signfontStyle[i].FontName === 'Helvetica') {\n        this.fontsign[i].style.borderColor = 'red';\n      }\n\n      fontDiv.appendChild(this.fontsign[i]);\n    }\n\n    for (var i = 0; i < this.signfontStyle.length; i++) {\n      // eslint-disable-next-line\n      var clickSign = document.getElementById('_font_signature' + i + '');\n      clickSign.addEventListener('click', this.typeSignatureclick.bind(this));\n    }\n\n    this.enableCreateButton(false);\n    this.enableClearbutton(false);\n    if (this.pdfViewer.element.offsetWidth < maximumWidth) this.updateCanvasSize();\n  };\n\n  Signature.prototype.typeSignatureclick = function () {\n    var eventTarget = event.target; // eslint-disable-next-line\n\n    var createButton = document.getElementsByClassName('e-pv-createbtn')[0];\n    createButton.disabled = false;\n\n    for (var i = 0; i < 4; i++) {\n      // eslint-disable-next-line\n      var fontElement = document.getElementById('_font_signature' + i + '');\n\n      if (fontElement) {\n        fontElement.style.borderColor = '';\n      }\n    }\n\n    eventTarget.style.borderColor = 'red';\n    this.outputString = eventTarget.textContent;\n\n    try {\n      this.fontName = JSON.parse(eventTarget.style.fontFamily);\n    } catch (e) {\n      this.fontName = eventTarget.style.fontFamily;\n    }\n  };\n  /**\n   * @param bounds\n   * @param position\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  Signature.prototype.addSignatureCollection = function (bounds, position) {\n    var minimumX = -1;\n    var minimumY = -1;\n    var maximumX = -1;\n    var maximumY = -1; // eslint-disable-next-line\n\n    var collectionData = processPathData(this.outputString); // eslint-disable-next-line\n\n    var newCanvas = document.createElement('canvas'); // eslint-disable-next-line\n\n    var context = newCanvas.getContext('2d'); // eslint-disable-next-line\n\n    var imageString;\n    var signatureType = this.pdfViewerBase.currentSignatureAnnot.shapeAnnotationType;\n\n    if (signatureType === 'HandWrittenSignature') {\n      if (collectionData.length !== 0) {\n        // eslint-disable-next-line\n        for (var k = 0; k < collectionData.length; k++) {\n          // eslint-disable-next-line\n          var val = collectionData[k];\n\n          if (minimumX === -1) {\n            // eslint-disable-next-line\n            minimumX = val['x']; // eslint-disable-next-line\n\n            maximumX = val['x']; // eslint-disable-next-line\n\n            minimumY = val['y']; // eslint-disable-next-line\n\n            maximumY = val['y'];\n          } else {\n            // eslint-disable-next-line\n            var point1 = val['x']; // eslint-disable-next-line\n\n            var point2 = val['y'];\n\n            if (minimumX >= point1) {\n              minimumX = point1;\n            }\n\n            if (minimumY >= point2) {\n              minimumY = point2;\n            }\n\n            if (maximumX <= point1) {\n              maximumX = point1;\n            }\n\n            if (maximumY <= point2) {\n              maximumY = point2;\n            }\n          }\n        }\n\n        var newdifferenceX = maximumX - minimumX;\n        var newdifferenceY = maximumY - minimumY;\n        var differenceX = newdifferenceX / 100;\n        var differenceY = newdifferenceY / 100;\n        var left = 0;\n        var top_1 = 0;\n\n        if (bounds) {\n          newCanvas.width = position.currentWidth;\n          newCanvas.height = position.currentHeight;\n          differenceX = newdifferenceX / bounds.width;\n          differenceY = newdifferenceY / bounds.height;\n          left = bounds.x - position.currentLeft;\n          top_1 = bounds.y - position.currentTop;\n        } else {\n          newCanvas.width = 100;\n          newCanvas.height = 100;\n        }\n\n        context.beginPath();\n\n        for (var n = 0; n < collectionData.length; n++) {\n          // eslint-disable-next-line\n          var val = collectionData[n]; // eslint-disable-next-line\n\n          var point1 = (val['x'] - minimumX) / differenceX + left; // eslint-disable-next-line\n\n          var point2 = (val['y'] - minimumY) / differenceY + top_1; // eslint-disable-next-line\n\n          if (val['command'] === 'M') {\n            context.moveTo(point1, point2); // eslint-disable-next-line\n          } else if (val['command'] === 'L') {\n            context.lineTo(point1, point2);\n          }\n        }\n\n        context.stroke();\n        context.closePath();\n        imageString = newCanvas.toDataURL();\n      }\n    } else if (signatureType === 'SignatureText') {\n      imageString = this.outputString;\n    } else {\n      imageString = this.outputString;\n    }\n\n    if (bounds) {\n      this.saveImageString = imageString;\n    } else {\n      // eslint-disable-next-line\n      var signCollection = {};\n      signCollection['sign_' + this.pdfViewerBase.imageCount] = this.outputString;\n      this.outputcollection.push(signCollection); // eslint-disable-next-line\n\n      var signature = [];\n      signature.push({\n        id: 'sign_' + this.pdfViewerBase.imageCount,\n        imageData: imageString,\n        signatureType: signatureType,\n        fontFamily: this.pdfViewerBase.currentSignatureAnnot.fontFamily\n      });\n      this.signaturecollection.push({\n        image: signature,\n        isInitial: this.pdfViewerBase.isInitialField\n      });\n      this.pdfViewerBase.imageCount++;\n    }\n  };\n  /**\n   * @private]\n   * @param {number} limit - The limit.\n   * @returns {number} - Returns number.\n   */\n\n\n  Signature.prototype.getSaveLimit = function (limit) {\n    if (limit > this.maxSaveLimit) {\n      limit = this.maxSaveLimit;\n    } else if (limit < 1) {\n      limit = 1;\n    }\n\n    return limit;\n  };\n  /**\n   * @private\n   * @returns {void}\n   */\n\n\n  Signature.prototype.RenderSavedSignature = function () {\n    this.pdfViewerBase.signatureCount++;\n    var zoomvalue = this.pdfViewerBase.getZoomFactor();\n    var annot;\n\n    if (this.pdfViewerBase.isAddedSignClicked) {\n      var annotationName = this.pdfViewer.annotation.createGUID();\n      this.pdfViewerBase.currentSignatureAnnot = null;\n      this.pdfViewerBase.isSignatureAdded = true;\n      var pageIndex = this.pdfViewerBase.currentPageNumber - 1;\n      var pageDiv = document.getElementById(this.pdfViewer.element.id + '_pageDiv_' + pageIndex);\n      var currentLeft = 0;\n      var currentTop = 0; // eslint-disable-next-line max-len\n\n      var currentWidth = this.pdfViewer.handWrittenSignatureSettings.width ? this.pdfViewer.handWrittenSignatureSettings.width : 100; // eslint-disable-next-line max-len\n\n      var currentHeight = this.pdfViewer.handWrittenSignatureSettings.height ? this.pdfViewer.handWrittenSignatureSettings.height : 100; // eslint-disable-next-line max-len\n\n      var thickness = this.pdfViewer.handWrittenSignatureSettings.thickness ? this.pdfViewer.handWrittenSignatureSettings.thickness : 1; // eslint-disable-next-line max-len\n\n      var opacity = this.pdfViewer.handWrittenSignatureSettings.opacity ? this.pdfViewer.handWrittenSignatureSettings.opacity : 1; // eslint-disable-next-line max-len\n\n      var strokeColor = this.pdfViewer.handWrittenSignatureSettings.strokeColor ? this.pdfViewer.handWrittenSignatureSettings.strokeColor : '#000000';\n      currentLeft = (parseFloat(pageDiv.style.width) / 2 - currentWidth / 2) / zoomvalue; // eslint-disable-next-line max-len\n\n      currentTop = (parseFloat(pageDiv.style.height) / 2 - currentHeight / 2) / zoomvalue;\n      var keyString = '';\n      var signatureType = void 0;\n      var signatureFontFamily = void 0;\n\n      for (var collection = 0; collection < this.outputcollection.length; collection++) {\n        // eslint-disable-next-line\n        var collectionAddedsign = this.outputcollection[collection]; // eslint-disable-next-line\n\n        var eventTarget = event.target; // eslint-disable-next-line max-len\n\n        if (eventTarget && eventTarget.id === 'sign_' + collection || eventTarget && eventTarget.id === 'sign_border' + collection) {\n          keyString = collectionAddedsign['sign_' + collection];\n          break;\n        }\n      }\n\n      for (var signatureIndex = 0; signatureIndex < this.signaturecollection.length; signatureIndex++) {\n        var eventTarget = event.target;\n        var signatureId = this.signaturecollection[signatureIndex].image[0].id.split('_')[1];\n\n        if (eventTarget && eventTarget.id === 'sign_' + signatureId || eventTarget && eventTarget.id === 'sign_border' + signatureId) {\n          signatureType = this.signaturecollection[signatureIndex].image[0].signatureType;\n          signatureFontFamily = this.signaturecollection[signatureIndex].image[0].fontFamily;\n          break;\n        }\n      }\n\n      if (signatureType === 'HandWrittenSignature') {\n        // eslint-disable-next-line\n        var signatureBounds = this.pdfViewer.formFieldsModule.updateSignatureAspectRatio(keyString, true); // eslint-disable-next-line max-len\n\n        currentWidth = signatureBounds.width ? signatureBounds.width : currentWidth; // eslint-disable-next-line max-len\n\n        currentHeight = signatureBounds.height ? signatureBounds.height : currentHeight;\n      } else {\n        currentWidth = currentWidth === 150 ? 200 : this.pdfViewer.handWrittenSignatureSettings.width; // eslint-disable-next-line max-len\n\n        currentHeight = currentHeight === 100 ? 65 : this.pdfViewer.handWrittenSignatureSettings.height;\n      }\n\n      annot = {\n        // eslint-disable-next-line max-len\n        id: 'sign' + this.pdfViewerBase.signatureCount,\n        bounds: {\n          x: currentLeft,\n          y: currentTop,\n          width: currentWidth,\n          height: currentHeight\n        },\n        pageIndex: pageIndex,\n        data: keyString,\n        // eslint-disable-next-line max-len\n        shapeAnnotationType: signatureType,\n        opacity: opacity,\n        fontFamily: signatureFontFamily,\n        strokeColor: strokeColor,\n        thickness: thickness,\n        signatureName: annotationName\n      };\n      this.pdfViewerBase.currentSignatureAnnot = annot;\n      this.pdfViewerBase.isAddedSignClicked = false;\n    } else {\n      this.pdfViewer.formFieldsModule.drawSignature();\n    }\n  };\n  /**\n   * @private\n   * @returns {void}\n   */\n\n\n  Signature.prototype.updateCanvasSize = function () {\n    // eslint-disable-next-line\n    var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n    this.setTabItemWidth(canvas);\n    var uploadCanvas = document.getElementById(this.pdfViewer.element.id + '_signatureuploadCanvas_');\n    this.setTabItemWidth(uploadCanvas);\n    var fontAppearance = document.getElementById(this.pdfViewer.element.id + '_font_appearance');\n    this.setTabItemWidth(fontAppearance);\n  };\n\n  Signature.prototype.setTabItemWidth = function (canvas) {\n    var padding = 2;\n    var maximumWidth = 750;\n    var canvasWidth = 714;\n    var margin = 50;\n    var elem = document.querySelector('.e-dlg-content');\n\n    if (elem) {\n      var style = getComputedStyle(elem);\n      padding = padding + parseInt(style.paddingLeft, 10) + parseInt(style.paddingRight, 10);\n    }\n\n    if (canvas && this.signatureDialog && this.signatureDialog.visible) {\n      if (this.pdfViewer.element.offsetWidth > maximumWidth) {\n        canvas.width = canvasWidth;\n        canvas.style.width = canvasWidth + 'px';\n      } else {\n        canvas.width = this.pdfViewer.element.offsetWidth - padding;\n        canvas.style.width = canvas.width + 'px';\n      }\n    }\n\n    var fontInnerDiv = document.getElementsByClassName('e-pv-font-sign');\n\n    if (canvas && fontInnerDiv && fontInnerDiv.length > 0) {\n      for (var i = 0; i < fontInnerDiv.length; i++) {\n        var fontDiv = fontInnerDiv[i];\n        fontDiv.style.width = canvas.width / 2 - margin + 'px';\n      }\n    }\n  };\n\n  Signature.prototype.signaturePanelMouseDown = function (e) {\n    if (e.type !== 'contextmenu') {\n      e.preventDefault();\n      this.findMousePosition(e);\n      this.mouseDetection = true;\n      this.oldX = this.mouseX;\n      this.oldY = this.mouseY;\n      this.newObject = [];\n      this.drawMousePosition(e);\n      this.mouseMoving = true;\n    }\n  };\n\n  Signature.prototype.enableCreateButton = function (isEnable) {\n    // eslint-disable-next-line\n    var createbtn = document.getElementsByClassName('e-pv-createbtn')[0];\n\n    if (createbtn) {\n      createbtn.disabled = isEnable;\n    }\n\n    this.enableClearbutton(isEnable);\n  };\n\n  Signature.prototype.enableClearbutton = function (isEnable) {\n    // eslint-disable-next-line\n    var clearbtn = document.getElementsByClassName('e-pv-clearbtn')[0];\n\n    if (clearbtn) {\n      clearbtn.disabled = isEnable;\n    }\n  };\n\n  Signature.prototype.signaturePanelMouseMove = function (e) {\n    if (this.mouseDetection && this.signaturetype === 'Draw') {\n      this.findMousePosition(e);\n      this.enableCreateButton(false);\n      this.drawMousePosition(e);\n    }\n  };\n\n  Signature.prototype.findMousePosition = function (event) {\n    var offsetX;\n    var offsetY;\n\n    if (event.type.indexOf('touch') !== -1) {\n      event = event;\n      var element = event.target; // eslint-disable-next-line\n\n      var currentRect = element.getBoundingClientRect();\n      this.mouseX = event.touches[0].pageX - currentRect.left;\n      this.mouseY = event.touches[0].pageY - currentRect.top;\n    } else {\n      event = event;\n      this.mouseX = event.offsetX;\n      this.mouseY = event.offsetY;\n    }\n  };\n\n  Signature.prototype.drawMousePosition = function (event) {\n    if (this.mouseDetection) {\n      this.drawSignatureInCanvas();\n      this.oldX = this.mouseX;\n      this.oldY = this.mouseY;\n    }\n  };\n\n  Signature.prototype.drawSignatureInCanvas = function () {\n    // eslint-disable-next-line\n    var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_'); // eslint-disable-next-line\n\n    var context = canvas.getContext('2d');\n    context.beginPath();\n    context.moveTo(this.oldX, this.oldY);\n    context.lineTo(this.mouseX, this.mouseY);\n    context.stroke();\n    context.lineWidth = 2;\n    context.arc(this.oldX, this.oldY, 2 / 2, 0, Math.PI * 2, true);\n    context.closePath();\n    this.newObject.push(this.mouseX, this.mouseY);\n  };\n\n  Signature.prototype.signaturePanelMouseUp = function () {\n    if (this.mouseDetection) {\n      this.convertToPath(this.newObject);\n    }\n\n    this.mouseDetection = false;\n\n    if (event.type == 'touchend') {\n      this.canvasTouched = true;\n    }\n  };\n\n  Signature.prototype.signaturePanelMouseLeave = function () {\n    if (this.mouseDetection) {\n      this.convertToPath(this.newObject);\n    }\n\n    this.mouseDetection = false;\n    this.mouseMoving = false;\n  };\n\n  ; // eslint-disable-next-line\n\n  Signature.prototype.convertToPath = function (newObject) {\n    this.movePath(newObject[0], newObject[1]);\n    this.linePath(newObject[0], newObject[1]);\n\n    for (var n = 2; n < newObject.length; n = n + 2) {\n      this.linePath(newObject[n], newObject[n + 1]);\n    }\n  };\n\n  Signature.prototype.linePath = function (x, y) {\n    this.outputString += 'L' + x + ',' + y + ' ';\n  };\n\n  Signature.prototype.movePath = function (x, y) {\n    this.outputString += 'M' + x + ',' + y + ' ';\n  };\n  /**\n   * @private\n   * @returns {void}\n   */\n\n\n  Signature.prototype.clearSignatureCanvas = function (type) {\n    var isCanvasClear = true;\n    var drawObject = [];\n\n    if (type && !isNullOrUndefined(type.previousIndex) && !isNullOrUndefined(type.selectedIndex)) {\n      isCanvasClear = false;\n\n      if (type.previousIndex === 0) {\n        this.drawOutputString = this.outputString;\n        drawObject = this.newObject;\n      } else if (type.previousIndex === 2) {\n        this.imageOutputString = this.outputString;\n      }\n\n      this.outputString = '';\n      this.newObject = [];\n\n      if (type.selectedIndex === 0) {\n        this.outputString = this.drawOutputString;\n        this.newObject = drawObject;\n      } else if (type.selectedIndex === 2) {\n        this.outputString = this.imageOutputString;\n      }\n    } else {\n      this.outputString = '';\n      this.newObject = [];\n    }\n\n    var isClearDrawTab = false;\n    var isClearTypeTab = false;\n    var isClearImageTab = false;\n\n    if (type && type.currentTarget && type.currentTarget.classList.contains(\"e-pv-clearbtn\")) {\n      isCanvasClear = false;\n\n      if (this.signaturetype === 'Draw') {\n        isClearDrawTab = true;\n      } else if (this.signaturetype === 'Type') {\n        isClearTypeTab = true;\n      } else {\n        isClearImageTab = true;\n      }\n    } // eslint-disable-next-line\n\n\n    var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_'); // eslint-disable-next-line\n\n    if (canvas && isCanvasClear || isClearDrawTab) {\n      // eslint-disable-next-line\n      var context = canvas.getContext('2d');\n      context.clearRect(0, 0, canvas.width, canvas.height);\n    } // eslint-disable-next-line\n\n\n    var imageCanvas = document.getElementById(this.pdfViewer.element.id + '_signatureuploadCanvas_');\n\n    if (imageCanvas && isCanvasClear || isClearImageTab) {\n      // eslint-disable-next-line\n      var context = imageCanvas.getContext('2d');\n      context.clearRect(0, 0, imageCanvas.width, imageCanvas.height); // eslint-disable-next-line\n\n      var signbutton = document.getElementById(this.pdfViewer.element.id + '_e-pv-upload-button');\n\n      if (signbutton) {\n        signbutton.style.visibility = '';\n      }\n    } // eslint-disable-next-line\n\n\n    var fontdiv = document.getElementById(this.pdfViewer.element.id + '_font_appearance'); // eslint-disable-next-line\n\n    var textbox = document.getElementById(this.pdfViewer.element.id + '_e-pv-Signtext-box');\n\n    if (fontdiv && textbox && isCanvasClear || isClearTypeTab) {\n      textbox.value = '';\n\n      if (!isBlazor()) {\n        fontdiv.innerHTML = '';\n      }\n    }\n\n    this.enableCreateButton(true);\n  };\n  /**\n   * @private\n   * @returns {void}\n   */\n\n\n  Signature.prototype.closeSignaturePanel = function () {\n    if (this.pdfViewerBase.currentTarget) {\n      this.pdfViewerBase.drawSignatureWithTool = true;\n    }\n\n    this.clearSignatureCanvas();\n\n    if (!isBlazor()) {\n      this.signatureDialog.hide();\n    }\n\n    this.pdfViewerBase.isToolbarSignClicked = false;\n    this.pdfViewerBase.drawSignatureWithTool = false;\n    this.drawOutputString = '';\n    this.imageOutputString = '';\n  };\n  /**\n   * @private\n   * @returns {string} - Returns the string.\n   */\n\n\n  Signature.prototype.saveSignature = function () {\n    // eslint-disable-next-line\n    var storeObject = null;\n\n    if (this.pdfViewerBase.isStorageExceed) {\n      storeObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_sign'];\n    } else {\n      storeObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_sign');\n    } // eslint-disable-next-line\n\n\n    var annotations = new Array();\n\n    for (var j = 0; j < this.pdfViewerBase.pageCount; j++) {\n      annotations[j] = [];\n    }\n\n    if (storeObject) {\n      var annotationCollection = JSON.parse(storeObject);\n\n      for (var i = 0; i < annotationCollection.length; i++) {\n        var newArray = [];\n        var pageAnnotationObject = annotationCollection[i];\n\n        if (pageAnnotationObject) {\n          for (var z = 0; pageAnnotationObject.annotations.length > z; z++) {\n            // eslint-disable-next-line max-len\n            var strokeColorString = pageAnnotationObject.annotations[z].strokeColor ? pageAnnotationObject.annotations[z].strokeColor : \"black\";\n            pageAnnotationObject.annotations[z].strokeColor = JSON.stringify(this.getRgbCode(strokeColorString)); // eslint-disable-next-line max-len\n\n            pageAnnotationObject.annotations[z].bounds = JSON.stringify(this.pdfViewer.annotation.getBounds(pageAnnotationObject.annotations[z].bounds, pageAnnotationObject.pageIndex));\n\n            if (pageAnnotationObject.annotations[z].shapeAnnotationType === 'HandWrittenSignature') {\n              // eslint-disable-next-line\n              var collectionData = processPathData(pageAnnotationObject.annotations[z].data); // eslint-disable-next-line\n\n              var csData = splitArrayCollection(collectionData);\n              pageAnnotationObject.annotations[z].data = JSON.stringify(csData);\n            } else {\n              if (pageAnnotationObject.annotations[z].shapeAnnotationType === 'SignatureText' && !this.checkDefaultFont(pageAnnotationObject.annotations[z].fontFamily)) {\n                var signTypeCanvas = createElement('canvas');\n                signTypeCanvas.width = 150;\n                signTypeCanvas.height = pageAnnotationObject.annotations[z].fontSize * 2; // eslint-disable-next-line\n\n                var canvasContext = signTypeCanvas.getContext('2d');\n                var x = signTypeCanvas.width / 2;\n                var y = signTypeCanvas.height / 2 - 10;\n                canvasContext.textAlign = 'center';\n                canvasContext.font = pageAnnotationObject.annotations[z].fontSize + 'px ' + pageAnnotationObject.annotations[z].fontFamily;\n                canvasContext.fillText(pageAnnotationObject.annotations[z].data, x, y);\n                pageAnnotationObject.annotations[z].data = JSON.stringify(signTypeCanvas.toDataURL('image/png'));\n                pageAnnotationObject.annotations[z].shapeAnnotationType = 'SignatureImage';\n              } else {\n                pageAnnotationObject.annotations[z].data = JSON.stringify(pageAnnotationObject.annotations[z].data);\n              }\n            }\n          }\n\n          newArray = pageAnnotationObject.annotations;\n        }\n\n        annotations[pageAnnotationObject.pageIndex] = newArray;\n      }\n    }\n\n    return JSON.stringify(annotations);\n  };\n\n  Signature.prototype.checkDefaultFont = function (fontName) {\n    // eslint-disable-next-line\n    [{\n      FontName: 'Helvetica'\n    }, {\n      FontName: 'Times New Roman'\n    }, {\n      FontName: 'Courier'\n    }, {\n      FontName: 'Symbol'\n    }];\n\n    if (fontName === 'Helvetica' || fontName === 'Times New Roman' || fontName === 'Courier' || fontName === 'Symbol') {\n      return true;\n    }\n\n    return false;\n  };\n  /**\n   * @param colorString\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  Signature.prototype.getRgbCode = function (colorString) {\n    if (!colorString.match(/#([a-z0-9]+)/gi) && !colorString.match(/^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+(?:\\.\\d+)?))?\\)$/)) {\n      colorString = this.pdfViewer.annotationModule.nameToHash(colorString);\n    }\n\n    var stringArray = colorString.split(',');\n\n    if (isNullOrUndefined(stringArray[1])) {\n      colorString = this.pdfViewer.annotationModule.getValue(colorString, 'rgba');\n      stringArray = colorString.split(',');\n    } // eslint-disable-next-line radix\n\n\n    var r = parseInt(stringArray[0].split('(')[1]); // eslint-disable-next-line radix\n\n    var g = parseInt(stringArray[1]); // eslint-disable-next-line radix\n\n    var b = parseInt(stringArray[2]); // eslint-disable-next-line radix\n\n    var a = parseInt(stringArray[3]);\n    return {\n      r: r,\n      g: g,\n      b: b,\n      a: a\n    };\n  };\n  /**\n   * @private\n   * @param {number} left - The left.\n   * @param {number} top - The top.\n   * @returns {void}\n   */\n\n\n  Signature.prototype.renderSignature = function (left, top) {\n    var annot; // eslint-disable-next-line\n\n    var currentAnnotation = this.pdfViewerBase.currentSignatureAnnot;\n    var annotationName = this.pdfViewer.annotation.createGUID();\n\n    if (currentAnnotation) {\n      if (this.pdfViewerBase.currentSignatureAnnot.shapeAnnotationType === 'HandWrittenSignature') {\n        annot = {\n          // eslint-disable-next-line max-len\n          id: currentAnnotation.id,\n          bounds: {\n            x: left,\n            y: top,\n            width: currentAnnotation.bounds.width,\n            height: currentAnnotation.bounds.height\n          },\n          pageIndex: currentAnnotation.pageIndex,\n          data: currentAnnotation.data,\n          shapeAnnotationType: 'HandWrittenSignature',\n          opacity: currentAnnotation.opacity,\n          fontFamily: currentAnnotation.fontFamily,\n          fontSize: currentAnnotation.fontSize,\n          strokeColor: currentAnnotation.strokeColor,\n          thickness: currentAnnotation.thickness,\n          signatureName: annotationName\n        };\n      }\n\n      if (this.pdfViewerBase.currentSignatureAnnot.shapeAnnotationType === 'SignatureText') {\n        annot = {\n          // eslint-disable-next-line max-len\n          id: currentAnnotation.id,\n          bounds: {\n            x: left,\n            y: top,\n            width: currentAnnotation.bounds.width,\n            height: currentAnnotation.bounds.height\n          },\n          pageIndex: currentAnnotation.pageIndex,\n          data: currentAnnotation.data,\n          shapeAnnotationType: 'SignatureText',\n          opacity: currentAnnotation.opacity,\n          fontFamily: currentAnnotation.fontFamily,\n          fontSize: currentAnnotation.fontSize,\n          strokeColor: currentAnnotation.strokeColor,\n          thickness: currentAnnotation.thickness,\n          signatureName: annotationName\n        };\n      } else if (this.pdfViewerBase.currentSignatureAnnot.shapeAnnotationType === 'SignatureImage') {\n        annot = {\n          // eslint-disable-next-line max-len\n          id: currentAnnotation.id,\n          bounds: {\n            x: left,\n            y: top,\n            width: currentAnnotation.bounds.width,\n            height: currentAnnotation.bounds.height\n          },\n          pageIndex: currentAnnotation.pageIndex,\n          data: currentAnnotation.data,\n          shapeAnnotationType: 'SignatureImage',\n          opacity: currentAnnotation.opacity,\n          fontFamily: currentAnnotation.fontFamily,\n          fontSize: currentAnnotation.fontSize,\n          strokeColor: currentAnnotation.strokeColor,\n          thickness: currentAnnotation.thickness,\n          signatureName: annotationName\n        };\n      }\n\n      this.pdfViewer.add(annot); // eslint-disable-next-line\n\n      var canvass = document.getElementById(this.pdfViewer.element.id + '_annotationCanvas_' + currentAnnotation.pageIndex); // eslint-disable-next-line\n\n      this.pdfViewer.renderDrawing(canvass, currentAnnotation.pageIndex);\n      this.pdfViewerBase.signatureAdded = true; // eslint-disable-next-line max-len\n\n      this.storeSignatureData(currentAnnotation.pageIndex, annot);\n      this.pdfViewer.fireSignatureAdd(currentAnnotation.pageIndex, currentAnnotation.signatureName, currentAnnotation.shapeAnnotationType, currentAnnotation.bounds, currentAnnotation.opacity, currentAnnotation.strokeColor, currentAnnotation.thickness);\n      this.pdfViewerBase.currentSignatureAnnot = null;\n      this.pdfViewerBase.signatureCount++;\n    }\n  };\n  /**\n   * @param annotationCollection\n   * @param pageIndex\n   * @param isImport\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  Signature.prototype.renderExistingSignature = function (annotationCollection, pageIndex, isImport) {\n    var annot;\n    var isAnnotationAdded = false;\n\n    if (!isImport) {\n      for (var p = 0; p < this.signAnnotationIndex.length; p++) {\n        if (this.signAnnotationIndex[p] === pageIndex) {\n          isAnnotationAdded = true;\n          break;\n        }\n      }\n    }\n\n    if (annotationCollection && !isAnnotationAdded) {\n      if (annotationCollection.length > 0 && this.signAnnotationIndex.indexOf(pageIndex) === -1) {\n        this.signAnnotationIndex.push(pageIndex);\n      }\n\n      for (var n = 0; n < annotationCollection.length; n++) {\n        // eslint-disable-next-line\n        var currentAnnotation = annotationCollection[n];\n\n        if (currentAnnotation) {\n          // eslint-disable-next-line\n          var data = currentAnnotation.PathData;\n\n          if (isImport) {\n            if (currentAnnotation.IsSignature) {\n              data = currentAnnotation.PathData;\n            } else if (currentAnnotation.AnnotationType === 'SignatureImage' || currentAnnotation.AnnotationType === 'SignatureText') {\n              data = JSON.parse(JSON.stringify(currentAnnotation.PathData));\n            } else {\n              if (data.includes('command')) {\n                data = getPathString(JSON.parse(currentAnnotation.PathData));\n              } else {\n                data = currentAnnotation.PathData;\n              }\n            }\n          }\n\n          this.outputString = data;\n          this.outputString = '';\n          var rectDiff = 0;\n          var rectDifference = 1;\n          var bounds = currentAnnotation.Bounds;\n          var currentLeft = !isNullOrUndefined(bounds.X) ? bounds.X + rectDiff / 2 : bounds.x + rectDiff / 2;\n          var currentTop = !isNullOrUndefined(bounds.Y) ? bounds.Y + rectDiff / 2 : bounds.y + rectDiff / 2;\n          var currentWidth = bounds.Width ? bounds.Width - (rectDifference - 1) : bounds.width - (rectDifference - 1);\n          var currentHeight = bounds.Height ? bounds.Height - (rectDifference - 1) : bounds.height - (rectDifference - 1);\n\n          if (currentAnnotation.AnnotationType === 'SignatureText') {\n            annot = {\n              id: 'sign' + this.pdfViewerBase.signatureCount,\n              bounds: {\n                x: currentLeft,\n                y: currentTop,\n                width: currentWidth,\n                height: currentHeight\n              },\n              pageIndex: pageIndex,\n              data: data,\n              fontFamily: currentAnnotation.FontFamily,\n              fontSize: currentAnnotation.FontSize,\n              shapeAnnotationType: 'SignatureText',\n              opacity: currentAnnotation.Opacity,\n              strokeColor: currentAnnotation.StrokeColor,\n              thickness: currentAnnotation.Thickness,\n              signatureName: currentAnnotation.SignatureName\n            };\n          } else if (currentAnnotation.AnnotationType === 'SignatureImage') {\n            annot = {\n              id: 'sign' + this.pdfViewerBase.signatureCount,\n              bounds: {\n                x: currentLeft,\n                y: currentTop,\n                width: currentWidth,\n                height: currentHeight\n              },\n              pageIndex: pageIndex,\n              data: data,\n              shapeAnnotationType: 'SignatureImage',\n              opacity: currentAnnotation.Opacity,\n              strokeColor: currentAnnotation.StrokeColor,\n              thickness: currentAnnotation.Thickness,\n              signatureName: currentAnnotation.SignatureName\n            };\n          } else {\n            annot = {\n              id: 'sign' + this.pdfViewerBase.signatureCount,\n              bounds: {\n                x: currentLeft,\n                y: currentTop,\n                width: currentWidth,\n                height: currentHeight\n              },\n              pageIndex: pageIndex,\n              data: data,\n              shapeAnnotationType: 'HandWrittenSignature',\n              opacity: currentAnnotation.Opacity,\n              strokeColor: currentAnnotation.StrokeColor,\n              thickness: currentAnnotation.Thickness,\n              signatureName: currentAnnotation.SignatureName\n            };\n          }\n        }\n\n        this.pdfViewer.add(annot); // eslint-disable-next-line\n\n        var canvass = document.getElementById(this.pdfViewer.element.id + '_annotationCanvas_' + currentAnnotation.pageIndex); // eslint-disable-next-line\n\n        this.pdfViewer.renderDrawing(canvass, annot.pageIndex);\n        this.storeSignatureData(annot.pageIndex, annot);\n        this.pdfViewerBase.currentSignatureAnnot = null;\n        this.pdfViewerBase.signatureCount++; // eslint-disable-next-line max-len\n\n        if (this.pdfViewerBase.navigationPane && this.pdfViewerBase.navigationPane.annotationMenuObj && this.pdfViewer.isSignatureEditable) {\n          // eslint-disable-next-line max-len\n          this.pdfViewerBase.navigationPane.annotationMenuObj.enableItems([this.pdfViewer.localeObj.getConstant('Export Annotations')], true); // eslint-disable-next-line max-len\n\n          this.pdfViewerBase.navigationPane.annotationMenuObj.enableItems([this.pdfViewer.localeObj.getConstant('Export XFDF')], true);\n        }\n      }\n    }\n  };\n  /**\n   * @param pageNumber\n   * @param annotations\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  Signature.prototype.storeSignatureData = function (pageNumber, annotations) {\n    // eslint-disable-next-line max-len\n    this.pdfViewer.annotation.addAction(annotations.pageIndex, null, annotations, 'Addition', '', annotations, annotations);\n    var annotation = null;\n    var left = annotations.bounds.left ? annotations.bounds.left : annotations.bounds.x;\n    var top = annotations.bounds.top ? annotations.bounds.top : annotations.bounds.y;\n\n    if (annotations.wrapper && annotations.wrapper.bounds) {\n      left = annotations.wrapper.bounds.left;\n      top = annotations.wrapper.bounds.top;\n    }\n\n    annotation = {\n      // eslint-disable-next-line max-len\n      id: annotations.id,\n      bounds: {\n        left: left,\n        top: top,\n        width: annotations.bounds.width,\n        height: annotations.bounds.height\n      },\n      shapeAnnotationType: annotations.shapeAnnotationType,\n      opacity: annotations.opacity,\n      thickness: annotations.thickness,\n      strokeColor: annotations.strokeColor,\n      pageIndex: annotations.pageIndex,\n      data: annotations.data,\n      fontSize: annotations.fontSize,\n      fontFamily: annotations.fontFamily,\n      signatureName: annotations.signatureName\n    }; // eslint-disable-next-line\n\n    var sessionSize = Math.round(JSON.stringify(window.sessionStorage).length / 1024); // eslint-disable-next-line\n\n    var currentAnnotation = Math.round(JSON.stringify(annotation).length / 1024);\n\n    if (sessionSize + currentAnnotation > 4500) {\n      this.pdfViewerBase.isStorageExceed = true;\n      this.pdfViewer.annotationModule.clearAnnotationStorage();\n    } // eslint-disable-next-line\n\n\n    var storeObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_sign');\n    var index = 0;\n\n    if (!storeObject) {\n      this.storeSignatureCollections(annotation, pageNumber);\n      var shapeAnnotation = {\n        pageIndex: pageNumber,\n        annotations: []\n      };\n      shapeAnnotation.annotations.push(annotation);\n      index = shapeAnnotation.annotations.indexOf(annotation);\n      var annotationCollection = [];\n      annotationCollection.push(shapeAnnotation);\n      var annotationStringified = JSON.stringify(annotationCollection);\n\n      if (this.pdfViewerBase.isStorageExceed) {\n        this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_sign'] = annotationStringified;\n      } else {\n        window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_sign', annotationStringified);\n      }\n    } else {\n      this.storeSignatureCollections(annotation, pageNumber);\n      var annotObject = JSON.parse(storeObject);\n      window.sessionStorage.removeItem(this.pdfViewerBase.documentId + '_annotations_sign');\n      var pageIndex = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageNumber);\n\n      if (annotObject[pageIndex]) {\n        annotObject[pageIndex].annotations.push(annotation);\n        index = annotObject[pageIndex].annotations.indexOf(annotation);\n      } else {\n        var markupAnnotation = {\n          pageIndex: pageNumber,\n          annotations: []\n        };\n        markupAnnotation.annotations.push(annotation);\n        index = markupAnnotation.annotations.indexOf(annotation);\n        annotObject.push(markupAnnotation);\n      }\n\n      var annotationStringified = JSON.stringify(annotObject);\n\n      if (this.pdfViewerBase.isStorageExceed) {\n        this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_sign'] = annotationStringified;\n      } else {\n        window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_sign', annotationStringified);\n      }\n    }\n  };\n  /**\n   * @param property\n   * @param pageNumber\n   * @param annotationBase\n   * @param isSignatureEdited\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  Signature.prototype.modifySignatureCollection = function (property, pageNumber, annotationBase, isSignatureEdited) {\n    this.pdfViewerBase.updateDocumentEditedProperty(true);\n    var currentAnnotObject = null;\n    var pageAnnotations = this.getAnnotations(pageNumber, null);\n\n    if (pageAnnotations != null && annotationBase) {\n      for (var i = 0; i < pageAnnotations.length; i++) {\n        if (annotationBase.id === pageAnnotations[i].id) {\n          if (property === 'bounds') {\n            // eslint-disable-next-line max-len\n            pageAnnotations[i].bounds = {\n              left: annotationBase.wrapper.bounds.left,\n              top: annotationBase.wrapper.bounds.top,\n              width: annotationBase.bounds.width,\n              height: annotationBase.bounds.height\n            };\n            pageAnnotations[i].fontSize = annotationBase.fontSize;\n          } else if (property === 'stroke') {\n            pageAnnotations[i].strokeColor = annotationBase.wrapper.children[0].style.strokeColor;\n          } else if (property === 'opacity') {\n            pageAnnotations[i].opacity = annotationBase.wrapper.children[0].style.opacity;\n          } else if (property === 'thickness') {\n            pageAnnotations[i].thickness = annotationBase.wrapper.children[0].style.strokeWidth;\n          } else if (property === 'delete') {\n            this.updateSignatureCollection(pageAnnotations[i]);\n            currentAnnotObject = pageAnnotations.splice(i, 1)[0];\n            break;\n          }\n\n          if (property && property !== 'delete') {\n            this.storeSignatureCollections(pageAnnotations[i], pageNumber);\n          }\n\n          if (isSignatureEdited) {\n            pageAnnotations[i].opacity = annotationBase.wrapper.children[0].style.opacity;\n            pageAnnotations[i].strokeColor = annotationBase.wrapper.children[0].style.strokeColor;\n            pageAnnotations[i].thickness = annotationBase.wrapper.children[0].style.strokeWidth;\n            this.storeSignatureCollections(pageAnnotations[i], pageNumber);\n            break;\n          }\n        }\n      }\n\n      this.manageAnnotations(pageAnnotations, pageNumber);\n    }\n\n    return currentAnnotObject;\n  };\n  /**\n   * @param annotation\n   * @param pageNumber\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  Signature.prototype.storeSignatureCollections = function (annotation, pageNumber) {\n    // eslint-disable-next-line\n    var collectionDetails = this.checkSignatureCollection(annotation); // eslint-disable-next-line\n\n    var selectAnnotation = cloneObject(annotation);\n    selectAnnotation.annotationId = annotation.signatureName;\n    selectAnnotation.pageNumber = pageNumber;\n    delete selectAnnotation.annotName;\n\n    if (annotation.id) {\n      selectAnnotation.uniqueKey = annotation.id;\n      delete selectAnnotation.id;\n    }\n\n    if (collectionDetails.isExisting) {\n      this.pdfViewer.signatureCollection.splice(collectionDetails.position, 0, selectAnnotation);\n    } else {\n      this.pdfViewer.signatureCollection.push(selectAnnotation);\n    }\n  }; // eslint-disable-next-line\n\n\n  Signature.prototype.checkSignatureCollection = function (signature) {\n    // eslint-disable-next-line\n    var collections = this.pdfViewer.signatureCollection;\n\n    if (collections && signature) {\n      for (var i = 0; i < collections.length; i++) {\n        if (collections[i].annotationId === signature.signatureName) {\n          this.pdfViewer.signatureCollection.splice(i, 1);\n          return {\n            isExisting: true,\n            position: i\n          };\n        }\n      }\n    }\n\n    return {\n      isExisting: false,\n      position: null\n    };\n  };\n  /**\n   * @param signature\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  Signature.prototype.updateSignatureCollection = function (signature) {\n    // eslint-disable-next-line\n    var collections = this.pdfViewer.signatureCollection;\n\n    if (collections && signature) {\n      for (var i = 0; i < collections.length; i++) {\n        if (collections[i].annotationId === signature.signatureName) {\n          this.pdfViewer.signatureCollection.splice(i, 1);\n          break;\n        }\n      }\n    }\n  };\n  /**\n   * @param pageNumber\n   * @param signature\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  Signature.prototype.addInCollection = function (pageNumber, signature) {\n    if (signature) {\n      this.storeSignatureCollections(signature, pageNumber); // eslint-disable-next-line\n\n      var pageSignatures = this.getAnnotations(pageNumber, null);\n\n      if (pageSignatures) {\n        pageSignatures.push(signature);\n      }\n\n      this.manageAnnotations(pageSignatures, pageNumber);\n    }\n  }; // eslint-disable-next-line\n\n\n  Signature.prototype.getAnnotations = function (pageIndex, shapeAnnotations) {\n    // eslint-disable-next-line\n    var annotationCollection; // eslint-disable-next-line\n\n    var storeObject = null;\n\n    if (this.pdfViewerBase.isStorageExceed) {\n      storeObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_sign'];\n    } else {\n      storeObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_sign');\n    }\n\n    if (storeObject) {\n      var annotObject = JSON.parse(storeObject);\n      var index = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageIndex);\n\n      if (annotObject[index]) {\n        annotationCollection = annotObject[index].annotations;\n      } else {\n        annotationCollection = shapeAnnotations;\n      }\n    } else {\n      annotationCollection = shapeAnnotations;\n    }\n\n    return annotationCollection;\n  };\n\n  Signature.prototype.manageAnnotations = function (pageAnnotations, pageNumber) {\n    // eslint-disable-next-line\n    var storeObject = null;\n\n    if (this.pdfViewerBase.isStorageExceed) {\n      storeObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_sign'];\n    } else {\n      storeObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_sign');\n    }\n\n    if (storeObject) {\n      var annotObject = JSON.parse(storeObject);\n      window.sessionStorage.removeItem(this.pdfViewerBase.documentId + '_annotations_sign');\n      var index = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageNumber);\n\n      if (annotObject[index]) {\n        annotObject[index].annotations = pageAnnotations;\n      }\n\n      var annotationStringified = JSON.stringify(annotObject);\n\n      if (this.pdfViewerBase.isStorageExceed) {\n        this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_sign'] = annotationStringified;\n      } else {\n        window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_sign', annotationStringified);\n      }\n    }\n  };\n  /**\n   * @private\n   * @param {boolean} isShow - Returns the true or false.\n   * @returns {void}\n   */\n\n\n  Signature.prototype.showSignatureDialog = function (isShow) {\n    if (isShow) {\n      this.createSignaturePanel();\n    }\n  };\n  /**\n   * @private\n   * @returns {void}\n   */\n\n\n  Signature.prototype.setAnnotationMode = function () {\n    this.pdfViewerBase.isToolbarSignClicked = true;\n    this.showSignatureDialog(true);\n  };\n  /**\n   * @private\n   * @returns {void}\n   */\n\n\n  Signature.prototype.setInitialMode = function () {\n    this.pdfViewerBase.isToolbarSignClicked = true;\n    this.pdfViewerBase.isInitialField = true;\n    this.showSignatureDialog(true);\n  };\n  /**\n   * @param number\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  Signature.prototype.ConvertPointToPixel = function (number) {\n    return number * (96 / 72);\n  };\n  /**\n   * @param signature\n   * @param pageIndex\n   * @param isImport\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  Signature.prototype.updateSignatureCollections = function (signature, pageIndex, isImport) {\n    var annot; // eslint-disable-next-line\n\n    if (signature) {\n      // eslint-disable-next-line\n      var bounds = signature.Bounds;\n      var currentLeft = bounds.X;\n      var currentTop = bounds.Y;\n      var currentWidth = bounds.Width;\n      var currentHeight = bounds.Height; // eslint-disable-next-line\n\n      var data = signature.PathData;\n\n      if (isImport) {\n        data = getPathString(JSON.parse(signature.PathData));\n      }\n\n      annot = {\n        // eslint-disable-next-line max-len\n        id: 'sign' + signature.SignatureName,\n        bounds: {\n          x: currentLeft,\n          y: currentTop,\n          width: currentWidth,\n          height: currentHeight\n        },\n        pageIndex: pageIndex,\n        data: data,\n        shapeAnnotationType: 'HandWrittenSignature',\n        opacity: signature.Opacity,\n        strokeColor: signature.StrokeColor,\n        thickness: signature.Thickness,\n        signatureName: signature.SignatureName\n      };\n      return annot;\n    }\n  };\n  /**\n   * @private\n   * @returns {void}\n   */\n\n\n  Signature.prototype.destroy = function () {\n    window.sessionStorage.removeItem('_annotations_sign'); // eslint-disable-next-line\n\n    var signImage = document.getElementById(this.pdfViewer.element.id + '_signElement');\n\n    if (signImage) {\n      signImage.removeEventListener('change', this.addStampImage);\n      if (signImage.parentElement) signImage.parentElement.removeChild(signImage);\n    }\n\n    if (this.signatureDialog) this.signatureDialog.destroy();\n  };\n\n  return Signature;\n}();\n\nexport { Signature };","map":{"version":3,"names":["createElement","isNullOrUndefined","isBlazor","Dialog","splitArrayCollection","processPathData","getPathString","TextBox","cloneObject","CheckBox","Tab","Button","DisplayMode","Signature","pdfViewer","pdfViewerBase","_this","mouseMoving","canvasTouched","newObject","outputString","drawOutputString","imageOutputString","signaturecollection","outputcollection","signAnnotationIndex","fontsign","signfontStyle","isSaveSignature","isInitialFiledSaveSignature","isSignatureFieldsSaveSignature","saveSignatureString","saveImageString","signatureImageString","maxSaveLimit","select","e","isSwiped","signaturetype","cancel","addStampImage","args","proxy","upoadedFiles","target","files","uploadedFile","type","split","reader","FileReader","onload","canvas","document","getElementById","element","id","context","getContext","image","Image","signbutton","style","visibility","drawImage","width","height","enableCreateButton","src","signatureImageHeight","naturalHeight","signatureImageWidth","naturalWidth","currentTarget","result","readAsDataURL","value","prototype","createSignaturePanel","maximumWidth","elementID","dialogDiv","className","display","pageContainer","appendChild","appearanceTab","createSignatureCanvas","signaturePanelHeader","isToolbarSignClicked","isInitialField","localeObj","getConstant","signatureDialog","content","showCloseIcon","closeOnEscape","isModal","header","cssClass","visible","allowDragging","beforeClose","clearSignatureCanvas","destroy","tabObj","signatureWindow","parentNode","removeChild","parentElement","drawSignatureWithTool","formFieldsModule","fireFocusOutFormField","name","setFocus","buttons","buttonModel","disabled","click","bind","closeSignaturePanel","isPrimary","addSignatureInPage","appendTo","offsetWidth","updateCanvasSize","enableRtl","checkboxItem","ej2_instances","items","label","drawCheckbox","hideSignatureCheckbox","typeCheckbox","imageCheckbox","querySelector","addEventListener","signaturePanelMouseDown","signaturePanelMouseMove","signaturePanelMouseUp","_dotnetInstance","invokeMethodAsync","drawSavedSignature","context_1","image_1","checkbox","checked","enableClearbutton","handWrittenSignatureSettings","initialDialogSettings","hideSaveSignature","hideCheckboxParent","signatureDialogSettings","initialFieldSettings","signatureFieldSettings","saveSignatureCheckbox","saveSignatureImage","toDataURL","addSignature","annot","annotationName","annotation","createGUID","currentSignatureAnnot","isSignatureAdded","pageIndex","currentPageNumber","thickness","opacity","strokeColor","fontSize","fontFamily","signatureBounds","updateSignatureAspectRatio","signatureCount","bounds","data","shapeAnnotationType","signatureName","addSignatureCollection","hideSignaturePanel","imageAddSignature","typeAddSignature","checkSaveFiledSign","drawSignature","initialField","saveSign","zoomvalue","getZoomFactor","pageDiv","currentLeft","currentTop","currentHeight","currentWidth","parseFloat","zoomFactor","signtypevalue","updateSignatureTypeValue","inputValue","left","top","x","y","dynamicText","signatureModule","fontName","standardImageRatio","isType","fontElements","querySelectorAll","j","length","borderColor","textContent","JSON","parse","hide","bindTypeSignatureClickEvent","i","fontElement","typeSignatureclicked","bindDrawSignatureClickEvent","event","eventTarget","previousField","field","remove","appearanceDiv","styles","classList","add","border","backgroundColor","boxSizing","borderRadius","signaturePanelMouseLeave","checkBoxObj","input","saveCheckBoxContent","typeDiv","inputText","inputobj","placeholder","floatLabelType","fontDiv","color","marginTop","renderSignatureText","tab","uploadDiv","button","uploadButton","position","uploadCanvas","zIndex","uploadSignatureImage","FontName","fontSignature","typeSignatureFonts","showHideSignatureTab","displayMode","selected","handleSelectEvent","selecting","lastElementChild","overflow","headerText","tabInstance","headerValue","text","selectedItem","previousIndex","toLocaleLowerCase","enableCreateSignatureButton","Draw","push","Text","Upload","createSignatureFileElement","signImage","attrs","setAttribute","body","textBox","innerHTML","clickSign","typeSignatureclick","createButton","getElementsByClassName","minimumX","minimumY","maximumX","maximumY","collectionData","newCanvas","imageString","signatureType","k","val","point1","point2","newdifferenceX","newdifferenceY","differenceX","differenceY","top_1","beginPath","n","moveTo","lineTo","stroke","closePath","signCollection","imageCount","signature","imageData","isInitial","getSaveLimit","limit","RenderSavedSignature","isAddedSignClicked","keyString","signatureFontFamily","collection","collectionAddedsign","signatureIndex","signatureId","setTabItemWidth","fontAppearance","padding","canvasWidth","margin","elem","getComputedStyle","parseInt","paddingLeft","paddingRight","fontInnerDiv","preventDefault","findMousePosition","mouseDetection","oldX","mouseX","oldY","mouseY","drawMousePosition","isEnable","createbtn","clearbtn","offsetX","offsetY","indexOf","currentRect","getBoundingClientRect","touches","pageX","pageY","drawSignatureInCanvas","lineWidth","arc","Math","PI","convertToPath","movePath","linePath","isCanvasClear","drawObject","selectedIndex","isClearDrawTab","isClearTypeTab","isClearImageTab","contains","clearRect","imageCanvas","fontdiv","textbox","saveSignature","storeObject","isStorageExceed","annotationStorage","documentId","window","sessionStorage","getItem","annotations","Array","pageCount","annotationCollection","newArray","pageAnnotationObject","z","strokeColorString","stringify","getRgbCode","getBounds","csData","checkDefaultFont","signTypeCanvas","canvasContext","textAlign","font","fillText","colorString","match","annotationModule","nameToHash","stringArray","getValue","r","g","b","a","renderSignature","currentAnnotation","canvass","renderDrawing","signatureAdded","storeSignatureData","fireSignatureAdd","renderExistingSignature","isImport","isAnnotationAdded","p","PathData","IsSignature","AnnotationType","includes","rectDiff","rectDifference","Bounds","X","Y","Width","Height","FontFamily","FontSize","Opacity","StrokeColor","Thickness","SignatureName","navigationPane","annotationMenuObj","isSignatureEditable","enableItems","pageNumber","addAction","wrapper","sessionSize","round","clearAnnotationStorage","index","storeSignatureCollections","shapeAnnotation","annotationStringified","setItem","annotObject","removeItem","getPageCollection","markupAnnotation","modifySignatureCollection","property","annotationBase","isSignatureEdited","updateDocumentEditedProperty","currentAnnotObject","pageAnnotations","getAnnotations","children","strokeWidth","updateSignatureCollection","splice","manageAnnotations","collectionDetails","checkSignatureCollection","selectAnnotation","annotationId","annotName","uniqueKey","isExisting","signatureCollection","collections","addInCollection","pageSignatures","shapeAnnotations","showSignatureDialog","isShow","setAnnotationMode","setInitialMode","ConvertPointToPixel","number","updateSignatureCollections","removeEventListener"],"sources":["/home/morgan/Desktop/Projets/ENT4/Jwt-Auth-pdf/react-jwt-auth/react-jwt-auth/node_modules/@syncfusion/ej2-pdfviewer/src/pdfviewer/base/signature.js"],"sourcesContent":["import { createElement, isNullOrUndefined, isBlazor } from '@syncfusion/ej2-base';\nimport { Dialog } from '@syncfusion/ej2-popups';\nimport { splitArrayCollection, processPathData, getPathString } from '@syncfusion/ej2-drawings';\nimport { TextBox } from '@syncfusion/ej2-inputs';\nimport { cloneObject } from '../drawing/drawing-util';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { Tab } from '@syncfusion/ej2-navigations';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { DisplayMode } from './types';\n/**\n * @hidden\n */\nvar Signature = /** @class */ (function () {\n    /**\n     * Initialize the constructor of blazorUIadapater.\n     * @private\n     * @param { PdfViewer } pdfViewer - Specified PdfViewer class.\n     * @param { PdfViewerBase } pdfViewerBase - The pdfViewerBase.\n     */\n    function Signature(pdfViewer, pdfViewerBase) {\n        var _this = this;\n        this.mouseMoving = true;\n        this.canvasTouched = false;\n        // eslint-disable-next-line\n        this.newObject = [];\n        /**\n         * @private\n         */\n        this.outputString = '';\n        /**\n         * @private\n         */\n        this.drawOutputString = '';\n        /**\n        * @private\n        */\n        this.imageOutputString = '';\n        /**\n         * @private\n         */\n        // eslint-disable-next-line\n        this.signaturecollection = [];\n        /**\n         * @private\n         */\n        // eslint-disable-next-line\n        this.outputcollection = [];\n        /**\n         * @private\n         */\n        // eslint-disable-next-line\n        this.signAnnotationIndex = [];\n        // eslint-disable-next-line\n        this.fontsign = [];\n        // eslint-disable-next-line\n        this.signfontStyle = [];\n        this.isSaveSignature = false;\n        this.isInitialFiledSaveSignature = false;\n        this.isSignatureFieldsSaveSignature = false;\n        // eslint-disable-next-line\n        this.saveSignatureString = '';\n        /**\n         * @private\n         */\n        // eslint-disable-next-line\n        this.saveImageString = '';\n        this.signatureImageString = '';\n        /**\n         * @private\n         */\n        // eslint-disable-next-line\n        this.maxSaveLimit = 5;\n        this.select = function (e) {\n            if (this.canvasTouched) {\n                this.mouseMoving = true;\n                this.canvasTouched = false;\n            }\n            if (e.isSwiped && this.signaturetype == 'Draw' && this.mouseMoving) {\n                e.cancel = true;\n                this.mouseMoving = false;\n            }\n        };\n        // eslint-disable-next-line\n        this.addStampImage = function (args) {\n            // eslint-disable-next-line\n            var proxy = _this;\n            // eslint-disable-next-line\n            var upoadedFiles = args.target.files;\n            if (args.target.files[0] !== null) {\n                var uploadedFile = upoadedFiles[0];\n                if (uploadedFile.type.split('/')[0] === 'image') {\n                    var reader = new FileReader();\n                    // eslint-disable-next-line\n                    reader.onload = function (e) {\n                        // eslint-disable-next-line\n                        var canvas = document.getElementById(_this.pdfViewer.element.id + '_signatureuploadCanvas_');\n                        // eslint-disable-next-line\n                        var context = canvas.getContext('2d');\n                        // eslint-disable-next-line\n                        var image = new Image();\n                        // eslint-disable-next-line\n                        var proxy = _this;\n                        image.onload = function () {\n                            // eslint-disable-next-line\n                            var signbutton = document.getElementById(_this.pdfViewer.element.id + '_e-pv-upload-button');\n                            signbutton.style.visibility = 'hidden';\n                            context.drawImage(image, 0, 0, canvas.width, canvas.height);\n                            proxy.enableCreateButton(false);\n                            proxy.outputString = image.src;\n                            proxy.signatureImageHeight = image.naturalHeight;\n                            proxy.signatureImageWidth = image.naturalWidth;\n                        };\n                        image.src = e.currentTarget.result;\n                        proxy.outputString = e.currentTarget.result;\n                    };\n                    reader.readAsDataURL(uploadedFile);\n                }\n            }\n            args.target.value = '';\n            args.currentTarget.value = '';\n        };\n        this.pdfViewer = pdfViewer;\n        this.pdfViewerBase = pdfViewerBase;\n    }\n    /**\n     * @private\n     * @returns {void}\n     */\n    Signature.prototype.createSignaturePanel = function () {\n        var _this = this;\n        var maximumWidth = 750;\n        if (!isBlazor()) {\n            var elementID = this.pdfViewer.element.id;\n            var dialogDiv = createElement('div', { id: elementID + '_signature_window', className: 'e-pv-signature-window' });\n            dialogDiv.style.display = 'block';\n            this.pdfViewerBase.pageContainer.appendChild(dialogDiv);\n            var appearanceTab = this.createSignatureCanvas();\n            var signaturePanelHeader = void 0;\n            if (!this.pdfViewerBase.isToolbarSignClicked) {\n                if (this.pdfViewerBase.isInitialField) {\n                    signaturePanelHeader = this.pdfViewer.localeObj.getConstant('HandwrittenInitialDialogHeaderText');\n                }\n                else {\n                    signaturePanelHeader = this.pdfViewer.localeObj.getConstant('HandwrittenSignatureDialogHeaderText');\n                }\n            }\n            else {\n                if (this.pdfViewerBase.isInitialField) {\n                    signaturePanelHeader = this.pdfViewer.localeObj.getConstant('InitialFieldDialogHeaderText');\n                }\n                else {\n                    signaturePanelHeader = this.pdfViewer.localeObj.getConstant('SignatureFieldDialogHeaderText');\n                }\n            }\n            if (this.signatureDialog) {\n                this.signatureDialog.content = appearanceTab;\n            }\n            else {\n                this.signatureDialog = new Dialog({\n                    // eslint-disable-next-line max-len\n                    showCloseIcon: true, closeOnEscape: false, isModal: true, header: signaturePanelHeader, cssClass: 'e-pv-signature-dialog-height',\n                    target: this.pdfViewer.element, content: appearanceTab, width: '750px', visible: true, allowDragging: true,\n                    beforeClose: function () {\n                        _this.clearSignatureCanvas();\n                        _this.signatureDialog.destroy();\n                        _this.signatureDialog = null;\n                        if (_this.tabObj) {\n                            _this.tabObj.destroy();\n                        }\n                        // eslint-disable-next-line\n                        var signatureWindow = document.getElementById(_this.pdfViewer.element.id + '_signature_window');\n                        if (signatureWindow) {\n                            // eslint-disable-next-line\n                            signatureWindow.parentNode ? signatureWindow.parentNode.removeChild(signatureWindow) : signatureWindow.parentElement.removeChild(signatureWindow);\n                        }\n                        // eslint-disable-next-line max-len\n                        if (!_this.pdfViewerBase.isToolbarSignClicked && !_this.pdfViewerBase.drawSignatureWithTool && !isNullOrUndefined(_this.pdfViewer.formFieldsModule.currentTarget)) {\n                            _this.pdfViewer.fireFocusOutFormField(_this.pdfViewer.formFieldsModule.currentTarget.name, '');\n                        }\n                        _this.pdfViewerBase.isToolbarSignClicked = false;\n                        _this.pdfViewer.formFieldsModule.setFocus();\n                    }\n                });\n                this.signatureDialog.buttons = [\n                    // eslint-disable-next-line max-len\n                    { buttonModel: { content: this.pdfViewer.localeObj.getConstant('Clear'), disabled: true, cssClass: 'e-pv-clearbtn' }, click: this.clearSignatureCanvas.bind(this) },\n                    // eslint-disable-next-line max-len\n                    { buttonModel: { content: this.pdfViewer.localeObj.getConstant('Cancel') }, click: this.closeSignaturePanel.bind(this) },\n                    // eslint-disable-next-line max-len\n                    { buttonModel: { content: this.pdfViewer.localeObj.getConstant('Create'), isPrimary: true, disabled: true, cssClass: 'e-pv-createbtn' }, click: this.addSignatureInPage.bind(this) }\n                ];\n                this.signatureDialog.appendTo(dialogDiv);\n            }\n            if (this.pdfViewer.element.offsetWidth < maximumWidth)\n                this.updateCanvasSize();\n            if (this.pdfViewer.enableRtl) {\n                this.signatureDialog.enableRtl = this.pdfViewer.enableRtl;\n            }\n            var checkboxItem = this.signatureDialog.content.ej2_instances[0].items[0];\n            if (checkboxItem.header.label === 'DRAW') {\n                var drawCheckbox = document.getElementById(\"checkbox\");\n                this.hideSignatureCheckbox(drawCheckbox);\n            }\n            else if (checkboxItem.header.label === 'TYPE') {\n                var typeCheckbox = document.getElementById(\"checkbox1\");\n                this.hideSignatureCheckbox(typeCheckbox);\n            }\n            else {\n                var imageCheckbox = document.getElementById(\"checkbox2\");\n                this.hideSignatureCheckbox(imageCheckbox);\n            }\n        }\n        else {\n            // eslint-disable-next-line\n            var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n            if (canvas) {\n                if (!this.pdfViewerBase.pageContainer.querySelector('.e-pv-signature-window')) {\n                    var elementID = this.pdfViewer.element.id;\n                    // eslint-disable-next-line max-len\n                    var dialogDiv = createElement('div', { id: elementID + '_signature_window', className: 'e-pv-signature-window' });\n                    dialogDiv.style.display = 'block';\n                    this.pdfViewerBase.pageContainer.appendChild(dialogDiv);\n                }\n                canvas.addEventListener('mousedown', this.signaturePanelMouseDown.bind(this));\n                canvas.addEventListener('mousemove', this.signaturePanelMouseMove.bind(this));\n                canvas.addEventListener('mouseup', this.signaturePanelMouseUp.bind(this));\n                canvas.addEventListener('mouseleave', this.signaturePanelMouseUp.bind(this));\n                canvas.addEventListener('touchstart', this.signaturePanelMouseDown.bind(this));\n                canvas.addEventListener('touchmove', this.signaturePanelMouseMove.bind(this));\n                canvas.addEventListener('touchend', this.signaturePanelMouseUp.bind(this));\n                this.clearSignatureCanvas();\n            }\n            this.pdfViewer._dotnetInstance.invokeMethodAsync('OpenSignaturePanel', this.pdfViewerBase.isToolbarSignClicked);\n        }\n        this.drawSavedSignature();\n    };\n    Signature.prototype.drawSavedSignature = function () {\n        if (!this.pdfViewerBase.isToolbarSignClicked && this.isSaveSignature) {\n            this.outputString = this.saveSignatureString;\n            // eslint-disable-next-line\n            var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n            // eslint-disable-next-line\n            var context_1 = canvas.getContext('2d');\n            // eslint-disable-next-line\n            var image_1 = new Image();\n            image_1.onload = function () {\n                context_1.drawImage(image_1, 0, 0);\n            };\n            image_1.src = this.signatureImageString;\n            // eslint-disable-next-line\n            var checkbox = document.getElementById(this.pdfViewer.element.id + '_signatureCheckBox');\n            if (checkbox) {\n                checkbox.checked = true;\n            }\n            this.enableCreateButton(false);\n            this.enableClearbutton(false);\n        }\n    };\n    Signature.prototype.hideSignatureCheckbox = function (checkbox) {\n        if (this.pdfViewerBase.isToolbarSignClicked) {\n            if (this.pdfViewerBase.isInitialField) {\n                if (this.pdfViewer.handWrittenSignatureSettings.initialDialogSettings.hideSaveSignature) {\n                    this.hideCheckboxParent(checkbox);\n                }\n            }\n            else if (this.pdfViewer.handWrittenSignatureSettings.signatureDialogSettings.hideSaveSignature) {\n                this.hideCheckboxParent(checkbox);\n            }\n        }\n        else {\n            if (this.pdfViewerBase.isInitialField) {\n                if (this.pdfViewer.initialFieldSettings.initialDialogSettings.hideSaveSignature) {\n                    this.hideCheckboxParent(checkbox);\n                }\n            }\n            else {\n                if (this.pdfViewer.signatureFieldSettings.signatureDialogSettings.hideSaveSignature) {\n                    this.hideCheckboxParent(checkbox);\n                }\n            }\n        }\n    };\n    Signature.prototype.saveSignatureCheckbox = function () {\n        if (this.pdfViewerBase.isToolbarSignClicked) {\n            return false;\n        }\n        else {\n            if (this.pdfViewerBase.isInitialField) {\n                if (this.pdfViewer.initialFieldSettings.initialDialogSettings.hideSaveSignature) {\n                    return false;\n                }\n                else {\n                    return this.isInitialFiledSaveSignature;\n                }\n            }\n            else {\n                if (this.pdfViewer.signatureFieldSettings.signatureDialogSettings.hideSaveSignature) {\n                    return false;\n                }\n                else {\n                    return this.isSignatureFieldsSaveSignature;\n                }\n            }\n        }\n    };\n    Signature.prototype.hideCheckboxParent = function (checkbox) {\n        if (checkbox) {\n            checkbox.parentElement.style.display = 'none';\n        }\n    };\n    Signature.prototype.saveSignatureImage = function () {\n        // eslint-disable-next-line\n        var checkbox = document.getElementById(this.pdfViewer.element.id + '_signatureCheckBox');\n        if (checkbox && checkbox.checked) {\n            if (this.outputString !== '') {\n                this.isSaveSignature = true;\n                this.saveSignatureString = this.outputString;\n                // eslint-disable-next-line\n                var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n                this.saveImageString = canvas.toDataURL();\n                this.signatureImageString = this.saveImageString;\n            }\n        }\n        else {\n            if (this.isSaveSignature) {\n                this.isSaveSignature = false;\n                this.saveSignatureString = '';\n                this.saveImageString = '';\n                this.signatureImageString = '';\n            }\n            this.clearSignatureCanvas();\n        }\n    };\n    /**\n     * @param type\n     * @private\n     */\n    // eslint-disable-next-line\n    Signature.prototype.addSignature = function (type) {\n        var annot;\n        if (this.pdfViewerBase.isToolbarSignClicked) {\n            var annotationName = this.pdfViewer.annotation.createGUID();\n            this.pdfViewerBase.currentSignatureAnnot = null;\n            this.pdfViewerBase.isSignatureAdded = true;\n            var pageIndex = this.pdfViewerBase.currentPageNumber - 1;\n            // eslint-disable-next-line max-len\n            var thickness = this.pdfViewer.handWrittenSignatureSettings.thickness ? this.pdfViewer.handWrittenSignatureSettings.thickness : 1;\n            // eslint-disable-next-line max-len\n            var opacity = this.pdfViewer.handWrittenSignatureSettings.opacity ? this.pdfViewer.handWrittenSignatureSettings.opacity : 1;\n            // eslint-disable-next-line max-len\n            var strokeColor = this.pdfViewer.handWrittenSignatureSettings.strokeColor ? this.pdfViewer.handWrittenSignatureSettings.strokeColor : '#000000';\n            var fontSize = 16;\n            var fontFamily = 'Helvetica';\n            var signatureBounds = this.pdfViewer.formFieldsModule.updateSignatureAspectRatio(this.outputString, true);\n            // eslint-disable-next-line\n            var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n            this.saveImageString = canvas.toDataURL();\n            this.signatureImageString = this.saveImageString;\n            annot = {\n                // eslint-disable-next-line max-len\n                id: 'sign' + this.pdfViewerBase.signatureCount, bounds: signatureBounds, pageIndex: pageIndex, data: this.outputString, fontFamily: fontFamily, fontSize: fontSize,\n                shapeAnnotationType: 'HandWrittenSignature', opacity: opacity, strokeColor: strokeColor, thickness: thickness, signatureName: annotationName\n            };\n            this.pdfViewerBase.currentSignatureAnnot = annot;\n            // eslint-disable-next-line\n            var checkbox = void 0;\n            if (isBlazor()) {\n                checkbox = document.getElementById(this.pdfViewer.element.id + '_signatureCheckBox');\n            }\n            else {\n                checkbox = document.getElementById('checkbox');\n            }\n            if (checkbox && checkbox.checked) {\n                this.addSignatureCollection();\n            }\n            this.hideSignaturePanel();\n            this.pdfViewerBase.isToolbarSignClicked = false;\n        }\n        else {\n            // eslint-disable-next-line\n            var checkbox = void 0;\n            if (isBlazor()) {\n                checkbox = document.getElementById(this.pdfViewer.element.id + '_signatureCheckBox');\n            }\n            else {\n                checkbox = document.getElementById('checkbox');\n            }\n            var isSignatureAdded = false;\n            if (isBlazor() && type) {\n                if (type[0] === 'Image') {\n                    this.imageAddSignature();\n                    isSignatureAdded = true;\n                    this.outputString = '';\n                }\n                else if (type[0] === 'Type') {\n                    this.typeAddSignature();\n                    isSignatureAdded = true;\n                    this.outputString = '';\n                }\n            }\n            if (!isSignatureAdded) {\n                // eslint-disable-next-line\n                var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n                this.saveImageString = canvas.toDataURL();\n                if (checkbox && checkbox.checked) {\n                    this.isSaveSignature = true;\n                    this.saveSignatureString = this.outputString;\n                    this.checkSaveFiledSign(this.pdfViewerBase.isInitialField, true);\n                }\n                else {\n                    this.isSaveSignature = false;\n                    this.saveSignatureString = '';\n                    this.checkSaveFiledSign(this.pdfViewerBase.isInitialField, false);\n                }\n                this.signatureImageString = this.saveImageString;\n                this.pdfViewer.formFieldsModule.drawSignature(null, null, this.pdfViewerBase.currentTarget, null);\n                isSignatureAdded = true;\n            }\n        }\n    };\n    Signature.prototype.checkSaveFiledSign = function (initialField, saveSign) {\n        if (initialField) {\n            this.isInitialFiledSaveSignature = saveSign;\n        }\n        else {\n            this.isSignatureFieldsSaveSignature = saveSign;\n        }\n    };\n    Signature.prototype.addSignatureInPage = function () {\n        if (this.signaturetype === 'Draw') {\n            this.addSignature();\n        }\n        else if (this.signaturetype === 'Type') {\n            this.typeAddSignature();\n        }\n        else {\n            this.imageAddSignature();\n        }\n        this.drawOutputString = '';\n        this.imageOutputString = '';\n    };\n    Signature.prototype.typeAddSignature = function () {\n        if (this.pdfViewerBase.isToolbarSignClicked) {\n            var zoomvalue = this.pdfViewerBase.getZoomFactor();\n            // eslint-disable-next-line\n            var annot = null;\n            var annotationName = this.pdfViewer.annotation.createGUID();\n            this.pdfViewerBase.currentSignatureAnnot = null;\n            this.pdfViewerBase.isSignatureAdded = true;\n            var pageIndex = this.pdfViewerBase.currentPageNumber - 1;\n            var pageDiv = document.getElementById(this.pdfViewer.element.id + '_pageDiv_' + pageIndex);\n            var thickness = this.pdfViewer.handWrittenSignatureSettings.thickness ? this.pdfViewer.handWrittenSignatureSettings.thickness : 1;\n            var opacity = this.pdfViewer.handWrittenSignatureSettings.opacity ? this.pdfViewer.handWrittenSignatureSettings.opacity : 1;\n            var strokeColor = this.pdfViewer.handWrittenSignatureSettings.strokeColor ? this.pdfViewer.handWrittenSignatureSettings.strokeColor : '#000000';\n            var fontSize = 16;\n            var currentLeft = 0;\n            var currentTop = 0;\n            var currentHeight = 65;\n            var currentWidth = 200;\n            currentLeft = ((parseFloat(pageDiv.style.width) / 2) - (currentWidth / 2)) / zoomvalue;\n            currentTop = ((parseFloat(pageDiv.style.height) / 2) - (currentHeight / 2)) / zoomvalue;\n            var zoomFactor = this.pdfViewerBase.getZoomFactor();\n            if (!this.signtypevalue) {\n                this.updateSignatureTypeValue(true);\n            }\n            var inputValue = this.signtypevalue;\n            annot = {\n                // eslint-disable-next-line max-len\n                id: 'Typesign' + this.pdfViewerBase.signatureCount, bounds: {\n                    left: currentLeft / zoomFactor, top: currentTop / zoomFactor, x: currentLeft / zoomFactor,\n                    // eslint-disable-next-line max-len\n                    y: currentTop / zoomFactor, width: currentWidth, height: currentHeight\n                }, pageIndex: pageIndex, dynamicText: inputValue, data: this.pdfViewerBase.signatureModule.outputString, shapeAnnotationType: 'SignatureText',\n                opacity: opacity, strokeColor: strokeColor, thickness: thickness, fontSize: fontSize, fontFamily: this.fontName, signatureName: annotationName\n            };\n            this.pdfViewerBase.currentSignatureAnnot = annot;\n            // eslint-disable-next-line\n            var checkbox = void 0;\n            if (isBlazor()) {\n                checkbox = document.getElementById(this.pdfViewer.element.id + '_signatureCheckBox');\n            }\n            else {\n                checkbox = document.getElementById('checkbox1');\n            }\n            if (checkbox && checkbox.checked) {\n                this.addSignatureCollection();\n            }\n            this.signtypevalue = '';\n            this.hideSignaturePanel();\n            this.pdfViewerBase.isToolbarSignClicked = false;\n        }\n        else {\n            if (this.outputString === '') {\n                this.updateSignatureTypeValue();\n            }\n            this.pdfViewer.formFieldsModule.drawSignature('Type', '', this.pdfViewerBase.currentTarget);\n            this.hideSignaturePanel();\n        }\n    };\n    Signature.prototype.imageAddSignature = function () {\n        if (this.pdfViewerBase.isToolbarSignClicked) {\n            var zoomvalue = this.pdfViewerBase.getZoomFactor();\n            // eslint-disable-next-line\n            var annot = null;\n            var annotationName = this.pdfViewer.annotation.createGUID();\n            this.pdfViewerBase.currentSignatureAnnot = null;\n            this.pdfViewerBase.isSignatureAdded = true;\n            var pageIndex = this.pdfViewerBase.currentPageNumber - 1;\n            var pageDiv = document.getElementById(this.pdfViewer.element.id + '_pageDiv_' + pageIndex);\n            var thickness = this.pdfViewer.handWrittenSignatureSettings.thickness ? this.pdfViewer.handWrittenSignatureSettings.thickness : 1;\n            var opacity = this.pdfViewer.handWrittenSignatureSettings.opacity ? this.pdfViewer.handWrittenSignatureSettings.opacity : 1;\n            var strokeColor = this.pdfViewer.handWrittenSignatureSettings.strokeColor ? this.pdfViewer.handWrittenSignatureSettings.strokeColor : '#000000';\n            var fontSize = 16;\n            var currentLeft = 0;\n            var currentTop = 0;\n            var standardImageRatio = 100;\n            var currentHeight = 0;\n            var currentWidth = 0;\n            // eslint-disable-next-line max-len\n            if (this.signatureImageHeight >= this.signatureImageWidth) {\n                currentHeight = ((this.signatureImageHeight / this.signatureImageHeight) * standardImageRatio);\n                currentWidth = ((this.signatureImageWidth / this.signatureImageHeight) * standardImageRatio);\n            }\n            else {\n                currentHeight = ((this.signatureImageHeight / this.signatureImageWidth) * standardImageRatio);\n                currentWidth = ((this.signatureImageWidth / this.signatureImageWidth) * standardImageRatio);\n            }\n            currentLeft = ((parseFloat(pageDiv.style.width) / 2) - (currentWidth / 2)) / zoomvalue;\n            currentTop = ((parseFloat(pageDiv.style.height) / 2) - (currentHeight / 2)) / zoomvalue;\n            var zoomFactor = this.pdfViewerBase.getZoomFactor();\n            var inputValue = this.signtypevalue;\n            annot = {\n                // eslint-disable-next-line max-len\n                id: 'Typesign' + this.pdfViewerBase.signatureCount, bounds: {\n                    left: currentLeft / zoomFactor, top: currentTop / zoomFactor, x: currentLeft / zoomFactor,\n                    // eslint-disable-next-line max-len\n                    y: currentTop / zoomFactor, width: currentWidth, height: currentHeight\n                }, pageIndex: pageIndex, dynamicText: inputValue, data: this.pdfViewerBase.signatureModule.outputString, shapeAnnotationType: 'SignatureImage',\n                opacity: opacity, strokeColor: strokeColor, thickness: thickness, fontSize: fontSize, fontFamily: this.fontName, signatureName: annotationName\n            };\n            this.pdfViewerBase.currentSignatureAnnot = annot;\n            // eslint-disable-next-line\n            var checkbox = void 0;\n            if (isBlazor()) {\n                checkbox = document.getElementById(this.pdfViewer.element.id + '_signatureCheckBox');\n            }\n            else {\n                checkbox = document.getElementById('checkbox2');\n            }\n            if (checkbox && checkbox.checked) {\n                this.addSignatureCollection();\n            }\n            this.hideSignaturePanel();\n            this.pdfViewerBase.isToolbarSignClicked = false;\n        }\n        else {\n            this.pdfViewer.formFieldsModule.drawSignature('Image', '', this.pdfViewerBase.currentTarget);\n            this.hideSignaturePanel();\n        }\n    };\n    Signature.prototype.updateSignatureTypeValue = function (isType) {\n        // eslint-disable-next-line\n        var fontElements = document.querySelectorAll('.e-pv-font-sign');\n        if (fontElements) {\n            for (var j = 0; j < fontElements.length; j++) {\n                if (fontElements[j] && fontElements[j].style.borderColor === 'red') {\n                    if (isType) {\n                        this.signtypevalue = fontElements[j].textContent;\n                        this.outputString = fontElements[j].textContent;\n                    }\n                    else {\n                        this.outputString = fontElements[j].textContent;\n                    }\n                    try {\n                        this.fontName = JSON.parse(fontElements[j].style.fontFamily);\n                    }\n                    catch (e) {\n                        this.fontName = fontElements[j].style.fontFamily;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    Signature.prototype.hideSignaturePanel = function () {\n        if (this.signatureDialog) {\n            this.signatureDialog.hide();\n        }\n    };\n    Signature.prototype.bindTypeSignatureClickEvent = function () {\n        if (isBlazor()) {\n            for (var i = 0; i < 4; i++) {\n                // eslint-disable-next-line\n                var fontElement = document.querySelector('#' + this.pdfViewer.element.id + '_font_signature' + i);\n                if (fontElement) {\n                    fontElement.addEventListener('click', this.typeSignatureclicked.bind(this));\n                }\n            }\n        }\n    };\n    Signature.prototype.bindDrawSignatureClickEvent = function () {\n        // eslint-disable-next-line\n        var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n        if (canvas) {\n            canvas.addEventListener('mousedown', this.signaturePanelMouseDown.bind(this));\n            canvas.addEventListener('mousemove', this.signaturePanelMouseMove.bind(this));\n            canvas.addEventListener('mouseup', this.signaturePanelMouseUp.bind(this));\n            canvas.addEventListener('mouseleave', this.signaturePanelMouseUp.bind(this));\n            canvas.addEventListener('touchstart', this.signaturePanelMouseDown.bind(this));\n            canvas.addEventListener('touchmove', this.signaturePanelMouseMove.bind(this));\n            canvas.addEventListener('touchend', this.signaturePanelMouseUp.bind(this));\n        }\n    };\n    // eslint-disable-next-line\n    Signature.prototype.typeSignatureclicked = function (event) {\n        var eventTarget = event.target;\n        if (eventTarget) {\n            for (var i = 0; i < 4; i++) {\n                // eslint-disable-next-line\n                var fontElement = document.querySelector('#' + this.pdfViewer.element.id + '_font_signature' + i);\n                if (fontElement) {\n                    fontElement.style.borderColor = '';\n                }\n            }\n            eventTarget.style.borderColor = 'red';\n            this.outputString = eventTarget.textContent;\n            try {\n                this.fontName = JSON.parse(eventTarget.style.fontFamily);\n            }\n            catch (e) {\n                this.fontName = eventTarget.style.fontFamily;\n            }\n            this.enableCreateButton(false);\n        }\n    };\n    // eslint-disable-next-line\n    Signature.prototype.createSignatureCanvas = function () {\n        // eslint-disable-next-line\n        var previousField = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n        // eslint-disable-next-line\n        var field = document.getElementById(this.pdfViewer.element.id + 'Signature_appearance');\n        if (previousField) {\n            previousField.remove();\n        }\n        if (field) {\n            field.remove();\n        }\n        // eslint-disable-next-line max-len\n        var appearanceDiv = createElement('div', { id: this.pdfViewer.element.id + 'Signature_appearance', className: 'e-pv-signature-apperance', styles: 'margin-top:30px' });\n        // eslint-disable-next-line max-len\n        var canvas = createElement('canvas', { id: this.pdfViewer.element.id + '_signatureCanvas_', className: 'e-pv-signature-canvas' });\n        if (this.pdfViewer.element.offsetWidth > 750) {\n            canvas.width = 714;\n        }\n        else {\n            canvas.width = this.pdfViewer.element.offsetWidth - 35;\n        }\n        canvas.classList.add('e-pv-canvas-signature');\n        canvas.height = 305;\n        canvas.style.height = '305px';\n        canvas.style.border = '1px dotted #bdbdbd';\n        canvas.style.backgroundColor = 'white';\n        canvas.style.boxSizing = 'border-box';\n        canvas.style.borderRadius = '2px';\n        canvas.addEventListener('mousedown', this.signaturePanelMouseDown.bind(this));\n        canvas.addEventListener('mousemove', this.signaturePanelMouseMove.bind(this));\n        canvas.addEventListener('mouseup', this.signaturePanelMouseUp.bind(this));\n        canvas.addEventListener('mouseleave', this.signaturePanelMouseLeave.bind(this));\n        canvas.addEventListener('touchstart', this.signaturePanelMouseDown.bind(this));\n        canvas.addEventListener('touchmove', this.signaturePanelMouseMove.bind(this));\n        canvas.addEventListener('touchend', this.signaturePanelMouseUp.bind(this));\n        appearanceDiv.appendChild(canvas);\n        // eslint-disable-next-line\n        var checkBoxObj;\n        // eslint-disable-next-line\n        var input;\n        var saveCheckBoxContent;\n        if (this.pdfViewerBase.isToolbarSignClicked && !this.pdfViewerBase.isInitialField) {\n            saveCheckBoxContent = this.pdfViewer.localeObj.getConstant('Save Signature');\n        }\n        else {\n            saveCheckBoxContent = this.pdfViewerBase.isInitialField ? this.pdfViewer.localeObj.getConstant('Save Initial') : this.pdfViewer.localeObj.getConstant('Save Signature');\n        }\n        if (!this.pdfViewer.hideSaveSignature) {\n            // eslint-disable-next-line\n            input = document.createElement('input');\n            input.type = 'checkbox';\n            input.id = 'checkbox';\n            appearanceDiv.appendChild(input);\n            checkBoxObj = new CheckBox({ label: saveCheckBoxContent, disabled: false, checked: false });\n            checkBoxObj.appendTo(input);\n        }\n        this.isSaveSignature = this.saveSignatureCheckbox();\n        if (this.isSaveSignature) {\n            checkBoxObj.checked = true;\n        }\n        //if (!this.pdfViewerBase.isToolbarSignClicked) {\n        // eslint-disable-next-line\n        var typeDiv = createElement('div', { id: this.pdfViewer.element.id + 'type_appearance', className: 'e-pv-signature-apperance', styles: 'margin-top:6px' });\n        // eslint-disable-next-line\n        var inputText = document.createElement('input');\n        inputText.type = 'text';\n        inputText.id = this.pdfViewer.element.id + '_e-pv-Signtext-box';\n        typeDiv.appendChild(inputText);\n        // eslint-disable-next-line\n        var inputobj = new TextBox({\n            placeholder: this.pdfViewer.localeObj.getConstant('Enter Signature as Name'),\n            floatLabelType: 'Auto'\n        });\n        inputobj.appendTo(inputText);\n        // eslint-disable-next-line\n        var fontDiv = createElement('div', { id: this.pdfViewer.element.id + '_font_appearance', className: 'e-pv-font-appearance-style' });\n        fontDiv.classList.add('e-pv-canvas-signature');\n        fontDiv.style.height = '270px';\n        fontDiv.style.border = '1px dotted #bdbdbd';\n        fontDiv.style.boxSizing = 'border-box';\n        fontDiv.style.borderRadius = '2px';\n        fontDiv.style.backgroundColor = 'white';\n        fontDiv.style.color = 'black';\n        fontDiv.style.marginTop = '8px';\n        typeDiv.appendChild(fontDiv);\n        input = document.createElement('input');\n        input.type = 'checkbox';\n        input.id = 'checkbox1';\n        typeDiv.appendChild(input);\n        checkBoxObj = new CheckBox({ label: saveCheckBoxContent, disabled: false, checked: false });\n        checkBoxObj.appendTo(input);\n        inputobj.addEventListener('input', this.renderSignatureText.bind(this));\n        this.enableCreateButton(true);\n        // eslint-disable-next-line\n        var tab = createElement('div', { id: this.pdfViewer.element.id + 'Signature_tab' });\n        var uploadDiv = createElement('div', { id: this.pdfViewer.element.id + 'upload_appearance', className: 'e-pv-signature-apperance', styles: 'padding-top:30px' });\n        // eslint-disable-next-line\n        var button = document.createElement('div');\n        button.id = this.pdfViewer.element.id + '_e-pv-upload-button';\n        uploadDiv.appendChild(button);\n        // eslint-disable-next-line\n        var uploadButton = new Button({ cssClass: 'e-pv-sign-upload', content: this.pdfViewer.localeObj.getConstant('Browse Signature Image') });\n        uploadButton.appendTo(button);\n        uploadButton.element.style.position = 'absolute';\n        // eslint-disable-next-line max-len\n        var uploadCanvas = createElement('canvas', { id: this.pdfViewer.element.id + '_signatureuploadCanvas_', className: 'e-pv-signature-uploadcanvas' });\n        if (this.pdfViewer.element.offsetWidth > 750) {\n            uploadCanvas.width = 714;\n        }\n        else {\n            uploadCanvas.width = this.pdfViewer.element.offsetWidth - 35;\n        }\n        uploadCanvas.classList.add('e-pv-canvas-signature');\n        uploadCanvas.height = 305;\n        uploadCanvas.style.height = '305px';\n        uploadButton.element.style.left = ((uploadCanvas.width / 2) - 50) + 'px';\n        uploadButton.element.style.top = ((parseFloat(uploadCanvas.style.height) / 2) + 20) + 'px';\n        uploadCanvas.style.border = '1px dotted #bdbdbd';\n        uploadCanvas.style.backgroundColor = 'white';\n        uploadCanvas.style.boxSizing = 'border-box';\n        uploadCanvas.style.borderRadius = '2px';\n        uploadCanvas.style.zIndex = '0';\n        uploadDiv.appendChild(uploadCanvas);\n        input = document.createElement('input');\n        input.type = 'checkbox';\n        input.id = 'checkbox2';\n        uploadDiv.appendChild(input);\n        checkBoxObj = new CheckBox({ label: saveCheckBoxContent, disabled: false, checked: false });\n        checkBoxObj.appendTo(input);\n        button.addEventListener('click', this.uploadSignatureImage.bind(this));\n        // eslint-disable-next-line max-len\n        this.signfontStyle = [{ FontName: 'Helvetica' }, { FontName: 'Times New Roman' }, { FontName: 'Courier' }, { FontName: 'Symbol' }];\n        // eslint-disable-next-line\n        var fontSignature = [];\n        if (this.pdfViewerBase.isToolbarSignClicked && !isNullOrUndefined(this.pdfViewer.handWrittenSignatureSettings.typeSignatureFonts)) {\n            for (var j = 0; j < 4; j++) {\n                if (!isNullOrUndefined(this.pdfViewer.handWrittenSignatureSettings.typeSignatureFonts[j])) {\n                    this.signfontStyle[j].FontName = this.pdfViewer.handWrittenSignatureSettings.typeSignatureFonts[j];\n                }\n            }\n        }\n        for (var i = 0; i < this.signfontStyle.length; i++) {\n            fontSignature[i] = document.createElement('div');\n            fontSignature[i].id = '_font_signature' + i + '';\n            fontSignature[i].classList.add('e-pv-font-sign');\n        }\n        this.fontsign = fontSignature;\n        // eslint-disable-next-line\n        var proxy = this;\n        var items = [];\n        if (this.pdfViewerBase.isToolbarSignClicked) {\n            if (this.pdfViewerBase.isInitialField) {\n                items = this.showHideSignatureTab(this.pdfViewer.handWrittenSignatureSettings.initialDialogSettings.displayMode, appearanceDiv, typeDiv, uploadDiv);\n            }\n            else {\n                items = this.showHideSignatureTab(this.pdfViewer.handWrittenSignatureSettings.signatureDialogSettings.displayMode, appearanceDiv, typeDiv, uploadDiv);\n            }\n        }\n        else {\n            if (this.pdfViewerBase.isInitialField) {\n                items = this.showHideSignatureTab(this.pdfViewer.initialFieldSettings.initialDialogSettings.displayMode, appearanceDiv, typeDiv, uploadDiv);\n            }\n            else {\n                items = this.showHideSignatureTab(this.pdfViewer.signatureFieldSettings.signatureDialogSettings.displayMode, appearanceDiv, typeDiv, uploadDiv);\n            }\n        }\n        // eslint-disable-next-line\n        this.tabObj = new Tab({\n            selected: function (args) {\n                proxy.handleSelectEvent(args);\n            },\n            selecting: function (args) {\n                proxy.select(args);\n            },\n            items: items\n        });\n        this.tabObj.appendTo(tab);\n        if (tab && tab.lastElementChild) {\n            tab.lastElementChild.style.overflow = 'hidden';\n        }\n        if (items[0].header.label === 'DRAW') {\n            this.signaturetype = 'Draw';\n        }\n        else if (items[0].header.label === 'TYPE') {\n            this.signaturetype = 'Type';\n        }\n        else {\n            this.signaturetype = 'Image';\n        }\n        return tab;\n        // } else {\n        //     return appearanceDiv;\n        // }\n    };\n    Signature.prototype.handleSelectEvent = function (e) {\n        // eslint-disable-next-line\n        var headerText = '';\n        var maximumWidth = 750;\n        var tabInstance = document.getElementById(this.pdfViewer.element.id + 'Signature_tab').ej2_instances[0];\n        if (tabInstance) {\n            if (tabInstance.items.length > 0) {\n                for (var i = 0; i < tabInstance.items.length; i++) {\n                    var headerValue = tabInstance.items[i].header.text;\n                    if (headerValue === e.selectedItem.textContent) {\n                        headerText = tabInstance.items[i].header.label;\n                    }\n                }\n            }\n        }\n        var checkbox = document.getElementById('checkbox');\n        if (checkbox && checkbox.checked) {\n            if (e.previousIndex === 0 && this.outputString !== '') {\n                this.isSaveSignature = true;\n                this.saveSignatureString = this.outputString;\n                // eslint-disable-next-line\n                var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n                this.saveImageString = canvas.toDataURL();\n                this.signatureImageString = this.saveImageString;\n            }\n        }\n        else {\n            if (this.isSaveSignature) {\n                this.isSaveSignature = false;\n                this.saveSignatureString = '';\n                this.saveImageString = '';\n                this.signatureImageString = '';\n            }\n        }\n        this.clearSignatureCanvas(e);\n        // eslint-disable-next-line\n        if (headerText.toLocaleLowerCase() === 'draw') {\n            this.signaturetype = 'Draw';\n            this.enableCreateSignatureButton();\n            var drawCheckbox = document.getElementById(\"checkbox\");\n            this.hideSignatureCheckbox(drawCheckbox);\n        }\n        else if (headerText.toLocaleLowerCase() === 'type') {\n            this.updateSignatureTypeValue();\n            this.signaturetype = 'Type';\n            this.enableCreateSignatureButton();\n            var typeCheckbox = document.getElementById(\"checkbox1\");\n            this.hideSignatureCheckbox(typeCheckbox);\n        }\n        else if (headerText.toLocaleLowerCase() === 'upload') {\n            this.signaturetype = 'Image';\n            this.enableCreateSignatureButton();\n            var imageCheckbox = document.getElementById(\"checkbox2\");\n            this.hideSignatureCheckbox(imageCheckbox);\n        }\n        if (this.pdfViewer.element.offsetWidth < maximumWidth)\n            this.updateCanvasSize();\n    };\n    Signature.prototype.enableCreateSignatureButton = function () {\n        if (this.outputString !== \"\") {\n            this.enableCreateButton(false);\n        }\n        else {\n            this.enableCreateButton(true);\n        }\n    };\n    Signature.prototype.showHideSignatureTab = function (displayMode, appearanceDiv, typeDiv, uploadDiv) {\n        var items = [];\n        if (displayMode & DisplayMode.Draw) {\n            items.push({\n                header: { 'text': this.pdfViewer.localeObj.getConstant('Draw-hand Signature'), 'label': 'DRAW' },\n                content: appearanceDiv\n            });\n        }\n        if (displayMode & DisplayMode.Text) {\n            items.push({\n                header: { 'text': this.pdfViewer.localeObj.getConstant('Type Signature'), 'label': 'TYPE' },\n                content: typeDiv\n            });\n        }\n        if (displayMode & DisplayMode.Upload) {\n            items.push({\n                header: { 'text': this.pdfViewer.localeObj.getConstant('Upload Signature'), 'label': 'UPLOAD' },\n                content: uploadDiv\n            });\n        }\n        return items;\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    Signature.prototype.createSignatureFileElement = function () {\n        // eslint-disable-next-line\n        var signImage = createElement('input', { id: this.pdfViewer.element.id + '_signElement', attrs: { 'type': 'file' } });\n        signImage.setAttribute('accept', '.jpg,.jpeg,.png');\n        signImage.style.position = 'absolute';\n        signImage.style.left = '0px';\n        signImage.style.top = '0px';\n        signImage.style.visibility = 'hidden';\n        document.body.appendChild(signImage);\n        signImage.addEventListener('change', this.addStampImage);\n    };\n    Signature.prototype.uploadSignatureImage = function () {\n        // eslint-disable-next-line\n        var signImage = document.getElementById(this.pdfViewer.element.id + '_signElement');\n        if (signImage) {\n            signImage.click();\n        }\n    };\n    Signature.prototype.renderSignatureText = function () {\n        var maximumWidth = 750;\n        // eslint-disable-next-line\n        var fontDiv = document.getElementById(this.pdfViewer.element.id + '_font_appearance');\n        // eslint-disable-next-line\n        var textBox = document.getElementById(this.pdfViewer.element.id + '_e-pv-Signtext-box');\n        for (var i = 0; i < this.signfontStyle.length; i++) {\n            this.fontsign[i].innerHTML = textBox.value;\n            this.fontsign[i].style.fontFamily = this.signfontStyle[i].FontName;\n            if (this.signfontStyle[i].FontName === 'Helvetica') {\n                this.fontsign[i].style.borderColor = 'red';\n            }\n            fontDiv.appendChild(this.fontsign[i]);\n        }\n        for (var i = 0; i < this.signfontStyle.length; i++) {\n            // eslint-disable-next-line\n            var clickSign = document.getElementById('_font_signature' + i + '');\n            clickSign.addEventListener('click', this.typeSignatureclick.bind(this));\n        }\n        this.enableCreateButton(false);\n        this.enableClearbutton(false);\n        if (this.pdfViewer.element.offsetWidth < maximumWidth)\n            this.updateCanvasSize();\n    };\n    Signature.prototype.typeSignatureclick = function () {\n        var eventTarget = event.target;\n        // eslint-disable-next-line\n        var createButton = document.getElementsByClassName('e-pv-createbtn')[0];\n        createButton.disabled = false;\n        for (var i = 0; i < 4; i++) {\n            // eslint-disable-next-line\n            var fontElement = document.getElementById('_font_signature' + i + '');\n            if (fontElement) {\n                fontElement.style.borderColor = '';\n            }\n        }\n        eventTarget.style.borderColor = 'red';\n        this.outputString = eventTarget.textContent;\n        try {\n            this.fontName = JSON.parse(eventTarget.style.fontFamily);\n        }\n        catch (e) {\n            this.fontName = eventTarget.style.fontFamily;\n        }\n    };\n    /**\n     * @param bounds\n     * @param position\n     * @private\n     */\n    // eslint-disable-next-line\n    Signature.prototype.addSignatureCollection = function (bounds, position) {\n        var minimumX = -1;\n        var minimumY = -1;\n        var maximumX = -1;\n        var maximumY = -1;\n        // eslint-disable-next-line\n        var collectionData = processPathData(this.outputString);\n        // eslint-disable-next-line\n        var newCanvas = document.createElement('canvas');\n        // eslint-disable-next-line\n        var context = newCanvas.getContext('2d');\n        // eslint-disable-next-line\n        var imageString;\n        var signatureType = this.pdfViewerBase.currentSignatureAnnot.shapeAnnotationType;\n        if (signatureType === 'HandWrittenSignature') {\n            if (collectionData.length !== 0) {\n                // eslint-disable-next-line\n                for (var k = 0; k < collectionData.length; k++) {\n                    // eslint-disable-next-line\n                    var val = collectionData[k];\n                    if (minimumX === -1) {\n                        // eslint-disable-next-line\n                        minimumX = (val['x']);\n                        // eslint-disable-next-line\n                        maximumX = (val['x']);\n                        // eslint-disable-next-line\n                        minimumY = (val['y']);\n                        // eslint-disable-next-line\n                        maximumY = (val['y']);\n                    }\n                    else {\n                        // eslint-disable-next-line\n                        var point1 = (val['x']);\n                        // eslint-disable-next-line\n                        var point2 = (val['y']);\n                        if (minimumX >= point1) {\n                            minimumX = point1;\n                        }\n                        if (minimumY >= point2) {\n                            minimumY = point2;\n                        }\n                        if (maximumX <= point1) {\n                            maximumX = point1;\n                        }\n                        if (maximumY <= point2) {\n                            maximumY = point2;\n                        }\n                    }\n                }\n                var newdifferenceX = maximumX - minimumX;\n                var newdifferenceY = maximumY - minimumY;\n                var differenceX = newdifferenceX / 100;\n                var differenceY = newdifferenceY / 100;\n                var left = 0;\n                var top_1 = 0;\n                if (bounds) {\n                    newCanvas.width = position.currentWidth;\n                    newCanvas.height = position.currentHeight;\n                    differenceX = newdifferenceX / (bounds.width);\n                    differenceY = newdifferenceY / (bounds.height);\n                    left = bounds.x - position.currentLeft;\n                    top_1 = bounds.y - position.currentTop;\n                }\n                else {\n                    newCanvas.width = 100;\n                    newCanvas.height = 100;\n                }\n                context.beginPath();\n                for (var n = 0; n < collectionData.length; n++) {\n                    // eslint-disable-next-line\n                    var val = collectionData[n];\n                    // eslint-disable-next-line\n                    var point1 = ((val['x'] - minimumX) / differenceX) + left;\n                    // eslint-disable-next-line\n                    var point2 = ((val['y'] - minimumY) / differenceY) + top_1;\n                    // eslint-disable-next-line\n                    if (val['command'] === 'M') {\n                        context.moveTo(point1, point2);\n                        // eslint-disable-next-line\n                    }\n                    else if (val['command'] === 'L') {\n                        context.lineTo(point1, point2);\n                    }\n                }\n                context.stroke();\n                context.closePath();\n                imageString = newCanvas.toDataURL();\n            }\n        }\n        else if (signatureType === 'SignatureText') {\n            imageString = this.outputString;\n        }\n        else {\n            imageString = this.outputString;\n        }\n        if (bounds) {\n            this.saveImageString = imageString;\n        }\n        else {\n            // eslint-disable-next-line\n            var signCollection = {};\n            signCollection['sign_' + this.pdfViewerBase.imageCount] = this.outputString;\n            this.outputcollection.push(signCollection);\n            // eslint-disable-next-line\n            var signature = [];\n            signature.push({ id: 'sign_' + this.pdfViewerBase.imageCount, imageData: imageString, signatureType: signatureType, fontFamily: this.pdfViewerBase.currentSignatureAnnot.fontFamily });\n            this.signaturecollection.push({ image: signature, isInitial: this.pdfViewerBase.isInitialField });\n            this.pdfViewerBase.imageCount++;\n        }\n    };\n    /**\n     * @private]\n     * @param {number} limit - The limit.\n     * @returns {number} - Returns number.\n     */\n    Signature.prototype.getSaveLimit = function (limit) {\n        if (limit > this.maxSaveLimit) {\n            limit = this.maxSaveLimit;\n        }\n        else if (limit < 1) {\n            limit = 1;\n        }\n        return limit;\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    Signature.prototype.RenderSavedSignature = function () {\n        this.pdfViewerBase.signatureCount++;\n        var zoomvalue = this.pdfViewerBase.getZoomFactor();\n        var annot;\n        if (this.pdfViewerBase.isAddedSignClicked) {\n            var annotationName = this.pdfViewer.annotation.createGUID();\n            this.pdfViewerBase.currentSignatureAnnot = null;\n            this.pdfViewerBase.isSignatureAdded = true;\n            var pageIndex = this.pdfViewerBase.currentPageNumber - 1;\n            var pageDiv = document.getElementById(this.pdfViewer.element.id + '_pageDiv_' + pageIndex);\n            var currentLeft = 0;\n            var currentTop = 0;\n            // eslint-disable-next-line max-len\n            var currentWidth = this.pdfViewer.handWrittenSignatureSettings.width ? this.pdfViewer.handWrittenSignatureSettings.width : 100;\n            // eslint-disable-next-line max-len\n            var currentHeight = this.pdfViewer.handWrittenSignatureSettings.height ? this.pdfViewer.handWrittenSignatureSettings.height : 100;\n            // eslint-disable-next-line max-len\n            var thickness = this.pdfViewer.handWrittenSignatureSettings.thickness ? this.pdfViewer.handWrittenSignatureSettings.thickness : 1;\n            // eslint-disable-next-line max-len\n            var opacity = this.pdfViewer.handWrittenSignatureSettings.opacity ? this.pdfViewer.handWrittenSignatureSettings.opacity : 1;\n            // eslint-disable-next-line max-len\n            var strokeColor = this.pdfViewer.handWrittenSignatureSettings.strokeColor ? this.pdfViewer.handWrittenSignatureSettings.strokeColor : '#000000';\n            currentLeft = ((parseFloat(pageDiv.style.width) / 2) - (currentWidth / 2)) / zoomvalue;\n            // eslint-disable-next-line max-len\n            currentTop = ((parseFloat(pageDiv.style.height) / 2) - (currentHeight / 2)) / zoomvalue;\n            var keyString = '';\n            var signatureType = void 0;\n            var signatureFontFamily = void 0;\n            for (var collection = 0; collection < this.outputcollection.length; collection++) {\n                // eslint-disable-next-line\n                var collectionAddedsign = this.outputcollection[collection];\n                // eslint-disable-next-line\n                var eventTarget = event.target;\n                // eslint-disable-next-line max-len\n                if (eventTarget && eventTarget.id === 'sign_' + collection || eventTarget && eventTarget.id === 'sign_border' + collection) {\n                    keyString = collectionAddedsign['sign_' + collection];\n                    break;\n                }\n            }\n            for (var signatureIndex = 0; signatureIndex < this.signaturecollection.length; signatureIndex++) {\n                var eventTarget = event.target;\n                var signatureId = this.signaturecollection[signatureIndex].image[0].id.split('_')[1];\n                if (eventTarget && eventTarget.id === 'sign_' + signatureId || eventTarget && eventTarget.id === 'sign_border' + signatureId) {\n                    signatureType = this.signaturecollection[signatureIndex].image[0].signatureType;\n                    signatureFontFamily = this.signaturecollection[signatureIndex].image[0].fontFamily;\n                    break;\n                }\n            }\n            if (signatureType === 'HandWrittenSignature') {\n                // eslint-disable-next-line\n                var signatureBounds = this.pdfViewer.formFieldsModule.updateSignatureAspectRatio(keyString, true);\n                // eslint-disable-next-line max-len\n                currentWidth = signatureBounds.width ? signatureBounds.width : currentWidth;\n                // eslint-disable-next-line max-len\n                currentHeight = signatureBounds.height ? signatureBounds.height : currentHeight;\n            }\n            else {\n                currentWidth = currentWidth === 150 ? 200 : this.pdfViewer.handWrittenSignatureSettings.width;\n                // eslint-disable-next-line max-len\n                currentHeight = currentHeight === 100 ? 65 : this.pdfViewer.handWrittenSignatureSettings.height;\n            }\n            annot = {\n                // eslint-disable-next-line max-len\n                id: 'sign' + this.pdfViewerBase.signatureCount, bounds: { x: currentLeft, y: currentTop, width: currentWidth, height: currentHeight }, pageIndex: pageIndex, data: keyString,\n                // eslint-disable-next-line max-len\n                shapeAnnotationType: signatureType, opacity: opacity, fontFamily: signatureFontFamily, strokeColor: strokeColor, thickness: thickness, signatureName: annotationName\n            };\n            this.pdfViewerBase.currentSignatureAnnot = annot;\n            this.pdfViewerBase.isAddedSignClicked = false;\n        }\n        else {\n            this.pdfViewer.formFieldsModule.drawSignature();\n        }\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    Signature.prototype.updateCanvasSize = function () {\n        // eslint-disable-next-line\n        var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n        this.setTabItemWidth(canvas);\n        var uploadCanvas = document.getElementById(this.pdfViewer.element.id + '_signatureuploadCanvas_');\n        this.setTabItemWidth(uploadCanvas);\n        var fontAppearance = document.getElementById(this.pdfViewer.element.id + '_font_appearance');\n        this.setTabItemWidth(fontAppearance);\n    };\n    Signature.prototype.setTabItemWidth = function (canvas) {\n        var padding = 2;\n        var maximumWidth = 750;\n        var canvasWidth = 714;\n        var margin = 50;\n        var elem = document.querySelector('.e-dlg-content');\n        if (elem) {\n            var style = getComputedStyle(elem);\n            padding = padding + parseInt(style.paddingLeft, 10) + parseInt(style.paddingRight, 10);\n        }\n        if (canvas && this.signatureDialog && this.signatureDialog.visible) {\n            if (this.pdfViewer.element.offsetWidth > maximumWidth) {\n                canvas.width = canvasWidth;\n                canvas.style.width = canvasWidth + 'px';\n            }\n            else {\n                canvas.width = this.pdfViewer.element.offsetWidth - padding;\n                canvas.style.width = canvas.width + 'px';\n            }\n        }\n        var fontInnerDiv = document.getElementsByClassName('e-pv-font-sign');\n        if (canvas && fontInnerDiv && fontInnerDiv.length > 0) {\n            for (var i = 0; i < fontInnerDiv.length; i++) {\n                var fontDiv = fontInnerDiv[i];\n                fontDiv.style.width = ((canvas.width / 2) - margin) + 'px';\n            }\n        }\n    };\n    Signature.prototype.signaturePanelMouseDown = function (e) {\n        if (e.type !== 'contextmenu') {\n            e.preventDefault();\n            this.findMousePosition(e);\n            this.mouseDetection = true;\n            this.oldX = this.mouseX;\n            this.oldY = this.mouseY;\n            this.newObject = [];\n            this.drawMousePosition(e);\n            this.mouseMoving = true;\n        }\n    };\n    Signature.prototype.enableCreateButton = function (isEnable) {\n        // eslint-disable-next-line\n        var createbtn = document.getElementsByClassName('e-pv-createbtn')[0];\n        if (createbtn) {\n            createbtn.disabled = isEnable;\n        }\n        this.enableClearbutton(isEnable);\n    };\n    Signature.prototype.enableClearbutton = function (isEnable) {\n        // eslint-disable-next-line\n        var clearbtn = document.getElementsByClassName('e-pv-clearbtn')[0];\n        if (clearbtn) {\n            clearbtn.disabled = isEnable;\n        }\n    };\n    Signature.prototype.signaturePanelMouseMove = function (e) {\n        if (this.mouseDetection && this.signaturetype === 'Draw') {\n            this.findMousePosition(e);\n            this.enableCreateButton(false);\n            this.drawMousePosition(e);\n        }\n    };\n    Signature.prototype.findMousePosition = function (event) {\n        var offsetX;\n        var offsetY;\n        if (event.type.indexOf('touch') !== -1) {\n            event = event;\n            var element = event.target;\n            // eslint-disable-next-line\n            var currentRect = element.getBoundingClientRect();\n            this.mouseX = event.touches[0].pageX - currentRect.left;\n            this.mouseY = event.touches[0].pageY - currentRect.top;\n        }\n        else {\n            event = event;\n            this.mouseX = event.offsetX;\n            this.mouseY = event.offsetY;\n        }\n    };\n    Signature.prototype.drawMousePosition = function (event) {\n        if (this.mouseDetection) {\n            this.drawSignatureInCanvas();\n            this.oldX = this.mouseX;\n            this.oldY = this.mouseY;\n        }\n    };\n    Signature.prototype.drawSignatureInCanvas = function () {\n        // eslint-disable-next-line\n        var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n        // eslint-disable-next-line\n        var context = canvas.getContext('2d');\n        context.beginPath();\n        context.moveTo(this.oldX, this.oldY);\n        context.lineTo(this.mouseX, this.mouseY);\n        context.stroke();\n        context.lineWidth = 2;\n        context.arc(this.oldX, this.oldY, 2 / 2, 0, Math.PI * 2, true);\n        context.closePath();\n        this.newObject.push(this.mouseX, this.mouseY);\n    };\n    Signature.prototype.signaturePanelMouseUp = function () {\n        if (this.mouseDetection) {\n            this.convertToPath(this.newObject);\n        }\n        this.mouseDetection = false;\n        if (event.type == 'touchend') {\n            this.canvasTouched = true;\n        }\n    };\n    Signature.prototype.signaturePanelMouseLeave = function () {\n        if (this.mouseDetection) {\n            this.convertToPath(this.newObject);\n        }\n        this.mouseDetection = false;\n        this.mouseMoving = false;\n    };\n    ;\n    // eslint-disable-next-line\n    Signature.prototype.convertToPath = function (newObject) {\n        this.movePath(newObject[0], newObject[1]);\n        this.linePath(newObject[0], newObject[1]);\n        for (var n = 2; n < newObject.length; n = n + 2) {\n            this.linePath(newObject[n], newObject[n + 1]);\n        }\n    };\n    Signature.prototype.linePath = function (x, y) {\n        this.outputString += 'L' + x + ',' + y + ' ';\n    };\n    Signature.prototype.movePath = function (x, y) {\n        this.outputString += 'M' + x + ',' + y + ' ';\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    Signature.prototype.clearSignatureCanvas = function (type) {\n        var isCanvasClear = true;\n        var drawObject = [];\n        if (type && !isNullOrUndefined(type.previousIndex) && !isNullOrUndefined(type.selectedIndex)) {\n            isCanvasClear = false;\n            if (type.previousIndex === 0) {\n                this.drawOutputString = this.outputString;\n                drawObject = this.newObject;\n            }\n            else if (type.previousIndex === 2) {\n                this.imageOutputString = this.outputString;\n            }\n            this.outputString = '';\n            this.newObject = [];\n            if (type.selectedIndex === 0) {\n                this.outputString = this.drawOutputString;\n                this.newObject = drawObject;\n            }\n            else if (type.selectedIndex === 2) {\n                this.outputString = this.imageOutputString;\n            }\n        }\n        else {\n            this.outputString = '';\n            this.newObject = [];\n        }\n        var isClearDrawTab = false;\n        var isClearTypeTab = false;\n        var isClearImageTab = false;\n        if (type && type.currentTarget && type.currentTarget.classList.contains(\"e-pv-clearbtn\")) {\n            isCanvasClear = false;\n            if (this.signaturetype === 'Draw') {\n                isClearDrawTab = true;\n            }\n            else if (this.signaturetype === 'Type') {\n                isClearTypeTab = true;\n            }\n            else {\n                isClearImageTab = true;\n            }\n        }\n        // eslint-disable-next-line\n        var canvas = document.getElementById(this.pdfViewer.element.id + '_signatureCanvas_');\n        // eslint-disable-next-line\n        if ((canvas && isCanvasClear) || (isClearDrawTab)) {\n            // eslint-disable-next-line\n            var context = canvas.getContext('2d');\n            context.clearRect(0, 0, canvas.width, canvas.height);\n        }\n        // eslint-disable-next-line\n        var imageCanvas = document.getElementById(this.pdfViewer.element.id + '_signatureuploadCanvas_');\n        if (imageCanvas && isCanvasClear || (isClearImageTab)) {\n            // eslint-disable-next-line\n            var context = imageCanvas.getContext('2d');\n            context.clearRect(0, 0, imageCanvas.width, imageCanvas.height);\n            // eslint-disable-next-line\n            var signbutton = document.getElementById(this.pdfViewer.element.id + '_e-pv-upload-button');\n            if (signbutton) {\n                signbutton.style.visibility = '';\n            }\n        }\n        // eslint-disable-next-line\n        var fontdiv = document.getElementById(this.pdfViewer.element.id + '_font_appearance');\n        // eslint-disable-next-line\n        var textbox = document.getElementById(this.pdfViewer.element.id + '_e-pv-Signtext-box');\n        if ((fontdiv && textbox && isCanvasClear) || (isClearTypeTab)) {\n            textbox.value = '';\n            if (!isBlazor()) {\n                fontdiv.innerHTML = '';\n            }\n        }\n        this.enableCreateButton(true);\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    Signature.prototype.closeSignaturePanel = function () {\n        if (this.pdfViewerBase.currentTarget) {\n            this.pdfViewerBase.drawSignatureWithTool = true;\n        }\n        this.clearSignatureCanvas();\n        if (!isBlazor()) {\n            this.signatureDialog.hide();\n        }\n        this.pdfViewerBase.isToolbarSignClicked = false;\n        this.pdfViewerBase.drawSignatureWithTool = false;\n        this.drawOutputString = '';\n        this.imageOutputString = '';\n    };\n    /**\n     * @private\n     * @returns {string} - Returns the string.\n     */\n    Signature.prototype.saveSignature = function () {\n        // eslint-disable-next-line\n        var storeObject = null;\n        if (this.pdfViewerBase.isStorageExceed) {\n            storeObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_sign'];\n        }\n        else {\n            storeObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_sign');\n        }\n        // eslint-disable-next-line\n        var annotations = new Array();\n        for (var j = 0; j < this.pdfViewerBase.pageCount; j++) {\n            annotations[j] = [];\n        }\n        if (storeObject) {\n            var annotationCollection = JSON.parse(storeObject);\n            for (var i = 0; i < annotationCollection.length; i++) {\n                var newArray = [];\n                var pageAnnotationObject = annotationCollection[i];\n                if (pageAnnotationObject) {\n                    for (var z = 0; pageAnnotationObject.annotations.length > z; z++) {\n                        // eslint-disable-next-line max-len\n                        var strokeColorString = pageAnnotationObject.annotations[z].strokeColor ? pageAnnotationObject.annotations[z].strokeColor : \"black\";\n                        pageAnnotationObject.annotations[z].strokeColor = JSON.stringify(this.getRgbCode(strokeColorString));\n                        // eslint-disable-next-line max-len\n                        pageAnnotationObject.annotations[z].bounds = JSON.stringify(this.pdfViewer.annotation.getBounds(pageAnnotationObject.annotations[z].bounds, pageAnnotationObject.pageIndex));\n                        if (pageAnnotationObject.annotations[z].shapeAnnotationType === 'HandWrittenSignature') {\n                            // eslint-disable-next-line\n                            var collectionData = processPathData(pageAnnotationObject.annotations[z].data);\n                            // eslint-disable-next-line\n                            var csData = splitArrayCollection(collectionData);\n                            pageAnnotationObject.annotations[z].data = JSON.stringify(csData);\n                        }\n                        else {\n                            if (pageAnnotationObject.annotations[z].shapeAnnotationType === 'SignatureText' && !this.checkDefaultFont(pageAnnotationObject.annotations[z].fontFamily)) {\n                                var signTypeCanvas = createElement('canvas');\n                                signTypeCanvas.width = 150;\n                                signTypeCanvas.height = pageAnnotationObject.annotations[z].fontSize * 2;\n                                // eslint-disable-next-line\n                                var canvasContext = signTypeCanvas.getContext('2d');\n                                var x = signTypeCanvas.width / 2;\n                                var y = (signTypeCanvas.height / 2) - 10;\n                                canvasContext.textAlign = 'center';\n                                canvasContext.font = pageAnnotationObject.annotations[z].fontSize + 'px ' + pageAnnotationObject.annotations[z].fontFamily;\n                                canvasContext.fillText(pageAnnotationObject.annotations[z].data, x, y);\n                                pageAnnotationObject.annotations[z].data = JSON.stringify(signTypeCanvas.toDataURL('image/png'));\n                                pageAnnotationObject.annotations[z].shapeAnnotationType = 'SignatureImage';\n                            }\n                            else {\n                                pageAnnotationObject.annotations[z].data = JSON.stringify(pageAnnotationObject.annotations[z].data);\n                            }\n                        }\n                    }\n                    newArray = pageAnnotationObject.annotations;\n                }\n                annotations[pageAnnotationObject.pageIndex] = newArray;\n            }\n        }\n        return JSON.stringify(annotations);\n    };\n    Signature.prototype.checkDefaultFont = function (fontName) {\n        // eslint-disable-next-line\n        [{ FontName: 'Helvetica' }, { FontName: 'Times New Roman' }, { FontName: 'Courier' }, { FontName: 'Symbol' }];\n        if (fontName === 'Helvetica' || fontName === 'Times New Roman' || fontName === 'Courier' || fontName === 'Symbol') {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @param colorString\n     * @private\n     */\n    // eslint-disable-next-line\n    Signature.prototype.getRgbCode = function (colorString) {\n        if (!colorString.match(/#([a-z0-9]+)/gi) && !colorString.match(/^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+(?:\\.\\d+)?))?\\)$/)) {\n            colorString = this.pdfViewer.annotationModule.nameToHash(colorString);\n        }\n        var stringArray = colorString.split(',');\n        if (isNullOrUndefined(stringArray[1])) {\n            colorString = this.pdfViewer.annotationModule.getValue(colorString, 'rgba');\n            stringArray = colorString.split(',');\n        }\n        // eslint-disable-next-line radix\n        var r = parseInt(stringArray[0].split('(')[1]);\n        // eslint-disable-next-line radix\n        var g = parseInt(stringArray[1]);\n        // eslint-disable-next-line radix\n        var b = parseInt(stringArray[2]);\n        // eslint-disable-next-line radix\n        var a = parseInt(stringArray[3]);\n        return { r: r, g: g, b: b, a: a };\n    };\n    /**\n     * @private\n     * @param {number} left - The left.\n     * @param {number} top - The top.\n     * @returns {void}\n     */\n    Signature.prototype.renderSignature = function (left, top) {\n        var annot;\n        // eslint-disable-next-line\n        var currentAnnotation = this.pdfViewerBase.currentSignatureAnnot;\n        var annotationName = this.pdfViewer.annotation.createGUID();\n        if (currentAnnotation) {\n            if (this.pdfViewerBase.currentSignatureAnnot.shapeAnnotationType === 'HandWrittenSignature') {\n                annot = {\n                    // eslint-disable-next-line max-len\n                    id: currentAnnotation.id, bounds: { x: left, y: top, width: currentAnnotation.bounds.width, height: currentAnnotation.bounds.height }, pageIndex: currentAnnotation.pageIndex, data: currentAnnotation.data,\n                    shapeAnnotationType: 'HandWrittenSignature', opacity: currentAnnotation.opacity, fontFamily: currentAnnotation.fontFamily, fontSize: currentAnnotation.fontSize, strokeColor: currentAnnotation.strokeColor, thickness: currentAnnotation.thickness, signatureName: annotationName\n                };\n            }\n            if (this.pdfViewerBase.currentSignatureAnnot.shapeAnnotationType === 'SignatureText') {\n                annot = {\n                    // eslint-disable-next-line max-len\n                    id: currentAnnotation.id, bounds: { x: left, y: top, width: currentAnnotation.bounds.width, height: currentAnnotation.bounds.height }, pageIndex: currentAnnotation.pageIndex, data: currentAnnotation.data,\n                    shapeAnnotationType: 'SignatureText', opacity: currentAnnotation.opacity, fontFamily: currentAnnotation.fontFamily, fontSize: currentAnnotation.fontSize, strokeColor: currentAnnotation.strokeColor, thickness: currentAnnotation.thickness, signatureName: annotationName\n                };\n            }\n            else if (this.pdfViewerBase.currentSignatureAnnot.shapeAnnotationType === 'SignatureImage') {\n                annot = {\n                    // eslint-disable-next-line max-len\n                    id: currentAnnotation.id, bounds: { x: left, y: top, width: currentAnnotation.bounds.width, height: currentAnnotation.bounds.height }, pageIndex: currentAnnotation.pageIndex, data: currentAnnotation.data,\n                    shapeAnnotationType: 'SignatureImage', opacity: currentAnnotation.opacity, fontFamily: currentAnnotation.fontFamily, fontSize: currentAnnotation.fontSize, strokeColor: currentAnnotation.strokeColor, thickness: currentAnnotation.thickness, signatureName: annotationName\n                };\n            }\n            this.pdfViewer.add(annot);\n            // eslint-disable-next-line\n            var canvass = document.getElementById(this.pdfViewer.element.id + '_annotationCanvas_' + currentAnnotation.pageIndex);\n            // eslint-disable-next-line\n            this.pdfViewer.renderDrawing(canvass, currentAnnotation.pageIndex);\n            this.pdfViewerBase.signatureAdded = true;\n            // eslint-disable-next-line max-len\n            this.storeSignatureData(currentAnnotation.pageIndex, annot);\n            this.pdfViewer.fireSignatureAdd(currentAnnotation.pageIndex, currentAnnotation.signatureName, currentAnnotation.shapeAnnotationType, currentAnnotation.bounds, currentAnnotation.opacity, currentAnnotation.strokeColor, currentAnnotation.thickness);\n            this.pdfViewerBase.currentSignatureAnnot = null;\n            this.pdfViewerBase.signatureCount++;\n        }\n    };\n    /**\n     * @param annotationCollection\n     * @param pageIndex\n     * @param isImport\n     * @private\n     */\n    // eslint-disable-next-line\n    Signature.prototype.renderExistingSignature = function (annotationCollection, pageIndex, isImport) {\n        var annot;\n        var isAnnotationAdded = false;\n        if (!isImport) {\n            for (var p = 0; p < this.signAnnotationIndex.length; p++) {\n                if (this.signAnnotationIndex[p] === pageIndex) {\n                    isAnnotationAdded = true;\n                    break;\n                }\n            }\n        }\n        if (annotationCollection && !isAnnotationAdded) {\n            if (annotationCollection.length > 0 && this.signAnnotationIndex.indexOf(pageIndex) === -1) {\n                this.signAnnotationIndex.push(pageIndex);\n            }\n            for (var n = 0; n < annotationCollection.length; n++) {\n                // eslint-disable-next-line\n                var currentAnnotation = annotationCollection[n];\n                if (currentAnnotation) {\n                    // eslint-disable-next-line\n                    var data = currentAnnotation.PathData;\n                    if (isImport) {\n                        if (currentAnnotation.IsSignature) {\n                            data = currentAnnotation.PathData;\n                        }\n                        else if (currentAnnotation.AnnotationType === 'SignatureImage' || currentAnnotation.AnnotationType === 'SignatureText') {\n                            data = JSON.parse(JSON.stringify(currentAnnotation.PathData));\n                        }\n                        else {\n                            if (data.includes('command')) {\n                                data = getPathString(JSON.parse(currentAnnotation.PathData));\n                            }\n                            else {\n                                data = currentAnnotation.PathData;\n                            }\n                        }\n                    }\n                    this.outputString = data;\n                    this.outputString = '';\n                    var rectDiff = 0;\n                    var rectDifference = 1;\n                    var bounds = currentAnnotation.Bounds;\n                    var currentLeft = !isNullOrUndefined(bounds.X) ? bounds.X + (rectDiff / 2) : bounds.x + (rectDiff / 2);\n                    var currentTop = !isNullOrUndefined(bounds.Y) ? bounds.Y + (rectDiff / 2) : bounds.y + (rectDiff / 2);\n                    var currentWidth = bounds.Width ? bounds.Width - (rectDifference - 1) : bounds.width - (rectDifference - 1);\n                    var currentHeight = bounds.Height ? bounds.Height - (rectDifference - 1) : bounds.height - (rectDifference - 1);\n                    if (currentAnnotation.AnnotationType === 'SignatureText') {\n                        annot = {\n                            id: 'sign' + this.pdfViewerBase.signatureCount, bounds: { x: currentLeft, y: currentTop, width: currentWidth, height: currentHeight }, pageIndex: pageIndex, data: data, fontFamily: currentAnnotation.FontFamily, fontSize: currentAnnotation.FontSize,\n                            shapeAnnotationType: 'SignatureText', opacity: currentAnnotation.Opacity, strokeColor: currentAnnotation.StrokeColor, thickness: currentAnnotation.Thickness, signatureName: currentAnnotation.SignatureName\n                        };\n                    }\n                    else if (currentAnnotation.AnnotationType === 'SignatureImage') {\n                        annot = {\n                            id: 'sign' + this.pdfViewerBase.signatureCount, bounds: { x: currentLeft, y: currentTop, width: currentWidth, height: currentHeight }, pageIndex: pageIndex, data: data, shapeAnnotationType: 'SignatureImage', opacity: currentAnnotation.Opacity, strokeColor: currentAnnotation.StrokeColor, thickness: currentAnnotation.Thickness, signatureName: currentAnnotation.SignatureName\n                        };\n                    }\n                    else {\n                        annot = {\n                            id: 'sign' + this.pdfViewerBase.signatureCount, bounds: { x: currentLeft, y: currentTop, width: currentWidth, height: currentHeight }, pageIndex: pageIndex, data: data, shapeAnnotationType: 'HandWrittenSignature', opacity: currentAnnotation.Opacity, strokeColor: currentAnnotation.StrokeColor, thickness: currentAnnotation.Thickness, signatureName: currentAnnotation.SignatureName\n                        };\n                    }\n                }\n                this.pdfViewer.add(annot);\n                // eslint-disable-next-line\n                var canvass = document.getElementById(this.pdfViewer.element.id + '_annotationCanvas_' + currentAnnotation.pageIndex);\n                // eslint-disable-next-line\n                this.pdfViewer.renderDrawing(canvass, annot.pageIndex);\n                this.storeSignatureData(annot.pageIndex, annot);\n                this.pdfViewerBase.currentSignatureAnnot = null;\n                this.pdfViewerBase.signatureCount++;\n                // eslint-disable-next-line max-len\n                if (this.pdfViewerBase.navigationPane && this.pdfViewerBase.navigationPane.annotationMenuObj && this.pdfViewer.isSignatureEditable) {\n                    // eslint-disable-next-line max-len\n                    this.pdfViewerBase.navigationPane.annotationMenuObj.enableItems([this.pdfViewer.localeObj.getConstant('Export Annotations')], true);\n                    // eslint-disable-next-line max-len\n                    this.pdfViewerBase.navigationPane.annotationMenuObj.enableItems([this.pdfViewer.localeObj.getConstant('Export XFDF')], true);\n                }\n            }\n        }\n    };\n    /**\n     * @param pageNumber\n     * @param annotations\n     * @private\n     */\n    // eslint-disable-next-line\n    Signature.prototype.storeSignatureData = function (pageNumber, annotations) {\n        // eslint-disable-next-line max-len\n        this.pdfViewer.annotation.addAction(annotations.pageIndex, null, annotations, 'Addition', '', annotations, annotations);\n        var annotation = null;\n        var left = annotations.bounds.left ? annotations.bounds.left : annotations.bounds.x;\n        var top = annotations.bounds.top ? annotations.bounds.top : annotations.bounds.y;\n        if (annotations.wrapper && annotations.wrapper.bounds) {\n            left = annotations.wrapper.bounds.left;\n            top = annotations.wrapper.bounds.top;\n        }\n        annotation = {\n            // eslint-disable-next-line max-len\n            id: annotations.id, bounds: { left: left, top: top, width: annotations.bounds.width, height: annotations.bounds.height }, shapeAnnotationType: annotations.shapeAnnotationType, opacity: annotations.opacity, thickness: annotations.thickness, strokeColor: annotations.strokeColor, pageIndex: annotations.pageIndex, data: annotations.data, fontSize: annotations.fontSize, fontFamily: annotations.fontFamily, signatureName: annotations.signatureName\n        };\n        // eslint-disable-next-line\n        var sessionSize = Math.round(JSON.stringify(window.sessionStorage).length / 1024);\n        // eslint-disable-next-line\n        var currentAnnotation = Math.round(JSON.stringify(annotation).length / 1024);\n        if ((sessionSize + currentAnnotation) > 4500) {\n            this.pdfViewerBase.isStorageExceed = true;\n            this.pdfViewer.annotationModule.clearAnnotationStorage();\n        }\n        // eslint-disable-next-line\n        var storeObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_sign');\n        var index = 0;\n        if (!storeObject) {\n            this.storeSignatureCollections(annotation, pageNumber);\n            var shapeAnnotation = { pageIndex: pageNumber, annotations: [] };\n            shapeAnnotation.annotations.push(annotation);\n            index = shapeAnnotation.annotations.indexOf(annotation);\n            var annotationCollection = [];\n            annotationCollection.push(shapeAnnotation);\n            var annotationStringified = JSON.stringify(annotationCollection);\n            if (this.pdfViewerBase.isStorageExceed) {\n                this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_sign'] = annotationStringified;\n            }\n            else {\n                window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_sign', annotationStringified);\n            }\n        }\n        else {\n            this.storeSignatureCollections(annotation, pageNumber);\n            var annotObject = JSON.parse(storeObject);\n            window.sessionStorage.removeItem(this.pdfViewerBase.documentId + '_annotations_sign');\n            var pageIndex = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageNumber);\n            if (annotObject[pageIndex]) {\n                annotObject[pageIndex].annotations.push(annotation);\n                index = annotObject[pageIndex].annotations.indexOf(annotation);\n            }\n            else {\n                var markupAnnotation = { pageIndex: pageNumber, annotations: [] };\n                markupAnnotation.annotations.push(annotation);\n                index = markupAnnotation.annotations.indexOf(annotation);\n                annotObject.push(markupAnnotation);\n            }\n            var annotationStringified = JSON.stringify(annotObject);\n            if (this.pdfViewerBase.isStorageExceed) {\n                this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_sign'] = annotationStringified;\n            }\n            else {\n                window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_sign', annotationStringified);\n            }\n        }\n    };\n    /**\n     * @param property\n     * @param pageNumber\n     * @param annotationBase\n     * @param isSignatureEdited\n     * @private\n     */\n    // eslint-disable-next-line\n    Signature.prototype.modifySignatureCollection = function (property, pageNumber, annotationBase, isSignatureEdited) {\n        this.pdfViewerBase.updateDocumentEditedProperty(true);\n        var currentAnnotObject = null;\n        var pageAnnotations = this.getAnnotations(pageNumber, null);\n        if (pageAnnotations != null && annotationBase) {\n            for (var i = 0; i < pageAnnotations.length; i++) {\n                if (annotationBase.id === pageAnnotations[i].id) {\n                    if (property === 'bounds') {\n                        // eslint-disable-next-line max-len\n                        pageAnnotations[i].bounds = { left: annotationBase.wrapper.bounds.left, top: annotationBase.wrapper.bounds.top, width: annotationBase.bounds.width, height: annotationBase.bounds.height };\n                        pageAnnotations[i].fontSize = annotationBase.fontSize;\n                    }\n                    else if (property === 'stroke') {\n                        pageAnnotations[i].strokeColor = annotationBase.wrapper.children[0].style.strokeColor;\n                    }\n                    else if (property === 'opacity') {\n                        pageAnnotations[i].opacity = annotationBase.wrapper.children[0].style.opacity;\n                    }\n                    else if (property === 'thickness') {\n                        pageAnnotations[i].thickness = annotationBase.wrapper.children[0].style.strokeWidth;\n                    }\n                    else if (property === 'delete') {\n                        this.updateSignatureCollection(pageAnnotations[i]);\n                        currentAnnotObject = pageAnnotations.splice(i, 1)[0];\n                        break;\n                    }\n                    if (property && property !== 'delete') {\n                        this.storeSignatureCollections(pageAnnotations[i], pageNumber);\n                    }\n                    if (isSignatureEdited) {\n                        pageAnnotations[i].opacity = annotationBase.wrapper.children[0].style.opacity;\n                        pageAnnotations[i].strokeColor = annotationBase.wrapper.children[0].style.strokeColor;\n                        pageAnnotations[i].thickness = annotationBase.wrapper.children[0].style.strokeWidth;\n                        this.storeSignatureCollections(pageAnnotations[i], pageNumber);\n                        break;\n                    }\n                }\n            }\n            this.manageAnnotations(pageAnnotations, pageNumber);\n        }\n        return currentAnnotObject;\n    };\n    /**\n     * @param annotation\n     * @param pageNumber\n     * @private\n     */\n    // eslint-disable-next-line\n    Signature.prototype.storeSignatureCollections = function (annotation, pageNumber) {\n        // eslint-disable-next-line\n        var collectionDetails = this.checkSignatureCollection(annotation);\n        // eslint-disable-next-line\n        var selectAnnotation = cloneObject(annotation);\n        selectAnnotation.annotationId = annotation.signatureName;\n        selectAnnotation.pageNumber = pageNumber;\n        delete selectAnnotation.annotName;\n        if (annotation.id) {\n            selectAnnotation.uniqueKey = annotation.id;\n            delete selectAnnotation.id;\n        }\n        if (collectionDetails.isExisting) {\n            this.pdfViewer.signatureCollection.splice(collectionDetails.position, 0, selectAnnotation);\n        }\n        else {\n            this.pdfViewer.signatureCollection.push(selectAnnotation);\n        }\n    };\n    // eslint-disable-next-line\n    Signature.prototype.checkSignatureCollection = function (signature) {\n        // eslint-disable-next-line\n        var collections = this.pdfViewer.signatureCollection;\n        if (collections && signature) {\n            for (var i = 0; i < collections.length; i++) {\n                if (collections[i].annotationId === signature.signatureName) {\n                    this.pdfViewer.signatureCollection.splice(i, 1);\n                    return { isExisting: true, position: i };\n                }\n            }\n        }\n        return { isExisting: false, position: null };\n    };\n    /**\n     * @param signature\n     * @private\n     */\n    // eslint-disable-next-line\n    Signature.prototype.updateSignatureCollection = function (signature) {\n        // eslint-disable-next-line\n        var collections = this.pdfViewer.signatureCollection;\n        if (collections && signature) {\n            for (var i = 0; i < collections.length; i++) {\n                if (collections[i].annotationId === signature.signatureName) {\n                    this.pdfViewer.signatureCollection.splice(i, 1);\n                    break;\n                }\n            }\n        }\n    };\n    /**\n     * @param pageNumber\n     * @param signature\n     * @private\n     */\n    // eslint-disable-next-line\n    Signature.prototype.addInCollection = function (pageNumber, signature) {\n        if (signature) {\n            this.storeSignatureCollections(signature, pageNumber);\n            // eslint-disable-next-line\n            var pageSignatures = this.getAnnotations(pageNumber, null);\n            if (pageSignatures) {\n                pageSignatures.push(signature);\n            }\n            this.manageAnnotations(pageSignatures, pageNumber);\n        }\n    };\n    // eslint-disable-next-line\n    Signature.prototype.getAnnotations = function (pageIndex, shapeAnnotations) {\n        // eslint-disable-next-line\n        var annotationCollection;\n        // eslint-disable-next-line\n        var storeObject = null;\n        if (this.pdfViewerBase.isStorageExceed) {\n            storeObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_sign'];\n        }\n        else {\n            storeObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_sign');\n        }\n        if (storeObject) {\n            var annotObject = JSON.parse(storeObject);\n            var index = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageIndex);\n            if (annotObject[index]) {\n                annotationCollection = annotObject[index].annotations;\n            }\n            else {\n                annotationCollection = shapeAnnotations;\n            }\n        }\n        else {\n            annotationCollection = shapeAnnotations;\n        }\n        return annotationCollection;\n    };\n    Signature.prototype.manageAnnotations = function (pageAnnotations, pageNumber) {\n        // eslint-disable-next-line\n        var storeObject = null;\n        if (this.pdfViewerBase.isStorageExceed) {\n            storeObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_sign'];\n        }\n        else {\n            storeObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_sign');\n        }\n        if (storeObject) {\n            var annotObject = JSON.parse(storeObject);\n            window.sessionStorage.removeItem(this.pdfViewerBase.documentId + '_annotations_sign');\n            var index = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageNumber);\n            if (annotObject[index]) {\n                annotObject[index].annotations = pageAnnotations;\n            }\n            var annotationStringified = JSON.stringify(annotObject);\n            if (this.pdfViewerBase.isStorageExceed) {\n                this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_sign'] = annotationStringified;\n            }\n            else {\n                window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_sign', annotationStringified);\n            }\n        }\n    };\n    /**\n     * @private\n     * @param {boolean} isShow - Returns the true or false.\n     * @returns {void}\n     */\n    Signature.prototype.showSignatureDialog = function (isShow) {\n        if (isShow) {\n            this.createSignaturePanel();\n        }\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    Signature.prototype.setAnnotationMode = function () {\n        this.pdfViewerBase.isToolbarSignClicked = true;\n        this.showSignatureDialog(true);\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    Signature.prototype.setInitialMode = function () {\n        this.pdfViewerBase.isToolbarSignClicked = true;\n        this.pdfViewerBase.isInitialField = true;\n        this.showSignatureDialog(true);\n    };\n    /**\n     * @param number\n     * @private\n     */\n    // eslint-disable-next-line\n    Signature.prototype.ConvertPointToPixel = function (number) {\n        return (number * (96 / 72));\n    };\n    /**\n     * @param signature\n     * @param pageIndex\n     * @param isImport\n     * @private\n     */\n    // eslint-disable-next-line\n    Signature.prototype.updateSignatureCollections = function (signature, pageIndex, isImport) {\n        var annot;\n        // eslint-disable-next-line\n        if (signature) {\n            // eslint-disable-next-line\n            var bounds = signature.Bounds;\n            var currentLeft = bounds.X;\n            var currentTop = bounds.Y;\n            var currentWidth = bounds.Width;\n            var currentHeight = bounds.Height;\n            // eslint-disable-next-line\n            var data = signature.PathData;\n            if (isImport) {\n                data = getPathString(JSON.parse(signature.PathData));\n            }\n            annot = {\n                // eslint-disable-next-line max-len\n                id: 'sign' + signature.SignatureName, bounds: { x: currentLeft, y: currentTop, width: currentWidth, height: currentHeight }, pageIndex: pageIndex, data: data,\n                shapeAnnotationType: 'HandWrittenSignature', opacity: signature.Opacity, strokeColor: signature.StrokeColor, thickness: signature.Thickness, signatureName: signature.SignatureName\n            };\n            return annot;\n        }\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    Signature.prototype.destroy = function () {\n        window.sessionStorage.removeItem('_annotations_sign');\n        // eslint-disable-next-line\n        var signImage = document.getElementById(this.pdfViewer.element.id + '_signElement');\n        if (signImage) {\n            signImage.removeEventListener('change', this.addStampImage);\n            if (signImage.parentElement)\n                signImage.parentElement.removeChild(signImage);\n        }\n        if (this.signatureDialog)\n            this.signatureDialog.destroy();\n    };\n    return Signature;\n}());\nexport { Signature };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}