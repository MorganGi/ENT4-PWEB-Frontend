{"ast":null,"code":"import { EventHandler, isNullOrUndefined, extend, closest, getValue } from '@syncfusion/ej2-base';\nimport { getActualPropFromColl, isActionPrevent, getColumnByForeignKeyValue } from '../base/util';\nimport { remove, matches } from '@syncfusion/ej2-base';\nimport { DataUtil, Query, DataManager } from '@syncfusion/ej2-data';\nimport * as events from '../base/constant';\nimport { CellType, ResponsiveDialogAction } from '../base/enum';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { Cell } from '../models/cell';\nimport { Row } from '../models/row';\nimport { FilterCellRenderer } from '../renderer/filter-cell-renderer';\nimport { parentsUntil } from '../base/util';\nimport { FilterMenuRenderer } from '../renderer/filter-menu-renderer';\nimport { CheckBoxFilter } from '../actions/checkbox-filter';\nimport { ExcelFilter } from '../actions/excel-filter';\nimport * as literals from '../base/string-literals';\nimport { Input } from '@syncfusion/ej2-inputs';\n/**\n *\n * The `Filter` module is used to handle filtering action.\n */\n\nvar Filter =\n/** @class */\nfunction () {\n  /**\n   * Constructor for Grid filtering module\n   *\n   * @param {IGrid} parent - specifies the IGrid\n   * @param {FilterSettings} filterSettings - specifies the filterSettings\n   * @param {ServiceLocator} serviceLocator - specifes the serviceLocator\n   * @hidden\n   */\n  function Filter(parent, filterSettings, serviceLocator) {\n    this.predicate = 'and';\n    this.contentRefresh = true;\n    this.filterByMethod = true;\n    this.refresh = true;\n    this.values = {};\n    this.operators = {};\n    this.cellText = {};\n    this.nextFlMenuOpen = '';\n    this.type = {\n      'Menu': FilterMenuRenderer,\n      'CheckBox': CheckBoxFilter,\n      'Excel': ExcelFilter\n    };\n    /** @hidden */\n\n    this.filterOperators = {\n      contains: 'contains',\n      endsWith: 'endswith',\n      equal: 'equal',\n      greaterThan: 'greaterthan',\n      greaterThanOrEqual: 'greaterthanorequal',\n      lessThan: 'lessthan',\n      lessThanOrEqual: 'lessthanorequal',\n      notEqual: 'notequal',\n      startsWith: 'startswith'\n    };\n    this.fltrDlgDetails = {\n      field: '',\n      isOpen: false\n    };\n    /** @hidden */\n\n    this.skipNumberInput = ['=', ' ', '!'];\n    this.skipStringInput = ['>', '<', '='];\n    this.actualPredicate = {};\n    this.parent = parent;\n    this.filterSettings = filterSettings;\n    this.serviceLocator = serviceLocator;\n    this.addEventListener();\n    this.setFullScreenDialog();\n  }\n  /**\n   * To render filter bar when filtering enabled.\n   *\n   * @param {NotifyArgs} e - specifies the NotifyArgs\n   * @returns {void}\n   * @hidden\n   */\n\n\n  Filter.prototype.render = function (e) {\n    if (DataUtil.getObject('args.isFrozen', e) || this.parent.getFrozenMode() === literals.leftRight && DataUtil.getObject('args.renderFrozenRightContent', e)) {\n      return;\n    }\n\n    var gObj = this.parent;\n    this.l10n = this.serviceLocator.getService('localization');\n    this.getLocalizedCustomOperators();\n\n    if (this.parent.filterSettings.type === 'FilterBar') {\n      if (gObj.columns.length) {\n        var fltrElem = this.parent.element.querySelector('.e-filterbar');\n\n        if (fltrElem) {\n          remove(fltrElem);\n        }\n\n        var rowRenderer = new RowRenderer(this.serviceLocator, CellType.Filter, gObj);\n        var cellrender = this.serviceLocator.getService('cellRendererFactory');\n        cellrender.addCellRenderer(CellType.Filter, new FilterCellRenderer(this.parent, this.serviceLocator));\n        this.valueFormatter = this.serviceLocator.getService('valueFormatter');\n        rowRenderer.element = this.parent.createElement('tr', {\n          className: 'e-filterbar',\n          attrs: {\n            role: 'row'\n          }\n        });\n        var row = this.generateRow();\n        row.data = this.values;\n\n        if (gObj.getFrozenMode() === 'Right') {\n          var thead = gObj.getFrozenRightHeader().querySelector('thead');\n          thead.appendChild(rowRenderer.element);\n        } else {\n          this.parent.getHeaderContent().querySelector('thead').appendChild(rowRenderer.element);\n        }\n\n        var rowdrag = this.parent.element.querySelector('.e-rowdragheader');\n        this.element = rowRenderer.render(row, gObj.getColumns(), null, null, rowRenderer.element);\n        var detail = this.element.querySelector('.e-detailheadercell');\n\n        if (detail) {\n          detail.className = 'e-filterbarcell e-mastercell';\n        }\n\n        if (rowdrag) {\n          rowdrag.className = 'e-dragheadercell e-mastercell';\n        }\n\n        var gCells = [].slice.call(this.element.getElementsByClassName('e-grouptopleftcell'));\n\n        if (gCells.length) {\n          gCells[gCells.length - 1].classList.add('e-lastgrouptopleftcell');\n        }\n\n        this.wireEvents();\n        this.parent.notify(events.freezeRender, {\n          case: 'filter'\n        });\n      }\n    }\n  };\n  /**\n   * To show the responsive custom filter dialog\n   *\n   * @param {boolean} enable - specifes dialog open\n   * @returns {void}\n   * @hidden\n   */\n\n\n  Filter.prototype.showCustomFilter = function (enable) {\n    this.responsiveDialogRenderer.isCustomDialog = enable;\n    this.responsiveDialogRenderer.showResponsiveDialog(this.column);\n  };\n  /**\n   * To create the filter module.\n   *\n   * @param {Column} col - specifies the filtering column name\n   * @returns {void}\n   * @hidden\n   */\n\n\n  Filter.prototype.setFilterModel = function (col) {\n    var type = col.filter.type || this.parent.filterSettings.type;\n    this.filterModule = new this.type[type](this.parent, this.parent.filterSettings, this.serviceLocator, this.customOperators, this);\n  };\n  /**\n   * To destroy the filter bar.\n   *\n   * @returns {void}\n   * @hidden\n   */\n\n\n  Filter.prototype.destroy = function () {\n    var gridElement = this.parent.element;\n\n    if (!gridElement || !gridElement.querySelector('.' + literals.gridHeader) && !gridElement.querySelector('.' + literals.gridContent)) {\n      return;\n    }\n\n    if (this.filterModule) {\n      this.filterModule.destroy();\n    } // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n\n    if (!this.parent.refreshing && (this.parent.isDestroyed || !this.parent.allowFiltering)) {\n      this.filterSettings.columns = [];\n    }\n\n    this.updateFilterMsg();\n    this.removeEventListener();\n    this.unWireEvents();\n\n    if (this.filterSettings.type === 'FilterBar' && this.filterSettings.showFilterBarOperator) {\n      var dropdownlist = [].slice.call(this.element.getElementsByClassName('e-filterbaroperator'));\n\n      for (var i = 0; i < dropdownlist.length; i++) {\n        if (dropdownlist[i].ej2_instances[0]) {\n          dropdownlist[i].ej2_instances[0].destroy();\n        }\n      }\n    }\n\n    if (this.element) {\n      if (this.element.parentElement) {\n        remove(this.element);\n      }\n\n      var filterBarElement = this.parent.getHeaderContent().querySelector('.e-filterbar');\n\n      if (this.parent.isFrozenGrid() && filterBarElement) {\n        remove(filterBarElement);\n      }\n    }\n  };\n\n  Filter.prototype.setFullScreenDialog = function () {\n    if (this.serviceLocator) {\n      this.serviceLocator.registerAdaptiveService(this, this.parent.enableAdaptiveUI, ResponsiveDialogAction.isFilter);\n    }\n  };\n\n  Filter.prototype.generateRow = function () {\n    var options = {};\n    var row = new Row(options);\n    row.cells = this.generateCells();\n    return row;\n  };\n\n  Filter.prototype.generateCells = function () {\n    //TODO: generate dummy column for group, detail, stacked row here for filtering;\n    var cells = [];\n\n    if (this.parent.allowGrouping) {\n      for (var c = 0, len = this.parent.groupSettings.columns.length; c < len; c++) {\n        cells.push(this.generateCell({}, CellType.HeaderIndent));\n      }\n    }\n\n    if (this.parent.detailTemplate || this.parent.childGrid) {\n      cells.push(this.generateCell({}, CellType.DetailHeader));\n    }\n\n    if (this.parent.isRowDragable() && this.parent.getFrozenMode() !== 'Right') {\n      cells.push(this.generateCell({}, CellType.RowDragHIcon));\n    }\n\n    for (var _i = 0, _a = this.parent.getColumns(); _i < _a.length; _i++) {\n      var dummy = _a[_i];\n      cells.push(this.generateCell(dummy));\n    }\n\n    if (this.parent.getFrozenMode() === 'Right') {\n      cells.push(this.generateCell({}, CellType.RowDragHIcon));\n    }\n\n    return cells;\n  };\n\n  Filter.prototype.generateCell = function (column, cellType) {\n    var opt = {\n      'visible': column.visible,\n      'isDataCell': false,\n      'rowId': '',\n      'column': column,\n      'cellType': cellType ? cellType : CellType.Filter,\n      'attributes': {\n        title: this.l10n.getConstant('FilterbarTitle')\n      }\n    };\n    return new Cell(opt);\n  };\n  /**\n   * To update filterSettings when applying filter.\n   *\n   * @returns {void}\n   * @hidden\n   */\n\n\n  Filter.prototype.updateModel = function () {\n    var col = this.parent.getColumnByField(this.fieldName);\n    this.filterObjIndex = this.getFilteredColsIndexByField(col);\n    this.prevFilterObject = this.filterSettings.columns[this.filterObjIndex];\n    var arrayVal = Array.isArray(this.value) ? this.value : [this.value];\n    var moduleName = this.parent.dataSource.adaptor && this.parent.dataSource.adaptor.getModuleName ? this.parent.dataSource.adaptor.getModuleName() : undefined;\n\n    for (var i = 0, len = arrayVal.length; i < len; i++) {\n      var field = col.isForeignColumn() ? col.foreignKeyValue : this.fieldName;\n      var isMenuNotEqual = this.operator === 'notequal';\n      this.currentFilterObject = {\n        field: field,\n        uid: col.uid,\n        isForeignKey: col.isForeignColumn(),\n        operator: this.operator,\n        value: arrayVal[i],\n        predicate: this.predicate,\n        matchCase: this.matchCase,\n        ignoreAccent: this.ignoreAccent,\n        actualFilterValue: {},\n        actualOperator: {}\n      };\n      var index = this.getFilteredColsIndexByField(col);\n\n      if (index > -1 && !Array.isArray(this.value)) {\n        this.filterSettings.columns[index] = this.currentFilterObject;\n      } else {\n        this.filterSettings.columns.push(this.currentFilterObject);\n      }\n\n      if (!this.column.isForeignColumn() && isNullOrUndefined(this.value) && (this.operator === 'equal' || this.operator === 'notequal') && moduleName !== 'ODataAdaptor' && moduleName !== 'ODataV4Adaptor') {\n        this.filterSettings.columns = [];\n\n        if (col.type === 'string') {\n          this.filterSettings.columns.push({\n            field: field,\n            ignoreAccent: this.ignoreAccent,\n            matchCase: this.matchCase,\n            operator: this.operator,\n            predicate: isMenuNotEqual ? 'and' : 'or',\n            value: ''\n          });\n        }\n\n        this.filterSettings.columns.push({\n          field: field,\n          ignoreAccent: this.ignoreAccent,\n          matchCase: this.matchCase,\n          operator: this.operator,\n          predicate: isMenuNotEqual ? 'and' : 'or',\n          value: undefined\n        });\n        this.filterSettings.columns.push({\n          field: field,\n          ignoreAccent: this.ignoreAccent,\n          matchCase: this.matchCase,\n          operator: this.operator,\n          predicate: isMenuNotEqual ? 'and' : 'or',\n          value: null\n        });\n      }\n    } // eslint-disable-next-line no-self-assign\n\n\n    this.filterSettings.columns = this.filterSettings.columns;\n    this.parent.dataBind();\n  };\n\n  Filter.prototype.getFilteredColsIndexByField = function (col) {\n    var cols = this.filterSettings.columns;\n\n    for (var i = 0, len = cols.length; i < len; i++) {\n      if (cols[i].uid === col.uid || col.isForeignColumn() && this.parent.getColumnByUid(col.uid).field === col.foreignKeyValue) {\n        return i;\n      }\n    }\n\n    return -1;\n  };\n  /**\n   * To trigger action complete event.\n   *\n   * @param {NotifyArgs} e - specifies the NotifyArgs\n   * @returns {void}\n   * @hidden\n   */\n\n\n  Filter.prototype.onActionComplete = function (e) {\n    var args = !this.isRemove ? {\n      currentFilterObject: this.currentFilterObject,\n\n      /* tslint:disable:no-string-literal */\n      currentFilteringColumn: !isNullOrUndefined(this.column) ? this.column.field : undefined,\n\n      /* tslint:enable:no-string-literal */\n      columns: this.filterSettings.columns,\n      requestType: 'filtering',\n      type: events.actionComplete\n    } : {\n      requestType: 'filtering',\n      type: events.actionComplete\n    };\n    this.parent.trigger(events.actionComplete, extend(e, args));\n    this.isRemove = false;\n  };\n\n  Filter.prototype.wireEvents = function () {\n    EventHandler.add(this.parent.getHeaderContent(), 'keyup', this.keyUpHandlerImmediate, this);\n  };\n\n  Filter.prototype.unWireEvents = function () {\n    EventHandler.remove(this.parent.getHeaderContent(), 'keyup', this.keyUpHandlerImmediate);\n  };\n\n  Filter.prototype.enableAfterRender = function (e) {\n    if (e.module === this.getModuleName() && e.enable) {\n      this.parent.getHeaderTable().classList.add('e-sortfilter');\n      this.render();\n    }\n  };\n\n  Filter.prototype.refreshFilterValue = function () {\n    this.parent.removeEventListener(events.beforeDataBound, this.refreshFilterValueFn);\n\n    if (this.filterSettings.type === 'FilterBar' && this.filterSettings.columns.length && !this.parent.getCurrentViewRecords().length) {\n      this.initialEnd();\n    }\n  };\n\n  Filter.prototype.initialEnd = function () {\n    this.parent.off(events.contentReady, this.initialEnd);\n\n    if (this.parent.getColumns().length && this.filterSettings.columns.length) {\n      var gObj = this.parent;\n      this.contentRefresh = false;\n      this.initialLoad = true;\n\n      for (var _i = 0, _a = gObj.filterSettings.columns; _i < _a.length; _i++) {\n        var col = _a[_i];\n        this.filterByColumn(col.field, col.operator, col.value, col.predicate, col.matchCase, col.ignoreAccent, col.actualFilterValue, col.actualOperator);\n      }\n\n      this.initialLoad = false;\n      this.updateFilterMsg();\n      this.contentRefresh = true;\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n\n\n  Filter.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.on(events.setFullScreenDialog, this.setFullScreenDialog, this);\n    this.parent.on(events.uiUpdate, this.enableAfterRender, this);\n    this.parent.on(events.filterComplete, this.onActionComplete, this);\n    this.parent.on(events.inBoundModelChanged, this.onPropertyChanged, this);\n    this.parent.on(events.keyPressed, this.keyUpHandler, this);\n    this.parent.on(events.columnPositionChanged, this.columnPositionChanged, this);\n    this.parent.on(events.headerRefreshed, this.render, this);\n    this.parent.on(events.contentReady, this.initialEnd, this);\n    this.parent.on(events.filterMenuClose, this.filterMenuClose, this);\n    this.docClickHandler = this.clickHandler.bind(this);\n    EventHandler.add(document, 'click', this.docClickHandler, this);\n    EventHandler.add(this.parent.element, 'mousedown', this.refreshClearIcon, this);\n    this.parent.on(events.filterOpen, this.columnMenuFilter, this);\n    this.parent.on(events.click, this.filterIconClickHandler, this);\n    this.parent.on('persist-data-changed', this.initialEnd, this);\n    this.parent.on(events.closeFilterDialog, this.clickHandler, this);\n    this.parent.on(events.destroy, this.destroy, this);\n    this.refreshFilterValueFn = this.refreshFilterValue.bind(this);\n    this.parent.addEventListener(events.beforeDataBound, this.refreshFilterValueFn);\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n\n\n  Filter.prototype.removeEventListener = function () {\n    EventHandler.remove(document, 'click', this.docClickHandler);\n    EventHandler.remove(this.parent.element, 'mousedown', this.refreshClearIcon);\n\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off(events.setFullScreenDialog, this.setFullScreenDialog);\n    this.parent.off(events.uiUpdate, this.enableAfterRender);\n    this.parent.off(events.filterComplete, this.onActionComplete);\n    this.parent.off(events.inBoundModelChanged, this.onPropertyChanged);\n    this.parent.off(events.keyPressed, this.keyUpHandler);\n    this.parent.off(events.columnPositionChanged, this.columnPositionChanged);\n    this.parent.off(events.headerRefreshed, this.render);\n    this.parent.off(events.filterOpen, this.columnMenuFilter);\n    this.parent.off(events.filterMenuClose, this.filterMenuClose);\n    this.parent.off(events.click, this.filterIconClickHandler);\n    this.parent.off(events.closeFilterDialog, this.clickHandler);\n    this.parent.off(events.destroy, this.destroy);\n  };\n\n  Filter.prototype.refreshClearIcon = function (e) {\n    if (this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar' && e.target.closest('th') && e.target.closest('th').classList.contains('e-filterbarcell') && e.target.classList.contains('e-clear-icon')) {\n      var targetText = e.target.previousElementSibling;\n      Input.setValue(null, targetText, 'Never', true);\n\n      if (this.filterSettings.mode === 'Immediate') {\n        this.removeFilteredColsByField(targetText.id.slice(0, -14)); //Length of _filterBarcell = 14\n      }\n    }\n  };\n\n  Filter.prototype.filterMenuClose = function () {\n    this.fltrDlgDetails.isOpen = false;\n  };\n  /**\n   * Filters the Grid row by fieldName, filterOperator, and filterValue.\n   *\n   * @param  {string} fieldName - Defines the field name of the filter column.\n   * @param  {string} filterOperator - Defines the operator to filter records.\n   * @param  {string | number | Date | boolean} filterValue - Defines the value which is used to filter records.\n   * @param  {string} predicate - Defines the relationship of one filter query with another by using AND or OR predicate.\n   * @param  {boolean} matchCase - If match case is set to true, then the filter records\n   * the exact match or <br> filters records that are case insensitive (uppercase and lowercase letters treated the same).\n   * @param {boolean} ignoreAccent - If ignoreAccent set to true, then filter ignores the diacritic characters or accents while filtering.\n   * @param  {string} actualFilterValue - Defines the actual filter value for the filter column.\n   * @param  {string} actualOperator - Defines the actual filter operator for the filter column.\n   * @returns {void}\n   */\n\n\n  Filter.prototype.filterByColumn = function (fieldName, filterOperator, filterValue, predicate, matchCase, ignoreAccent, actualFilterValue, actualOperator) {\n    var _this = this;\n\n    var gObj = this.parent;\n    var filterCell;\n    this.column = gObj.grabColumnByFieldFromAllCols(fieldName);\n\n    if (this.filterSettings.type === 'FilterBar' && this.filterSettings.showFilterBarOperator && isNullOrUndefined(this.column.filterBarTemplate) && isNullOrUndefined(this.column.filterTemplate)) {\n      filterOperator = this.getOperatorName(fieldName);\n    }\n\n    if (!this.column) {\n      return;\n    }\n\n    if (this.filterSettings.type === 'FilterBar') {\n      filterCell = gObj.getHeaderContent().querySelector('[id=\\'' + this.column.field + '_filterBarcell\\']');\n    }\n\n    if (!isNullOrUndefined(this.column.allowFiltering) && !this.column.allowFiltering) {\n      this.parent.log('action_disabled_column', {\n        moduleName: this.getModuleName(),\n        columnName: this.column.headerText\n      });\n      return;\n    }\n\n    if (isActionPrevent(gObj)) {\n      gObj.notify(events.preventBatch, {\n        instance: this,\n        handler: this.filterByColumn,\n        arg1: fieldName,\n        arg2: filterOperator,\n        arg3: filterValue,\n        arg4: predicate,\n        arg5: matchCase,\n        arg6: ignoreAccent,\n        arg7: actualFilterValue,\n        arg8: actualOperator\n      });\n      return;\n    }\n\n    this.predicate = predicate ? predicate : Array.isArray(filterValue) ? 'or' : 'and';\n    this.value = filterValue;\n    this.matchCase = matchCase || false;\n    this.ignoreAccent = this.ignoreAccent = !isNullOrUndefined(ignoreAccent) ? ignoreAccent : this.parent.filterSettings.ignoreAccent;\n    this.fieldName = fieldName;\n    this.operator = filterOperator;\n    filterValue = !isNullOrUndefined(filterValue) ? filterValue.toString() : filterValue;\n\n    if (filterValue === '') {\n      filterValue = null;\n    }\n\n    if (this.column.type === 'number' || this.column.type === 'date') {\n      this.matchCase = true;\n    }\n\n    gObj.getColumnHeaderByField(fieldName).setAttribute('aria-filtered', 'true');\n\n    if (filterCell && this.filterSettings.type === 'FilterBar') {\n      if (filterValue && filterValue.length < 1 || !this.filterByMethod && this.checkForSkipInput(this.column, filterValue)) {\n        this.filterStatusMsg = filterValue && filterValue.length < 1 ? '' : this.l10n.getConstant('InvalidFilterMessage');\n        this.updateFilterMsg();\n        return;\n      }\n\n      if (filterCell.value !== filterValue) {\n        filterCell.value = filterValue;\n      }\n    }\n\n    if (!isNullOrUndefined(this.column.format)) {\n      this.applyColumnFormat(filterValue);\n\n      if (this.initialLoad && this.filterSettings.type === 'FilterBar') {\n        filterCell.value = this.values[this.column.field];\n      }\n    } else {\n      this.values[this.column.field] = filterValue; //this line should be above updateModel\n    }\n\n    var predObj = {\n      field: this.fieldName,\n      predicate: predicate,\n      matchCase: matchCase,\n      ignoreAccent: ignoreAccent,\n      operator: this.operator,\n      value: this.value,\n      type: this.column.type\n    };\n    var filterColumn = this.parent.filterSettings.columns.filter(function (fColumn) {\n      return fColumn.field === _this.fieldName;\n    });\n\n    if (filterColumn.length > 1 && !isNullOrUndefined(this.actualPredicate[this.fieldName])) {\n      this.actualPredicate[this.fieldName].push(predObj);\n    } else {\n      this.actualPredicate[this.fieldName] = [predObj];\n    }\n\n    if (this.checkAlreadyColFiltered(this.column.field)) {\n      return;\n    }\n\n    this.updateModel();\n  };\n\n  Filter.prototype.applyColumnFormat = function (filterValue) {\n    var _this = this;\n\n    var getFlvalue = this.column.type === 'date' || this.column.type === 'datetime' ? new Date(filterValue) : parseFloat(filterValue);\n\n    if ((this.column.type === 'date' || this.column.type === 'datetime') && filterValue && filterValue.split(',').length > 1) {\n      this.values[this.column.field] = filterValue.split(',').map(function (val) {\n        if (val === '') {\n          val = null;\n        }\n\n        return _this.setFormatForFlColumn(new Date(val), _this.column);\n      });\n    } else {\n      this.values[this.column.field] = this.setFormatForFlColumn(getFlvalue, this.column);\n    }\n  }; // To skip the second time request to server while applying initial filtering - EJ2-44361\n\n\n  Filter.prototype.skipUid = function (col) {\n    var flag = true;\n    var colLen = Object.keys(col);\n\n    for (var i = 0; i < colLen.length; i++) {\n      var key = Object.keys(col[colLen[i]]);\n\n      if (key.length === 1 && key[0] === 'uid') {\n        flag = false;\n      }\n    }\n\n    return flag;\n  };\n\n  Filter.prototype.onPropertyChanged = function (e) {\n    if (e.module !== this.getModuleName()) {\n      return;\n    }\n\n    for (var _i = 0, _a = Object.keys(e.properties); _i < _a.length; _i++) {\n      var prop = _a[_i];\n\n      switch (prop) {\n        case 'columns':\n          // eslint-disable-next-line no-case-declarations\n          var col = 'columns'; // eslint-disable-next-line no-case-declarations\n\n          var args = {\n            currentFilterObject: this.currentFilterObject,\n            currentFilteringColumn: this.column ? this.column.field : undefined,\n            action: 'filter',\n            columns: this.filterSettings.columns,\n            requestType: 'filtering',\n            type: events.actionBegin,\n            cancel: false\n          };\n\n          if (this.contentRefresh && this.skipUid(e.properties[col])) {\n            this.parent.notify(events.modelChanged, args);\n\n            if (args.cancel) {\n              if (isNullOrUndefined(this.prevFilterObject)) {\n                this.filterSettings.columns.splice(this.filterSettings.columns.length - 1, 1);\n              } else {\n                this.filterSettings.columns[this.filterObjIndex] = this.prevFilterObject;\n              }\n\n              return;\n            }\n\n            this.updateFilterIcon();\n            this.refreshFilterSettings();\n            this.updateFilterMsg();\n            this.updateFilter();\n          }\n\n          break;\n\n        case 'showFilterBarStatus':\n          if (e.properties[prop]) {\n            this.updateFilterMsg();\n          } else if (this.parent.allowPaging) {\n            this.parent.updateExternalMessage('');\n          }\n\n          break;\n\n        case 'showFilterBarOperator':\n        case 'type':\n          this.parent.refreshHeader();\n          this.refreshFilterSettings();\n          break;\n      }\n    }\n  };\n\n  Filter.prototype.refreshFilterSettings = function () {\n    if (this.filterSettings.type === 'FilterBar') {\n      for (var i = 0; i < this.filterSettings.columns.length; i++) {\n        this.column = this.parent.grabColumnByUidFromAllCols(this.filterSettings.columns[i].uid);\n        var filterValue = this.filterSettings.columns[i].value;\n        filterValue = !isNullOrUndefined(filterValue) && filterValue.toString();\n\n        if (!isNullOrUndefined(this.column.format)) {\n          this.applyColumnFormat(filterValue);\n        } else {\n          var key = this.filterSettings.columns[i].field;\n          this.values[key] = this.filterSettings.columns[i].value;\n        }\n\n        var filterElement = this.getFilterBarElement(this.column.field);\n\n        if (filterElement) {\n          if (this.cellText[this.filterSettings.columns[i].field] !== '' && !isNullOrUndefined(this.cellText[this.filterSettings.columns[i].field])) {\n            filterElement.value = this.cellText[this.column.field];\n          } else {\n            filterElement.value = this.filterSettings.columns[i].value;\n          }\n        }\n      }\n\n      if (this.filterSettings.columns.length === 0) {\n        var col = this.parent.getColumns();\n\n        for (var i = 0; i < col.length; i++) {\n          var filterElement = this.getFilterBarElement(col[i].field);\n\n          if (filterElement && filterElement.value !== '') {\n            filterElement.value = '';\n            delete this.values[col[i].field];\n          }\n        }\n      }\n    }\n  };\n\n  Filter.prototype.updateFilterIcon = function () {\n    if (this.filterSettings.columns.length === 0 && this.parent.element.querySelector('.e-filtered')) {\n      var fltrIconElement = [].slice.call(this.parent.element.getElementsByClassName('e-filtered'));\n\n      for (var i = 0, len = fltrIconElement.length; i < len; i++) {\n        fltrIconElement[i].removeAttribute('aria-filtered');\n        fltrIconElement[i].classList.remove('e-filtered');\n      }\n    }\n  };\n\n  Filter.prototype.getFilterBarElement = function (col) {\n    var selector = '[id=\\'' + col + '_filterBarcell\\']';\n    var filterElement;\n\n    if (selector && !isNullOrUndefined(this.element)) {\n      filterElement = this.element.querySelector(selector);\n    }\n\n    return filterElement;\n  };\n  /**\n   * @private\n   * @returns {void}\n   */\n\n\n  Filter.prototype.refreshFilter = function () {\n    this.refreshFilterSettings();\n    this.updateFilterMsg();\n  };\n  /**\n   * Clears all the filtered rows of the Grid.\n   *\n   * @param {string[]} fields - returns the fields\n   * @returns {void}\n   */\n\n\n  Filter.prototype.clearFiltering = function (fields) {\n    var _this = this;\n\n    var cols = getActualPropFromColl(this.filterSettings.columns);\n\n    if (!isNullOrUndefined(fields)) {\n      this.refresh = false;\n      fields.forEach(function (field) {\n        _this.removeFilteredColsByField(field, false);\n      });\n      this.parent.setProperties({\n        filterSettings: {\n          columns: this.filterSettings.columns\n        }\n      }, true);\n      this.parent.renderModule.refresh();\n      this.refresh = true;\n      return;\n    }\n\n    if (isActionPrevent(this.parent)) {\n      this.parent.notify(events.preventBatch, {\n        instance: this,\n        handler: this.clearFiltering\n      });\n      return;\n    }\n\n    for (var i = 0; i < cols.length; i++) {\n      cols[i].uid = cols[i].uid || this.parent.getColumnByField(cols[i].field).uid;\n    }\n\n    var colUid = cols.map(function (f) {\n      return f.uid;\n    });\n    var filteredcols = colUid.filter(function (item, pos) {\n      return colUid.indexOf(item) === pos;\n    });\n    this.refresh = false;\n\n    for (var i = 0, len = filteredcols.length; i < len; i++) {\n      this.removeFilteredColsByField(this.parent.getColumnByUid(filteredcols[i]).field, false);\n    }\n\n    this.refresh = true;\n\n    if (filteredcols.length) {\n      this.parent.renderModule.refresh();\n    }\n\n    if (this.parent.filterSettings.columns.length === 0 && this.parent.element.querySelector('.e-filtered')) {\n      var fltrElement = [].slice.call(this.parent.element.getElementsByClassName('e-filtered'));\n\n      for (var i = 0, len = fltrElement.length; i < len; i++) {\n        fltrElement[0].removeAttribute('aria-filtered');\n        fltrElement[0].classList.remove('e-filtered');\n      }\n    }\n\n    this.isRemove = true;\n    this.filterStatusMsg = '';\n    this.updateFilterMsg();\n  };\n\n  Filter.prototype.checkAlreadyColFiltered = function (field) {\n    var columns = this.filterSettings.columns;\n\n    for (var _i = 0, columns_1 = columns; _i < columns_1.length; _i++) {\n      var col = columns_1[_i];\n\n      if (col.field === field && col.value === this.value && col.operator === this.operator && col.predicate === this.predicate) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  Filter.prototype.columnMenuFilter = function (args) {\n    this.column = args.col;\n    var ele = closest(args.target, '#' + args.id);\n\n    if (args.isClose && !ele) {\n      this.filterModule.closeDialog();\n    } else if (ele) {\n      this.filterDialogOpen(this.column, args.target);\n    }\n  };\n\n  Filter.prototype.filterDialogOpen = function (col, target, left, top) {\n    if (this.filterModule) {\n      this.filterModule.closeDialog();\n    }\n\n    this.setFilterModel(col);\n    this.filterModule.openDialog(this.createOptions(col, target, left, top));\n  };\n  /**\n   * Create filter dialog options\n   *\n   * @param  {Column} col - Filtering column detail.\n   * @param  {Element} target -  Filter dialog target.\n   * @param  {number} left -  Filter dialog left position.\n   * @param  {number} top -  Filter dialog top position.\n   * @returns {Object} returns the created dialog options\n   * @hidden\n   */\n\n\n  Filter.prototype.createOptions = function (col, target, left, top) {\n    var gObj = this.parent;\n    var dataSource = col.filter.dataSource || gObj.dataSource && 'result' in gObj.dataSource ? gObj.dataSource : gObj.getDataModule().dataManager;\n    var type = col.filter.type || this.parent.filterSettings.type;\n    var options = {\n      type: col.type,\n      field: col.field,\n      displayName: col.headerText,\n      dataSource: dataSource,\n      format: col.format,\n      height: 800,\n      columns: gObj.getColumns(),\n      filteredColumns: gObj.filterSettings.columns,\n      target: target,\n      dataManager: gObj.getDataModule().dataManager,\n      formatFn: col.getFormatter(),\n      ignoreAccent: gObj.filterSettings.ignoreAccent,\n      parserFn: col.getParser(),\n      query: gObj.query,\n      template: col.getFilterItemTemplate(),\n      hideSearchbox: isNullOrUndefined(col.filter.hideSearchbox) ? false : col.filter.hideSearchbox,\n      handler: this.filterHandler.bind(this),\n      localizedStrings: gObj.getLocaleConstants(),\n      position: {\n        X: left,\n        Y: top\n      },\n      column: col,\n      foreignKeyValue: col.foreignKeyValue,\n      actualPredicate: this.actualPredicate,\n      localeObj: gObj.localeObj,\n      isRemote: gObj.getDataModule().isRemote(),\n      allowCaseSensitive: this.filterSettings.enableCaseSensitivity,\n      isResponsiveFilter: this.parent.enableAdaptiveUI,\n      operator: this.actualPredicate[col.field] && type === 'Menu' ? this.actualPredicate[col.field][0].operator : 'equal'\n    };\n    return options;\n  };\n  /**\n   * Removes filtered column by field name.\n   *\n   * @param  {string} field - Defines column field name to remove filter.\n   * @param  {boolean} isClearFilterBar - Specifies whether the filter bar value needs to be cleared.\n   * @returns {void}\n   * @hidden\n   */\n\n\n  Filter.prototype.removeFilteredColsByField = function (field, isClearFilterBar) {\n    var fCell;\n    var cols = this.filterSettings.columns;\n\n    if (isActionPrevent(this.parent)) {\n      var args = {\n        instance: this,\n        handler: this.removeFilteredColsByField,\n        arg1: field,\n        arg2: isClearFilterBar\n      };\n      this.parent.notify(events.preventBatch, args);\n      return;\n    }\n\n    var colUid = cols.map(function (f) {\n      return f.uid;\n    });\n    var filteredColsUid = colUid.filter(function (item, pos) {\n      return colUid.indexOf(item) === pos;\n    });\n\n    var _loop_1 = function (i, len) {\n      cols[i].uid = cols[i].uid || this_1.parent.getColumnByField(cols[i].field).uid;\n      var len_1 = cols.length;\n      var column = this_1.parent.grabColumnByUidFromAllCols(filteredColsUid[i]);\n\n      if (column.field === field || column.field === column.foreignKeyValue && column.isForeignColumn()) {\n        var currentPred = this_1.filterSettings.columns.filter(function (e) {\n          return e.uid === column.uid;\n        })[0];\n\n        if (this_1.filterSettings.type === 'FilterBar' && !isClearFilterBar) {\n          var selector = '[id=\\'' + column.field + '_filterBarcell\\']';\n          fCell = this_1.parent.getHeaderContent().querySelector(selector);\n\n          if (fCell) {\n            fCell.value = '';\n            delete this_1.values[field];\n          }\n        }\n\n        while (len_1--) {\n          if (cols[len_1].uid === column.uid) {\n            cols.splice(len_1, 1);\n          }\n        }\n\n        var fltrElement = this_1.parent.getColumnHeaderByField(column.field);\n        fltrElement.removeAttribute('aria-filtered');\n\n        if (this_1.filterSettings.type !== 'FilterBar') {\n          var iconClass = this_1.parent.showColumnMenu && column.showColumnMenu ? '.e-columnmenu' : '.e-icon-filter';\n          fltrElement.querySelector(iconClass).classList.remove('e-filtered');\n        }\n\n        this_1.isRemove = true;\n\n        if (this_1.actualPredicate[field]) {\n          delete this_1.actualPredicate[field];\n        }\n\n        if (this_1.values[field]) {\n          delete this_1.values[field];\n        }\n\n        if (this_1.refresh) {\n          this_1.parent.notify(events.modelChanged, {\n            requestType: 'filtering',\n            type: events.actionBegin,\n            currentFilterObject: currentPred,\n            currentFilterColumn: column,\n            action: 'clearFilter'\n          });\n        }\n\n        return \"break\";\n      }\n    };\n\n    var this_1 = this;\n\n    for (var i = 0, len = filteredColsUid.length; i < len; i++) {\n      var state_1 = _loop_1(i, len);\n\n      if (state_1 === \"break\") break;\n    }\n\n    this.updateFilterMsg();\n  };\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {string} returns the module name\n   * @private\n   */\n\n\n  Filter.prototype.getModuleName = function () {\n    return 'filter';\n  };\n\n  Filter.prototype.keyUpHandlerImmediate = function (e) {\n    if (e.keyCode !== 13) {\n      this.keyUpHandler(e);\n    }\n  };\n\n  Filter.prototype.keyUpHandler = function (e) {\n    var gObj = this.parent;\n    var target = e.target;\n\n    if (target && matches(target, '.e-filterbar input')) {\n      var closeHeaderEle = closest(target, 'th.e-filterbarcell');\n      this.column = gObj.getColumnByUid(closeHeaderEle.getAttribute('e-mappinguid'));\n\n      if (!this.column) {\n        return;\n      }\n\n      if (e.action === 'altDownArrow' && this.parent.filterSettings.showFilterBarOperator) {\n        var dropDownListInput = closest(target, 'span').querySelector('.e-filterbaroperator');\n        dropDownListInput.ej2_instances[0].showPopup();\n        dropDownListInput.focus();\n      }\n\n      if ((this.filterSettings.mode === 'Immediate' || e.keyCode === 13 && !e.target.classList.contains('e-filterbaroperator')) && e.keyCode !== 9 && !this.column.filterTemplate) {\n        this.value = target.value.trim();\n        this.processFilter(e);\n      }\n    }\n\n    if (e.action === 'altDownArrow' && this.filterSettings.type !== 'FilterBar') {\n      var element = gObj.focusModule.currentInfo.element;\n\n      if (element && element.classList.contains('e-headercell')) {\n        var column = gObj.getColumnByUid(element.firstElementChild.getAttribute('e-mappinguid'));\n        this.openMenuByField(column.field);\n        this.parent.focusModule.clearIndicator();\n      }\n    }\n\n    if (e.action === 'escape' && this.filterSettings.type === 'Menu' && this.filterModule) {\n      this.filterModule.closeDialog();\n      gObj.notify(events.restoreFocus, {});\n    }\n  };\n\n  Filter.prototype.updateCrossIcon = function (element) {\n    if (element.value.length) {\n      element.nextElementSibling.classList.remove('e-hide');\n    }\n  };\n\n  Filter.prototype.updateFilterMsg = function () {\n    if (this.filterSettings.type === 'FilterBar') {\n      var gObj = this.parent;\n      var getFormatFlValue = void 0;\n      var columns = this.filterSettings.columns;\n      var column = void 0;\n\n      if (!this.filterSettings.showFilterBarStatus) {\n        return;\n      }\n\n      if (columns.length > 0 && this.filterStatusMsg !== this.l10n.getConstant('InvalidFilterMessage')) {\n        this.filterStatusMsg = '';\n\n        for (var index = 0; index < columns.length; index++) {\n          column = gObj.grabColumnByUidFromAllCols(columns[index].uid) || gObj.grabColumnByFieldFromAllCols(columns[index].field);\n\n          if (index) {\n            this.filterStatusMsg += ' && ';\n          }\n\n          if (!isNullOrUndefined(column.format)) {\n            var flValue = column.type === 'date' || column.type === 'datetime' ? this.valueFormatter.fromView(this.values[column.field], column.getParser(), column.type) : this.values[column.field];\n\n            if (!(column.type === 'date' || column.type === 'datetime')) {\n              var formater = this.serviceLocator.getService('valueFormatter');\n              getFormatFlValue = formater.toView(flValue, column.getParser()).toString();\n            } else {\n              getFormatFlValue = this.setFormatForFlColumn(flValue, column);\n            }\n\n            this.filterStatusMsg += column.headerText + ': ' + getFormatFlValue;\n          } else {\n            this.filterStatusMsg += column.headerText + ': ' + this.values[column.field];\n          }\n        }\n      }\n\n      if (gObj.allowPaging) {\n        gObj.updateExternalMessage(this.filterStatusMsg);\n      } //TODO: virtual paging\n\n\n      this.filterStatusMsg = '';\n    }\n  };\n\n  Filter.prototype.setFormatForFlColumn = function (value, column) {\n    var formater = this.serviceLocator.getService('valueFormatter');\n    return formater.toView(value, column.getFormatter()).toString();\n  };\n\n  Filter.prototype.checkForSkipInput = function (column, value) {\n    var isSkip;\n\n    if (column.type === 'number') {\n      if (DataUtil.operatorSymbols[value] || this.skipNumberInput.indexOf(value) > -1) {\n        isSkip = true;\n      }\n    } else if (column.type === 'string') {\n      for (var _i = 0, value_1 = value; _i < value_1.length; _i++) {\n        var val = value_1[_i];\n\n        if (this.skipStringInput.indexOf(val) > -1) {\n          isSkip = true;\n        }\n      }\n    }\n\n    return isSkip;\n  };\n\n  Filter.prototype.processFilter = function (e) {\n    this.stopTimer();\n    this.startTimer(e);\n  };\n\n  Filter.prototype.startTimer = function (e) {\n    var _this = this;\n\n    this.timer = window.setInterval(function () {\n      _this.onTimerTick();\n    }, e.keyCode === 13 ? 0 : this.filterSettings.immediateModeDelay);\n  };\n\n  Filter.prototype.stopTimer = function () {\n    window.clearInterval(this.timer);\n  };\n\n  Filter.prototype.onTimerTick = function () {\n    var selector = '[id=\\'' + this.column.field + '_filterBarcell\\']';\n    var filterElement = this.element.querySelector(selector);\n\n    if (!filterElement && this.parent.isFrozenGrid()) {\n      filterElement = this.parent.getHeaderContent().querySelector(selector);\n    }\n\n    var filterValue;\n    this.cellText[this.column.field] = filterElement.value;\n    this.stopTimer();\n\n    if (!isNullOrUndefined(this.column.filterBarTemplate)) {\n      var templateRead = this.column.filterBarTemplate.read;\n\n      if (typeof templateRead === 'string') {\n        templateRead = getValue(templateRead, window);\n      }\n\n      if (!isNullOrUndefined(templateRead)) {\n        this.value = templateRead.call(this, filterElement);\n      }\n    } else {\n      filterValue = JSON.parse(JSON.stringify(filterElement.value));\n    }\n\n    if (isNullOrUndefined(this.value) || this.value === '') {\n      this.removeFilteredColsByField(this.column.field);\n      return;\n    }\n\n    this.validateFilterValue(this.value);\n    this.filterByMethod = false;\n    this.filterByColumn(this.column.field, this.operator, this.value, this.predicate, this.filterSettings.enableCaseSensitivity, this.ignoreAccent);\n    this.filterByMethod = true;\n    filterElement.value = filterValue;\n    this.updateFilterMsg();\n  };\n\n  Filter.prototype.validateFilterValue = function (value) {\n    var skipInput;\n    var index;\n    this.matchCase = this.filterSettings.enableCaseSensitivity;\n\n    switch (this.column.type) {\n      case 'number':\n        if (this.column.filter.operator) {\n          this.operator = this.column.filter.operator;\n        } else {\n          this.operator = this.filterOperators.equal;\n        }\n\n        skipInput = ['>', '<', '=', '!'];\n\n        for (var i = 0; i < value.length; i++) {\n          if (skipInput.indexOf(value[i]) > -1) {\n            index = i;\n            break;\n          }\n        }\n\n        this.getOperator(value.substring(index));\n\n        if (index !== 0) {\n          this.value = value.substring(0, index);\n        }\n\n        if (this.value !== '' && value.length >= 1) {\n          this.value = this.valueFormatter.fromView(this.value, this.column.getParser(), this.column.type);\n        }\n\n        if (isNaN(this.value)) {\n          this.filterStatusMsg = this.l10n.getConstant('InvalidFilterMessage');\n        }\n\n        break;\n\n      case 'date':\n      case 'datetime':\n        this.operator = this.filterOperators.equal;\n\n        if (this.value !== '' && !(this.value instanceof Date)) {\n          this.getOperator(value);\n          this.value = this.valueFormatter.fromView(this.value, this.column.getParser(), this.column.type);\n\n          if (isNullOrUndefined(this.value)) {\n            this.filterStatusMsg = this.l10n.getConstant('InvalidFilterMessage');\n          }\n        }\n\n        break;\n\n      case 'string':\n        this.matchCase = false;\n\n        if (value.charAt(0) === '*') {\n          this.value = this.value.slice(1);\n          this.operator = this.filterOperators.startsWith;\n        } else if (value.charAt(value.length - 1) === '%') {\n          this.value = this.value.slice(0, -1);\n          this.operator = this.filterOperators.startsWith;\n        } else if (value.charAt(0) === '%') {\n          this.value = this.value.slice(1);\n          this.operator = this.filterOperators.endsWith;\n        } else {\n          if (this.column.filter.operator) {\n            this.operator = this.column.filter.operator;\n          } else {\n            this.operator = this.filterOperators.startsWith;\n          }\n        }\n\n        break;\n\n      case 'boolean':\n        if (value.toLowerCase() === 'true' || value === '1') {\n          this.value = true;\n        } else if (value.toLowerCase() === 'false' || value === '0') {\n          this.value = false;\n        } else if (value.length) {\n          this.filterStatusMsg = this.l10n.getConstant('InvalidFilterMessage');\n        }\n\n        this.operator = this.filterOperators.equal;\n        break;\n\n      default:\n        if (this.column.filter.operator) {\n          this.operator = this.column.filter.operator;\n        } else {\n          this.operator = this.filterOperators.equal;\n        }\n\n    }\n  };\n\n  Filter.prototype.getOperator = function (value) {\n    var singleOp = value.charAt(0);\n    var multipleOp = value.slice(0, 2);\n    var operators = extend({\n      '=': this.filterOperators.equal,\n      '!': this.filterOperators.notEqual\n    }, DataUtil.operatorSymbols); // eslint-disable-next-line no-prototype-builtins\n\n    if (operators.hasOwnProperty(singleOp) || operators.hasOwnProperty(multipleOp)) {\n      this.operator = operators[singleOp];\n      this.value = value.substring(1);\n\n      if (!this.operator) {\n        this.operator = operators[multipleOp];\n        this.value = value.substring(2);\n      }\n    }\n\n    if (this.operator === this.filterOperators.lessThan || this.operator === this.filterOperators.greaterThan) {\n      if (this.value.charAt(0) === '=') {\n        this.operator = this.operator + 'orequal';\n        this.value = this.value.substring(1);\n      }\n    }\n  };\n\n  Filter.prototype.columnPositionChanged = function () {\n    if (this.parent.filterSettings.type !== 'FilterBar') {\n      return;\n    }\n  };\n\n  Filter.prototype.getLocalizedCustomOperators = function () {\n    var numOptr = [{\n      value: 'equal',\n      text: this.l10n.getConstant('Equal')\n    }, {\n      value: 'greaterthan',\n      text: this.l10n.getConstant('GreaterThan')\n    }, {\n      value: 'greaterthanorequal',\n      text: this.l10n.getConstant('GreaterThanOrEqual')\n    }, {\n      value: 'lessthan',\n      text: this.l10n.getConstant('LessThan')\n    }, {\n      value: 'lessthanorequal',\n      text: this.l10n.getConstant('LessThanOrEqual')\n    }, {\n      value: 'notequal',\n      text: this.l10n.getConstant('NotEqual')\n    }];\n    this.customOperators = {\n      stringOperator: [{\n        value: 'startswith',\n        text: this.l10n.getConstant('StartsWith')\n      }, {\n        value: 'endswith',\n        text: this.l10n.getConstant('EndsWith')\n      }, {\n        value: 'contains',\n        text: this.l10n.getConstant('Contains')\n      }, {\n        value: 'equal',\n        text: this.l10n.getConstant('Equal')\n      }, {\n        value: 'notequal',\n        text: this.l10n.getConstant('NotEqual')\n      }],\n      numberOperator: numOptr,\n      dateOperator: numOptr,\n      datetimeOperator: numOptr,\n      booleanOperator: [{\n        value: 'equal',\n        text: this.l10n.getConstant('Equal')\n      }, {\n        value: 'notequal',\n        text: this.l10n.getConstant('NotEqual')\n      }]\n    };\n  };\n  /**\n   * @param {string} field - specifies the field name\n   * @returns {void}\n   * @hidden\n   */\n\n\n  Filter.prototype.openMenuByField = function (field) {\n    var gObj = this.parent;\n\n    if (gObj.enableAdaptiveUI) {\n      this.showCustomFilter(false);\n      return;\n    }\n\n    var column = gObj.getColumnByField(field);\n    var header = gObj.getColumnHeaderByField(field);\n    var target = header.querySelector('.e-filtermenudiv');\n\n    if (!target) {\n      return;\n    }\n\n    var gClient = gObj.element.getBoundingClientRect();\n    var fClient = target.getBoundingClientRect();\n    this.filterDialogOpen(column, target, fClient.right - gClient.left, fClient.bottom - gClient.top);\n  };\n\n  Filter.prototype.filterIconClickHandler = function (e) {\n    var target = e.target;\n\n    if (target.classList.contains('e-filtermenudiv') && (this.parent.filterSettings.type === 'Menu' || this.parent.filterSettings.type === 'CheckBox' || this.parent.filterSettings.type === 'Excel')) {\n      var gObj = this.parent;\n      var col = gObj.getColumnByUid(parentsUntil(target, 'e-headercell').firstElementChild.getAttribute('e-mappinguid'));\n      this.column = col;\n\n      if (this.fltrDlgDetails.field === col.field && this.fltrDlgDetails.isOpen) {\n        return;\n      }\n\n      if (this.filterModule) {\n        this.filterModule.closeDialog();\n      }\n\n      this.fltrDlgDetails = {\n        field: col.field,\n        isOpen: true\n      };\n      this.openMenuByField(col.field);\n    }\n  };\n\n  Filter.prototype.clickHandler = function (e) {\n    if (this.filterSettings.type === 'FilterBar' && this.filterSettings.showFilterBarOperator) {\n      if (parentsUntil(e.target, 'e-filterbarcell') && e.target.classList.contains('e-input-group-icon')) {\n        var filterOperatorElement = closest(e.target, 'div').querySelector('.e-filterbaroperator');\n\n        if (filterOperatorElement) {\n          filterOperatorElement.focus();\n        } else {\n          e.target.focus();\n        }\n      }\n\n      if (e.target.classList.contains('e-list-item')) {\n        var inputId = document.querySelector('.e-popup-open').getAttribute('id').replace('_popup', '');\n\n        if (inputId.indexOf('grid-column') !== -1) {\n          closest(document.getElementById(inputId), 'div').querySelector('.e-filtertext').focus();\n        }\n      }\n    }\n\n    if (this.filterSettings.mode === 'Immediate' || this.parent.filterSettings.type === 'Menu' || this.parent.filterSettings.type === 'CheckBox' || this.parent.filterSettings.type === 'Excel') {\n      var target = e.target;\n      var datepickerEle = target.classList.contains('e-day'); // due to datepicker popup cause\n\n      var dialog = parentsUntil(this.parent.element, 'e-dialog');\n      var hasDialog = false;\n      var popupEle = parentsUntil(target, 'e-popup');\n      var hasDialogClosed = this.parent.element.querySelector('.e-filter-popup');\n\n      if (dialog && popupEle) {\n        hasDialog = dialog.id === popupEle.id;\n      }\n\n      if (hasDialogClosed && (parentsUntil(target, 'e-excel-ascending') || parentsUntil(target, 'e-excel-descending'))) {\n        this.filterModule.closeDialog(target);\n      }\n\n      if (parentsUntil(target, 'e-filter-popup') || target.classList.contains('e-filtermenudiv')) {\n        return;\n      } else if (this.filterModule && !parentsUntil(target, 'e-popup-wrapper') && !closest(target, '.e-filter-item.e-menu-item') && !datepickerEle) {\n        if (hasDialog && !parentsUntil(target, 'e-filter-popup') && !parentsUntil(target, 'e-popup-flmenu') || !popupEle && hasDialogClosed) {\n          this.filterModule.isresetFocus = parentsUntil(target, 'e-grid') && parentsUntil(target, 'e-grid').id === this.parent.element.id;\n          this.filterModule.closeDialog(target);\n        }\n      }\n    }\n  };\n\n  Filter.prototype.filterHandler = function (args) {\n    this.actualPredicate[args.field] = args.actualPredicate;\n    var dataManager = new DataManager(this.filterSettings.columns);\n    var query = new Query().where('field', this.filterOperators.equal, args.field);\n    var result = dataManager.executeLocal(query);\n\n    for (var i = 0; i < result.length; i++) {\n      var index = -1;\n\n      for (var j = 0; j < this.filterSettings.columns.length; j++) {\n        if (result[i].field === this.filterSettings.columns[j].field) {\n          index = j;\n          break;\n        }\n      }\n\n      if (index !== -1) {\n        this.filterSettings.columns.splice(index, 1);\n      }\n    }\n\n    if (this.values[args.field]) {\n      delete this.values[args.field];\n    }\n\n    var col = this.parent.getColumnByField(args.field);\n    var iconClass = this.parent.showColumnMenu && col.showColumnMenu ? '.e-columnmenu' : '.e-icon-filter';\n    var filterIconElement = this.parent.getColumnHeaderByField(args.field).querySelector(iconClass);\n\n    if (args.action === 'filtering') {\n      this.filterSettings.columns = this.filterSettings.columns.concat(args.filterCollection);\n\n      if (this.filterSettings.columns.length && filterIconElement) {\n        filterIconElement.classList.add('e-filtered');\n      }\n    } else {\n      if (filterIconElement) {\n        filterIconElement.classList.remove('e-filtered');\n      }\n\n      args.requestType = 'filtering';\n      this.parent.renderModule.refresh(args); //hot-fix onpropertychanged not working for object { array }\n    }\n\n    this.parent.dataBind();\n  };\n\n  Filter.prototype.updateFilter = function () {\n    var cols = this.filterSettings.columns;\n    this.actualPredicate = {};\n\n    for (var i = 0; i < cols.length; i++) {\n      this.column = this.parent.getColumnByField(cols[i].field) || getColumnByForeignKeyValue(cols[i].field, this.parent.getForeignKeyColumns());\n      var fieldName = cols[i].field;\n\n      if (!this.parent.getColumnByField(cols[i].field)) {\n        fieldName = getColumnByForeignKeyValue(cols[i].field, this.parent.getForeignKeyColumns()).field;\n      }\n\n      this.refreshFilterIcon(fieldName, cols[i].operator, cols[i].value, cols[i].type, cols[i].predicate, cols[i].matchCase, cols[i].ignoreAccent, cols[i].uid);\n    }\n  };\n\n  Filter.prototype.refreshFilterIcon = function (fieldName, operator, value, type, predicate, matchCase, ignoreAccent, uid) {\n    var obj = {\n      field: fieldName,\n      predicate: predicate,\n      matchCase: matchCase,\n      ignoreAccent: ignoreAccent,\n      operator: operator,\n      value: value,\n      type: type\n    };\n\n    if (this.actualPredicate[fieldName]) {\n      this.actualPredicate[fieldName].push(obj);\n    } else {\n      this.actualPredicate[fieldName] = [obj];\n    }\n\n    var field = uid ? this.parent.grabColumnByUidFromAllCols(uid).field : fieldName;\n    this.addFilteredClass(field);\n  };\n\n  Filter.prototype.addFilteredClass = function (fieldName) {\n    var filterIconElement;\n    var col = this.parent.getColumnByField(fieldName);\n\n    if (this.parent.showColumnMenu && col.showColumnMenu) {\n      filterIconElement = this.parent.getColumnHeaderByField(fieldName).querySelector('.e-columnmenu');\n    } else if (col) {\n      filterIconElement = this.parent.getColumnHeaderByField(fieldName).querySelector('.e-icon-filter');\n    }\n\n    if (filterIconElement) {\n      filterIconElement.classList.add('e-filtered');\n    }\n  };\n  /**\n   * @hidden\n   * @returns {FilterUI} returns the FilterUI\n   */\n\n\n  Filter.prototype.getFilterUIInfo = function () {\n    return this.filterModule ? this.filterModule.getFilterUIInfo() : {};\n  };\n  /**\n   * @param {string} field - specifies the field name\n   * @returns {string} returns the operator name\n   * @hidden\n   */\n\n\n  Filter.prototype.getOperatorName = function (field) {\n    return document.getElementById(this.parent.getColumnByField(field).uid).ej2_instances[0].value;\n  };\n  /**\n   * Renders checkbox items in Menu filter dialog.\n   *\n   * @returns {void}\n   */\n\n\n  Filter.prototype.renderCheckboxOnFilterMenu = function () {\n    return this.filterModule.renderCheckBoxMenu();\n  };\n\n  return Filter;\n}();\n\nexport { Filter };","map":{"version":3,"names":["EventHandler","isNullOrUndefined","extend","closest","getValue","getActualPropFromColl","isActionPrevent","getColumnByForeignKeyValue","remove","matches","DataUtil","Query","DataManager","events","CellType","ResponsiveDialogAction","RowRenderer","Cell","Row","FilterCellRenderer","parentsUntil","FilterMenuRenderer","CheckBoxFilter","ExcelFilter","literals","Input","Filter","parent","filterSettings","serviceLocator","predicate","contentRefresh","filterByMethod","refresh","values","operators","cellText","nextFlMenuOpen","type","filterOperators","contains","endsWith","equal","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","notEqual","startsWith","fltrDlgDetails","field","isOpen","skipNumberInput","skipStringInput","actualPredicate","addEventListener","setFullScreenDialog","prototype","render","e","getObject","getFrozenMode","leftRight","gObj","l10n","getService","getLocalizedCustomOperators","columns","length","fltrElem","element","querySelector","rowRenderer","cellrender","addCellRenderer","valueFormatter","createElement","className","attrs","role","row","generateRow","data","thead","getFrozenRightHeader","appendChild","getHeaderContent","rowdrag","getColumns","detail","gCells","slice","call","getElementsByClassName","classList","add","wireEvents","notify","freezeRender","case","showCustomFilter","enable","responsiveDialogRenderer","isCustomDialog","showResponsiveDialog","column","setFilterModel","col","filter","filterModule","customOperators","destroy","gridElement","gridHeader","gridContent","refreshing","isDestroyed","allowFiltering","updateFilterMsg","removeEventListener","unWireEvents","showFilterBarOperator","dropdownlist","i","ej2_instances","parentElement","filterBarElement","isFrozenGrid","registerAdaptiveService","enableAdaptiveUI","isFilter","options","cells","generateCells","allowGrouping","c","len","groupSettings","push","generateCell","HeaderIndent","detailTemplate","childGrid","DetailHeader","isRowDragable","RowDragHIcon","_i","_a","dummy","cellType","opt","visible","title","getConstant","updateModel","getColumnByField","fieldName","filterObjIndex","getFilteredColsIndexByField","prevFilterObject","arrayVal","Array","isArray","value","moduleName","dataSource","adaptor","getModuleName","undefined","isForeignColumn","foreignKeyValue","isMenuNotEqual","operator","currentFilterObject","uid","isForeignKey","matchCase","ignoreAccent","actualFilterValue","actualOperator","index","dataBind","cols","getColumnByUid","onActionComplete","args","isRemove","currentFilteringColumn","requestType","actionComplete","trigger","keyUpHandlerImmediate","enableAfterRender","module","getHeaderTable","refreshFilterValue","beforeDataBound","refreshFilterValueFn","getCurrentViewRecords","initialEnd","off","contentReady","initialLoad","filterByColumn","on","uiUpdate","filterComplete","inBoundModelChanged","onPropertyChanged","keyPressed","keyUpHandler","columnPositionChanged","headerRefreshed","filterMenuClose","docClickHandler","clickHandler","bind","document","refreshClearIcon","filterOpen","columnMenuFilter","click","filterIconClickHandler","closeFilterDialog","target","targetText","previousElementSibling","setValue","mode","removeFilteredColsByField","id","filterOperator","filterValue","_this","filterCell","grabColumnByFieldFromAllCols","filterBarTemplate","filterTemplate","getOperatorName","log","columnName","headerText","preventBatch","instance","handler","arg1","arg2","arg3","arg4","arg5","arg6","arg7","arg8","toString","getColumnHeaderByField","setAttribute","checkForSkipInput","filterStatusMsg","format","applyColumnFormat","predObj","filterColumn","fColumn","checkAlreadyColFiltered","getFlvalue","Date","parseFloat","split","map","val","setFormatForFlColumn","skipUid","flag","colLen","Object","keys","key","properties","prop","action","actionBegin","cancel","modelChanged","splice","updateFilterIcon","refreshFilterSettings","updateFilter","allowPaging","updateExternalMessage","refreshHeader","grabColumnByUidFromAllCols","filterElement","getFilterBarElement","fltrIconElement","removeAttribute","selector","refreshFilter","clearFiltering","fields","forEach","setProperties","renderModule","colUid","f","filteredcols","item","pos","indexOf","fltrElement","columns_1","ele","isClose","closeDialog","filterDialogOpen","left","top","openDialog","createOptions","getDataModule","dataManager","displayName","height","filteredColumns","formatFn","getFormatter","parserFn","getParser","query","template","getFilterItemTemplate","hideSearchbox","filterHandler","localizedStrings","getLocaleConstants","position","X","Y","localeObj","isRemote","allowCaseSensitive","enableCaseSensitivity","isResponsiveFilter","isClearFilterBar","fCell","filteredColsUid","_loop_1","this_1","len_1","currentPred","iconClass","showColumnMenu","currentFilterColumn","state_1","keyCode","closeHeaderEle","getAttribute","dropDownListInput","showPopup","focus","trim","processFilter","focusModule","currentInfo","firstElementChild","openMenuByField","clearIndicator","restoreFocus","updateCrossIcon","nextElementSibling","getFormatFlValue","showFilterBarStatus","flValue","fromView","formater","toView","isSkip","operatorSymbols","value_1","stopTimer","startTimer","timer","window","setInterval","onTimerTick","immediateModeDelay","clearInterval","templateRead","read","JSON","parse","stringify","validateFilterValue","skipInput","getOperator","substring","isNaN","charAt","toLowerCase","singleOp","multipleOp","hasOwnProperty","numOptr","text","stringOperator","numberOperator","dateOperator","datetimeOperator","booleanOperator","header","gClient","getBoundingClientRect","fClient","right","bottom","filterOperatorElement","inputId","replace","getElementById","datepickerEle","dialog","hasDialog","popupEle","hasDialogClosed","isresetFocus","where","result","executeLocal","j","filterIconElement","concat","filterCollection","getForeignKeyColumns","refreshFilterIcon","obj","addFilteredClass","getFilterUIInfo","renderCheckboxOnFilterMenu","renderCheckBoxMenu"],"sources":["/home/morgan/Desktop/Projets/ENT4/Jwt-Auth-pdf/react-jwt-auth/react-jwt-auth/node_modules/@syncfusion/ej2-grids/src/grid/actions/filter.js"],"sourcesContent":["import { EventHandler, isNullOrUndefined, extend, closest, getValue } from '@syncfusion/ej2-base';\nimport { getActualPropFromColl, isActionPrevent, getColumnByForeignKeyValue } from '../base/util';\nimport { remove, matches } from '@syncfusion/ej2-base';\nimport { DataUtil, Query, DataManager } from '@syncfusion/ej2-data';\nimport * as events from '../base/constant';\nimport { CellType, ResponsiveDialogAction } from '../base/enum';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { Cell } from '../models/cell';\nimport { Row } from '../models/row';\nimport { FilterCellRenderer } from '../renderer/filter-cell-renderer';\nimport { parentsUntil } from '../base/util';\nimport { FilterMenuRenderer } from '../renderer/filter-menu-renderer';\nimport { CheckBoxFilter } from '../actions/checkbox-filter';\nimport { ExcelFilter } from '../actions/excel-filter';\nimport * as literals from '../base/string-literals';\nimport { Input } from '@syncfusion/ej2-inputs';\n/**\n *\n * The `Filter` module is used to handle filtering action.\n */\nvar Filter = /** @class */ (function () {\n    /**\n     * Constructor for Grid filtering module\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @param {FilterSettings} filterSettings - specifies the filterSettings\n     * @param {ServiceLocator} serviceLocator - specifes the serviceLocator\n     * @hidden\n     */\n    function Filter(parent, filterSettings, serviceLocator) {\n        this.predicate = 'and';\n        this.contentRefresh = true;\n        this.filterByMethod = true;\n        this.refresh = true;\n        this.values = {};\n        this.operators = {};\n        this.cellText = {};\n        this.nextFlMenuOpen = '';\n        this.type = { 'Menu': FilterMenuRenderer, 'CheckBox': CheckBoxFilter, 'Excel': ExcelFilter };\n        /** @hidden */\n        this.filterOperators = {\n            contains: 'contains', endsWith: 'endswith', equal: 'equal', greaterThan: 'greaterthan', greaterThanOrEqual: 'greaterthanorequal',\n            lessThan: 'lessthan', lessThanOrEqual: 'lessthanorequal', notEqual: 'notequal', startsWith: 'startswith'\n        };\n        this.fltrDlgDetails = { field: '', isOpen: false };\n        /** @hidden */\n        this.skipNumberInput = ['=', ' ', '!'];\n        this.skipStringInput = ['>', '<', '='];\n        this.actualPredicate = {};\n        this.parent = parent;\n        this.filterSettings = filterSettings;\n        this.serviceLocator = serviceLocator;\n        this.addEventListener();\n        this.setFullScreenDialog();\n    }\n    /**\n     * To render filter bar when filtering enabled.\n     *\n     * @param {NotifyArgs} e - specifies the NotifyArgs\n     * @returns {void}\n     * @hidden\n     */\n    Filter.prototype.render = function (e) {\n        if (DataUtil.getObject('args.isFrozen', e) || (this.parent.getFrozenMode() === literals.leftRight &&\n            DataUtil.getObject('args.renderFrozenRightContent', e))) {\n            return;\n        }\n        var gObj = this.parent;\n        this.l10n = this.serviceLocator.getService('localization');\n        this.getLocalizedCustomOperators();\n        if (this.parent.filterSettings.type === 'FilterBar') {\n            if (gObj.columns.length) {\n                var fltrElem = this.parent.element.querySelector('.e-filterbar');\n                if (fltrElem) {\n                    remove(fltrElem);\n                }\n                var rowRenderer = new RowRenderer(this.serviceLocator, CellType.Filter, gObj);\n                var cellrender = this.serviceLocator.getService('cellRendererFactory');\n                cellrender.addCellRenderer(CellType.Filter, new FilterCellRenderer(this.parent, this.serviceLocator));\n                this.valueFormatter = this.serviceLocator.getService('valueFormatter');\n                rowRenderer.element = this.parent.createElement('tr', { className: 'e-filterbar', attrs: { role: 'row' } });\n                var row = this.generateRow();\n                row.data = this.values;\n                if (gObj.getFrozenMode() === 'Right') {\n                    var thead = gObj.getFrozenRightHeader().querySelector('thead');\n                    thead.appendChild(rowRenderer.element);\n                }\n                else {\n                    this.parent.getHeaderContent().querySelector('thead').appendChild(rowRenderer.element);\n                }\n                var rowdrag = this.parent.element.querySelector('.e-rowdragheader');\n                this.element = rowRenderer.render(row, gObj.getColumns(), null, null, rowRenderer.element);\n                var detail = this.element.querySelector('.e-detailheadercell');\n                if (detail) {\n                    detail.className = 'e-filterbarcell e-mastercell';\n                }\n                if (rowdrag) {\n                    rowdrag.className = 'e-dragheadercell e-mastercell';\n                }\n                var gCells = [].slice.call(this.element.getElementsByClassName('e-grouptopleftcell'));\n                if (gCells.length) {\n                    gCells[gCells.length - 1].classList.add('e-lastgrouptopleftcell');\n                }\n                this.wireEvents();\n                this.parent.notify(events.freezeRender, { case: 'filter' });\n            }\n        }\n    };\n    /**\n     * To show the responsive custom filter dialog\n     *\n     * @param {boolean} enable - specifes dialog open\n     * @returns {void}\n     * @hidden\n     */\n    Filter.prototype.showCustomFilter = function (enable) {\n        this.responsiveDialogRenderer.isCustomDialog = enable;\n        this.responsiveDialogRenderer.showResponsiveDialog(this.column);\n    };\n    /**\n     * To create the filter module.\n     *\n     * @param {Column} col - specifies the filtering column name\n     * @returns {void}\n     * @hidden\n     */\n    Filter.prototype.setFilterModel = function (col) {\n        var type = col.filter.type || this.parent.filterSettings.type;\n        this.filterModule = new this.type[type](this.parent, this.parent.filterSettings, this.serviceLocator, this.customOperators, this);\n    };\n    /**\n     * To destroy the filter bar.\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Filter.prototype.destroy = function () {\n        var gridElement = this.parent.element;\n        if (!gridElement || (!gridElement.querySelector('.' + literals.gridHeader) && !gridElement.querySelector('.' + literals.gridContent))) {\n            return;\n        }\n        if (this.filterModule) {\n            this.filterModule.destroy();\n        }\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        if (!this.parent.refreshing && (this.parent.isDestroyed || !this.parent.allowFiltering)) {\n            this.filterSettings.columns = [];\n        }\n        this.updateFilterMsg();\n        this.removeEventListener();\n        this.unWireEvents();\n        if (this.filterSettings.type === 'FilterBar' && this.filterSettings.showFilterBarOperator) {\n            var dropdownlist = [].slice.call(this.element.getElementsByClassName('e-filterbaroperator'));\n            for (var i = 0; i < dropdownlist.length; i++) {\n                if (dropdownlist[i].ej2_instances[0]) {\n                    dropdownlist[i].ej2_instances[0].destroy();\n                }\n            }\n        }\n        if (this.element) {\n            if (this.element.parentElement) {\n                remove(this.element);\n            }\n            var filterBarElement = this.parent.getHeaderContent().querySelector('.e-filterbar');\n            if (this.parent.isFrozenGrid() && filterBarElement) {\n                remove(filterBarElement);\n            }\n        }\n    };\n    Filter.prototype.setFullScreenDialog = function () {\n        if (this.serviceLocator) {\n            this.serviceLocator.registerAdaptiveService(this, this.parent.enableAdaptiveUI, ResponsiveDialogAction.isFilter);\n        }\n    };\n    Filter.prototype.generateRow = function () {\n        var options = {};\n        var row = new Row(options);\n        row.cells = this.generateCells();\n        return row;\n    };\n    Filter.prototype.generateCells = function () {\n        //TODO: generate dummy column for group, detail, stacked row here for filtering;\n        var cells = [];\n        if (this.parent.allowGrouping) {\n            for (var c = 0, len = this.parent.groupSettings.columns.length; c < len; c++) {\n                cells.push(this.generateCell({}, CellType.HeaderIndent));\n            }\n        }\n        if (this.parent.detailTemplate || this.parent.childGrid) {\n            cells.push(this.generateCell({}, CellType.DetailHeader));\n        }\n        if (this.parent.isRowDragable() && this.parent.getFrozenMode() !== 'Right') {\n            cells.push(this.generateCell({}, CellType.RowDragHIcon));\n        }\n        for (var _i = 0, _a = this.parent.getColumns(); _i < _a.length; _i++) {\n            var dummy = _a[_i];\n            cells.push(this.generateCell(dummy));\n        }\n        if (this.parent.getFrozenMode() === 'Right') {\n            cells.push(this.generateCell({}, CellType.RowDragHIcon));\n        }\n        return cells;\n    };\n    Filter.prototype.generateCell = function (column, cellType) {\n        var opt = {\n            'visible': column.visible,\n            'isDataCell': false,\n            'rowId': '',\n            'column': column,\n            'cellType': cellType ? cellType : CellType.Filter,\n            'attributes': { title: this.l10n.getConstant('FilterbarTitle') }\n        };\n        return new Cell(opt);\n    };\n    /**\n     * To update filterSettings when applying filter.\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Filter.prototype.updateModel = function () {\n        var col = this.parent.getColumnByField(this.fieldName);\n        this.filterObjIndex = this.getFilteredColsIndexByField(col);\n        this.prevFilterObject = this.filterSettings.columns[this.filterObjIndex];\n        var arrayVal = Array.isArray(this.value) ? this.value : [this.value];\n        var moduleName = this.parent.dataSource.adaptor && this.parent.dataSource.adaptor.getModuleName ? this.parent.dataSource.adaptor.getModuleName() : undefined;\n        for (var i = 0, len = arrayVal.length; i < len; i++) {\n            var field = col.isForeignColumn() ? col.foreignKeyValue : this.fieldName;\n            var isMenuNotEqual = this.operator === 'notequal';\n            this.currentFilterObject = {\n                field: field, uid: col.uid, isForeignKey: col.isForeignColumn(), operator: this.operator,\n                value: arrayVal[i], predicate: this.predicate,\n                matchCase: this.matchCase, ignoreAccent: this.ignoreAccent, actualFilterValue: {}, actualOperator: {}\n            };\n            var index = this.getFilteredColsIndexByField(col);\n            if (index > -1 && !Array.isArray(this.value)) {\n                this.filterSettings.columns[index] = this.currentFilterObject;\n            }\n            else {\n                this.filterSettings.columns.push(this.currentFilterObject);\n            }\n            if (!this.column.isForeignColumn() && isNullOrUndefined(this.value) && (this.operator === 'equal' ||\n                this.operator === 'notequal') && (moduleName !== 'ODataAdaptor' && moduleName !== 'ODataV4Adaptor')) {\n                this.filterSettings.columns = [];\n                if (col.type === 'string') {\n                    this.filterSettings.columns.push({\n                        field: field, ignoreAccent: this.ignoreAccent, matchCase: this.matchCase,\n                        operator: this.operator, predicate: isMenuNotEqual ? 'and' : 'or', value: ''\n                    });\n                }\n                this.filterSettings.columns.push({\n                    field: field, ignoreAccent: this.ignoreAccent, matchCase: this.matchCase,\n                    operator: this.operator, predicate: isMenuNotEqual ? 'and' : 'or', value: undefined\n                });\n                this.filterSettings.columns.push({\n                    field: field, ignoreAccent: this.ignoreAccent, matchCase: this.matchCase,\n                    operator: this.operator, predicate: isMenuNotEqual ? 'and' : 'or', value: null\n                });\n            }\n        }\n        // eslint-disable-next-line no-self-assign\n        this.filterSettings.columns = this.filterSettings.columns;\n        this.parent.dataBind();\n    };\n    Filter.prototype.getFilteredColsIndexByField = function (col) {\n        var cols = this.filterSettings.columns;\n        for (var i = 0, len = cols.length; i < len; i++) {\n            if (cols[i].uid === col.uid || (col.isForeignColumn() && this.parent.getColumnByUid(col.uid).field === col.foreignKeyValue)) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    /**\n     * To trigger action complete event.\n     *\n     * @param {NotifyArgs} e - specifies the NotifyArgs\n     * @returns {void}\n     * @hidden\n     */\n    Filter.prototype.onActionComplete = function (e) {\n        var args = !this.isRemove ? {\n            currentFilterObject: this.currentFilterObject,\n            /* tslint:disable:no-string-literal */\n            currentFilteringColumn: !isNullOrUndefined(this.column) ? this.column.field : undefined,\n            /* tslint:enable:no-string-literal */\n            columns: this.filterSettings.columns, requestType: 'filtering', type: events.actionComplete\n        } : {\n            requestType: 'filtering', type: events.actionComplete\n        };\n        this.parent.trigger(events.actionComplete, extend(e, args));\n        this.isRemove = false;\n    };\n    Filter.prototype.wireEvents = function () {\n        EventHandler.add(this.parent.getHeaderContent(), 'keyup', this.keyUpHandlerImmediate, this);\n    };\n    Filter.prototype.unWireEvents = function () {\n        EventHandler.remove(this.parent.getHeaderContent(), 'keyup', this.keyUpHandlerImmediate);\n    };\n    Filter.prototype.enableAfterRender = function (e) {\n        if (e.module === this.getModuleName() && e.enable) {\n            this.parent.getHeaderTable().classList.add('e-sortfilter');\n            this.render();\n        }\n    };\n    Filter.prototype.refreshFilterValue = function () {\n        this.parent.removeEventListener(events.beforeDataBound, this.refreshFilterValueFn);\n        if (this.filterSettings.type === 'FilterBar' && this.filterSettings.columns.length &&\n            !this.parent.getCurrentViewRecords().length) {\n            this.initialEnd();\n        }\n    };\n    Filter.prototype.initialEnd = function () {\n        this.parent.off(events.contentReady, this.initialEnd);\n        if (this.parent.getColumns().length && this.filterSettings.columns.length) {\n            var gObj = this.parent;\n            this.contentRefresh = false;\n            this.initialLoad = true;\n            for (var _i = 0, _a = gObj.filterSettings.columns; _i < _a.length; _i++) {\n                var col = _a[_i];\n                this.filterByColumn(col.field, col.operator, col.value, col.predicate, col.matchCase, col.ignoreAccent, col.actualFilterValue, col.actualOperator);\n            }\n            this.initialLoad = false;\n            this.updateFilterMsg();\n            this.contentRefresh = true;\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Filter.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.setFullScreenDialog, this.setFullScreenDialog, this);\n        this.parent.on(events.uiUpdate, this.enableAfterRender, this);\n        this.parent.on(events.filterComplete, this.onActionComplete, this);\n        this.parent.on(events.inBoundModelChanged, this.onPropertyChanged, this);\n        this.parent.on(events.keyPressed, this.keyUpHandler, this);\n        this.parent.on(events.columnPositionChanged, this.columnPositionChanged, this);\n        this.parent.on(events.headerRefreshed, this.render, this);\n        this.parent.on(events.contentReady, this.initialEnd, this);\n        this.parent.on(events.filterMenuClose, this.filterMenuClose, this);\n        this.docClickHandler = this.clickHandler.bind(this);\n        EventHandler.add(document, 'click', this.docClickHandler, this);\n        EventHandler.add(this.parent.element, 'mousedown', this.refreshClearIcon, this);\n        this.parent.on(events.filterOpen, this.columnMenuFilter, this);\n        this.parent.on(events.click, this.filterIconClickHandler, this);\n        this.parent.on('persist-data-changed', this.initialEnd, this);\n        this.parent.on(events.closeFilterDialog, this.clickHandler, this);\n        this.parent.on(events.destroy, this.destroy, this);\n        this.refreshFilterValueFn = this.refreshFilterValue.bind(this);\n        this.parent.addEventListener(events.beforeDataBound, this.refreshFilterValueFn);\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Filter.prototype.removeEventListener = function () {\n        EventHandler.remove(document, 'click', this.docClickHandler);\n        EventHandler.remove(this.parent.element, 'mousedown', this.refreshClearIcon);\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.setFullScreenDialog, this.setFullScreenDialog);\n        this.parent.off(events.uiUpdate, this.enableAfterRender);\n        this.parent.off(events.filterComplete, this.onActionComplete);\n        this.parent.off(events.inBoundModelChanged, this.onPropertyChanged);\n        this.parent.off(events.keyPressed, this.keyUpHandler);\n        this.parent.off(events.columnPositionChanged, this.columnPositionChanged);\n        this.parent.off(events.headerRefreshed, this.render);\n        this.parent.off(events.filterOpen, this.columnMenuFilter);\n        this.parent.off(events.filterMenuClose, this.filterMenuClose);\n        this.parent.off(events.click, this.filterIconClickHandler);\n        this.parent.off(events.closeFilterDialog, this.clickHandler);\n        this.parent.off(events.destroy, this.destroy);\n    };\n    Filter.prototype.refreshClearIcon = function (e) {\n        if (this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar' &&\n            e.target.closest('th') && e.target.closest('th').classList.contains('e-filterbarcell') &&\n            e.target.classList.contains('e-clear-icon')) {\n            var targetText = e.target.previousElementSibling;\n            Input.setValue(null, targetText, 'Never', true);\n            if (this.filterSettings.mode === 'Immediate') {\n                this.removeFilteredColsByField(targetText.id.slice(0, -14)); //Length of _filterBarcell = 14\n            }\n        }\n    };\n    Filter.prototype.filterMenuClose = function () {\n        this.fltrDlgDetails.isOpen = false;\n    };\n    /**\n     * Filters the Grid row by fieldName, filterOperator, and filterValue.\n     *\n     * @param  {string} fieldName - Defines the field name of the filter column.\n     * @param  {string} filterOperator - Defines the operator to filter records.\n     * @param  {string | number | Date | boolean} filterValue - Defines the value which is used to filter records.\n     * @param  {string} predicate - Defines the relationship of one filter query with another by using AND or OR predicate.\n     * @param  {boolean} matchCase - If match case is set to true, then the filter records\n     * the exact match or <br> filters records that are case insensitive (uppercase and lowercase letters treated the same).\n     * @param {boolean} ignoreAccent - If ignoreAccent set to true, then filter ignores the diacritic characters or accents while filtering.\n     * @param  {string} actualFilterValue - Defines the actual filter value for the filter column.\n     * @param  {string} actualOperator - Defines the actual filter operator for the filter column.\n     * @returns {void}\n     */\n    Filter.prototype.filterByColumn = function (fieldName, filterOperator, filterValue, predicate, matchCase, ignoreAccent, actualFilterValue, actualOperator) {\n        var _this = this;\n        var gObj = this.parent;\n        var filterCell;\n        this.column = gObj.grabColumnByFieldFromAllCols(fieldName);\n        if (this.filterSettings.type === 'FilterBar' && this.filterSettings.showFilterBarOperator\n            && isNullOrUndefined(this.column.filterBarTemplate) && isNullOrUndefined(this.column.filterTemplate)) {\n            filterOperator = this.getOperatorName(fieldName);\n        }\n        if (!this.column) {\n            return;\n        }\n        if (this.filterSettings.type === 'FilterBar') {\n            filterCell = gObj.getHeaderContent().querySelector('[id=\\'' + this.column.field + '_filterBarcell\\']');\n        }\n        if (!isNullOrUndefined(this.column.allowFiltering) && !this.column.allowFiltering) {\n            this.parent.log('action_disabled_column', { moduleName: this.getModuleName(), columnName: this.column.headerText });\n            return;\n        }\n        if (isActionPrevent(gObj)) {\n            gObj.notify(events.preventBatch, {\n                instance: this, handler: this.filterByColumn, arg1: fieldName, arg2: filterOperator, arg3: filterValue, arg4: predicate,\n                arg5: matchCase, arg6: ignoreAccent, arg7: actualFilterValue, arg8: actualOperator\n            });\n            return;\n        }\n        this.predicate = predicate ? predicate : Array.isArray(filterValue) ? 'or' : 'and';\n        this.value = filterValue;\n        this.matchCase = matchCase || false;\n        this.ignoreAccent = this.ignoreAccent = !isNullOrUndefined(ignoreAccent) ? ignoreAccent : this.parent.filterSettings.ignoreAccent;\n        this.fieldName = fieldName;\n        this.operator = filterOperator;\n        filterValue = !isNullOrUndefined(filterValue) ? filterValue.toString() : filterValue;\n        if (filterValue === '') {\n            filterValue = null;\n        }\n        if (this.column.type === 'number' || this.column.type === 'date') {\n            this.matchCase = true;\n        }\n        gObj.getColumnHeaderByField(fieldName).setAttribute('aria-filtered', 'true');\n        if (filterCell && this.filterSettings.type === 'FilterBar') {\n            if ((filterValue && filterValue.length < 1) || (!this.filterByMethod &&\n                this.checkForSkipInput(this.column, filterValue))) {\n                this.filterStatusMsg = (filterValue && filterValue.length < 1) ? '' : this.l10n.getConstant('InvalidFilterMessage');\n                this.updateFilterMsg();\n                return;\n            }\n            if (filterCell.value !== filterValue) {\n                filterCell.value = filterValue;\n            }\n        }\n        if (!isNullOrUndefined(this.column.format)) {\n            this.applyColumnFormat(filterValue);\n            if (this.initialLoad && this.filterSettings.type === 'FilterBar') {\n                filterCell.value = this.values[this.column.field];\n            }\n        }\n        else {\n            this.values[this.column.field] = filterValue; //this line should be above updateModel\n        }\n        var predObj = {\n            field: this.fieldName,\n            predicate: predicate,\n            matchCase: matchCase,\n            ignoreAccent: ignoreAccent,\n            operator: this.operator,\n            value: this.value,\n            type: this.column.type\n        };\n        var filterColumn = this.parent.filterSettings.columns.filter(function (fColumn) {\n            return (fColumn.field === _this.fieldName);\n        });\n        if (filterColumn.length > 1 && !isNullOrUndefined(this.actualPredicate[this.fieldName])) {\n            this.actualPredicate[this.fieldName].push(predObj);\n        }\n        else {\n            this.actualPredicate[this.fieldName] = [predObj];\n        }\n        if (this.checkAlreadyColFiltered(this.column.field)) {\n            return;\n        }\n        this.updateModel();\n    };\n    Filter.prototype.applyColumnFormat = function (filterValue) {\n        var _this = this;\n        var getFlvalue = (this.column.type === 'date' || this.column.type === 'datetime') ?\n            new Date(filterValue) : parseFloat(filterValue);\n        if ((this.column.type === 'date' || this.column.type === 'datetime') && filterValue &&\n            filterValue.split(',').length > 1) {\n            this.values[this.column.field] = ((filterValue).split(',')).map(function (val) {\n                if (val === '') {\n                    val = null;\n                }\n                return _this.setFormatForFlColumn(new Date(val), _this.column);\n            });\n        }\n        else {\n            this.values[this.column.field] = this.setFormatForFlColumn(getFlvalue, this.column);\n        }\n    };\n    // To skip the second time request to server while applying initial filtering - EJ2-44361\n    Filter.prototype.skipUid = function (col) {\n        var flag = true;\n        var colLen = Object.keys((col));\n        for (var i = 0; i < colLen.length; i++) {\n            var key = Object.keys(col[colLen[i]]);\n            if (key.length === 1 && key[0] === 'uid') {\n                flag = false;\n            }\n        }\n        return flag;\n    };\n    Filter.prototype.onPropertyChanged = function (e) {\n        if (e.module !== this.getModuleName()) {\n            return;\n        }\n        for (var _i = 0, _a = Object.keys(e.properties); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'columns':\n                    // eslint-disable-next-line no-case-declarations\n                    var col = 'columns';\n                    // eslint-disable-next-line no-case-declarations\n                    var args = {\n                        currentFilterObject: this.currentFilterObject, currentFilteringColumn: this.column ?\n                            this.column.field : undefined, action: 'filter', columns: this.filterSettings.columns,\n                        requestType: 'filtering', type: events.actionBegin, cancel: false\n                    };\n                    if (this.contentRefresh && this.skipUid(e.properties[col])) {\n                        this.parent.notify(events.modelChanged, args);\n                        if (args.cancel) {\n                            if (isNullOrUndefined(this.prevFilterObject)) {\n                                this.filterSettings.columns.splice(this.filterSettings.columns.length - 1, 1);\n                            }\n                            else {\n                                this.filterSettings.columns[this.filterObjIndex] = this.prevFilterObject;\n                            }\n                            return;\n                        }\n                        this.updateFilterIcon();\n                        this.refreshFilterSettings();\n                        this.updateFilterMsg();\n                        this.updateFilter();\n                    }\n                    break;\n                case 'showFilterBarStatus':\n                    if (e.properties[prop]) {\n                        this.updateFilterMsg();\n                    }\n                    else if (this.parent.allowPaging) {\n                        this.parent.updateExternalMessage('');\n                    }\n                    break;\n                case 'showFilterBarOperator':\n                case 'type':\n                    this.parent.refreshHeader();\n                    this.refreshFilterSettings();\n                    break;\n            }\n        }\n    };\n    Filter.prototype.refreshFilterSettings = function () {\n        if (this.filterSettings.type === 'FilterBar') {\n            for (var i = 0; i < this.filterSettings.columns.length; i++) {\n                this.column = this.parent.grabColumnByUidFromAllCols(this.filterSettings.columns[i].uid);\n                var filterValue = this.filterSettings.columns[i].value;\n                filterValue = !isNullOrUndefined(filterValue) && filterValue.toString();\n                if (!isNullOrUndefined(this.column.format)) {\n                    this.applyColumnFormat(filterValue);\n                }\n                else {\n                    var key = this.filterSettings.columns[i].field;\n                    this.values[key] = this.filterSettings.columns[i].value;\n                }\n                var filterElement = this.getFilterBarElement(this.column.field);\n                if (filterElement) {\n                    if (this.cellText[this.filterSettings.columns[i].field] !== ''\n                        && !isNullOrUndefined(this.cellText[this.filterSettings.columns[i].field])) {\n                        filterElement.value = this.cellText[this.column.field];\n                    }\n                    else {\n                        filterElement.value = this.filterSettings.columns[i].value;\n                    }\n                }\n            }\n            if (this.filterSettings.columns.length === 0) {\n                var col = this.parent.getColumns();\n                for (var i = 0; i < col.length; i++) {\n                    var filterElement = this.getFilterBarElement(col[i].field);\n                    if (filterElement && filterElement.value !== '') {\n                        filterElement.value = '';\n                        delete this.values[col[i].field];\n                    }\n                }\n            }\n        }\n    };\n    Filter.prototype.updateFilterIcon = function () {\n        if (this.filterSettings.columns.length === 0 && this.parent.element.querySelector('.e-filtered')) {\n            var fltrIconElement = [].slice.call(this.parent.element.getElementsByClassName('e-filtered'));\n            for (var i = 0, len = fltrIconElement.length; i < len; i++) {\n                fltrIconElement[i].removeAttribute('aria-filtered');\n                fltrIconElement[i].classList.remove('e-filtered');\n            }\n        }\n    };\n    Filter.prototype.getFilterBarElement = function (col) {\n        var selector = '[id=\\'' + col + '_filterBarcell\\']';\n        var filterElement;\n        if (selector && !isNullOrUndefined(this.element)) {\n            filterElement = this.element.querySelector(selector);\n        }\n        return filterElement;\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    Filter.prototype.refreshFilter = function () {\n        this.refreshFilterSettings();\n        this.updateFilterMsg();\n    };\n    /**\n     * Clears all the filtered rows of the Grid.\n     *\n     * @param {string[]} fields - returns the fields\n     * @returns {void}\n     */\n    Filter.prototype.clearFiltering = function (fields) {\n        var _this = this;\n        var cols = getActualPropFromColl(this.filterSettings.columns);\n        if (!isNullOrUndefined(fields)) {\n            this.refresh = false;\n            fields.forEach(function (field) { _this.removeFilteredColsByField(field, false); });\n            this.parent.setProperties({ filterSettings: { columns: this.filterSettings.columns } }, true);\n            this.parent.renderModule.refresh();\n            this.refresh = true;\n            return;\n        }\n        if (isActionPrevent(this.parent)) {\n            this.parent.notify(events.preventBatch, { instance: this, handler: this.clearFiltering });\n            return;\n        }\n        for (var i = 0; i < cols.length; i++) {\n            cols[i].uid = cols[i].uid || this.parent.getColumnByField(cols[i].field).uid;\n        }\n        var colUid = cols.map(function (f) { return f.uid; });\n        var filteredcols = colUid.filter(function (item, pos) { return colUid.indexOf(item) === pos; });\n        this.refresh = false;\n        for (var i = 0, len = filteredcols.length; i < len; i++) {\n            this.removeFilteredColsByField(this.parent.getColumnByUid(filteredcols[i]).field, false);\n        }\n        this.refresh = true;\n        if (filteredcols.length) {\n            this.parent.renderModule.refresh();\n        }\n        if (this.parent.filterSettings.columns.length === 0 && this.parent.element.querySelector('.e-filtered')) {\n            var fltrElement = [].slice.call(this.parent.element.getElementsByClassName('e-filtered'));\n            for (var i = 0, len = fltrElement.length; i < len; i++) {\n                fltrElement[0].removeAttribute('aria-filtered');\n                fltrElement[0].classList.remove('e-filtered');\n            }\n        }\n        this.isRemove = true;\n        this.filterStatusMsg = '';\n        this.updateFilterMsg();\n    };\n    Filter.prototype.checkAlreadyColFiltered = function (field) {\n        var columns = this.filterSettings.columns;\n        for (var _i = 0, columns_1 = columns; _i < columns_1.length; _i++) {\n            var col = columns_1[_i];\n            if (col.field === field && col.value === this.value &&\n                col.operator === this.operator && col.predicate === this.predicate) {\n                return true;\n            }\n        }\n        return false;\n    };\n    Filter.prototype.columnMenuFilter = function (args) {\n        this.column = args.col;\n        var ele = closest(args.target, '#' + args.id);\n        if (args.isClose && !ele) {\n            this.filterModule.closeDialog();\n        }\n        else if (ele) {\n            this.filterDialogOpen(this.column, args.target);\n        }\n    };\n    Filter.prototype.filterDialogOpen = function (col, target, left, top) {\n        if (this.filterModule) {\n            this.filterModule.closeDialog();\n        }\n        this.setFilterModel(col);\n        this.filterModule.openDialog(this.createOptions(col, target, left, top));\n    };\n    /**\n     * Create filter dialog options\n     *\n     * @param  {Column} col - Filtering column detail.\n     * @param  {Element} target -  Filter dialog target.\n     * @param  {number} left -  Filter dialog left position.\n     * @param  {number} top -  Filter dialog top position.\n     * @returns {Object} returns the created dialog options\n     * @hidden\n     */\n    Filter.prototype.createOptions = function (col, target, left, top) {\n        var gObj = this.parent;\n        var dataSource = col.filter.dataSource || gObj.dataSource && 'result' in gObj.dataSource ? gObj.dataSource :\n            gObj.getDataModule().dataManager;\n        var type = col.filter.type || this.parent.filterSettings.type;\n        var options = {\n            type: col.type, field: col.field, displayName: col.headerText,\n            dataSource: dataSource, format: col.format, height: 800, columns: gObj.getColumns(),\n            filteredColumns: gObj.filterSettings.columns, target: target, dataManager: gObj.getDataModule().dataManager,\n            formatFn: col.getFormatter(), ignoreAccent: gObj.filterSettings.ignoreAccent,\n            parserFn: col.getParser(), query: gObj.query, template: col.getFilterItemTemplate(),\n            hideSearchbox: isNullOrUndefined(col.filter.hideSearchbox) ? false : col.filter.hideSearchbox,\n            handler: this.filterHandler.bind(this), localizedStrings: gObj.getLocaleConstants(),\n            position: { X: left, Y: top }, column: col, foreignKeyValue: col.foreignKeyValue,\n            actualPredicate: this.actualPredicate, localeObj: gObj.localeObj,\n            isRemote: gObj.getDataModule().isRemote(), allowCaseSensitive: this.filterSettings.enableCaseSensitivity,\n            isResponsiveFilter: this.parent.enableAdaptiveUI,\n            operator: this.actualPredicate[col.field] && type === 'Menu' ? this.actualPredicate[col.field][0].operator : 'equal'\n        };\n        return options;\n    };\n    /**\n     * Removes filtered column by field name.\n     *\n     * @param  {string} field - Defines column field name to remove filter.\n     * @param  {boolean} isClearFilterBar - Specifies whether the filter bar value needs to be cleared.\n     * @returns {void}\n     * @hidden\n     */\n    Filter.prototype.removeFilteredColsByField = function (field, isClearFilterBar) {\n        var fCell;\n        var cols = this.filterSettings.columns;\n        if (isActionPrevent(this.parent)) {\n            var args = { instance: this, handler: this.removeFilteredColsByField, arg1: field, arg2: isClearFilterBar };\n            this.parent.notify(events.preventBatch, args);\n            return;\n        }\n        var colUid = cols.map(function (f) { return f.uid; });\n        var filteredColsUid = colUid.filter(function (item, pos) { return colUid.indexOf(item) === pos; });\n        var _loop_1 = function (i, len) {\n            cols[i].uid = cols[i].uid || this_1.parent.getColumnByField(cols[i].field).uid;\n            var len_1 = cols.length;\n            var column = this_1.parent.grabColumnByUidFromAllCols(filteredColsUid[i]);\n            if (column.field === field || (column.field === column.foreignKeyValue && column.isForeignColumn())) {\n                var currentPred = this_1.filterSettings.columns.filter(function (e) {\n                    return e.uid === column.uid;\n                })[0];\n                if (this_1.filterSettings.type === 'FilterBar' && !isClearFilterBar) {\n                    var selector = '[id=\\'' + column.field + '_filterBarcell\\']';\n                    fCell = this_1.parent.getHeaderContent().querySelector(selector);\n                    if (fCell) {\n                        fCell.value = '';\n                        delete this_1.values[field];\n                    }\n                }\n                while (len_1--) {\n                    if (cols[len_1].uid === column.uid) {\n                        cols.splice(len_1, 1);\n                    }\n                }\n                var fltrElement = this_1.parent.getColumnHeaderByField(column.field);\n                fltrElement.removeAttribute('aria-filtered');\n                if (this_1.filterSettings.type !== 'FilterBar') {\n                    var iconClass = this_1.parent.showColumnMenu && column.showColumnMenu ? '.e-columnmenu' : '.e-icon-filter';\n                    fltrElement.querySelector(iconClass).classList.remove('e-filtered');\n                }\n                this_1.isRemove = true;\n                if (this_1.actualPredicate[field]) {\n                    delete this_1.actualPredicate[field];\n                }\n                if (this_1.values[field]) {\n                    delete this_1.values[field];\n                }\n                if (this_1.refresh) {\n                    this_1.parent.notify(events.modelChanged, {\n                        requestType: 'filtering', type: events.actionBegin, currentFilterObject: currentPred,\n                        currentFilterColumn: column, action: 'clearFilter'\n                    });\n                }\n                return \"break\";\n            }\n        };\n        var this_1 = this;\n        for (var i = 0, len = filteredColsUid.length; i < len; i++) {\n            var state_1 = _loop_1(i, len);\n            if (state_1 === \"break\")\n                break;\n        }\n        this.updateFilterMsg();\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} returns the module name\n     * @private\n     */\n    Filter.prototype.getModuleName = function () {\n        return 'filter';\n    };\n    Filter.prototype.keyUpHandlerImmediate = function (e) {\n        if (e.keyCode !== 13) {\n            this.keyUpHandler(e);\n        }\n    };\n    Filter.prototype.keyUpHandler = function (e) {\n        var gObj = this.parent;\n        var target = e.target;\n        if (target && matches(target, '.e-filterbar input')) {\n            var closeHeaderEle = closest(target, 'th.e-filterbarcell');\n            this.column = gObj.getColumnByUid(closeHeaderEle.getAttribute('e-mappinguid'));\n            if (!this.column) {\n                return;\n            }\n            if (e.action === 'altDownArrow' && this.parent.filterSettings.showFilterBarOperator) {\n                var dropDownListInput = closest(target, 'span').querySelector('.e-filterbaroperator');\n                dropDownListInput.ej2_instances[0].showPopup();\n                dropDownListInput.focus();\n            }\n            if ((this.filterSettings.mode === 'Immediate' || (e.keyCode === 13 &&\n                !e.target.classList.contains('e-filterbaroperator')))\n                && e.keyCode !== 9 && !this.column.filterTemplate) {\n                this.value = target.value.trim();\n                this.processFilter(e);\n            }\n        }\n        if (e.action === 'altDownArrow' && this.filterSettings.type !== 'FilterBar') {\n            var element = gObj.focusModule.currentInfo.element;\n            if (element && element.classList.contains('e-headercell')) {\n                var column = gObj.getColumnByUid(element.firstElementChild.getAttribute('e-mappinguid'));\n                this.openMenuByField(column.field);\n                this.parent.focusModule.clearIndicator();\n            }\n        }\n        if (e.action === 'escape' && this.filterSettings.type === 'Menu' && this.filterModule) {\n            this.filterModule.closeDialog();\n            gObj.notify(events.restoreFocus, {});\n        }\n    };\n    Filter.prototype.updateCrossIcon = function (element) {\n        if (element.value.length) {\n            element.nextElementSibling.classList.remove('e-hide');\n        }\n    };\n    Filter.prototype.updateFilterMsg = function () {\n        if (this.filterSettings.type === 'FilterBar') {\n            var gObj = this.parent;\n            var getFormatFlValue = void 0;\n            var columns = this.filterSettings.columns;\n            var column = void 0;\n            if (!this.filterSettings.showFilterBarStatus) {\n                return;\n            }\n            if (columns.length > 0 && this.filterStatusMsg !== this.l10n.getConstant('InvalidFilterMessage')) {\n                this.filterStatusMsg = '';\n                for (var index = 0; index < columns.length; index++) {\n                    column = gObj.grabColumnByUidFromAllCols(columns[index].uid) || gObj.grabColumnByFieldFromAllCols(columns[index].field);\n                    if (index) {\n                        this.filterStatusMsg += ' && ';\n                    }\n                    if (!isNullOrUndefined(column.format)) {\n                        var flValue = (column.type === 'date' || column.type === 'datetime') ?\n                            this.valueFormatter.fromView(this.values[column.field], column.getParser(), column.type) :\n                            this.values[column.field];\n                        if (!(column.type === 'date' || column.type === 'datetime')) {\n                            var formater = this.serviceLocator.getService('valueFormatter');\n                            getFormatFlValue = formater.toView(flValue, column.getParser()).toString();\n                        }\n                        else {\n                            getFormatFlValue = this.setFormatForFlColumn(flValue, column);\n                        }\n                        this.filterStatusMsg += column.headerText + ': ' + getFormatFlValue;\n                    }\n                    else {\n                        this.filterStatusMsg += column.headerText + ': ' + this.values[column.field];\n                    }\n                }\n            }\n            if (gObj.allowPaging) {\n                gObj.updateExternalMessage(this.filterStatusMsg);\n            }\n            //TODO: virtual paging\n            this.filterStatusMsg = '';\n        }\n    };\n    Filter.prototype.setFormatForFlColumn = function (value, column) {\n        var formater = this.serviceLocator.getService('valueFormatter');\n        return formater.toView(value, column.getFormatter()).toString();\n    };\n    Filter.prototype.checkForSkipInput = function (column, value) {\n        var isSkip;\n        if (column.type === 'number') {\n            if (DataUtil.operatorSymbols[value] || this.skipNumberInput.indexOf(value) > -1) {\n                isSkip = true;\n            }\n        }\n        else if (column.type === 'string') {\n            for (var _i = 0, value_1 = value; _i < value_1.length; _i++) {\n                var val = value_1[_i];\n                if (this.skipStringInput.indexOf(val) > -1) {\n                    isSkip = true;\n                }\n            }\n        }\n        return isSkip;\n    };\n    Filter.prototype.processFilter = function (e) {\n        this.stopTimer();\n        this.startTimer(e);\n    };\n    Filter.prototype.startTimer = function (e) {\n        var _this = this;\n        this.timer = window.setInterval(function () { _this.onTimerTick(); }, e.keyCode === 13 ? 0 : this.filterSettings.immediateModeDelay);\n    };\n    Filter.prototype.stopTimer = function () {\n        window.clearInterval(this.timer);\n    };\n    Filter.prototype.onTimerTick = function () {\n        var selector = '[id=\\'' + this.column.field + '_filterBarcell\\']';\n        var filterElement = this.element.querySelector(selector);\n        if (!filterElement && this.parent.isFrozenGrid()) {\n            filterElement = this.parent.getHeaderContent().querySelector(selector);\n        }\n        var filterValue;\n        this.cellText[this.column.field] = filterElement.value;\n        this.stopTimer();\n        if (!isNullOrUndefined(this.column.filterBarTemplate)) {\n            var templateRead = this.column.filterBarTemplate.read;\n            if (typeof templateRead === 'string') {\n                templateRead = getValue(templateRead, window);\n            }\n            if (!isNullOrUndefined(templateRead)) {\n                this.value = templateRead.call(this, filterElement);\n            }\n        }\n        else {\n            filterValue = JSON.parse(JSON.stringify(filterElement.value));\n        }\n        if (isNullOrUndefined(this.value) || this.value === '') {\n            this.removeFilteredColsByField(this.column.field);\n            return;\n        }\n        this.validateFilterValue(this.value);\n        this.filterByMethod = false;\n        this.filterByColumn(this.column.field, this.operator, this.value, this.predicate, this.filterSettings.enableCaseSensitivity, this.ignoreAccent);\n        this.filterByMethod = true;\n        filterElement.value = filterValue;\n        this.updateFilterMsg();\n    };\n    Filter.prototype.validateFilterValue = function (value) {\n        var skipInput;\n        var index;\n        this.matchCase = this.filterSettings.enableCaseSensitivity;\n        switch (this.column.type) {\n            case 'number':\n                if (this.column.filter.operator) {\n                    this.operator = this.column.filter.operator;\n                }\n                else {\n                    this.operator = this.filterOperators.equal;\n                }\n                skipInput = ['>', '<', '=', '!'];\n                for (var i = 0; i < value.length; i++) {\n                    if (skipInput.indexOf(value[i]) > -1) {\n                        index = i;\n                        break;\n                    }\n                }\n                this.getOperator(value.substring(index));\n                if (index !== 0) {\n                    this.value = value.substring(0, index);\n                }\n                if (this.value !== '' && value.length >= 1) {\n                    this.value = this.valueFormatter.fromView(this.value, this.column.getParser(), this.column.type);\n                }\n                if (isNaN(this.value)) {\n                    this.filterStatusMsg = this.l10n.getConstant('InvalidFilterMessage');\n                }\n                break;\n            case 'date':\n            case 'datetime':\n                this.operator = this.filterOperators.equal;\n                if (this.value !== '' && !(this.value instanceof Date)) {\n                    this.getOperator(value);\n                    this.value = this.valueFormatter.fromView(this.value, this.column.getParser(), this.column.type);\n                    if (isNullOrUndefined(this.value)) {\n                        this.filterStatusMsg = this.l10n.getConstant('InvalidFilterMessage');\n                    }\n                }\n                break;\n            case 'string':\n                this.matchCase = false;\n                if (value.charAt(0) === '*') {\n                    this.value = this.value.slice(1);\n                    this.operator = this.filterOperators.startsWith;\n                }\n                else if (value.charAt(value.length - 1) === '%') {\n                    this.value = this.value.slice(0, -1);\n                    this.operator = this.filterOperators.startsWith;\n                }\n                else if (value.charAt(0) === '%') {\n                    this.value = this.value.slice(1);\n                    this.operator = this.filterOperators.endsWith;\n                }\n                else {\n                    if (this.column.filter.operator) {\n                        this.operator = this.column.filter.operator;\n                    }\n                    else {\n                        this.operator = this.filterOperators.startsWith;\n                    }\n                }\n                break;\n            case 'boolean':\n                if (value.toLowerCase() === 'true' || value === '1') {\n                    this.value = true;\n                }\n                else if (value.toLowerCase() === 'false' || value === '0') {\n                    this.value = false;\n                }\n                else if (value.length) {\n                    this.filterStatusMsg = this.l10n.getConstant('InvalidFilterMessage');\n                }\n                this.operator = this.filterOperators.equal;\n                break;\n            default:\n                if (this.column.filter.operator) {\n                    this.operator = this.column.filter.operator;\n                }\n                else {\n                    this.operator = this.filterOperators.equal;\n                }\n        }\n    };\n    Filter.prototype.getOperator = function (value) {\n        var singleOp = value.charAt(0);\n        var multipleOp = value.slice(0, 2);\n        var operators = extend({ '=': this.filterOperators.equal, '!': this.filterOperators.notEqual }, DataUtil.operatorSymbols);\n        // eslint-disable-next-line no-prototype-builtins\n        if (operators.hasOwnProperty(singleOp) || operators.hasOwnProperty(multipleOp)) {\n            this.operator = operators[singleOp];\n            this.value = value.substring(1);\n            if (!this.operator) {\n                this.operator = operators[multipleOp];\n                this.value = value.substring(2);\n            }\n        }\n        if (this.operator === this.filterOperators.lessThan || this.operator === this.filterOperators.greaterThan) {\n            if (this.value.charAt(0) === '=') {\n                this.operator = this.operator + 'orequal';\n                this.value = this.value.substring(1);\n            }\n        }\n    };\n    Filter.prototype.columnPositionChanged = function () {\n        if (this.parent.filterSettings.type !== 'FilterBar') {\n            return;\n        }\n    };\n    Filter.prototype.getLocalizedCustomOperators = function () {\n        var numOptr = [\n            { value: 'equal', text: this.l10n.getConstant('Equal') },\n            { value: 'greaterthan', text: this.l10n.getConstant('GreaterThan') },\n            { value: 'greaterthanorequal', text: this.l10n.getConstant('GreaterThanOrEqual') },\n            { value: 'lessthan', text: this.l10n.getConstant('LessThan') },\n            { value: 'lessthanorequal', text: this.l10n.getConstant('LessThanOrEqual') },\n            { value: 'notequal', text: this.l10n.getConstant('NotEqual') }\n        ];\n        this.customOperators = {\n            stringOperator: [\n                { value: 'startswith', text: this.l10n.getConstant('StartsWith') },\n                { value: 'endswith', text: this.l10n.getConstant('EndsWith') },\n                { value: 'contains', text: this.l10n.getConstant('Contains') },\n                { value: 'equal', text: this.l10n.getConstant('Equal') },\n                { value: 'notequal', text: this.l10n.getConstant('NotEqual') }\n            ],\n            numberOperator: numOptr,\n            dateOperator: numOptr,\n            datetimeOperator: numOptr,\n            booleanOperator: [\n                { value: 'equal', text: this.l10n.getConstant('Equal') },\n                { value: 'notequal', text: this.l10n.getConstant('NotEqual') }\n            ]\n        };\n    };\n    /**\n     * @param {string} field - specifies the field name\n     * @returns {void}\n     * @hidden\n     */\n    Filter.prototype.openMenuByField = function (field) {\n        var gObj = this.parent;\n        if (gObj.enableAdaptiveUI) {\n            this.showCustomFilter(false);\n            return;\n        }\n        var column = gObj.getColumnByField(field);\n        var header = gObj.getColumnHeaderByField(field);\n        var target = header.querySelector('.e-filtermenudiv');\n        if (!target) {\n            return;\n        }\n        var gClient = gObj.element.getBoundingClientRect();\n        var fClient = target.getBoundingClientRect();\n        this.filterDialogOpen(column, target, fClient.right - gClient.left, fClient.bottom - gClient.top);\n    };\n    Filter.prototype.filterIconClickHandler = function (e) {\n        var target = e.target;\n        if (target.classList.contains('e-filtermenudiv') && (this.parent.filterSettings.type === 'Menu' ||\n            this.parent.filterSettings.type === 'CheckBox' || this.parent.filterSettings.type === 'Excel')) {\n            var gObj = this.parent;\n            var col = gObj.getColumnByUid(parentsUntil(target, 'e-headercell').firstElementChild.getAttribute('e-mappinguid'));\n            this.column = col;\n            if (this.fltrDlgDetails.field === col.field && this.fltrDlgDetails.isOpen) {\n                return;\n            }\n            if (this.filterModule) {\n                this.filterModule.closeDialog();\n            }\n            this.fltrDlgDetails = { field: col.field, isOpen: true };\n            this.openMenuByField(col.field);\n        }\n    };\n    Filter.prototype.clickHandler = function (e) {\n        if (this.filterSettings.type === 'FilterBar' && this.filterSettings.showFilterBarOperator) {\n            if (parentsUntil(e.target, 'e-filterbarcell') &&\n                e.target.classList.contains('e-input-group-icon')) {\n                var filterOperatorElement = closest(e.target, 'div').\n                    querySelector('.e-filterbaroperator');\n                if (filterOperatorElement) {\n                    filterOperatorElement.focus();\n                }\n                else {\n                    e.target.focus();\n                }\n            }\n            if (e.target.classList.contains('e-list-item')) {\n                var inputId = document.querySelector('.e-popup-open').getAttribute('id').replace('_popup', '');\n                if (inputId.indexOf('grid-column') !== -1) {\n                    closest(document.getElementById(inputId), 'div').querySelector('.e-filtertext').focus();\n                }\n            }\n        }\n        if (this.filterSettings.mode === 'Immediate' || this.parent.filterSettings.type === 'Menu' ||\n            this.parent.filterSettings.type === 'CheckBox' || this.parent.filterSettings.type === 'Excel') {\n            var target = e.target;\n            var datepickerEle = target.classList.contains('e-day'); // due to datepicker popup cause\n            var dialog = parentsUntil(this.parent.element, 'e-dialog');\n            var hasDialog = false;\n            var popupEle = parentsUntil(target, 'e-popup');\n            var hasDialogClosed = this.parent.element.querySelector('.e-filter-popup');\n            if (dialog && popupEle) {\n                hasDialog = dialog.id === popupEle.id;\n            }\n            if ((hasDialogClosed && (parentsUntil(target, 'e-excel-ascending') ||\n                parentsUntil(target, 'e-excel-descending')))) {\n                this.filterModule.closeDialog(target);\n            }\n            if (parentsUntil(target, 'e-filter-popup') || target.classList.contains('e-filtermenudiv')) {\n                return;\n            }\n            else if (this.filterModule && (!parentsUntil(target, 'e-popup-wrapper')\n                && (!closest(target, '.e-filter-item.e-menu-item'))) && !datepickerEle) {\n                if ((hasDialog && (!parentsUntil(target, 'e-filter-popup'))\n                    && (!parentsUntil(target, 'e-popup-flmenu'))) || (!popupEle && hasDialogClosed)) {\n                    this.filterModule.isresetFocus = parentsUntil(target, 'e-grid') &&\n                        parentsUntil(target, 'e-grid').id === this.parent.element.id;\n                    this.filterModule.closeDialog(target);\n                }\n            }\n        }\n    };\n    Filter.prototype.filterHandler = function (args) {\n        this.actualPredicate[args.field] = args.actualPredicate;\n        var dataManager = new DataManager(this.filterSettings.columns);\n        var query = new Query().where('field', this.filterOperators.equal, args.field);\n        var result = dataManager.executeLocal(query);\n        for (var i = 0; i < result.length; i++) {\n            var index = -1;\n            for (var j = 0; j < this.filterSettings.columns.length; j++) {\n                if (result[i].field === this.filterSettings.columns[j].field) {\n                    index = j;\n                    break;\n                }\n            }\n            if (index !== -1) {\n                this.filterSettings.columns.splice(index, 1);\n            }\n        }\n        if (this.values[args.field]) {\n            delete this.values[args.field];\n        }\n        var col = this.parent.getColumnByField(args.field);\n        var iconClass = this.parent.showColumnMenu && col.showColumnMenu ? '.e-columnmenu' : '.e-icon-filter';\n        var filterIconElement = this.parent.getColumnHeaderByField(args.field).querySelector(iconClass);\n        if (args.action === 'filtering') {\n            this.filterSettings.columns = this.filterSettings.columns.concat(args.filterCollection);\n            if (this.filterSettings.columns.length && filterIconElement) {\n                filterIconElement.classList.add('e-filtered');\n            }\n        }\n        else {\n            if (filterIconElement) {\n                filterIconElement.classList.remove('e-filtered');\n            }\n            args.requestType = 'filtering';\n            this.parent.renderModule.refresh(args); //hot-fix onpropertychanged not working for object { array }\n        }\n        this.parent.dataBind();\n    };\n    Filter.prototype.updateFilter = function () {\n        var cols = this.filterSettings.columns;\n        this.actualPredicate = {};\n        for (var i = 0; i < cols.length; i++) {\n            this.column = this.parent.getColumnByField(cols[i].field) ||\n                getColumnByForeignKeyValue(cols[i].field, this.parent.getForeignKeyColumns());\n            var fieldName = cols[i].field;\n            if (!this.parent.getColumnByField(cols[i].field)) {\n                fieldName = getColumnByForeignKeyValue(cols[i].field, this.parent.getForeignKeyColumns()).field;\n            }\n            this.refreshFilterIcon(fieldName, cols[i].operator, cols[i].value, cols[i].type, cols[i].predicate, cols[i].matchCase, cols[i].ignoreAccent, cols[i].uid);\n        }\n    };\n    Filter.prototype.refreshFilterIcon = function (fieldName, operator, value, type, predicate, matchCase, ignoreAccent, uid) {\n        var obj = {\n            field: fieldName,\n            predicate: predicate,\n            matchCase: matchCase,\n            ignoreAccent: ignoreAccent,\n            operator: operator,\n            value: value,\n            type: type\n        };\n        if (this.actualPredicate[fieldName]) {\n            this.actualPredicate[fieldName].push(obj);\n        }\n        else {\n            this.actualPredicate[fieldName] = [obj];\n        }\n        var field = uid ? this.parent.grabColumnByUidFromAllCols(uid).field : fieldName;\n        this.addFilteredClass(field);\n    };\n    Filter.prototype.addFilteredClass = function (fieldName) {\n        var filterIconElement;\n        var col = this.parent.getColumnByField(fieldName);\n        if (this.parent.showColumnMenu && col.showColumnMenu) {\n            filterIconElement = this.parent.getColumnHeaderByField(fieldName).querySelector('.e-columnmenu');\n        }\n        else if (col) {\n            filterIconElement = this.parent.getColumnHeaderByField(fieldName).querySelector('.e-icon-filter');\n        }\n        if (filterIconElement) {\n            filterIconElement.classList.add('e-filtered');\n        }\n    };\n    /**\n     * @hidden\n     * @returns {FilterUI} returns the FilterUI\n     */\n    Filter.prototype.getFilterUIInfo = function () {\n        return this.filterModule ? this.filterModule.getFilterUIInfo() : {};\n    };\n    /**\n     * @param {string} field - specifies the field name\n     * @returns {string} returns the operator name\n     * @hidden\n     */\n    Filter.prototype.getOperatorName = function (field) {\n        return document.getElementById(this.parent.getColumnByField(field).uid).ej2_instances[0].value;\n    };\n    /**\n     * Renders checkbox items in Menu filter dialog.\n     *\n     * @returns {void}\n     */\n    Filter.prototype.renderCheckboxOnFilterMenu = function () {\n        return this.filterModule.renderCheckBoxMenu();\n    };\n    return Filter;\n}());\nexport { Filter };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}