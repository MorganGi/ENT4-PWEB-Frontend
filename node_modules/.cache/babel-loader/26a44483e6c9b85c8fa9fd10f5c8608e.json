{"ast":null,"code":"/* eslint-disable */\nimport { createElement, Browser, isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `TextSelection` module is used to handle the text selection of PDF viewer.\n */\n\nvar TextSelection =\n/** @class */\nfunction () {\n  /**\n   * @param pdfViewer\n   * @param pdfViewerBase\n   * @param pdfViewer\n   * @param pdfViewerBase\n   * @private\n   */\n  function TextSelection(pdfViewer, pdfViewerBase) {\n    var _this = this;\n    /**\n     * @private\n     */\n\n\n    this.isTextSelection = false;\n    /**\n     * @private\n     */\n\n    this.selectionStartPage = null;\n    this.isBackwardPropagatedSelection = false;\n    this.contextMenuHeight = 144;\n    /**\n     * @private\n     */\n\n    this.selectionRangeArray = [];\n    this.selectionAnchorTouch = null;\n    this.selectionFocusTouch = null; // eslint-disable-next-line\n\n    this.scrollMoveTimer = 0;\n    this.isMouseLeaveSelection = false;\n    this.isTouchSelection = false;\n    this.previousScrollDifference = 0;\n    this.topStoreLeft = null;\n    this.topStoreRight = null;\n    this.isTextSearched = false;\n    this.isSelectionStartTriggered = false;\n\n    this.onLeftTouchSelectElementTouchStart = function (event) {\n      _this.initiateSelectionByTouch();\n    };\n\n    this.onRightTouchSelectElementTouchStart = function (event) {\n      _this.initiateSelectionByTouch();\n    };\n\n    this.onLeftTouchSelectElementTouchEnd = function (event) {\n      _this.terminateSelectionByTouch(event);\n    };\n\n    this.onRightTouchSelectElementTouchEnd = function (event) {\n      _this.terminateSelectionByTouch(event);\n    };\n\n    this.onLeftTouchSelectElementTouchMove = function (event) {\n      var range;\n      var nodeElement;\n      event.preventDefault();\n      event.target.style.zIndex = '0';\n      var rightElement = _this.dropDivElementRight;\n\n      var isTouchedWithinViewerContainer = _this.isTouchedWithinContainer(event);\n\n      if (rightElement && isTouchedWithinViewerContainer) {\n        var dropBounds = rightElement.getBoundingClientRect();\n        var xTouch = event.changedTouches[0].clientX;\n        var yTouch = event.changedTouches[0].clientY;\n        event.target.style.zIndex = '1000';\n        nodeElement = _this.getNodeElement(range, xTouch, yTouch, event, nodeElement);\n\n        if (nodeElement) {\n          // eslint-disable-next-line max-len\n          var currentDifference = Math.sqrt((yTouch - dropBounds.top) * (yTouch - dropBounds.top) + (xTouch - dropBounds.left) * (xTouch - dropBounds.left));\n\n          var isCloserMovement = _this.isCloserTouchScroll(currentDifference);\n\n          var isTextSelected = false;\n\n          if (yTouch <= dropBounds.top) {\n            _this.dropElementLeft.style.transform = 'rotate(0deg)';\n            _this.dropElementRight.style.transform = 'rotate(-90deg)';\n            isTextSelected = _this.selectTextByTouch(nodeElement.parentElement, xTouch, yTouch, false, 'left', isCloserMovement);\n          } else {\n            _this.dropElementLeft.style.transform = 'rotate(-90deg)';\n            _this.dropElementRight.style.transform = 'rotate(0deg)';\n            isTextSelected = _this.selectTextByTouch(nodeElement.parentElement, xTouch, yTouch, true, 'left', isCloserMovement);\n          }\n\n          if (isTextSelected) {\n            var elementClientRect = _this.dropDivElementLeft.getBoundingClientRect();\n\n            var pageTopValue = _this.pdfViewerBase.pageSize[_this.pdfViewerBase.currentPageNumber - 1].top;\n\n            var topClientValue = _this.getClientValueTop(yTouch, _this.pdfViewerBase.currentPageNumber - 1); // eslint-disable-next-line max-len\n\n\n            var currentPageLeft = _this.pdfViewerBase.getElement('_pageDiv_' + (_this.pdfViewerBase.currentPageNumber - 1)).getBoundingClientRect().left;\n\n            var currentRangeLeft = xTouch - currentPageLeft; // eslint-disable-next-line max-len\n\n            _this.dropDivElementLeft.style.top = pageTopValue * _this.pdfViewerBase.getZoomFactor() + topClientValue + 'px';\n            _this.topStoreLeft = {\n              pageTop: pageTopValue,\n              topClientValue: _this.getMagnifiedValue(topClientValue),\n              pageNumber: _this.pdfViewerBase.currentPageNumber - 1,\n              left: _this.getMagnifiedValue(currentRangeLeft),\n              isHeightNeeded: false\n            }; // eslint-disable-next-line max-len\n\n            _this.dropDivElementLeft.style.left = xTouch - _this.pdfViewerBase.viewerContainer.getBoundingClientRect().left - elementClientRect.width / 2 + 'px';\n            _this.previousScrollDifference = currentDifference;\n          }\n        }\n      }\n    }; // eslint-disable-next-line\n\n\n    this.onRightTouchSelectElementTouchMove = function (event) {\n      var range;\n      var nodeElement;\n      event.preventDefault();\n      event.target.style.zIndex = '0';\n      var leftElement = _this.dropDivElementLeft;\n\n      var isTouchedWithinViewerContainer = _this.isTouchedWithinContainer(event);\n\n      if (leftElement && isTouchedWithinViewerContainer) {\n        var dropPosition = leftElement.getBoundingClientRect();\n        var touchX = event.changedTouches[0].clientX;\n        var touchY = event.changedTouches[0].clientY;\n        event.target.style.zIndex = '1000';\n        nodeElement = _this.getNodeElement(range, touchX, touchY, event, nodeElement);\n\n        if (nodeElement) {\n          // eslint-disable-next-line max-len\n          var currentDifference = Math.sqrt((touchY - dropPosition.top) * (touchY - dropPosition.top) + (touchX - dropPosition.left) * (touchX - dropPosition.left));\n\n          var isCloserMovement = _this.isCloserTouchScroll(currentDifference);\n\n          var isTextSelected = false;\n\n          if (touchY >= dropPosition.top) {\n            _this.dropElementRight.style.transform = 'rotate(-90deg)';\n            _this.dropElementLeft.style.transform = 'rotate(0deg)';\n            isTextSelected = _this.selectTextByTouch(nodeElement.parentElement, touchX, touchY, true, 'right', isCloserMovement);\n          } else {\n            _this.dropElementRight.style.transform = 'rotate(0deg)';\n            _this.dropElementLeft.style.transform = 'rotate(-90deg)';\n            isTextSelected = _this.selectTextByTouch(nodeElement.parentElement, touchX, touchY, false, 'right', isCloserMovement);\n          }\n\n          if (isTextSelected) {\n            var pageTopValue = _this.pdfViewerBase.pageSize[_this.pdfViewerBase.currentPageNumber - 1].top;\n\n            var topClientValue = _this.getClientValueTop(touchY, _this.pdfViewerBase.currentPageNumber - 1);\n\n            var elementClientRect = _this.dropDivElementRight.getBoundingClientRect();\n\n            _this.dropDivElementRight.style.top = pageTopValue * _this.pdfViewerBase.getZoomFactor() + topClientValue + 'px'; // eslint-disable-next-line max-len\n\n            var currentPageLeft = _this.pdfViewerBase.getElement('_pageDiv_' + (_this.pdfViewerBase.currentPageNumber - 1)).getBoundingClientRect().left;\n\n            var currentRangeLeft = touchX - currentPageLeft; // eslint-disable-next-line max-len\n\n            _this.topStoreRight = {\n              pageTop: pageTopValue,\n              topClientValue: _this.getMagnifiedValue(topClientValue),\n              pageNumber: _this.pdfViewerBase.currentPageNumber - 1,\n              left: _this.getMagnifiedValue(currentRangeLeft),\n              isHeightNeeded: false\n            }; // eslint-disable-next-line max-len\n\n            _this.dropDivElementRight.style.left = touchX - _this.pdfViewerBase.viewerContainer.getBoundingClientRect().left - elementClientRect.width / 2 + 'px';\n            _this.previousScrollDifference = currentDifference;\n          }\n        }\n      }\n    };\n\n    this.pdfViewer = pdfViewer;\n    this.pdfViewerBase = pdfViewerBase;\n  }\n  /**\n   * @param target\n   * @param x\n   * @param y\n   * @param isExtended\n   * @private\n   */\n\n\n  TextSelection.prototype.textSelectionOnMouseMove = function (target, x, y, isExtended) {\n    var targetElement = target;\n    this.isTextSearched = true;\n\n    if (targetElement.nodeType === targetElement.TEXT_NODE) {\n      if (!this.isSelectionStartTriggered && !this.pdfViewerBase.getTextMarkupAnnotationMode()) {\n        this.pdfViewer.fireTextSelectionStart(this.pdfViewerBase.currentPageNumber);\n        this.isSelectionStartTriggered = true;\n      }\n\n      this.isBackwardPropagatedSelection = false;\n      var range = targetElement.ownerDocument.createRange();\n      var selection = window.getSelection();\n\n      if (selection.anchorNode !== null) {\n        var position = selection.anchorNode.compareDocumentPosition(selection.focusNode);\n\n        if (!position && selection.anchorOffset > selection.focusOffset || position === Node.DOCUMENT_POSITION_PRECEDING) {\n          this.isBackwardPropagatedSelection = true;\n        }\n      }\n\n      range.selectNodeContents(targetElement);\n      var currentPosition = 0;\n      var endPosition = range.endOffset;\n\n      while (currentPosition < endPosition) {\n        range.setStart(targetElement, currentPosition);\n        range.setEnd(targetElement, currentPosition + 1);\n        var rangeBounds = range.getBoundingClientRect();\n        var rightBounds = rangeBounds.right;\n\n        if (isExtended) {\n          // eslint-disable-next-line\n          rightBounds = parseInt(rangeBounds.right.toString());\n        } // eslint-disable-next-line max-len\n        // eslint-disable-next-line\n\n\n        if (rangeBounds.left <= x && rightBounds >= x && parseInt(rangeBounds.top.toString()) <= y && rangeBounds.bottom >= y) {\n          if (selection.anchorNode !== null && selection.anchorNode.parentNode.classList.contains('e-pv-text')) {\n            range.setStart(selection.anchorNode, selection.anchorOffset);\n          }\n\n          selection.removeAllRanges();\n          selection.addRange(range);\n\n          if (!this.isTextSelection) {\n            this.selectionStartPage = this.pdfViewerBase.currentPageNumber - 1;\n          }\n\n          this.isTextSelection = true; // eslint-disable-next-line\n\n          var isIE = !!document.documentMode;\n\n          if (!isIE) {\n            if (this.isBackwardPropagatedSelection) {\n              selection.extend(targetElement, currentPosition);\n            } else if (isExtended) {\n              selection.extend(targetElement, currentPosition);\n            } else {\n              selection.extend(targetElement, currentPosition + 1);\n            }\n          }\n\n          range.detach();\n        }\n\n        currentPosition += 1;\n      } // eslint-disable-next-line\n\n\n      var annotationModule = this.pdfViewer.annotationModule; // eslint-disable-next-line max-len\n\n      if (annotationModule && annotationModule.textMarkupAnnotationModule && annotationModule.textMarkupAnnotationModule.isEnableTextMarkupResizer(annotationModule.textMarkupAnnotationModule.currentTextMarkupAddMode)) {\n        // eslint-disable-next-line\n        var leftDivElement = document.getElementById(this.pdfViewer.element.id + '_droplet_left');\n\n        if (this.pdfViewerBase.isSelection && selection && selection.rangeCount > 0) {\n          // eslint-disable-next-line\n          var currentrange = selection.getRangeAt(0); // eslint-disable-next-line\n\n          var rect = currentrange.getBoundingClientRect();\n          var left = rect.left;\n          var top_1 = rect.top;\n          this.pdfViewer.annotation.textMarkupAnnotationModule.updateLeftposition(left, top_1);\n          this.pdfViewerBase.isSelection = false;\n        } else if (leftDivElement && leftDivElement.style.display === 'none') {\n          this.pdfViewer.annotation.textMarkupAnnotationModule.updateLeftposition(x, y);\n        }\n\n        this.pdfViewer.annotation.textMarkupAnnotationModule.updatePosition(x, y);\n      }\n    } else {\n      for (var i = 0; i < targetElement.childNodes.length; i++) {\n        if (targetElement.childNodes[i].nodeType === targetElement.TEXT_NODE) {\n          var range = this.getSelectionRange(i, targetElement);\n          var rangeBounds = range.getBoundingClientRect(); // eslint-disable-next-line max-len\n          // eslint-disable-next-line\n\n          if (rangeBounds.left <= x && rangeBounds.right >= parseInt(x.toString()) && parseInt(rangeBounds.top.toString()) <= y && rangeBounds.bottom >= y) {\n            range.detach();\n            this.textSelectionOnMouseMove(targetElement.childNodes[i], x, y, isExtended);\n          } else {\n            range.detach();\n          }\n        }\n      }\n    }\n  };\n  /**\n   * @param target\n   * @param x\n   * @param y\n   * @param isforward\n   * @param target\n   * @param x\n   * @param y\n   * @param isforward\n   * @param target\n   * @param x\n   * @param y\n   * @param isforward\n   * @private\n   */\n\n\n  TextSelection.prototype.textSelectionOnDrag = function (target, x, y, isforward) {\n    var targetElement = target;\n    this.isTextSearched = true;\n\n    if (targetElement.nodeType === targetElement.TEXT_NODE) {\n      this.isBackwardPropagatedSelection = false;\n      var range = targetElement.ownerDocument.createRange();\n      var selection = window.getSelection();\n\n      if (selection.anchorNode !== null) {\n        var position = selection.anchorNode.compareDocumentPosition(selection.focusNode);\n\n        if (!position && selection.anchorOffset > selection.focusOffset || position === Node.DOCUMENT_POSITION_PRECEDING) {\n          this.isBackwardPropagatedSelection = true;\n        }\n      }\n\n      range.selectNodeContents(targetElement);\n      var currentPosition = 0;\n      var endPosition = range.endOffset;\n\n      while (currentPosition < endPosition) {\n        range.setStart(targetElement, currentPosition);\n        range.setEnd(targetElement, currentPosition + 1);\n        var rangeBounds = range.getBoundingClientRect(); // eslint-disable-next-line max-len\n        // eslint-disable-next-line\n\n        if (rangeBounds.left <= x && rangeBounds.right >= x && parseInt(rangeBounds.top.toString()) <= y && rangeBounds.bottom >= y) {\n          if (isforward) {\n            // eslint-disable-next-line max-len\n            if (selection.anchorNode !== null && selection.anchorNode.parentNode.classList.contains('e-pv-text')) {\n              range.setStart(selection.anchorNode, selection.anchorOffset);\n            }\n\n            selection.removeAllRanges();\n            selection.addRange(range);\n            selection.extend(targetElement, currentPosition);\n          } else if (selection.focusNode) {\n            range.setEnd(selection.focusNode, selection.focusOffset);\n            selection.removeAllRanges();\n            selection.addRange(range);\n          }\n\n          if (!this.isTextSelection) {\n            this.selectionStartPage = this.pdfViewerBase.currentPageNumber - 1;\n          }\n\n          this.isTextSelection = true;\n          range.detach();\n          return true;\n        }\n\n        currentPosition += 1;\n      }\n\n      if (this.pdfViewerBase.isSelection) {\n        // eslint-disable-next-line\n        var currentrange = selection.getRangeAt(0); // eslint-disable-next-line\n\n        var rect = currentrange.getBoundingClientRect();\n        var left = rect.left;\n        var top_2 = rect.top;\n        this.pdfViewer.annotation.textMarkupAnnotationModule.updateLeftposition(left, top_2);\n        this.pdfViewerBase.isSelection = false;\n      }\n\n      this.pdfViewer.annotation.textMarkupAnnotationModule.updatePosition(x, y);\n    } else {\n      for (var i = 0; i < targetElement.childNodes.length; i++) {\n        if (targetElement.childNodes[i].nodeType === targetElement.TEXT_NODE) {\n          var range = this.getSelectionRange(i, targetElement);\n          var rangeBounds = range.getBoundingClientRect(); // eslint-disable-next-line max-len\n          // eslint-disable-next-line\n\n          if (rangeBounds.left <= x && rangeBounds.right >= x && parseInt(rangeBounds.top.toString()) <= y && rangeBounds.bottom >= y) {\n            range.detach();\n            this.textSelectionOnDrag(targetElement.childNodes[i], x, y, isforward);\n          } else {\n            range.detach();\n          }\n        }\n      }\n    }\n\n    return null;\n  };\n  /**\n   * Select the target text region in the PDF document of the given bounds.\n   *\n   * @param  {number} pageNumbers - Specifies the page number\n   * @param  {IRectangle[]} bounds -  Specifies the bounds of the texts.\n   * @returns void\n   */\n\n\n  TextSelection.prototype.selectTextRegion = function (pageNumbers, bounds) {\n    // eslint-disable-next-line\n    var element = null;\n    var pageNumber = pageNumbers - 1;\n\n    for (var k = 0; k < bounds.length; k++) {\n      // eslint-disable-next-line\n      var bound = bounds[k];\n      var x = (bound.left ? bound.left : bound.Left) * this.pdfViewerBase.getZoomFactor();\n      var y = (bound.top ? bound.top : bound.Top) * this.pdfViewerBase.getZoomFactor();\n      var width = (bound.width ? bound.width : bound.Width) * this.pdfViewerBase.getZoomFactor();\n      var height = bound.height ? bound.height : bound.Height; // eslint-disable-next-line\n\n      var textLayer = this.pdfViewerBase.getElement('_textLayer_' + pageNumber);\n\n      if (textLayer) {\n        // eslint-disable-next-line\n        var textDivs = textLayer.childNodes;\n\n        for (var n = 0; n < textDivs.length; n++) {\n          if (textDivs[n]) {\n            // eslint-disable-next-line\n            var rangebounds = textDivs[n].getBoundingClientRect();\n            var top_3 = this.getClientValueTop(rangebounds.top, pageNumber); // eslint-disable-next-line max-len\n\n            var currentLeft = rangebounds.left - this.pdfViewerBase.getElement('_pageDiv_' + pageNumber).getBoundingClientRect().left;\n            var totalLeft = currentLeft + rangebounds.width; // eslint-disable-next-line\n\n            var textDiVLeft = parseInt(textDivs[n].style.left); // eslint-disable-next-line\n\n            var currentTop = parseInt(textDivs[n].style.top);\n            var isLeftBounds = this.checkLeftBounds(currentLeft, textDiVLeft, totalLeft, x);\n            var isTopBounds = this.checkTopBounds(top_3, currentTop, y);\n\n            if (isLeftBounds && isTopBounds) {\n              element = textDivs[n];\n              break;\n            }\n          }\n        }\n\n        if (element != null) {\n          // eslint-disable-next-line\n          var boundingRect = this.pdfViewerBase.getElement('_textLayer_' + pageNumber).getBoundingClientRect();\n          this.textSelectionOnMouseMove(element, x + boundingRect.left, y + boundingRect.top, false);\n\n          if (bounds.length - 1 === k) {\n            // eslint-disable-next-line max-len\n            this.textSelectionOnMouseMove(element, x + boundingRect.left + width, y + boundingRect.top, false);\n          }\n        }\n      }\n    }\n  };\n  /**\n   * @param left\n   * @param textDiVLeft\n   * @param totalLeft\n   * @param x\n   * @private\n   */\n\n\n  TextSelection.prototype.checkLeftBounds = function (left, textDiVLeft, totalLeft, x) {\n    var isExists = false; // eslint-disable-next-line max-len\n    // eslint-disable-next-line\n\n    if (left === parseInt(x.toString()) || parseInt(left.toString()) === parseInt(x.toString()) || left + 1 === parseInt(x.toString()) || left - 1 === parseInt(x.toString()) // eslint-disable-next-line\n    || textDiVLeft === parseInt(x.toString()) || textDiVLeft === x || totalLeft >= x && left <= x) {\n      isExists = true;\n    }\n\n    return isExists;\n  };\n  /**\n   * @param top\n   * @param currentTop\n   * @param y\n   * @param top\n   * @param currentTop\n   * @param y\n   * @private\n   */\n\n\n  TextSelection.prototype.checkTopBounds = function (top, currentTop, y) {\n    var isExists = false; // eslint-disable-next-line max-len\n    // eslint-disable-next-line\n\n    if (top === parseInt(y.toString()) || parseInt(top.toString()) === parseInt(y.toString()) || parseInt((top + 1).toString()) === parseInt(y.toString()) || parseInt((top - 1).toString()) === parseInt(y.toString()) // eslint-disable-next-line\n    || currentTop === parseInt(y.toString()) || currentTop === y) {\n      isExists = true;\n    }\n\n    return isExists;\n  };\n  /**\n   * @param event\n   * @private\n   */\n\n\n  TextSelection.prototype.textSelectionOnMouseLeave = function (event) {\n    var _this = this;\n\n    event.preventDefault();\n    var viewerTop = this.pdfViewerBase.viewerContainer.offsetTop;\n\n    if (this.pdfViewer.magnificationModule) {\n      if (this.pdfViewer.magnificationModule.fitType === 'fitToPage') {\n        return;\n      }\n    }\n\n    if (event.clientY > viewerTop) {\n      this.scrollMoveTimer = setInterval(function () {\n        _this.scrollForwardOnSelection();\n      }, 500);\n    } else {\n      this.scrollMoveTimer = setInterval(function () {\n        _this.scrollBackwardOnSelection();\n      }, 500);\n    }\n  };\n\n  TextSelection.prototype.scrollForwardOnSelection = function () {\n    this.isMouseLeaveSelection = true;\n    this.pdfViewerBase.viewerContainer.scrollTop = this.pdfViewerBase.viewerContainer.scrollTop + 200;\n    this.stichSelectionOnScroll(this.pdfViewerBase.currentPageNumber - 1);\n  };\n\n  TextSelection.prototype.scrollBackwardOnSelection = function () {\n    this.isMouseLeaveSelection = true;\n    this.pdfViewerBase.viewerContainer.scrollTop = this.pdfViewerBase.viewerContainer.scrollTop - 200;\n    this.stichSelectionOnScroll(this.pdfViewerBase.currentPageNumber - 1);\n  };\n  /**\n   * @private\n   */\n\n\n  TextSelection.prototype.clear = function () {\n    if (this.scrollMoveTimer) {\n      this.isMouseLeaveSelection = false;\n      clearInterval(this.scrollMoveTimer);\n    }\n  };\n  /**\n   * @param element\n   * @param x\n   * @param y\n   * @param isStoreSelection\n   * @param element\n   * @param x\n   * @param y\n   * @param isStoreSelection\n   * @param element\n   * @param x\n   * @param y\n   * @param isStoreSelection\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  TextSelection.prototype.selectAWord = function (element, x, y, isStoreSelection) {\n    if (element.nodeType === element.TEXT_NODE) {\n      var selection = window.getSelection();\n      var range = element.ownerDocument.createRange();\n      range.selectNodeContents(element);\n      var currentPosition = 0;\n      var endPosition = range.endOffset;\n\n      while (currentPosition < endPosition) {\n        range.setStart(element, currentPosition);\n        range.setEnd(element, currentPosition + 1);\n        var rangeBounds = range.getBoundingClientRect();\n\n        if (rangeBounds.left <= x && rangeBounds.right >= x && rangeBounds.top <= y && rangeBounds.bottom >= y) {\n          var textContent = element.textContent;\n          var indices = [];\n          var startPosition = void 0;\n          var endPos = void 0;\n\n          for (var i = 0; i < textContent.length; i++) {\n            if (textContent[i] === ' ') {\n              indices.push(i);\n            }\n          }\n\n          for (var j = 0; j < indices.length; j++) {\n            if (currentPosition === indices[j]) {\n              startPosition = indices[j];\n              endPos = indices[j];\n            }\n\n            if (indices[0] > currentPosition) {\n              startPosition = 0;\n              endPos = indices[j];\n              break;\n            }\n\n            if (currentPosition > indices[j] && currentPosition < indices[j + 1]) {\n              startPosition = indices[j];\n              endPos = indices[j + 1];\n            } else if (currentPosition > indices[j]) {\n              if (!indices[j + 1]) {\n                startPosition = indices[j];\n              }\n            }\n          }\n\n          if (!endPos) {\n            endPos = textContent.length;\n          }\n\n          if (startPosition === 0) {\n            range.setStart(element, startPosition);\n          } else {\n            range.setStart(element, startPosition + 1);\n          }\n\n          range.setEnd(element, endPos);\n          selection.removeAllRanges();\n          selection.addRange(range);\n          this.isTextSelection = true; // eslint-disable-next-line max-len\n\n          var startParent = isNullOrUndefined(range.startContainer.parentElement) ? range.startContainer.parentNode : range.startContainer.parentElement; // eslint-disable-next-line radix\n\n          this.selectionStartPage = parseInt(startParent.id.split('_text_')[1]);\n\n          if (isStoreSelection) {\n            // eslint-disable-next-line max-len\n            this.selectionAnchorTouch = {\n              anchorNode: selection.anchorNode.parentElement.id,\n              anchorOffset: selection.anchorOffset\n            };\n            this.selectionFocusTouch = {\n              focusNode: selection.focusNode.parentElement.id,\n              focusOffset: selection.focusOffset\n            };\n          }\n\n          if (!Browser.isIE) {\n            range.detach();\n          }\n\n          break;\n        }\n\n        currentPosition += 1;\n      }\n    } else {\n      for (var i = 0; i < element.childNodes.length; i++) {\n        var range = this.getSelectionRange(i, element);\n        var rangeBounds = range.getBoundingClientRect();\n\n        if (rangeBounds.left <= x && rangeBounds.right >= x && rangeBounds.top <= y && rangeBounds.bottom >= y) {\n          range.detach();\n          this.selectAWord(element.childNodes[i], x, y, isStoreSelection);\n        } else {\n          range.detach();\n        }\n      }\n    }\n  };\n\n  TextSelection.prototype.getSelectionRange = function (index, element) {\n    var range = element.childNodes[index].ownerDocument.createRange();\n    range.selectNodeContents(element.childNodes[index]);\n    return range;\n  };\n  /**\n   * @param event\n   * @private\n   */\n\n\n  TextSelection.prototype.selectEntireLine = function (event) {\n    var textIds = [];\n    var targetElement = event.target;\n    var targetRect = targetElement.getBoundingClientRect(); // eslint-disable-next-line\n\n    var targetcentre = parseInt((targetRect.top + targetRect.height / 2).toString()); // eslint-disable-next-line radix\n\n    var pageNumber = parseInt(event.target.id.split('_text_')[1]);\n    var textDivs = document.querySelectorAll('div[id*=\"' + this.pdfViewer.element.id + '_text_' + pageNumber + '\"]');\n\n    if (targetElement.classList.contains('e-pv-text')) {\n      this.pdfViewer.fireTextSelectionStart(pageNumber + 1);\n\n      for (var i = 0; i < textDivs.length; i++) {\n        var rect = textDivs[i].getBoundingClientRect(); // eslint-disable-next-line radix\n\n        var topValue = parseInt(rect.top.toString()); // eslint-disable-next-line radix\n\n        var bottomValue = parseInt(rect.bottom.toString());\n\n        if (topValue <= targetcentre && bottomValue > targetcentre && targetRect.bottom + 10 > bottomValue) {\n          var textId = textDivs[i].id;\n\n          if (textId !== '') {\n            textIds.push(textId);\n          }\n        }\n      }\n\n      var selection = window.getSelection();\n      selection.removeAllRanges();\n      var range = document.createRange();\n      var lengths = textIds.length - 1;\n      var d1 = document.getElementById(textIds[0]);\n      var d2 = document.getElementById(textIds[lengths]);\n      var childNodes = d2.childNodes.length;\n\n      if (childNodes > 0) {\n        range.setStart(d1.childNodes[0], 0);\n        range.setEnd(d2.childNodes[0], d2.textContent.length);\n      } else {\n        range.setStart(d1.childNodes[0], 0);\n        range.setEnd(d2, 1);\n      } // eslint-disable-next-line radix\n\n\n      this.selectionStartPage = parseInt(range.startContainer.parentElement.id.split('_text_')[1]);\n      selection.addRange(range);\n      this.isTextSelection = true;\n\n      if (selection != null && this.pdfViewer.contextMenuSettings.contextMenuAction === 'MouseUp') {\n        this.calculateContextMenuPosition(event.clientY, event.clientY);\n      }\n    }\n  };\n  /**\n   * @private\n   */\n\n\n  TextSelection.prototype.enableTextSelectionMode = function () {\n    this.pdfViewerBase.isTextSelectionDisabled = false;\n    this.pdfViewerBase.viewerContainer.classList.remove('e-disable-text-selection');\n    this.pdfViewerBase.viewerContainer.classList.add('e-enable-text-selection');\n    this.pdfViewerBase.viewerContainer.addEventListener('selectstart', function () {\n      return true;\n    });\n  };\n\n  TextSelection.prototype.clearTextSelection = function () {\n    if (this.isTextSelection) {\n      this.pdfViewerBase.textLayer.clearDivSelection();\n\n      if (window.getSelection) {\n        if (window.getSelection().removeAllRanges) {\n          window.getSelection().removeAllRanges();\n        }\n      }\n\n      if (this.pdfViewer.linkAnnotationModule) {\n        var lowerPageIndex = this.pdfViewerBase.currentPageNumber - 3;\n        lowerPageIndex = lowerPageIndex < 0 ? 0 : lowerPageIndex;\n        var higherPageIndex = this.pdfViewer.currentPageNumber + 1; // eslint-disable-next-line max-len\n\n        higherPageIndex = higherPageIndex < this.pdfViewerBase.pageCount - 1 ? higherPageIndex : this.pdfViewerBase.pageCount - 1;\n\n        for (var i = lowerPageIndex; i <= higherPageIndex; i++) {\n          this.pdfViewer.linkAnnotationModule.modifyZindexForTextSelection(i, false);\n        }\n      }\n\n      if (this.pdfViewer.annotation && this.pdfViewer.annotation.textMarkupAnnotationModule) {\n        this.pdfViewer.annotation.textMarkupAnnotationModule.showHideDropletDiv(true);\n      }\n\n      this.selectionRangeArray = [];\n      this.isTextSelection = false;\n      this.isTouchSelection = false;\n\n      if (this.pdfViewer.textSearchModule) {\n        this.pdfViewer.textSearchModule.searchAfterSelection();\n      }\n\n      this.pdfViewerBase.contextMenuModule.close();\n      this.removeTouchElements();\n    }\n  };\n  /**\n   * @private\n   */\n\n\n  TextSelection.prototype.removeTouchElements = function () {\n    if (this.dropDivElementLeft) {\n      this.dropDivElementLeft.parentElement.removeChild(this.dropDivElementLeft);\n      this.dropDivElementLeft = null;\n      this.dropElementLeft.style.transform = 'rotate(0deg)';\n    }\n\n    if (this.dropDivElementRight) {\n      this.dropDivElementRight.parentElement.removeChild(this.dropDivElementRight);\n      this.dropDivElementRight = null;\n      this.dropElementRight.style.transform = 'rotate(-90deg)';\n    }\n  };\n  /**\n   * @private\n   */\n\n\n  TextSelection.prototype.resizeTouchElements = function () {\n    var viewerContainerLeft = this.pdfViewerBase.viewerContainer.getBoundingClientRect().left;\n\n    if (this.dropDivElementLeft) {\n      var elementClientRect = this.dropDivElementLeft.getBoundingClientRect();\n      var dropElementHeight = 0; // eslint-disable-next-line max-len\n\n      var leftCurrentPagePosition = this.pdfViewerBase.getElement('_pageDiv_' + this.topStoreLeft.pageNumber).getBoundingClientRect();\n      this.dropDivElementLeft.style.left = parseFloat(this.topStoreLeft.left.toString()) * this.pdfViewerBase.getZoomFactor() + leftCurrentPagePosition.left - viewerContainerLeft - elementClientRect.width / 2 + 'px';\n\n      if (this.topStoreLeft.isHeightNeeded) {\n        dropElementHeight = elementClientRect.height / 2 * this.pdfViewerBase.getZoomFactor();\n      } // eslint-disable-next-line max-len\n\n\n      this.dropDivElementLeft.style.top = parseFloat(this.topStoreLeft.pageTop.toString()) * this.pdfViewerBase.getZoomFactor() + parseFloat(this.topStoreLeft.topClientValue.toString()) * this.pdfViewerBase.getZoomFactor() + dropElementHeight + 'px';\n    }\n\n    if (this.dropDivElementRight) {\n      var elementClientRect = this.dropDivElementRight.getBoundingClientRect();\n      var dropElementHeight = 0; // eslint-disable-next-line max-len\n\n      var rightCurrentPagePosition = this.pdfViewerBase.getElement('_pageDiv_' + this.topStoreRight.pageNumber).getBoundingClientRect();\n      this.dropDivElementRight.style.left = parseFloat(this.topStoreRight.left.toString()) * this.pdfViewerBase.getZoomFactor() + rightCurrentPagePosition.left - viewerContainerLeft - elementClientRect.width / 2 + 'px';\n\n      if (this.topStoreRight.isHeightNeeded) {\n        dropElementHeight = elementClientRect.height / 2 * this.pdfViewerBase.getZoomFactor();\n      } // eslint-disable-next-line max-len\n\n\n      this.dropDivElementRight.style.top = parseFloat(this.topStoreRight.pageTop.toString()) * this.pdfViewerBase.getZoomFactor() + parseFloat(this.topStoreRight.topClientValue.toString()) * this.pdfViewerBase.getZoomFactor() + dropElementHeight + 'px';\n    }\n  };\n  /**\n   * @param event\n   * @private\n   */\n\n\n  TextSelection.prototype.textSelectionOnMouseup = function (event) {\n    this.clear();\n\n    if (window.getSelection().anchorNode !== null) {\n      this.isMouseLeaveSelection = false;\n      this.isSelectionStartTriggered = false;\n      this.maintainSelectionOnZoom(true, false);\n      this.fireTextSelectEnd();\n      var isTextSearch = this.pdfViewerBase.textLayer.getTextSearchStatus();\n\n      if (isTextSearch) {\n        this.pdfViewerBase.textLayer.clearDivSelection(); // eslint-disable-next-line\n\n        var indexes = this.pdfViewer.textSearchModule.getIndexes();\n        var lowerPageValue = parseFloat(indexes.lowerPageValue.toString());\n        var higherPageValue = parseFloat(indexes.higherPageValue.toString());\n\n        for (var i = lowerPageValue; i < higherPageValue; i++) {\n          this.applySelectionRangeOnScroll(i);\n        }\n\n        this.pdfViewer.textSearchModule.searchAfterSelection();\n      } else {\n        this.applySpanForSelection();\n      }\n\n      if (this.pdfViewer.linkAnnotationModule) {\n        this.pdfViewer.linkAnnotationModule.modifyZindexForTextSelection(this.pdfViewerBase.currentPageNumber - 1, false);\n      }\n\n      if (this.isTextSearched && this.pdfViewer.contextMenuSettings.contextMenuAction === 'MouseUp') {\n        this.calculateContextMenuPosition(event.clientY, event.clientX);\n        this.isTextSearched = false;\n      }\n    } else {\n      this.pdfViewerBase.textLayer.clearDivSelection();\n\n      if (this.pdfViewer.textSearchModule) {\n        this.pdfViewer.textSearchModule.searchAfterSelection();\n      }\n\n      this.pdfViewerBase.contextMenuModule.close();\n      this.removeTouchElements();\n    }\n  };\n  /**\n   * @private\n   */\n\n\n  TextSelection.prototype.fireTextSelectEnd = function () {\n    if (this.selectionRangeArray.length !== 0) {\n      var selectEndPageIndex = 0;\n      var selectedText = ''; // eslint-disable-next-line\n\n      var selectedBounds = [];\n\n      for (var k = 0; k < this.selectionRangeArray.length; k++) {\n        selectedText += this.selectionRangeArray[k].textContent;\n\n        for (var j = 0; j < this.selectionRangeArray[k].rectangleBounds.length; j++) {\n          var currentBound = this.selectionRangeArray[k].rectangleBounds[j]; // eslint-disable-next-line max-len\n\n          selectedBounds.push({\n            left: currentBound.left,\n            right: currentBound.right,\n            top: currentBound.top,\n            bottom: currentBound.bottom,\n            width: currentBound.width,\n            height: currentBound.height,\n            pageIndex: this.selectionRangeArray[k].pageNumber + 1\n          });\n        }\n\n        if (this.selectionRangeArray[k].isBackward && k === 0) {\n          selectEndPageIndex = this.selectionRangeArray[k].pageNumber + 1;\n        } else if (!this.selectionRangeArray[k].isBackward && k === this.selectionRangeArray.length - 1) {\n          selectEndPageIndex = this.selectionRangeArray[k].pageNumber + 1;\n        }\n      }\n\n      this.pdfViewer.fireTextSelectionEnd(selectEndPageIndex, selectedText, selectedBounds);\n    }\n  };\n  /**\n   * @param isMaintainSelection\n   * @param isStich\n   * @param isMaintainSelection\n   * @param isStich\n   * @private\n   */\n\n\n  TextSelection.prototype.maintainSelectionOnZoom = function (isMaintainSelection, isStich) {\n    var selection = window.getSelection();\n\n    if (selection.type === 'Range' || !selection.type && !selection.isCollapsed) {\n      var isBackward = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n\n      if (selection.anchorNode !== null) {\n        // eslint-disable-next-line radix\n        var anchorPageId = parseInt(this.getNodeElementFromNode(selection.anchorNode).id.split('_text_')[1]); // eslint-disable-next-line radix\n\n        var focusPageId = parseInt(this.getNodeElementFromNode(selection.focusNode).id.split('_text_')[1]);\n\n        if (this.isTouchSelection && isNaN(focusPageId)) {\n          var focusElement = selection.focusNode;\n\n          if (focusElement === this.pdfViewerBase.pageContainer) {\n            var lastChildNode = this.pdfViewerBase.pageContainer.lastChild;\n\n            if (lastChildNode.classList.contains('e-pv-touch-select-drop')) {\n              // eslint-disable-next-line radix\n              focusPageId = parseInt(lastChildNode.previousSibling.previousSibling.id.split('_pageDiv_')[1]);\n            } else if (lastChildNode.classList.contains('e-pv-page-div')) {\n              // eslint-disable-next-line radix\n              focusPageId = parseInt(lastChildNode.id.split('_pageDiv_')[1]);\n            }\n          }\n        }\n\n        if (!isBackward) {\n          for (var i = anchorPageId; i <= focusPageId; i++) {\n            this.maintainSelectionOnScroll(i, isStich);\n          }\n        } else {\n          for (var i = anchorPageId; i >= focusPageId; i--) {\n            this.maintainSelectionOnScroll(i, isStich);\n          }\n        }\n      }\n\n      if (!isMaintainSelection) {\n        selection.removeAllRanges();\n      }\n    }\n  };\n  /**\n   * @param pageNumber\n   * @private\n   */\n\n\n  TextSelection.prototype.isSelectionAvailableOnScroll = function (pageNumber) {\n    var isSelectionAvailable = false;\n    var ranges = this.selectionRangeArray;\n\n    for (var i = 0; i < ranges.length; i++) {\n      if (ranges[i] !== null) {\n        if (pageNumber === ranges[i].pageNumber) {\n          isSelectionAvailable = true;\n\n          if (this.isTouchSelection && !this.pdfViewerBase.getMagnified()) {\n            isSelectionAvailable = false;\n          }\n\n          break;\n        }\n      }\n    }\n\n    return isSelectionAvailable;\n  };\n  /**\n   * @param pageNumber\n   * @private\n   */\n\n\n  TextSelection.prototype.applySelectionRangeOnScroll = function (pageNumber) {\n    if (this.isMouseLeaveSelection) {\n      this.applySelectionMouseScroll(pageNumber);\n    } else {\n      this.applySelectionRange(pageNumber);\n    }\n  }; // eslint-disable-next-line\n\n\n  TextSelection.prototype.getSelectionRangeFromArray = function (pageNumber) {\n    var isSelectionAvailable = false;\n    var selectionRange = null;\n    var ranges = this.selectionRangeArray;\n\n    for (var i = 0; i < ranges.length; i++) {\n      if (ranges[i] !== null) {\n        if (pageNumber === ranges[i].pageNumber) {\n          selectionRange = ranges[i];\n          isSelectionAvailable = true;\n          break;\n        }\n      }\n    }\n\n    return {\n      isSelectionAvailable: isSelectionAvailable,\n      selectionRange: selectionRange\n    };\n  };\n\n  TextSelection.prototype.applySelectionRange = function (pageNumber) {\n    var selectionObject = this.getSelectionRangeFromArray(pageNumber);\n    var isSelectionAvailable = selectionObject.isSelectionAvailable;\n    var textLayer = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + pageNumber);\n\n    if (textLayer) {\n      if (isSelectionAvailable && textLayer.childNodes.length !== 0) {\n        var selectionRange = selectionObject.selectionRange;\n        var anchorOffsetDiv = void 0;\n        var focusOffsetDiv = void 0;\n        var anchorOffset = void 0;\n        var focusOffset = void 0;\n\n        if (selectionRange.isBackward) {\n          // eslint-disable-next-line radix\n          var startId = parseInt(selectionRange.endNode.split('_text_')[1].split('_')[1]); // eslint-disable-next-line radix\n\n          var endId = parseInt(selectionRange.startNode.split('_text_')[1].split('_')[1]);\n\n          if (startId < endId) {\n            anchorOffsetDiv = startId;\n            anchorOffset = selectionRange.endOffset;\n            focusOffset = selectionRange.startOffset;\n            focusOffsetDiv = endId;\n          } else {\n            anchorOffsetDiv = endId;\n            anchorOffset = selectionRange.endOffset;\n            focusOffsetDiv = startId;\n            focusOffset = selectionRange.startOffset;\n          }\n        } else {\n          // eslint-disable-next-line radix\n          anchorOffsetDiv = parseInt(selectionRange.startNode.split('text_')[1].split('_')[1]); // eslint-disable-next-line radix\n\n          focusOffsetDiv = parseInt(selectionRange.endNode.split('text_')[1].split('_')[1]);\n          anchorOffset = selectionRange.startOffset;\n          focusOffset = selectionRange.endOffset;\n        }\n\n        window.getSelection().removeAllRanges(); // eslint-disable-next-line max-len\n\n        this.pdfViewerBase.textLayer.applySpanForSelection(pageNumber, pageNumber, anchorOffsetDiv, focusOffsetDiv, anchorOffset, focusOffset);\n\n        if (this.pdfViewer.textSearchModule) {\n          this.pdfViewer.textSearchModule.searchAfterSelection();\n        }\n      }\n    }\n  };\n\n  TextSelection.prototype.applySelectionMouseScroll = function (pageNumber) {\n    var selectionObject = this.getSelectionRangeFromArray(pageNumber);\n    var isSelectionAvailable = selectionObject.isSelectionAvailable;\n\n    if (isSelectionAvailable) {\n      var selectionRange = selectionObject.selectionRange;\n      var selection = window.getSelection();\n      var anchorNode = document.getElementById(selectionRange.startNode).childNodes[0];\n      var focusNode = document.getElementById(selectionRange.endNode).childNodes[0];\n      var range = document.createRange();\n\n      if (selection.anchorNode === null) {\n        if (!selectionRange.isBackward) {\n          range.setStart(anchorNode, selectionRange.startOffset);\n          range.setEnd(focusNode, selectionRange.endOffset);\n        } else {\n          range.setStart(focusNode, selectionRange.endOffset);\n          range.setEnd(anchorNode, selectionRange.startOffset);\n        }\n      } else {\n        // eslint-disable-next-line\n        var anchorPageIndex = isNaN(parseInt(selection.anchorNode.parentElement.id.split('_text_')[1])) ? parseInt(selection.anchorNode.id.split('_pageDiv_')[1]) : parseInt(selection.anchorNode.parentElement.id.split('_text_')[1]);\n\n        if (isNaN(anchorPageIndex)) {\n          // eslint-disable-next-line radix\n          anchorPageIndex = parseInt(selection.anchorNode.id.split('_text_')[1]);\n        } // eslint-disable-next-line\n\n\n        var focusPageIndex = isNaN(parseInt(selection.focusNode.parentElement.id.split('_text_')[1])) ? parseInt(selection.focusNode.id.split('_pageDiv_')[1]) : parseInt(selection.focusNode.parentElement.id.split('_text_')[1]); // eslint-disable-next-line radix\n\n        var currentAnchorIndex = parseInt(selectionRange.startNode.split('_text_')[1]);\n\n        if (anchorPageIndex === focusPageIndex && anchorPageIndex === currentAnchorIndex) {\n          if (!selectionRange.isBackward) {\n            range.setStart(anchorNode, selectionRange.startOffset);\n            range.setEnd(focusNode, selectionRange.endOffset);\n          } else {\n            range.setStart(focusNode, selectionRange.endOffset);\n            range.setEnd(anchorNode, selectionRange.startOffset);\n          }\n        } else if (!isNaN(anchorPageIndex)) {\n          if (!isNaN(anchorPageIndex) && !selectionRange.isBackward) {\n            // eslint-disable-next-line max-len\n            if (anchorPageIndex < currentAnchorIndex && currentAnchorIndex < focusPageIndex && anchorPageIndex !== focusPageIndex) {\n              range.setStart(selection.anchorNode, selection.anchorOffset);\n              range.setEnd(selection.focusNode, selection.focusOffset);\n            } else if (anchorPageIndex < currentAnchorIndex) {\n              range.setStart(selection.anchorNode, selection.anchorOffset);\n              range.setEnd(focusNode, selectionRange.endOffset);\n            } else {\n              range.setStart(anchorNode, selectionRange.startOffset);\n              range.setEnd(selection.focusNode, selection.focusOffset);\n            }\n          } else {\n            var isBackward = this.pdfViewerBase.textLayer.isBackWardSelection(selection); // eslint-disable-next-line max-len\n\n            if (anchorPageIndex > currentAnchorIndex && currentAnchorIndex > focusPageIndex && anchorPageIndex !== focusPageIndex) {\n              if (!isBackward) {\n                range.setStart(selection.anchorNode, selection.anchorOffset);\n                range.setEnd(selection.focusNode, selection.focusOffset);\n              } else {\n                selection.extend(selection.focusNode, selection.focusOffset);\n              } // eslint-disable-next-line max-len\n\n            } else if (anchorPageIndex < currentAnchorIndex && currentAnchorIndex < focusPageIndex && anchorPageIndex !== focusPageIndex) {\n              if (!isBackward) {\n                range.setStart(selection.anchorNode, selection.anchorOffset);\n                range.setEnd(selection.focusNode, selection.focusOffset);\n              } else {\n                selection.extend(selection.focusNode, selection.focusOffset);\n              }\n            } else if (anchorPageIndex < currentAnchorIndex) {\n              if (!isBackward) {\n                if (currentAnchorIndex !== this.selectionRangeArray[0].pageNumber) {\n                  range.setStart(selection.anchorNode, selection.anchorOffset);\n                  range.setEnd(focusNode, selectionRange.endOffset);\n                } else {\n                  range.setStart(selection.anchorNode, selection.anchorOffset);\n                  range.setEnd(anchorNode, selectionRange.startOffset);\n                }\n              } else {\n                if (currentAnchorIndex !== this.selectionRangeArray[0].pageNumber) {\n                  this.extendCurrentSelection(focusNode.parentElement, selectionRange.endOffset, selection, range);\n                } else {\n                  this.extendCurrentSelection(anchorNode.parentElement, selectionRange.startOffset, selection, range);\n                }\n              }\n            } else if (anchorPageIndex === currentAnchorIndex) {\n              if (currentAnchorIndex === focusPageIndex) {\n                range.setStart(anchorNode, selectionRange.startOffset);\n                range.setEnd(anchorNode, selectionRange.startOffset);\n                selection.removeAllRanges();\n                selection.addRange(range);\n                range = document.createRange();\n                selection.extend(focusNode, selectionRange.endOffset);\n              } else {\n                if (isBackward) {\n                  this.extendCurrentSelection(focusNode.parentElement, selectionRange.endOffset, selection, range);\n                } else {\n                  range.setStart(focusNode, selectionRange.endOffset);\n                  range.setEnd(selection.focusNode, selection.focusOffset);\n                }\n              }\n            } else if (focusPageIndex === currentAnchorIndex) {\n              if (isBackward) {\n                selection.extend(selection.focusNode, selection.focusOffset);\n              } else {\n                range.setStart(selection.anchorNode, selection.anchorOffset);\n                range.setEnd(selection.focusNode, selection.focusOffset);\n              }\n            } else if (anchorPageIndex > currentAnchorIndex) {\n              // eslint-disable-next-line radix\n              var currentAnchorOffset = parseInt(selectionRange.startNode.split('_' + currentAnchorIndex + '_')[1]); // eslint-disable-next-line radix\n\n              var currentFocusOffset = parseInt(selectionRange.endNode.split('_' + currentAnchorIndex + '_')[1]);\n\n              if (isBackward) {\n                if (currentAnchorIndex !== this.selectionRangeArray[0].pageNumber) {\n                  if (currentAnchorOffset < currentFocusOffset) {\n                    this.extendCurrentSelection(anchorNode.parentElement, selectionRange.startOffset, selection, range);\n                  } else {\n                    range.setStart(focusNode.parentElement, selectionRange.endOffset);\n                    range.setEnd(selection.anchorNode, selection.anchorOffset);\n                  }\n                } else {\n                  this.extendCurrentSelection(focusNode.parentElement, selectionRange.endOffset, selection, range);\n                }\n              } else {\n                if (currentAnchorOffset < currentFocusOffset) {\n                  range.setStart(anchorNode, selectionRange.startOffset);\n                  range.setEnd(selection.focusNode, selection.focusOffset);\n                } else {\n                  range.setStart(focusNode, selectionRange.endOffset);\n                  range.setEnd(selection.focusNode, selection.focusOffset);\n                }\n              }\n            }\n          }\n        } else if (isNaN(anchorPageIndex)) {\n          if (!selectionRange.isBackward) {\n            range.setStart(anchorNode, selectionRange.startOffset);\n            range.setEnd(focusNode, selectionRange.endOffset);\n          } else {\n            range.setStart(focusNode, selectionRange.endOffset);\n            range.setEnd(anchorNode, selectionRange.startOffset);\n          }\n        }\n      }\n\n      if (range.toString() !== '') {\n        selection.removeAllRanges();\n        selection.addRange(range);\n      }\n    }\n  };\n  /**\n   * @param pageNumber\n   * @param isStich\n   * @param pageNumber\n   * @param isStich\n   * @private\n   */\n\n\n  TextSelection.prototype.maintainSelectionOnScroll = function (pageNumber, isStich) {\n    var isSelectionAvailable = this.isSelectionAvailableOnScroll(pageNumber);\n\n    if (this.isTextSelection && !isSelectionAvailable) {\n      this.maintainSelection(pageNumber, isStich);\n    }\n  };\n  /**\n   * @param pageNumber\n   * @param isStich\n   * @private\n   */\n\n\n  TextSelection.prototype.maintainSelection = function (pageNumber, isStich) {\n    var selection = window.getSelection();\n\n    if (this.isTextSelection && (selection.type === 'Range' || !selection.type && !selection.isCollapsed)) {\n      // eslint-disable-next-line\n      var anchorPageId = parseInt(this.getNodeElementFromNode(selection.anchorNode).id.split('_text_')[1]); // eslint-disable-next-line\n\n      var focusPageId = parseInt(this.getNodeElementFromNode(selection.focusNode).id.split('_text_')[1]);\n\n      if (isNaN(focusPageId) && selection.anchorNode !== null) {\n        var backward_1 = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n\n        if (!backward_1) {\n          // eslint-disable-next-line radix\n          var lastChildNode = this.pdfViewerBase.pageContainer.lastChild;\n\n          if (lastChildNode.classList.contains('e-pv-touch-select-drop')) {\n            // eslint-disable-next-line radix\n            focusPageId = parseInt(lastChildNode.previousSibling.previousSibling.id.split('_pageDiv_')[1]);\n          } else {\n            // eslint-disable-next-line radix\n            focusPageId = parseInt(lastChildNode.id.split('_pageDiv_')[1]);\n          }\n        } else {\n          // eslint-disable-next-line radix\n          focusPageId = parseInt(this.pdfViewerBase.pageContainer.firstChild.id.split('_pageDiv_')[1]);\n        }\n      }\n\n      var backward = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n\n      if (this.isTouchSelection && pageNumber > focusPageId && pageNumber > anchorPageId) {\n        return;\n      }\n\n      if (anchorPageId === focusPageId) {\n        var selectionObject = null;\n        var selectionBounds = this.getSelectionBounds(selection.getRangeAt(0), pageNumber);\n        var selectionRectBounds = this.getSelectionRectangleBounds(selection.getRangeAt(0), pageNumber); // eslint-disable-next-line max-len\n\n        var anchorOffsetValue = this.getNodeElementFromNode(selection.anchorNode).childNodes.length === 1 ? selection.anchorOffset : this.getCorrectOffset(selection.anchorNode, selection.anchorOffset);\n        var focusOffsetValue = this.getNodeElementFromNode(selection.focusNode).childNodes.length === 1 ? selection.focusOffset : this.getCorrectOffset(selection.focusNode, selection.focusOffset);\n        selectionObject = {\n          isBackward: backward,\n          startNode: this.getNodeElementFromNode(selection.anchorNode).id,\n          startOffset: anchorOffsetValue,\n          endNode: this.getNodeElementFromNode(selection.focusNode).id,\n          // eslint-disable-next-line max-len\n          endOffset: focusOffsetValue,\n          textContent: selection.toString(),\n          pageNumber: pageNumber,\n          bound: selectionBounds,\n          rectangleBounds: selectionRectBounds\n        };\n        this.pushSelectionRangeObject(selectionObject, pageNumber);\n      } else {\n        var selectionObject = this.createRangeObjectOnScroll(pageNumber, anchorPageId, focusPageId);\n\n        if (selectionObject) {\n          this.pushSelectionRangeObject(selectionObject, pageNumber);\n\n          if (isStich) {\n            this.stichSelection(backward, selection, pageNumber);\n          }\n        }\n      }\n    }\n  };\n\n  TextSelection.prototype.getCorrectOffset = function (node, offset) {\n    var offsetValue = 0;\n    var parentElement = this.getNodeElementFromNode(node);\n\n    for (var i = 0; i < parentElement.childNodes.length; i++) {\n      if (parentElement.childNodes[i] === node) {\n        offsetValue = offsetValue + offset;\n        break;\n      } else {\n        offsetValue = offsetValue + parentElement.childNodes[i].textContent.length;\n      }\n    }\n\n    return offsetValue;\n  };\n\n  TextSelection.prototype.pushSelectionRangeObject = function (selectionObject, pageNumber) {\n    if (this.isTouchSelection) {\n      var currentObject = this.selectionRangeArray.filter( // eslint-disable-next-line\n      function (obj) {\n        return obj.pageNumber === pageNumber;\n      });\n\n      if (currentObject.length > 0) {\n        var currentObjectIndex = this.selectionRangeArray.indexOf(currentObject[0]);\n        this.selectionRangeArray.splice(currentObjectIndex, 1, selectionObject);\n        return;\n      }\n    }\n\n    var nextPageObject = this.selectionRangeArray.filter( // eslint-disable-next-line\n    function (obj) {\n      return obj.pageNumber === pageNumber + 1;\n    });\n\n    if (nextPageObject.length === 0) {\n      if (this.isTouchSelection && this.selectionRangeArray.length !== 0) {\n        var prevPageObject = this.selectionRangeArray.filter( // eslint-disable-next-line\n        function (obj) {\n          return obj.pageNumber === pageNumber - 1;\n        });\n\n        if (prevPageObject.length !== 0) {\n          var prevIndex = this.selectionRangeArray.indexOf(prevPageObject[0]);\n          this.selectionRangeArray.splice(prevIndex + 1, 0, selectionObject);\n        } else {\n          var firstObject = this.selectionRangeArray[0];\n\n          if (pageNumber < firstObject.pageNumber) {\n            this.selectionRangeArray.splice(0, 0, selectionObject);\n          } else {\n            this.selectionRangeArray.push(selectionObject);\n          }\n        }\n      } else {\n        this.selectionRangeArray.push(selectionObject);\n      }\n    } else {\n      var index = this.selectionRangeArray.indexOf(nextPageObject[0]);\n      this.selectionRangeArray.splice(index, 0, selectionObject);\n    }\n  };\n\n  TextSelection.prototype.extendCurrentSelection = function (element, offset, selection, range) {\n    var currentFocusOffset = selection.focusOffset;\n    var currentFocusElement = selection.focusNode.parentElement.id; // eslint-disable-next-line\n\n    var focusPageId = isNaN(parseInt(currentFocusElement.split('_text_')[1])) ? parseInt(selection.focusNode.id.split('_pageDiv_')[1]) : parseInt(currentFocusElement.split('_text_')[1]); // eslint-disable-next-line radix\n\n    if (isNaN(parseInt(currentFocusElement.split('_text_')[1]))) {\n      // eslint-disable-next-line\n      currentFocusElement = this.pdfViewerBase.getElement('_textLayer_' + (focusPageId + 1)).firstChild.id;\n    }\n\n    range.setStart(element.childNodes[0], offset);\n    range.setEnd(element.childNodes[0], offset);\n    selection.removeAllRanges();\n    selection.addRange(range);\n    selection.extend(document.getElementById(currentFocusElement).childNodes[0], currentFocusOffset);\n  };\n\n  TextSelection.prototype.stichSelection = function (backward, selection, pageNumber) {\n    var range = document.createRange();\n    var nextPageElement;\n\n    if (backward) {\n      nextPageElement = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + (pageNumber - 1));\n\n      if (nextPageElement) {\n        var lastElement = nextPageElement.lastChild;\n\n        if (lastElement) {\n          this.extendCurrentSelection(lastElement, this.getTextLastLength(lastElement), selection, range);\n        } else {\n          nextPageElement = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + (pageNumber - 2));\n          lastElement = nextPageElement.lastChild;\n          this.extendCurrentSelection(lastElement, this.getTextLastLength(lastElement), selection, range);\n        }\n      } else {\n        nextPageElement = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + (pageNumber + 1));\n        var lastElement = nextPageElement.firstChild;\n        this.extendCurrentSelection(lastElement, 0, selection, range);\n      }\n    } else {\n      nextPageElement = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + (pageNumber + 1));\n\n      if (nextPageElement) {\n        var firstElement = nextPageElement.firstChild;\n\n        if (!firstElement) {\n          nextPageElement = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + (pageNumber + 2));\n          firstElement = nextPageElement.firstChild;\n          range.setStart(firstElement.childNodes[0], 0);\n        } else {\n          range.setStart(firstElement.childNodes[0], 0);\n        }\n\n        range.setEnd(selection.focusNode, selection.focusOffset);\n        selection.removeAllRanges();\n        selection.addRange(range);\n      }\n    }\n  };\n  /**\n   * @param currentPageNumber\n   * @private\n   */\n\n\n  TextSelection.prototype.textSelectionOnMouseWheel = function (currentPageNumber) {\n    this.isMouseLeaveSelection = true;\n    this.stichSelectionOnScroll(currentPageNumber);\n  };\n  /**\n   * @param currentPageNumber\n   * @private\n   */\n\n\n  TextSelection.prototype.stichSelectionOnScroll = function (currentPageNumber) {\n    var selection = window.getSelection();\n\n    if (this.isTextSelection) {\n      // eslint-disable-next-line radix\n      var anchorPageId = parseInt(this.getNodeElementFromNode(selection.anchorNode).id.split('_text_')[1]); // eslint-disable-next-line radix\n\n      var focusPageId = parseInt(this.getNodeElementFromNode(selection.focusNode).id.split('_text_')[1]);\n      var nextPageElement = void 0;\n\n      if (anchorPageId !== currentPageNumber && focusPageId !== currentPageNumber) {\n        var backward = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n\n        if (!backward) {\n          nextPageElement = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + (currentPageNumber - 1));\n\n          if (nextPageElement) {\n            var lastElement = nextPageElement.lastChild;\n\n            if (lastElement) {\n              if (lastElement.childNodes[0]) {\n                this.extendSelectionStich(lastElement.childNodes[0], this.getTextLastLength(lastElement), selection);\n              } else {\n                this.extendSelectionStich(lastElement, this.getTextLastLength(lastElement), selection);\n              }\n            } else {\n              nextPageElement = this.pdfViewerBase.getElement('_textLayer_' + currentPageNumber);\n              var lastElement_1 = nextPageElement.firstChild;\n              this.extendSelectionStich(lastElement_1.childNodes[0], 0, selection);\n            }\n          }\n        } else {\n          nextPageElement = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + (currentPageNumber - 1));\n\n          if (nextPageElement) {\n            var lastElement = nextPageElement.firstChild;\n\n            if (lastElement) {\n              this.extendSelectionStich(lastElement.childNodes[0], 0, selection);\n            }\n          }\n        }\n      }\n\n      this.maintainSelectionArray();\n    }\n  };\n\n  TextSelection.prototype.extendSelectionStich = function (node, offset, selection) {\n    if (selection.extend) {\n      selection.extend(node, offset);\n    }\n  };\n  /**\n   * @param pageNumber\n   * @param anchorPageId\n   * @param focusPageId\n   * @param pageNumber\n   * @param anchorPageId\n   * @param focusPageId\n   * @private\n   */\n\n\n  TextSelection.prototype.createRangeObjectOnScroll = function (pageNumber, anchorPageId, focusPageId) {\n    var selectionObject = null;\n    var selection = window.getSelection();\n\n    if (selection.anchorNode !== null) {\n      var backward = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n      var firstElement = void 0;\n      var lastElement = void 0;\n      var startOffset = void 0;\n      var endOffset = void 0;\n      var element = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + pageNumber);\n\n      if (element.childNodes) {\n        if (!backward) {\n          if (pageNumber === anchorPageId) {\n            firstElement = this.getNodeElementFromNode(selection.anchorNode); // eslint-disable-next-line max-len\n\n            lastElement = element.lastChild;\n            startOffset = this.getCorrectOffset(selection.anchorNode, selection.anchorOffset);\n            endOffset = this.getTextLastLength(lastElement);\n          } else if (pageNumber > anchorPageId && pageNumber < focusPageId) {\n            // eslint-disable-next-line max-len\n            firstElement = element.firstChild; // eslint-disable-next-line max-len\n\n            lastElement = element.lastChild;\n            startOffset = 0;\n            endOffset = this.getTextLastLength(lastElement);\n          } else if (pageNumber === focusPageId) {\n            // eslint-disable-next-line max-len\n            firstElement = element.firstChild;\n            var pageNumberIndex = this.getNodeElementFromNode(selection.focusNode).id.indexOf(focusPageId.toString());\n\n            if (pageNumberIndex !== -1) {\n              lastElement = this.getNodeElementFromNode(selection.focusNode);\n              endOffset = this.getCorrectOffset(selection.focusNode, selection.focusOffset);\n            } else {\n              // eslint-disable-next-line max-len\n              lastElement = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + focusPageId).lastChild;\n              endOffset = this.getTextLastLength(lastElement);\n            }\n\n            startOffset = 0;\n          }\n        } else {\n          if (pageNumber === anchorPageId) {\n            firstElement = this.getNodeElementFromNode(selection.anchorNode); // eslint-disable-next-line max-len\n\n            lastElement = element.firstChild;\n            startOffset = this.getCorrectOffset(selection.anchorNode, selection.anchorOffset);\n            endOffset = 0;\n          } else if (pageNumber < anchorPageId && pageNumber > focusPageId) {\n            // eslint-disable-next-line max-len\n            firstElement = element.firstChild; // eslint-disable-next-line max-len\n\n            lastElement = element.lastChild;\n            startOffset = 0;\n            endOffset = this.getTextLastLength(lastElement);\n          } else if (pageNumber === focusPageId) {\n            firstElement = this.getNodeElementFromNode(selection.focusNode); // eslint-disable-next-line max-len\n\n            lastElement = element.lastChild;\n            startOffset = this.getCorrectOffset(selection.focusNode, selection.focusOffset);\n            endOffset = this.getTextLastLength(lastElement);\n          }\n        }\n\n        if (firstElement && lastElement) {\n          // eslint-disable-next-line max-len\n          var selectionRangeObject = this.getSelectionRangeObject(firstElement.id, startOffset, lastElement.id, endOffset, pageNumber);\n          var selectionString = selectionRangeObject.toString();\n          var selectionBound = this.getSelectionBounds(selectionRangeObject, pageNumber);\n          var selectionRectBounds = this.getSelectionRectangleBounds(selectionRangeObject, pageNumber); // eslint-disable-next-line max-len\n\n          return selectionObject = {\n            isBackward: backward,\n            startNode: firstElement.id,\n            startOffset: startOffset,\n            endNode: lastElement.id,\n            endOffset: endOffset,\n            textContent: selectionString,\n            pageNumber: pageNumber,\n            bound: selectionBound,\n            rectangleBounds: selectionRectBounds\n          };\n        } else {\n          return null;\n        }\n      }\n    }\n\n    return null;\n  };\n\n  TextSelection.prototype.getSelectionRangeObject = function (startNode, startOffset, endNode, endOffset, pageNumber) {\n    var startElement = document.getElementById(startNode);\n    var endElement = document.getElementById(endNode);\n\n    if (startElement.childNodes[0]) {\n      startElement = startElement.childNodes[0];\n    }\n\n    if (endElement.childNodes[0]) {\n      endElement = endElement.childNodes[0];\n    } // eslint-disable-next-line radix\n\n\n    var currentAnchorOffset = parseInt(startNode.split('_' + pageNumber + '_')[1]); // eslint-disable-next-line radix\n\n    var currentFocusOffset = parseInt(endNode.split('_' + pageNumber + '_')[1]);\n    var range = document.createRange();\n\n    if (currentAnchorOffset <= currentFocusOffset) {\n      range.setStart(startElement, startOffset);\n      range.setEnd(endElement, endOffset);\n    } else {\n      range.setStart(endElement, endOffset);\n      range.setEnd(startElement, startOffset);\n    }\n\n    return range;\n  };\n\n  TextSelection.prototype.getSelectionBounds = function (range, pageNumber) {\n    var startElement = this.getNodeElementFromNode(range.startContainer);\n    var endElement = this.getNodeElementFromNode(range.endContainer);\n    var bounds = null;\n\n    if (startElement !== endElement) {\n      var newStartRange = document.createRange(); // eslint-disable-next-line max-len\n\n      var startRange = this.createRangeForSelection(range.startContainer, range.endContainer, range.startOffset, range.endOffset, newStartRange);\n      bounds = this.normalizeBounds(startRange.getBoundingClientRect(), pageNumber);\n    } else {\n      bounds = this.normalizeBounds(range.getBoundingClientRect(), pageNumber);\n    }\n\n    return bounds;\n  };\n\n  TextSelection.prototype.getSelectionRectangleBounds = function (range, pageNumber) {\n    var selectionBounds = [];\n    var startElement = this.getNodeElementFromNode(range.startContainer);\n    var endElement = this.getNodeElementFromNode(range.endContainer);\n    var bounds = null;\n\n    if (startElement !== endElement) {\n      var startOffset = 0;\n      var endOffset = 0;\n      var currentId = 0;\n      var anchorPageId = this.pdfViewerBase.textLayer.getPageIndex(range.startContainer);\n      var anchorTextId = this.pdfViewerBase.textLayer.getTextIndex(range.startContainer, anchorPageId);\n      var focusPageId = this.pdfViewerBase.textLayer.getPageIndex(range.endContainer);\n      var focusTextId = this.pdfViewerBase.textLayer.getTextIndex(range.endContainer, focusPageId);\n      var textDivs = this.pdfViewerBase.getElement('_textLayer_' + focusPageId).childNodes;\n\n      if (pageNumber === anchorPageId) {\n        currentId = anchorTextId;\n      } else {\n        currentId = 0;\n      }\n\n      for (var j = currentId; j < textDivs.length; j++) {\n        var textElement = textDivs[j];\n\n        if (j === anchorTextId) {\n          startOffset = range.startOffset;\n        } else {\n          startOffset = 0;\n        }\n\n        if (j === focusTextId) {\n          endOffset = range.endOffset;\n        } else {\n          endOffset = textElement.textContent.length;\n        }\n\n        if (startOffset !== 0 || endOffset !== 0) {\n          var newRange = document.createRange();\n\n          for (var k = 0; k < textElement.childNodes.length; k++) {\n            var node = textElement.childNodes[k];\n            newRange.setStart(node, startOffset);\n            newRange.setEnd(node, endOffset);\n          }\n\n          var boundingRect = this.normalizeBounds(newRange.getBoundingClientRect(), pageNumber);\n          selectionBounds.push(boundingRect);\n          newRange.detach();\n\n          if (j === focusTextId) {\n            break;\n          }\n        }\n      }\n    } else {\n      bounds = this.normalizeBounds(range.getBoundingClientRect(), pageNumber);\n      selectionBounds.push(bounds);\n    }\n\n    return selectionBounds;\n  };\n\n  TextSelection.prototype.getTextId = function (elementId) {\n    var index = elementId.lastIndexOf('_');\n    var divId = elementId.substring(index + 1, elementId.length); // eslint-disable-next-line radix\n\n    return parseInt(divId);\n  };\n\n  TextSelection.prototype.normalizeBounds = function (bound, pageNumber) {\n    var newBounds = null;\n    var currentPageElement = this.pdfViewerBase.getElement('_pageDiv_' + pageNumber);\n\n    if (this.pdfViewerBase.isMixedSizeDocument) {\n      var currentTextElement = this.pdfViewerBase.getElement('_textLayer_' + pageNumber);\n\n      if (currentTextElement) {\n        currentPageElement = currentTextElement;\n      }\n    }\n\n    var currentPageRect = currentPageElement.getBoundingClientRect();\n    newBounds = {\n      bottom: this.getMagnifiedValue(bound.bottom - currentPageRect.top),\n      height: this.getMagnifiedValue(bound.height),\n      left: this.getMagnifiedValue(bound.left - currentPageRect.left),\n      top: this.getMagnifiedValue(bound.top - currentPageRect.top),\n      right: this.getMagnifiedValue(bound.right - currentPageRect.left),\n      width: this.getMagnifiedValue(bound.width)\n    };\n    return newBounds;\n  };\n\n  TextSelection.prototype.getMagnifiedValue = function (value) {\n    return value / this.pdfViewerBase.getZoomFactor();\n  };\n  /**\n   * @param pageNumber\n   * @private\n   */\n\n\n  TextSelection.prototype.getCurrentSelectionBounds = function (pageNumber) {\n    var bound = null;\n    var ranges = this.selectionRangeArray;\n\n    for (var i = 0; i < ranges.length; i++) {\n      if (ranges[i] !== null) {\n        if (pageNumber === ranges[i].pageNumber) {\n          bound = ranges[i].bound;\n        }\n      }\n    }\n\n    return bound;\n  };\n\n  TextSelection.prototype.createRangeForSelection = function (start, end, startOffset, endOffset, range) {\n    range.setStart(start, startOffset);\n    range.setEnd(end, endOffset);\n    return range;\n  };\n\n  TextSelection.prototype.maintainSelectionArray = function () {\n    var _this = this;\n\n    if (this.selectionRangeArray.length !== 0) {\n      var selection = window.getSelection();\n      var isBackward = this.pdfViewerBase.textLayer.isBackWardSelection(selection); // eslint-disable-next-line\n\n      var anchorPage = isNaN(parseInt(this.getNodeElementFromNode(selection.anchorNode).id.split('_text_')[1])) ? parseInt(selection.anchorNode.id.split('_pageDiv_')[1]) : parseInt(this.getNodeElementFromNode(selection.anchorNode).id.split('_text_')[1]);\n\n      if (isNaN(anchorPage)) {\n        // eslint-disable-next-line radix\n        anchorPage = parseInt(selection.anchorNode.id.split('_text_')[1]);\n      } // eslint-disable-next-line\n\n\n      var focusPage_1 = isNaN(parseInt(this.getNodeElementFromNode(selection.focusNode).id.split('_text_')[1])) ? parseInt(selection.focusNode.id.split('_pageDiv_')[1]) : parseInt(this.getNodeElementFromNode(selection.focusNode).id.split('_text_')[1]);\n\n      if (isNaN(focusPage_1)) {\n        // eslint-disable-next-line\n        focusPage_1 = isNaN(parseInt(selection.focusNode.id.split('_text_')[1])) ? parseInt(selection.focusNode.id.split('_textLayer_')[1]) : parseInt(selection.focusNode.id.split('_text_')[1]);\n      }\n\n      var arrayObject = [];\n\n      if (!isBackward) {\n        arrayObject = this.selectionRangeArray.filter( // eslint-disable-next-line\n        function (obj) {\n          return !(_this.selectionStartPage <= obj.pageNumber && obj.pageNumber < focusPage_1);\n        });\n      } else {\n        arrayObject = this.selectionRangeArray.filter( // eslint-disable-next-line\n        function (obj) {\n          return !(focusPage_1 < obj.pageNumber && obj.pageNumber <= _this.selectionStartPage);\n        });\n      }\n\n      if (arrayObject.length > 0) {\n        for (var i = 0; i < arrayObject.length; i++) {\n          var indexInArray = this.selectionRangeArray.indexOf(arrayObject[i]);\n\n          if (indexInArray !== -1) {\n            this.selectionRangeArray.splice(indexInArray, 1);\n          }\n        }\n\n        if (this.selectionRangeArray.length === 1) {\n          // eslint-disable-next-line max-len\n          if (this.selectionRangeArray[0].pageNumber === anchorPage || this.selectionRangeArray[0].pageNumber === focusPage_1) {\n            arrayObject = [];\n          }\n        }\n      }\n    }\n  };\n  /**\n   * @private\n   */\n\n\n  TextSelection.prototype.applySpanForSelection = function () {\n    var selection = window.getSelection(); // eslint-disable-next-line max-len\n\n    if (selection.anchorNode === selection.focusNode && selection.anchorOffset === selection.focusOffset && !selection.isCollapsed) {\n      selection.removeAllRanges();\n    } // eslint-disable-next-line max-len\n\n\n    if (selection.anchorNode !== null && this.pdfViewerBase.viewerContainer.contains(this.getNodeElementFromNode(selection.anchorNode))) {\n      var isBackWardSelection = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n      var anchorPageId = void 0;\n      var focusPageId = void 0;\n      var anchorOffsetDiv = void 0;\n      var focusOffsetDiv = void 0;\n      var anchorOffset = void 0;\n      var focusOffset = void 0;\n\n      if (isBackWardSelection) {\n        // eslint-disable-next-line radix\n        anchorPageId = parseInt(this.getNodeElementFromNode(selection.focusNode).id.split('_text_')[1]); // eslint-disable-next-line radix\n\n        focusPageId = parseInt(this.getNodeElementFromNode(selection.anchorNode).id.split('_text_')[1]); // eslint-disable-next-line radix\n\n        anchorOffsetDiv = parseInt(this.getNodeElementFromNode(selection.focusNode).id.split('_text_')[1].split('_')[1]); // eslint-disable-next-line radix\n\n        focusOffsetDiv = parseInt(this.getNodeElementFromNode(selection.anchorNode).id.split('_text_')[1].split('_')[1]);\n        anchorOffset = selection.focusOffset;\n        focusOffset = selection.anchorOffset;\n      } else {\n        var anchorElement = this.getNodeElementFromNode(selection.anchorNode);\n        var focusElement = this.getNodeElementFromNode(selection.focusNode); // eslint-disable-next-line\n\n        anchorPageId = anchorElement.id.indexOf('text_') !== -1 ? parseInt(anchorElement.id.split('text_')[1]) : parseInt(anchorElement.id.split('_textLayer_')[1]); // eslint-disable-next-line\n\n        focusPageId = focusElement.id.indexOf('text_') !== -1 ? parseInt(focusElement.id.split('text_')[1]) : parseInt(focusElement.id.split('_textLayer_')[1]);\n        var isFocusChanged = false;\n\n        if (this.isTouchSelection) {\n          if (selection.focusNode === this.pdfViewerBase.pageContainer) {\n            var lastChildNode = this.pdfViewerBase.pageContainer.lastChild;\n\n            if (lastChildNode.classList.contains('e-pv-touch-select-drop')) {\n              var lastPageDiv = lastChildNode.previousSibling.previousSibling; // eslint-disable-next-line radix\n\n              focusPageId = parseInt(lastPageDiv.id.split('_pageDiv_')[1]);\n              focusElement = this.pdfViewerBase.getElement('_textLayer_' + focusPageId).lastChild;\n              isFocusChanged = true;\n            } else if (lastChildNode.classList.contains('e-pv-page-div')) {\n              var lastPageDiv = lastChildNode; // eslint-disable-next-line radix\n\n              focusPageId = parseInt(lastPageDiv.id.split('_pageDiv_')[1]);\n              focusElement = this.pdfViewerBase.getElement('_textLayer_' + focusPageId).lastChild;\n              isFocusChanged = true;\n            }\n          }\n        }\n\n        if (anchorElement.classList.contains('e-pv-maintaincontent')) {\n          anchorElement = this.getNodeElementFromNode(anchorElement); // eslint-disable-next-line radix\n\n          anchorPageId = parseInt(anchorElement.id.split('text_')[1]);\n        }\n\n        if (focusElement.classList.contains('e-pv-maintaincontent')) {\n          focusElement = this.getNodeElementFromNode(focusElement); // eslint-disable-next-line radix\n\n          focusPageId = parseInt(focusElement.id.split('text_')[1]);\n        }\n\n        if (anchorPageId === focusPageId) {\n          if (anchorElement.contains(focusElement)) {\n            anchorElement = focusElement;\n          }\n\n          if (focusElement.contains(anchorElement)) {\n            focusElement = anchorElement;\n          }\n        } // eslint-disable-next-line radix\n\n\n        anchorOffsetDiv = anchorElement.id.split('text_')[1] ? parseInt(anchorElement.id.split('text_')[1].split('_')[1]) : null; // eslint-disable-next-line radix\n\n        focusOffsetDiv = focusElement.id.split('text_')[1] ? parseInt(focusElement.id.split('text_')[1].split('_')[1]) : null;\n        anchorOffsetDiv = isNaN(anchorOffsetDiv) ? focusOffsetDiv : anchorOffsetDiv;\n        focusOffsetDiv = isNaN(focusOffsetDiv) ? anchorOffsetDiv : focusOffsetDiv;\n        anchorOffset = selection.anchorOffset;\n        focusOffset = !isFocusChanged ? selection.focusOffset : focusElement.textContent.length;\n      }\n\n      if (this.pdfViewerBase.checkIsNormalText()) {\n        selection.removeAllRanges();\n        this.pdfViewerBase.textLayer.clearDivSelection(); // eslint-disable-next-line max-len\n\n        this.pdfViewerBase.textLayer.applySpanForSelection(anchorPageId, focusPageId, anchorOffsetDiv, focusOffsetDiv, anchorOffset, focusOffset);\n      }\n\n      if (this.pdfViewer.textSearchModule) {\n        this.pdfViewer.textSearchModule.searchAfterSelection();\n      }\n    }\n  };\n  /**\n   * @param event\n   * @param x\n   * @param y\n   * @private\n   */\n\n\n  TextSelection.prototype.initiateTouchSelection = function (event, x, y) {\n    if (this.pdfViewerBase.isShapeBasedAnnotationsEnabled()) {\n      if (this.pdfViewer.selectedItems.annotations.length > 0) {\n        this.pdfViewer.clearSelection(this.pdfViewer.selectedItems.annotations[0].pageIndex);\n      }\n    } // eslint-disable-next-line\n\n\n    var element = event.target;\n    var belowElements = document.elementsFromPoint(event.touches[0].clientX, event.touches[0].clientY);\n\n    if (belowElements.length !== 0) {\n      if (belowElements[0].classList.contains('e-pv-hyperlink') && belowElements[1].classList.contains('e-pv-text')) {\n        element = belowElements[1];\n      }\n    }\n\n    var pageNumber = parseFloat(element.id.split('_')[2]);\n    this.pdfViewer.fireTextSelectionStart(pageNumber + 1);\n    this.selectAWord(element, x, y, true);\n    this.createTouchSelectElement(event);\n    this.maintainSelectionOnZoom(true, false);\n    this.fireTextSelectEnd();\n    this.applySpanForSelection();\n  }; // eslint-disable-next-line\n\n\n  TextSelection.prototype.selectTextByTouch = function (element, x, y, isForwardSelection, target, isCloserMovement) {\n    var isTextSelected = false;\n\n    if (element.nodeType === element.TEXT_NODE) {\n      var rangeObject = element.ownerDocument.createRange();\n      var selection = window.getSelection();\n      rangeObject.selectNodeContents(element);\n      var currentPosition = 0;\n      var endPosition = rangeObject.endOffset;\n\n      while (currentPosition < endPosition) {\n        rangeObject.setStart(element, currentPosition);\n        rangeObject.setEnd(element, currentPosition + 1);\n        var rangeBounds = rangeObject.getBoundingClientRect();\n\n        if (rangeBounds.left <= x && rangeBounds.right >= x && rangeBounds.top <= y && rangeBounds.bottom >= y) {\n          if (selection.anchorNode != null) {\n            if (isForwardSelection) {\n              rangeObject.setStart(selection.anchorNode, selection.anchorOffset);\n            } // eslint-disable-next-line max-len\n\n\n            rangeObject = this.setTouchSelectionStartPosition(selection, rangeObject, isForwardSelection, target, element, currentPosition, isCloserMovement);\n\n            if (isForwardSelection) {\n              selection.extend(element, currentPosition);\n            }\n\n            isTextSelected = true;\n          }\n\n          rangeObject.detach();\n          return isTextSelected;\n        }\n\n        currentPosition += 1;\n      }\n    } else {\n      for (var i = 0; i < element.childNodes.length; i++) {\n        var range = element.childNodes[i].ownerDocument.createRange();\n        range.selectNodeContents(element.childNodes[i]);\n        var rangeBounds = range.getBoundingClientRect();\n\n        if (rangeBounds.left <= x && rangeBounds.right >= x && rangeBounds.top <= y && rangeBounds.bottom >= y) {\n          range.detach();\n          return this.selectTextByTouch(element.childNodes[i], x, y, isForwardSelection, target, isCloserMovement);\n        } else {\n          range.detach();\n        }\n      }\n    }\n\n    return isTextSelected;\n  }; // eslint-disable-next-line\n\n\n  TextSelection.prototype.setTouchSelectionStartPosition = function (selection, range, isForwardSelection, target, element, currentPosition, isCloserMovement) {\n    if (isForwardSelection) {\n      if (target === 'left') {\n        // eslint-disable-next-line\n        var startNode = this.getTouchFocusElement(selection, true);\n        range.setStart(startNode.focusNode, startNode.focusOffset);\n        range.setEnd(element, currentPosition);\n        this.selectionAnchorTouch = {\n          anchorNode: range.endContainer.parentElement.id,\n          anchorOffset: range.endOffset\n        };\n      } else if (target === 'right') {\n        // eslint-disable-next-line\n        var startNode = this.getTouchAnchorElement(selection, false);\n        range.setStart(startNode.anchorNode, startNode.anchorOffset);\n        range.setEnd(element, currentPosition);\n        this.selectionFocusTouch = {\n          focusNode: range.endContainer.parentElement.id,\n          focusOffset: range.endOffset\n        };\n      }\n    } else {\n      if (target === 'left') {\n        if (!isCloserMovement) {\n          // eslint-disable-next-line\n          var startNode = this.getTouchFocusElement(selection, false);\n          range.setStart(element, currentPosition); // eslint-disable-next-line radix\n\n          range.setEnd(startNode.focusNode, startNode.focusOffset);\n\n          if (range.toString() === '') {\n            range.setStart(element, currentPosition);\n            range.setEnd(selection.focusNode, selection.focusOffset);\n          }\n\n          this.selectionAnchorTouch = {\n            anchorNode: range.startContainer.parentElement.id,\n            anchorOffset: range.startOffset\n          };\n        } else {\n          range.setStart(element, currentPosition);\n          range.setEnd(selection.focusNode, selection.focusOffset);\n          this.selectionAnchorTouch = {\n            anchorNode: range.startContainer.parentElement.id,\n            anchorOffset: range.startOffset\n          };\n        }\n      } else if (target === 'right') {\n        // eslint-disable-next-line\n        var startNode = this.getTouchAnchorElement(selection, true);\n        range.setStart(element, currentPosition);\n        range.setEnd(startNode.anchorNode, startNode.anchorOffset);\n\n        if (range.toString() === '') {\n          range.setStart(startNode.anchorNode, startNode.anchorOffset);\n          range.setEnd(element, currentPosition);\n        }\n\n        this.selectionFocusTouch = {\n          focusNode: range.startContainer.parentElement.id,\n          focusOffset: range.startOffset\n        };\n      }\n    }\n\n    selection.removeAllRanges();\n    selection.addRange(range);\n    return range;\n  };\n\n  TextSelection.prototype.getTouchAnchorElement = function (selection, isCurrentFocus) {\n    var element = document.getElementById(this.selectionAnchorTouch.anchorNode.toString());\n    var startNode = null;\n    var offset = 0;\n\n    if (element) {\n      startNode = element.childNodes[0]; // eslint-disable-next-line radix\n\n      offset = parseInt(this.selectionAnchorTouch.anchorOffset.toString());\n    } else {\n      if (isCurrentFocus) {\n        startNode = selection.focusNode;\n        offset = selection.focusOffset;\n      } else {\n        startNode = selection.anchorNode;\n        offset = selection.anchorOffset;\n      }\n    }\n\n    return {\n      anchorNode: startNode,\n      anchorOffset: offset\n    };\n  };\n\n  TextSelection.prototype.getTouchFocusElement = function (selection, isCurrentAnchor) {\n    var element = document.getElementById(this.selectionFocusTouch.focusNode.toString());\n    var startNode = null;\n    var offset = 0;\n\n    if (element) {\n      startNode = element.childNodes[0]; // eslint-disable-next-line radix\n\n      offset = parseInt(this.selectionFocusTouch.focusOffset.toString());\n    } else {\n      if (isCurrentAnchor) {\n        startNode = selection.anchorNode;\n        offset = selection.anchorOffset;\n      } else {\n        startNode = selection.focusNode;\n        offset = selection.focusOffset;\n      }\n    }\n\n    return {\n      focusNode: startNode,\n      focusOffset: offset\n    };\n  };\n\n  TextSelection.prototype.createTouchSelectElement = function (event) {\n    var topMargin = 10;\n    this.isTouchSelection = true;\n    var selection = window.getSelection();\n\n    if (selection.type === 'Range') {\n      // eslint-disable-next-line max-len\n      this.dropDivElementLeft = createElement('div', {\n        id: this.pdfViewer.element.id + '_touchSelect_droplet_left',\n        className: 'e-pv-touch-select-drop'\n      }); // eslint-disable-next-line max-len\n\n      this.dropDivElementRight = createElement('div', {\n        id: this.pdfViewer.element.id + '_touchSelect_droplet_right',\n        className: 'e-pv-touch-select-drop'\n      });\n      this.dropElementLeft = createElement('div', {\n        className: 'e-pv-touch-ellipse'\n      });\n      this.dropElementLeft.style.transform = 'rotate(0deg)';\n      this.dropDivElementLeft.appendChild(this.dropElementLeft);\n      this.dropElementRight = createElement('div', {\n        className: 'e-pv-touch-ellipse'\n      });\n      this.dropElementRight.style.transform = 'rotate(-90deg)';\n      this.dropElementRight.style.margin = '0 9px 0 0';\n      this.dropDivElementRight.appendChild(this.dropElementRight);\n      this.pdfViewerBase.pageContainer.appendChild(this.dropDivElementLeft);\n      this.pdfViewerBase.pageContainer.appendChild(this.dropDivElementRight);\n      var range = selection.getRangeAt(0);\n      var rangePosition = range.getBoundingClientRect();\n      var dropElementRect = this.dropDivElementLeft.getBoundingClientRect(); // eslint-disable-next-line max-len\n\n      var pageTopValue = this.pdfViewerBase.pageSize[this.pdfViewerBase.currentPageNumber - 1].top;\n      var viewerLeftPosition = this.pdfViewerBase.viewerContainer.getBoundingClientRect().left;\n      var topClientValue = this.getClientValueTop(rangePosition.top, this.pdfViewerBase.currentPageNumber - 1); // eslint-disable-next-line max-len\n\n      var topPositionValue = topClientValue + pageTopValue * this.pdfViewerBase.getZoomFactor() + dropElementRect.height / 2 * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropDivElementLeft.style.top = topPositionValue;\n      this.dropDivElementLeft.style.left = rangePosition.left - (viewerLeftPosition + dropElementRect.width) + 'px';\n      this.dropDivElementRight.style.top = topPositionValue; // eslint-disable-next-line max-len\n\n      this.dropDivElementRight.style.left = rangePosition.left + rangePosition.width - viewerLeftPosition + 'px';\n      var currentPageLeft = this.pdfViewerBase.getElement('_pageDiv_' + (this.pdfViewerBase.currentPageNumber - 1)).getBoundingClientRect().left;\n      var currentRangeLeft = rangePosition.left - currentPageLeft; // eslint-disable-next-line max-len\n\n      this.topStoreLeft = {\n        pageTop: pageTopValue,\n        topClientValue: this.getMagnifiedValue(topClientValue),\n        pageNumber: this.pdfViewerBase.currentPageNumber - 1,\n        left: this.getMagnifiedValue(currentRangeLeft),\n        isHeightNeeded: true\n      }; // eslint-disable-next-line max-len\n\n      this.topStoreRight = {\n        pageTop: pageTopValue,\n        topClientValue: this.getMagnifiedValue(topClientValue),\n        pageNumber: this.pdfViewerBase.currentPageNumber - 1,\n        left: this.getMagnifiedValue(currentRangeLeft + rangePosition.width),\n        isHeightNeeded: true\n      };\n      this.dropDivElementLeft.addEventListener('touchstart', this.onLeftTouchSelectElementTouchStart);\n      this.dropDivElementLeft.addEventListener('touchmove', this.onLeftTouchSelectElementTouchMove);\n      this.dropDivElementLeft.addEventListener('touchend', this.onLeftTouchSelectElementTouchEnd);\n      this.dropDivElementRight.addEventListener('touchstart', this.onRightTouchSelectElementTouchStart);\n      this.dropDivElementRight.addEventListener('touchmove', this.onRightTouchSelectElementTouchMove);\n      this.dropDivElementRight.addEventListener('touchend', this.onRightTouchSelectElementTouchEnd); // eslint-disable-next-line max-len\n\n      this.calculateContextMenuPosition(event.touches[0].clientY + this.dropDivElementLeft.clientHeight + topMargin, parseInt(this.dropDivElementLeft.style.left, 10) - topMargin);\n    }\n  };\n  /**\n   * @param top\n   * @param left\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  TextSelection.prototype.calculateContextMenuPosition = function (top, left) {\n    var _this = this;\n\n    var topMargin = 10;\n\n    if (Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n      // eslint-disable-next-line\n      var contextTop = top - this.contextMenuHeight;\n\n      if (contextTop < this.pdfViewerBase.toolbarHeight) {\n        top = top + this.contextMenuHeight;\n      } else {\n        top = contextTop;\n      }\n\n      if (top + this.contextMenuHeight > window.innerHeight) {\n        top = top - this.contextMenuHeight;\n      }\n    }\n\n    if (this.pdfViewer.contextMenuSettings.contextMenuAction === 'MouseUp') {\n      left = left - 50;\n    }\n\n    var proxy = this;\n    setTimeout(function () {\n      var leftValue = 35;\n      var selectedContent = document.getElementsByClassName(\"e-pv-maintaincontent\")[0] ? document.getElementsByClassName(\"e-pv-maintaincontent\")[0].getBoundingClientRect() : null;\n\n      if (selectedContent) {\n        if (selectedContent.bottom + proxy.contextMenuHeight + proxy.pdfViewerBase.toolbarHeight > window.innerHeight) {\n          top = selectedContent.top - (proxy.contextMenuHeight + proxy.pdfViewerBase.toolbarHeight - topMargin);\n        } else {\n          top = selectedContent.bottom + proxy.pdfViewerBase.toolbarHeight - topMargin;\n        }\n\n        left = selectedContent.left - leftValue;\n        var toolbarModule = _this.pdfViewer.toolbarModule ? _this.pdfViewer.toolbarModule.annotationToolbarModule : 'null';\n\n        if (!toolbarModule || !toolbarModule.textMarkupToolbarElement || toolbarModule.textMarkupToolbarElement.children.length === 0) {\n          // eslint-disable-next-line max-len\n          proxy.pdfViewerBase.contextMenuModule.open(top, left, proxy.pdfViewerBase.viewerContainer);\n        }\n      }\n    });\n  };\n  /**\n   * @private\n   */\n\n\n  TextSelection.prototype.initiateSelectionByTouch = function () {\n    this.pdfViewerBase.textLayer.clearDivSelection();\n    this.pdfViewerBase.contextMenuModule.close();\n    var lowerPageIndex = this.pdfViewerBase.currentPageNumber - 3;\n    lowerPageIndex = lowerPageIndex < 0 ? 0 : lowerPageIndex;\n    var higherPageIndex = this.pdfViewer.currentPageNumber + 1; // eslint-disable-next-line max-len\n\n    higherPageIndex = higherPageIndex < this.pdfViewerBase.pageCount - 1 ? higherPageIndex : this.pdfViewerBase.pageCount - 1;\n\n    for (var i = lowerPageIndex; i <= higherPageIndex; i++) {\n      var textLayer = this.pdfViewerBase.getElement('_textLayer_' + i);\n\n      if (textLayer) {\n        if (textLayer.childNodes !== null) {\n          this.applySelectionMouseScroll(i);\n        }\n      }\n    }\n\n    if (this.selectionRangeArray.length > 0) {\n      this.pdfViewer.fireTextSelectionStart(this.selectionRangeArray[0].pageNumber + 1);\n    }\n  }; // eslint-disable-next-line\n\n\n  TextSelection.prototype.terminateSelectionByTouch = function (event) {\n    var topMargin = 10;\n    this.maintainSelectionOnZoom(true, false);\n    this.applySpanForSelection();\n\n    if (this.pdfViewerBase.getTextMarkupAnnotationMode()) {\n      // eslint-disable-next-line max-len\n      this.pdfViewer.annotationModule.textMarkupAnnotationModule.drawTextMarkupAnnotations(this.pdfViewer.annotationModule.textMarkupAnnotationModule.currentTextMarkupAddMode);\n    } else {\n      this.fireTextSelectEnd();\n      var top_4 = event.changedTouches[0].clientY + event.currentTarget.clientHeight;\n      var spanBounds = this.getSpanBounds();\n\n      if (spanBounds.bottom + this.contextMenuHeight + this.pdfViewerBase.toolbarHeight > window.innerHeight) {\n        top_4 = spanBounds.top - (this.contextMenuHeight + this.pdfViewerBase.toolbarHeight);\n      } else {\n        top_4 = spanBounds.bottom + this.pdfViewerBase.toolbarHeight - topMargin;\n      }\n\n      this.pdfViewerBase.contextMenuModule.open(top_4, (spanBounds.right - spanBounds.left) / 2, this.pdfViewerBase.viewerContainer);\n    }\n  };\n\n  TextSelection.prototype.getSpanBounds = function () {\n    var spanWidth = [];\n    var spanRight = [];\n    var spanLeft = [];\n    var spanHeight = 0;\n    var selectedContent = document.getElementsByClassName(\"e-pv-maintaincontent\");\n\n    if (selectedContent.length > 0) {\n      for (var i = 0; i < selectedContent.length; i++) {\n        var spanElement = selectedContent[i].getBoundingClientRect();\n        spanHeight = spanHeight + spanElement.height;\n        spanWidth.push(spanElement.width);\n        spanRight.push(spanElement.right);\n        spanLeft.push(spanElement.left);\n      } // eslint-disable-next-line max-len\n\n\n      return {\n        top: selectedContent[0].getBoundingClientRect().top,\n        bottom: selectedContent[selectedContent.length - 1].getBoundingClientRect().bottom,\n        left: Math.min.apply(null, spanLeft),\n        right: Math.max.apply(null, spanRight),\n        width: Math.max.apply(null, spanWidth),\n        height: spanHeight\n      };\n    }\n  };\n\n  TextSelection.prototype.getNodeElement = function (range, touchX, touchY, event, nodeElement) {\n    if (document.caretRangeFromPoint) {\n      range = document.caretRangeFromPoint(touchX, touchY);\n      nodeElement = this.onTouchElementScroll(range, nodeElement, touchY, event); // eslint-disable-next-line\n    } else if (document.caretPositionFromPoint) {\n      // eslint-disable-next-line\n      var start = document.caretPositionFromPoint(touchX, touchY); // eslint-disable-next-line\n\n      var end = document.caretPositionFromPoint(touchX, touchY);\n      range = document.createRange();\n      range.setStart(start.offsetNode, start.offset);\n      range.setEnd(end.offsetNode, end.offset);\n      nodeElement = this.onTouchElementScroll(range, nodeElement, touchY, event);\n    }\n\n    return nodeElement;\n  };\n\n  TextSelection.prototype.isTouchedWithinContainer = function (event) {\n    var elements = document.elementsFromPoint(event.touches[0].clientX, event.touches[0].clientY);\n    var isTouchedWithinContainer = false;\n\n    if (elements.length !== 0) {\n      isTouchedWithinContainer = true;\n    }\n\n    return isTouchedWithinContainer;\n  };\n\n  TextSelection.prototype.onTouchElementScroll = function (range, nodeElement, touchY, event) {\n    var viewerScrollTop = this.pdfViewerBase.viewerContainer.scrollTop;\n\n    if (range != null) {\n      nodeElement = range.startContainer;\n      var isScrollBar = this.isScrolledOnScrollBar(event);\n\n      if (!this.pdfViewerBase.viewerContainer.contains(nodeElement.parentElement) || isScrollBar) {\n        if (touchY < this.pdfViewerBase.viewerContainer.clientHeight) {\n          this.pdfViewerBase.viewerContainer.scrollTop = viewerScrollTop - 30;\n        } else {\n          this.pdfViewerBase.viewerContainer.scrollTop = viewerScrollTop + 30;\n        }\n      }\n    } else {\n      if (touchY < this.pdfViewerBase.viewerContainer.clientHeight) {\n        this.pdfViewerBase.viewerContainer.scrollTop = viewerScrollTop - 30;\n      } else {\n        this.pdfViewerBase.viewerContainer.scrollTop = viewerScrollTop + 30;\n      }\n    }\n\n    return nodeElement;\n  };\n\n  TextSelection.prototype.isCloserTouchScroll = function (currentDifference) {\n    var isForwardMovement = false;\n\n    if (this.previousScrollDifference > currentDifference) {\n      isForwardMovement = true;\n    }\n\n    return isForwardMovement;\n  };\n\n  TextSelection.prototype.getClientValueTop = function (clientValue, pageNumber) {\n    if (this.pdfViewerBase.getElement('_pageDiv_' + pageNumber)) {\n      // eslint-disable-next-line max-len\n      return clientValue - this.pdfViewerBase.getElement('_pageDiv_' + pageNumber).getBoundingClientRect().top;\n    } else {\n      return clientValue;\n    }\n  };\n\n  TextSelection.prototype.isScrolledOnScrollBar = function (event) {\n    var isScrollBar = false; // eslint-disable-next-line max-len\n\n    if (event.touches && this.pdfViewerBase.viewerContainer.clientHeight + this.pdfViewerBase.viewerContainer.offsetTop < event.touches[0].clientY && event.touches[0].clientY < this.pdfViewerBase.viewerContainer.offsetHeight + this.pdfViewerBase.viewerContainer.offsetTop) {\n      isScrollBar = true;\n    }\n\n    return isScrollBar;\n  };\n\n  TextSelection.prototype.getTextLastLength = function (element) {\n    if (element) {\n      return element.textContent.length;\n    } else {\n      return 0;\n    }\n  };\n\n  TextSelection.prototype.getNodeElementFromNode = function (node) {\n    if (node.parentElement) {\n      return node.parentElement;\n    } else {\n      return node.parentNode;\n    }\n  };\n  /**\n   * Copy the selected text in the PDF Document.\n   *\n   * @returns void\n   */\n\n\n  TextSelection.prototype.copyText = function () {\n    var selectionText = '';\n    this.maintainSelectionOnZoom(true, false);\n\n    if (this.selectionRangeArray.length > 0) {\n      for (var i = 0; i < this.selectionRangeArray.length; i++) {\n        selectionText += this.selectionRangeArray[i].textContent;\n      }\n    }\n\n    if (selectionText.length > 0) {\n      if (this.pdfViewer.annotation) {\n        this.pdfViewer.annotation.isShapeCopied = false;\n      }\n\n      var textArea = document.createElement('textarea');\n      textArea.contentEditable = 'true';\n      textArea.textContent = selectionText; // eslint-disable-next-line max-len\n\n      if (this.pdfViewer.annotation && this.pdfViewer.annotation.freeTextAnnotationModule) {\n        this.pdfViewer.annotation.freeTextAnnotationModule.selectedText = selectionText;\n      }\n\n      textArea.style.position = 'fixed';\n      document.body.appendChild(textArea);\n      textArea.select();\n\n      try {\n        document.execCommand('copy');\n      } catch (ex) {\n        console.warn('Copy to clipboard failed.', ex);\n      } finally {\n        if (textArea) {\n          document.body.removeChild(textArea);\n        }\n      }\n    }\n  };\n  /**\n   * @private\n   */\n\n\n  TextSelection.prototype.destroy = function () {\n    this.clear();\n  };\n  /**\n   * @private\n   */\n\n\n  TextSelection.prototype.getModuleName = function () {\n    return 'TextSelection';\n  };\n\n  return TextSelection;\n}();\n\nexport { TextSelection };","map":{"version":3,"names":["createElement","Browser","isNullOrUndefined","TextSelection","pdfViewer","pdfViewerBase","_this","isTextSelection","selectionStartPage","isBackwardPropagatedSelection","contextMenuHeight","selectionRangeArray","selectionAnchorTouch","selectionFocusTouch","scrollMoveTimer","isMouseLeaveSelection","isTouchSelection","previousScrollDifference","topStoreLeft","topStoreRight","isTextSearched","isSelectionStartTriggered","onLeftTouchSelectElementTouchStart","event","initiateSelectionByTouch","onRightTouchSelectElementTouchStart","onLeftTouchSelectElementTouchEnd","terminateSelectionByTouch","onRightTouchSelectElementTouchEnd","onLeftTouchSelectElementTouchMove","range","nodeElement","preventDefault","target","style","zIndex","rightElement","dropDivElementRight","isTouchedWithinViewerContainer","isTouchedWithinContainer","dropBounds","getBoundingClientRect","xTouch","changedTouches","clientX","yTouch","clientY","getNodeElement","currentDifference","Math","sqrt","top","left","isCloserMovement","isCloserTouchScroll","isTextSelected","dropElementLeft","transform","dropElementRight","selectTextByTouch","parentElement","elementClientRect","dropDivElementLeft","pageTopValue","pageSize","currentPageNumber","topClientValue","getClientValueTop","currentPageLeft","getElement","currentRangeLeft","getZoomFactor","pageTop","getMagnifiedValue","pageNumber","isHeightNeeded","viewerContainer","width","onRightTouchSelectElementTouchMove","leftElement","dropPosition","touchX","touchY","prototype","textSelectionOnMouseMove","x","y","isExtended","targetElement","nodeType","TEXT_NODE","getTextMarkupAnnotationMode","fireTextSelectionStart","ownerDocument","createRange","selection","window","getSelection","anchorNode","position","compareDocumentPosition","focusNode","anchorOffset","focusOffset","Node","DOCUMENT_POSITION_PRECEDING","selectNodeContents","currentPosition","endPosition","endOffset","setStart","setEnd","rangeBounds","rightBounds","right","parseInt","toString","bottom","parentNode","classList","contains","removeAllRanges","addRange","isIE","document","documentMode","extend","detach","annotationModule","textMarkupAnnotationModule","isEnableTextMarkupResizer","currentTextMarkupAddMode","leftDivElement","getElementById","element","id","isSelection","rangeCount","currentrange","getRangeAt","rect","top_1","annotation","updateLeftposition","display","updatePosition","i","childNodes","length","getSelectionRange","textSelectionOnDrag","isforward","top_2","selectTextRegion","pageNumbers","bounds","k","bound","Left","Top","Width","height","Height","textLayer","textDivs","n","rangebounds","top_3","currentLeft","totalLeft","textDiVLeft","currentTop","isLeftBounds","checkLeftBounds","isTopBounds","checkTopBounds","boundingRect","isExists","textSelectionOnMouseLeave","viewerTop","offsetTop","magnificationModule","fitType","setInterval","scrollForwardOnSelection","scrollBackwardOnSelection","scrollTop","stichSelectionOnScroll","clear","clearInterval","selectAWord","isStoreSelection","textContent","indices","startPosition","endPos","push","j","startParent","startContainer","split","index","selectEntireLine","textIds","targetRect","targetcentre","querySelectorAll","topValue","bottomValue","textId","lengths","d1","d2","contextMenuSettings","contextMenuAction","calculateContextMenuPosition","enableTextSelectionMode","isTextSelectionDisabled","remove","add","addEventListener","clearTextSelection","clearDivSelection","linkAnnotationModule","lowerPageIndex","higherPageIndex","pageCount","modifyZindexForTextSelection","showHideDropletDiv","textSearchModule","searchAfterSelection","contextMenuModule","close","removeTouchElements","removeChild","resizeTouchElements","viewerContainerLeft","dropElementHeight","leftCurrentPagePosition","parseFloat","rightCurrentPagePosition","textSelectionOnMouseup","maintainSelectionOnZoom","fireTextSelectEnd","isTextSearch","getTextSearchStatus","indexes","getIndexes","lowerPageValue","higherPageValue","applySelectionRangeOnScroll","applySpanForSelection","selectEndPageIndex","selectedText","selectedBounds","rectangleBounds","currentBound","pageIndex","isBackward","fireTextSelectionEnd","isMaintainSelection","isStich","type","isCollapsed","isBackWardSelection","anchorPageId","getNodeElementFromNode","focusPageId","isNaN","focusElement","pageContainer","lastChildNode","lastChild","previousSibling","maintainSelectionOnScroll","isSelectionAvailableOnScroll","isSelectionAvailable","ranges","getMagnified","applySelectionMouseScroll","applySelectionRange","getSelectionRangeFromArray","selectionRange","selectionObject","anchorOffsetDiv","focusOffsetDiv","startId","endNode","endId","startNode","startOffset","anchorPageIndex","focusPageIndex","currentAnchorIndex","extendCurrentSelection","currentAnchorOffset","currentFocusOffset","maintainSelection","backward_1","firstChild","backward","selectionBounds","getSelectionBounds","selectionRectBounds","getSelectionRectangleBounds","anchorOffsetValue","getCorrectOffset","focusOffsetValue","pushSelectionRangeObject","createRangeObjectOnScroll","stichSelection","node","offset","offsetValue","currentObject","filter","obj","currentObjectIndex","indexOf","splice","nextPageObject","prevPageObject","prevIndex","firstObject","currentFocusElement","nextPageElement","lastElement","getTextLastLength","firstElement","textSelectionOnMouseWheel","extendSelectionStich","lastElement_1","maintainSelectionArray","pageNumberIndex","selectionRangeObject","getSelectionRangeObject","selectionString","selectionBound","startElement","endElement","endContainer","newStartRange","startRange","createRangeForSelection","normalizeBounds","currentId","getPageIndex","anchorTextId","getTextIndex","focusTextId","textElement","newRange","getTextId","elementId","lastIndexOf","divId","substring","newBounds","currentPageElement","isMixedSizeDocument","currentTextElement","currentPageRect","value","getCurrentSelectionBounds","start","end","anchorPage","focusPage_1","arrayObject","indexInArray","anchorElement","isFocusChanged","lastPageDiv","checkIsNormalText","initiateTouchSelection","isShapeBasedAnnotationsEnabled","selectedItems","annotations","clearSelection","belowElements","elementsFromPoint","touches","createTouchSelectElement","isForwardSelection","rangeObject","setTouchSelectionStartPosition","getTouchFocusElement","getTouchAnchorElement","isCurrentFocus","isCurrentAnchor","topMargin","className","appendChild","margin","rangePosition","dropElementRect","viewerLeftPosition","topPositionValue","clientHeight","isDevice","enableDesktopMode","contextTop","toolbarHeight","innerHeight","proxy","setTimeout","leftValue","selectedContent","getElementsByClassName","toolbarModule","annotationToolbarModule","textMarkupToolbarElement","children","open","drawTextMarkupAnnotations","top_4","currentTarget","spanBounds","getSpanBounds","spanWidth","spanRight","spanLeft","spanHeight","spanElement","min","apply","max","caretRangeFromPoint","onTouchElementScroll","caretPositionFromPoint","offsetNode","elements","viewerScrollTop","isScrollBar","isScrolledOnScrollBar","isForwardMovement","clientValue","offsetHeight","copyText","selectionText","isShapeCopied","textArea","contentEditable","freeTextAnnotationModule","body","select","execCommand","ex","console","warn","destroy","getModuleName"],"sources":["/home/morgan/Desktop/Projets/ENT4/Jwt-Auth-pdf/react-jwt-auth/react-jwt-auth/node_modules/@syncfusion/ej2-pdfviewer/src/pdfviewer/text-selection/text-selection.js"],"sourcesContent":["/* eslint-disable */\nimport { createElement, Browser, isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `TextSelection` module is used to handle the text selection of PDF viewer.\n */\nvar TextSelection = /** @class */ (function () {\n    /**\n     * @param pdfViewer\n     * @param pdfViewerBase\n     * @param pdfViewer\n     * @param pdfViewerBase\n     * @private\n     */\n    function TextSelection(pdfViewer, pdfViewerBase) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.isTextSelection = false;\n        /**\n         * @private\n         */\n        this.selectionStartPage = null;\n        this.isBackwardPropagatedSelection = false;\n        this.contextMenuHeight = 144;\n        /**\n         * @private\n         */\n        this.selectionRangeArray = [];\n        this.selectionAnchorTouch = null;\n        this.selectionFocusTouch = null;\n        // eslint-disable-next-line\n        this.scrollMoveTimer = 0;\n        this.isMouseLeaveSelection = false;\n        this.isTouchSelection = false;\n        this.previousScrollDifference = 0;\n        this.topStoreLeft = null;\n        this.topStoreRight = null;\n        this.isTextSearched = false;\n        this.isSelectionStartTriggered = false;\n        this.onLeftTouchSelectElementTouchStart = function (event) {\n            _this.initiateSelectionByTouch();\n        };\n        this.onRightTouchSelectElementTouchStart = function (event) {\n            _this.initiateSelectionByTouch();\n        };\n        this.onLeftTouchSelectElementTouchEnd = function (event) {\n            _this.terminateSelectionByTouch(event);\n        };\n        this.onRightTouchSelectElementTouchEnd = function (event) {\n            _this.terminateSelectionByTouch(event);\n        };\n        this.onLeftTouchSelectElementTouchMove = function (event) {\n            var range;\n            var nodeElement;\n            event.preventDefault();\n            event.target.style.zIndex = '0';\n            var rightElement = _this.dropDivElementRight;\n            var isTouchedWithinViewerContainer = _this.isTouchedWithinContainer(event);\n            if (rightElement && isTouchedWithinViewerContainer) {\n                var dropBounds = rightElement.getBoundingClientRect();\n                var xTouch = event.changedTouches[0].clientX;\n                var yTouch = event.changedTouches[0].clientY;\n                event.target.style.zIndex = '1000';\n                nodeElement = _this.getNodeElement(range, xTouch, yTouch, event, nodeElement);\n                if (nodeElement) {\n                    // eslint-disable-next-line max-len\n                    var currentDifference = Math.sqrt((yTouch - dropBounds.top) * (yTouch - dropBounds.top) + (xTouch - dropBounds.left) * (xTouch - dropBounds.left));\n                    var isCloserMovement = _this.isCloserTouchScroll(currentDifference);\n                    var isTextSelected = false;\n                    if (yTouch <= dropBounds.top) {\n                        _this.dropElementLeft.style.transform = 'rotate(0deg)';\n                        _this.dropElementRight.style.transform = 'rotate(-90deg)';\n                        isTextSelected = _this.selectTextByTouch(nodeElement.parentElement, xTouch, yTouch, false, 'left', isCloserMovement);\n                    }\n                    else {\n                        _this.dropElementLeft.style.transform = 'rotate(-90deg)';\n                        _this.dropElementRight.style.transform = 'rotate(0deg)';\n                        isTextSelected = _this.selectTextByTouch(nodeElement.parentElement, xTouch, yTouch, true, 'left', isCloserMovement);\n                    }\n                    if (isTextSelected) {\n                        var elementClientRect = _this.dropDivElementLeft.getBoundingClientRect();\n                        var pageTopValue = _this.pdfViewerBase.pageSize[_this.pdfViewerBase.currentPageNumber - 1].top;\n                        var topClientValue = _this.getClientValueTop(yTouch, _this.pdfViewerBase.currentPageNumber - 1);\n                        // eslint-disable-next-line max-len\n                        var currentPageLeft = _this.pdfViewerBase.getElement('_pageDiv_' + (_this.pdfViewerBase.currentPageNumber - 1)).getBoundingClientRect().left;\n                        var currentRangeLeft = xTouch - currentPageLeft;\n                        // eslint-disable-next-line max-len\n                        _this.dropDivElementLeft.style.top = pageTopValue * _this.pdfViewerBase.getZoomFactor() + topClientValue + 'px';\n                        _this.topStoreLeft = { pageTop: pageTopValue, topClientValue: _this.getMagnifiedValue(topClientValue), pageNumber: _this.pdfViewerBase.currentPageNumber - 1, left: _this.getMagnifiedValue(currentRangeLeft), isHeightNeeded: false };\n                        // eslint-disable-next-line max-len\n                        _this.dropDivElementLeft.style.left = xTouch - _this.pdfViewerBase.viewerContainer.getBoundingClientRect().left - (elementClientRect.width / 2) + 'px';\n                        _this.previousScrollDifference = currentDifference;\n                    }\n                }\n            }\n        };\n        // eslint-disable-next-line\n        this.onRightTouchSelectElementTouchMove = function (event) {\n            var range;\n            var nodeElement;\n            event.preventDefault();\n            event.target.style.zIndex = '0';\n            var leftElement = _this.dropDivElementLeft;\n            var isTouchedWithinViewerContainer = _this.isTouchedWithinContainer(event);\n            if (leftElement && isTouchedWithinViewerContainer) {\n                var dropPosition = leftElement.getBoundingClientRect();\n                var touchX = event.changedTouches[0].clientX;\n                var touchY = event.changedTouches[0].clientY;\n                event.target.style.zIndex = '1000';\n                nodeElement = _this.getNodeElement(range, touchX, touchY, event, nodeElement);\n                if (nodeElement) {\n                    // eslint-disable-next-line max-len\n                    var currentDifference = Math.sqrt((touchY - dropPosition.top) * (touchY - dropPosition.top) + (touchX - dropPosition.left) * (touchX - dropPosition.left));\n                    var isCloserMovement = _this.isCloserTouchScroll(currentDifference);\n                    var isTextSelected = false;\n                    if (touchY >= dropPosition.top) {\n                        _this.dropElementRight.style.transform = 'rotate(-90deg)';\n                        _this.dropElementLeft.style.transform = 'rotate(0deg)';\n                        isTextSelected = _this.selectTextByTouch(nodeElement.parentElement, touchX, touchY, true, 'right', isCloserMovement);\n                    }\n                    else {\n                        _this.dropElementRight.style.transform = 'rotate(0deg)';\n                        _this.dropElementLeft.style.transform = 'rotate(-90deg)';\n                        isTextSelected = _this.selectTextByTouch(nodeElement.parentElement, touchX, touchY, false, 'right', isCloserMovement);\n                    }\n                    if (isTextSelected) {\n                        var pageTopValue = _this.pdfViewerBase.pageSize[_this.pdfViewerBase.currentPageNumber - 1].top;\n                        var topClientValue = _this.getClientValueTop(touchY, _this.pdfViewerBase.currentPageNumber - 1);\n                        var elementClientRect = _this.dropDivElementRight.getBoundingClientRect();\n                        _this.dropDivElementRight.style.top = pageTopValue * _this.pdfViewerBase.getZoomFactor() + topClientValue + 'px';\n                        // eslint-disable-next-line max-len\n                        var currentPageLeft = _this.pdfViewerBase.getElement('_pageDiv_' + (_this.pdfViewerBase.currentPageNumber - 1)).getBoundingClientRect().left;\n                        var currentRangeLeft = touchX - currentPageLeft;\n                        // eslint-disable-next-line max-len\n                        _this.topStoreRight = { pageTop: pageTopValue, topClientValue: _this.getMagnifiedValue(topClientValue), pageNumber: _this.pdfViewerBase.currentPageNumber - 1, left: _this.getMagnifiedValue(currentRangeLeft), isHeightNeeded: false };\n                        // eslint-disable-next-line max-len\n                        _this.dropDivElementRight.style.left = touchX - _this.pdfViewerBase.viewerContainer.getBoundingClientRect().left - (elementClientRect.width / 2) + 'px';\n                        _this.previousScrollDifference = currentDifference;\n                    }\n                }\n            }\n        };\n        this.pdfViewer = pdfViewer;\n        this.pdfViewerBase = pdfViewerBase;\n    }\n    /**\n     * @param target\n     * @param x\n     * @param y\n     * @param isExtended\n     * @private\n     */\n    TextSelection.prototype.textSelectionOnMouseMove = function (target, x, y, isExtended) {\n        var targetElement = target;\n        this.isTextSearched = true;\n        if (targetElement.nodeType === targetElement.TEXT_NODE) {\n            if (!this.isSelectionStartTriggered && !this.pdfViewerBase.getTextMarkupAnnotationMode()) {\n                this.pdfViewer.fireTextSelectionStart(this.pdfViewerBase.currentPageNumber);\n                this.isSelectionStartTriggered = true;\n            }\n            this.isBackwardPropagatedSelection = false;\n            var range = targetElement.ownerDocument.createRange();\n            var selection = window.getSelection();\n            if (selection.anchorNode !== null) {\n                var position = selection.anchorNode.compareDocumentPosition(selection.focusNode);\n                if (!position && selection.anchorOffset > selection.focusOffset || position === Node.DOCUMENT_POSITION_PRECEDING) {\n                    this.isBackwardPropagatedSelection = true;\n                }\n            }\n            range.selectNodeContents(targetElement);\n            var currentPosition = 0;\n            var endPosition = range.endOffset;\n            while (currentPosition < endPosition) {\n                range.setStart(targetElement, currentPosition);\n                range.setEnd(targetElement, currentPosition + 1);\n                var rangeBounds = range.getBoundingClientRect();\n                var rightBounds = rangeBounds.right;\n                if (isExtended) {\n                    // eslint-disable-next-line\n                    rightBounds = parseInt(rangeBounds.right.toString());\n                }\n                // eslint-disable-next-line max-len\n                // eslint-disable-next-line\n                if (rangeBounds.left <= x && rightBounds >= x && parseInt(rangeBounds.top.toString()) <= y && rangeBounds.bottom >= y) {\n                    if (selection.anchorNode !== null && selection.anchorNode.parentNode.classList.contains('e-pv-text')) {\n                        range.setStart(selection.anchorNode, selection.anchorOffset);\n                    }\n                    selection.removeAllRanges();\n                    selection.addRange(range);\n                    if (!this.isTextSelection) {\n                        this.selectionStartPage = this.pdfViewerBase.currentPageNumber - 1;\n                    }\n                    this.isTextSelection = true;\n                    // eslint-disable-next-line\n                    var isIE = !!document.documentMode;\n                    if (!isIE) {\n                        if (this.isBackwardPropagatedSelection) {\n                            selection.extend(targetElement, currentPosition);\n                        }\n                        else if (isExtended) {\n                            selection.extend(targetElement, currentPosition);\n                        }\n                        else {\n                            selection.extend(targetElement, currentPosition + 1);\n                        }\n                    }\n                    range.detach();\n                }\n                currentPosition += 1;\n            }\n            // eslint-disable-next-line\n            var annotationModule = this.pdfViewer.annotationModule;\n            // eslint-disable-next-line max-len\n            if (annotationModule && annotationModule.textMarkupAnnotationModule && annotationModule.textMarkupAnnotationModule.isEnableTextMarkupResizer(annotationModule.textMarkupAnnotationModule.currentTextMarkupAddMode)) {\n                // eslint-disable-next-line\n                var leftDivElement = document.getElementById(this.pdfViewer.element.id + '_droplet_left');\n                if (this.pdfViewerBase.isSelection && selection && selection.rangeCount > 0) {\n                    // eslint-disable-next-line\n                    var currentrange = selection.getRangeAt(0);\n                    // eslint-disable-next-line\n                    var rect = currentrange.getBoundingClientRect();\n                    var left = rect.left;\n                    var top_1 = rect.top;\n                    this.pdfViewer.annotation.textMarkupAnnotationModule.updateLeftposition(left, top_1);\n                    this.pdfViewerBase.isSelection = false;\n                }\n                else if ((leftDivElement && leftDivElement.style.display === 'none')) {\n                    this.pdfViewer.annotation.textMarkupAnnotationModule.updateLeftposition(x, y);\n                }\n                this.pdfViewer.annotation.textMarkupAnnotationModule.updatePosition(x, y);\n            }\n        }\n        else {\n            for (var i = 0; i < targetElement.childNodes.length; i++) {\n                if (targetElement.childNodes[i].nodeType === targetElement.TEXT_NODE) {\n                    var range = this.getSelectionRange(i, targetElement);\n                    var rangeBounds = range.getBoundingClientRect();\n                    // eslint-disable-next-line max-len\n                    // eslint-disable-next-line\n                    if (rangeBounds.left <= x && rangeBounds.right >= parseInt(x.toString()) && parseInt(rangeBounds.top.toString()) <= y && rangeBounds.bottom >= y) {\n                        range.detach();\n                        this.textSelectionOnMouseMove(targetElement.childNodes[i], x, y, isExtended);\n                    }\n                    else {\n                        range.detach();\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @param target\n     * @param x\n     * @param y\n     * @param isforward\n     * @param target\n     * @param x\n     * @param y\n     * @param isforward\n     * @param target\n     * @param x\n     * @param y\n     * @param isforward\n     * @private\n     */\n    TextSelection.prototype.textSelectionOnDrag = function (target, x, y, isforward) {\n        var targetElement = target;\n        this.isTextSearched = true;\n        if (targetElement.nodeType === targetElement.TEXT_NODE) {\n            this.isBackwardPropagatedSelection = false;\n            var range = targetElement.ownerDocument.createRange();\n            var selection = window.getSelection();\n            if (selection.anchorNode !== null) {\n                var position = selection.anchorNode.compareDocumentPosition(selection.focusNode);\n                if (!position && selection.anchorOffset > selection.focusOffset || position === Node.DOCUMENT_POSITION_PRECEDING) {\n                    this.isBackwardPropagatedSelection = true;\n                }\n            }\n            range.selectNodeContents(targetElement);\n            var currentPosition = 0;\n            var endPosition = range.endOffset;\n            while (currentPosition < endPosition) {\n                range.setStart(targetElement, currentPosition);\n                range.setEnd(targetElement, currentPosition + 1);\n                var rangeBounds = range.getBoundingClientRect();\n                // eslint-disable-next-line max-len\n                // eslint-disable-next-line\n                if (rangeBounds.left <= x && rangeBounds.right >= x && parseInt(rangeBounds.top.toString()) <= y && rangeBounds.bottom >= y) {\n                    if (isforward) {\n                        // eslint-disable-next-line max-len\n                        if (selection.anchorNode !== null && selection.anchorNode.parentNode.classList.contains('e-pv-text')) {\n                            range.setStart(selection.anchorNode, selection.anchorOffset);\n                        }\n                        selection.removeAllRanges();\n                        selection.addRange(range);\n                        selection.extend(targetElement, currentPosition);\n                    }\n                    else if (selection.focusNode) {\n                        range.setEnd(selection.focusNode, selection.focusOffset);\n                        selection.removeAllRanges();\n                        selection.addRange(range);\n                    }\n                    if (!this.isTextSelection) {\n                        this.selectionStartPage = this.pdfViewerBase.currentPageNumber - 1;\n                    }\n                    this.isTextSelection = true;\n                    range.detach();\n                    return true;\n                }\n                currentPosition += 1;\n            }\n            if (this.pdfViewerBase.isSelection) {\n                // eslint-disable-next-line\n                var currentrange = selection.getRangeAt(0);\n                // eslint-disable-next-line\n                var rect = currentrange.getBoundingClientRect();\n                var left = rect.left;\n                var top_2 = rect.top;\n                this.pdfViewer.annotation.textMarkupAnnotationModule.updateLeftposition(left, top_2);\n                this.pdfViewerBase.isSelection = false;\n            }\n            this.pdfViewer.annotation.textMarkupAnnotationModule.updatePosition(x, y);\n        }\n        else {\n            for (var i = 0; i < targetElement.childNodes.length; i++) {\n                if (targetElement.childNodes[i].nodeType === targetElement.TEXT_NODE) {\n                    var range = this.getSelectionRange(i, targetElement);\n                    var rangeBounds = range.getBoundingClientRect();\n                    // eslint-disable-next-line max-len\n                    // eslint-disable-next-line\n                    if (rangeBounds.left <= x && rangeBounds.right >= x && parseInt(rangeBounds.top.toString()) <= y && rangeBounds.bottom >= y) {\n                        range.detach();\n                        this.textSelectionOnDrag(targetElement.childNodes[i], x, y, isforward);\n                    }\n                    else {\n                        range.detach();\n                    }\n                }\n            }\n        }\n        return null;\n    };\n    /**\n     * Select the target text region in the PDF document of the given bounds.\n     *\n     * @param  {number} pageNumbers - Specifies the page number\n     * @param  {IRectangle[]} bounds -  Specifies the bounds of the texts.\n     * @returns void\n     */\n    TextSelection.prototype.selectTextRegion = function (pageNumbers, bounds) {\n        // eslint-disable-next-line\n        var element = null;\n        var pageNumber = (pageNumbers - 1);\n        for (var k = 0; k < bounds.length; k++) {\n            // eslint-disable-next-line\n            var bound = bounds[k];\n            var x = (bound.left ? bound.left : bound.Left) * this.pdfViewerBase.getZoomFactor();\n            var y = (bound.top ? bound.top : bound.Top) * this.pdfViewerBase.getZoomFactor();\n            var width = (bound.width ? bound.width : bound.Width) * this.pdfViewerBase.getZoomFactor();\n            var height = bound.height ? bound.height : bound.Height;\n            // eslint-disable-next-line\n            var textLayer = this.pdfViewerBase.getElement('_textLayer_' + pageNumber);\n            if (textLayer) {\n                // eslint-disable-next-line\n                var textDivs = textLayer.childNodes;\n                for (var n = 0; n < textDivs.length; n++) {\n                    if (textDivs[n]) {\n                        // eslint-disable-next-line\n                        var rangebounds = textDivs[n].getBoundingClientRect();\n                        var top_3 = this.getClientValueTop(rangebounds.top, pageNumber);\n                        // eslint-disable-next-line max-len\n                        var currentLeft = rangebounds.left - this.pdfViewerBase.getElement('_pageDiv_' + pageNumber).getBoundingClientRect().left;\n                        var totalLeft = currentLeft + rangebounds.width;\n                        // eslint-disable-next-line\n                        var textDiVLeft = parseInt(textDivs[n].style.left);\n                        // eslint-disable-next-line\n                        var currentTop = parseInt(textDivs[n].style.top);\n                        var isLeftBounds = this.checkLeftBounds(currentLeft, textDiVLeft, totalLeft, x);\n                        var isTopBounds = this.checkTopBounds(top_3, currentTop, y);\n                        if (isLeftBounds && isTopBounds) {\n                            element = textDivs[n];\n                            break;\n                        }\n                    }\n                }\n                if (element != null) {\n                    // eslint-disable-next-line\n                    var boundingRect = this.pdfViewerBase.getElement('_textLayer_' + pageNumber).getBoundingClientRect();\n                    this.textSelectionOnMouseMove(element, x + boundingRect.left, y + boundingRect.top, false);\n                    if ((bounds.length - 1) === k) {\n                        // eslint-disable-next-line max-len\n                        this.textSelectionOnMouseMove(element, x + boundingRect.left + width, y + boundingRect.top, false);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @param left\n     * @param textDiVLeft\n     * @param totalLeft\n     * @param x\n     * @private\n     */\n    TextSelection.prototype.checkLeftBounds = function (left, textDiVLeft, totalLeft, x) {\n        var isExists = false;\n        // eslint-disable-next-line max-len\n        // eslint-disable-next-line\n        if (left === parseInt(x.toString()) || parseInt(left.toString()) === parseInt(x.toString()) || (left + 1) === parseInt(x.toString()) || (left - 1) === parseInt(x.toString())\n            // eslint-disable-next-line\n            || textDiVLeft === parseInt(x.toString()) || textDiVLeft === x || (totalLeft >= x && left <= x)) {\n            isExists = true;\n        }\n        return isExists;\n    };\n    /**\n     * @param top\n     * @param currentTop\n     * @param y\n     * @param top\n     * @param currentTop\n     * @param y\n     * @private\n     */\n    TextSelection.prototype.checkTopBounds = function (top, currentTop, y) {\n        var isExists = false;\n        // eslint-disable-next-line max-len\n        // eslint-disable-next-line\n        if ((top === parseInt(y.toString()) || parseInt(top.toString()) === parseInt(y.toString()) || parseInt((top + 1).toString()) === parseInt(y.toString()) || parseInt((top - 1).toString()) === parseInt(y.toString())\n            // eslint-disable-next-line\n            || currentTop === parseInt(y.toString()) || currentTop === y)) {\n            isExists = true;\n        }\n        return isExists;\n    };\n    /**\n     * @param event\n     * @private\n     */\n    TextSelection.prototype.textSelectionOnMouseLeave = function (event) {\n        var _this = this;\n        event.preventDefault();\n        var viewerTop = this.pdfViewerBase.viewerContainer.offsetTop;\n        if (this.pdfViewer.magnificationModule) {\n            if (this.pdfViewer.magnificationModule.fitType === 'fitToPage') {\n                return;\n            }\n        }\n        if (event.clientY > viewerTop) {\n            this.scrollMoveTimer = setInterval(function () {\n                _this.scrollForwardOnSelection();\n            }, 500);\n        }\n        else {\n            this.scrollMoveTimer = setInterval(function () {\n                _this.scrollBackwardOnSelection();\n            }, 500);\n        }\n    };\n    TextSelection.prototype.scrollForwardOnSelection = function () {\n        this.isMouseLeaveSelection = true;\n        this.pdfViewerBase.viewerContainer.scrollTop = this.pdfViewerBase.viewerContainer.scrollTop + 200;\n        this.stichSelectionOnScroll(this.pdfViewerBase.currentPageNumber - 1);\n    };\n    TextSelection.prototype.scrollBackwardOnSelection = function () {\n        this.isMouseLeaveSelection = true;\n        this.pdfViewerBase.viewerContainer.scrollTop = this.pdfViewerBase.viewerContainer.scrollTop - 200;\n        this.stichSelectionOnScroll(this.pdfViewerBase.currentPageNumber - 1);\n    };\n    /**\n     * @private\n     */\n    TextSelection.prototype.clear = function () {\n        if (this.scrollMoveTimer) {\n            this.isMouseLeaveSelection = false;\n            clearInterval(this.scrollMoveTimer);\n        }\n    };\n    /**\n     * @param element\n     * @param x\n     * @param y\n     * @param isStoreSelection\n     * @param element\n     * @param x\n     * @param y\n     * @param isStoreSelection\n     * @param element\n     * @param x\n     * @param y\n     * @param isStoreSelection\n     * @private\n     */\n    // eslint-disable-next-line\n    TextSelection.prototype.selectAWord = function (element, x, y, isStoreSelection) {\n        if (element.nodeType === element.TEXT_NODE) {\n            var selection = window.getSelection();\n            var range = element.ownerDocument.createRange();\n            range.selectNodeContents(element);\n            var currentPosition = 0;\n            var endPosition = range.endOffset;\n            while (currentPosition < endPosition) {\n                range.setStart(element, currentPosition);\n                range.setEnd(element, currentPosition + 1);\n                var rangeBounds = range.getBoundingClientRect();\n                if (rangeBounds.left <= x && rangeBounds.right >= x && rangeBounds.top <= y && rangeBounds.bottom >= y) {\n                    var textContent = element.textContent;\n                    var indices = [];\n                    var startPosition = void 0;\n                    var endPos = void 0;\n                    for (var i = 0; i < textContent.length; i++) {\n                        if (textContent[i] === ' ') {\n                            indices.push(i);\n                        }\n                    }\n                    for (var j = 0; j < indices.length; j++) {\n                        if (currentPosition === indices[j]) {\n                            startPosition = indices[j];\n                            endPos = indices[j];\n                        }\n                        if (indices[0] > currentPosition) {\n                            startPosition = 0;\n                            endPos = indices[j];\n                            break;\n                        }\n                        if (currentPosition > indices[j] && currentPosition < indices[j + 1]) {\n                            startPosition = indices[j];\n                            endPos = indices[j + 1];\n                        }\n                        else if (currentPosition > indices[j]) {\n                            if (!indices[j + 1]) {\n                                startPosition = indices[j];\n                            }\n                        }\n                    }\n                    if (!endPos) {\n                        endPos = textContent.length;\n                    }\n                    if (startPosition === 0) {\n                        range.setStart(element, startPosition);\n                    }\n                    else {\n                        range.setStart(element, startPosition + 1);\n                    }\n                    range.setEnd(element, endPos);\n                    selection.removeAllRanges();\n                    selection.addRange(range);\n                    this.isTextSelection = true;\n                    // eslint-disable-next-line max-len\n                    var startParent = isNullOrUndefined(range.startContainer.parentElement) ? range.startContainer.parentNode : range.startContainer.parentElement;\n                    // eslint-disable-next-line radix\n                    this.selectionStartPage = parseInt(startParent.id.split('_text_')[1]);\n                    if (isStoreSelection) {\n                        // eslint-disable-next-line max-len\n                        this.selectionAnchorTouch = { anchorNode: selection.anchorNode.parentElement.id, anchorOffset: selection.anchorOffset };\n                        this.selectionFocusTouch = { focusNode: selection.focusNode.parentElement.id, focusOffset: selection.focusOffset };\n                    }\n                    if (!Browser.isIE) {\n                        range.detach();\n                    }\n                    break;\n                }\n                currentPosition += 1;\n            }\n        }\n        else {\n            for (var i = 0; i < element.childNodes.length; i++) {\n                var range = this.getSelectionRange(i, element);\n                var rangeBounds = range.getBoundingClientRect();\n                if (rangeBounds.left <= x && rangeBounds.right >= x && rangeBounds.top <= y && rangeBounds.bottom >= y) {\n                    range.detach();\n                    this.selectAWord(element.childNodes[i], x, y, isStoreSelection);\n                }\n                else {\n                    range.detach();\n                }\n            }\n        }\n    };\n    TextSelection.prototype.getSelectionRange = function (index, element) {\n        var range = element.childNodes[index].ownerDocument.createRange();\n        range.selectNodeContents(element.childNodes[index]);\n        return range;\n    };\n    /**\n     * @param event\n     * @private\n     */\n    TextSelection.prototype.selectEntireLine = function (event) {\n        var textIds = [];\n        var targetElement = event.target;\n        var targetRect = targetElement.getBoundingClientRect();\n        // eslint-disable-next-line\n        var targetcentre = parseInt((targetRect.top + (targetRect.height / 2)).toString());\n        // eslint-disable-next-line radix\n        var pageNumber = parseInt(event.target.id.split('_text_')[1]);\n        var textDivs = document.querySelectorAll('div[id*=\"' + this.pdfViewer.element.id + '_text_' + pageNumber + '\"]');\n        if (targetElement.classList.contains('e-pv-text')) {\n            this.pdfViewer.fireTextSelectionStart(pageNumber + 1);\n            for (var i = 0; i < textDivs.length; i++) {\n                var rect = textDivs[i].getBoundingClientRect();\n                // eslint-disable-next-line radix\n                var topValue = parseInt(rect.top.toString());\n                // eslint-disable-next-line radix\n                var bottomValue = parseInt(rect.bottom.toString());\n                if ((topValue <= targetcentre && bottomValue > targetcentre) && (targetRect.bottom + 10 > bottomValue)) {\n                    var textId = textDivs[i].id;\n                    if (textId !== '') {\n                        textIds.push(textId);\n                    }\n                }\n            }\n            var selection = window.getSelection();\n            selection.removeAllRanges();\n            var range = document.createRange();\n            var lengths = (textIds.length - 1);\n            var d1 = document.getElementById(textIds[0]);\n            var d2 = document.getElementById(textIds[lengths]);\n            var childNodes = d2.childNodes.length;\n            if (childNodes > 0) {\n                range.setStart(d1.childNodes[0], 0);\n                range.setEnd(d2.childNodes[0], d2.textContent.length);\n            }\n            else {\n                range.setStart(d1.childNodes[0], 0);\n                range.setEnd(d2, 1);\n            }\n            // eslint-disable-next-line radix\n            this.selectionStartPage = parseInt(range.startContainer.parentElement.id.split('_text_')[1]);\n            selection.addRange(range);\n            this.isTextSelection = true;\n            if (selection != null && this.pdfViewer.contextMenuSettings.contextMenuAction === 'MouseUp') {\n                this.calculateContextMenuPosition(event.clientY, event.clientY);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TextSelection.prototype.enableTextSelectionMode = function () {\n        this.pdfViewerBase.isTextSelectionDisabled = false;\n        this.pdfViewerBase.viewerContainer.classList.remove('e-disable-text-selection');\n        this.pdfViewerBase.viewerContainer.classList.add('e-enable-text-selection');\n        this.pdfViewerBase.viewerContainer.addEventListener('selectstart', function () {\n            return true;\n        });\n    };\n    TextSelection.prototype.clearTextSelection = function () {\n        if (this.isTextSelection) {\n            this.pdfViewerBase.textLayer.clearDivSelection();\n            if (window.getSelection) {\n                if (window.getSelection().removeAllRanges) {\n                    window.getSelection().removeAllRanges();\n                }\n            }\n            if (this.pdfViewer.linkAnnotationModule) {\n                var lowerPageIndex = this.pdfViewerBase.currentPageNumber - 3;\n                lowerPageIndex = (lowerPageIndex < 0) ? 0 : lowerPageIndex;\n                var higherPageIndex = this.pdfViewer.currentPageNumber + 1;\n                // eslint-disable-next-line max-len\n                higherPageIndex = (higherPageIndex < (this.pdfViewerBase.pageCount - 1)) ? higherPageIndex : (this.pdfViewerBase.pageCount - 1);\n                for (var i = lowerPageIndex; i <= higherPageIndex; i++) {\n                    this.pdfViewer.linkAnnotationModule.modifyZindexForTextSelection(i, false);\n                }\n            }\n            if (this.pdfViewer.annotation && this.pdfViewer.annotation.textMarkupAnnotationModule) {\n                this.pdfViewer.annotation.textMarkupAnnotationModule.showHideDropletDiv(true);\n            }\n            this.selectionRangeArray = [];\n            this.isTextSelection = false;\n            this.isTouchSelection = false;\n            if (this.pdfViewer.textSearchModule) {\n                this.pdfViewer.textSearchModule.searchAfterSelection();\n            }\n            this.pdfViewerBase.contextMenuModule.close();\n            this.removeTouchElements();\n        }\n    };\n    /**\n     * @private\n     */\n    TextSelection.prototype.removeTouchElements = function () {\n        if (this.dropDivElementLeft) {\n            this.dropDivElementLeft.parentElement.removeChild(this.dropDivElementLeft);\n            this.dropDivElementLeft = null;\n            this.dropElementLeft.style.transform = 'rotate(0deg)';\n        }\n        if (this.dropDivElementRight) {\n            this.dropDivElementRight.parentElement.removeChild(this.dropDivElementRight);\n            this.dropDivElementRight = null;\n            this.dropElementRight.style.transform = 'rotate(-90deg)';\n        }\n    };\n    /**\n     * @private\n     */\n    TextSelection.prototype.resizeTouchElements = function () {\n        var viewerContainerLeft = this.pdfViewerBase.viewerContainer.getBoundingClientRect().left;\n        if (this.dropDivElementLeft) {\n            var elementClientRect = this.dropDivElementLeft.getBoundingClientRect();\n            var dropElementHeight = 0;\n            // eslint-disable-next-line max-len\n            var leftCurrentPagePosition = this.pdfViewerBase.getElement('_pageDiv_' + this.topStoreLeft.pageNumber).getBoundingClientRect();\n            this.dropDivElementLeft.style.left = parseFloat(this.topStoreLeft.left.toString()) * this.pdfViewerBase.getZoomFactor() + leftCurrentPagePosition.left - viewerContainerLeft - (elementClientRect.width / 2) + 'px';\n            if (this.topStoreLeft.isHeightNeeded) {\n                dropElementHeight = (elementClientRect.height / 2) * this.pdfViewerBase.getZoomFactor();\n            }\n            // eslint-disable-next-line max-len\n            this.dropDivElementLeft.style.top = parseFloat(this.topStoreLeft.pageTop.toString()) * this.pdfViewerBase.getZoomFactor() + parseFloat(this.topStoreLeft.topClientValue.toString()) * this.pdfViewerBase.getZoomFactor() + dropElementHeight + 'px';\n        }\n        if (this.dropDivElementRight) {\n            var elementClientRect = this.dropDivElementRight.getBoundingClientRect();\n            var dropElementHeight = 0;\n            // eslint-disable-next-line max-len\n            var rightCurrentPagePosition = this.pdfViewerBase.getElement('_pageDiv_' + this.topStoreRight.pageNumber).getBoundingClientRect();\n            this.dropDivElementRight.style.left = parseFloat(this.topStoreRight.left.toString()) * this.pdfViewerBase.getZoomFactor() + rightCurrentPagePosition.left - viewerContainerLeft - (elementClientRect.width / 2) + 'px';\n            if (this.topStoreRight.isHeightNeeded) {\n                dropElementHeight = (elementClientRect.height / 2) * this.pdfViewerBase.getZoomFactor();\n            }\n            // eslint-disable-next-line max-len\n            this.dropDivElementRight.style.top = parseFloat(this.topStoreRight.pageTop.toString()) * this.pdfViewerBase.getZoomFactor() + parseFloat(this.topStoreRight.topClientValue.toString()) * this.pdfViewerBase.getZoomFactor() + dropElementHeight + 'px';\n        }\n    };\n    /**\n     * @param event\n     * @private\n     */\n    TextSelection.prototype.textSelectionOnMouseup = function (event) {\n        this.clear();\n        if (window.getSelection().anchorNode !== null) {\n            this.isMouseLeaveSelection = false;\n            this.isSelectionStartTriggered = false;\n            this.maintainSelectionOnZoom(true, false);\n            this.fireTextSelectEnd();\n            var isTextSearch = this.pdfViewerBase.textLayer.getTextSearchStatus();\n            if (isTextSearch) {\n                this.pdfViewerBase.textLayer.clearDivSelection();\n                // eslint-disable-next-line\n                var indexes = this.pdfViewer.textSearchModule.getIndexes();\n                var lowerPageValue = parseFloat(indexes.lowerPageValue.toString());\n                var higherPageValue = parseFloat(indexes.higherPageValue.toString());\n                for (var i = lowerPageValue; i < higherPageValue; i++) {\n                    this.applySelectionRangeOnScroll(i);\n                }\n                this.pdfViewer.textSearchModule.searchAfterSelection();\n            }\n            else {\n                this.applySpanForSelection();\n            }\n            if (this.pdfViewer.linkAnnotationModule) {\n                this.pdfViewer.linkAnnotationModule.modifyZindexForTextSelection(this.pdfViewerBase.currentPageNumber - 1, false);\n            }\n            if (this.isTextSearched && this.pdfViewer.contextMenuSettings.contextMenuAction === 'MouseUp') {\n                this.calculateContextMenuPosition(event.clientY, event.clientX);\n                this.isTextSearched = false;\n            }\n        }\n        else {\n            this.pdfViewerBase.textLayer.clearDivSelection();\n            if (this.pdfViewer.textSearchModule) {\n                this.pdfViewer.textSearchModule.searchAfterSelection();\n            }\n            this.pdfViewerBase.contextMenuModule.close();\n            this.removeTouchElements();\n        }\n    };\n    /**\n     * @private\n     */\n    TextSelection.prototype.fireTextSelectEnd = function () {\n        if (this.selectionRangeArray.length !== 0) {\n            var selectEndPageIndex = 0;\n            var selectedText = '';\n            // eslint-disable-next-line\n            var selectedBounds = [];\n            for (var k = 0; k < this.selectionRangeArray.length; k++) {\n                selectedText += this.selectionRangeArray[k].textContent;\n                for (var j = 0; j < this.selectionRangeArray[k].rectangleBounds.length; j++) {\n                    var currentBound = this.selectionRangeArray[k].rectangleBounds[j];\n                    // eslint-disable-next-line max-len\n                    selectedBounds.push({ left: currentBound.left, right: currentBound.right, top: currentBound.top, bottom: currentBound.bottom, width: currentBound.width, height: currentBound.height, pageIndex: this.selectionRangeArray[k].pageNumber + 1 });\n                }\n                if (this.selectionRangeArray[k].isBackward && k === 0) {\n                    selectEndPageIndex = this.selectionRangeArray[k].pageNumber + 1;\n                }\n                else if (!this.selectionRangeArray[k].isBackward && k === this.selectionRangeArray.length - 1) {\n                    selectEndPageIndex = this.selectionRangeArray[k].pageNumber + 1;\n                }\n            }\n            this.pdfViewer.fireTextSelectionEnd(selectEndPageIndex, selectedText, selectedBounds);\n        }\n    };\n    /**\n     * @param isMaintainSelection\n     * @param isStich\n     * @param isMaintainSelection\n     * @param isStich\n     * @private\n     */\n    TextSelection.prototype.maintainSelectionOnZoom = function (isMaintainSelection, isStich) {\n        var selection = window.getSelection();\n        if (selection.type === 'Range' || (!selection.type && !selection.isCollapsed)) {\n            var isBackward = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n            if (selection.anchorNode !== null) {\n                // eslint-disable-next-line radix\n                var anchorPageId = parseInt(this.getNodeElementFromNode(selection.anchorNode).id.split('_text_')[1]);\n                // eslint-disable-next-line radix\n                var focusPageId = parseInt(this.getNodeElementFromNode(selection.focusNode).id.split('_text_')[1]);\n                if (this.isTouchSelection && isNaN(focusPageId)) {\n                    var focusElement = selection.focusNode;\n                    if (focusElement === this.pdfViewerBase.pageContainer) {\n                        var lastChildNode = this.pdfViewerBase.pageContainer.lastChild;\n                        if (lastChildNode.classList.contains('e-pv-touch-select-drop')) {\n                            // eslint-disable-next-line radix\n                            focusPageId = parseInt(lastChildNode.previousSibling.previousSibling.id.split('_pageDiv_')[1]);\n                        }\n                        else if (lastChildNode.classList.contains('e-pv-page-div')) {\n                            // eslint-disable-next-line radix\n                            focusPageId = parseInt(lastChildNode.id.split('_pageDiv_')[1]);\n                        }\n                    }\n                }\n                if (!isBackward) {\n                    for (var i = anchorPageId; i <= focusPageId; i++) {\n                        this.maintainSelectionOnScroll(i, isStich);\n                    }\n                }\n                else {\n                    for (var i = anchorPageId; i >= focusPageId; i--) {\n                        this.maintainSelectionOnScroll(i, isStich);\n                    }\n                }\n            }\n            if (!isMaintainSelection) {\n                selection.removeAllRanges();\n            }\n        }\n    };\n    /**\n     * @param pageNumber\n     * @private\n     */\n    TextSelection.prototype.isSelectionAvailableOnScroll = function (pageNumber) {\n        var isSelectionAvailable = false;\n        var ranges = this.selectionRangeArray;\n        for (var i = 0; i < ranges.length; i++) {\n            if (ranges[i] !== null) {\n                if (pageNumber === ranges[i].pageNumber) {\n                    isSelectionAvailable = true;\n                    if (this.isTouchSelection && !this.pdfViewerBase.getMagnified()) {\n                        isSelectionAvailable = false;\n                    }\n                    break;\n                }\n            }\n        }\n        return isSelectionAvailable;\n    };\n    /**\n     * @param pageNumber\n     * @private\n     */\n    TextSelection.prototype.applySelectionRangeOnScroll = function (pageNumber) {\n        if (this.isMouseLeaveSelection) {\n            this.applySelectionMouseScroll(pageNumber);\n        }\n        else {\n            this.applySelectionRange(pageNumber);\n        }\n    };\n    // eslint-disable-next-line\n    TextSelection.prototype.getSelectionRangeFromArray = function (pageNumber) {\n        var isSelectionAvailable = false;\n        var selectionRange = null;\n        var ranges = this.selectionRangeArray;\n        for (var i = 0; i < ranges.length; i++) {\n            if (ranges[i] !== null) {\n                if (pageNumber === ranges[i].pageNumber) {\n                    selectionRange = ranges[i];\n                    isSelectionAvailable = true;\n                    break;\n                }\n            }\n        }\n        return { isSelectionAvailable: isSelectionAvailable, selectionRange: selectionRange };\n    };\n    TextSelection.prototype.applySelectionRange = function (pageNumber) {\n        var selectionObject = this.getSelectionRangeFromArray(pageNumber);\n        var isSelectionAvailable = selectionObject.isSelectionAvailable;\n        var textLayer = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + pageNumber);\n        if (textLayer) {\n            if (isSelectionAvailable && textLayer.childNodes.length !== 0) {\n                var selectionRange = selectionObject.selectionRange;\n                var anchorOffsetDiv = void 0;\n                var focusOffsetDiv = void 0;\n                var anchorOffset = void 0;\n                var focusOffset = void 0;\n                if (selectionRange.isBackward) {\n                    // eslint-disable-next-line radix\n                    var startId = parseInt(selectionRange.endNode.split('_text_')[1].split('_')[1]);\n                    // eslint-disable-next-line radix\n                    var endId = parseInt(selectionRange.startNode.split('_text_')[1].split('_')[1]);\n                    if (startId < endId) {\n                        anchorOffsetDiv = startId;\n                        anchorOffset = selectionRange.endOffset;\n                        focusOffset = selectionRange.startOffset;\n                        focusOffsetDiv = endId;\n                    }\n                    else {\n                        anchorOffsetDiv = endId;\n                        anchorOffset = selectionRange.endOffset;\n                        focusOffsetDiv = startId;\n                        focusOffset = selectionRange.startOffset;\n                    }\n                }\n                else {\n                    // eslint-disable-next-line radix\n                    anchorOffsetDiv = parseInt(selectionRange.startNode.split('text_')[1].split('_')[1]);\n                    // eslint-disable-next-line radix\n                    focusOffsetDiv = parseInt(selectionRange.endNode.split('text_')[1].split('_')[1]);\n                    anchorOffset = selectionRange.startOffset;\n                    focusOffset = selectionRange.endOffset;\n                }\n                window.getSelection().removeAllRanges();\n                // eslint-disable-next-line max-len\n                this.pdfViewerBase.textLayer.applySpanForSelection(pageNumber, pageNumber, anchorOffsetDiv, focusOffsetDiv, anchorOffset, focusOffset);\n                if (this.pdfViewer.textSearchModule) {\n                    this.pdfViewer.textSearchModule.searchAfterSelection();\n                }\n            }\n        }\n    };\n    TextSelection.prototype.applySelectionMouseScroll = function (pageNumber) {\n        var selectionObject = this.getSelectionRangeFromArray(pageNumber);\n        var isSelectionAvailable = selectionObject.isSelectionAvailable;\n        if (isSelectionAvailable) {\n            var selectionRange = selectionObject.selectionRange;\n            var selection = window.getSelection();\n            var anchorNode = document.getElementById(selectionRange.startNode).childNodes[0];\n            var focusNode = document.getElementById(selectionRange.endNode).childNodes[0];\n            var range = document.createRange();\n            if (selection.anchorNode === null) {\n                if (!selectionRange.isBackward) {\n                    range.setStart(anchorNode, selectionRange.startOffset);\n                    range.setEnd(focusNode, selectionRange.endOffset);\n                }\n                else {\n                    range.setStart(focusNode, selectionRange.endOffset);\n                    range.setEnd(anchorNode, selectionRange.startOffset);\n                }\n            }\n            else {\n                // eslint-disable-next-line\n                var anchorPageIndex = isNaN(parseInt(selection.anchorNode.parentElement.id.split('_text_')[1])) ? parseInt(selection.anchorNode.id.split('_pageDiv_')[1]) : parseInt(selection.anchorNode.parentElement.id.split('_text_')[1]);\n                if (isNaN(anchorPageIndex)) {\n                    // eslint-disable-next-line radix\n                    anchorPageIndex = parseInt(selection.anchorNode.id.split('_text_')[1]);\n                }\n                // eslint-disable-next-line\n                var focusPageIndex = isNaN(parseInt(selection.focusNode.parentElement.id.split('_text_')[1])) ? parseInt(selection.focusNode.id.split('_pageDiv_')[1]) : parseInt(selection.focusNode.parentElement.id.split('_text_')[1]);\n                // eslint-disable-next-line radix\n                var currentAnchorIndex = parseInt(selectionRange.startNode.split('_text_')[1]);\n                if ((anchorPageIndex === focusPageIndex) && (anchorPageIndex === currentAnchorIndex)) {\n                    if (!selectionRange.isBackward) {\n                        range.setStart(anchorNode, selectionRange.startOffset);\n                        range.setEnd(focusNode, selectionRange.endOffset);\n                    }\n                    else {\n                        range.setStart(focusNode, selectionRange.endOffset);\n                        range.setEnd(anchorNode, selectionRange.startOffset);\n                    }\n                }\n                else if (!isNaN(anchorPageIndex)) {\n                    if (!isNaN(anchorPageIndex) && !selectionRange.isBackward) {\n                        // eslint-disable-next-line max-len\n                        if (anchorPageIndex < currentAnchorIndex && currentAnchorIndex < focusPageIndex && anchorPageIndex !== focusPageIndex) {\n                            range.setStart(selection.anchorNode, selection.anchorOffset);\n                            range.setEnd(selection.focusNode, selection.focusOffset);\n                        }\n                        else if (anchorPageIndex < currentAnchorIndex) {\n                            range.setStart(selection.anchorNode, selection.anchorOffset);\n                            range.setEnd(focusNode, selectionRange.endOffset);\n                        }\n                        else {\n                            range.setStart(anchorNode, selectionRange.startOffset);\n                            range.setEnd(selection.focusNode, selection.focusOffset);\n                        }\n                    }\n                    else {\n                        var isBackward = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n                        // eslint-disable-next-line max-len\n                        if (anchorPageIndex > currentAnchorIndex && currentAnchorIndex > focusPageIndex && anchorPageIndex !== focusPageIndex) {\n                            if (!isBackward) {\n                                range.setStart(selection.anchorNode, selection.anchorOffset);\n                                range.setEnd(selection.focusNode, selection.focusOffset);\n                            }\n                            else {\n                                selection.extend(selection.focusNode, selection.focusOffset);\n                            }\n                            // eslint-disable-next-line max-len\n                        }\n                        else if (anchorPageIndex < currentAnchorIndex && currentAnchorIndex < focusPageIndex && anchorPageIndex !== focusPageIndex) {\n                            if (!isBackward) {\n                                range.setStart(selection.anchorNode, selection.anchorOffset);\n                                range.setEnd(selection.focusNode, selection.focusOffset);\n                            }\n                            else {\n                                selection.extend(selection.focusNode, selection.focusOffset);\n                            }\n                        }\n                        else if (anchorPageIndex < currentAnchorIndex) {\n                            if (!isBackward) {\n                                if (currentAnchorIndex !== this.selectionRangeArray[0].pageNumber) {\n                                    range.setStart(selection.anchorNode, selection.anchorOffset);\n                                    range.setEnd(focusNode, selectionRange.endOffset);\n                                }\n                                else {\n                                    range.setStart(selection.anchorNode, selection.anchorOffset);\n                                    range.setEnd(anchorNode, selectionRange.startOffset);\n                                }\n                            }\n                            else {\n                                if (currentAnchorIndex !== this.selectionRangeArray[0].pageNumber) {\n                                    this.extendCurrentSelection(focusNode.parentElement, selectionRange.endOffset, selection, range);\n                                }\n                                else {\n                                    this.extendCurrentSelection(anchorNode.parentElement, selectionRange.startOffset, selection, range);\n                                }\n                            }\n                        }\n                        else if (anchorPageIndex === currentAnchorIndex) {\n                            if (currentAnchorIndex === focusPageIndex) {\n                                range.setStart(anchorNode, selectionRange.startOffset);\n                                range.setEnd(anchorNode, selectionRange.startOffset);\n                                selection.removeAllRanges();\n                                selection.addRange(range);\n                                range = document.createRange();\n                                selection.extend(focusNode, selectionRange.endOffset);\n                            }\n                            else {\n                                if (isBackward) {\n                                    this.extendCurrentSelection(focusNode.parentElement, selectionRange.endOffset, selection, range);\n                                }\n                                else {\n                                    range.setStart(focusNode, selectionRange.endOffset);\n                                    range.setEnd(selection.focusNode, selection.focusOffset);\n                                }\n                            }\n                        }\n                        else if (focusPageIndex === currentAnchorIndex) {\n                            if (isBackward) {\n                                selection.extend(selection.focusNode, selection.focusOffset);\n                            }\n                            else {\n                                range.setStart(selection.anchorNode, selection.anchorOffset);\n                                range.setEnd(selection.focusNode, selection.focusOffset);\n                            }\n                        }\n                        else if (anchorPageIndex > currentAnchorIndex) {\n                            // eslint-disable-next-line radix\n                            var currentAnchorOffset = parseInt(selectionRange.startNode.split('_' + currentAnchorIndex + '_')[1]);\n                            // eslint-disable-next-line radix\n                            var currentFocusOffset = parseInt(selectionRange.endNode.split('_' + currentAnchorIndex + '_')[1]);\n                            if (isBackward) {\n                                if (currentAnchorIndex !== this.selectionRangeArray[0].pageNumber) {\n                                    if (currentAnchorOffset < currentFocusOffset) {\n                                        this.extendCurrentSelection(anchorNode.parentElement, selectionRange.startOffset, selection, range);\n                                    }\n                                    else {\n                                        range.setStart(focusNode.parentElement, selectionRange.endOffset);\n                                        range.setEnd(selection.anchorNode, selection.anchorOffset);\n                                    }\n                                }\n                                else {\n                                    this.extendCurrentSelection(focusNode.parentElement, selectionRange.endOffset, selection, range);\n                                }\n                            }\n                            else {\n                                if (currentAnchorOffset < currentFocusOffset) {\n                                    range.setStart(anchorNode, selectionRange.startOffset);\n                                    range.setEnd(selection.focusNode, selection.focusOffset);\n                                }\n                                else {\n                                    range.setStart(focusNode, selectionRange.endOffset);\n                                    range.setEnd(selection.focusNode, selection.focusOffset);\n                                }\n                            }\n                        }\n                    }\n                }\n                else if (isNaN(anchorPageIndex)) {\n                    if (!selectionRange.isBackward) {\n                        range.setStart(anchorNode, selectionRange.startOffset);\n                        range.setEnd(focusNode, selectionRange.endOffset);\n                    }\n                    else {\n                        range.setStart(focusNode, selectionRange.endOffset);\n                        range.setEnd(anchorNode, selectionRange.startOffset);\n                    }\n                }\n            }\n            if (range.toString() !== '') {\n                selection.removeAllRanges();\n                selection.addRange(range);\n            }\n        }\n    };\n    /**\n     * @param pageNumber\n     * @param isStich\n     * @param pageNumber\n     * @param isStich\n     * @private\n     */\n    TextSelection.prototype.maintainSelectionOnScroll = function (pageNumber, isStich) {\n        var isSelectionAvailable = this.isSelectionAvailableOnScroll(pageNumber);\n        if (this.isTextSelection && !isSelectionAvailable) {\n            this.maintainSelection(pageNumber, isStich);\n        }\n    };\n    /**\n     * @param pageNumber\n     * @param isStich\n     * @private\n     */\n    TextSelection.prototype.maintainSelection = function (pageNumber, isStich) {\n        var selection = window.getSelection();\n        if (this.isTextSelection && (selection.type === 'Range' || (!selection.type && !selection.isCollapsed))) {\n            // eslint-disable-next-line\n            var anchorPageId = parseInt(this.getNodeElementFromNode(selection.anchorNode).id.split('_text_')[1]);\n            // eslint-disable-next-line\n            var focusPageId = parseInt(this.getNodeElementFromNode(selection.focusNode).id.split('_text_')[1]);\n            if (isNaN(focusPageId) && selection.anchorNode !== null) {\n                var backward_1 = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n                if (!backward_1) {\n                    // eslint-disable-next-line radix\n                    var lastChildNode = this.pdfViewerBase.pageContainer.lastChild;\n                    if (lastChildNode.classList.contains('e-pv-touch-select-drop')) {\n                        // eslint-disable-next-line radix\n                        focusPageId = parseInt(lastChildNode.previousSibling.previousSibling.id.split('_pageDiv_')[1]);\n                    }\n                    else {\n                        // eslint-disable-next-line radix\n                        focusPageId = parseInt(lastChildNode.id.split('_pageDiv_')[1]);\n                    }\n                }\n                else {\n                    // eslint-disable-next-line radix\n                    focusPageId = parseInt(this.pdfViewerBase.pageContainer.firstChild.id.split('_pageDiv_')[1]);\n                }\n            }\n            var backward = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n            if (this.isTouchSelection && pageNumber > focusPageId && pageNumber > anchorPageId) {\n                return;\n            }\n            if (anchorPageId === focusPageId) {\n                var selectionObject = null;\n                var selectionBounds = this.getSelectionBounds(selection.getRangeAt(0), pageNumber);\n                var selectionRectBounds = this.getSelectionRectangleBounds(selection.getRangeAt(0), pageNumber);\n                // eslint-disable-next-line max-len\n                var anchorOffsetValue = (this.getNodeElementFromNode(selection.anchorNode).childNodes.length === 1) ? selection.anchorOffset : this.getCorrectOffset(selection.anchorNode, selection.anchorOffset);\n                var focusOffsetValue = (this.getNodeElementFromNode(selection.focusNode).childNodes.length === 1) ? selection.focusOffset : this.getCorrectOffset(selection.focusNode, selection.focusOffset);\n                selectionObject = {\n                    isBackward: backward, startNode: this.getNodeElementFromNode(selection.anchorNode).id,\n                    startOffset: anchorOffsetValue, endNode: this.getNodeElementFromNode(selection.focusNode).id,\n                    // eslint-disable-next-line max-len\n                    endOffset: focusOffsetValue, textContent: selection.toString(), pageNumber: pageNumber, bound: selectionBounds, rectangleBounds: selectionRectBounds\n                };\n                this.pushSelectionRangeObject(selectionObject, pageNumber);\n            }\n            else {\n                var selectionObject = this.createRangeObjectOnScroll(pageNumber, anchorPageId, focusPageId);\n                if (selectionObject) {\n                    this.pushSelectionRangeObject(selectionObject, pageNumber);\n                    if (isStich) {\n                        this.stichSelection(backward, selection, pageNumber);\n                    }\n                }\n            }\n        }\n    };\n    TextSelection.prototype.getCorrectOffset = function (node, offset) {\n        var offsetValue = 0;\n        var parentElement = this.getNodeElementFromNode(node);\n        for (var i = 0; i < parentElement.childNodes.length; i++) {\n            if (parentElement.childNodes[i] === node) {\n                offsetValue = offsetValue + offset;\n                break;\n            }\n            else {\n                offsetValue = offsetValue + parentElement.childNodes[i].textContent.length;\n            }\n        }\n        return offsetValue;\n    };\n    TextSelection.prototype.pushSelectionRangeObject = function (selectionObject, pageNumber) {\n        if (this.isTouchSelection) {\n            var currentObject = this.selectionRangeArray.filter(\n            // eslint-disable-next-line\n            function (obj) {\n                return (obj.pageNumber === pageNumber);\n            });\n            if (currentObject.length > 0) {\n                var currentObjectIndex = this.selectionRangeArray.indexOf(currentObject[0]);\n                this.selectionRangeArray.splice(currentObjectIndex, 1, selectionObject);\n                return;\n            }\n        }\n        var nextPageObject = this.selectionRangeArray.filter(\n        // eslint-disable-next-line\n        function (obj) {\n            return (obj.pageNumber === (pageNumber + 1));\n        });\n        if (nextPageObject.length === 0) {\n            if (this.isTouchSelection && this.selectionRangeArray.length !== 0) {\n                var prevPageObject = this.selectionRangeArray.filter(\n                // eslint-disable-next-line\n                function (obj) {\n                    return (obj.pageNumber === (pageNumber - 1));\n                });\n                if (prevPageObject.length !== 0) {\n                    var prevIndex = this.selectionRangeArray.indexOf(prevPageObject[0]);\n                    this.selectionRangeArray.splice(prevIndex + 1, 0, selectionObject);\n                }\n                else {\n                    var firstObject = this.selectionRangeArray[0];\n                    if (pageNumber < firstObject.pageNumber) {\n                        this.selectionRangeArray.splice(0, 0, selectionObject);\n                    }\n                    else {\n                        this.selectionRangeArray.push(selectionObject);\n                    }\n                }\n            }\n            else {\n                this.selectionRangeArray.push(selectionObject);\n            }\n        }\n        else {\n            var index = this.selectionRangeArray.indexOf(nextPageObject[0]);\n            this.selectionRangeArray.splice(index, 0, selectionObject);\n        }\n    };\n    TextSelection.prototype.extendCurrentSelection = function (element, offset, selection, range) {\n        var currentFocusOffset = selection.focusOffset;\n        var currentFocusElement = selection.focusNode.parentElement.id;\n        // eslint-disable-next-line\n        var focusPageId = isNaN(parseInt(currentFocusElement.split('_text_')[1])) ? parseInt(selection.focusNode.id.split('_pageDiv_')[1]) : parseInt(currentFocusElement.split('_text_')[1]);\n        // eslint-disable-next-line radix\n        if (isNaN(parseInt(currentFocusElement.split('_text_')[1]))) {\n            // eslint-disable-next-line\n            currentFocusElement = this.pdfViewerBase.getElement('_textLayer_' + (focusPageId + 1)).firstChild.id;\n        }\n        range.setStart(element.childNodes[0], offset);\n        range.setEnd(element.childNodes[0], offset);\n        selection.removeAllRanges();\n        selection.addRange(range);\n        selection.extend(document.getElementById(currentFocusElement).childNodes[0], currentFocusOffset);\n    };\n    TextSelection.prototype.stichSelection = function (backward, selection, pageNumber) {\n        var range = document.createRange();\n        var nextPageElement;\n        if (backward) {\n            nextPageElement = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + (pageNumber - 1));\n            if (nextPageElement) {\n                var lastElement = nextPageElement.lastChild;\n                if (lastElement) {\n                    this.extendCurrentSelection(lastElement, this.getTextLastLength(lastElement), selection, range);\n                }\n                else {\n                    nextPageElement = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + (pageNumber - 2));\n                    lastElement = nextPageElement.lastChild;\n                    this.extendCurrentSelection(lastElement, this.getTextLastLength(lastElement), selection, range);\n                }\n            }\n            else {\n                nextPageElement = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + (pageNumber + 1));\n                var lastElement = nextPageElement.firstChild;\n                this.extendCurrentSelection(lastElement, 0, selection, range);\n            }\n        }\n        else {\n            nextPageElement = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + (pageNumber + 1));\n            if (nextPageElement) {\n                var firstElement = nextPageElement.firstChild;\n                if (!firstElement) {\n                    nextPageElement = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + (pageNumber + 2));\n                    firstElement = nextPageElement.firstChild;\n                    range.setStart(firstElement.childNodes[0], 0);\n                }\n                else {\n                    range.setStart(firstElement.childNodes[0], 0);\n                }\n                range.setEnd(selection.focusNode, selection.focusOffset);\n                selection.removeAllRanges();\n                selection.addRange(range);\n            }\n        }\n    };\n    /**\n     * @param currentPageNumber\n     * @private\n     */\n    TextSelection.prototype.textSelectionOnMouseWheel = function (currentPageNumber) {\n        this.isMouseLeaveSelection = true;\n        this.stichSelectionOnScroll(currentPageNumber);\n    };\n    /**\n     * @param currentPageNumber\n     * @private\n     */\n    TextSelection.prototype.stichSelectionOnScroll = function (currentPageNumber) {\n        var selection = window.getSelection();\n        if (this.isTextSelection) {\n            // eslint-disable-next-line radix\n            var anchorPageId = parseInt(this.getNodeElementFromNode(selection.anchorNode).id.split('_text_')[1]);\n            // eslint-disable-next-line radix\n            var focusPageId = parseInt(this.getNodeElementFromNode(selection.focusNode).id.split('_text_')[1]);\n            var nextPageElement = void 0;\n            if (anchorPageId !== currentPageNumber && focusPageId !== currentPageNumber) {\n                var backward = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n                if (!backward) {\n                    nextPageElement = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + (currentPageNumber - 1));\n                    if (nextPageElement) {\n                        var lastElement = nextPageElement.lastChild;\n                        if (lastElement) {\n                            if (lastElement.childNodes[0]) {\n                                this.extendSelectionStich(lastElement.childNodes[0], this.getTextLastLength(lastElement), selection);\n                            }\n                            else {\n                                this.extendSelectionStich(lastElement, this.getTextLastLength(lastElement), selection);\n                            }\n                        }\n                        else {\n                            nextPageElement = this.pdfViewerBase.getElement('_textLayer_' + currentPageNumber);\n                            var lastElement_1 = nextPageElement.firstChild;\n                            this.extendSelectionStich(lastElement_1.childNodes[0], 0, selection);\n                        }\n                    }\n                }\n                else {\n                    nextPageElement = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + (currentPageNumber - 1));\n                    if (nextPageElement) {\n                        var lastElement = nextPageElement.firstChild;\n                        if (lastElement) {\n                            this.extendSelectionStich(lastElement.childNodes[0], 0, selection);\n                        }\n                    }\n                }\n            }\n            this.maintainSelectionArray();\n        }\n    };\n    TextSelection.prototype.extendSelectionStich = function (node, offset, selection) {\n        if (selection.extend) {\n            selection.extend(node, offset);\n        }\n    };\n    /**\n     * @param pageNumber\n     * @param anchorPageId\n     * @param focusPageId\n     * @param pageNumber\n     * @param anchorPageId\n     * @param focusPageId\n     * @private\n     */\n    TextSelection.prototype.createRangeObjectOnScroll = function (pageNumber, anchorPageId, focusPageId) {\n        var selectionObject = null;\n        var selection = window.getSelection();\n        if (selection.anchorNode !== null) {\n            var backward = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n            var firstElement = void 0;\n            var lastElement = void 0;\n            var startOffset = void 0;\n            var endOffset = void 0;\n            var element = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + pageNumber);\n            if (element.childNodes) {\n                if (!backward) {\n                    if (pageNumber === anchorPageId) {\n                        firstElement = this.getNodeElementFromNode(selection.anchorNode);\n                        // eslint-disable-next-line max-len\n                        lastElement = element.lastChild;\n                        startOffset = this.getCorrectOffset(selection.anchorNode, selection.anchorOffset);\n                        endOffset = this.getTextLastLength(lastElement);\n                    }\n                    else if (pageNumber > anchorPageId && pageNumber < focusPageId) {\n                        // eslint-disable-next-line max-len\n                        firstElement = element.firstChild;\n                        // eslint-disable-next-line max-len\n                        lastElement = element.lastChild;\n                        startOffset = 0;\n                        endOffset = this.getTextLastLength(lastElement);\n                    }\n                    else if (pageNumber === focusPageId) {\n                        // eslint-disable-next-line max-len\n                        firstElement = element.firstChild;\n                        var pageNumberIndex = this.getNodeElementFromNode(selection.focusNode).id.indexOf(focusPageId.toString());\n                        if (pageNumberIndex !== -1) {\n                            lastElement = this.getNodeElementFromNode(selection.focusNode);\n                            endOffset = this.getCorrectOffset(selection.focusNode, selection.focusOffset);\n                        }\n                        else {\n                            // eslint-disable-next-line max-len\n                            lastElement = document.getElementById(this.pdfViewer.element.id + '_textLayer_' + focusPageId).lastChild;\n                            endOffset = this.getTextLastLength(lastElement);\n                        }\n                        startOffset = 0;\n                    }\n                }\n                else {\n                    if (pageNumber === anchorPageId) {\n                        firstElement = this.getNodeElementFromNode(selection.anchorNode);\n                        // eslint-disable-next-line max-len\n                        lastElement = element.firstChild;\n                        startOffset = this.getCorrectOffset(selection.anchorNode, selection.anchorOffset);\n                        endOffset = 0;\n                    }\n                    else if (pageNumber < anchorPageId && pageNumber > focusPageId) {\n                        // eslint-disable-next-line max-len\n                        firstElement = element.firstChild;\n                        // eslint-disable-next-line max-len\n                        lastElement = element.lastChild;\n                        startOffset = 0;\n                        endOffset = this.getTextLastLength(lastElement);\n                    }\n                    else if (pageNumber === focusPageId) {\n                        firstElement = this.getNodeElementFromNode(selection.focusNode);\n                        // eslint-disable-next-line max-len\n                        lastElement = element.lastChild;\n                        startOffset = this.getCorrectOffset(selection.focusNode, selection.focusOffset);\n                        endOffset = this.getTextLastLength(lastElement);\n                    }\n                }\n                if (firstElement && lastElement) {\n                    // eslint-disable-next-line max-len\n                    var selectionRangeObject = this.getSelectionRangeObject(firstElement.id, startOffset, lastElement.id, endOffset, pageNumber);\n                    var selectionString = selectionRangeObject.toString();\n                    var selectionBound = this.getSelectionBounds(selectionRangeObject, pageNumber);\n                    var selectionRectBounds = this.getSelectionRectangleBounds(selectionRangeObject, pageNumber);\n                    // eslint-disable-next-line max-len\n                    return selectionObject = { isBackward: backward, startNode: firstElement.id, startOffset: startOffset, endNode: lastElement.id, endOffset: endOffset, textContent: selectionString, pageNumber: pageNumber, bound: selectionBound, rectangleBounds: selectionRectBounds };\n                }\n                else {\n                    return null;\n                }\n            }\n        }\n        return null;\n    };\n    TextSelection.prototype.getSelectionRangeObject = function (startNode, startOffset, endNode, endOffset, pageNumber) {\n        var startElement = document.getElementById(startNode);\n        var endElement = document.getElementById(endNode);\n        if (startElement.childNodes[0]) {\n            startElement = startElement.childNodes[0];\n        }\n        if (endElement.childNodes[0]) {\n            endElement = endElement.childNodes[0];\n        }\n        // eslint-disable-next-line radix\n        var currentAnchorOffset = parseInt(startNode.split('_' + pageNumber + '_')[1]);\n        // eslint-disable-next-line radix\n        var currentFocusOffset = parseInt(endNode.split('_' + pageNumber + '_')[1]);\n        var range = document.createRange();\n        if (currentAnchorOffset <= currentFocusOffset) {\n            range.setStart(startElement, startOffset);\n            range.setEnd(endElement, endOffset);\n        }\n        else {\n            range.setStart(endElement, endOffset);\n            range.setEnd(startElement, startOffset);\n        }\n        return range;\n    };\n    TextSelection.prototype.getSelectionBounds = function (range, pageNumber) {\n        var startElement = this.getNodeElementFromNode(range.startContainer);\n        var endElement = this.getNodeElementFromNode(range.endContainer);\n        var bounds = null;\n        if (startElement !== endElement) {\n            var newStartRange = document.createRange();\n            // eslint-disable-next-line max-len\n            var startRange = this.createRangeForSelection(range.startContainer, range.endContainer, range.startOffset, range.endOffset, newStartRange);\n            bounds = this.normalizeBounds(startRange.getBoundingClientRect(), pageNumber);\n        }\n        else {\n            bounds = this.normalizeBounds(range.getBoundingClientRect(), pageNumber);\n        }\n        return bounds;\n    };\n    TextSelection.prototype.getSelectionRectangleBounds = function (range, pageNumber) {\n        var selectionBounds = [];\n        var startElement = this.getNodeElementFromNode(range.startContainer);\n        var endElement = this.getNodeElementFromNode(range.endContainer);\n        var bounds = null;\n        if (startElement !== endElement) {\n            var startOffset = 0;\n            var endOffset = 0;\n            var currentId = 0;\n            var anchorPageId = this.pdfViewerBase.textLayer.getPageIndex(range.startContainer);\n            var anchorTextId = this.pdfViewerBase.textLayer.getTextIndex(range.startContainer, anchorPageId);\n            var focusPageId = this.pdfViewerBase.textLayer.getPageIndex(range.endContainer);\n            var focusTextId = this.pdfViewerBase.textLayer.getTextIndex(range.endContainer, focusPageId);\n            var textDivs = this.pdfViewerBase.getElement('_textLayer_' + focusPageId).childNodes;\n            if (pageNumber === anchorPageId) {\n                currentId = anchorTextId;\n            }\n            else {\n                currentId = 0;\n            }\n            for (var j = currentId; j < textDivs.length; j++) {\n                var textElement = textDivs[j];\n                if (j === anchorTextId) {\n                    startOffset = range.startOffset;\n                }\n                else {\n                    startOffset = 0;\n                }\n                if (j === focusTextId) {\n                    endOffset = range.endOffset;\n                }\n                else {\n                    endOffset = textElement.textContent.length;\n                }\n                if (startOffset !== 0 || endOffset !== 0) {\n                    var newRange = document.createRange();\n                    for (var k = 0; k < textElement.childNodes.length; k++) {\n                        var node = textElement.childNodes[k];\n                        newRange.setStart(node, startOffset);\n                        newRange.setEnd(node, endOffset);\n                    }\n                    var boundingRect = this.normalizeBounds(newRange.getBoundingClientRect(), pageNumber);\n                    selectionBounds.push(boundingRect);\n                    newRange.detach();\n                    if (j === focusTextId) {\n                        break;\n                    }\n                }\n            }\n        }\n        else {\n            bounds = this.normalizeBounds(range.getBoundingClientRect(), pageNumber);\n            selectionBounds.push(bounds);\n        }\n        return selectionBounds;\n    };\n    TextSelection.prototype.getTextId = function (elementId) {\n        var index = elementId.lastIndexOf('_');\n        var divId = elementId.substring(index + 1, elementId.length);\n        // eslint-disable-next-line radix\n        return parseInt(divId);\n    };\n    TextSelection.prototype.normalizeBounds = function (bound, pageNumber) {\n        var newBounds = null;\n        var currentPageElement = this.pdfViewerBase.getElement('_pageDiv_' + pageNumber);\n        if (this.pdfViewerBase.isMixedSizeDocument) {\n            var currentTextElement = this.pdfViewerBase.getElement('_textLayer_' + pageNumber);\n            if (currentTextElement) {\n                currentPageElement = currentTextElement;\n            }\n        }\n        var currentPageRect = currentPageElement.getBoundingClientRect();\n        newBounds = {\n            bottom: this.getMagnifiedValue(bound.bottom - currentPageRect.top), height: this.getMagnifiedValue(bound.height),\n            left: this.getMagnifiedValue(bound.left - currentPageRect.left), top: this.getMagnifiedValue(bound.top - currentPageRect.top),\n            right: this.getMagnifiedValue(bound.right - currentPageRect.left), width: this.getMagnifiedValue(bound.width)\n        };\n        return newBounds;\n    };\n    TextSelection.prototype.getMagnifiedValue = function (value) {\n        return value / this.pdfViewerBase.getZoomFactor();\n    };\n    /**\n     * @param pageNumber\n     * @private\n     */\n    TextSelection.prototype.getCurrentSelectionBounds = function (pageNumber) {\n        var bound = null;\n        var ranges = this.selectionRangeArray;\n        for (var i = 0; i < ranges.length; i++) {\n            if (ranges[i] !== null) {\n                if (pageNumber === ranges[i].pageNumber) {\n                    bound = ranges[i].bound;\n                }\n            }\n        }\n        return bound;\n    };\n    TextSelection.prototype.createRangeForSelection = function (start, end, startOffset, endOffset, range) {\n        range.setStart(start, startOffset);\n        range.setEnd(end, endOffset);\n        return range;\n    };\n    TextSelection.prototype.maintainSelectionArray = function () {\n        var _this = this;\n        if (this.selectionRangeArray.length !== 0) {\n            var selection = window.getSelection();\n            var isBackward = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n            // eslint-disable-next-line\n            var anchorPage = isNaN(parseInt(this.getNodeElementFromNode(selection.anchorNode).id.split('_text_')[1])) ? parseInt(selection.anchorNode.id.split('_pageDiv_')[1]) : parseInt(this.getNodeElementFromNode(selection.anchorNode).id.split('_text_')[1]);\n            if (isNaN(anchorPage)) {\n                // eslint-disable-next-line radix\n                anchorPage = parseInt(selection.anchorNode.id.split('_text_')[1]);\n            }\n            // eslint-disable-next-line\n            var focusPage_1 = isNaN(parseInt(this.getNodeElementFromNode(selection.focusNode).id.split('_text_')[1])) ? parseInt(selection.focusNode.id.split('_pageDiv_')[1]) : parseInt(this.getNodeElementFromNode(selection.focusNode).id.split('_text_')[1]);\n            if (isNaN(focusPage_1)) {\n                // eslint-disable-next-line\n                focusPage_1 = isNaN(parseInt(selection.focusNode.id.split('_text_')[1])) ? parseInt(selection.focusNode.id.split('_textLayer_')[1]) : parseInt(selection.focusNode.id.split('_text_')[1]);\n            }\n            var arrayObject = [];\n            if (!isBackward) {\n                arrayObject = this.selectionRangeArray.filter(\n                // eslint-disable-next-line\n                function (obj) {\n                    return (!((_this.selectionStartPage <= obj.pageNumber) && (obj.pageNumber < focusPage_1)));\n                });\n            }\n            else {\n                arrayObject = this.selectionRangeArray.filter(\n                // eslint-disable-next-line\n                function (obj) {\n                    return (!((focusPage_1 < obj.pageNumber) && (obj.pageNumber <= _this.selectionStartPage)));\n                });\n            }\n            if (arrayObject.length > 0) {\n                for (var i = 0; i < arrayObject.length; i++) {\n                    var indexInArray = this.selectionRangeArray.indexOf(arrayObject[i]);\n                    if (indexInArray !== -1) {\n                        this.selectionRangeArray.splice(indexInArray, 1);\n                    }\n                }\n                if (this.selectionRangeArray.length === 1) {\n                    // eslint-disable-next-line max-len\n                    if (this.selectionRangeArray[0].pageNumber === anchorPage || this.selectionRangeArray[0].pageNumber === focusPage_1) {\n                        arrayObject = [];\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TextSelection.prototype.applySpanForSelection = function () {\n        var selection = window.getSelection();\n        // eslint-disable-next-line max-len\n        if (selection.anchorNode === selection.focusNode && selection.anchorOffset === selection.focusOffset && !selection.isCollapsed) {\n            selection.removeAllRanges();\n        }\n        // eslint-disable-next-line max-len\n        if (selection.anchorNode !== null && this.pdfViewerBase.viewerContainer.contains(this.getNodeElementFromNode(selection.anchorNode))) {\n            var isBackWardSelection = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n            var anchorPageId = void 0;\n            var focusPageId = void 0;\n            var anchorOffsetDiv = void 0;\n            var focusOffsetDiv = void 0;\n            var anchorOffset = void 0;\n            var focusOffset = void 0;\n            if (isBackWardSelection) {\n                // eslint-disable-next-line radix\n                anchorPageId = parseInt(this.getNodeElementFromNode(selection.focusNode).id.split('_text_')[1]);\n                // eslint-disable-next-line radix\n                focusPageId = parseInt(this.getNodeElementFromNode(selection.anchorNode).id.split('_text_')[1]);\n                // eslint-disable-next-line radix\n                anchorOffsetDiv = parseInt(this.getNodeElementFromNode(selection.focusNode).id.split('_text_')[1].split('_')[1]);\n                // eslint-disable-next-line radix\n                focusOffsetDiv = parseInt(this.getNodeElementFromNode(selection.anchorNode).id.split('_text_')[1].split('_')[1]);\n                anchorOffset = selection.focusOffset;\n                focusOffset = selection.anchorOffset;\n            }\n            else {\n                var anchorElement = this.getNodeElementFromNode(selection.anchorNode);\n                var focusElement = this.getNodeElementFromNode(selection.focusNode);\n                // eslint-disable-next-line\n                anchorPageId = (anchorElement.id.indexOf('text_') !== -1) ? parseInt(anchorElement.id.split('text_')[1]) : parseInt(anchorElement.id.split('_textLayer_')[1]);\n                // eslint-disable-next-line\n                focusPageId = (focusElement.id.indexOf('text_') !== -1) ? parseInt(focusElement.id.split('text_')[1]) : parseInt(focusElement.id.split('_textLayer_')[1]);\n                var isFocusChanged = false;\n                if (this.isTouchSelection) {\n                    if (selection.focusNode === this.pdfViewerBase.pageContainer) {\n                        var lastChildNode = this.pdfViewerBase.pageContainer.lastChild;\n                        if (lastChildNode.classList.contains('e-pv-touch-select-drop')) {\n                            var lastPageDiv = lastChildNode.previousSibling.previousSibling;\n                            // eslint-disable-next-line radix\n                            focusPageId = parseInt(lastPageDiv.id.split('_pageDiv_')[1]);\n                            focusElement = this.pdfViewerBase.getElement('_textLayer_' + focusPageId).lastChild;\n                            isFocusChanged = true;\n                        }\n                        else if (lastChildNode.classList.contains('e-pv-page-div')) {\n                            var lastPageDiv = lastChildNode;\n                            // eslint-disable-next-line radix\n                            focusPageId = parseInt(lastPageDiv.id.split('_pageDiv_')[1]);\n                            focusElement = this.pdfViewerBase.getElement('_textLayer_' + focusPageId).lastChild;\n                            isFocusChanged = true;\n                        }\n                    }\n                }\n                if (anchorElement.classList.contains('e-pv-maintaincontent')) {\n                    anchorElement = this.getNodeElementFromNode(anchorElement);\n                    // eslint-disable-next-line radix\n                    anchorPageId = parseInt(anchorElement.id.split('text_')[1]);\n                }\n                if (focusElement.classList.contains('e-pv-maintaincontent')) {\n                    focusElement = this.getNodeElementFromNode(focusElement);\n                    // eslint-disable-next-line radix\n                    focusPageId = parseInt(focusElement.id.split('text_')[1]);\n                }\n                if (anchorPageId === focusPageId) {\n                    if (anchorElement.contains(focusElement)) {\n                        anchorElement = focusElement;\n                    }\n                    if (focusElement.contains(anchorElement)) {\n                        focusElement = anchorElement;\n                    }\n                }\n                // eslint-disable-next-line radix\n                anchorOffsetDiv = (anchorElement.id.split('text_')[1]) ? parseInt(anchorElement.id.split('text_')[1].split('_')[1]) : null;\n                // eslint-disable-next-line radix\n                focusOffsetDiv = (focusElement.id.split('text_')[1]) ? parseInt(focusElement.id.split('text_')[1].split('_')[1]) : null;\n                anchorOffsetDiv = isNaN(anchorOffsetDiv) ? focusOffsetDiv : anchorOffsetDiv;\n                focusOffsetDiv = isNaN(focusOffsetDiv) ? anchorOffsetDiv : focusOffsetDiv;\n                anchorOffset = selection.anchorOffset;\n                focusOffset = !isFocusChanged ? selection.focusOffset : focusElement.textContent.length;\n            }\n            if (this.pdfViewerBase.checkIsNormalText()) {\n                selection.removeAllRanges();\n                this.pdfViewerBase.textLayer.clearDivSelection();\n                // eslint-disable-next-line max-len\n                this.pdfViewerBase.textLayer.applySpanForSelection(anchorPageId, focusPageId, anchorOffsetDiv, focusOffsetDiv, anchorOffset, focusOffset);\n            }\n            if (this.pdfViewer.textSearchModule) {\n                this.pdfViewer.textSearchModule.searchAfterSelection();\n            }\n        }\n    };\n    /**\n     * @param event\n     * @param x\n     * @param y\n     * @private\n     */\n    TextSelection.prototype.initiateTouchSelection = function (event, x, y) {\n        if (this.pdfViewerBase.isShapeBasedAnnotationsEnabled()) {\n            if (this.pdfViewer.selectedItems.annotations.length > 0) {\n                this.pdfViewer.clearSelection(this.pdfViewer.selectedItems.annotations[0].pageIndex);\n            }\n        }\n        // eslint-disable-next-line\n        var element = event.target;\n        var belowElements = document.elementsFromPoint(event.touches[0].clientX, event.touches[0].clientY);\n        if (belowElements.length !== 0) {\n            if (belowElements[0].classList.contains('e-pv-hyperlink') && belowElements[1].classList.contains('e-pv-text')) {\n                element = belowElements[1];\n            }\n        }\n        var pageNumber = parseFloat(element.id.split('_')[2]);\n        this.pdfViewer.fireTextSelectionStart(pageNumber + 1);\n        this.selectAWord(element, x, y, true);\n        this.createTouchSelectElement(event);\n        this.maintainSelectionOnZoom(true, false);\n        this.fireTextSelectEnd();\n        this.applySpanForSelection();\n    };\n    // eslint-disable-next-line\n    TextSelection.prototype.selectTextByTouch = function (element, x, y, isForwardSelection, target, isCloserMovement) {\n        var isTextSelected = false;\n        if (element.nodeType === element.TEXT_NODE) {\n            var rangeObject = element.ownerDocument.createRange();\n            var selection = window.getSelection();\n            rangeObject.selectNodeContents(element);\n            var currentPosition = 0;\n            var endPosition = rangeObject.endOffset;\n            while (currentPosition < endPosition) {\n                rangeObject.setStart(element, currentPosition);\n                rangeObject.setEnd(element, currentPosition + 1);\n                var rangeBounds = rangeObject.getBoundingClientRect();\n                if (rangeBounds.left <= x && rangeBounds.right >= x && rangeBounds.top <= y && rangeBounds.bottom >= y) {\n                    if (selection.anchorNode != null) {\n                        if (isForwardSelection) {\n                            rangeObject.setStart(selection.anchorNode, selection.anchorOffset);\n                        }\n                        // eslint-disable-next-line max-len\n                        rangeObject = this.setTouchSelectionStartPosition(selection, rangeObject, isForwardSelection, target, element, currentPosition, isCloserMovement);\n                        if (isForwardSelection) {\n                            selection.extend(element, currentPosition);\n                        }\n                        isTextSelected = true;\n                    }\n                    rangeObject.detach();\n                    return isTextSelected;\n                }\n                currentPosition += 1;\n            }\n        }\n        else {\n            for (var i = 0; i < element.childNodes.length; i++) {\n                var range = element.childNodes[i].ownerDocument.createRange();\n                range.selectNodeContents(element.childNodes[i]);\n                var rangeBounds = range.getBoundingClientRect();\n                if (rangeBounds.left <= x && rangeBounds.right >= x && rangeBounds.top <= y && rangeBounds.bottom >= y) {\n                    range.detach();\n                    return (this.selectTextByTouch(element.childNodes[i], x, y, isForwardSelection, target, isCloserMovement));\n                }\n                else {\n                    range.detach();\n                }\n            }\n        }\n        return isTextSelected;\n    };\n    // eslint-disable-next-line\n    TextSelection.prototype.setTouchSelectionStartPosition = function (selection, range, isForwardSelection, target, element, currentPosition, isCloserMovement) {\n        if (isForwardSelection) {\n            if (target === 'left') {\n                // eslint-disable-next-line\n                var startNode = this.getTouchFocusElement(selection, true);\n                range.setStart(startNode.focusNode, startNode.focusOffset);\n                range.setEnd(element, currentPosition);\n                this.selectionAnchorTouch = { anchorNode: range.endContainer.parentElement.id, anchorOffset: range.endOffset };\n            }\n            else if (target === 'right') {\n                // eslint-disable-next-line\n                var startNode = this.getTouchAnchorElement(selection, false);\n                range.setStart(startNode.anchorNode, startNode.anchorOffset);\n                range.setEnd(element, currentPosition);\n                this.selectionFocusTouch = { focusNode: range.endContainer.parentElement.id, focusOffset: range.endOffset };\n            }\n        }\n        else {\n            if (target === 'left') {\n                if (!isCloserMovement) {\n                    // eslint-disable-next-line\n                    var startNode = this.getTouchFocusElement(selection, false);\n                    range.setStart(element, currentPosition);\n                    // eslint-disable-next-line radix\n                    range.setEnd(startNode.focusNode, startNode.focusOffset);\n                    if (range.toString() === '') {\n                        range.setStart(element, currentPosition);\n                        range.setEnd(selection.focusNode, selection.focusOffset);\n                    }\n                    this.selectionAnchorTouch = { anchorNode: range.startContainer.parentElement.id, anchorOffset: range.startOffset };\n                }\n                else {\n                    range.setStart(element, currentPosition);\n                    range.setEnd(selection.focusNode, selection.focusOffset);\n                    this.selectionAnchorTouch = { anchorNode: range.startContainer.parentElement.id, anchorOffset: range.startOffset };\n                }\n            }\n            else if (target === 'right') {\n                // eslint-disable-next-line\n                var startNode = this.getTouchAnchorElement(selection, true);\n                range.setStart(element, currentPosition);\n                range.setEnd(startNode.anchorNode, startNode.anchorOffset);\n                if (range.toString() === '') {\n                    range.setStart(startNode.anchorNode, startNode.anchorOffset);\n                    range.setEnd(element, currentPosition);\n                }\n                this.selectionFocusTouch = { focusNode: range.startContainer.parentElement.id, focusOffset: range.startOffset };\n            }\n        }\n        selection.removeAllRanges();\n        selection.addRange(range);\n        return range;\n    };\n    TextSelection.prototype.getTouchAnchorElement = function (selection, isCurrentFocus) {\n        var element = document.getElementById(this.selectionAnchorTouch.anchorNode.toString());\n        var startNode = null;\n        var offset = 0;\n        if (element) {\n            startNode = element.childNodes[0];\n            // eslint-disable-next-line radix\n            offset = parseInt(this.selectionAnchorTouch.anchorOffset.toString());\n        }\n        else {\n            if (isCurrentFocus) {\n                startNode = selection.focusNode;\n                offset = selection.focusOffset;\n            }\n            else {\n                startNode = selection.anchorNode;\n                offset = selection.anchorOffset;\n            }\n        }\n        return { anchorNode: startNode, anchorOffset: offset };\n    };\n    TextSelection.prototype.getTouchFocusElement = function (selection, isCurrentAnchor) {\n        var element = document.getElementById(this.selectionFocusTouch.focusNode.toString());\n        var startNode = null;\n        var offset = 0;\n        if (element) {\n            startNode = element.childNodes[0];\n            // eslint-disable-next-line radix\n            offset = parseInt(this.selectionFocusTouch.focusOffset.toString());\n        }\n        else {\n            if (isCurrentAnchor) {\n                startNode = selection.anchorNode;\n                offset = selection.anchorOffset;\n            }\n            else {\n                startNode = selection.focusNode;\n                offset = selection.focusOffset;\n            }\n        }\n        return { focusNode: startNode, focusOffset: offset };\n    };\n    TextSelection.prototype.createTouchSelectElement = function (event) {\n        var topMargin = 10;\n        this.isTouchSelection = true;\n        var selection = window.getSelection();\n        if (selection.type === 'Range') {\n            // eslint-disable-next-line max-len\n            this.dropDivElementLeft = createElement('div', { id: this.pdfViewer.element.id + '_touchSelect_droplet_left', className: 'e-pv-touch-select-drop' });\n            // eslint-disable-next-line max-len\n            this.dropDivElementRight = createElement('div', { id: this.pdfViewer.element.id + '_touchSelect_droplet_right', className: 'e-pv-touch-select-drop' });\n            this.dropElementLeft = createElement('div', { className: 'e-pv-touch-ellipse' });\n            this.dropElementLeft.style.transform = 'rotate(0deg)';\n            this.dropDivElementLeft.appendChild(this.dropElementLeft);\n            this.dropElementRight = createElement('div', { className: 'e-pv-touch-ellipse' });\n            this.dropElementRight.style.transform = 'rotate(-90deg)';\n            this.dropElementRight.style.margin = '0 9px 0 0';\n            this.dropDivElementRight.appendChild(this.dropElementRight);\n            this.pdfViewerBase.pageContainer.appendChild(this.dropDivElementLeft);\n            this.pdfViewerBase.pageContainer.appendChild(this.dropDivElementRight);\n            var range = selection.getRangeAt(0);\n            var rangePosition = range.getBoundingClientRect();\n            var dropElementRect = this.dropDivElementLeft.getBoundingClientRect();\n            // eslint-disable-next-line max-len\n            var pageTopValue = this.pdfViewerBase.pageSize[this.pdfViewerBase.currentPageNumber - 1].top;\n            var viewerLeftPosition = this.pdfViewerBase.viewerContainer.getBoundingClientRect().left;\n            var topClientValue = this.getClientValueTop(rangePosition.top, this.pdfViewerBase.currentPageNumber - 1);\n            // eslint-disable-next-line max-len\n            var topPositionValue = topClientValue + pageTopValue * this.pdfViewerBase.getZoomFactor() + (dropElementRect.height / 2) * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropDivElementLeft.style.top = topPositionValue;\n            this.dropDivElementLeft.style.left = rangePosition.left - (viewerLeftPosition + (dropElementRect.width)) + 'px';\n            this.dropDivElementRight.style.top = topPositionValue;\n            // eslint-disable-next-line max-len\n            this.dropDivElementRight.style.left = rangePosition.left + rangePosition.width - viewerLeftPosition + 'px';\n            var currentPageLeft = this.pdfViewerBase.getElement('_pageDiv_' + (this.pdfViewerBase.currentPageNumber - 1)).getBoundingClientRect().left;\n            var currentRangeLeft = rangePosition.left - currentPageLeft;\n            // eslint-disable-next-line max-len\n            this.topStoreLeft = { pageTop: pageTopValue, topClientValue: this.getMagnifiedValue(topClientValue), pageNumber: this.pdfViewerBase.currentPageNumber - 1, left: this.getMagnifiedValue(currentRangeLeft), isHeightNeeded: true };\n            // eslint-disable-next-line max-len\n            this.topStoreRight = { pageTop: pageTopValue, topClientValue: this.getMagnifiedValue(topClientValue), pageNumber: this.pdfViewerBase.currentPageNumber - 1, left: this.getMagnifiedValue(currentRangeLeft + rangePosition.width), isHeightNeeded: true };\n            this.dropDivElementLeft.addEventListener('touchstart', this.onLeftTouchSelectElementTouchStart);\n            this.dropDivElementLeft.addEventListener('touchmove', this.onLeftTouchSelectElementTouchMove);\n            this.dropDivElementLeft.addEventListener('touchend', this.onLeftTouchSelectElementTouchEnd);\n            this.dropDivElementRight.addEventListener('touchstart', this.onRightTouchSelectElementTouchStart);\n            this.dropDivElementRight.addEventListener('touchmove', this.onRightTouchSelectElementTouchMove);\n            this.dropDivElementRight.addEventListener('touchend', this.onRightTouchSelectElementTouchEnd);\n            // eslint-disable-next-line max-len\n            this.calculateContextMenuPosition((event.touches[0].clientY + this.dropDivElementLeft.clientHeight + topMargin), (parseInt(this.dropDivElementLeft.style.left, 10) - topMargin));\n        }\n    };\n    /**\n     * @param top\n     * @param left\n     * @private\n     */\n    // eslint-disable-next-line\n    TextSelection.prototype.calculateContextMenuPosition = function (top, left) {\n        var _this = this;\n        var topMargin = 10;\n        if (Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n            // eslint-disable-next-line\n            var contextTop = top - this.contextMenuHeight;\n            if (contextTop < this.pdfViewerBase.toolbarHeight) {\n                top = top + this.contextMenuHeight;\n            }\n            else {\n                top = contextTop;\n            }\n            if ((top + this.contextMenuHeight) > window.innerHeight) {\n                top = top - this.contextMenuHeight;\n            }\n        }\n        if (this.pdfViewer.contextMenuSettings.contextMenuAction === 'MouseUp') {\n            left = left - 50;\n        }\n        var proxy = this;\n        setTimeout(function () {\n            var leftValue = 35;\n            var selectedContent = document.getElementsByClassName(\"e-pv-maintaincontent\")[0] ? document.getElementsByClassName(\"e-pv-maintaincontent\")[0].getBoundingClientRect() : null;\n            if (selectedContent) {\n                if ((selectedContent.bottom + proxy.contextMenuHeight + proxy.pdfViewerBase.toolbarHeight) > window.innerHeight) {\n                    top = selectedContent.top - (proxy.contextMenuHeight + proxy.pdfViewerBase.toolbarHeight - topMargin);\n                }\n                else {\n                    top = selectedContent.bottom + proxy.pdfViewerBase.toolbarHeight - topMargin;\n                }\n                left = selectedContent.left - leftValue;\n                var toolbarModule = _this.pdfViewer.toolbarModule ? _this.pdfViewer.toolbarModule.annotationToolbarModule : 'null';\n                if (!toolbarModule || !toolbarModule.textMarkupToolbarElement || toolbarModule.textMarkupToolbarElement.children.length === 0) {\n                    // eslint-disable-next-line max-len\n                    proxy.pdfViewerBase.contextMenuModule.open(top, left, proxy.pdfViewerBase.viewerContainer);\n                }\n            }\n        });\n    };\n    /**\n     * @private\n     */\n    TextSelection.prototype.initiateSelectionByTouch = function () {\n        this.pdfViewerBase.textLayer.clearDivSelection();\n        this.pdfViewerBase.contextMenuModule.close();\n        var lowerPageIndex = this.pdfViewerBase.currentPageNumber - 3;\n        lowerPageIndex = (lowerPageIndex < 0) ? 0 : lowerPageIndex;\n        var higherPageIndex = this.pdfViewer.currentPageNumber + 1;\n        // eslint-disable-next-line max-len\n        higherPageIndex = (higherPageIndex < (this.pdfViewerBase.pageCount - 1)) ? higherPageIndex : (this.pdfViewerBase.pageCount - 1);\n        for (var i = lowerPageIndex; i <= higherPageIndex; i++) {\n            var textLayer = this.pdfViewerBase.getElement('_textLayer_' + i);\n            if (textLayer) {\n                if (textLayer.childNodes !== null) {\n                    this.applySelectionMouseScroll(i);\n                }\n            }\n        }\n        if (this.selectionRangeArray.length > 0) {\n            this.pdfViewer.fireTextSelectionStart(this.selectionRangeArray[0].pageNumber + 1);\n        }\n    };\n    // eslint-disable-next-line\n    TextSelection.prototype.terminateSelectionByTouch = function (event) {\n        var topMargin = 10;\n        this.maintainSelectionOnZoom(true, false);\n        this.applySpanForSelection();\n        if (this.pdfViewerBase.getTextMarkupAnnotationMode()) {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.annotationModule.textMarkupAnnotationModule.drawTextMarkupAnnotations(this.pdfViewer.annotationModule.textMarkupAnnotationModule.currentTextMarkupAddMode);\n        }\n        else {\n            this.fireTextSelectEnd();\n            var top_4 = event.changedTouches[0].clientY + event.currentTarget.clientHeight;\n            var spanBounds = this.getSpanBounds();\n            if ((spanBounds.bottom + this.contextMenuHeight + this.pdfViewerBase.toolbarHeight) > window.innerHeight) {\n                top_4 = spanBounds.top - (this.contextMenuHeight + this.pdfViewerBase.toolbarHeight);\n            }\n            else {\n                top_4 = spanBounds.bottom + this.pdfViewerBase.toolbarHeight - topMargin;\n            }\n            this.pdfViewerBase.contextMenuModule.open(top_4, (spanBounds.right - spanBounds.left) / 2, this.pdfViewerBase.viewerContainer);\n        }\n    };\n    TextSelection.prototype.getSpanBounds = function () {\n        var spanWidth = [];\n        var spanRight = [];\n        var spanLeft = [];\n        var spanHeight = 0;\n        var selectedContent = document.getElementsByClassName(\"e-pv-maintaincontent\");\n        if (selectedContent.length > 0) {\n            for (var i = 0; i < selectedContent.length; i++) {\n                var spanElement = selectedContent[i].getBoundingClientRect();\n                spanHeight = spanHeight + spanElement.height;\n                spanWidth.push(spanElement.width);\n                spanRight.push(spanElement.right);\n                spanLeft.push(spanElement.left);\n            }\n            // eslint-disable-next-line max-len\n            return { top: selectedContent[0].getBoundingClientRect().top, bottom: selectedContent[selectedContent.length - 1].getBoundingClientRect().bottom, left: Math.min.apply(null, spanLeft), right: Math.max.apply(null, spanRight), width: Math.max.apply(null, spanWidth), height: spanHeight };\n        }\n    };\n    TextSelection.prototype.getNodeElement = function (range, touchX, touchY, event, nodeElement) {\n        if (document.caretRangeFromPoint) {\n            range = document.caretRangeFromPoint(touchX, touchY);\n            nodeElement = this.onTouchElementScroll(range, nodeElement, touchY, event);\n            // eslint-disable-next-line\n        }\n        else if (document.caretPositionFromPoint) {\n            // eslint-disable-next-line\n            var start = document.caretPositionFromPoint(touchX, touchY);\n            // eslint-disable-next-line\n            var end = document.caretPositionFromPoint(touchX, touchY);\n            range = document.createRange();\n            range.setStart(start.offsetNode, start.offset);\n            range.setEnd(end.offsetNode, end.offset);\n            nodeElement = this.onTouchElementScroll(range, nodeElement, touchY, event);\n        }\n        return nodeElement;\n    };\n    TextSelection.prototype.isTouchedWithinContainer = function (event) {\n        var elements = document.elementsFromPoint(event.touches[0].clientX, event.touches[0].clientY);\n        var isTouchedWithinContainer = false;\n        if (elements.length !== 0) {\n            isTouchedWithinContainer = true;\n        }\n        return isTouchedWithinContainer;\n    };\n    TextSelection.prototype.onTouchElementScroll = function (range, nodeElement, touchY, event) {\n        var viewerScrollTop = this.pdfViewerBase.viewerContainer.scrollTop;\n        if (range != null) {\n            nodeElement = range.startContainer;\n            var isScrollBar = this.isScrolledOnScrollBar(event);\n            if (!this.pdfViewerBase.viewerContainer.contains(nodeElement.parentElement) || isScrollBar) {\n                if (touchY < this.pdfViewerBase.viewerContainer.clientHeight) {\n                    this.pdfViewerBase.viewerContainer.scrollTop = viewerScrollTop - 30;\n                }\n                else {\n                    this.pdfViewerBase.viewerContainer.scrollTop = viewerScrollTop + 30;\n                }\n            }\n        }\n        else {\n            if (touchY < this.pdfViewerBase.viewerContainer.clientHeight) {\n                this.pdfViewerBase.viewerContainer.scrollTop = viewerScrollTop - 30;\n            }\n            else {\n                this.pdfViewerBase.viewerContainer.scrollTop = viewerScrollTop + 30;\n            }\n        }\n        return nodeElement;\n    };\n    TextSelection.prototype.isCloserTouchScroll = function (currentDifference) {\n        var isForwardMovement = false;\n        if (this.previousScrollDifference > currentDifference) {\n            isForwardMovement = true;\n        }\n        return isForwardMovement;\n    };\n    TextSelection.prototype.getClientValueTop = function (clientValue, pageNumber) {\n        if (this.pdfViewerBase.getElement('_pageDiv_' + pageNumber)) {\n            // eslint-disable-next-line max-len\n            return clientValue - this.pdfViewerBase.getElement('_pageDiv_' + pageNumber).getBoundingClientRect().top;\n        }\n        else {\n            return clientValue;\n        }\n    };\n    TextSelection.prototype.isScrolledOnScrollBar = function (event) {\n        var isScrollBar = false;\n        // eslint-disable-next-line max-len\n        if (event.touches && (this.pdfViewerBase.viewerContainer.clientHeight + this.pdfViewerBase.viewerContainer.offsetTop) < event.touches[0].clientY && event.touches[0].clientY < (this.pdfViewerBase.viewerContainer.offsetHeight + this.pdfViewerBase.viewerContainer.offsetTop)) {\n            isScrollBar = true;\n        }\n        return isScrollBar;\n    };\n    TextSelection.prototype.getTextLastLength = function (element) {\n        if (element) {\n            return element.textContent.length;\n        }\n        else {\n            return 0;\n        }\n    };\n    TextSelection.prototype.getNodeElementFromNode = function (node) {\n        if (node.parentElement) {\n            return node.parentElement;\n        }\n        else {\n            return node.parentNode;\n        }\n    };\n    /**\n     * Copy the selected text in the PDF Document.\n     *\n     * @returns void\n     */\n    TextSelection.prototype.copyText = function () {\n        var selectionText = '';\n        this.maintainSelectionOnZoom(true, false);\n        if (this.selectionRangeArray.length > 0) {\n            for (var i = 0; i < this.selectionRangeArray.length; i++) {\n                selectionText += this.selectionRangeArray[i].textContent;\n            }\n        }\n        if (selectionText.length > 0) {\n            if (this.pdfViewer.annotation) {\n                this.pdfViewer.annotation.isShapeCopied = false;\n            }\n            var textArea = document.createElement('textarea');\n            textArea.contentEditable = 'true';\n            textArea.textContent = selectionText;\n            // eslint-disable-next-line max-len\n            if (this.pdfViewer.annotation && this.pdfViewer.annotation.freeTextAnnotationModule) {\n                this.pdfViewer.annotation.freeTextAnnotationModule.selectedText = selectionText;\n            }\n            textArea.style.position = 'fixed';\n            document.body.appendChild(textArea);\n            textArea.select();\n            try {\n                document.execCommand('copy');\n            }\n            catch (ex) {\n                console.warn('Copy to clipboard failed.', ex);\n            }\n            finally {\n                if (textArea) {\n                    document.body.removeChild(textArea);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TextSelection.prototype.destroy = function () {\n        this.clear();\n    };\n    /**\n     * @private\n     */\n    TextSelection.prototype.getModuleName = function () {\n        return 'TextSelection';\n    };\n    return TextSelection;\n}());\nexport { TextSelection };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}