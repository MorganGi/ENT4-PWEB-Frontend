{"ast":null,"code":"import { addClass, Browser, EventHandler, detach, removeClass, select, selectAll, KeyboardEvents } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined as isNOU, closest, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { setStyleAttribute, extend } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport * as classes from '../base/classes';\nimport { RenderType, ToolbarType } from '../base/enum';\nimport { setToolbarStatus, updateUndoRedoStatus, getTBarItemsIndex, getCollection, toObjectLowerCase, isIDevice } from '../base/util';\nimport { updateDropDownFontFormatLocale } from '../base/util';\nimport * as model from '../models/items';\nimport { ToolbarRenderer } from '../renderer/toolbar-renderer';\nimport { BaseToolbar } from './base-toolbar';\nimport { DropDownButtons } from './dropdown-buttons';\nimport { ToolbarAction } from './toolbar-action';\n/**\n * `Toolbar` module is used to handle Toolbar actions.\n */\n\nvar Toolbar =\n/** @class */\nfunction () {\n  function Toolbar(parent, serviceLocator) {\n    this.parent = parent;\n    this.isToolbar = false;\n    this.locator = serviceLocator;\n    this.isTransformChild = false;\n    this.renderFactory = this.locator.getService('rendererFactory');\n    model.updateDropDownLocale(this.parent);\n    updateDropDownFontFormatLocale(this.parent);\n    this.renderFactory.addRenderer(RenderType.Toolbar, new ToolbarRenderer(this.parent));\n    this.toolbarRenderer = this.renderFactory.getRenderer(RenderType.Toolbar);\n    this.baseToolbar = new BaseToolbar(this.parent, this.locator);\n    this.addEventListener();\n\n    if (this.parent.toolbarSettings && Object.keys(this.parent.toolbarSettings.itemConfigs).length > 0) {\n      extend(this.tools, model.tools, toObjectLowerCase(this.parent.toolbarSettings.itemConfigs), true);\n    } else {\n      this.tools = model.tools;\n    }\n  }\n\n  Toolbar.prototype.initializeInstance = function () {\n    this.contentRenderer = this.renderFactory.getRenderer(RenderType.Content);\n    this.editableElement = this.contentRenderer.getEditPanel();\n    this.editPanel = this.contentRenderer.getPanel();\n  };\n\n  Toolbar.prototype.toolbarBindEvent = function () {\n    if (!this.parent.inlineMode.enable) {\n      this.keyBoardModule = new KeyboardEvents(this.getToolbarElement(), {\n        keyAction: this.toolBarKeyDown.bind(this),\n        keyConfigs: this.parent.formatter.keyConfig,\n        eventName: 'keydown'\n      });\n    }\n  };\n\n  Toolbar.prototype.toolBarKeyDown = function (e) {\n    switch (e.action) {\n      case 'escape':\n        this.parent.contentModule.getEditPanel().focus();\n        break;\n    }\n  };\n\n  Toolbar.prototype.createToolbarElement = function () {\n    this.tbElement = this.parent.createElement('div', {\n      id: this.parent.getID() + '_toolbar'\n    });\n\n    if (!Browser.isDevice && this.parent.inlineMode.enable && isIDevice()) {\n      return;\n    } else {\n      if (this.parent.toolbarSettings.enableFloating && !this.parent.inlineMode.enable) {\n        this.tbWrapper = this.parent.createElement('div', {\n          id: this.parent.getID() + '_toolbar_wrapper',\n          innerHTML: this.tbElement.outerHTML,\n          className: classes.CLS_TB_WRAP\n        });\n        this.tbElement = this.tbWrapper.firstElementChild;\n        this.parent.element.insertBefore(this.tbWrapper, this.editPanel);\n      } else {\n        this.parent.element.insertBefore(this.tbElement, this.editPanel);\n      }\n    }\n  };\n\n  Toolbar.prototype.getToolbarMode = function () {\n    var tbMode;\n\n    switch (this.parent.toolbarSettings.type) {\n      case ToolbarType.Expand:\n        tbMode = 'Extended';\n        break;\n\n      case ToolbarType.Scrollable:\n        tbMode = 'Scrollable';\n        break;\n\n      default:\n        tbMode = 'MultiRow';\n    }\n\n    if (isIDevice() && this.parent.toolbarSettings.type === ToolbarType.Expand) {\n      tbMode = ToolbarType.Scrollable;\n    }\n\n    return tbMode;\n  };\n\n  Toolbar.prototype.checkToolbarResponsive = function (ele) {\n    if (!Browser.isDevice || isIDevice()) {\n      return false;\n    }\n\n    var tBarMode;\n\n    if (this.parent.toolbarSettings.type === ToolbarType.Expand) {\n      tBarMode = ToolbarType.MultiRow;\n    } else {\n      tBarMode = this.parent.toolbarSettings.type;\n    }\n\n    this.baseToolbar.render({\n      container: this.parent.inlineMode.enable ? 'quick' : 'toolbar',\n      items: this.parent.toolbarSettings.items,\n      mode: tBarMode,\n      target: ele,\n      cssClass: this.parent.cssClass\n    });\n\n    if (this.parent.toolbarSettings.type === ToolbarType.Expand) {\n      addClass([ele], ['e-rte-tb-mobile']);\n\n      if (this.parent.inlineMode.enable) {\n        this.addFixedTBarClass();\n      } else {\n        addClass([ele], [classes.CLS_TB_STATIC]);\n      }\n    }\n\n    this.wireEvents();\n    this.dropDownModule.renderDropDowns({\n      container: ele,\n      containerType: this.parent.inlineMode.enable ? 'quick' : 'toolbar',\n      items: this.parent.toolbarSettings.items\n    });\n    this.parent.notify(events.renderColorPicker, {\n      container: this.tbElement,\n      containerType: this.parent.inlineMode.enable ? 'quick' : 'toolbar',\n      items: this.parent.toolbarSettings.items\n    });\n    return true;\n  };\n\n  Toolbar.prototype.checkIsTransformChild = function () {\n    this.isTransformChild = false;\n    var transformElements = selectAll('[style*=\"transform\"]', document);\n\n    for (var i = 0; i < transformElements.length; i++) {\n      if (!isNullOrUndefined(transformElements[i].contains) && transformElements[i].contains(this.parent.element)) {\n        this.isTransformChild = true;\n        break;\n      }\n    }\n  };\n\n  Toolbar.prototype.toggleFloatClass = function (e) {\n    var topValue;\n    var isBody = false;\n    var isFloat = false;\n    var scrollParent;\n    var floatOffset = this.parent.floatingToolbarOffset;\n\n    if (e && this.parent.iframeSettings.enable && this.parent.inputElement.ownerDocument === e.target) {\n      scrollParent = e.target.body;\n    } else if (e && e.target !== document) {\n      scrollParent = e.target;\n    } else {\n      isBody = true;\n      scrollParent = document.body;\n    }\n\n    var tbHeight = this.getToolbarHeight() + this.getExpandTBarPopHeight();\n\n    if (this.isTransformChild) {\n      topValue = 0;\n      var scrollParentRelativeTop = 0;\n      var trgHeight = this.parent.element.offsetHeight;\n\n      if (isBody) {\n        var bodyStyle = window.getComputedStyle(scrollParent);\n        scrollParentRelativeTop = parseFloat(bodyStyle.marginTop.split('px')[0]) + parseFloat(bodyStyle.paddingTop.split('px')[0]);\n      }\n\n      var targetTop = this.parent.element.getBoundingClientRect().top;\n      var scrollParentYOffset = Browser.isMSPointer && isBody ? window.pageYOffset : scrollParent.parentElement.scrollTop;\n      var scrollParentRect = scrollParent.getBoundingClientRect();\n      var scrollParentTop = !isBody ? scrollParentRect.top : scrollParentRect.top + scrollParentYOffset;\n      var outOfRange = targetTop - (!isBody ? scrollParentTop : 0) + trgHeight > tbHeight + floatOffset ? false : true;\n\n      if (targetTop > scrollParentTop + floatOffset || targetTop < -trgHeight || (targetTop < 0 ? outOfRange : false)) {\n        isFloat = false;\n        removeClass([this.tbElement], [classes.CLS_TB_ABS_FLOAT]);\n      } else if (targetTop < scrollParentTop + floatOffset) {\n        if (targetTop < 0) {\n          topValue = -targetTop + scrollParentTop;\n        } else {\n          topValue = scrollParentTop - targetTop;\n        }\n\n        topValue = isBody ? topValue - scrollParentRelativeTop : topValue;\n        addClass([this.tbElement], [classes.CLS_TB_ABS_FLOAT]);\n        isFloat = true;\n      }\n    } else {\n      var parent_1 = this.parent.element.getBoundingClientRect();\n\n      if (window.innerHeight < parent_1.top) {\n        return;\n      }\n\n      topValue = e && e.target !== document ? scrollParent.getBoundingClientRect().top : 0;\n\n      if (parent_1.bottom < floatOffset + tbHeight + topValue || parent_1.bottom < 0 || parent_1.top > floatOffset + topValue) {\n        isFloat = false;\n      } else if (parent_1.top < floatOffset || parent_1.top < floatOffset + topValue) {\n        isFloat = true;\n      }\n    }\n\n    if (!isFloat) {\n      removeClass([this.tbElement], [classes.CLS_TB_FLOAT]);\n      setStyleAttribute(this.tbElement, {\n        top: 0 + 'px',\n        width: '100%'\n      });\n    } else {\n      addClass([this.tbElement], [classes.CLS_TB_FLOAT]);\n      setStyleAttribute(this.tbElement, {\n        width: this.parent.element.offsetWidth + 'px',\n        top: floatOffset + topValue + 'px'\n      });\n    }\n  };\n\n  Toolbar.prototype.renderToolbar = function () {\n    this.initializeInstance();\n    this.createToolbarElement();\n\n    if (this.checkToolbarResponsive(this.tbElement)) {\n      return;\n    }\n\n    if (this.parent.inlineMode.enable) {\n      this.parent.notify(events.renderInlineToolbar, {});\n    } else {\n      this.baseToolbar.render({\n        container: 'toolbar',\n        items: this.parent.toolbarSettings.items,\n        mode: this.getToolbarMode(),\n        target: this.tbElement,\n        cssClass: this.parent.cssClass\n      });\n\n      if (!this.parent.inlineMode.enable) {\n        if (this.parent.toolbarSettings.enableFloating) {\n          this.checkIsTransformChild();\n          this.toggleFloatClass();\n        }\n\n        addClass([this.parent.element], [classes.CLS_RTE_TB_ENABLED]);\n\n        if (this.parent.toolbarSettings.type === ToolbarType.Expand) {\n          addClass([this.parent.element], [classes.CLS_RTE_EXPAND_TB]);\n        }\n      }\n    }\n\n    this.wireEvents();\n\n    if (this.parent.inlineMode.enable && !isIDevice()) {\n      this.addFixedTBarClass();\n    }\n\n    if (!this.parent.inlineMode.enable) {\n      this.dropDownModule.renderDropDowns({\n        container: this.tbElement,\n        containerType: 'toolbar',\n        items: this.parent.toolbarSettings.items\n      });\n      this.parent.notify(events.renderColorPicker, {\n        container: this.tbElement,\n        containerType: 'toolbar',\n        items: this.parent.toolbarSettings.items\n      });\n      this.refreshToolbarOverflow();\n    }\n\n    var divEle = this.parent.element.querySelector('.e-rte-srctextarea');\n    var iframeEle = this.parent.element.querySelector('.e-source-content');\n\n    if (!this.parent.iframeSettings.enable && !isNOU(divEle) && divEle.style.display === 'block' || this.parent.iframeSettings.enable && !isNOU(iframeEle) && iframeEle.style.display === 'block') {\n      this.parent.notify(events.updateToolbarItem, {\n        targetItem: 'SourceCode',\n        updateItem: 'Preview',\n        baseToolbar: this.parent.getBaseToolbarObject()\n      });\n      this.parent.disableToolbarItem(this.parent.toolbarSettings.items);\n    }\n  };\n  /**\n   * addFixedTBarClass method\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  Toolbar.prototype.addFixedTBarClass = function () {\n    addClass([this.tbElement], [classes.CLS_TB_FIXED]);\n  };\n  /**\n   * removeFixedTBarClass method\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  Toolbar.prototype.removeFixedTBarClass = function () {\n    removeClass([this.tbElement], [classes.CLS_TB_FIXED]);\n  };\n\n  Toolbar.prototype.showFixedTBar = function () {\n    addClass([this.tbElement], [classes.CLS_SHOW]);\n\n    if (Browser.isIos) {\n      addClass([this.tbElement], [classes.CLS_TB_IOS_FIX]);\n    }\n  };\n\n  Toolbar.prototype.hideFixedTBar = function () {\n    // eslint-disable-next-line\n    !this.isToolbar ? removeClass([this.tbElement], [classes.CLS_SHOW, classes.CLS_TB_IOS_FIX]) : this.isToolbar = false;\n  };\n  /**\n   * updateItem method\n   *\n   * @param {IUpdateItemsModel} args - specifies the arguments.\n   * @returns {void}\n   * @hidden\n    */\n\n\n  Toolbar.prototype.updateItem = function (args) {\n    var item = this.tools[args.updateItem.toLocaleLowerCase()];\n    var trgItem = this.tools[args.targetItem.toLocaleLowerCase()];\n    var index = getTBarItemsIndex(getCollection(trgItem.subCommand), args.baseToolbar.toolbarObj.items)[0];\n\n    if (!isNOU(index)) {\n      var prefixId = this.parent.inlineMode.enable ? '_quick_' : '_toolbar_';\n      args.baseToolbar.toolbarObj.items[index].id = this.parent.getID() + prefixId + item.id;\n      args.baseToolbar.toolbarObj.items[index].prefixIcon = item.icon;\n      args.baseToolbar.toolbarObj.items[index].tooltipText = item.tooltip;\n      args.baseToolbar.toolbarObj.items[index].subCommand = item.subCommand;\n      args.baseToolbar.toolbarObj.dataBind();\n    } else {\n      this.addTBarItem(args, 0);\n    }\n  };\n\n  Toolbar.prototype.updateToolbarStatus = function (args) {\n    if (!this.tbElement || this.parent.inlineMode.enable && (isIDevice() || !Browser.isDevice)) {\n      return;\n    }\n\n    var options = {\n      args: args,\n      dropDownModule: this.dropDownModule,\n      parent: this.parent,\n      tbElements: selectAll('.' + classes.CLS_TB_ITEM, this.tbElement),\n      tbItems: this.baseToolbar.toolbarObj.items\n    };\n    setToolbarStatus(options, this.parent.inlineMode.enable ? true : false, this.parent);\n  };\n\n  Toolbar.prototype.fullScreen = function (e) {\n    this.parent.fullScreenModule.showFullScreen(e);\n  };\n\n  Toolbar.prototype.hideScreen = function (e) {\n    this.parent.fullScreenModule.hideFullScreen(e);\n  };\n  /**\n   * getBaseToolbar method\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  Toolbar.prototype.getBaseToolbar = function () {\n    return this.baseToolbar;\n  };\n  /**\n   * addTBarItem method\n   *\n   * @param {IUpdateItemsModel} args - specifies the arguments.\n   * @param {number} index - specifies the index value.\n   * @returns {void}\n   * @hidden\n    */\n\n\n  Toolbar.prototype.addTBarItem = function (args, index) {\n    args.baseToolbar.toolbarObj.addItems([args.baseToolbar.getObject(args.updateItem, 'toolbar')], index);\n  };\n  /**\n   * enableTBarItems method\n   *\n   * @param {BaseToolbar} baseToolbar - specifies the toolbar.\n   * @param {string} items - specifies the string value.\n   * @param {boolean} isEnable - specifies the boolean value.\n   * @param {boolean} muteToolbarUpdate - specifies the toolbar.\n   * @returns {void}\n   * @hidden\n    */\n\n\n  Toolbar.prototype.enableTBarItems = function (baseToolbar, items, isEnable, muteToolbarUpdate) {\n    var trgItems = getTBarItemsIndex(getCollection(items), baseToolbar.toolbarObj.items);\n    this.tbItems = selectAll('.' + classes.CLS_TB_ITEM, baseToolbar.toolbarObj.element);\n\n    for (var i = 0; i < trgItems.length; i++) {\n      var item = this.tbItems[trgItems[i]];\n\n      if (item) {\n        baseToolbar.toolbarObj.enableItems(item, isEnable);\n      }\n    }\n\n    if (!select('.e-rte-srctextarea', this.parent.element) && !muteToolbarUpdate) {\n      updateUndoRedoStatus(baseToolbar, this.parent.formatter.editorManager.undoRedoManager.getUndoStatus());\n    }\n  };\n  /**\n   * removeTBarItems method\n   *\n   * @param {string} items - specifies the string value.\n   * @returns {void}\n   * @hidden\n    */\n\n\n  Toolbar.prototype.removeTBarItems = function (items) {\n    if (isNullOrUndefined(this.baseToolbar.toolbarObj)) {\n      this.baseToolbar = this.parent.getBaseToolbarObject();\n    }\n\n    var trgItems = getTBarItemsIndex(getCollection(items), this.baseToolbar.toolbarObj.items);\n    this.tbItems = this.parent.inlineMode.enable ? selectAll('.' + classes.CLS_TB_ITEM, this.baseToolbar.toolbarObj.element) : selectAll('.' + classes.CLS_TB_ITEM, this.parent.element);\n\n    for (var i = 0; i < trgItems.length; i++) {\n      this.baseToolbar.toolbarObj.removeItems(this.tbItems[trgItems[i]]);\n    }\n  };\n  /**\n   * getExpandTBarPopHeight method\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  Toolbar.prototype.getExpandTBarPopHeight = function () {\n    var popHeight = 0;\n\n    if (this.parent.toolbarSettings.type === ToolbarType.Expand && this.tbElement.classList.contains('e-extended-toolbar')) {\n      var expandPopup = select('.e-toolbar-extended', this.tbElement);\n\n      if (expandPopup && this.tbElement.classList.contains('e-expand-open') || expandPopup && expandPopup.classList.contains('e-popup-open')) {\n        addClass([expandPopup], [classes.CLS_VISIBLE]);\n        popHeight = popHeight + expandPopup.offsetHeight;\n        removeClass([expandPopup], [classes.CLS_VISIBLE]);\n      } else {\n        removeClass([this.tbElement], [classes.CLS_EXPAND_OPEN]);\n      }\n    }\n\n    return popHeight;\n  };\n  /**\n   * getToolbarHeight method\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  Toolbar.prototype.getToolbarHeight = function () {\n    return this.tbElement.offsetHeight;\n  };\n  /**\n   * getToolbarElement method\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  Toolbar.prototype.getToolbarElement = function () {\n    return select('.' + classes.CLS_TOOLBAR, this.parent.element);\n  };\n  /**\n   * refreshToolbarOverflow method\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  Toolbar.prototype.refreshToolbarOverflow = function () {\n    this.baseToolbar.toolbarObj.refreshOverflow();\n  };\n\n  Toolbar.prototype.isToolbarDestroyed = function () {\n    return this.baseToolbar.toolbarObj && !this.baseToolbar.toolbarObj.isDestroyed;\n  };\n\n  Toolbar.prototype.destroyToolbar = function () {\n    if (this.isToolbarDestroyed()) {\n      this.parent.unWireScrollElementsEvents();\n      this.unWireEvents();\n      this.parent.notify(events.destroyColorPicker, {});\n      this.dropDownModule.destroyDropDowns();\n      this.baseToolbar.toolbarObj.destroy();\n      this.removeEventListener();\n      removeClass([this.parent.element], [classes.CLS_RTE_TB_ENABLED]);\n      removeClass([this.parent.element], [classes.CLS_RTE_EXPAND_TB]);\n      var tbWrapper = select('.' + classes.CLS_TB_WRAP, this.parent.element);\n      var tbElement = select('.' + classes.CLS_TOOLBAR, this.parent.element);\n\n      if (!isNullOrUndefined(tbWrapper)) {\n        detach(tbWrapper);\n      } else if (!isNullOrUndefined(tbElement)) {\n        detach(tbElement);\n      }\n    }\n  };\n  /**\n   * Destroys the ToolBar.\n   *\n   * @function destroy\n   * @returns {void}\n   * @hidden\n    */\n\n\n  Toolbar.prototype.destroy = function () {\n    if (this.isToolbarDestroyed()) {\n      this.destroyToolbar();\n\n      if (this.keyBoardModule) {\n        this.keyBoardModule.destroy();\n      }\n    }\n  };\n\n  Toolbar.prototype.scrollHandler = function (e) {\n    if (!this.parent.inlineMode.enable) {\n      if (this.parent.toolbarSettings.enableFloating && this.getDOMVisibility(this.tbElement)) {\n        this.toggleFloatClass(e.args);\n      }\n    }\n  };\n\n  Toolbar.prototype.getDOMVisibility = function (el) {\n    if (!el.offsetParent && el.offsetWidth === 0 && el.offsetHeight === 0) {\n      return false;\n    }\n\n    return true;\n  };\n\n  Toolbar.prototype.mouseDownHandler = function () {\n    if (Browser.isDevice && this.parent.inlineMode.enable && !isIDevice()) {\n      this.showFixedTBar();\n    }\n  };\n\n  Toolbar.prototype.focusChangeHandler = function () {\n    if (Browser.isDevice && this.parent.inlineMode.enable && !isIDevice()) {\n      this.isToolbar = false;\n      this.hideFixedTBar();\n    }\n  };\n\n  Toolbar.prototype.dropDownBeforeOpenHandler = function () {\n    this.isToolbar = true;\n  }; // eslint-disable-next-line\n\n\n  Toolbar.prototype.tbFocusHandler = function (e) {\n    var activeElm = document.activeElement;\n    var isToolbaractive = closest(activeElm, '.e-rte-toolbar');\n\n    if (activeElm === this.parent.getToolbarElement() || isToolbaractive === this.parent.getToolbarElement()) {\n      var toolbarItem = this.parent.getToolbarElement().querySelectorAll('.e-expended-nav');\n\n      for (var i = 0; i < toolbarItem.length; i++) {\n        if (isNOU(this.parent.getToolbarElement().querySelector('.e-insert-table-btn'))) {\n          toolbarItem[i].setAttribute('tabindex', '0');\n        } else {\n          toolbarItem[i].setAttribute('tabindex', '1');\n        }\n      }\n    }\n  };\n\n  Toolbar.prototype.tbKeydownHandler = function (e) {\n    if (e.target.classList.contains('e-dropdown-btn') || e.target.getAttribute('id') === this.parent.getID() + '_toolbar_CreateTable') {\n      e.target.setAttribute('tabindex', '0');\n    }\n  };\n\n  Toolbar.prototype.toolbarClickHandler = function (e) {\n    var trg = closest(e.originalEvent.target, '.e-hor-nav');\n\n    if (trg && this.parent.toolbarSettings.type === ToolbarType.Expand && !isNOU(trg)) {\n      if (!trg.classList.contains('e-nav-active')) {\n        removeClass([this.tbElement], [classes.CLS_EXPAND_OPEN]);\n        this.parent.setContentHeight('toolbar', false);\n      } else {\n        addClass([this.tbElement], [classes.CLS_EXPAND_OPEN]);\n        this.parent.setContentHeight('toolbar', true);\n      }\n    } else if (Browser.isDevice || this.parent.inlineMode.enable) {\n      this.isToolbar = true;\n    }\n\n    if (isNOU(trg) && this.parent.toolbarSettings.type === ToolbarType.Expand) {\n      removeClass([this.tbElement], [classes.CLS_EXPAND_OPEN]);\n    }\n  };\n\n  Toolbar.prototype.wireEvents = function () {\n    if (this.parent.inlineMode.enable && isIDevice()) {\n      return;\n    }\n\n    EventHandler.add(this.tbElement, 'focusin', this.tbFocusHandler, this);\n    EventHandler.add(this.tbElement, 'keydown', this.tbKeydownHandler, this);\n  };\n\n  Toolbar.prototype.unWireEvents = function () {\n    EventHandler.remove(this.tbElement, 'focusin', this.tbFocusHandler);\n    EventHandler.remove(this.tbElement, 'keydown', this.tbKeydownHandler);\n  };\n\n  Toolbar.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.dropDownModule = new DropDownButtons(this.parent, this.locator);\n    this.toolbarActionModule = new ToolbarAction(this.parent);\n    this.parent.on(events.initialEnd, this.renderToolbar, this);\n    this.parent.on(events.scroll, this.scrollHandler, this);\n    this.parent.on(events.bindOnEnd, this.toolbarBindEvent, this);\n    this.parent.on(events.toolbarUpdated, this.updateToolbarStatus, this);\n    this.parent.on(events.modelChanged, this.onPropertyChanged, this);\n    this.parent.on(events.refreshBegin, this.onRefresh, this);\n    this.parent.on(events.destroy, this.destroy, this);\n    this.parent.on(events.enableFullScreen, this.fullScreen, this);\n    this.parent.on(events.disableFullScreen, this.hideScreen, this);\n    this.parent.on(events.updateToolbarItem, this.updateItem, this);\n    this.parent.on(events.beforeDropDownOpen, this.dropDownBeforeOpenHandler, this);\n    this.parent.on(events.expandPopupClick, this.parent.setContentHeight, this.parent);\n    this.parent.on(events.focusChange, this.focusChangeHandler, this);\n    this.parent.on(events.mouseDown, this.mouseDownHandler, this);\n    this.parent.on(events.sourceCodeMouseDown, this.mouseDownHandler, this);\n    this.parent.on(events.bindCssClass, this.setCssClass, this);\n\n    if (!this.parent.inlineMode.enable && !isIDevice()) {\n      this.parent.on(events.toolbarClick, this.toolbarClickHandler, this);\n    }\n  };\n\n  Toolbar.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off(events.initialEnd, this.renderToolbar);\n    this.parent.off(events.scroll, this.scrollHandler);\n    this.parent.off(events.bindOnEnd, this.toolbarBindEvent);\n    this.parent.off(events.toolbarUpdated, this.updateToolbarStatus);\n    this.parent.off(events.modelChanged, this.onPropertyChanged);\n    this.parent.off(events.refreshBegin, this.onRefresh);\n    this.parent.off(events.destroy, this.destroy);\n    this.parent.off(events.enableFullScreen, this.parent.fullScreenModule.showFullScreen);\n    this.parent.off(events.disableFullScreen, this.parent.fullScreenModule.hideFullScreen);\n    this.parent.off(events.updateToolbarItem, this.updateItem);\n    this.parent.off(events.beforeDropDownOpen, this.dropDownBeforeOpenHandler);\n    this.parent.off(events.expandPopupClick, this.parent.setContentHeight);\n    this.parent.off(events.focusChange, this.focusChangeHandler);\n    this.parent.off(events.mouseDown, this.mouseDownHandler);\n    this.parent.off(events.sourceCodeMouseDown, this.mouseDownHandler);\n    this.parent.off(events.bindCssClass, this.setCssClass);\n\n    if (!this.parent.inlineMode.enable && !isIDevice()) {\n      this.parent.off(events.toolbarClick, this.toolbarClickHandler);\n    }\n  };\n\n  Toolbar.prototype.setCssClass = function (e) {\n    if (this.toolbarObj && e.cssClass) {\n      if (isNullOrUndefined(e.oldCssClass)) {\n        this.toolbarObj.setProperties({\n          cssClass: (this.toolbarObj.cssClass + ' ' + e.cssClass).trim()\n        });\n      } else {\n        this.toolbarObj.setProperties({\n          cssClass: (this.toolbarObj.cssClass.replace(e.oldCssClass, '').trim() + ' ' + e.cssClass).trim()\n        });\n      }\n    }\n  };\n\n  Toolbar.prototype.onRefresh = function () {\n    if (!this.parent.inlineMode.enable) {\n      this.refreshToolbarOverflow();\n    }\n\n    this.parent.setContentHeight('', true);\n  };\n  /**\n   * Called internally if any of the property value changed.\n   *\n   * @param {RichTextEditorModel} e - specifies the string value\n   * @returns {void}\n   * @hidden\n    */\n\n\n  Toolbar.prototype.onPropertyChanged = function (e) {\n    if (!isNullOrUndefined(e.newProp.inlineMode)) {\n      for (var _i = 0, _a = Object.keys(e.newProp.inlineMode); _i < _a.length; _i++) {\n        var prop = _a[_i];\n\n        switch (prop) {\n          case 'enable':\n            this.refreshToolbar();\n            break;\n        }\n      }\n    }\n\n    if (e.module !== this.getModuleName()) {\n      return;\n    }\n\n    this.refreshToolbar();\n  };\n\n  Toolbar.prototype.refreshToolbar = function () {\n    if (isNullOrUndefined(this.baseToolbar.toolbarObj)) {\n      this.baseToolbar = this.parent.getBaseToolbarObject();\n    }\n\n    var tbWrapper = select('.' + classes.CLS_TB_WRAP, this.parent.element);\n    var tbElement = select('.' + classes.CLS_TOOLBAR, this.parent.element);\n\n    if (tbElement || tbWrapper) {\n      this.destroyToolbar();\n    }\n\n    if (this.parent.toolbarSettings.enable) {\n      this.addEventListener();\n      this.renderToolbar();\n      this.parent.wireScrollElementsEvents();\n\n      if (!select('.e-rte-srctextarea', this.parent.element)) {\n        updateUndoRedoStatus(this.baseToolbar, this.parent.formatter.editorManager.undoRedoManager.getUndoStatus());\n      }\n\n      this.parent.notify(events.dynamicModule, {});\n    }\n  };\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {void}\n   * @hidden\n   */\n\n\n  Toolbar.prototype.getModuleName = function () {\n    return 'toolbar';\n  };\n\n  return Toolbar;\n}();\n\nexport { Toolbar };","map":{"version":3,"names":["addClass","Browser","EventHandler","detach","removeClass","select","selectAll","KeyboardEvents","isNullOrUndefined","isNOU","closest","setStyleAttribute","extend","events","classes","RenderType","ToolbarType","setToolbarStatus","updateUndoRedoStatus","getTBarItemsIndex","getCollection","toObjectLowerCase","isIDevice","updateDropDownFontFormatLocale","model","ToolbarRenderer","BaseToolbar","DropDownButtons","ToolbarAction","Toolbar","parent","serviceLocator","isToolbar","locator","isTransformChild","renderFactory","getService","updateDropDownLocale","addRenderer","toolbarRenderer","getRenderer","baseToolbar","addEventListener","toolbarSettings","Object","keys","itemConfigs","length","tools","prototype","initializeInstance","contentRenderer","Content","editableElement","getEditPanel","editPanel","getPanel","toolbarBindEvent","inlineMode","enable","keyBoardModule","getToolbarElement","keyAction","toolBarKeyDown","bind","keyConfigs","formatter","keyConfig","eventName","e","action","contentModule","focus","createToolbarElement","tbElement","createElement","id","getID","isDevice","enableFloating","tbWrapper","innerHTML","outerHTML","className","CLS_TB_WRAP","firstElementChild","element","insertBefore","getToolbarMode","tbMode","type","Expand","Scrollable","checkToolbarResponsive","ele","tBarMode","MultiRow","render","container","items","mode","target","cssClass","addFixedTBarClass","CLS_TB_STATIC","wireEvents","dropDownModule","renderDropDowns","containerType","notify","renderColorPicker","checkIsTransformChild","transformElements","document","i","contains","toggleFloatClass","topValue","isBody","isFloat","scrollParent","floatOffset","floatingToolbarOffset","iframeSettings","inputElement","ownerDocument","body","tbHeight","getToolbarHeight","getExpandTBarPopHeight","scrollParentRelativeTop","trgHeight","offsetHeight","bodyStyle","window","getComputedStyle","parseFloat","marginTop","split","paddingTop","targetTop","getBoundingClientRect","top","scrollParentYOffset","isMSPointer","pageYOffset","parentElement","scrollTop","scrollParentRect","scrollParentTop","outOfRange","CLS_TB_ABS_FLOAT","parent_1","innerHeight","bottom","CLS_TB_FLOAT","width","offsetWidth","renderToolbar","renderInlineToolbar","CLS_RTE_TB_ENABLED","CLS_RTE_EXPAND_TB","refreshToolbarOverflow","divEle","querySelector","iframeEle","style","display","updateToolbarItem","targetItem","updateItem","getBaseToolbarObject","disableToolbarItem","CLS_TB_FIXED","removeFixedTBarClass","showFixedTBar","CLS_SHOW","isIos","CLS_TB_IOS_FIX","hideFixedTBar","args","item","toLocaleLowerCase","trgItem","index","subCommand","toolbarObj","prefixId","prefixIcon","icon","tooltipText","tooltip","dataBind","addTBarItem","updateToolbarStatus","options","tbElements","CLS_TB_ITEM","tbItems","fullScreen","fullScreenModule","showFullScreen","hideScreen","hideFullScreen","getBaseToolbar","addItems","getObject","enableTBarItems","isEnable","muteToolbarUpdate","trgItems","enableItems","editorManager","undoRedoManager","getUndoStatus","removeTBarItems","removeItems","popHeight","classList","expandPopup","CLS_VISIBLE","CLS_EXPAND_OPEN","CLS_TOOLBAR","refreshOverflow","isToolbarDestroyed","isDestroyed","destroyToolbar","unWireScrollElementsEvents","unWireEvents","destroyColorPicker","destroyDropDowns","destroy","removeEventListener","scrollHandler","getDOMVisibility","el","offsetParent","mouseDownHandler","focusChangeHandler","dropDownBeforeOpenHandler","tbFocusHandler","activeElm","activeElement","isToolbaractive","toolbarItem","querySelectorAll","setAttribute","tbKeydownHandler","getAttribute","toolbarClickHandler","trg","originalEvent","setContentHeight","add","remove","toolbarActionModule","on","initialEnd","scroll","bindOnEnd","toolbarUpdated","modelChanged","onPropertyChanged","refreshBegin","onRefresh","enableFullScreen","disableFullScreen","beforeDropDownOpen","expandPopupClick","focusChange","mouseDown","sourceCodeMouseDown","bindCssClass","setCssClass","toolbarClick","off","oldCssClass","setProperties","trim","replace","newProp","_i","_a","prop","refreshToolbar","module","getModuleName","wireScrollElementsEvents","dynamicModule"],"sources":["/home/morgan/Desktop/Projets/ENT4/Jwt-Auth-pdf/react-jwt-auth/react-jwt-auth/node_modules/@syncfusion/ej2-richtexteditor/src/rich-text-editor/actions/toolbar.js"],"sourcesContent":["import { addClass, Browser, EventHandler, detach, removeClass, select, selectAll, KeyboardEvents } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined as isNOU, closest, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { setStyleAttribute, extend } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport * as classes from '../base/classes';\nimport { RenderType, ToolbarType } from '../base/enum';\nimport { setToolbarStatus, updateUndoRedoStatus, getTBarItemsIndex, getCollection, toObjectLowerCase, isIDevice } from '../base/util';\nimport { updateDropDownFontFormatLocale } from '../base/util';\nimport * as model from '../models/items';\nimport { ToolbarRenderer } from '../renderer/toolbar-renderer';\nimport { BaseToolbar } from './base-toolbar';\nimport { DropDownButtons } from './dropdown-buttons';\nimport { ToolbarAction } from './toolbar-action';\n/**\n * `Toolbar` module is used to handle Toolbar actions.\n */\nvar Toolbar = /** @class */ (function () {\n    function Toolbar(parent, serviceLocator) {\n        this.parent = parent;\n        this.isToolbar = false;\n        this.locator = serviceLocator;\n        this.isTransformChild = false;\n        this.renderFactory = this.locator.getService('rendererFactory');\n        model.updateDropDownLocale(this.parent);\n        updateDropDownFontFormatLocale(this.parent);\n        this.renderFactory.addRenderer(RenderType.Toolbar, new ToolbarRenderer(this.parent));\n        this.toolbarRenderer = this.renderFactory.getRenderer(RenderType.Toolbar);\n        this.baseToolbar = new BaseToolbar(this.parent, this.locator);\n        this.addEventListener();\n        if (this.parent.toolbarSettings && Object.keys(this.parent.toolbarSettings.itemConfigs).length > 0) {\n            extend(this.tools, model.tools, toObjectLowerCase(this.parent.toolbarSettings.itemConfigs), true);\n        }\n        else {\n            this.tools = model.tools;\n        }\n    }\n    Toolbar.prototype.initializeInstance = function () {\n        this.contentRenderer = this.renderFactory.getRenderer(RenderType.Content);\n        this.editableElement = this.contentRenderer.getEditPanel();\n        this.editPanel = this.contentRenderer.getPanel();\n    };\n    Toolbar.prototype.toolbarBindEvent = function () {\n        if (!this.parent.inlineMode.enable) {\n            this.keyBoardModule = new KeyboardEvents(this.getToolbarElement(), {\n                keyAction: this.toolBarKeyDown.bind(this), keyConfigs: this.parent.formatter.keyConfig, eventName: 'keydown'\n            });\n        }\n    };\n    Toolbar.prototype.toolBarKeyDown = function (e) {\n        switch (e.action) {\n            case 'escape':\n                this.parent.contentModule.getEditPanel().focus();\n                break;\n        }\n    };\n    Toolbar.prototype.createToolbarElement = function () {\n        this.tbElement = this.parent.createElement('div', { id: this.parent.getID() + '_toolbar' });\n        if (!Browser.isDevice && this.parent.inlineMode.enable && isIDevice()) {\n            return;\n        }\n        else {\n            if (this.parent.toolbarSettings.enableFloating && !this.parent.inlineMode.enable) {\n                this.tbWrapper = this.parent.createElement('div', {\n                    id: this.parent.getID() + '_toolbar_wrapper',\n                    innerHTML: this.tbElement.outerHTML,\n                    className: classes.CLS_TB_WRAP\n                });\n                this.tbElement = this.tbWrapper.firstElementChild;\n                this.parent.element.insertBefore(this.tbWrapper, this.editPanel);\n            }\n            else {\n                this.parent.element.insertBefore(this.tbElement, this.editPanel);\n            }\n        }\n    };\n    Toolbar.prototype.getToolbarMode = function () {\n        var tbMode;\n        switch (this.parent.toolbarSettings.type) {\n            case ToolbarType.Expand:\n                tbMode = 'Extended';\n                break;\n            case ToolbarType.Scrollable:\n                tbMode = 'Scrollable';\n                break;\n            default:\n                tbMode = 'MultiRow';\n        }\n        if (isIDevice() && this.parent.toolbarSettings.type === ToolbarType.Expand) {\n            tbMode = ToolbarType.Scrollable;\n        }\n        return tbMode;\n    };\n    Toolbar.prototype.checkToolbarResponsive = function (ele) {\n        if (!Browser.isDevice || isIDevice()) {\n            return false;\n        }\n        var tBarMode;\n        if (this.parent.toolbarSettings.type === ToolbarType.Expand) {\n            tBarMode = ToolbarType.MultiRow;\n        }\n        else {\n            tBarMode = this.parent.toolbarSettings.type;\n        }\n        this.baseToolbar.render({\n            container: ((this.parent.inlineMode.enable) ? 'quick' : 'toolbar'),\n            items: this.parent.toolbarSettings.items,\n            mode: tBarMode,\n            target: ele,\n            cssClass: this.parent.cssClass\n        });\n        if (this.parent.toolbarSettings.type === ToolbarType.Expand) {\n            addClass([ele], ['e-rte-tb-mobile']);\n            if (this.parent.inlineMode.enable) {\n                this.addFixedTBarClass();\n            }\n            else {\n                addClass([ele], [classes.CLS_TB_STATIC]);\n            }\n        }\n        this.wireEvents();\n        this.dropDownModule.renderDropDowns({\n            container: ele,\n            containerType: ((this.parent.inlineMode.enable) ? 'quick' : 'toolbar'),\n            items: this.parent.toolbarSettings.items\n        });\n        this.parent.notify(events.renderColorPicker, {\n            container: this.tbElement,\n            containerType: ((this.parent.inlineMode.enable) ? 'quick' : 'toolbar'),\n            items: this.parent.toolbarSettings.items\n        });\n        return true;\n    };\n    Toolbar.prototype.checkIsTransformChild = function () {\n        this.isTransformChild = false;\n        var transformElements = selectAll('[style*=\"transform\"]', document);\n        for (var i = 0; i < transformElements.length; i++) {\n            if (!isNullOrUndefined(transformElements[i].contains) && transformElements[i].contains(this.parent.element)) {\n                this.isTransformChild = true;\n                break;\n            }\n        }\n    };\n    Toolbar.prototype.toggleFloatClass = function (e) {\n        var topValue;\n        var isBody = false;\n        var isFloat = false;\n        var scrollParent;\n        var floatOffset = this.parent.floatingToolbarOffset;\n        if (e && this.parent.iframeSettings.enable && this.parent.inputElement.ownerDocument === e.target) {\n            scrollParent = e.target.body;\n        }\n        else if (e && e.target !== document) {\n            scrollParent = e.target;\n        }\n        else {\n            isBody = true;\n            scrollParent = document.body;\n        }\n        var tbHeight = this.getToolbarHeight() + this.getExpandTBarPopHeight();\n        if (this.isTransformChild) {\n            topValue = 0;\n            var scrollParentRelativeTop = 0;\n            var trgHeight = this.parent.element.offsetHeight;\n            if (isBody) {\n                var bodyStyle = window.getComputedStyle(scrollParent);\n                scrollParentRelativeTop = parseFloat(bodyStyle.marginTop.split('px')[0]) + parseFloat(bodyStyle.paddingTop.split('px')[0]);\n            }\n            var targetTop = this.parent.element.getBoundingClientRect().top;\n            var scrollParentYOffset = (Browser.isMSPointer && isBody) ? window.pageYOffset : scrollParent.parentElement.scrollTop;\n            var scrollParentRect = scrollParent.getBoundingClientRect();\n            var scrollParentTop = (!isBody) ? scrollParentRect.top : (scrollParentRect.top + scrollParentYOffset);\n            var outOfRange = ((targetTop - ((!isBody) ? scrollParentTop : 0))\n                + trgHeight > tbHeight + floatOffset) ? false : true;\n            if (targetTop > (scrollParentTop + floatOffset) || targetTop < -trgHeight || ((targetTop < 0) ? outOfRange : false)) {\n                isFloat = false;\n                removeClass([this.tbElement], [classes.CLS_TB_ABS_FLOAT]);\n            }\n            else if (targetTop < (scrollParentTop + floatOffset)) {\n                if (targetTop < 0) {\n                    topValue = (-targetTop) + scrollParentTop;\n                }\n                else {\n                    topValue = scrollParentTop - targetTop;\n                }\n                topValue = (isBody) ? topValue - scrollParentRelativeTop : topValue;\n                addClass([this.tbElement], [classes.CLS_TB_ABS_FLOAT]);\n                isFloat = true;\n            }\n        }\n        else {\n            var parent_1 = this.parent.element.getBoundingClientRect();\n            if (window.innerHeight < parent_1.top) {\n                return;\n            }\n            topValue = (e && e.target !== document) ? scrollParent.getBoundingClientRect().top : 0;\n            if ((parent_1.bottom < (floatOffset + tbHeight + topValue)) || parent_1.bottom < 0 || parent_1.top > floatOffset + topValue) {\n                isFloat = false;\n            }\n            else if (parent_1.top < floatOffset || parent_1.top < floatOffset + topValue) {\n                isFloat = true;\n            }\n        }\n        if (!isFloat) {\n            removeClass([this.tbElement], [classes.CLS_TB_FLOAT]);\n            setStyleAttribute(this.tbElement, { top: 0 + 'px', width: '100%' });\n        }\n        else {\n            addClass([this.tbElement], [classes.CLS_TB_FLOAT]);\n            setStyleAttribute(this.tbElement, { width: this.parent.element.offsetWidth + 'px', top: (floatOffset + topValue) + 'px' });\n        }\n    };\n    Toolbar.prototype.renderToolbar = function () {\n        this.initializeInstance();\n        this.createToolbarElement();\n        if (this.checkToolbarResponsive(this.tbElement)) {\n            return;\n        }\n        if (this.parent.inlineMode.enable) {\n            this.parent.notify(events.renderInlineToolbar, {});\n        }\n        else {\n            this.baseToolbar.render({\n                container: 'toolbar',\n                items: this.parent.toolbarSettings.items,\n                mode: this.getToolbarMode(),\n                target: this.tbElement,\n                cssClass: this.parent.cssClass\n            });\n            if (!this.parent.inlineMode.enable) {\n                if (this.parent.toolbarSettings.enableFloating) {\n                    this.checkIsTransformChild();\n                    this.toggleFloatClass();\n                }\n                addClass([this.parent.element], [classes.CLS_RTE_TB_ENABLED]);\n                if (this.parent.toolbarSettings.type === ToolbarType.Expand) {\n                    addClass([this.parent.element], [classes.CLS_RTE_EXPAND_TB]);\n                }\n            }\n        }\n        this.wireEvents();\n        if (this.parent.inlineMode.enable && !isIDevice()) {\n            this.addFixedTBarClass();\n        }\n        if (!this.parent.inlineMode.enable) {\n            this.dropDownModule.renderDropDowns({\n                container: this.tbElement,\n                containerType: 'toolbar',\n                items: this.parent.toolbarSettings.items\n            });\n            this.parent.notify(events.renderColorPicker, {\n                container: this.tbElement,\n                containerType: 'toolbar',\n                items: this.parent.toolbarSettings.items\n            });\n            this.refreshToolbarOverflow();\n        }\n        var divEle = this.parent.element.querySelector('.e-rte-srctextarea');\n        var iframeEle = this.parent.element.querySelector('.e-source-content');\n        if ((!this.parent.iframeSettings.enable && (!isNOU(divEle) && divEle.style.display === 'block')) ||\n            (this.parent.iframeSettings.enable && (!isNOU(iframeEle) && iframeEle.style.display === 'block'))) {\n            this.parent.notify(events.updateToolbarItem, {\n                targetItem: 'SourceCode', updateItem: 'Preview',\n                baseToolbar: this.parent.getBaseToolbarObject()\n            });\n            this.parent.disableToolbarItem(this.parent.toolbarSettings.items);\n        }\n    };\n    /**\n     * addFixedTBarClass method\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    Toolbar.prototype.addFixedTBarClass = function () {\n        addClass([this.tbElement], [classes.CLS_TB_FIXED]);\n    };\n    /**\n     * removeFixedTBarClass method\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    Toolbar.prototype.removeFixedTBarClass = function () {\n        removeClass([this.tbElement], [classes.CLS_TB_FIXED]);\n    };\n    Toolbar.prototype.showFixedTBar = function () {\n        addClass([this.tbElement], [classes.CLS_SHOW]);\n        if (Browser.isIos) {\n            addClass([this.tbElement], [classes.CLS_TB_IOS_FIX]);\n        }\n    };\n    Toolbar.prototype.hideFixedTBar = function () {\n        // eslint-disable-next-line\n        (!this.isToolbar) ? removeClass([this.tbElement], [classes.CLS_SHOW, classes.CLS_TB_IOS_FIX]) : this.isToolbar = false;\n    };\n    /**\n     * updateItem method\n     *\n     * @param {IUpdateItemsModel} args - specifies the arguments.\n     * @returns {void}\n     * @hidden\n\n     */\n    Toolbar.prototype.updateItem = function (args) {\n        var item = this.tools[args.updateItem.toLocaleLowerCase()];\n        var trgItem = this.tools[args.targetItem.toLocaleLowerCase()];\n        var index = getTBarItemsIndex(getCollection(trgItem.subCommand), args.baseToolbar.toolbarObj.items)[0];\n        if (!isNOU(index)) {\n            var prefixId = this.parent.inlineMode.enable ? '_quick_' : '_toolbar_';\n            args.baseToolbar.toolbarObj.items[index].id = this.parent.getID() + prefixId + item.id;\n            args.baseToolbar.toolbarObj.items[index].prefixIcon = item.icon;\n            args.baseToolbar.toolbarObj.items[index].tooltipText = item.tooltip;\n            args.baseToolbar.toolbarObj.items[index].subCommand = item.subCommand;\n            args.baseToolbar.toolbarObj.dataBind();\n        }\n        else {\n            this.addTBarItem(args, 0);\n        }\n    };\n    Toolbar.prototype.updateToolbarStatus = function (args) {\n        if (!this.tbElement || (this.parent.inlineMode.enable && (isIDevice() || !Browser.isDevice))) {\n            return;\n        }\n        var options = {\n            args: args,\n            dropDownModule: this.dropDownModule,\n            parent: this.parent,\n            tbElements: selectAll('.' + classes.CLS_TB_ITEM, this.tbElement),\n            tbItems: this.baseToolbar.toolbarObj.items\n        };\n        setToolbarStatus(options, (this.parent.inlineMode.enable ? true : false), this.parent);\n    };\n    Toolbar.prototype.fullScreen = function (e) {\n        this.parent.fullScreenModule.showFullScreen(e);\n    };\n    Toolbar.prototype.hideScreen = function (e) {\n        this.parent.fullScreenModule.hideFullScreen(e);\n    };\n    /**\n     * getBaseToolbar method\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    Toolbar.prototype.getBaseToolbar = function () {\n        return this.baseToolbar;\n    };\n    /**\n     * addTBarItem method\n     *\n     * @param {IUpdateItemsModel} args - specifies the arguments.\n     * @param {number} index - specifies the index value.\n     * @returns {void}\n     * @hidden\n\n     */\n    Toolbar.prototype.addTBarItem = function (args, index) {\n        args.baseToolbar.toolbarObj.addItems([args.baseToolbar.getObject(args.updateItem, 'toolbar')], index);\n    };\n    /**\n     * enableTBarItems method\n     *\n     * @param {BaseToolbar} baseToolbar - specifies the toolbar.\n     * @param {string} items - specifies the string value.\n     * @param {boolean} isEnable - specifies the boolean value.\n     * @param {boolean} muteToolbarUpdate - specifies the toolbar.\n     * @returns {void}\n     * @hidden\n\n     */\n    Toolbar.prototype.enableTBarItems = function (baseToolbar, items, isEnable, muteToolbarUpdate) {\n        var trgItems = getTBarItemsIndex(getCollection(items), baseToolbar.toolbarObj.items);\n        this.tbItems = selectAll('.' + classes.CLS_TB_ITEM, baseToolbar.toolbarObj.element);\n        for (var i = 0; i < trgItems.length; i++) {\n            var item = this.tbItems[trgItems[i]];\n            if (item) {\n                baseToolbar.toolbarObj.enableItems(item, isEnable);\n            }\n        }\n        if (!select('.e-rte-srctextarea', this.parent.element) && !muteToolbarUpdate) {\n            updateUndoRedoStatus(baseToolbar, this.parent.formatter.editorManager.undoRedoManager.getUndoStatus());\n        }\n    };\n    /**\n     * removeTBarItems method\n     *\n     * @param {string} items - specifies the string value.\n     * @returns {void}\n     * @hidden\n\n     */\n    Toolbar.prototype.removeTBarItems = function (items) {\n        if (isNullOrUndefined(this.baseToolbar.toolbarObj)) {\n            this.baseToolbar = this.parent.getBaseToolbarObject();\n        }\n        var trgItems = getTBarItemsIndex(getCollection(items), this.baseToolbar.toolbarObj.items);\n        this.tbItems = (this.parent.inlineMode.enable) ? selectAll('.' + classes.CLS_TB_ITEM, this.baseToolbar.toolbarObj.element)\n            : selectAll('.' + classes.CLS_TB_ITEM, this.parent.element);\n        for (var i = 0; i < trgItems.length; i++) {\n            this.baseToolbar.toolbarObj.removeItems(this.tbItems[trgItems[i]]);\n        }\n    };\n    /**\n     * getExpandTBarPopHeight method\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    Toolbar.prototype.getExpandTBarPopHeight = function () {\n        var popHeight = 0;\n        if (this.parent.toolbarSettings.type === ToolbarType.Expand && this.tbElement.classList.contains('e-extended-toolbar')) {\n            var expandPopup = select('.e-toolbar-extended', this.tbElement);\n            if (expandPopup && this.tbElement.classList.contains('e-expand-open')\n                || expandPopup && expandPopup.classList.contains('e-popup-open')) {\n                addClass([expandPopup], [classes.CLS_VISIBLE]);\n                popHeight = popHeight + expandPopup.offsetHeight;\n                removeClass([expandPopup], [classes.CLS_VISIBLE]);\n            }\n            else {\n                removeClass([this.tbElement], [classes.CLS_EXPAND_OPEN]);\n            }\n        }\n        return popHeight;\n    };\n    /**\n     * getToolbarHeight method\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    Toolbar.prototype.getToolbarHeight = function () {\n        return this.tbElement.offsetHeight;\n    };\n    /**\n     * getToolbarElement method\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    Toolbar.prototype.getToolbarElement = function () {\n        return select('.' + classes.CLS_TOOLBAR, this.parent.element);\n    };\n    /**\n     * refreshToolbarOverflow method\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    Toolbar.prototype.refreshToolbarOverflow = function () {\n        this.baseToolbar.toolbarObj.refreshOverflow();\n    };\n    Toolbar.prototype.isToolbarDestroyed = function () {\n        return this.baseToolbar.toolbarObj && !this.baseToolbar.toolbarObj.isDestroyed;\n    };\n    Toolbar.prototype.destroyToolbar = function () {\n        if (this.isToolbarDestroyed()) {\n            this.parent.unWireScrollElementsEvents();\n            this.unWireEvents();\n            this.parent.notify(events.destroyColorPicker, {});\n            this.dropDownModule.destroyDropDowns();\n            this.baseToolbar.toolbarObj.destroy();\n            this.removeEventListener();\n            removeClass([this.parent.element], [classes.CLS_RTE_TB_ENABLED]);\n            removeClass([this.parent.element], [classes.CLS_RTE_EXPAND_TB]);\n            var tbWrapper = select('.' + classes.CLS_TB_WRAP, this.parent.element);\n            var tbElement = select('.' + classes.CLS_TOOLBAR, this.parent.element);\n            if (!isNullOrUndefined(tbWrapper)) {\n                detach(tbWrapper);\n            }\n            else if (!isNullOrUndefined(tbElement)) {\n                detach(tbElement);\n            }\n        }\n    };\n    /**\n     * Destroys the ToolBar.\n     *\n     * @function destroy\n     * @returns {void}\n     * @hidden\n\n     */\n    Toolbar.prototype.destroy = function () {\n        if (this.isToolbarDestroyed()) {\n            this.destroyToolbar();\n            if (this.keyBoardModule) {\n                this.keyBoardModule.destroy();\n            }\n        }\n    };\n    Toolbar.prototype.scrollHandler = function (e) {\n        if (!this.parent.inlineMode.enable) {\n            if (this.parent.toolbarSettings.enableFloating && this.getDOMVisibility(this.tbElement)) {\n                this.toggleFloatClass(e.args);\n            }\n        }\n    };\n    Toolbar.prototype.getDOMVisibility = function (el) {\n        if (!el.offsetParent && el.offsetWidth === 0 && el.offsetHeight === 0) {\n            return false;\n        }\n        return true;\n    };\n    Toolbar.prototype.mouseDownHandler = function () {\n        if (Browser.isDevice && this.parent.inlineMode.enable && !isIDevice()) {\n            this.showFixedTBar();\n        }\n    };\n    Toolbar.prototype.focusChangeHandler = function () {\n        if (Browser.isDevice && this.parent.inlineMode.enable && !isIDevice()) {\n            this.isToolbar = false;\n            this.hideFixedTBar();\n        }\n    };\n    Toolbar.prototype.dropDownBeforeOpenHandler = function () {\n        this.isToolbar = true;\n    };\n    // eslint-disable-next-line\n    Toolbar.prototype.tbFocusHandler = function (e) {\n        var activeElm = document.activeElement;\n        var isToolbaractive = closest(activeElm, '.e-rte-toolbar');\n        if (activeElm === this.parent.getToolbarElement() || isToolbaractive === this.parent.getToolbarElement()) {\n            var toolbarItem = this.parent.getToolbarElement().querySelectorAll('.e-expended-nav');\n            for (var i = 0; i < toolbarItem.length; i++) {\n                if (isNOU(this.parent.getToolbarElement().querySelector('.e-insert-table-btn'))) {\n                    toolbarItem[i].setAttribute('tabindex', '0');\n                }\n                else {\n                    toolbarItem[i].setAttribute('tabindex', '1');\n                }\n            }\n        }\n    };\n    Toolbar.prototype.tbKeydownHandler = function (e) {\n        if (e.target.classList.contains('e-dropdown-btn') ||\n            e.target.getAttribute('id') === this.parent.getID() + '_toolbar_CreateTable') {\n            e.target.setAttribute('tabindex', '0');\n        }\n    };\n    Toolbar.prototype.toolbarClickHandler = function (e) {\n        var trg = closest(e.originalEvent.target, '.e-hor-nav');\n        if (trg && this.parent.toolbarSettings.type === ToolbarType.Expand && !isNOU(trg)) {\n            if (!trg.classList.contains('e-nav-active')) {\n                removeClass([this.tbElement], [classes.CLS_EXPAND_OPEN]);\n                this.parent.setContentHeight('toolbar', false);\n            }\n            else {\n                addClass([this.tbElement], [classes.CLS_EXPAND_OPEN]);\n                this.parent.setContentHeight('toolbar', true);\n            }\n        }\n        else if (Browser.isDevice || this.parent.inlineMode.enable) {\n            this.isToolbar = true;\n        }\n        if (isNOU(trg) && this.parent.toolbarSettings.type === ToolbarType.Expand) {\n            removeClass([this.tbElement], [classes.CLS_EXPAND_OPEN]);\n        }\n    };\n    Toolbar.prototype.wireEvents = function () {\n        if (this.parent.inlineMode.enable && isIDevice()) {\n            return;\n        }\n        EventHandler.add(this.tbElement, 'focusin', this.tbFocusHandler, this);\n        EventHandler.add(this.tbElement, 'keydown', this.tbKeydownHandler, this);\n    };\n    Toolbar.prototype.unWireEvents = function () {\n        EventHandler.remove(this.tbElement, 'focusin', this.tbFocusHandler);\n        EventHandler.remove(this.tbElement, 'keydown', this.tbKeydownHandler);\n    };\n    Toolbar.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.dropDownModule = new DropDownButtons(this.parent, this.locator);\n        this.toolbarActionModule = new ToolbarAction(this.parent);\n        this.parent.on(events.initialEnd, this.renderToolbar, this);\n        this.parent.on(events.scroll, this.scrollHandler, this);\n        this.parent.on(events.bindOnEnd, this.toolbarBindEvent, this);\n        this.parent.on(events.toolbarUpdated, this.updateToolbarStatus, this);\n        this.parent.on(events.modelChanged, this.onPropertyChanged, this);\n        this.parent.on(events.refreshBegin, this.onRefresh, this);\n        this.parent.on(events.destroy, this.destroy, this);\n        this.parent.on(events.enableFullScreen, this.fullScreen, this);\n        this.parent.on(events.disableFullScreen, this.hideScreen, this);\n        this.parent.on(events.updateToolbarItem, this.updateItem, this);\n        this.parent.on(events.beforeDropDownOpen, this.dropDownBeforeOpenHandler, this);\n        this.parent.on(events.expandPopupClick, this.parent.setContentHeight, this.parent);\n        this.parent.on(events.focusChange, this.focusChangeHandler, this);\n        this.parent.on(events.mouseDown, this.mouseDownHandler, this);\n        this.parent.on(events.sourceCodeMouseDown, this.mouseDownHandler, this);\n        this.parent.on(events.bindCssClass, this.setCssClass, this);\n        if (!this.parent.inlineMode.enable && !isIDevice()) {\n            this.parent.on(events.toolbarClick, this.toolbarClickHandler, this);\n        }\n    };\n    Toolbar.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.initialEnd, this.renderToolbar);\n        this.parent.off(events.scroll, this.scrollHandler);\n        this.parent.off(events.bindOnEnd, this.toolbarBindEvent);\n        this.parent.off(events.toolbarUpdated, this.updateToolbarStatus);\n        this.parent.off(events.modelChanged, this.onPropertyChanged);\n        this.parent.off(events.refreshBegin, this.onRefresh);\n        this.parent.off(events.destroy, this.destroy);\n        this.parent.off(events.enableFullScreen, this.parent.fullScreenModule.showFullScreen);\n        this.parent.off(events.disableFullScreen, this.parent.fullScreenModule.hideFullScreen);\n        this.parent.off(events.updateToolbarItem, this.updateItem);\n        this.parent.off(events.beforeDropDownOpen, this.dropDownBeforeOpenHandler);\n        this.parent.off(events.expandPopupClick, this.parent.setContentHeight);\n        this.parent.off(events.focusChange, this.focusChangeHandler);\n        this.parent.off(events.mouseDown, this.mouseDownHandler);\n        this.parent.off(events.sourceCodeMouseDown, this.mouseDownHandler);\n        this.parent.off(events.bindCssClass, this.setCssClass);\n        if (!this.parent.inlineMode.enable && !isIDevice()) {\n            this.parent.off(events.toolbarClick, this.toolbarClickHandler);\n        }\n    };\n    Toolbar.prototype.setCssClass = function (e) {\n        if (this.toolbarObj && e.cssClass) {\n            if (isNullOrUndefined(e.oldCssClass)) {\n                this.toolbarObj.setProperties({ cssClass: (this.toolbarObj.cssClass + ' ' + e.cssClass).trim() });\n            }\n            else {\n                this.toolbarObj.setProperties({ cssClass: (this.toolbarObj.cssClass.replace(e.oldCssClass, '').trim() + ' ' + e.cssClass).trim() });\n            }\n        }\n    };\n    Toolbar.prototype.onRefresh = function () {\n        if (!this.parent.inlineMode.enable) {\n            this.refreshToolbarOverflow();\n        }\n        this.parent.setContentHeight('', true);\n    };\n    /**\n     * Called internally if any of the property value changed.\n     *\n     * @param {RichTextEditorModel} e - specifies the string value\n     * @returns {void}\n     * @hidden\n\n     */\n    Toolbar.prototype.onPropertyChanged = function (e) {\n        if (!isNullOrUndefined(e.newProp.inlineMode)) {\n            for (var _i = 0, _a = Object.keys(e.newProp.inlineMode); _i < _a.length; _i++) {\n                var prop = _a[_i];\n                switch (prop) {\n                    case 'enable':\n                        this.refreshToolbar();\n                        break;\n                }\n            }\n        }\n        if (e.module !== this.getModuleName()) {\n            return;\n        }\n        this.refreshToolbar();\n    };\n    Toolbar.prototype.refreshToolbar = function () {\n        if (isNullOrUndefined(this.baseToolbar.toolbarObj)) {\n            this.baseToolbar = this.parent.getBaseToolbarObject();\n        }\n        var tbWrapper = select('.' + classes.CLS_TB_WRAP, this.parent.element);\n        var tbElement = select('.' + classes.CLS_TOOLBAR, this.parent.element);\n        if (tbElement || tbWrapper) {\n            this.destroyToolbar();\n        }\n        if (this.parent.toolbarSettings.enable) {\n            this.addEventListener();\n            this.renderToolbar();\n            this.parent.wireScrollElementsEvents();\n            if (!select('.e-rte-srctextarea', this.parent.element)) {\n                updateUndoRedoStatus(this.baseToolbar, this.parent.formatter.editorManager.undoRedoManager.getUndoStatus());\n            }\n            this.parent.notify(events.dynamicModule, {});\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Toolbar.prototype.getModuleName = function () {\n        return 'toolbar';\n    };\n    return Toolbar;\n}());\nexport { Toolbar };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}