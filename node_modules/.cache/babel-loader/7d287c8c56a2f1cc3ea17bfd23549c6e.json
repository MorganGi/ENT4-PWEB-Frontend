{"ast":null,"code":"import { createElement, Browser, isNullOrUndefined, isBlazor } from '@syncfusion/ej2-base';\n/**\n * The `TextMarkupAnnotation` module is used to handle text markup annotation actions of PDF viewer.\n *\n * @hidden\n */\n\nvar TextMarkupAnnotation =\n/** @class */\nfunction () {\n  /**\n   * @param pdfViewer\n   * @param viewerBase\n   * @private\n   */\n  function TextMarkupAnnotation(pdfViewer, viewerBase) {\n    var _this = this;\n    /**\n     * @private\n     */\n\n\n    this.currentTextMarkupAddMode = '';\n    /**\n     * @private\n     */\n\n    this.selectTextMarkupCurrentPage = null;\n    /**\n     * @private\n     */\n\n    this.currentTextMarkupAnnotation = null;\n    /**\n     * @private\n     */\n\n    this.isAddAnnotationProgramatically = false;\n    this.currentAnnotationIndex = null;\n    this.isAnnotationSelect = false;\n    /**\n     * @private\n     */\n\n    this.isDropletClicked = false;\n    /**\n     * @private\n     */\n\n    this.isRightDropletClicked = false;\n    /**\n     * @private\n     */\n\n    this.isLeftDropletClicked = false;\n    /**\n     * @private\n     */\n\n    this.isSelectionMaintained = false;\n    this.isExtended = false;\n    this.isNewAnnotation = false;\n    this.selectedTextMarkup = null;\n    this.multiPageCollection = [];\n    this.triggerAddEvent = false;\n    /**\n     * @private\n     */\n\n    this.isSelectedAnnotation = false;\n    this.dropletHeight = 20;\n    /**\n     * @private\n     */\n\n    this.annotationClickPosition = {}; // eslint-disable-next-line\n\n    this.maintainSelection = function (event) {\n      _this.isDropletClicked = true;\n\n      _this.pdfViewer.textSelectionModule.initiateSelectionByTouch();\n\n      _this.isExtended = true;\n      _this.pdfViewer.textSelectionModule.selectionRangeArray = [];\n    }; // eslint-disable-next-line\n\n\n    this.selectionEnd = function (event) {\n      if (_this.isDropletClicked) {\n        _this.isDropletClicked = false;\n      }\n    }; // eslint-disable-next-line\n\n\n    this.annotationLeftMove = function (event) {\n      if (_this.isDropletClicked) {\n        _this.isLeftDropletClicked = true;\n      }\n    }; // eslint-disable-next-line\n\n\n    this.annotationRightMove = function (event) {\n      if (_this.isDropletClicked) {\n        _this.isRightDropletClicked = true;\n      }\n    };\n\n    this.pdfViewer = pdfViewer;\n    this.pdfViewerBase = viewerBase;\n  }\n  /**\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.createAnnotationSelectElement = function () {\n    // eslint-disable-next-line max-len\n    this.dropDivAnnotationLeft = createElement('div', {\n      id: this.pdfViewer.element.id + '_droplet_left',\n      className: 'e-pv-drop'\n    });\n    this.dropDivAnnotationLeft.style.borderRight = '2px solid'; // eslint-disable-next-line max-len\n\n    this.dropDivAnnotationRight = createElement('div', {\n      id: this.pdfViewer.element.id + '_droplet_right',\n      className: 'e-pv-drop'\n    });\n    this.dropDivAnnotationRight.style.borderLeft = '2px solid';\n    this.dropElementLeft = createElement('div', {\n      className: 'e-pv-droplet',\n      id: this.pdfViewer.element.id + '_dropletspan_left'\n    });\n    this.dropElementLeft.style.transform = 'rotate(0deg)';\n    this.dropDivAnnotationLeft.appendChild(this.dropElementLeft);\n    this.dropElementRight = createElement('div', {\n      className: 'e-pv-droplet',\n      id: this.pdfViewer.element.id + '_dropletspan_right'\n    });\n    this.dropElementRight.style.transform = 'rotate(-90deg)';\n    this.dropDivAnnotationRight.appendChild(this.dropElementRight);\n    this.pdfViewerBase.pageContainer.appendChild(this.dropDivAnnotationLeft);\n    this.pdfViewerBase.pageContainer.appendChild(this.dropDivAnnotationRight);\n    this.dropElementLeft.style.top = '20px';\n    this.dropElementRight.style.top = '20px';\n    this.dropElementRight.style.left = '-8px';\n    this.dropElementLeft.style.left = '-8px';\n    this.dropDivAnnotationLeft.style.display = 'none';\n    this.dropDivAnnotationRight.style.display = 'none';\n    this.dropDivAnnotationLeft.addEventListener('mousedown', this.maintainSelection);\n    this.dropDivAnnotationLeft.addEventListener('mousemove', this.annotationLeftMove);\n    this.dropDivAnnotationLeft.addEventListener('mouseup', this.selectionEnd);\n    this.dropDivAnnotationRight.addEventListener('mousedown', this.maintainSelection);\n    this.dropDivAnnotationRight.addEventListener('mousemove', this.annotationRightMove);\n    this.dropDivAnnotationRight.addEventListener('mouseup', this.selectionEnd);\n  };\n  /**\n   * @param target\n   * @param x\n   * @param y\n   * @param target\n   * @param x\n   * @param y\n   * @param target\n   * @param x\n   * @param y\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.textSelect = function (target, x, y) {\n    if (this.isLeftDropletClicked) {\n      var leftElement = this.dropDivAnnotationRight.getBoundingClientRect();\n      var rightElement = this.dropDivAnnotationLeft.getBoundingClientRect();\n      var clientX = x;\n      var clientY = y;\n\n      if (target.classList.contains('e-pv-text')) {\n        if (rightElement.top - 25 > leftElement.top) {\n          this.pdfViewer.textSelectionModule.textSelectionOnDrag(target, clientX, clientY, true);\n        } else {\n          this.pdfViewer.textSelectionModule.textSelectionOnDrag(target, clientX, clientY, false);\n        }\n\n        this.updateLeftposition(clientX, clientY);\n      }\n    } else if (this.isRightDropletClicked) {\n      var leftElement = this.dropDivAnnotationLeft.getBoundingClientRect();\n      var clientX = x;\n      var clientY = y;\n\n      if (target.classList.contains('e-pv-text')) {\n        if (clientY >= leftElement.top) {\n          this.pdfViewer.textSelectionModule.textSelectionOnDrag(target, clientX, clientY, true);\n        } else {\n          this.pdfViewer.textSelectionModule.textSelectionOnDrag(target, clientX, clientY, false);\n        }\n\n        this.updatePosition(clientX, clientY);\n      }\n    }\n  };\n  /**\n   * @param hide\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.showHideDropletDiv = function (hide) {\n    var type = this.pdfViewer.annotationModule.textMarkupAnnotationModule.currentTextMarkupAddMode;\n    var isEnableResizer = this.isEnableTextMarkupResizer(type);\n\n    if (isEnableResizer && this.dropDivAnnotationLeft && this.dropDivAnnotationRight) {\n      if (hide) {\n        this.dropDivAnnotationLeft.style.display = 'none';\n        this.dropDivAnnotationRight.style.display = 'none';\n      } else {\n        this.dropDivAnnotationLeft.style.display = '';\n        this.dropDivAnnotationRight.style.display = '';\n        this.updateDropletStyles(type);\n      }\n    }\n  };\n  /**\n   * @param type\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.isEnableTextMarkupResizer = function (type) {\n    var isEnableResizer = false;\n\n    if (type) {\n      if (type === 'Highlight' && this.pdfViewer.highlightSettings.enableTextMarkupResizer) {\n        isEnableResizer = true;\n      } else if (type === 'Underline' && this.pdfViewer.underlineSettings.enableTextMarkupResizer) {\n        isEnableResizer = true;\n      } else if (type === 'Strikethrough' && this.pdfViewer.strikethroughSettings.enableTextMarkupResizer) {\n        isEnableResizer = true;\n      } else if (this.pdfViewer.enableTextMarkupResizer) {\n        isEnableResizer = true;\n      }\n    } else {\n      if (this.pdfViewer.enableTextMarkupResizer) {\n        isEnableResizer = true;\n      } else if (this.pdfViewer.highlightSettings.enableTextMarkupResizer) {\n        isEnableResizer = true;\n      } else if (this.pdfViewer.underlineSettings.enableTextMarkupResizer) {\n        isEnableResizer = true;\n      } else if (this.pdfViewer.strikethroughSettings.enableTextMarkupResizer) {\n        isEnableResizer = true;\n      }\n    }\n\n    return isEnableResizer;\n  };\n\n  TextMarkupAnnotation.prototype.updateDropletStyles = function (type) {\n    if (this.isEnableTextMarkupResizer(type) && this.dropDivAnnotationLeft && this.dropDivAnnotationLeft.offsetWidth > 0) {\n      this.dropDivAnnotationLeft.style.width = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropDivAnnotationRight.style.width = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropElementLeft.style.width = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropElementRight.style.width = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropDivAnnotationLeft.style.height = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropDivAnnotationRight.style.height = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropElementLeft.style.height = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropElementRight.style.height = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropElementLeft.style.top = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n      this.dropElementRight.style.top = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n    }\n  };\n\n  TextMarkupAnnotation.prototype.updateAnnotationBounds = function () {\n    this.isSelectionMaintained = false; // eslint-disable-next-line\n\n    var annotation = this.currentTextMarkupAnnotation;\n\n    if (annotation && annotation.isMultiSelect) {\n      this.showHideDropletDiv(true);\n      this.updateMultiAnnotBounds(annotation);\n    } else if (annotation && annotation.bounds) {\n      this.retreieveSelection(annotation, null);\n      this.pdfViewer.textSelectionModule.maintainSelection(this.selectTextMarkupCurrentPage, false);\n      this.isSelectionMaintained = true;\n      window.getSelection().removeAllRanges();\n    }\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.updateMultiAnnotBounds = function (annotation) {\n    if (!annotation.annotpageNumbers) {\n      var annotationList = this.getAnnotations(annotation.pageNumber, null);\n\n      if (annotationList) {\n        for (var z = 0; z < annotationList.length; z++) {\n          if (annotationList[z].annotName === annotation.annotName) {\n            annotation = annotationList[z];\n            break;\n          }\n        }\n      }\n    }\n\n    var lowestNumber = annotation.annotpageNumbers[0];\n    var highestNumber = annotation.annotpageNumbers[0];\n\n    for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n      var currentPage = annotation.annotpageNumbers[p];\n\n      if (currentPage >= highestNumber) {\n        highestNumber = currentPage;\n      }\n\n      if (currentPage <= lowestNumber) {\n        lowestNumber = currentPage;\n      }\n    }\n\n    for (var k = lowestNumber; k <= highestNumber; k++) {\n      var annotationList = this.getAnnotations(k, null);\n\n      if (annotationList) {\n        for (var j = 0; j < annotation.annotNameCollection.length; j++) {\n          // eslint-disable-next-line\n          var currentAnnot = annotation.annotNameCollection[j];\n\n          for (var z = 0; z < annotationList.length; z++) {\n            if (annotationList[z].annotName === currentAnnot) {\n              // eslint-disable-next-line\n              var newAnnotation = annotationList[z];\n              this.retreieveSelection(newAnnotation, null);\n              this.pdfViewer.textSelectionModule.maintainSelection(newAnnotation.pageNumber, false);\n            }\n          }\n        }\n      }\n    }\n\n    this.isSelectionMaintained = true;\n    window.getSelection().removeAllRanges();\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.retreieveSelection = function (annotation, element) {\n    for (var k = 0; k < annotation.bounds.length; k++) {\n      // eslint-disable-next-line\n      var bound = annotation.bounds[k];\n      var x = (bound.left ? bound.left : bound.Left) * this.pdfViewerBase.getZoomFactor();\n      var y = (bound.top ? bound.top : bound.Top) * this.pdfViewerBase.getZoomFactor();\n      var width = (bound.width ? bound.width : bound.Width) * this.pdfViewerBase.getZoomFactor();\n      var height = bound.height ? bound.height : bound.Height; // eslint-disable-next-line\n\n      var textLayer = this.pdfViewerBase.getElement('_textLayer_' + annotation.pageNumber);\n\n      if (textLayer) {\n        // eslint-disable-next-line\n        var textDivs = textLayer.childNodes;\n\n        for (var n = 0; n < textDivs.length; n++) {\n          if (textDivs[n]) {\n            // eslint-disable-next-line\n            var rangebounds = textDivs[n].getBoundingClientRect();\n            var top_1 = this.getClientValueTop(rangebounds.top, annotation.pageNumber); // eslint-disable-next-line max-len\n\n            var currentLeft = rangebounds.left - this.pdfViewerBase.getElement('_pageDiv_' + annotation.pageNumber).getBoundingClientRect().left;\n            var totalLeft = currentLeft + rangebounds.width; // eslint-disable-next-line\n\n            var textDiVLeft = parseInt(textDivs[n].style.left); // eslint-disable-next-line\n\n            var currentTop = parseInt(textDivs[n].style.top);\n            var isLeftBounds = this.pdfViewer.textSelectionModule.checkLeftBounds(currentLeft, textDiVLeft, totalLeft, x);\n            var isTopBounds = this.pdfViewer.textSelectionModule.checkTopBounds(top_1, currentTop, y);\n\n            if (isLeftBounds && isTopBounds) {\n              element = textDivs[n];\n              break;\n            }\n          }\n        }\n\n        if (element != null) {\n          // eslint-disable-next-line\n          var boundingRect = this.pdfViewerBase.getElement('_textLayer_' + annotation.pageNumber).getBoundingClientRect();\n          this.pdfViewer.textSelectionModule.textSelectionOnMouseMove(element, x + boundingRect.left, y + boundingRect.top, false);\n\n          if (annotation.bounds.length - 1 === k) {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.textSelectionModule.textSelectionOnMouseMove(element, x + boundingRect.left + width, y + boundingRect.top, false);\n          }\n        }\n      }\n    }\n  };\n  /**\n   * @param x\n   * @param y\n   * @param isSelected\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.updatePosition = function (x, y, isSelected) {\n    this.showHideDropletDiv(false);\n    var pageTopValue = this.pdfViewerBase.pageSize[this.pdfViewerBase.currentPageNumber - 1].top;\n    var topClientValue = this.getClientValueTop(y, this.pdfViewerBase.currentPageNumber - 1); // eslint-disable-next-line\n\n    var rightDivElement = document.getElementById(this.pdfViewer.element.id + '_droplet_right');\n\n    if (isSelected) {\n      // eslint-disable-next-line max-len\n      rightDivElement.style.top = topClientValue * this.pdfViewerBase.getZoomFactor() + pageTopValue * this.pdfViewerBase.getZoomFactor() + 'px';\n    } else {\n      // eslint-disable-next-line max-len\n      rightDivElement.style.top = topClientValue + pageTopValue * this.pdfViewerBase.getZoomFactor() + 'px';\n    } // eslint-disable-next-line max-len\n\n\n    rightDivElement.style.left = x + this.pdfViewerBase.viewerContainer.scrollLeft - this.pdfViewerBase.viewerContainer.getBoundingClientRect().left + 'px';\n  };\n  /**\n   * @param x\n   * @param y\n   * @param isSelected\n   * @param x\n   * @param y\n   * @param isSelected\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.updateLeftposition = function (x, y, isSelected) {\n    this.showHideDropletDiv(false);\n    var pageTopValue = this.pdfViewerBase.pageSize[this.pdfViewerBase.currentPageNumber - 1].top;\n    var topClientValue = this.getClientValueTop(y, this.pdfViewerBase.currentPageNumber - 1); // eslint-disable-next-line\n\n    var leftDivElement = document.getElementById(this.pdfViewer.element.id + '_droplet_left');\n    leftDivElement.style.display = '';\n\n    if (isSelected) {\n      // eslint-disable-next-line max-len\n      leftDivElement.style.top = topClientValue * this.pdfViewerBase.getZoomFactor() + pageTopValue * this.pdfViewerBase.getZoomFactor() + 'px';\n    } else {\n      // eslint-disable-next-line max-len\n      leftDivElement.style.top = topClientValue + pageTopValue * this.pdfViewerBase.getZoomFactor() + 'px';\n    } // eslint-disable-next-line max-len\n\n\n    leftDivElement.style.left = x + this.pdfViewerBase.viewerContainer.scrollLeft - this.pdfViewerBase.viewerContainer.getBoundingClientRect().left - this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n  };\n\n  TextMarkupAnnotation.prototype.getClientValueTop = function (clientValue, pageNumber) {\n    if (this.pdfViewerBase.getElement('_pageDiv_' + pageNumber)) {\n      // eslint-disable-next-line max-len\n      return clientValue - this.pdfViewerBase.getElement('_pageDiv_' + pageNumber).getBoundingClientRect().top;\n    } else {\n      return clientValue;\n    }\n  };\n  /**\n   * @param textMarkupAnnotations\n   * @param pageNumber\n   * @param isImportTextMarkup\n   * @param textMarkupAnnotations\n   * @param pageNumber\n   * @param isImportTextMarkup\n   * @param textMarkupAnnotations\n   * @param pageNumber\n   * @param isImportTextMarkup\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.renderTextMarkupAnnotationsInPage = function (textMarkupAnnotations, pageNumber, isImportTextMarkup) {\n    var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n\n    if (isImportTextMarkup) {\n      this.renderTextMarkupAnnotations(null, pageNumber, canvas, this.pdfViewerBase.getZoomFactor());\n      this.renderTextMarkupAnnotations(textMarkupAnnotations, pageNumber, canvas, this.pdfViewerBase.getZoomFactor(), true);\n    } else {\n      this.renderTextMarkupAnnotations(textMarkupAnnotations, pageNumber, canvas, this.pdfViewerBase.getZoomFactor());\n    }\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.renderTextMarkupAnnotations = function (textMarkupAnnotations, pageNumber, canvas, factor, isImportAction) {\n    if (canvas) {\n      var context = canvas.getContext('2d');\n      context.setTransform(1, 0, 0, 1, 0, 0);\n      context.setLineDash([]); // eslint-disable-next-line\n\n      var annotations = void 0;\n\n      if (!isImportAction) {\n        annotations = this.getAnnotations(pageNumber, textMarkupAnnotations);\n      } else {\n        annotations = textMarkupAnnotations;\n      }\n\n      if (annotations) {\n        for (var i = 0; i < annotations.length; i++) {\n          // eslint-disable-next-line\n          var annotation = annotations[i];\n          var annotationObject = null;\n          var isAnnotationRotated = void 0;\n\n          if (annotation.TextMarkupAnnotationType) {\n            if (isImportAction) {\n              if (this.pdfViewerBase.isJsonImported) {\n                var newArray = [];\n\n                for (var i_1 = 0; i_1 < annotation.Bounds.length; i_1++) {\n                  // eslint-disable-next-line\n                  annotation.Bounds[i_1] = this.pdfViewerBase.importJsonForRotatedDocuments(annotation.Rotate, pageNumber, annotation.Bounds[i_1], annotation.AnnotationRotation);\n                  annotation.Bounds[i_1].left = annotation.Bounds[i_1].X;\n                  annotation.Bounds[i_1].top = annotation.Bounds[i_1].Y;\n                  newArray.push(annotation.Bounds[i_1]);\n                }\n\n                annotation.Bounds = newArray;\n                isAnnotationRotated = this.pdfViewerBase.isPageRotated;\n              }\n            } // eslint-disable-next-line max-len\n\n\n            annotation.annotationAddMode = this.pdfViewer.annotationModule.findAnnotationMode(annotation, pageNumber, annotation.AnnotType);\n\n            if (!annotation.Author) {\n              // eslint-disable-next-line max-len\n              annotation.Author = this.pdfViewer.annotationModule.updateAnnotationAuthor('textMarkup', annotation.TextMarkupAnnotationType);\n            }\n\n            if (!annotation.Subject) {\n              annotation.Subject = annotation.TextMarkupAnnotationType;\n            }\n\n            if (annotation.AnnotationSettings && annotation.AnnotationSettings.isLock) {\n              annotation.AnnotationSettings = {\n                isLock: annotation.AnnotationSettings.isLock\n              };\n            } else {\n              annotation.AnnotationSettings = this.getAnnotationSettings(annotation.TextMarkupAnnotationType);\n            }\n\n            var isPrint_1 = true;\n\n            if (annotation.annotationAddMode === 'Imported Annotation') {\n              isPrint_1 = annotation.IsPrint;\n            } else {\n              isPrint_1 = this.getIsPrintValue(annotation.TextMarkupAnnotationType);\n            } // eslint-disable-next-line max-len\n\n\n            annotation.allowedInteractions = annotation.AllowedInteractions ? annotation.AllowedInteractions : this.pdfViewer.annotationModule.updateAnnotationAllowedInteractions(annotation); // eslint-disable-next-line max-len\n\n            annotationObject = {\n              textMarkupAnnotationType: annotation.TextMarkupAnnotationType,\n              color: annotation.Color,\n              allowedInteractions: annotation.allowedInteractions,\n              opacity: annotation.Opacity,\n              bounds: annotation.Bounds,\n              author: annotation.Author,\n              subject: annotation.Subject,\n              modifiedDate: annotation.ModifiedDate,\n              note: annotation.Note,\n              rect: annotation.Rect,\n              // eslint-disable-next-line max-len\n              annotName: annotation.AnnotName,\n              comments: this.pdfViewer.annotationModule.getAnnotationComments(annotation.Comments, annotation, annotation.Author),\n              review: {\n                state: annotation.State,\n                stateModel: annotation.StateModel,\n                modifiedDate: annotation.ModifiedDate,\n                author: annotation.Author\n              },\n              shapeAnnotationType: 'textMarkup',\n              pageNumber: pageNumber,\n              textMarkupContent: annotation.TextMarkupContent,\n              textMarkupStartIndex: 0,\n              textMarkupEndIndex: 0,\n              annotationSelectorSettings: this.getSettings(annotation),\n              // eslint-disable-next-line max-len\n              customData: this.pdfViewer.annotation.getCustomData(annotation),\n              annotationAddMode: annotation.annotationAddMode,\n              annotationSettings: annotation.AnnotationSettings,\n              isPrint: isPrint_1,\n              isCommentLock: annotation.IsCommentLock,\n              isAnnotationRotated: isAnnotationRotated\n            };\n\n            if (annotation.IsMultiSelect) {\n              annotationObject.annotNameCollection = annotation.AnnotNameCollection;\n              annotationObject.annotpageNumbers = annotation.AnnotpageNumbers;\n              annotationObject.isMultiSelect = annotation.IsMultiSelect;\n            }\n\n            if (annotation.textMarkupContent && annotation.textMarkupContent !== '') {\n              annotationObject.textMarkupContent = annotation.textMarkupContent;\n              annotationObject.textMarkupStartIndex = annotation.textMarkupStartIndex;\n              annotationObject.textMarkupEndIndex = annotation.textMarkupEndIndex;\n            }\n\n            this.pdfViewer.annotationModule.storeAnnotations(pageNumber, annotationObject, '_annotations_textMarkup');\n\n            if (this.isAddAnnotationProgramatically) {\n              // eslint-disable-next-line\n              var settings = {\n                opacity: annotationObject.opacity,\n                author: annotation.author,\n                subject: annotation.subject,\n                modifiedDate: annotation.modifiedDate,\n                // eslint-disable-next-line\n                width: annotationObject.bounds.width,\n                height: annotationObject.bounds.height\n              };\n              this.pdfViewer.fireAnnotationAdd(annotationObject.pageNumber, annotationObject.annotName, annotation.TextMarkupAnnotationType, annotationObject.bounds, settings);\n            }\n          } // eslint-disable-next-line max-len\n\n\n          var type = annotation.TextMarkupAnnotationType ? annotation.TextMarkupAnnotationType : annotation.textMarkupAnnotationType; // eslint-disable-next-line\n\n          var annotBounds = annotation.Bounds ? annotation.Bounds : annotation.bounds;\n          var opacity = annotation.Opacity ? annotation.Opacity : annotation.opacity;\n          var color = annotation.Color ? annotation.Color : annotation.color;\n          var isPrint = true;\n\n          if (annotation.TextMarkupAnnotationType) {\n            isPrint = annotation.IsPrint;\n          }\n\n          if (annotation.textMarkupAnnotationType) {\n            isPrint = annotation.isPrint;\n          }\n\n          switch (type) {\n            case 'Highlight':\n              this.renderHighlightAnnotation(annotBounds, opacity, color, context, factor, isPrint, pageNumber);\n              break;\n\n            case 'Strikethrough':\n              this.renderStrikeoutAnnotation(annotBounds, opacity, color, context, factor, pageNumber, isPrint);\n              break;\n\n            case 'Underline':\n              this.renderUnderlineAnnotation(annotBounds, opacity, color, context, factor, pageNumber, isPrint);\n              break;\n          }\n        }\n      }\n\n      var isMaintainedSelector = false;\n\n      if (this.currentTextMarkupAnnotation && this.currentTextMarkupAnnotation.annotpageNumbers) {\n        for (var m = 0; m < this.currentTextMarkupAnnotation.annotpageNumbers.length; m++) {\n          if (pageNumber === this.currentTextMarkupAnnotation.annotpageNumbers[m]) {\n            isMaintainedSelector = true;\n            this.isAnnotationSelect = false;\n            break;\n          }\n        }\n      }\n\n      if (pageNumber === this.selectTextMarkupCurrentPage || isMaintainedSelector) {\n        if (!this.isAnnotationSelect) {\n          this.maintainAnnotationSelection();\n        } else {\n          this.isAnnotationSelect = false;\n        }\n      }\n    }\n  };\n  /**\n   * @param annotation\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.getSettings = function (annotation) {\n    var selector;\n\n    if (annotation.AnnotationSelectorSettings) {\n      selector = annotation.AnnotationSelectorSettings;\n    } else {\n      selector = this.getSelector(annotation.TextMarkupAnnotationType);\n    }\n\n    return selector;\n  };\n  /**\n   * @param type\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.drawTextMarkupAnnotations = function (type) {\n    this.isTextMarkupAnnotationMode = true;\n    this.currentTextMarkupAddMode = type;\n    var isCleared = true;\n    this.multiPageCollection = [];\n    var selectionObject = this.pdfViewer.textSelectionModule ? this.pdfViewer.textSelectionModule.selectionRangeArray : [];\n\n    if (selectionObject.length > 0 && !this.isSelectionMaintained) {\n      this.convertSelectionToTextMarkup(type, selectionObject, this.pdfViewerBase.getZoomFactor());\n    }\n\n    if (this.isEnableTextMarkupResizer(type) && this.isExtended && window.getSelection().toString()) {\n      var pageBounds = this.getDrawnBounds();\n\n      if (pageBounds[0] && pageBounds[0].bounds) {\n        // eslint-disable-next-line\n        var currentAnnot = this.currentTextMarkupAnnotation;\n\n        for (var k = 0; k < pageBounds.length; k++) {\n          if (currentAnnot && currentAnnot.pageNumber === pageBounds[k].pageIndex) {\n            this.currentTextMarkupAnnotation = currentAnnot;\n            this.selectTextMarkupCurrentPage = pageBounds[k].pageIndex;\n            this.updateTextMarkupAnnotationBounds(pageBounds, k);\n          } else {\n            if (currentAnnot) {\n              if (type === '') {\n                type = currentAnnot.textMarkupAnnotationType;\n              }\n            }\n\n            if (!currentAnnot.isMultiSelect) {\n              var isMultiSelect = false;\n\n              if (this.isMultiAnnotation(type)) {\n                this.multiPageCollection.push(currentAnnot);\n                isMultiSelect = true;\n              } // eslint-disable-next-line max-len\n\n\n              this.drawTextMarkups(type, pageBounds[k].bounds, pageBounds[k].pageIndex, pageBounds[k].rect, this.pdfViewerBase.getZoomFactor(), pageBounds[k].textContent, pageBounds[k].startIndex, pageBounds[k].endIndex, isMultiSelect);\n            } else {\n              if (currentAnnot.isMultiSelect && currentAnnot.annotNameCollection) {\n                this.modifyCurrentAnnotation(currentAnnot, pageBounds, k);\n              }\n            }\n          }\n        }\n      }\n    } else if (window.getSelection().toString()) {\n      var pageBounds = this.getDrawnBounds();\n      var isMultiSelect = this.isMultiPageAnnotations(pageBounds, type);\n\n      if (pageBounds.length > 0) {\n        for (var i = 0; i < pageBounds.length; i++) {\n          if (type === '') {\n            isCleared = false;\n          } // eslint-disable-next-line max-len\n\n\n          this.drawTextMarkups(type, pageBounds[i].bounds, pageBounds[i].pageIndex, pageBounds[i].rect, this.pdfViewerBase.getZoomFactor(), pageBounds[i].textContent, pageBounds[i].startIndex, pageBounds[i].endIndex, isMultiSelect);\n        }\n      }\n    }\n\n    if (this.multiPageCollection) {\n      for (var j = 0; j < this.multiPageCollection.length; j++) {\n        this.updateAnnotationNames(this.multiPageCollection[j], this.multiPageCollection[j].pageNumber);\n      }\n    }\n\n    this.isExtended = false;\n    this.isSelectionMaintained = false; // this.pdfViewerBase.annotationHelper.redoCollection = [];\n\n    if (isCleared && this.pdfViewer.textSelectionModule) {\n      this.pdfViewer.textSelectionModule.clearTextSelection();\n    }\n\n    if (this.isEnableTextMarkupResizer(type)) {\n      this.updateAnnotationBounds();\n    }\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.isMultiPageAnnotations = function (pageBounds, type) {\n    var isMultiSelect = false;\n\n    for (var n = 0; n < pageBounds.length; n++) {\n      if (pageBounds[n].pageIndex !== pageBounds[0].pageIndex && this.isMultiAnnotation(type)) {\n        isMultiSelect = true;\n        break;\n      }\n    }\n\n    return isMultiSelect;\n  };\n\n  TextMarkupAnnotation.prototype.isMultiAnnotation = function (type) {\n    var isSelection = false;\n\n    if (type === 'Highlight' && this.pdfViewer.highlightSettings.enableMultiPageAnnotation) {\n      isSelection = true;\n    } else if (type === 'Underline' && this.pdfViewer.underlineSettings.enableMultiPageAnnotation) {\n      isSelection = true;\n    } else if (type === 'Strikethrough' && this.pdfViewer.strikethroughSettings.enableMultiPageAnnotation) {\n      isSelection = true;\n    } else if (this.pdfViewer.enableMultiPageAnnotation) {\n      isSelection = true;\n    }\n\n    return isSelection;\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.modifyCurrentAnnotation = function (currentAnnot, pageBounds, index) {\n    for (var c = 0; c < currentAnnot.annotNameCollection.length; c++) {\n      // eslint-disable-next-line\n      var currentAnnots = currentAnnot.annotNameCollection[c];\n      var annotationList = this.getAnnotations(pageBounds[index].pageIndex, null);\n\n      if (annotationList) {\n        for (var z = 0; z < annotationList.length; z++) {\n          if (annotationList[z].annotName === currentAnnots) {\n            this.currentTextMarkupAnnotation = annotationList[z];\n            this.selectTextMarkupCurrentPage = pageBounds[index].pageIndex;\n            this.updateTextMarkupAnnotationBounds(pageBounds, index);\n            break;\n          }\n        }\n      }\n    }\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.drawAnnotationSelector = function (newAnnotation, annotation, newcanvas) {\n    for (var i = 0; i < newAnnotation.bounds.length; i++) {\n      // eslint-disable-next-line\n      var bound = newAnnotation.bounds[i];\n      var x = bound.left ? bound.left : bound.Left;\n      var y = bound.top ? bound.top : bound.Top;\n      var width = bound.width ? bound.width : bound.Width;\n      var height = bound.height ? bound.height : bound.Height;\n\n      if (!newcanvas) {\n        newcanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + newAnnotation.pageNumber);\n      } // eslint-disable-next-line max-len\n\n\n      this.drawAnnotationSelectRect(newcanvas, this.getMagnifiedValue(x - 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(y - 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(width + 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(height + 0.5, this.pdfViewerBase.getZoomFactor()), annotation);\n    }\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.selectMultiPageAnnotations = function (annotation) {\n    for (var k = 0; k < annotation.annotNameCollection.length; k++) {\n      // eslint-disable-next-line\n      var currentAnnot = annotation.annotNameCollection[k];\n\n      if (currentAnnot !== annotation.annotName) {\n        for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n          var currentPage = annotation.annotpageNumbers[p];\n          var annotationList = this.getAnnotations(currentPage, null);\n\n          if (annotationList) {\n            for (var z = 0; z < annotationList.length; z++) {\n              if (annotationList[z].annotName === currentAnnot) {\n                // eslint-disable-next-line\n                var newAnnotation = annotationList[z];\n                this.drawAnnotationSelector(newAnnotation, annotation);\n              }\n            }\n          }\n        }\n      }\n    }\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.deletMultiPageAnnotation = function (annotation) {\n    for (var k = 0; k < annotation.annotNameCollection.length; k++) {\n      // eslint-disable-next-line\n      var currentAnnot = annotation.annotNameCollection[k];\n\n      if (currentAnnot !== annotation.annotName) {\n        for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n          var currentPage = annotation.annotpageNumbers[p];\n          var annotationList = this.getAnnotations(currentPage, null);\n\n          if (annotationList) {\n            for (var z = 0; z < annotationList.length; z++) {\n              if (annotationList[z].annotName === currentAnnot) {\n                // eslint-disable-next-line\n                var newAnnotation = annotationList[z];\n                var deletedAnnotation = null;\n                deletedAnnotation = annotationList.splice(z, 1)[0];\n                this.pdfViewer.annotationModule.addAction(currentPage, z, deletedAnnotation, 'Text Markup Deleted', null);\n                this.currentAnnotationIndex = z;\n                this.pdfViewer.annotation.stickyNotesAnnotationModule.findPosition(deletedAnnotation, 'textMarkup');\n                var removeDiv = document.getElementById(deletedAnnotation.annotName);\n\n                if (removeDiv) {\n                  if (removeDiv.parentElement.childElementCount === 1) {\n                    this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAccordionContainer(removeDiv);\n                  } else {\n                    removeDiv.remove();\n                  }\n                }\n\n                this.pdfViewer.annotationModule.updateAnnotationCollection(newAnnotation);\n                this.manageAnnotations(annotationList, currentPage); // eslint-disable-next-line max-len\n\n                this.pdfViewer.annotationModule.updateImportAnnotationCollection(newAnnotation, newAnnotation.pageNumber, 'textMarkupAnnotation');\n                var annotationId = newAnnotation.annotName; // eslint-disable-next-line\n\n                var annotationBounds = newAnnotation.bounds;\n                this.pdfViewer.annotationModule.renderAnnotations(currentPage, null, null, null);\n              }\n            }\n          }\n        }\n      }\n    }\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.modifyMultiPageAnnotations = function (annotation, property, value) {\n    for (var k = 0; k < annotation.annotNameCollection.length; k++) {\n      // eslint-disable-next-line\n      var currentAnnot = annotation.annotNameCollection[k];\n\n      if (currentAnnot !== annotation.annotName) {\n        for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n          var currentPage = annotation.annotpageNumbers[p];\n          var annotationList = this.getAnnotations(currentPage, null);\n\n          if (annotationList) {\n            for (var z = 0; z < annotationList.length; z++) {\n              if (annotationList[z].annotName === currentAnnot) {\n                if (property === 'Color') {\n                  annotationList[z].color = value;\n                } else {\n                  annotationList[z].opacity = value;\n                }\n\n                annotationList[z].modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n                this.currentAnnotationIndex = z;\n\n                if (status === null || status === 'changed') {\n                  // eslint-disable-next-line max-len\n                  this.pdfViewer.annotationModule.addAction(annotationList[z].pageNumber, z, annotationList[z], 'Text Markup Property modified', property);\n                }\n\n                this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAnnotationModifiedDate(annotationList[z]);\n                this.manageAnnotations(annotationList, currentPage);\n                this.pdfViewer.annotationModule.renderAnnotations(currentPage, null, null, null);\n              }\n            }\n          }\n        }\n      }\n    }\n  };\n\n  TextMarkupAnnotation.prototype.convertSelectionToTextMarkup = function (type, selectionObject, factor) {\n    var isMultiSelect = false;\n    this.triggerAddEvent = false;\n    this.multiPageCollection = [];\n\n    for (var i = 0; i < selectionObject.length; i++) {\n      var textValue = selectionObject[i].textContent; // eslint-disable-next-line\n\n      var indexes = void 0;\n\n      if (selectionObject[i].startNode === selectionObject[i].endNode) {\n        var parentText = document.getElementById(selectionObject[i].startNode).textContent;\n        indexes = this.getIndexNumbers(selectionObject[i].pageNumber, textValue, parentText);\n      } else {\n        indexes = this.getIndexNumbers(selectionObject[i].pageNumber, textValue);\n      }\n\n      if (!isMultiSelect) {\n        for (var n = 1; n < selectionObject.length; n++) {\n          if (selectionObject[n].pageNumber !== selectionObject[0].pageNumber && this.isMultiAnnotation(type)) {\n            isMultiSelect = true;\n            break;\n          }\n        }\n      }\n\n      if (this.isMultiAnnotation(type) && selectionObject.length - 1 === i) {\n        this.triggerAddEvent = true;\n      } // eslint-disable-next-line max-len\n\n\n      this.drawTextMarkups(type, selectionObject[i].rectangleBounds, selectionObject[i].pageNumber, selectionObject[i].bound, factor, textValue, indexes.startIndex, indexes.endIndex, isMultiSelect);\n    }\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.updateTextMarkupAnnotationBounds = function (pageBounds, currentIndex) {\n    if (this.currentTextMarkupAnnotation) {\n      var pageAnnotations = this.getAnnotations(pageBounds[currentIndex].pageIndex, null);\n      var annotation = null;\n\n      if (pageAnnotations) {\n        for (var i = 0; i < pageAnnotations.length; i++) {\n          if (JSON.stringify(this.currentTextMarkupAnnotation) === JSON.stringify(pageAnnotations[i])) {\n            pageAnnotations[i].bounds = pageBounds[currentIndex].bounds;\n            pageAnnotations[i].textMarkupContent = pageBounds[currentIndex].textContent;\n            pageAnnotations[i].textMarkupStartIndex = pageBounds[currentIndex].startIndex;\n            pageAnnotations[i].textMarkupEndIndex = pageBounds[currentIndex].endIndex;\n            pageAnnotations[i].modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n            annotation = pageAnnotations[i];\n          }\n        }\n\n        this.manageAnnotations(pageAnnotations, pageBounds[currentIndex].pageIndex);\n        this.currentTextMarkupAnnotation = null;\n        this.pdfViewer.annotationModule.renderAnnotations(pageBounds[currentIndex].pageIndex, null, null, null);\n        this.pdfViewerBase.updateDocumentEditedProperty(true);\n\n        if (annotation) {\n          // eslint-disable-next-line\n          var settings = {\n            opacity: annotation.opacity,\n            color: annotation.color,\n            author: annotation.author,\n            subject: annotation.subject,\n            modifiedDate: annotation.modifiedDate\n          }; // eslint-disable-next-line max-len\n\n          var multiPageCollection = this.multiPageCollectionList(annotation);\n\n          if (multiPageCollection.length > 0) {\n            if (pageBounds.length - 1 === currentIndex) {\n              // eslint-disable-next-line max-len\n              this.pdfViewer.fireAnnotationResize(pageBounds[currentIndex].pageIndex, annotation.annotName, annotation.textMarkupAnnotationType, annotation.bounds, settings, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex, null, multiPageCollection);\n            }\n          } else {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.fireAnnotationResize(pageBounds[currentIndex].pageIndex, annotation.annotName, annotation.textMarkupAnnotationType, annotation.bounds, settings, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex, null);\n          }\n        } // eslint-disable-next-line max-len\n\n\n        this.currentAnnotationIndex = null;\n        this.selectTextMarkupCurrentPage = null;\n      }\n    }\n  };\n  /**\n   * @param annotation\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.multiPageCollectionList = function (annotation) {\n    var multiPageCollectionList = [];\n\n    if (annotation.isMultiSelect && annotation.annotNameCollection) {\n      multiPageCollectionList.push(annotation);\n\n      for (var k = 0; k < annotation.annotNameCollection.length; k++) {\n        // eslint-disable-next-line\n        var currentAnnot = annotation.annotNameCollection[k];\n\n        if (currentAnnot !== annotation.annotName) {\n          for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n            var currentPage = annotation.annotpageNumbers[p];\n            var annotationList = this.getAnnotations(currentPage, null);\n\n            if (annotationList) {\n              for (var z = 0; z < annotationList.length; z++) {\n                if (annotationList[z].annotName === currentAnnot) {\n                  multiPageCollectionList.push(annotationList[z]);\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n\n    return multiPageCollectionList;\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.updateAnnotationNames = function (annotations, pageNumber) {\n    if (annotations) {\n      var pageAnnotations = this.getAnnotations(pageNumber, null);\n      var annotation = null;\n\n      if (pageAnnotations) {\n        for (var i = 0; i < pageAnnotations.length; i++) {\n          if (annotations.annotName === pageAnnotations[i].annotName) {\n            // eslint-disable-next-line\n            var annotNamesCollections = []; // eslint-disable-next-line\n\n            var annotpageNumbers = [];\n\n            for (var p = 0; p < this.multiPageCollection.length; p++) {\n              annotNamesCollections.push(this.multiPageCollection[p].annotName);\n              annotpageNumbers.push(this.multiPageCollection[p].pageNumber);\n            }\n\n            pageAnnotations[i].isMultiSelect = true;\n            pageAnnotations[i].annotNameCollection = annotNamesCollections;\n            pageAnnotations[i].annotpageNumbers = annotpageNumbers;\n            annotation = pageAnnotations[i];\n          }\n        }\n\n        this.manageAnnotations(pageAnnotations, pageNumber);\n      }\n    }\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.updateAnnotationContent = function (annotation, pageBound) {\n    if (annotation) {\n      var pageAnnotations = this.getAnnotations(this.selectTextMarkupCurrentPage, null);\n      var annotation_1 = null;\n\n      if (pageAnnotations) {\n        for (var i = 0; i < pageAnnotations.length; i++) {\n          if (JSON.stringify(this.currentTextMarkupAnnotation) === JSON.stringify(pageAnnotations[i])) {\n            pageAnnotations[i].textMarkupContent = pageBound.textContent;\n            pageAnnotations[i].textMarkupStartIndex = pageBound.startIndex;\n            pageAnnotations[i].textMarkupEndIndex = pageBound.endIndex;\n            annotation_1 = pageAnnotations[i];\n          }\n\n          this.pdfViewer.annotationModule.storeAnnotationCollections(pageAnnotations[i], this.selectTextMarkupCurrentPage);\n        }\n\n        this.manageAnnotations(pageAnnotations, this.selectTextMarkupCurrentPage);\n      }\n    }\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.drawTextMarkups = function (type, bounds, pageNumber, rect, factor, textContent, startIndex, endIndex, isMultiSelect) {\n    var annotation = null;\n    this.isNewAnnotation = false;\n    var author = 'Guest';\n    var subject;\n    var context = this.getPageContext(pageNumber);\n    var modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n    this.highlightColor = this.highlightColor ? this.highlightColor : this.pdfViewer.highlightSettings.color;\n    this.underlineColor = this.underlineColor ? this.underlineColor : this.pdfViewer.underlineSettings.color;\n    this.strikethroughColor = this.strikethroughColor ? this.strikethroughColor : this.pdfViewer.strikethroughSettings.color;\n    this.highlightOpacity = this.pdfViewer.highlightSettings.opacity;\n    this.underlineOpacity = this.pdfViewer.underlineSettings.opacity;\n    this.strikethroughOpacity = this.pdfViewer.strikethroughSettings.opacity;\n    this.annotationAddMode = 'UI Drawn Annotation'; // eslint-disable-next-line\n\n    var allowedInteractions;\n\n    if (context) {\n      context.setLineDash([]);\n\n      switch (type) {\n        case 'Highlight':\n          this.isNewAnnotation = true;\n          subject = 'Highlight'; // eslint-disable-next-line max-len\n\n          author = this.pdfViewer.highlightSettings.author !== 'Guest' && this.pdfViewer.highlightSettings.author ? this.pdfViewer.highlightSettings.author : this.pdfViewer.annotationSettings.author ? this.pdfViewer.annotationSettings.author : 'Guest';\n          allowedInteractions = this.pdfViewer.highlightSettings.allowedInteractions ? this.pdfViewer.highlightSettings.allowedInteractions : 'None'; // eslint-disable-next-line max-len\n\n          annotation = this.getAddedAnnotation(type, this.highlightColor, this.highlightOpacity, bounds, author, subject, modifiedDate, '', false, rect, pageNumber, textContent, startIndex, endIndex, isMultiSelect, allowedInteractions);\n\n          if (annotation) {\n            // eslint-disable-next-line max-len\n            this.renderHighlightAnnotation(annotation.bounds, annotation.opacity, annotation.color, context, factor, annotation.isPrint, pageNumber);\n          }\n\n          break;\n\n        case 'Strikethrough':\n          this.isNewAnnotation = true;\n          subject = 'Strikethrough'; // eslint-disable-next-line max-len\n\n          author = this.pdfViewer.strikethroughSettings.author !== 'Guest' && this.pdfViewer.strikethroughSettings.author ? this.pdfViewer.strikethroughSettings.author : this.pdfViewer.annotationSettings.author ? this.pdfViewer.annotationSettings.author : 'Guest';\n          allowedInteractions = this.pdfViewer.strikethroughSettings.allowedInteractions ? this.pdfViewer.strikethroughSettings.allowedInteractions : 'None'; // eslint-disable-next-line max-len\n\n          annotation = this.getAddedAnnotation(type, this.strikethroughColor, this.strikethroughOpacity, bounds, author, subject, modifiedDate, '', false, rect, pageNumber, textContent, startIndex, endIndex, isMultiSelect, allowedInteractions);\n\n          if (annotation) {\n            // eslint-disable-next-line max-len\n            this.renderStrikeoutAnnotation(annotation.bounds, annotation.opacity, annotation.color, context, factor, pageNumber, annotation.isPrint);\n          }\n\n          break;\n\n        case 'Underline':\n          this.isNewAnnotation = true;\n          subject = 'Underline'; // eslint-disable-next-line max-len\n\n          author = this.pdfViewer.underlineSettings.author !== 'Guest' && this.pdfViewer.underlineSettings.author ? this.pdfViewer.underlineSettings.author : this.pdfViewer.annotationSettings.author ? this.pdfViewer.annotationSettings.author : 'Guest';\n          allowedInteractions = this.pdfViewer.underlineSettings.allowedInteractions ? this.pdfViewer.underlineSettings.allowedInteractions : 'None'; // eslint-disable-next-line max-len\n\n          annotation = this.getAddedAnnotation(type, this.underlineColor, this.underlineOpacity, bounds, author, subject, modifiedDate, '', false, rect, pageNumber, textContent, startIndex, endIndex, isMultiSelect, allowedInteractions);\n\n          if (annotation) {\n            // eslint-disable-next-line max-len\n            this.renderUnderlineAnnotation(annotation.bounds, annotation.opacity, annotation.color, context, factor, pageNumber, annotation.isPrint);\n          }\n\n          break;\n      }\n\n      this.isNewAnnotation = false;\n\n      if (annotation) {\n        this.pdfViewerBase.updateDocumentEditedProperty(true); // eslint-disable-next-line\n\n        var settings = {\n          opacity: annotation.opacity,\n          color: annotation.color,\n          author: annotation.author,\n          subject: annotation.subject,\n          modifiedDate: annotation.modifiedDate\n        };\n        var index = this.pdfViewer.annotationModule.actionCollection[this.pdfViewer.annotationModule.actionCollection.length - 1].index; // eslint-disable-next-line max-len\n\n        if (this.isMultiAnnotation(type)) {\n          if (this.triggerAddEvent) {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.fireAnnotationAdd(pageNumber, annotation.annotName, type, annotation.bounds, settings, textContent, startIndex, endIndex, null, this.multiPageCollection);\n          }\n        } else {\n          // eslint-disable-next-line max-len\n          this.pdfViewer.fireAnnotationAdd(pageNumber, annotation.annotName, type, annotation.bounds, settings, textContent, startIndex, endIndex);\n        }\n      }\n\n      if (Browser.isDevice && !this.pdfViewer.enableDesktopMode && this.pdfViewer.enableToolbar && this.pdfViewer.enableAnnotationToolbar) {\n        this.pdfViewer.toolbarModule.annotationToolbarModule.createPropertyTools(type);\n      }\n    }\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.retreiveTextIndex = function (annotation) {\n    if (annotation.textMarkupContent === '') {\n      this.retreieveSelection(annotation, null);\n      var pageBounds = this.getDrawnBounds();\n      window.getSelection().removeAllRanges();\n\n      if (pageBounds[0] && pageBounds[0].bounds) {\n        this.updateAnnotationContent(annotation, pageBounds[0]);\n        annotation.textMarkupContent = pageBounds[0].textContent;\n        annotation.textMarkupStartIndex = pageBounds[0].startIndex;\n        annotation.textMarkupEndIndex = pageBounds[0].endIndex;\n      }\n    }\n\n    return annotation;\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.renderHighlightAnnotation = function (bounds, opacity, color, context, factor, isPrint, pageIndex) {\n    var zoomRatio = this.pdfViewerBase.getZoomRatio(factor);\n\n    for (var i = 0; i < bounds.length; i++) {\n      // eslint-disable-next-line\n      var bound = bounds[i];\n      context.beginPath();\n      var x = bound.X ? bound.X : bound.left;\n      var y = bound.Y ? bound.Y : bound.top;\n      var width = bound.Width ? bound.Width : bound.width;\n      var height = bound.Height ? bound.Height : bound.height;\n      x = x ? x : bound.x;\n      y = y ? y : bound.y; // The highlighted position is slightly increased. So Subtract -1 from the height. \n\n      height = height - 1;\n\n      if (context.canvas.id === this.pdfViewer.element.id + '_print_annotation_layer_' + pageIndex) {\n        if (isPrint) {\n          // eslint-disable-next-line max-len\n          context.rect(x * zoomRatio, y * zoomRatio, width * zoomRatio, height * zoomRatio);\n          context.globalAlpha = opacity * 0.5;\n          context.closePath();\n          context.fillStyle = color;\n          context.msFillRule = 'nonzero';\n          context.fill();\n        }\n      } else {\n        // eslint-disable-next-line max-len\n        context.rect(x * zoomRatio, y * zoomRatio, width * zoomRatio, height * zoomRatio);\n        context.globalAlpha = opacity * 0.5;\n        context.closePath();\n        context.fillStyle = color;\n        context.msFillRule = 'nonzero';\n        context.fill();\n      }\n    }\n\n    context.save();\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.renderStrikeoutAnnotation = function (bounds, opacity, color, context, factor, pageNumber, isPrint) {\n    for (var i = 0; i < bounds.length; i++) {\n      // eslint-disable-next-line\n      var bound = this.getProperBounds(bounds[i]);\n      var pageDetails = this.pdfViewerBase.pageSize[pageNumber];\n      var factorRatio = this.pdfViewerBase.getZoomRatio(factor);\n\n      if (context.canvas.id === this.pdfViewer.element.id + '_print_annotation_layer_' + pageNumber) {\n        if (isPrint) {\n          if (pageDetails.rotation === 1) {\n            // eslint-disable-next-line max-len\n            this.drawLine(opacity, bound.x + bound.width / 2, bound.y, bound.width, bound.height, color, factorRatio, context, pageNumber);\n          } else if (pageDetails.rotation === 2) {\n            // eslint-disable-next-line max-len\n            this.drawLine(opacity, bound.x, bound.y + bound.height / 2, bound.width, bound.height, color, factorRatio, context, pageNumber);\n          } else if (pageDetails.rotation === 3) {\n            this.drawLine(opacity, bound.x, bound.y, bound.width / 2, bound.height, color, factorRatio, context, pageNumber);\n          } else {\n            this.drawLine(opacity, bound.x, bound.y, bound.width, bound.height / 2, color, factorRatio, context, pageNumber);\n          }\n        }\n      } else {\n        if (pageDetails.rotation === 1) {\n          // eslint-disable-next-line max-len\n          this.drawLine(opacity, bound.x + bound.width / 2, bound.y, bound.width, bound.height, color, factorRatio, context, pageNumber);\n        } else if (pageDetails.rotation === 2) {\n          // eslint-disable-next-line max-len\n          this.drawLine(opacity, bound.x, bound.y + bound.height / 2, bound.width, bound.height, color, factorRatio, context, pageNumber);\n        } else if (pageDetails.rotation === 3) {\n          this.drawLine(opacity, bound.x, bound.y, bound.width / 2, bound.height, color, factorRatio, context, pageNumber);\n        } else {\n          this.drawLine(opacity, bound.x, bound.y, bound.width, bound.height / 2, color, factorRatio, context, pageNumber);\n        }\n      }\n    }\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.renderUnderlineAnnotation = function (bounds, opacity, color, context, factor, pageNumber, isPrint) {\n    for (var i = 0; i < bounds.length; i++) {\n      // eslint-disable-next-line\n      var boundValues = this.getProperBounds(bounds[i]);\n      var factorRatio = this.pdfViewerBase.getZoomRatio(factor);\n\n      if (context.canvas.id === this.pdfViewer.element.id + '_print_annotation_layer_' + pageNumber) {\n        if (isPrint) {\n          // eslint-disable-next-line max-len\n          this.drawLine(opacity, boundValues.x, boundValues.y, boundValues.width, boundValues.height, color, factorRatio, context, pageNumber);\n        }\n      } else {\n        // eslint-disable-next-line max-len\n        this.drawLine(opacity, boundValues.x, boundValues.y, boundValues.width, boundValues.height, color, factorRatio, context, pageNumber);\n      }\n    }\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.getProperBounds = function (bound) {\n    var x = bound.X ? bound.X : bound.left;\n    var y = bound.Y ? bound.Y : bound.top;\n    var width = bound.Width ? bound.Width : bound.width;\n    var height = bound.Height ? bound.Height : bound.height;\n    x = x ? x : bound.x;\n    y = y ? y : bound.y;\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    };\n  }; // eslint-disable-next-line max-len\n\n\n  TextMarkupAnnotation.prototype.drawLine = function (opacity, x, y, width, height, color, factor, context, pageNumber) {\n    context.globalAlpha = opacity;\n\n    if (isBlazor()) {\n      y = y - 1;\n    }\n\n    height = height - 1;\n    context.beginPath();\n    var pageDetails = this.pdfViewerBase.pageSize[pageNumber];\n\n    if (pageDetails.rotation === 1) {\n      context.moveTo(x * factor, y * factor);\n      context.lineTo(x * factor, (y + height) * factor);\n    } else if (pageDetails.rotation === 2) {\n      context.moveTo(x * factor, y * factor);\n      context.lineTo((width + x) * factor, y * factor);\n    } else if (pageDetails.rotation === 3) {\n      context.moveTo((width + x) * factor, y * factor);\n      context.lineTo((width + x) * factor, (y + height) * factor);\n    } else {\n      context.moveTo(x * factor, (y + height) * factor);\n      context.lineTo((width + x) * factor, (y + height) * factor);\n    }\n\n    context.lineWidth = 1;\n    context.strokeStyle = color;\n    context.closePath();\n    context.msFillRule = 'nonzero';\n    context.stroke();\n  };\n  /**\n   * @param textMarkupAnnotations\n   * @param pageIndex\n   * @param stampData\n   * @param shapeData\n   * @param measureShapeData\n   * @param stickyData\n   * @param textMarkupAnnotations\n   * @param pageIndex\n   * @param stampData\n   * @param shapeData\n   * @param measureShapeData\n   * @param stickyData\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.printTextMarkupAnnotations = function (textMarkupAnnotations, pageIndex, stampData, shapeData, measureShapeData, stickyData) {\n    var canvas = createElement('canvas', {\n      id: this.pdfViewer.element.id + '_print_annotation_layer_' + pageIndex\n    });\n    canvas.style.width = 816 + 'px';\n    canvas.style.height = 1056 + 'px';\n    var pageWidth = this.pdfViewerBase.pageSize[pageIndex].width;\n    var pageHeight = this.pdfViewerBase.pageSize[pageIndex].height;\n    var zoom = this.pdfViewerBase.getZoomFactor();\n    var zoomRatio = this.pdfViewerBase.getZoomRatio(zoom);\n    canvas.height = pageHeight * zoomRatio;\n    canvas.width = pageWidth * zoomRatio; // eslint-disable-next-line\n\n    var textMarkupannotations = this.getAnnotations(pageIndex, null, '_annotations_textMarkup'); // eslint-disable-next-line\n\n    var shapeAnnotation = this.getAnnotations(pageIndex, null, '_annotations_shape'); // eslint-disable-next-line\n\n    var measureShapeAnnotation = this.getAnnotations(pageIndex, null, '_annotations_shape_measure'); // eslint-disable-next-line\n\n    var stampAnnotation = this.getAnnotations(pageIndex, null, '_annotations_stamp'); // eslint-disable-next-line\n\n    var stickyNoteAnnotation = this.getAnnotations(pageIndex, null, '_annotations_sticky');\n\n    if (stampAnnotation || shapeAnnotation || stickyNoteAnnotation || measureShapeAnnotation) {\n      this.pdfViewer.renderDrawing(canvas, pageIndex);\n    } else {\n      this.pdfViewer.annotation.renderAnnotations(pageIndex, shapeData, measureShapeData, null, canvas);\n      this.pdfViewer.annotation.stampAnnotationModule.renderStampAnnotations(stampData, pageIndex, canvas);\n      this.pdfViewer.annotation.stickyNotesAnnotationModule.renderStickyNotesAnnotations(stickyData, pageIndex, canvas);\n    }\n\n    var zoomFactor = this.pdfViewerBase.getZoomFactor();\n\n    if (textMarkupannotations) {\n      this.renderTextMarkupAnnotations(null, pageIndex, canvas, zoomFactor);\n    } else {\n      this.renderTextMarkupAnnotations(textMarkupAnnotations, pageIndex, canvas, zoomFactor);\n    }\n\n    var imageSource = canvas.toDataURL();\n    return imageSource;\n  };\n  /**\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.saveTextMarkupAnnotations = function () {\n    // eslint-disable-next-line\n    var storeTextMarkupObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n\n    if (this.pdfViewerBase.isStorageExceed) {\n      storeTextMarkupObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_textMarkup'];\n    } // eslint-disable-next-line\n\n\n    var textMarkupAnnotations = new Array();\n\n    for (var j = 0; j < this.pdfViewerBase.pageCount; j++) {\n      textMarkupAnnotations[j] = [];\n    }\n\n    if (storeTextMarkupObject && !this.pdfViewer.annotationSettings.skipDownload) {\n      var textMarkupAnnotationCollection = JSON.parse(storeTextMarkupObject);\n\n      for (var i = 0; i < textMarkupAnnotationCollection.length; i++) {\n        var newArray = [];\n        var pageAnnotationObject = textMarkupAnnotationCollection[i];\n\n        if (pageAnnotationObject) {\n          for (var z = 0; pageAnnotationObject.annotations.length > z; z++) {\n            this.pdfViewer.annotationModule.updateModifiedDate(pageAnnotationObject.annotations[z]);\n\n            if (this.pdfViewerBase.isJsonExported) {\n              if (pageAnnotationObject.annotations[z].isAnnotationRotated) {\n                pageAnnotationObject.annotations[z].bounds = this.getBoundsForSave(pageAnnotationObject.annotations[z].bounds, i);\n              } else {\n                var pageDetails = this.pdfViewerBase.pageSize[pageAnnotationObject.pageIndex];\n\n                if (pageDetails) {\n                  pageAnnotationObject.annotations[z].annotationRotation = pageDetails.rotation;\n                }\n              }\n            } // eslint-disable-next-line max-len\n\n\n            pageAnnotationObject.annotations[z].bounds = JSON.stringify(this.getBoundsForSave(pageAnnotationObject.annotations[z].bounds, i));\n            var colorString = pageAnnotationObject.annotations[z].color;\n            pageAnnotationObject.annotations[z].color = JSON.stringify(this.getRgbCode(colorString));\n            pageAnnotationObject.annotations[z].rect = JSON.stringify(pageAnnotationObject.annotations[z].rect);\n          }\n\n          newArray = pageAnnotationObject.annotations;\n        }\n\n        textMarkupAnnotations[pageAnnotationObject.pageIndex] = newArray;\n      }\n    }\n\n    return JSON.stringify(textMarkupAnnotations);\n  };\n  /**\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.deleteTextMarkupAnnotation = function () {\n    if (this.currentTextMarkupAnnotation) {\n      var isLock = false;\n\n      if (this.currentTextMarkupAnnotation.annotationSettings) {\n        // eslint-disable-next-line\n        isLock = this.currentTextMarkupAnnotation.annotationSettings.isLock;\n\n        if (this.pdfViewer.annotationModule.checkAllowedInteractions('Delete', this.currentTextMarkupAnnotation)) {\n          isLock = false;\n        }\n      }\n\n      if (!isLock) {\n        var deletedAnnotation = null;\n        this.showHideDropletDiv(true); // eslint-disable-next-line\n\n        var annotation = this.currentTextMarkupAnnotation;\n\n        if (this.currentTextMarkupAnnotation.isMultiSelect && annotation.annotNameCollection) {\n          this.deletMultiPageAnnotation(annotation);\n        }\n\n        var pageAnnotations = this.getAnnotations(this.selectTextMarkupCurrentPage, null);\n\n        if (pageAnnotations) {\n          for (var i = 0; i < pageAnnotations.length; i++) {\n            if (this.currentTextMarkupAnnotation.annotName === pageAnnotations[i].annotName) {\n              deletedAnnotation = pageAnnotations.splice(i, 1)[0]; // eslint-disable-next-line max-len\n\n              this.pdfViewer.annotationModule.addAction(this.selectTextMarkupCurrentPage, i, deletedAnnotation, 'Text Markup Deleted', null);\n              this.currentAnnotationIndex = i;\n              this.pdfViewer.annotation.stickyNotesAnnotationModule.findPosition(deletedAnnotation, 'textMarkup');\n              var removeDiv = document.getElementById(deletedAnnotation.annotName);\n\n              if (removeDiv) {\n                if (removeDiv.parentElement.childElementCount === 1) {\n                  this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAccordionContainer(removeDiv);\n                } else {\n                  removeDiv.remove();\n                }\n              }\n            }\n          }\n\n          this.pdfViewer.annotationModule.updateAnnotationCollection(this.currentTextMarkupAnnotation);\n          this.manageAnnotations(pageAnnotations, this.selectTextMarkupCurrentPage); // eslint-disable-next-line max-len\n\n          this.pdfViewer.annotationModule.updateImportAnnotationCollection(this.currentTextMarkupAnnotation, this.currentTextMarkupAnnotation.pageNumber, 'textMarkupAnnotation');\n          var annotationId = this.currentTextMarkupAnnotation.annotName; // eslint-disable-next-line\n\n          var annotationBounds = this.currentTextMarkupAnnotation.bounds;\n          this.currentTextMarkupAnnotation = null;\n          this.pdfViewer.annotationModule.renderAnnotations(this.selectTextMarkupCurrentPage, null, null, null);\n          this.pdfViewerBase.updateDocumentEditedProperty(true); // eslint-disable-next-line max-len\n\n          var multiPageCollection = this.multiPageCollectionList(annotation);\n\n          if (multiPageCollection.length > 0) {\n            multiPageCollection.push(deletedAnnotation); // eslint-disable-next-line max-len\n\n            this.pdfViewer.fireAnnotationRemove(this.selectTextMarkupCurrentPage, annotationId, deletedAnnotation.textMarkupAnnotationType, annotationBounds, deletedAnnotation.textMarkupContent, deletedAnnotation.textMarkupStartIndex, deletedAnnotation.textMarkupEndIndex, multiPageCollection);\n          } else {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.fireAnnotationRemove(this.selectTextMarkupCurrentPage, annotationId, deletedAnnotation.textMarkupAnnotationType, annotationBounds, deletedAnnotation.textMarkupContent, deletedAnnotation.textMarkupStartIndex, deletedAnnotation.textMarkupEndIndex);\n          }\n\n          this.currentAnnotationIndex = null;\n          this.selectTextMarkupCurrentPage = null;\n\n          if (Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.toolbarModule.annotationToolbarModule.hideMobileAnnotationToolbar();\n            this.pdfViewer.toolbarModule.showToolbar(true);\n          }\n        }\n      }\n    }\n  };\n  /**\n   * @param color\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.modifyColorProperty = function (color) {\n    if (this.currentTextMarkupAnnotation) {\n      var pageAnnotations = this.modifyAnnotationProperty('Color', color, null);\n      this.manageAnnotations(pageAnnotations, this.selectTextMarkupCurrentPage);\n      this.pdfViewer.annotationModule.renderAnnotations(this.selectTextMarkupCurrentPage, null, null, null);\n      this.pdfViewerBase.updateDocumentEditedProperty(true); // eslint-disable-next-line\n\n      var annotation = this.currentTextMarkupAnnotation; // eslint-disable-next-line max-len\n\n      var multiPageCollection = this.multiPageCollectionList(annotation);\n\n      if (multiPageCollection.length > 0) {\n        // eslint-disable-next-line max-len\n        this.pdfViewer.fireAnnotationPropertiesChange(this.selectTextMarkupCurrentPage, annotation.annotName, annotation.textMarkupAnnotationType, true, false, false, false, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex, multiPageCollection);\n        this.currentAnnotationIndex = null;\n      } else {\n        // eslint-disable-next-line max-len\n        this.pdfViewer.fireAnnotationPropertiesChange(this.selectTextMarkupCurrentPage, annotation.annotName, annotation.textMarkupAnnotationType, true, false, false, false, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex);\n        this.currentAnnotationIndex = null;\n      }\n    }\n  };\n  /**\n   * @param args\n   * @param isOpacity\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.modifyOpacityProperty = function (args, isOpacity) {\n    if (this.currentTextMarkupAnnotation) {\n      var pageAnnotations = void 0;\n\n      if (isOpacity) {\n        pageAnnotations = this.modifyAnnotationProperty('Opacity', isOpacity, 'changed');\n      } else {\n        pageAnnotations = this.modifyAnnotationProperty('Opacity', args.value / 100, args.name);\n      }\n\n      if (pageAnnotations) {\n        this.manageAnnotations(pageAnnotations, this.selectTextMarkupCurrentPage);\n        this.pdfViewer.annotationModule.renderAnnotations(this.selectTextMarkupCurrentPage, null, null, null);\n\n        if (isOpacity || args.name === 'changed') {\n          this.pdfViewerBase.updateDocumentEditedProperty(true); // eslint-disable-next-line\n\n          var annotation = this.currentTextMarkupAnnotation; // eslint-disable-next-line max-len\n\n          var multiPageCollection = this.multiPageCollectionList(annotation);\n\n          if (multiPageCollection.length > 0) {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.fireAnnotationPropertiesChange(this.selectTextMarkupCurrentPage, annotation.annotName, annotation.textMarkupAnnotationType, false, true, false, false, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex, multiPageCollection);\n            this.currentAnnotationIndex = null;\n          } else {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.fireAnnotationPropertiesChange(this.selectTextMarkupCurrentPage, annotation.annotName, annotation.textMarkupAnnotationType, false, true, false, false, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex);\n            this.currentAnnotationIndex = null;\n          }\n        }\n      }\n    }\n  };\n  /**\n   * @param property\n   * @param value\n   * @param status\n   * @param annotName\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.modifyAnnotationProperty = function (property, value, status, annotName) {\n    // eslint-disable-next-line\n    var annotation = this.currentTextMarkupAnnotation;\n\n    if (annotation.isMultiSelect && annotation.annotNameCollection) {\n      this.modifyMultiPageAnnotations(annotation, property, value);\n    }\n\n    var pageAnnotations = this.getAnnotations(this.selectTextMarkupCurrentPage, null);\n\n    if (pageAnnotations) {\n      for (var i = 0; i < pageAnnotations.length; i++) {\n        if (JSON.stringify(this.currentTextMarkupAnnotation) === JSON.stringify(pageAnnotations[i])) {\n          if (property === 'Color') {\n            pageAnnotations[i].color = value;\n          } else if (property === 'Opacity') {\n            pageAnnotations[i].opacity = value;\n          } else if (property === 'AnnotationSettings') {\n            pageAnnotations[i].annotationSettings = {\n              isLock: value\n            };\n          }\n\n          pageAnnotations[i].modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n          this.currentAnnotationIndex = i;\n\n          if (status === null || status === 'changed') {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.annotationModule.addAction(this.selectTextMarkupCurrentPage, i, this.currentTextMarkupAnnotation, 'Text Markup Property modified', property);\n          }\n\n          this.currentTextMarkupAnnotation = pageAnnotations[i];\n          this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAnnotationModifiedDate(pageAnnotations[i]);\n          this.pdfViewer.annotationModule.storeAnnotationCollections(pageAnnotations[i], this.selectTextMarkupCurrentPage);\n        }\n      }\n    }\n\n    return pageAnnotations;\n  };\n  /**\n   * @param annotation\n   * @param pageNumber\n   * @param index\n   * @param action\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.undoTextMarkupAction = function (annotation, pageNumber, index, action) {\n    var pageAnnotations = this.getAnnotations(pageNumber, null);\n\n    if (pageAnnotations) {\n      if (action === 'Text Markup Added') {\n        this.pdfViewer.annotation.stickyNotesAnnotationModule.findPosition(pageAnnotations[index], 'textMarkup'); // eslint-disable-next-line\n\n        var removeDiv = document.getElementById(pageAnnotations[index].annotName);\n\n        if (removeDiv) {\n          if (removeDiv.parentElement.childElementCount === 1) {\n            this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAccordionContainer(removeDiv);\n          } else {\n            removeDiv.parentElement.removeChild(removeDiv);\n          }\n        }\n\n        pageAnnotations.splice(index, 1);\n      } else if (action === 'Text Markup Deleted') {\n        // eslint-disable-next-line max-len\n        this.pdfViewer.annotationModule.stickyNotesAnnotationModule.addAnnotationComments(pageNumber, annotation.shapeAnnotationType);\n        pageAnnotations.splice(index, 0, annotation);\n      }\n    }\n\n    this.clearCurrentAnnotation();\n    this.pdfViewerBase.updateDocumentEditedProperty(true);\n    this.manageAnnotations(pageAnnotations, pageNumber);\n    this.pdfViewer.annotationModule.renderAnnotations(pageNumber, null, null, null);\n  };\n  /**\n   * @param annotation\n   * @param pageNumber\n   * @param index\n   * @param property\n   * @param isUndoAction\n   * @param annotation\n   * @param pageNumber\n   * @param index\n   * @param property\n   * @param isUndoAction\n   * @param annotation\n   * @param pageNumber\n   * @param index\n   * @param property\n   * @param isUndoAction\n   * @param annotation\n   * @param pageNumber\n   * @param index\n   * @param property\n   * @param isUndoAction\n   * @private\n   */\n  // eslint-disable-next-line max-len\n\n\n  TextMarkupAnnotation.prototype.undoRedoPropertyChange = function (annotation, pageNumber, index, property, isUndoAction) {\n    var pageAnnotations = this.getAnnotations(pageNumber, null);\n\n    if (pageAnnotations) {\n      if (property === 'Color') {\n        var tempColor = pageAnnotations[index].color;\n        pageAnnotations[index].color = annotation.color;\n        annotation.color = tempColor;\n      } else {\n        var tempOpacity = pageAnnotations[index].opacity;\n        pageAnnotations[index].opacity = annotation.opacity;\n        annotation.opacity = tempOpacity;\n      }\n\n      this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAnnotationModifiedDate(annotation, null, true);\n\n      if (isUndoAction) {\n        annotation.modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n      }\n    }\n\n    this.clearCurrentAnnotation();\n    this.pdfViewerBase.updateDocumentEditedProperty(true);\n    this.manageAnnotations(pageAnnotations, pageNumber);\n    this.pdfViewer.annotationModule.renderAnnotations(pageNumber, null, null, null);\n    return annotation;\n  };\n  /**\n   * @param annotation\n   * @param pageNumber\n   * @param index\n   * @param action\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.redoTextMarkupAction = function (annotation, pageNumber, index, action) {\n    var pageAnnotations = this.getAnnotations(pageNumber, null);\n\n    if (pageAnnotations) {\n      if (action === 'Text Markup Added') {\n        // eslint-disable-next-line max-len\n        this.pdfViewer.annotationModule.stickyNotesAnnotationModule.addAnnotationComments(pageNumber, annotation.shapeAnnotationType);\n        pageAnnotations.push(annotation);\n      } else if (action === 'Text Markup Deleted') {\n        this.pdfViewer.annotation.stickyNotesAnnotationModule.findPosition(pageAnnotations[index], 'textMarkup'); // eslint-disable-next-line\n\n        var removeDiv = document.getElementById(pageAnnotations[index].annotName);\n\n        if (removeDiv) {\n          if (removeDiv.parentElement.childElementCount === 1) {\n            this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAccordionContainer(removeDiv);\n          } else {\n            removeDiv.remove();\n          }\n        }\n\n        pageAnnotations.splice(index, 1);\n      }\n    }\n\n    this.clearCurrentAnnotation();\n    this.pdfViewerBase.updateDocumentEditedProperty(true);\n    this.manageAnnotations(pageAnnotations, pageNumber);\n    this.pdfViewer.annotationModule.renderAnnotations(pageNumber, null, null, null);\n  };\n  /**\n   * @param pageNumber\n   * @param note\n   * @param pageNumber\n   * @param note\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.saveNoteContent = function (pageNumber, note) {\n    var pageAnnotations = this.getAnnotations(pageNumber, null);\n\n    if (pageAnnotations) {\n      for (var i = 0; i < pageAnnotations.length; i++) {\n        if (JSON.stringify(this.currentTextMarkupAnnotation) === JSON.stringify(pageAnnotations[i])) {\n          pageAnnotations[i].note = note;\n        }\n      }\n    }\n\n    this.manageAnnotations(pageAnnotations, pageNumber);\n    this.pdfViewerBase.updateDocumentEditedProperty(true);\n  };\n\n  TextMarkupAnnotation.prototype.clearCurrentAnnotation = function () {\n    if (!this.isExtended) {\n      if (this.pdfViewer.isMaintainSelection && !this.pdfViewer.textSelectionModule.isTextSelection) {\n        this.selectTextMarkupCurrentPage = this.selectTextMarkupCurrentPage;\n        this.currentTextMarkupAnnotation = this.currentTextMarkupAnnotation;\n      } else {\n        this.selectTextMarkupCurrentPage = null;\n        this.currentTextMarkupAnnotation = null;\n      }\n\n      var isSkip = false; // eslint-disable-next-line max-len\n\n      if (this.pdfViewer.annotation.freeTextAnnotationModule && this.pdfViewer.annotation.freeTextAnnotationModule.isInuptBoxInFocus) {\n        isSkip = true;\n      }\n\n      if (!isSkip) {\n        this.enableAnnotationPropertiesTool(false);\n      }\n    }\n  };\n  /**\n   * @param pageNumber\n   * @param isSelect\n   * @param pageNumber\n   * @param isSelect\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.clearCurrentAnnotationSelection = function (pageNumber, isSelect) {\n    if (isSelect) {\n      this.isAnnotationSelect = true;\n    } else {\n      this.isAnnotationSelect = false;\n    }\n\n    var lowerPageIndex = pageNumber - 2 >= 0 ? pageNumber - 2 : 0; // eslint-disable-next-line max-len\n\n    var higherPageIndex = pageNumber + 2 < this.pdfViewerBase.pageCount ? pageNumber + 2 : this.pdfViewerBase.pageCount - 1;\n\n    for (var k = lowerPageIndex; k <= higherPageIndex; k++) {\n      this.clearAnnotationSelection(k);\n    }\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.getBoundsForSave = function (bounds, pageIndex) {\n    // eslint-disable-next-line\n    var newArray = [];\n\n    for (var i = 0; i < bounds.length; i++) {\n      // eslint-disable-next-line\n      var bound = this.getAnnotationBounds(bounds[i], pageIndex);\n      newArray.push(bound);\n    }\n\n    return newArray;\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.getAnnotationBounds = function (bounds, pageIndex) {\n    var left = bounds.left ? bounds.left : bounds.Left;\n    var top = bounds.top ? bounds.top : bounds.Top;\n    var height = bounds.height ? bounds.height : bounds.Height;\n    var width = bounds.width ? bounds.width : bounds.Width;\n    var pageDetails = this.pdfViewerBase.pageSize[pageIndex];\n    left = left ? left : bounds.x;\n    top = top ? top : bounds.y;\n\n    if (pageDetails) {\n      if (pageDetails.rotation === 1) {\n        return {\n          left: top,\n          top: pageDetails.width - (left + width),\n          width: height,\n          height: width\n        };\n      } else if (pageDetails.rotation === 2) {\n        // eslint-disable-next-line max-len\n        return {\n          left: pageDetails.width - left - width,\n          top: pageDetails.height - top - height,\n          width: width,\n          height: height\n        };\n      } else if (pageDetails.rotation === 3) {\n        return {\n          left: pageDetails.height - top - height,\n          top: left,\n          width: height,\n          height: width\n        };\n      } else {\n        return {\n          left: left,\n          top: top,\n          width: width,\n          height: height\n        };\n      }\n    } else {\n      return {\n        left: left,\n        top: top,\n        width: width,\n        height: height\n      };\n    }\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.getRgbCode = function (colorString) {\n    if (!colorString.match(/#([a-z0-9]+)/gi) && !colorString.match(/^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+(?:\\.\\d+)?))?\\)$/)) {\n      colorString = this.pdfViewer.annotationModule.nameToHash(colorString);\n    }\n\n    var markupStringArray = colorString.split(',');\n\n    if (isNullOrUndefined(markupStringArray[1])) {\n      colorString = this.pdfViewer.annotationModule.getValue(colorString, 'rgba');\n      markupStringArray = colorString.split(',');\n    } // eslint-disable-next-line radix\n\n\n    var textMarkupR = parseInt(markupStringArray[0].split('(')[1]); // eslint-disable-next-line radix\n\n    var textMarkupG = parseInt(markupStringArray[1]); // eslint-disable-next-line radix\n\n    var textMarkupB = parseInt(markupStringArray[2]); // eslint-disable-next-line radix\n\n    var textMarkupA = parseInt(markupStringArray[3]);\n    return {\n      a: textMarkupA,\n      r: textMarkupR,\n      g: textMarkupG,\n      b: textMarkupB\n    };\n  };\n\n  TextMarkupAnnotation.prototype.getDrawnBounds = function () {\n    var pageBounds = [];\n    var selection = window.getSelection();\n\n    if (selection.anchorNode !== null) {\n      var range = document.createRange();\n      var isBackWardSelection = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n\n      if (selection.anchorNode === selection.focusNode) {\n        var pageId = this.pdfViewerBase.textLayer.getPageIndex(selection.anchorNode);\n        var startIndex = 0;\n        var endIndex = 0;\n\n        if (!isNaN(pageId)) {\n          var pageRect = this.pdfViewerBase.getElement('_pageDiv_' + pageId).getBoundingClientRect();\n\n          if (this.pdfViewerBase.isMixedSizeDocument) {\n            pageRect = this.pdfViewerBase.getElement('_textLayer_' + pageId).getBoundingClientRect();\n          }\n\n          if (isBackWardSelection) {\n            range.setStart(selection.focusNode, selection.focusOffset);\n            range.setEnd(selection.anchorNode, selection.anchorOffset);\n          } else {\n            if (selection.anchorOffset < selection.focusOffset) {\n              startIndex = selection.anchorOffset;\n              endIndex = selection.focusOffset;\n              range.setStart(selection.anchorNode, selection.anchorOffset);\n              range.setEnd(selection.focusNode, selection.focusOffset);\n            } else {\n              startIndex = selection.focusOffset;\n              endIndex = selection.anchorOffset;\n              range.setStart(selection.focusNode, selection.focusOffset);\n              range.setEnd(selection.anchorNode, selection.anchorOffset);\n            }\n          }\n\n          var boundingRect = range.getBoundingClientRect(); // eslint-disable-next-line\n\n          var indexes = this.getIndexNumbers(pageId, range.toString(), range.commonAncestorContainer.textContent.toString()); // eslint-disable-next-line max-len\n\n          var rectangle = {\n            left: this.getDefaultValue(boundingRect.left - pageRect.left),\n            top: this.getDefaultValue(boundingRect.top - pageRect.top),\n            width: this.getDefaultValue(boundingRect.width),\n            height: this.getDefaultValue(boundingRect.height),\n            right: this.getDefaultValue(boundingRect.right - pageRect.left),\n            bottom: this.getDefaultValue(boundingRect.bottom - pageRect.top)\n          };\n          var rectangleArray = [];\n          rectangleArray.push(rectangle); // eslint-disable-next-line\n\n          var rect = {\n            left: rectangle.left,\n            top: rectangle.top,\n            right: rectangle.right,\n            bottom: rectangle.bottom\n          };\n          pageBounds.push({\n            pageIndex: pageId,\n            bounds: rectangleArray,\n            rect: rect,\n            startIndex: indexes.startIndex,\n            endIndex: indexes.endIndex,\n            textContent: range.toString()\n          });\n        }\n      } else {\n        var startNode = void 0;\n        var endNode = void 0;\n        var selectionStartOffset = void 0;\n        var selectionEndOffset = void 0;\n\n        if (isBackWardSelection) {\n          startNode = selection.focusNode;\n          selectionStartOffset = selection.focusOffset;\n          endNode = selection.anchorNode;\n          selectionEndOffset = selection.anchorOffset;\n        } else {\n          startNode = selection.anchorNode;\n          selectionStartOffset = selection.anchorOffset;\n          endNode = selection.focusNode;\n          selectionEndOffset = selection.focusOffset;\n        }\n\n        var anchorPageId = this.pdfViewerBase.textLayer.getPageIndex(startNode);\n        var anchorTextId = this.pdfViewerBase.textLayer.getTextIndex(startNode, anchorPageId);\n        var focusPageId = this.pdfViewerBase.textLayer.getPageIndex(endNode);\n        var focusTextId = this.pdfViewerBase.textLayer.getTextIndex(endNode, focusPageId);\n        var startOffset = 0;\n        var endOffset = 0;\n        var currentId = 0;\n\n        for (var i = anchorPageId; i <= focusPageId; i++) {\n          var selectionRects = [];\n          var pageStartId = void 0;\n          var pageEndId = void 0;\n          var pageStartOffset = void 0;\n          var pageEndOffset = void 0;\n          var textDivs = this.pdfViewerBase.getElement('_textLayer_' + i).childNodes;\n          var pageRect = this.pdfViewerBase.getElement('_pageDiv_' + i).getBoundingClientRect();\n\n          if (this.pdfViewerBase.isMixedSizeDocument) {\n            pageRect = this.pdfViewerBase.getElement('_textLayer_' + i).getBoundingClientRect();\n          }\n\n          if (i === anchorPageId) {\n            currentId = anchorTextId;\n          } else {\n            currentId = 0;\n          }\n\n          for (var j = currentId; j < textDivs.length; j++) {\n            var textElement = textDivs[j];\n\n            if (j === currentId) {\n              pageStartId = currentId;\n              pageStartOffset = i === anchorPageId ? selectionStartOffset : 0;\n            } else {\n              pageEndId = j;\n              pageEndOffset = i === focusPageId ? selectionEndOffset : textElement.textContent.length;\n            }\n\n            if (j === anchorTextId && i === anchorPageId) {\n              startOffset = selectionStartOffset;\n            } else {\n              startOffset = 0;\n            }\n\n            if (j === focusTextId && i === focusPageId) {\n              endOffset = selectionEndOffset;\n            } else {\n              endOffset = textElement.textContent.length;\n            }\n\n            for (var k = 0; k < textElement.childNodes.length; k++) {\n              var node = textElement.childNodes[k];\n              range.setStart(node, startOffset);\n              range.setEnd(node, endOffset);\n            }\n\n            var boundingRect = range.getBoundingClientRect(); // eslint-disable-next-line max-len\n\n            var rectangle = {\n              left: this.getDefaultValue(boundingRect.left - pageRect.left),\n              top: this.getDefaultValue(boundingRect.top - pageRect.top),\n              width: this.getDefaultValue(boundingRect.width),\n              height: this.getDefaultValue(boundingRect.height),\n              right: this.getDefaultValue(boundingRect.right - pageRect.left),\n              bottom: this.getDefaultValue(boundingRect.bottom - pageRect.top)\n            };\n            selectionRects.push(rectangle);\n            range.detach();\n\n            if (i === focusPageId && j === focusTextId) {\n              break;\n            }\n          }\n\n          if (!pageEndId) {\n            pageEndId = pageStartId;\n          }\n\n          if (!pageEndOffset) {\n            pageEndOffset = endOffset;\n          }\n\n          var startElementNode = this.pdfViewerBase.getElement('_text_' + i + '_' + pageStartId).childNodes[0];\n          var endElementNode = this.pdfViewerBase.getElement('_text_' + i + '_' + pageEndId).childNodes[0];\n          var pageRange = document.createRange();\n          pageRange.setStart(startElementNode, pageStartOffset);\n          pageRange.setEnd(endElementNode, pageEndOffset);\n          var pageRectBounds = pageRange.getBoundingClientRect();\n          var textValue = pageRange.toString(); // eslint-disable-next-line\n\n          var indexes = this.getIndexNumbers(i, textValue); // eslint-disable-next-line max-len\n\n          var pageRectangle = {\n            left: this.getDefaultValue(pageRectBounds.left - pageRect.left),\n            top: this.getDefaultValue(pageRectBounds.top - pageRect.top),\n            width: this.getDefaultValue(pageRectBounds.width),\n            height: this.getDefaultValue(pageRectBounds.height),\n            right: this.getDefaultValue(pageRectBounds.right - pageRect.left),\n            bottom: this.getDefaultValue(pageRectBounds.bottom - pageRect.top)\n          }; // eslint-disable-next-line\n\n          var rect = {\n            left: pageRectangle.left,\n            top: pageRectangle.top,\n            right: pageRectangle.right,\n            bottom: pageRectangle.bottom\n          };\n          pageBounds.push({\n            pageIndex: i,\n            bounds: selectionRects,\n            rect: rect,\n            startIndex: indexes.startIndex,\n            endIndex: indexes.endIndex,\n            textContent: textValue\n          });\n        }\n      }\n    }\n\n    selection.removeAllRanges();\n    return pageBounds;\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.getIndexNumbers = function (pageNumber, content, parentText) {\n    // eslint-disable-next-line\n    var storedData = this.pdfViewerBase.getStoredData(pageNumber);\n    var startIndex;\n    var endIndex;\n\n    if (storedData) {\n      var previousIndex = 0;\n      var pageText = storedData.pageText;\n\n      for (var p = 0; p < pageNumber; p++) {\n        if (this.pdfViewer.isExtractText) {\n          // eslint-disable-next-line\n          var documentIndex = this.pdfViewer.textSearchModule.documentTextCollection[p][p];\n          var pageTextData = documentIndex.pageText ? documentIndex.pageText : documentIndex.PageText; // eslint-disable-next-line max-len\n\n          if (this.pdfViewer.textSearchModule && this.pdfViewer.textSearchModule.documentTextCollection && this.pdfViewer.textSearchModule.isTextRetrieved) {\n            if (this.pdfViewer.textSearchModule.documentTextCollection[p]) {\n              previousIndex = previousIndex + pageTextData.length;\n            }\n          } else {\n            // eslint-disable-next-line max-len\n            if (this.pdfViewer.textSearchModule && this.pdfViewer.textSearchModule.documentTextCollection) {\n              if (pageNumber <= this.pdfViewer.textSearchModule.documentTextCollection.length) {\n                if (this.pdfViewer.textSearchModule.documentTextCollection[p]) {\n                  // eslint-disable-next-line max-len\n                  previousIndex = previousIndex + pageTextData.length;\n                }\n              } else {\n                previousIndex = 0;\n                break;\n              }\n            }\n          }\n        }\n      }\n\n      if (!isNullOrUndefined(parentText)) {\n        var parentIndex = pageText.indexOf(parentText);\n        var initialIndex = parentText.indexOf(content);\n        startIndex = parentIndex + initialIndex + previousIndex;\n      } else {\n        startIndex = pageText.indexOf(content) + previousIndex;\n      }\n\n      endIndex = startIndex + (content.length - 1);\n    }\n\n    return {\n      startIndex: startIndex,\n      endIndex: endIndex\n    };\n  };\n  /**\n   * @param pageNumber\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.rerenderAnnotationsPinch = function (pageNumber) {\n    var annotCanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n\n    if (annotCanvas) {\n      var oldAnnotCanvas = this.pdfViewerBase.getElement('_old_annotationCanvas_' + pageNumber);\n\n      if (oldAnnotCanvas) {\n        if (annotCanvas) {\n          oldAnnotCanvas.id = annotCanvas.id;\n          annotCanvas.parentElement.removeChild(annotCanvas);\n        } else {\n          oldAnnotCanvas.id = this.pdfViewer.element.id + '_annotationCanvas_' + pageNumber;\n        }\n\n        annotCanvas = oldAnnotCanvas;\n      }\n\n      annotCanvas.style.width = '';\n      annotCanvas.style.height = '';\n\n      if (this.pdfViewer.restrictZoomRequest) {\n        // eslint-disable-next-line max-len\n        annotCanvas.style.width = this.pdfViewerBase.pageSize[pageNumber].width * this.pdfViewerBase.getZoomFactor() + 'px'; // eslint-disable-next-line max-len\n\n        annotCanvas.style.height = this.pdfViewerBase.pageSize[pageNumber].height * this.pdfViewerBase.getZoomFactor() + 'px';\n      } else {\n        // eslint-disable-next-line max-len\n        annotCanvas.width = this.pdfViewerBase.pageSize[pageNumber].width * this.pdfViewerBase.getZoomFactor();\n        annotCanvas.height = this.pdfViewerBase.pageSize[pageNumber].height * this.pdfViewerBase.getZoomFactor();\n      }\n\n      this.renderTextMarkupAnnotations(null, pageNumber, annotCanvas, this.pdfViewerBase.getZoomFactor());\n    }\n  };\n  /**\n   * @param pageNumber\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.rerenderAnnotations = function (pageNumber) {\n    // eslint-disable-next-line\n    var oldCanvasCollection = document.querySelectorAll('#' + this.pdfViewer.element.id + '_old_annotationCanvas_' + pageNumber);\n\n    for (var i = 0; i < oldCanvasCollection.length; i++) {\n      if (oldCanvasCollection[i]) {\n        oldCanvasCollection[i].parentElement.removeChild(oldCanvasCollection[i]);\n      }\n    }\n\n    var newCanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n\n    if (newCanvas) {\n      newCanvas.style.display = 'block';\n    }\n  };\n  /**\n   * @param event\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.onTextMarkupAnnotationMouseUp = function (event) {\n    var pageNumber = this.pdfViewer.annotationModule.getEventPageNumber(event);\n\n    if (!isNullOrUndefined(pageNumber) && !isNaN(pageNumber)) {\n      var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n\n      if (this.currentTextMarkupAnnotation) {\n        this.selectedTextMarkup = this.currentTextMarkupAnnotation;\n      } else {\n        this.selectedTextMarkup = null;\n      }\n\n      this.clearCurrentSelectedAnnotation();\n      var currentAnnot = this.getCurrentMarkupAnnotation(event.clientX, event.clientY, pageNumber, canvas);\n\n      if (currentAnnot && !window.getSelection().toString()) {\n        var isLock = false;\n        var isSelection = false;\n\n        if (currentAnnot.annotationSettings && currentAnnot.annotationSettings.isLock) {\n          isLock = currentAnnot.annotationSettings.isLock;\n\n          if (isLock && this.pdfViewer.annotationModule.checkAllowedInteractions('Select', currentAnnot)) {\n            isLock = false;\n\n            if (this.pdfViewer.annotationModule.checkAllowedInteractions('PropertyChange', currentAnnot)) {\n              isSelection = false;\n            } else {\n              isSelection = true;\n            }\n          }\n        }\n\n        if (!isLock) {\n          var canvasParentPosition = canvas.parentElement.getBoundingClientRect();\n          var leftClickPosition = event.clientX - canvasParentPosition.left;\n          var topClickPosition = event.clientY - canvasParentPosition.top;\n          this.annotationClickPosition = {\n            x: leftClickPosition,\n            y: topClickPosition\n          };\n          this.selectAnnotation(currentAnnot, canvas, pageNumber, event);\n\n          if (Browser.isDevice && !this.pdfViewer.enableDesktopMode && this.pdfViewer.enableToolbar && this.pdfViewer.enableAnnotationToolbar) {\n            this.pdfViewer.toolbarModule.annotationToolbarModule.createPropertyTools(this.currentTextMarkupAnnotation.textMarkupAnnotationType);\n          }\n\n          this.currentTextMarkupAnnotation = currentAnnot;\n          this.selectTextMarkupCurrentPage = pageNumber;\n\n          if (!isSelection) {\n            this.enableAnnotationPropertiesTool(true);\n          }\n\n          var commentPanelDiv = document.getElementById(this.pdfViewer.element.id + '_commantPanel');\n\n          if (commentPanelDiv && commentPanelDiv.style.display === 'block') {\n            // eslint-disable-next-line\n            var accordionExpand = document.getElementById(this.pdfViewer.element.id + '_accordionContainer' + (pageNumber + 1));\n\n            if (accordionExpand) {\n              accordionExpand.ej2_instances[0].expandItem(true);\n            } // eslint-disable-next-line\n\n\n            var comments = document.getElementById(currentAnnot.annotName);\n\n            if (comments) {\n              comments.firstChild.click();\n            }\n          }\n\n          if (!isBlazor()) {\n            if (this.pdfViewer.toolbarModule && this.pdfViewer.enableAnnotationToolbar) {\n              this.pdfViewer.toolbarModule.annotationToolbarModule.isToolbarHidden = true; // eslint-disable-next-line max-len\n\n              this.pdfViewer.toolbarModule.annotationToolbarModule.showAnnotationToolbar(this.pdfViewer.toolbarModule.annotationItem);\n            }\n          }\n        }\n      } else {\n        this.clearCurrentAnnotation();\n      }\n\n      if (this.pdfViewer.isMaintainSelection && !this.pdfViewer.textSelectionModule.isTextSelection) {\n        if (currentAnnot) {\n          this.clearCurrentAnnotationSelection(pageNumber);\n        }\n      } else {\n        this.clearCurrentAnnotationSelection(pageNumber);\n      }\n    } else {\n      if (!this.pdfViewerBase.isClickedOnScrollBar(event, true)) {\n        this.clearCurrentAnnotation();\n        this.clearCurrentAnnotationSelection(pageNumber);\n      }\n    }\n  };\n  /**\n   * @param event\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.onTextMarkupAnnotationTouchEnd = function (event) {\n    var pageNumber = this.pdfViewer.annotationModule.getEventPageNumber(event);\n\n    if (!isNullOrUndefined(pageNumber) && !isNaN(pageNumber)) {\n      if (this.currentTextMarkupAnnotation) {\n        this.selectedTextMarkup = this.currentTextMarkupAnnotation;\n      } else {\n        this.selectedTextMarkup = null;\n      }\n\n      this.clearCurrentAnnotationSelection(pageNumber);\n      var touchCanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n      this.clearCurrentSelectedAnnotation(); // eslint-disable-next-line max-len\n\n      var currentAnnot = this.getCurrentMarkupAnnotation(event.touches[0].clientX, event.touches[0].clientY, pageNumber, touchCanvas);\n\n      if (currentAnnot) {\n        var isLock = false;\n\n        if (currentAnnot.annotationSettings && currentAnnot.annotationSettings.isLock) {\n          isLock = currentAnnot.annotationSettings.isLock;\n        }\n\n        if (!isLock) {\n          var canvasParentPosition = touchCanvas.parentElement.getBoundingClientRect();\n          var leftClickPosition = event.touches[0].clientX - canvasParentPosition.left;\n          var topClickPosition = event.touches[0].clientY - canvasParentPosition.top;\n          this.annotationClickPosition = {\n            x: leftClickPosition,\n            y: topClickPosition\n          };\n          this.selectAnnotation(currentAnnot, touchCanvas, pageNumber, event);\n\n          if (Browser.isDevice && !this.pdfViewer.enableDesktopMode && this.pdfViewer.enableToolbar && this.pdfViewer.enableAnnotationToolbar) {\n            this.pdfViewer.toolbarModule.annotationToolbarModule.createPropertyTools(this.currentTextMarkupAnnotation.textMarkupAnnotationType);\n          }\n\n          this.currentTextMarkupAnnotation = currentAnnot;\n          this.selectTextMarkupCurrentPage = pageNumber;\n          this.enableAnnotationPropertiesTool(true); // eslint-disable-next-line\n\n          var accordionExpand = document.getElementById(this.pdfViewer.element.id + '_accordionContainer' + (pageNumber + 1));\n\n          if (accordionExpand) {\n            accordionExpand.ej2_instances[0].expandItem(true);\n          } // eslint-disable-next-line\n\n\n          var comments = document.getElementById(currentAnnot.annotName);\n\n          if (comments) {\n            if (!Browser.isDevice) {\n              comments.firstChild.click();\n            }\n          }\n        }\n      } else {\n        this.clearCurrentAnnotation();\n      }\n\n      this.clearCurrentAnnotationSelection(pageNumber);\n    } else if (this.selectTextMarkupCurrentPage != null && Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n      var number = this.selectTextMarkupCurrentPage;\n      this.selectTextMarkupCurrentPage = null;\n      this.clearAnnotationSelection(number);\n    } else {\n      this.clearCurrentAnnotation();\n      this.clearCurrentAnnotationSelection(pageNumber);\n    }\n  };\n  /**\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.clearCurrentSelectedAnnotation = function () {\n    if (this.currentTextMarkupAnnotation) {\n      this.clearAnnotationSelection(this.selectTextMarkupCurrentPage); // eslint-disable-next-line\n\n      var currentAnnot = this.currentTextMarkupAnnotation;\n      this.pdfViewer.fireAnnotationUnSelect(currentAnnot.annotName, currentAnnot.pageNumber, currentAnnot);\n      this.clearCurrentAnnotation();\n    }\n  };\n  /**\n   * @param event\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.onTextMarkupAnnotationMouseMove = function (event) {\n    var eventTarget = event.target; // eslint-disable-next-line\n\n    var pageIndex = parseInt(eventTarget.id.split('_text_')[1]) || parseInt(eventTarget.id.split('_textLayer_')[1]) || parseInt(eventTarget.id.split('_annotationCanvas_')[1]);\n\n    if (event.target && (eventTarget.id.indexOf('_text') > -1 || eventTarget.id.indexOf('_annotationCanvas') > -1 || eventTarget.classList.contains('e-pv-hyperlink')) && this.pdfViewer.annotation) {\n      pageIndex = this.pdfViewer.annotation.getEventPageNumber(event);\n      var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageIndex);\n      var currentAnnot = this.getCurrentMarkupAnnotation(event.clientX, event.clientY, pageIndex, canvas);\n\n      if (currentAnnot) {\n        eventTarget.style.cursor = 'pointer'; // eslint-disable-next-line\n\n        var currentPosition = this.pdfViewerBase.getMousePosition(event); // eslint-disable-next-line\n\n        var relativePosition = this.pdfViewerBase.relativePosition(event); // eslint-disable-next-line\n\n        var viewerPositions = {\n          left: relativePosition.x,\n          top: relativePosition.y\n        }; // eslint-disable-next-line\n\n        var mousePositions = {\n          left: currentPosition.x,\n          top: currentPosition.y\n        }; // eslint-disable-next-line\n\n        var annotationSettings = {\n          opacity: currentAnnot.opacity,\n          color: currentAnnot.color,\n          author: currentAnnot.author,\n          subject: currentAnnot.subject,\n          modifiedDate: currentAnnot.modifiedDate\n        }; // eslint-disable-next-line max-len\n\n        this.pdfViewerBase.isMousedOver = true;\n        this.pdfViewer.fireAnnotationMouseover(currentAnnot.annotName, currentAnnot.pageNumber, currentAnnot.textMarkupAnnotationType, currentAnnot.bounds, annotationSettings, mousePositions, viewerPositions); // this.showPopupNote(event, currentAnnot);\n      } else {\n        this.pdfViewer.annotationModule.hidePopupNote();\n\n        if (this.pdfViewerBase.isPanMode && !this.pdfViewerBase.getAnnotationToolStatus()) {\n          eventTarget.style.cursor = 'grab';\n        }\n\n        if (this.pdfViewerBase.isMousedOver && !this.pdfViewerBase.isFormFieldMousedOver) {\n          this.pdfViewer.fireAnnotationMouseLeave(pageIndex);\n          this.pdfViewerBase.isMousedOver = false;\n        }\n      }\n    }\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.showPopupNote = function (event, annotation) {\n    if (annotation.note) {\n      // eslint-disable-next-line max-len\n      this.pdfViewer.annotationModule.showPopupNote(event, annotation.color, annotation.author, annotation.note, annotation.textMarkupAnnotationType);\n    }\n  };\n\n  TextMarkupAnnotation.prototype.getCurrentMarkupAnnotation = function (clientX, clientY, pageNumber, canvas) {\n    var currentTextMarkupAnnotations = [];\n\n    if (canvas) {\n      var canvasParentPosition = canvas.parentElement.getBoundingClientRect();\n\n      if (canvas.clientWidth !== canvas.parentElement.clientWidth) {\n        canvasParentPosition = canvas.getBoundingClientRect();\n      }\n\n      var leftClickPosition = clientX - canvasParentPosition.left;\n      var topClickPosition = clientY - canvasParentPosition.top;\n      var annotationList = this.getAnnotations(pageNumber, null);\n      var isAnnotationGot = false;\n\n      if (annotationList) {\n        for (var i = 0; i < annotationList.length; i++) {\n          var annotation = annotationList[i];\n\n          for (var j = 0; j < annotation.bounds.length; j++) {\n            // eslint-disable-next-line\n            var bound = annotation.bounds[j];\n            var left = bound.left ? bound.left : bound.Left;\n            var top_2 = bound.top ? bound.top : bound.Top;\n            var width = bound.width ? bound.width : bound.Width;\n            var height = bound.height ? bound.height : bound.Height; // eslint-disable-next-line max-len\n\n            if (leftClickPosition >= this.getMagnifiedValue(left, this.pdfViewerBase.getZoomFactor()) && leftClickPosition <= this.getMagnifiedValue(left + width, this.pdfViewerBase.getZoomFactor()) && topClickPosition >= this.getMagnifiedValue(top_2, this.pdfViewerBase.getZoomFactor()) && topClickPosition <= this.getMagnifiedValue(top_2 + height, this.pdfViewerBase.getZoomFactor())) {\n              currentTextMarkupAnnotations.push(annotation);\n              isAnnotationGot = true;\n            } else {\n              if (isAnnotationGot) {\n                isAnnotationGot = false;\n                break;\n              }\n            }\n          }\n        }\n      }\n\n      var currentAnnot = null;\n\n      if (currentTextMarkupAnnotations.length > 1) {\n        currentAnnot = this.compareCurrentAnnotations(currentTextMarkupAnnotations);\n      } else if (currentTextMarkupAnnotations.length === 1) {\n        currentAnnot = currentTextMarkupAnnotations[0];\n      }\n\n      return currentAnnot;\n    } else {\n      return null;\n    }\n  };\n\n  TextMarkupAnnotation.prototype.compareCurrentAnnotations = function (annotations) {\n    var previousX;\n    var currentAnnotation = null;\n\n    for (var i = 0; i < annotations.length; i++) {\n      if (i === annotations.length - 1) {\n        break;\n      } // eslint-disable-next-line\n\n\n      var firstAnnotBounds = annotations[i].bounds;\n      var firstXposition = firstAnnotBounds[0].left ? firstAnnotBounds[0].left : firstAnnotBounds[0].Left;\n      var firstYposition = firstAnnotBounds[0].top ? firstAnnotBounds[0].top : firstAnnotBounds[0].Top; // eslint-disable-next-line\n\n      var secondAnnotBounds = annotations[i + 1].bounds;\n      var secondXposition = secondAnnotBounds[0].left ? secondAnnotBounds[0].left : secondAnnotBounds[0].Left;\n      var secondYposition = secondAnnotBounds[0].top ? secondAnnotBounds[0].top : secondAnnotBounds[0].Top;\n\n      if (firstXposition < secondXposition || firstYposition < secondYposition) {\n        previousX = secondXposition;\n        currentAnnotation = annotations[i + 1];\n      } else {\n        previousX = firstXposition;\n        currentAnnotation = annotations[i];\n      }\n\n      if (previousX && i === annotations.length - 2) {\n        if (previousX === firstXposition && previousX === secondXposition) {\n          previousX = secondXposition;\n          currentAnnotation = annotations[i + 1];\n        }\n      }\n    }\n\n    return currentAnnotation;\n  };\n  /**\n   * @param pageNumber\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.clearAnnotationSelection = function (pageNumber) {\n    var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n\n    if (canvas) {\n      var context = canvas.getContext('2d');\n      context.setLineDash([]);\n      this.pdfViewer.annotationModule.renderAnnotations(pageNumber, null, null, null);\n    }\n  };\n  /**\n   * @param annotation\n   * @param canvas\n   * @param pageNumber\n   * @param event\n   * @param isProgrammaticSelection\n   * @param annotation\n   * @param canvas\n   * @param pageNumber\n   * @param event\n   * @param isProgrammaticSelection\n   * @private\n   */\n  // eslint-disable-next-line max-len\n\n\n  TextMarkupAnnotation.prototype.selectAnnotation = function (annotation, canvas, pageNumber, event, isProgrammaticSelection) {\n    if (this.pdfViewer.selectedItems.annotations[0]) {\n      this.pdfViewer.clearSelection(this.pdfViewer.selectedItems.annotations[0].pageIndex);\n      this.pdfViewer.clearSelection(this.selectTextMarkupCurrentPage);\n    }\n\n    var isLock = false;\n\n    if (annotation.annotationSettings && annotation.annotationSettings.isLock) {\n      isLock = annotation.annotationSettings.isLock;\n\n      if (isLock && this.pdfViewer.annotationModule.checkAllowedInteractions('Select', annotation)) {\n        isLock = false;\n      }\n    }\n\n    if (!isLock) {\n      var isCurrentTextMarkup = false;\n\n      if (!this.currentTextMarkupAnnotation) {\n        isCurrentTextMarkup = true;\n      }\n\n      if (this.selectedTextMarkup && annotation && !isProgrammaticSelection) {\n        if (this.selectedTextMarkup.annotName === annotation.annotName) {\n          isCurrentTextMarkup = false;\n        } else {\n          isCurrentTextMarkup = true;\n        }\n      }\n\n      if (!isNaN(pageNumber)) {\n        this.selectTextMarkupCurrentPage = pageNumber;\n        this.currentTextMarkupAnnotation = annotation;\n        annotation = this.retreiveTextIndex(annotation);\n        this.currentTextMarkupAnnotation = annotation;\n      }\n\n      if (this.isSelectedAnnotation && this.pdfViewer.textSelectionModule) {\n        this.pdfViewerBase.isSelection = true;\n        this.updateAnnotationBounds();\n      } // eslint-disable-next-line\n\n\n      var currentEvent = event;\n\n      if (this.isEnableTextMarkupResizer(annotation.textMarkupAnnotationType) && annotation && currentEvent && !currentEvent.touches) {\n        this.updateCurrentResizerPosition(annotation);\n      }\n\n      this.drawAnnotationSelector(annotation, this.currentTextMarkupAnnotation, canvas);\n\n      if (annotation.isMultiSelect && annotation.annotNameCollection) {\n        this.selectMultiPageAnnotations(annotation);\n      }\n\n      if (annotation.annotName !== '' && !this.isNewAnnotation) {\n        if (isCurrentTextMarkup) {\n          var isSelected = false;\n\n          if (!currentEvent) {\n            isSelected = true;\n          } // eslint-disable-next-line max-len\n\n\n          this.pdfViewer.annotationModule.annotationSelect(annotation.annotName, this.selectTextMarkupCurrentPage, annotation, null, false, isSelected);\n          this.selectedTextMarkup = null;\n        }\n      }\n\n      if (annotation && this.isEnableTextMarkupResizer(annotation.textMarkupAnnotationType)) {\n        this.isTextMarkupAnnotationMode = true;\n      }\n    }\n  };\n  /**\n   * @param annotation\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.updateCurrentResizerPosition = function (annotation) {\n    if (!annotation) {\n      annotation = this.currentTextMarkupAnnotation;\n    }\n\n    if (annotation) {\n      if (this.isEnableTextMarkupResizer(annotation.textMarkupAnnotationType) && annotation) {\n        // eslint-disable-next-line\n        var textElement = this.pdfViewerBase.getElement('_textLayer_' + this.selectTextMarkupCurrentPage);\n\n        if (textElement) {\n          // eslint-disable-next-line\n          var boundingRect = textElement.getBoundingClientRect();\n          var left = annotation.bounds[0].left ? annotation.bounds[0].left : annotation.bounds[0].Left;\n          var top_3 = annotation.bounds[0].top ? annotation.bounds[0].top : annotation.bounds[0].Top;\n          this.updateLeftposition(left * this.pdfViewerBase.getZoomFactor() + boundingRect.left, boundingRect.top + top_3, true); // eslint-disable-next-line\n\n          var endPosition = annotation.bounds[annotation.bounds.length - 1];\n          var endLeft = endPosition.left ? endPosition.left : endPosition.Left;\n          var endTop = endPosition.top ? endPosition.top : endPosition.Top;\n          var endWidth = endPosition.width ? endPosition.width : endPosition.Width; // eslint-disable-next-line max-len\n\n          this.updatePosition((endLeft + endWidth) * this.pdfViewerBase.getZoomFactor() + boundingRect.left, endTop + boundingRect.top, true);\n        }\n      }\n    }\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.drawAnnotationSelectRect = function (canvas, x, y, width, height, annotation) {\n    var ratio = this.pdfViewerBase.getZoomRatio();\n\n    if (canvas) {\n      var context = canvas.getContext('2d');\n      context.setTransform(1, 0, 0, 1, 0, 0);\n      context.beginPath();\n\n      if (typeof annotation.annotationSelectorSettings === 'string') {\n        // eslint-disable-next-line max-len\n        var lineDash = JSON.parse(annotation.annotationSelectorSettings).selectorLineDashArray.length === 0 ? [4] : JSON.parse(annotation.annotationSelectorSettings).selectorLineDashArray;\n\n        if (lineDash.length > 2) {\n          lineDash = [lineDash[0], lineDash[1]];\n        }\n\n        context.setLineDash(lineDash);\n        context.globalAlpha = 1;\n        context.rect(x * ratio, y * ratio, width * ratio, height * ratio);\n        context.closePath(); // eslint-disable-next-line max-len\n\n        var borderColor = JSON.parse(annotation.annotationSelectorSettings).selectionBorderColor === '' ? '#0000ff' : JSON.parse(annotation.annotationSelectorSettings).selectionBorderColor;\n        context.strokeStyle = borderColor; // eslint-disable-next-line max-len\n\n        context.lineWidth = JSON.parse(annotation.annotationSelectorSettings).selectionBorderThickness === 1 ? 1 : annotation.annotationSelectorSettings.selectionBorderThickness;\n        context.stroke();\n        context.save();\n      } else {\n        // eslint-disable-next-line max-len\n        var lineDash = annotation.annotationSelectorSettings.selectorLineDashArray.length === 0 ? [4] : annotation.annotationSelectorSettings.selectorLineDashArray;\n\n        if (lineDash.length > 2) {\n          lineDash = [lineDash[0], lineDash[1]];\n        }\n\n        context.setLineDash(lineDash);\n        context.globalAlpha = 1;\n        context.rect(x * ratio, y * ratio, width * ratio, height * ratio);\n        context.closePath(); // eslint-disable-next-line max-len\n\n        var borderColor = annotation.annotationSelectorSettings.selectionBorderColor === '' ? '#0000ff' : annotation.annotationSelectorSettings.selectionBorderColor;\n        context.strokeStyle = borderColor; // eslint-disable-next-line max-len\n\n        context.lineWidth = annotation.annotationSelectorSettings.selectionBorderThickness ? 1 : annotation.annotationSelectorSettings.selectionBorderThickness;\n        context.stroke();\n        context.save();\n      }\n    }\n  };\n  /**\n   * @param isEnable\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.enableAnnotationPropertiesTool = function (isEnable) {\n    if (this.pdfViewer.toolbarModule && this.pdfViewer.toolbarModule.annotationToolbarModule) {\n      // eslint-disable-next-line max-len\n      this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElementInBlazor = this.pdfViewer.element.querySelector('.e-pv-annotation-color-container');\n    } // eslint-disable-next-line max-len\n\n\n    if (this.pdfViewer.toolbarModule && this.pdfViewer.toolbarModule.annotationToolbarModule) {\n      if (!Browser.isDevice) {\n        this.pdfViewer.toolbarModule.annotationToolbarModule.createMobileAnnotationToolbar(isEnable);\n      }\n    } // eslint-disable-next-line max-len\n\n\n    if (this.pdfViewer.toolbarModule && this.pdfViewer.toolbarModule.annotationToolbarModule && this.pdfViewer.toolbarModule.annotationToolbarModule.isMobileAnnotEnabled && this.pdfViewer.selectedItems.annotations.length === 0) {\n      if (this.pdfViewer.toolbarModule.annotationToolbarModule) {\n        this.pdfViewer.toolbarModule.annotationToolbarModule.selectAnnotationDeleteItem(isEnable);\n        var enable = isEnable;\n\n        if (this.isTextMarkupAnnotationMode) {\n          enable = true;\n        }\n\n        this.pdfViewer.toolbarModule.annotationToolbarModule.enableTextMarkupAnnotationPropertiesTools(enable);\n\n        if (this.currentTextMarkupAnnotation) {\n          if (!isBlazor()) {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.toolbarModule.annotationToolbarModule.updateColorInIcon(this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElement, this.currentTextMarkupAnnotation.color);\n          } else {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.toolbarModule.annotationToolbarModule.updateColorInIcon(this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElementInBlazor, this.currentTextMarkupAnnotation.color);\n          }\n        } else {\n          if (!isNullOrUndefined(this.isTextMarkupAnnotationMode) && !this.isTextMarkupAnnotationMode) {\n            if (!isBlazor()) {\n              // eslint-disable-next-line max-len\n              this.pdfViewer.toolbarModule.annotationToolbarModule.updateColorInIcon(this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElement, '#000000');\n            } else {\n              // eslint-disable-next-line max-len\n              this.pdfViewer.toolbarModule.annotationToolbarModule.updateColorInIcon(this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElementInBlazor, '#000000');\n            }\n          } else {\n            this.pdfViewer.toolbarModule.annotationToolbarModule.setCurrentColorInPicker();\n          }\n        }\n      }\n    }\n  };\n  /**\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.maintainAnnotationSelection = function () {\n    if (this.currentTextMarkupAnnotation) {\n      var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + this.selectTextMarkupCurrentPage);\n\n      if (canvas) {\n        this.selectAnnotation(this.currentTextMarkupAnnotation, canvas, this.selectTextMarkupCurrentPage);\n      }\n    }\n  }; // private storeAnnotations(pageNumber: number, annotation: ITextMarkupAnnotation): number {\n  // eslint-disable-next-line\n  //     let storeObject: any = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n  //     let index: number = 0;\n  //     if (!storeObject) {\n  //         let markupAnnotation: IPageAnnotations = { pageIndex: pageNumber, annotations: [] };\n  //         markupAnnotation.annotations.push(annotation);\n  //         index = markupAnnotation.annotations.indexOf(annotation);\n  //         let annotationCollection: IPageAnnotations[] = [];\n  //         annotationCollection.push(markupAnnotation);\n  //         let annotationStringified: string = JSON.stringify(annotationCollection);\n  //         window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_textMarkup', annotationStringified);\n  //     } else {\n  //         let annotObject: IPageAnnotations[] = JSON.parse(storeObject);\n  //         window.sessionStorage.removeItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n  //         let pageIndex: number = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageNumber);\n  //         if (annotObject[pageIndex]) {\n  //             (annotObject[pageIndex] as IPageAnnotations).annotations.push(annotation);\n  //             index = (annotObject[pageIndex] as IPageAnnotations).annotations.indexOf(annotation);\n  //         } else {\n  //             let markupAnnotation: IPageAnnotations = { pageIndex: pageNumber, annotations: [] };\n  //             markupAnnotation.annotations.push(annotation);\n  //             index = markupAnnotation.annotations.indexOf(annotation);\n  //             annotObject.push(markupAnnotation);\n  //         }\n  //         let annotationStringified: string = JSON.stringify(annotObject);\n  //         window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_textMarkup', annotationStringified);\n  //     }\n  //     return index;\n  // }\n\n  /**\n   * @param pageAnnotations\n   * @param pageNumber\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.manageAnnotations = function (pageAnnotations, pageNumber) {\n    // eslint-disable-next-line\n    var storeObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n\n    if (this.pdfViewerBase.isStorageExceed) {\n      storeObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_textMarkup'];\n    }\n\n    if (storeObject) {\n      var annotObject = JSON.parse(storeObject);\n\n      if (!this.pdfViewerBase.isStorageExceed) {\n        window.sessionStorage.removeItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n      }\n\n      var index = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageNumber);\n\n      if (annotObject[index]) {\n        annotObject[index].annotations = pageAnnotations;\n      }\n\n      var annotationStringified = JSON.stringify(annotObject);\n\n      if (this.pdfViewerBase.isStorageExceed) {\n        this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_textMarkup'] = annotationStringified;\n      } else {\n        window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_textMarkup', annotationStringified);\n      }\n    }\n  };\n  /**\n   * @param pageIndex\n   * @param textMarkupAnnotations\n   * @param id\n   * @param pageIndex\n   * @param textMarkupAnnotations\n   * @param id\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.getAnnotations = function (pageIndex, textMarkupAnnotations, id) {\n    // eslint-disable-next-line\n    var annotationCollection; // eslint-disable-next-line\n\n    if (id == null || id == undefined) {\n      id = '_annotations_textMarkup';\n    } // eslint-disable-next-line\n\n\n    var storeObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + id);\n\n    if (this.pdfViewerBase.isStorageExceed) {\n      storeObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + id];\n    }\n\n    if (storeObject) {\n      var annotObject = JSON.parse(storeObject);\n      var index = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageIndex);\n\n      if (annotObject[index]) {\n        annotationCollection = annotObject[index].annotations;\n      } else {\n        annotationCollection = textMarkupAnnotations;\n      }\n    } else {\n      annotationCollection = textMarkupAnnotations;\n    }\n\n    return annotationCollection;\n  }; // eslint-disable-next-line max-len\n  // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.getAddedAnnotation = function (type, color, opacity, bounds, author, subject, predefinedDate, note, isCommentLock, rect, pageNumber, textContent, startIndex, endIndex, isMultiSelect, allowedInteractions) {\n    // eslint-disable-next-line max-len\n    var modifiedDate = predefinedDate ? predefinedDate : this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n    var annotationName = this.pdfViewer.annotation.createGUID();\n    var commentsDivid = this.pdfViewer.annotation.stickyNotesAnnotationModule.addComments('textMarkup', pageNumber + 1, type);\n\n    if (commentsDivid) {\n      document.getElementById(commentsDivid).id = annotationName;\n    } // eslint-disable-next-line\n\n\n    var annotationSettings = this.getAnnotationSettings(type);\n    var isPrint = this.getIsPrintValue(type);\n    var annotation = {\n      // eslint-disable-next-line max-len\n      textMarkupAnnotationType: type,\n      color: color,\n      opacity: opacity,\n      bounds: bounds,\n      author: author,\n      allowedInteractions: allowedInteractions,\n      subject: subject,\n      modifiedDate: modifiedDate,\n      note: note,\n      rect: rect,\n      annotName: annotationName,\n      comments: [],\n      review: {\n        state: '',\n        stateModel: '',\n        author: author,\n        modifiedDate: modifiedDate\n      },\n      shapeAnnotationType: 'textMarkup',\n      pageNumber: pageNumber,\n      // eslint-disable-next-line max-len\n      textMarkupContent: textContent,\n      textMarkupStartIndex: startIndex,\n      textMarkupEndIndex: endIndex,\n      isMultiSelect: isMultiSelect,\n      annotationSelectorSettings: this.getSelector(type),\n      customData: this.pdfViewer.annotation.getTextMarkupData(subject),\n      annotationAddMode: this.annotationAddMode,\n      annotationSettings: annotationSettings,\n      isPrint: isPrint,\n      isCommentLock: isCommentLock,\n      isAnnotationRotated: false\n    };\n\n    if (isMultiSelect) {\n      this.multiPageCollection.push(annotation);\n    }\n\n    var isSkip = false;\n\n    if (isMultiSelect && this.isExtended) {\n      isSkip = true;\n    }\n\n    if (document.getElementById(annotationName) && !isSkip) {\n      document.getElementById(annotationName).addEventListener('mouseup', this.annotationDivSelect(annotation, pageNumber));\n    }\n\n    var storedIndex = this.pdfViewer.annotationModule.storeAnnotations(pageNumber, annotation, '_annotations_textMarkup');\n    this.pdfViewer.annotationModule.addAction(pageNumber, storedIndex, annotation, 'Text Markup Added', null);\n    return annotation;\n  };\n\n  TextMarkupAnnotation.prototype.getSelector = function (type) {\n    var selector = this.pdfViewer.annotationSelectorSettings;\n\n    if (type === 'Highlight' && this.pdfViewer.highlightSettings.annotationSelectorSettings) {\n      selector = this.pdfViewer.highlightSettings.annotationSelectorSettings;\n    } else if (type === 'Underline' && this.pdfViewer.underlineSettings.annotationSelectorSettings) {\n      selector = this.pdfViewer.underlineSettings.annotationSelectorSettings;\n    } else if (type === 'Strikethrough' && this.pdfViewer.strikethroughSettings.annotationSelectorSettings) {\n      selector = this.pdfViewer.strikethroughSettings.annotationSelectorSettings;\n    }\n\n    return selector;\n  };\n\n  TextMarkupAnnotation.prototype.getAnnotationSettings = function (type) {\n    var annotationSettings = {\n      isLock: false\n    };\n\n    if (type === 'Highlight' && this.pdfViewer.highlightSettings.isLock) {\n      annotationSettings = {\n        isLock: true\n      };\n    } else if (type === 'Underline' && this.pdfViewer.underlineSettings.isLock) {\n      annotationSettings = {\n        isLock: true\n      };\n    } else if (type === 'Strikethrough' && this.pdfViewer.strikethroughSettings.isLock) {\n      annotationSettings = {\n        isLock: true\n      };\n    } else if (this.pdfViewer.annotationSettings.isLock) {\n      annotationSettings = {\n        isLock: true\n      };\n    }\n\n    return annotationSettings;\n  };\n\n  TextMarkupAnnotation.prototype.getIsPrintValue = function (type) {\n    var isPrint = true;\n\n    if (type === 'Highlight') {\n      isPrint = this.pdfViewer.highlightSettings.isPrint;\n    }\n\n    if (type === 'Underline') {\n      isPrint = this.pdfViewer.underlineSettings.isPrint;\n    }\n\n    if (type === 'Strikethrough') {\n      isPrint = this.pdfViewer.strikethroughSettings.isPrint;\n    }\n\n    return isPrint;\n  }; // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.annotationDivSelect = function (annotation, pageNumber) {\n    var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n    this.selectAnnotation(annotation, canvas, pageNumber);\n\n    if (this.pdfViewer.toolbarModule) {\n      if (this.pdfViewer.toolbarModule.annotationToolbarModule && this.pdfViewer.enableAnnotationToolbar) {\n        this.pdfViewer.toolbarModule.annotationToolbarModule.clearShapeMode();\n        this.pdfViewer.toolbarModule.annotationToolbarModule.clearMeasureMode();\n        var isLock = false;\n\n        if (annotation.annotationSettings && annotation.annotationSettings.isLock) {\n          isLock = annotation.annotationSettings.isLock;\n        }\n\n        if (isLock) {\n          if (this.pdfViewer.annotationModule.checkAllowedInteractions('PropertyChange', annotation)) {\n            this.pdfViewer.toolbarModule.annotationToolbarModule.enableTextMarkupAnnotationPropertiesTools(true);\n            this.pdfViewer.toolbarModule.annotationToolbarModule.setCurrentColorInPicker();\n          }\n\n          if (this.pdfViewer.annotationModule.checkAllowedInteractions('Delete', annotation)) {\n            this.pdfViewer.toolbarModule.annotationToolbarModule.selectAnnotationDeleteItem(true);\n          }\n        } else {\n          this.pdfViewer.toolbarModule.annotationToolbarModule.enableTextMarkupAnnotationPropertiesTools(true);\n          this.pdfViewer.toolbarModule.annotationToolbarModule.selectAnnotationDeleteItem(true);\n          this.pdfViewer.toolbarModule.annotationToolbarModule.setCurrentColorInPicker();\n        }\n\n        this.pdfViewer.toolbarModule.annotationToolbarModule.isToolbarHidden = true;\n\n        if (!isBlazor()) {\n          this.pdfViewer.toolbarModule.annotationToolbarModule.showAnnotationToolbar(this.pdfViewer.toolbarModule.annotationItem);\n        }\n      }\n    }\n  };\n\n  TextMarkupAnnotation.prototype.getPageContext = function (pageNumber) {\n    var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n    var context = null;\n\n    if (canvas) {\n      context = canvas.getContext('2d');\n    }\n\n    return context;\n  };\n\n  TextMarkupAnnotation.prototype.getDefaultValue = function (value) {\n    return value / this.pdfViewerBase.getZoomFactor();\n  };\n\n  TextMarkupAnnotation.prototype.getMagnifiedValue = function (value, factor) {\n    return value * factor;\n  };\n  /**\n   * @param annotation\n   * @param pageNumber\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.saveImportedTextMarkupAnnotations = function (annotation, pageNumber) {\n    var annotationObject = null;\n    annotation.Author = this.pdfViewer.annotationModule.updateAnnotationAuthor('textMarkup', annotation.Subject);\n\n    if (annotation.AnnotationSettings && annotation.AnnotationSettings.isLock) {\n      annotation.AnnotationSettings = {\n        isLock: annotation.AnnotationSettings.isLock\n      };\n    } else {\n      annotation.AnnotationSettings = this.getAnnotationSettings(annotation.TextMarkupAnnotationType);\n    } // eslint-disable-next-line max-len\n\n\n    annotation.allowedInteractions = this.pdfViewer.annotationModule.updateAnnotationAllowedInteractions(annotation); // eslint-disable-next-line max-len\n\n    annotationObject = {\n      // eslint-disable-next-line max-len\n      textMarkupAnnotationType: annotation.TextMarkupAnnotationType,\n      color: annotation.Color,\n      opacity: annotation.Opacity,\n      allowedInteractions: annotation.allowedInteractions,\n      bounds: annotation.Bounds,\n      author: annotation.Author,\n      subject: annotation.Subject,\n      modifiedDate: annotation.ModifiedDate,\n      note: annotation.Note,\n      rect: annotation.Rect,\n      annotName: annotation.AnnotName,\n      comments: this.pdfViewer.annotationModule.getAnnotationComments(annotation.Comments, annotation, annotation.Author),\n      review: {\n        state: annotation.State,\n        stateModel: annotation.StateModel,\n        modifiedDate: annotation.ModifiedDate,\n        author: annotation.Author\n      },\n      shapeAnnotationType: 'textMarkup',\n      pageNumber: pageNumber,\n      textMarkupContent: '',\n      textMarkupStartIndex: 0,\n      // eslint-disable-next-line max-len\n      textMarkupEndIndex: 0,\n      annotationSelectorSettings: this.getSettings(annotation),\n      customData: this.pdfViewer.annotation.getCustomData(annotation),\n      isMultiSelect: annotation.IsMultiSelect,\n      annotNameCollection: annotation.AnnotNameCollection,\n      annotpageNumbers: annotation.AnnotpageNumbers,\n      // eslint-disable-next-line max-len\n      annotationAddMode: this.annotationAddMode,\n      annotationSettings: annotation.AnnotationSettings,\n      isPrint: annotation.isPrint,\n      isCommentLock: annotation.IsCommentLock,\n      isAnnotationRotated: false\n    };\n    this.pdfViewer.annotationModule.storeAnnotations(pageNumber, annotationObject, '_annotations_textMarkup');\n  };\n  /**\n   * @param annotation\n   * @param pageNumber\n   * @param annotation\n   * @param pageNumber\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.updateTextMarkupAnnotationCollections = function (annotation, pageNumber) {\n    // eslint-disable-next-line\n    var annotationObject = null; // eslint-disable-next-line max-len\n\n    annotation.allowedInteractions = annotation.AllowedInteractions ? annotation.AllowedInteractions : this.pdfViewer.annotationModule.updateAnnotationAllowedInteractions(annotation);\n    annotationObject = {\n      // eslint-disable-next-line max-len\n      textMarkupAnnotationType: annotation.TextMarkupAnnotationType,\n      allowedInteractions: annotation.allowedInteractions,\n      color: annotation.Color,\n      opacity: annotation.Opacity,\n      bounds: annotation.Bounds,\n      author: annotation.Author,\n      subject: annotation.Subject,\n      modifiedDate: annotation.ModifiedDate,\n      note: annotation.Note,\n      rect: annotation.Rect,\n      annotationId: annotation.AnnotName,\n      comments: this.pdfViewer.annotationModule.getAnnotationComments(annotation.Comments, annotation, annotation.Author),\n      review: {\n        state: annotation.State,\n        stateModel: annotation.StateModel,\n        modifiedDate: annotation.ModifiedDate,\n        author: annotation.Author\n      },\n      shapeAnnotationType: 'textMarkup',\n      pageNumber: pageNumber,\n      isMultiSelect: annotation.IsMultiSelect,\n      annotNameCollection: annotation.AnnotNameCollection,\n      annotpageNumbers: annotation.AnnotpageNumbers,\n      customData: this.pdfViewer.annotation.getCustomData(annotation),\n      isPrint: annotation.isPrint,\n      isCommentLock: annotation.IsCommentLock\n    };\n    return annotationObject;\n  };\n  /**\n   * @param textMarkUpSettings\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  TextMarkupAnnotation.prototype.updateTextMarkupSettings = function (textMarkUpSettings) {\n    if (textMarkUpSettings === 'highlightSettings') {\n      // eslint-disable-next-line max-len\n      this.highlightColor = this.pdfViewer.highlightSettings.color ? this.pdfViewer.highlightSettings.color : this.highlightColor; // eslint-disable-next-line max-len\n\n      this.highlightOpacity = this.pdfViewer.highlightSettings.opacity ? this.pdfViewer.highlightSettings.opacity : this.highlightOpacity;\n    }\n\n    if (textMarkUpSettings === 'underlineSettings') {\n      // eslint-disable-next-line max-len\n      this.underlineColor = this.pdfViewer.underlineSettings.color ? this.pdfViewer.underlineSettings.color : this.underlineColor; // eslint-disable-next-line max-len\n\n      this.underlineOpacity = this.pdfViewer.underlineSettings.opacity ? this.pdfViewer.underlineSettings.opacity : this.underlineOpacity;\n    }\n\n    if (textMarkUpSettings === 'strikethroughSettings') {\n      // eslint-disable-next-line max-len\n      this.strikethroughColor = this.pdfViewer.strikethroughSettings.color ? this.pdfViewer.strikethroughSettings.color : this.strikethroughColor; // eslint-disable-next-line max-len\n\n      this.strikethroughOpacity = this.pdfViewer.strikethroughSettings.opacity ? this.pdfViewer.strikethroughSettings.opacity : this.strikethroughOpacity;\n    }\n  };\n  /**\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.clear = function () {\n    this.selectTextMarkupCurrentPage = null;\n    this.currentTextMarkupAnnotation = null;\n    this.annotationClickPosition = null;\n    window.sessionStorage.removeItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n  };\n  /**\n   * Get vertex points properties\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.getOffsetPoints = function (points) {\n    var offsetPoints = []; //Converting points model into vertex property\n\n    for (var j = 0; j < points.length; j++) {\n      offsetPoints[j] = {\n        X: points[j].x,\n        Y: points[j].y,\n        Width: points[j].width,\n        Height: points[j].height,\n        Left: points[j].x,\n        Top: points[j].y\n      };\n    }\n\n    return offsetPoints;\n  };\n  /**\n   * This method used to add annotations with using program.\n   *\n   * @param annotationType - It describes the annotation type\n   * @param annotationObject - It describes type of annotation object\n   * @returns Object\n   * @private\n   */\n\n\n  TextMarkupAnnotation.prototype.updateAddAnnotationDetails = function (annotationType, annotationObject) {\n    //Creating new object if annotationObject is null\n    if (!annotationObject) {\n      annotationObject = {\n        pageNumber: 0\n      };\n    } //Initialize the annotation settings\n\n\n    var annotSelectorSettings = null;\n    var annotallowedInteractions = null;\n    var textMarkupAnnotationType = '';\n    var annotSettings = null;\n    var color = '';\n    var bounds = []; //Creating the CurrentDate and Annotation name\n\n    var currentDateString = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n    var annotationName = this.pdfViewer.annotation.createGUID();\n\n    if (annotationType == 'Highlight') {\n      //Creating annotation settings\n      annotSelectorSettings = this.pdfViewer.highlightSettings.annotationSelectorSettings ? this.pdfViewer.highlightSettings.annotationSelectorSettings : this.pdfViewer.annotationSelectorSettings;\n      annotSettings = this.pdfViewer.annotationModule.updateSettings(this.pdfViewer.highlightSettings);\n      annotallowedInteractions = this.pdfViewer.highlightSettings.allowedInteractions ? this.pdfViewer.highlightSettings.allowedInteractions : this.pdfViewer.annotationSettings.allowedInteractions;\n      textMarkupAnnotationType = 'Highlight';\n      color = annotationObject.color ? annotationObject.color : '#ffff00';\n    } else if (annotationType == 'Underline') {\n      //Creating annotation settings\n      annotSelectorSettings = this.pdfViewer.underlineSettings.annotationSelectorSettings ? this.pdfViewer.underlineSettings.annotationSelectorSettings : this.pdfViewer.annotationSelectorSettings;\n      annotSettings = this.pdfViewer.annotationModule.updateSettings(this.pdfViewer.underlineSettings);\n      annotallowedInteractions = this.pdfViewer.underlineSettings.allowedInteractions ? this.pdfViewer.underlineSettings.allowedInteractions : this.pdfViewer.annotationSettings.allowedInteractions;\n      textMarkupAnnotationType = 'Underline';\n      color = annotationObject.color ? annotationObject.color : '#00ff00';\n    } else if (annotationType == 'Strikethrough') {\n      //Creating annotation settings\n      annotSelectorSettings = this.pdfViewer.strikethroughSettings.annotationSelectorSettings ? this.pdfViewer.strikethroughSettings.annotationSelectorSettings : this.pdfViewer.annotationSelectorSettings;\n      annotSettings = this.pdfViewer.annotationModule.updateSettings(this.pdfViewer.strikethroughSettings);\n      annotallowedInteractions = this.pdfViewer.strikethroughSettings.allowedInteractions ? this.pdfViewer.strikethroughSettings.allowedInteractions : this.pdfViewer.annotationSettings.allowedInteractions;\n      textMarkupAnnotationType = 'Strikethrough';\n      color = annotationObject.color ? annotationObject.color : '#ff0000';\n    }\n\n    annotSettings.isLock = annotationObject.isLock ? annotationObject.isLock : false; //Creating the offset points\n\n    if (annotationObject.bounds) {\n      bounds = this.getOffsetPoints(annotationObject.bounds);\n    } else bounds = [{\n      X: 1,\n      Y: 1,\n      Width: 100,\n      Height: 14,\n      Left: 1,\n      Top: 1,\n      Location: {\n        X: 1,\n        Y: 1\n      },\n      Size: {\n        Height: 14,\n        IsEmpty: false,\n        Width: 100\n      }\n    }]; //Creating Annotation objects with it's proper properties       \n\n\n    var textMarkupAnnotation = [];\n    var textmarkup = {\n      AllowedInteractions: annotationObject.allowedInteractions ? annotationObject.allowedInteractions : annotallowedInteractions,\n      AnnotName: annotationName,\n      AnnotNameCollection: null,\n      AnnotType: 'textMarkup',\n      AnnotationSelectorSettings: annotationObject.annotationSelectorSettings ? annotationObject.annotationSelectorSettings : annotSelectorSettings,\n      AnnotationSettings: annotSettings,\n      Author: annotationObject.author ? annotationObject.author : 'Guest',\n      Bounds: bounds,\n      Color: annotationObject.color ? annotationObject.color : color,\n      Comments: null,\n      CreatedDate: currentDateString,\n      CustomData: annotationObject.customData ? annotationObject.customData : null,\n      ExistingCustomData: null,\n      EnableMultiPageAnnotation: annotationObject.enableMultiPageAnnotation ? annotationObject.enableMultiPageAnnotation : false,\n      EnableTextMarkupResizer: annotationObject.enableTextMarkupResizer ? annotationObject.enableTextMarkupResizer : false,\n      IsCommentLock: false,\n      IsMultiSelect: false,\n      IsLock: annotationObject.isLock ? annotationObject.isLock : false,\n      IsPrint: annotationObject.isPrint ? annotationObject.isPrint : true,\n      ModifiedDate: currentDateString,\n      Note: '',\n      Opacity: annotationObject.opacity ? annotationObject.opacity : 1,\n      Rect: {},\n      State: '',\n      StateModel: '',\n      Subject: textMarkupAnnotationType,\n      TextMarkupAnnotationType: textMarkupAnnotationType\n    }; //Adding the annotation object to an array and return it\n\n    textMarkupAnnotation[0] = textmarkup;\n    return {\n      textMarkupAnnotation: textMarkupAnnotation\n    };\n  };\n\n  return TextMarkupAnnotation;\n}();\n\nexport { TextMarkupAnnotation };","map":{"version":3,"names":["createElement","Browser","isNullOrUndefined","isBlazor","TextMarkupAnnotation","pdfViewer","viewerBase","_this","currentTextMarkupAddMode","selectTextMarkupCurrentPage","currentTextMarkupAnnotation","isAddAnnotationProgramatically","currentAnnotationIndex","isAnnotationSelect","isDropletClicked","isRightDropletClicked","isLeftDropletClicked","isSelectionMaintained","isExtended","isNewAnnotation","selectedTextMarkup","multiPageCollection","triggerAddEvent","isSelectedAnnotation","dropletHeight","annotationClickPosition","maintainSelection","event","textSelectionModule","initiateSelectionByTouch","selectionRangeArray","selectionEnd","annotationLeftMove","annotationRightMove","pdfViewerBase","prototype","createAnnotationSelectElement","dropDivAnnotationLeft","id","element","className","style","borderRight","dropDivAnnotationRight","borderLeft","dropElementLeft","transform","appendChild","dropElementRight","pageContainer","top","left","display","addEventListener","textSelect","target","x","y","leftElement","getBoundingClientRect","rightElement","clientX","clientY","classList","contains","textSelectionOnDrag","updateLeftposition","updatePosition","showHideDropletDiv","hide","type","annotationModule","textMarkupAnnotationModule","isEnableResizer","isEnableTextMarkupResizer","updateDropletStyles","highlightSettings","enableTextMarkupResizer","underlineSettings","strikethroughSettings","offsetWidth","width","getZoomFactor","height","updateAnnotationBounds","annotation","isMultiSelect","updateMultiAnnotBounds","bounds","retreieveSelection","window","getSelection","removeAllRanges","annotpageNumbers","annotationList","getAnnotations","pageNumber","z","length","annotName","lowestNumber","highestNumber","p","currentPage","k","j","annotNameCollection","currentAnnot","newAnnotation","bound","Left","Top","Width","Height","textLayer","getElement","textDivs","childNodes","n","rangebounds","top_1","getClientValueTop","currentLeft","totalLeft","textDiVLeft","parseInt","currentTop","isLeftBounds","checkLeftBounds","isTopBounds","checkTopBounds","boundingRect","textSelectionOnMouseMove","isSelected","pageTopValue","pageSize","currentPageNumber","topClientValue","rightDivElement","document","getElementById","viewerContainer","scrollLeft","leftDivElement","clientValue","renderTextMarkupAnnotationsInPage","textMarkupAnnotations","isImportTextMarkup","canvas","renderTextMarkupAnnotations","factor","isImportAction","context","getContext","setTransform","setLineDash","annotations","i","annotationObject","isAnnotationRotated","TextMarkupAnnotationType","isJsonImported","newArray","i_1","Bounds","importJsonForRotatedDocuments","Rotate","AnnotationRotation","X","Y","push","isPageRotated","annotationAddMode","findAnnotationMode","AnnotType","Author","updateAnnotationAuthor","Subject","AnnotationSettings","isLock","getAnnotationSettings","isPrint_1","IsPrint","getIsPrintValue","allowedInteractions","AllowedInteractions","updateAnnotationAllowedInteractions","textMarkupAnnotationType","color","Color","opacity","Opacity","author","subject","modifiedDate","ModifiedDate","note","Note","rect","Rect","AnnotName","comments","getAnnotationComments","Comments","review","state","State","stateModel","StateModel","shapeAnnotationType","textMarkupContent","TextMarkupContent","textMarkupStartIndex","textMarkupEndIndex","annotationSelectorSettings","getSettings","customData","getCustomData","annotationSettings","isPrint","isCommentLock","IsCommentLock","IsMultiSelect","AnnotNameCollection","AnnotpageNumbers","storeAnnotations","settings","fireAnnotationAdd","annotBounds","renderHighlightAnnotation","renderStrikeoutAnnotation","renderUnderlineAnnotation","isMaintainedSelector","m","maintainAnnotationSelection","selector","AnnotationSelectorSettings","getSelector","drawTextMarkupAnnotations","isTextMarkupAnnotationMode","isCleared","selectionObject","convertSelectionToTextMarkup","toString","pageBounds","getDrawnBounds","pageIndex","updateTextMarkupAnnotationBounds","isMultiAnnotation","drawTextMarkups","textContent","startIndex","endIndex","modifyCurrentAnnotation","isMultiPageAnnotations","updateAnnotationNames","clearTextSelection","isSelection","enableMultiPageAnnotation","index","c","currentAnnots","drawAnnotationSelector","newcanvas","drawAnnotationSelectRect","getMagnifiedValue","selectMultiPageAnnotations","deletMultiPageAnnotation","deletedAnnotation","splice","addAction","stickyNotesAnnotationModule","findPosition","removeDiv","parentElement","childElementCount","updateAccordionContainer","remove","updateAnnotationCollection","manageAnnotations","updateImportAnnotationCollection","annotationId","annotationBounds","renderAnnotations","modifyMultiPageAnnotations","property","value","getDateAndTime","status","updateAnnotationModifiedDate","textValue","indexes","startNode","endNode","parentText","getIndexNumbers","rectangleBounds","currentIndex","pageAnnotations","JSON","stringify","updateDocumentEditedProperty","multiPageCollectionList","fireAnnotationResize","annotNamesCollections","updateAnnotationContent","pageBound","annotation_1","storeAnnotationCollections","getPageContext","highlightColor","underlineColor","strikethroughColor","highlightOpacity","underlineOpacity","strikethroughOpacity","getAddedAnnotation","actionCollection","isDevice","enableDesktopMode","enableToolbar","enableAnnotationToolbar","toolbarModule","annotationToolbarModule","createPropertyTools","retreiveTextIndex","zoomRatio","getZoomRatio","beginPath","globalAlpha","closePath","fillStyle","msFillRule","fill","save","getProperBounds","pageDetails","factorRatio","rotation","drawLine","boundValues","moveTo","lineTo","lineWidth","strokeStyle","stroke","printTextMarkupAnnotations","stampData","shapeData","measureShapeData","stickyData","pageWidth","pageHeight","zoom","textMarkupannotations","shapeAnnotation","measureShapeAnnotation","stampAnnotation","stickyNoteAnnotation","renderDrawing","stampAnnotationModule","renderStampAnnotations","renderStickyNotesAnnotations","zoomFactor","imageSource","toDataURL","saveTextMarkupAnnotations","storeTextMarkupObject","sessionStorage","getItem","documentId","isStorageExceed","annotationStorage","Array","pageCount","skipDownload","textMarkupAnnotationCollection","parse","pageAnnotationObject","updateModifiedDate","isJsonExported","getBoundsForSave","annotationRotation","colorString","getRgbCode","deleteTextMarkupAnnotation","checkAllowedInteractions","fireAnnotationRemove","hideMobileAnnotationToolbar","showToolbar","modifyColorProperty","modifyAnnotationProperty","fireAnnotationPropertiesChange","modifyOpacityProperty","args","isOpacity","name","undoTextMarkupAction","action","removeChild","addAnnotationComments","clearCurrentAnnotation","undoRedoPropertyChange","isUndoAction","tempColor","tempOpacity","redoTextMarkupAction","saveNoteContent","isMaintainSelection","isTextSelection","isSkip","freeTextAnnotationModule","isInuptBoxInFocus","enableAnnotationPropertiesTool","clearCurrentAnnotationSelection","isSelect","lowerPageIndex","higherPageIndex","clearAnnotationSelection","getAnnotationBounds","match","nameToHash","markupStringArray","split","getValue","textMarkupR","textMarkupG","textMarkupB","textMarkupA","a","r","g","b","selection","anchorNode","range","createRange","isBackWardSelection","focusNode","pageId","getPageIndex","isNaN","pageRect","isMixedSizeDocument","setStart","focusOffset","setEnd","anchorOffset","commonAncestorContainer","rectangle","getDefaultValue","right","bottom","rectangleArray","selectionStartOffset","selectionEndOffset","anchorPageId","anchorTextId","getTextIndex","focusPageId","focusTextId","startOffset","endOffset","currentId","selectionRects","pageStartId","pageEndId","pageStartOffset","pageEndOffset","textElement","node","detach","startElementNode","endElementNode","pageRange","pageRectBounds","pageRectangle","content","storedData","getStoredData","previousIndex","pageText","isExtractText","documentIndex","textSearchModule","documentTextCollection","pageTextData","PageText","isTextRetrieved","parentIndex","indexOf","initialIndex","rerenderAnnotationsPinch","annotCanvas","oldAnnotCanvas","restrictZoomRequest","rerenderAnnotations","oldCanvasCollection","querySelectorAll","newCanvas","onTextMarkupAnnotationMouseUp","getEventPageNumber","clearCurrentSelectedAnnotation","getCurrentMarkupAnnotation","canvasParentPosition","leftClickPosition","topClickPosition","selectAnnotation","commentPanelDiv","accordionExpand","ej2_instances","expandItem","firstChild","click","isToolbarHidden","showAnnotationToolbar","annotationItem","isClickedOnScrollBar","onTextMarkupAnnotationTouchEnd","touchCanvas","touches","number","fireAnnotationUnSelect","onTextMarkupAnnotationMouseMove","eventTarget","cursor","currentPosition","getMousePosition","relativePosition","viewerPositions","mousePositions","isMousedOver","fireAnnotationMouseover","hidePopupNote","isPanMode","getAnnotationToolStatus","isFormFieldMousedOver","fireAnnotationMouseLeave","showPopupNote","currentTextMarkupAnnotations","clientWidth","isAnnotationGot","top_2","compareCurrentAnnotations","previousX","currentAnnotation","firstAnnotBounds","firstXposition","firstYposition","secondAnnotBounds","secondXposition","secondYposition","isProgrammaticSelection","selectedItems","clearSelection","isCurrentTextMarkup","currentEvent","updateCurrentResizerPosition","annotationSelect","top_3","endPosition","endLeft","endTop","endWidth","ratio","lineDash","selectorLineDashArray","borderColor","selectionBorderColor","selectionBorderThickness","isEnable","colorDropDownElementInBlazor","querySelector","createMobileAnnotationToolbar","isMobileAnnotEnabled","selectAnnotationDeleteItem","enable","enableTextMarkupAnnotationPropertiesTools","updateColorInIcon","colorDropDownElement","setCurrentColorInPicker","storeObject","annotObject","removeItem","getPageCollection","annotationStringified","setItem","annotationCollection","undefined","predefinedDate","annotationName","createGUID","commentsDivid","addComments","getTextMarkupData","annotationDivSelect","storedIndex","clearShapeMode","clearMeasureMode","saveImportedTextMarkupAnnotations","updateTextMarkupAnnotationCollections","updateTextMarkupSettings","textMarkUpSettings","clear","getOffsetPoints","points","offsetPoints","updateAddAnnotationDetails","annotationType","annotSelectorSettings","annotallowedInteractions","annotSettings","currentDateString","updateSettings","Location","Size","IsEmpty","textMarkupAnnotation","textmarkup","CreatedDate","CustomData","ExistingCustomData","EnableMultiPageAnnotation","EnableTextMarkupResizer","IsLock"],"sources":["/home/morgan/Desktop/Projets/ENT4/Jwt-Auth-pdf/react-jwt-auth/react-jwt-auth/node_modules/@syncfusion/ej2-pdfviewer/src/pdfviewer/annotation/text-markup-annotation.js"],"sourcesContent":["import { createElement, Browser, isNullOrUndefined, isBlazor } from '@syncfusion/ej2-base';\n/**\n * The `TextMarkupAnnotation` module is used to handle text markup annotation actions of PDF viewer.\n *\n * @hidden\n */\nvar TextMarkupAnnotation = /** @class */ (function () {\n    /**\n     * @param pdfViewer\n     * @param viewerBase\n     * @private\n     */\n    function TextMarkupAnnotation(pdfViewer, viewerBase) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.currentTextMarkupAddMode = '';\n        /**\n         * @private\n         */\n        this.selectTextMarkupCurrentPage = null;\n        /**\n         * @private\n         */\n        this.currentTextMarkupAnnotation = null;\n        /**\n         * @private\n         */\n        this.isAddAnnotationProgramatically = false;\n        this.currentAnnotationIndex = null;\n        this.isAnnotationSelect = false;\n        /**\n         * @private\n         */\n        this.isDropletClicked = false;\n        /**\n         * @private\n         */\n        this.isRightDropletClicked = false;\n        /**\n         * @private\n         */\n        this.isLeftDropletClicked = false;\n        /**\n         * @private\n         */\n        this.isSelectionMaintained = false;\n        this.isExtended = false;\n        this.isNewAnnotation = false;\n        this.selectedTextMarkup = null;\n        this.multiPageCollection = [];\n        this.triggerAddEvent = false;\n        /**\n         * @private\n         */\n        this.isSelectedAnnotation = false;\n        this.dropletHeight = 20;\n        /**\n         * @private\n         */\n        this.annotationClickPosition = {};\n        // eslint-disable-next-line\n        this.maintainSelection = function (event) {\n            _this.isDropletClicked = true;\n            _this.pdfViewer.textSelectionModule.initiateSelectionByTouch();\n            _this.isExtended = true;\n            _this.pdfViewer.textSelectionModule.selectionRangeArray = [];\n        };\n        // eslint-disable-next-line\n        this.selectionEnd = function (event) {\n            if (_this.isDropletClicked) {\n                _this.isDropletClicked = false;\n            }\n        };\n        // eslint-disable-next-line\n        this.annotationLeftMove = function (event) {\n            if (_this.isDropletClicked) {\n                _this.isLeftDropletClicked = true;\n            }\n        };\n        // eslint-disable-next-line\n        this.annotationRightMove = function (event) {\n            if (_this.isDropletClicked) {\n                _this.isRightDropletClicked = true;\n            }\n        };\n        this.pdfViewer = pdfViewer;\n        this.pdfViewerBase = viewerBase;\n    }\n    /**\n     * @private\n     */\n    TextMarkupAnnotation.prototype.createAnnotationSelectElement = function () {\n        // eslint-disable-next-line max-len\n        this.dropDivAnnotationLeft = createElement('div', { id: this.pdfViewer.element.id + '_droplet_left', className: 'e-pv-drop' });\n        this.dropDivAnnotationLeft.style.borderRight = '2px solid';\n        // eslint-disable-next-line max-len\n        this.dropDivAnnotationRight = createElement('div', { id: this.pdfViewer.element.id + '_droplet_right', className: 'e-pv-drop' });\n        this.dropDivAnnotationRight.style.borderLeft = '2px solid';\n        this.dropElementLeft = createElement('div', { className: 'e-pv-droplet', id: this.pdfViewer.element.id + '_dropletspan_left' });\n        this.dropElementLeft.style.transform = 'rotate(0deg)';\n        this.dropDivAnnotationLeft.appendChild(this.dropElementLeft);\n        this.dropElementRight = createElement('div', { className: 'e-pv-droplet', id: this.pdfViewer.element.id + '_dropletspan_right' });\n        this.dropElementRight.style.transform = 'rotate(-90deg)';\n        this.dropDivAnnotationRight.appendChild(this.dropElementRight);\n        this.pdfViewerBase.pageContainer.appendChild(this.dropDivAnnotationLeft);\n        this.pdfViewerBase.pageContainer.appendChild(this.dropDivAnnotationRight);\n        this.dropElementLeft.style.top = '20px';\n        this.dropElementRight.style.top = '20px';\n        this.dropElementRight.style.left = '-8px';\n        this.dropElementLeft.style.left = '-8px';\n        this.dropDivAnnotationLeft.style.display = 'none';\n        this.dropDivAnnotationRight.style.display = 'none';\n        this.dropDivAnnotationLeft.addEventListener('mousedown', this.maintainSelection);\n        this.dropDivAnnotationLeft.addEventListener('mousemove', this.annotationLeftMove);\n        this.dropDivAnnotationLeft.addEventListener('mouseup', this.selectionEnd);\n        this.dropDivAnnotationRight.addEventListener('mousedown', this.maintainSelection);\n        this.dropDivAnnotationRight.addEventListener('mousemove', this.annotationRightMove);\n        this.dropDivAnnotationRight.addEventListener('mouseup', this.selectionEnd);\n    };\n    /**\n     * @param target\n     * @param x\n     * @param y\n     * @param target\n     * @param x\n     * @param y\n     * @param target\n     * @param x\n     * @param y\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.textSelect = function (target, x, y) {\n        if (this.isLeftDropletClicked) {\n            var leftElement = this.dropDivAnnotationRight.getBoundingClientRect();\n            var rightElement = this.dropDivAnnotationLeft.getBoundingClientRect();\n            var clientX = x;\n            var clientY = y;\n            if (target.classList.contains('e-pv-text')) {\n                if ((rightElement.top - 25) > leftElement.top) {\n                    this.pdfViewer.textSelectionModule.textSelectionOnDrag(target, clientX, clientY, true);\n                }\n                else {\n                    this.pdfViewer.textSelectionModule.textSelectionOnDrag(target, clientX, clientY, false);\n                }\n                this.updateLeftposition(clientX, clientY);\n            }\n        }\n        else if (this.isRightDropletClicked) {\n            var leftElement = this.dropDivAnnotationLeft.getBoundingClientRect();\n            var clientX = x;\n            var clientY = y;\n            if (target.classList.contains('e-pv-text')) {\n                if ((clientY) >= leftElement.top) {\n                    this.pdfViewer.textSelectionModule.textSelectionOnDrag(target, clientX, clientY, true);\n                }\n                else {\n                    this.pdfViewer.textSelectionModule.textSelectionOnDrag(target, clientX, clientY, false);\n                }\n                this.updatePosition(clientX, clientY);\n            }\n        }\n    };\n    /**\n     * @param hide\n     * @private\n     */\n    TextMarkupAnnotation.prototype.showHideDropletDiv = function (hide) {\n        var type = this.pdfViewer.annotationModule.textMarkupAnnotationModule.currentTextMarkupAddMode;\n        var isEnableResizer = this.isEnableTextMarkupResizer(type);\n        if (isEnableResizer && this.dropDivAnnotationLeft && this.dropDivAnnotationRight) {\n            if (hide) {\n                this.dropDivAnnotationLeft.style.display = 'none';\n                this.dropDivAnnotationRight.style.display = 'none';\n            }\n            else {\n                this.dropDivAnnotationLeft.style.display = '';\n                this.dropDivAnnotationRight.style.display = '';\n                this.updateDropletStyles(type);\n            }\n        }\n    };\n    /**\n     * @param type\n     * @private\n     */\n    TextMarkupAnnotation.prototype.isEnableTextMarkupResizer = function (type) {\n        var isEnableResizer = false;\n        if (type) {\n            if (type === 'Highlight' && this.pdfViewer.highlightSettings.enableTextMarkupResizer) {\n                isEnableResizer = true;\n            }\n            else if (type === 'Underline' && this.pdfViewer.underlineSettings.enableTextMarkupResizer) {\n                isEnableResizer = true;\n            }\n            else if (type === 'Strikethrough' && this.pdfViewer.strikethroughSettings.enableTextMarkupResizer) {\n                isEnableResizer = true;\n            }\n            else if (this.pdfViewer.enableTextMarkupResizer) {\n                isEnableResizer = true;\n            }\n        }\n        else {\n            if (this.pdfViewer.enableTextMarkupResizer) {\n                isEnableResizer = true;\n            }\n            else if (this.pdfViewer.highlightSettings.enableTextMarkupResizer) {\n                isEnableResizer = true;\n            }\n            else if (this.pdfViewer.underlineSettings.enableTextMarkupResizer) {\n                isEnableResizer = true;\n            }\n            else if (this.pdfViewer.strikethroughSettings.enableTextMarkupResizer) {\n                isEnableResizer = true;\n            }\n        }\n        return isEnableResizer;\n    };\n    TextMarkupAnnotation.prototype.updateDropletStyles = function (type) {\n        if (this.isEnableTextMarkupResizer(type) && this.dropDivAnnotationLeft && this.dropDivAnnotationLeft.offsetWidth > 0) {\n            this.dropDivAnnotationLeft.style.width = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropDivAnnotationRight.style.width = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropElementLeft.style.width = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropElementRight.style.width = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropDivAnnotationLeft.style.height = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropDivAnnotationRight.style.height = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropElementLeft.style.height = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropElementRight.style.height = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropElementLeft.style.top = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n            this.dropElementRight.style.top = this.dropletHeight * this.pdfViewerBase.getZoomFactor() + 'px';\n        }\n    };\n    TextMarkupAnnotation.prototype.updateAnnotationBounds = function () {\n        this.isSelectionMaintained = false;\n        // eslint-disable-next-line\n        var annotation = this.currentTextMarkupAnnotation;\n        if (annotation && annotation.isMultiSelect) {\n            this.showHideDropletDiv(true);\n            this.updateMultiAnnotBounds(annotation);\n        }\n        else if (annotation && annotation.bounds) {\n            this.retreieveSelection(annotation, null);\n            this.pdfViewer.textSelectionModule.maintainSelection(this.selectTextMarkupCurrentPage, false);\n            this.isSelectionMaintained = true;\n            window.getSelection().removeAllRanges();\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.updateMultiAnnotBounds = function (annotation) {\n        if (!annotation.annotpageNumbers) {\n            var annotationList = this.getAnnotations(annotation.pageNumber, null);\n            if (annotationList) {\n                for (var z = 0; z < annotationList.length; z++) {\n                    if (annotationList[z].annotName === annotation.annotName) {\n                        annotation = annotationList[z];\n                        break;\n                    }\n                }\n            }\n        }\n        var lowestNumber = annotation.annotpageNumbers[0];\n        var highestNumber = annotation.annotpageNumbers[0];\n        for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n            var currentPage = annotation.annotpageNumbers[p];\n            if (currentPage >= highestNumber) {\n                highestNumber = currentPage;\n            }\n            if (currentPage <= lowestNumber) {\n                lowestNumber = currentPage;\n            }\n        }\n        for (var k = lowestNumber; k <= highestNumber; k++) {\n            var annotationList = this.getAnnotations(k, null);\n            if (annotationList) {\n                for (var j = 0; j < annotation.annotNameCollection.length; j++) {\n                    // eslint-disable-next-line\n                    var currentAnnot = annotation.annotNameCollection[j];\n                    for (var z = 0; z < annotationList.length; z++) {\n                        if (annotationList[z].annotName === currentAnnot) {\n                            // eslint-disable-next-line\n                            var newAnnotation = annotationList[z];\n                            this.retreieveSelection(newAnnotation, null);\n                            this.pdfViewer.textSelectionModule.maintainSelection(newAnnotation.pageNumber, false);\n                        }\n                    }\n                }\n            }\n        }\n        this.isSelectionMaintained = true;\n        window.getSelection().removeAllRanges();\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.retreieveSelection = function (annotation, element) {\n        for (var k = 0; k < annotation.bounds.length; k++) {\n            // eslint-disable-next-line\n            var bound = annotation.bounds[k];\n            var x = (bound.left ? bound.left : bound.Left) * this.pdfViewerBase.getZoomFactor();\n            var y = (bound.top ? bound.top : bound.Top) * this.pdfViewerBase.getZoomFactor();\n            var width = (bound.width ? bound.width : bound.Width) * this.pdfViewerBase.getZoomFactor();\n            var height = bound.height ? bound.height : bound.Height;\n            // eslint-disable-next-line\n            var textLayer = this.pdfViewerBase.getElement('_textLayer_' + annotation.pageNumber);\n            if (textLayer) {\n                // eslint-disable-next-line\n                var textDivs = textLayer.childNodes;\n                for (var n = 0; n < textDivs.length; n++) {\n                    if (textDivs[n]) {\n                        // eslint-disable-next-line\n                        var rangebounds = textDivs[n].getBoundingClientRect();\n                        var top_1 = this.getClientValueTop(rangebounds.top, annotation.pageNumber);\n                        // eslint-disable-next-line max-len\n                        var currentLeft = rangebounds.left - this.pdfViewerBase.getElement('_pageDiv_' + annotation.pageNumber).getBoundingClientRect().left;\n                        var totalLeft = currentLeft + rangebounds.width;\n                        // eslint-disable-next-line\n                        var textDiVLeft = parseInt(textDivs[n].style.left);\n                        // eslint-disable-next-line\n                        var currentTop = parseInt(textDivs[n].style.top);\n                        var isLeftBounds = this.pdfViewer.textSelectionModule.checkLeftBounds(currentLeft, textDiVLeft, totalLeft, x);\n                        var isTopBounds = this.pdfViewer.textSelectionModule.checkTopBounds(top_1, currentTop, y);\n                        if (isLeftBounds && isTopBounds) {\n                            element = textDivs[n];\n                            break;\n                        }\n                    }\n                }\n                if (element != null) {\n                    // eslint-disable-next-line\n                    var boundingRect = this.pdfViewerBase.getElement('_textLayer_' + annotation.pageNumber).getBoundingClientRect();\n                    this.pdfViewer.textSelectionModule.textSelectionOnMouseMove(element, x + boundingRect.left, y + boundingRect.top, false);\n                    if ((annotation.bounds.length - 1) === k) {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.textSelectionModule.textSelectionOnMouseMove(element, x + boundingRect.left + width, y + boundingRect.top, false);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @param x\n     * @param y\n     * @param isSelected\n     * @private\n     */\n    TextMarkupAnnotation.prototype.updatePosition = function (x, y, isSelected) {\n        this.showHideDropletDiv(false);\n        var pageTopValue = this.pdfViewerBase.pageSize[this.pdfViewerBase.currentPageNumber - 1].top;\n        var topClientValue = this.getClientValueTop(y, this.pdfViewerBase.currentPageNumber - 1);\n        // eslint-disable-next-line\n        var rightDivElement = document.getElementById(this.pdfViewer.element.id + '_droplet_right');\n        if (isSelected) {\n            // eslint-disable-next-line max-len\n            rightDivElement.style.top = topClientValue * this.pdfViewerBase.getZoomFactor() + pageTopValue * this.pdfViewerBase.getZoomFactor() + 'px';\n        }\n        else {\n            // eslint-disable-next-line max-len\n            rightDivElement.style.top = topClientValue + pageTopValue * this.pdfViewerBase.getZoomFactor() + 'px';\n        }\n        // eslint-disable-next-line max-len\n        rightDivElement.style.left = x + this.pdfViewerBase.viewerContainer.scrollLeft - this.pdfViewerBase.viewerContainer.getBoundingClientRect().left + 'px';\n    };\n    /**\n     * @param x\n     * @param y\n     * @param isSelected\n     * @param x\n     * @param y\n     * @param isSelected\n     * @private\n     */\n    TextMarkupAnnotation.prototype.updateLeftposition = function (x, y, isSelected) {\n        this.showHideDropletDiv(false);\n        var pageTopValue = this.pdfViewerBase.pageSize[this.pdfViewerBase.currentPageNumber - 1].top;\n        var topClientValue = this.getClientValueTop(y, this.pdfViewerBase.currentPageNumber - 1);\n        // eslint-disable-next-line\n        var leftDivElement = document.getElementById(this.pdfViewer.element.id + '_droplet_left');\n        leftDivElement.style.display = '';\n        if (isSelected) {\n            // eslint-disable-next-line max-len\n            leftDivElement.style.top = topClientValue * this.pdfViewerBase.getZoomFactor() + pageTopValue * this.pdfViewerBase.getZoomFactor() + 'px';\n        }\n        else {\n            // eslint-disable-next-line max-len\n            leftDivElement.style.top = topClientValue + pageTopValue * this.pdfViewerBase.getZoomFactor() + 'px';\n        }\n        // eslint-disable-next-line max-len\n        leftDivElement.style.left = x + this.pdfViewerBase.viewerContainer.scrollLeft - this.pdfViewerBase.viewerContainer.getBoundingClientRect().left - (this.dropletHeight * this.pdfViewerBase.getZoomFactor()) + 'px';\n    };\n    TextMarkupAnnotation.prototype.getClientValueTop = function (clientValue, pageNumber) {\n        if (this.pdfViewerBase.getElement('_pageDiv_' + pageNumber)) {\n            // eslint-disable-next-line max-len\n            return clientValue - this.pdfViewerBase.getElement('_pageDiv_' + pageNumber).getBoundingClientRect().top;\n        }\n        else {\n            return clientValue;\n        }\n    };\n    /**\n     * @param textMarkupAnnotations\n     * @param pageNumber\n     * @param isImportTextMarkup\n     * @param textMarkupAnnotations\n     * @param pageNumber\n     * @param isImportTextMarkup\n     * @param textMarkupAnnotations\n     * @param pageNumber\n     * @param isImportTextMarkup\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.renderTextMarkupAnnotationsInPage = function (textMarkupAnnotations, pageNumber, isImportTextMarkup) {\n        var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n        if (isImportTextMarkup) {\n            this.renderTextMarkupAnnotations(null, pageNumber, canvas, this.pdfViewerBase.getZoomFactor());\n            this.renderTextMarkupAnnotations(textMarkupAnnotations, pageNumber, canvas, this.pdfViewerBase.getZoomFactor(), true);\n        }\n        else {\n            this.renderTextMarkupAnnotations(textMarkupAnnotations, pageNumber, canvas, this.pdfViewerBase.getZoomFactor());\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.renderTextMarkupAnnotations = function (textMarkupAnnotations, pageNumber, canvas, factor, isImportAction) {\n        if (canvas) {\n            var context = canvas.getContext('2d');\n            context.setTransform(1, 0, 0, 1, 0, 0);\n            context.setLineDash([]);\n            // eslint-disable-next-line\n            var annotations = void 0;\n            if (!isImportAction) {\n                annotations = this.getAnnotations(pageNumber, textMarkupAnnotations);\n            }\n            else {\n                annotations = textMarkupAnnotations;\n            }\n            if (annotations) {\n                for (var i = 0; i < annotations.length; i++) {\n                    // eslint-disable-next-line\n                    var annotation = annotations[i];\n                    var annotationObject = null;\n                    var isAnnotationRotated = void 0;\n                    if (annotation.TextMarkupAnnotationType) {\n                        if (isImportAction) {\n                            if (this.pdfViewerBase.isJsonImported) {\n                                var newArray = [];\n                                for (var i_1 = 0; i_1 < annotation.Bounds.length; i_1++) {\n                                    // eslint-disable-next-line\n                                    annotation.Bounds[i_1] = this.pdfViewerBase.importJsonForRotatedDocuments(annotation.Rotate, pageNumber, annotation.Bounds[i_1], annotation.AnnotationRotation);\n                                    annotation.Bounds[i_1].left = annotation.Bounds[i_1].X;\n                                    annotation.Bounds[i_1].top = annotation.Bounds[i_1].Y;\n                                    newArray.push(annotation.Bounds[i_1]);\n                                }\n                                annotation.Bounds = newArray;\n                                isAnnotationRotated = this.pdfViewerBase.isPageRotated;\n                            }\n                        }\n                        // eslint-disable-next-line max-len\n                        annotation.annotationAddMode = this.pdfViewer.annotationModule.findAnnotationMode(annotation, pageNumber, annotation.AnnotType);\n                        if (!annotation.Author) {\n                            // eslint-disable-next-line max-len\n                            annotation.Author = this.pdfViewer.annotationModule.updateAnnotationAuthor('textMarkup', annotation.TextMarkupAnnotationType);\n                        }\n                        if (!annotation.Subject) {\n                            annotation.Subject = annotation.TextMarkupAnnotationType;\n                        }\n                        if (annotation.AnnotationSettings && annotation.AnnotationSettings.isLock) {\n                            annotation.AnnotationSettings = { isLock: annotation.AnnotationSettings.isLock };\n                        }\n                        else {\n                            annotation.AnnotationSettings = this.getAnnotationSettings(annotation.TextMarkupAnnotationType);\n                        }\n                        var isPrint_1 = true;\n                        if (annotation.annotationAddMode === 'Imported Annotation') {\n                            isPrint_1 = annotation.IsPrint;\n                        }\n                        else {\n                            isPrint_1 = this.getIsPrintValue(annotation.TextMarkupAnnotationType);\n                        }\n                        // eslint-disable-next-line max-len\n                        annotation.allowedInteractions = annotation.AllowedInteractions ? annotation.AllowedInteractions : this.pdfViewer.annotationModule.updateAnnotationAllowedInteractions(annotation);\n                        // eslint-disable-next-line max-len\n                        annotationObject = {\n                            textMarkupAnnotationType: annotation.TextMarkupAnnotationType, color: annotation.Color, allowedInteractions: annotation.allowedInteractions, opacity: annotation.Opacity, bounds: annotation.Bounds, author: annotation.Author, subject: annotation.Subject, modifiedDate: annotation.ModifiedDate, note: annotation.Note, rect: annotation.Rect,\n                            // eslint-disable-next-line max-len\n                            annotName: annotation.AnnotName, comments: this.pdfViewer.annotationModule.getAnnotationComments(annotation.Comments, annotation, annotation.Author), review: { state: annotation.State, stateModel: annotation.StateModel, modifiedDate: annotation.ModifiedDate, author: annotation.Author }, shapeAnnotationType: 'textMarkup', pageNumber: pageNumber,\n                            textMarkupContent: annotation.TextMarkupContent, textMarkupStartIndex: 0, textMarkupEndIndex: 0, annotationSelectorSettings: this.getSettings(annotation),\n                            // eslint-disable-next-line max-len\n                            customData: this.pdfViewer.annotation.getCustomData(annotation), annotationAddMode: annotation.annotationAddMode, annotationSettings: annotation.AnnotationSettings, isPrint: isPrint_1, isCommentLock: annotation.IsCommentLock, isAnnotationRotated: isAnnotationRotated\n                        };\n                        if (annotation.IsMultiSelect) {\n                            annotationObject.annotNameCollection = annotation.AnnotNameCollection;\n                            annotationObject.annotpageNumbers = annotation.AnnotpageNumbers;\n                            annotationObject.isMultiSelect = annotation.IsMultiSelect;\n                        }\n                        if (annotation.textMarkupContent && annotation.textMarkupContent !== '') {\n                            annotationObject.textMarkupContent = annotation.textMarkupContent;\n                            annotationObject.textMarkupStartIndex = annotation.textMarkupStartIndex;\n                            annotationObject.textMarkupEndIndex = annotation.textMarkupEndIndex;\n                        }\n                        this.pdfViewer.annotationModule.storeAnnotations(pageNumber, annotationObject, '_annotations_textMarkup');\n                        if (this.isAddAnnotationProgramatically) {\n                            // eslint-disable-next-line\n                            var settings = {\n                                opacity: annotationObject.opacity, author: annotation.author, subject: annotation.subject, modifiedDate: annotation.modifiedDate,\n                                // eslint-disable-next-line\n                                width: annotationObject.bounds.width, height: annotationObject.bounds.height\n                            };\n                            this.pdfViewer.fireAnnotationAdd(annotationObject.pageNumber, annotationObject.annotName, annotation.TextMarkupAnnotationType, annotationObject.bounds, settings);\n                        }\n                    }\n                    // eslint-disable-next-line max-len\n                    var type = annotation.TextMarkupAnnotationType ? annotation.TextMarkupAnnotationType : annotation.textMarkupAnnotationType;\n                    // eslint-disable-next-line\n                    var annotBounds = annotation.Bounds ? annotation.Bounds : annotation.bounds;\n                    var opacity = annotation.Opacity ? annotation.Opacity : annotation.opacity;\n                    var color = annotation.Color ? annotation.Color : annotation.color;\n                    var isPrint = true;\n                    if (annotation.TextMarkupAnnotationType) {\n                        isPrint = annotation.IsPrint;\n                    }\n                    if (annotation.textMarkupAnnotationType) {\n                        isPrint = annotation.isPrint;\n                    }\n                    switch (type) {\n                        case 'Highlight':\n                            this.renderHighlightAnnotation(annotBounds, opacity, color, context, factor, isPrint, pageNumber);\n                            break;\n                        case 'Strikethrough':\n                            this.renderStrikeoutAnnotation(annotBounds, opacity, color, context, factor, pageNumber, isPrint);\n                            break;\n                        case 'Underline':\n                            this.renderUnderlineAnnotation(annotBounds, opacity, color, context, factor, pageNumber, isPrint);\n                            break;\n                    }\n                }\n            }\n            var isMaintainedSelector = false;\n            if (this.currentTextMarkupAnnotation && this.currentTextMarkupAnnotation.annotpageNumbers) {\n                for (var m = 0; m < this.currentTextMarkupAnnotation.annotpageNumbers.length; m++) {\n                    if (pageNumber === this.currentTextMarkupAnnotation.annotpageNumbers[m]) {\n                        isMaintainedSelector = true;\n                        this.isAnnotationSelect = false;\n                        break;\n                    }\n                }\n            }\n            if ((pageNumber === this.selectTextMarkupCurrentPage) || isMaintainedSelector) {\n                if (!this.isAnnotationSelect) {\n                    this.maintainAnnotationSelection();\n                }\n                else {\n                    this.isAnnotationSelect = false;\n                }\n            }\n        }\n    };\n    /**\n     * @param annotation\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.getSettings = function (annotation) {\n        var selector;\n        if (annotation.AnnotationSelectorSettings) {\n            selector = annotation.AnnotationSelectorSettings;\n        }\n        else {\n            selector = this.getSelector(annotation.TextMarkupAnnotationType);\n        }\n        return selector;\n    };\n    /**\n     * @param type\n     * @private\n     */\n    TextMarkupAnnotation.prototype.drawTextMarkupAnnotations = function (type) {\n        this.isTextMarkupAnnotationMode = true;\n        this.currentTextMarkupAddMode = type;\n        var isCleared = true;\n        this.multiPageCollection = [];\n        var selectionObject = this.pdfViewer.textSelectionModule ? this.pdfViewer.textSelectionModule.selectionRangeArray : [];\n        if (selectionObject.length > 0 && !this.isSelectionMaintained) {\n            this.convertSelectionToTextMarkup(type, selectionObject, this.pdfViewerBase.getZoomFactor());\n        }\n        if (this.isEnableTextMarkupResizer(type) && this.isExtended && window.getSelection().toString()) {\n            var pageBounds = this.getDrawnBounds();\n            if (pageBounds[0] && pageBounds[0].bounds) {\n                // eslint-disable-next-line\n                var currentAnnot = this.currentTextMarkupAnnotation;\n                for (var k = 0; k < pageBounds.length; k++) {\n                    if (currentAnnot && currentAnnot.pageNumber === pageBounds[k].pageIndex) {\n                        this.currentTextMarkupAnnotation = currentAnnot;\n                        this.selectTextMarkupCurrentPage = pageBounds[k].pageIndex;\n                        this.updateTextMarkupAnnotationBounds(pageBounds, k);\n                    }\n                    else {\n                        if (currentAnnot) {\n                            if (type === '') {\n                                type = currentAnnot.textMarkupAnnotationType;\n                            }\n                        }\n                        if (!currentAnnot.isMultiSelect) {\n                            var isMultiSelect = false;\n                            if (this.isMultiAnnotation(type)) {\n                                this.multiPageCollection.push(currentAnnot);\n                                isMultiSelect = true;\n                            }\n                            // eslint-disable-next-line max-len\n                            this.drawTextMarkups(type, pageBounds[k].bounds, pageBounds[k].pageIndex, pageBounds[k].rect, this.pdfViewerBase.getZoomFactor(), pageBounds[k].textContent, pageBounds[k].startIndex, pageBounds[k].endIndex, isMultiSelect);\n                        }\n                        else {\n                            if (currentAnnot.isMultiSelect && currentAnnot.annotNameCollection) {\n                                this.modifyCurrentAnnotation(currentAnnot, pageBounds, k);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        else if (window.getSelection().toString()) {\n            var pageBounds = this.getDrawnBounds();\n            var isMultiSelect = this.isMultiPageAnnotations(pageBounds, type);\n            if (pageBounds.length > 0) {\n                for (var i = 0; i < pageBounds.length; i++) {\n                    if (type === '') {\n                        isCleared = false;\n                    }\n                    // eslint-disable-next-line max-len\n                    this.drawTextMarkups(type, pageBounds[i].bounds, pageBounds[i].pageIndex, pageBounds[i].rect, this.pdfViewerBase.getZoomFactor(), pageBounds[i].textContent, pageBounds[i].startIndex, pageBounds[i].endIndex, isMultiSelect);\n                }\n            }\n        }\n        if (this.multiPageCollection) {\n            for (var j = 0; j < this.multiPageCollection.length; j++) {\n                this.updateAnnotationNames(this.multiPageCollection[j], this.multiPageCollection[j].pageNumber);\n            }\n        }\n        this.isExtended = false;\n        this.isSelectionMaintained = false;\n        // this.pdfViewerBase.annotationHelper.redoCollection = [];\n        if (isCleared && this.pdfViewer.textSelectionModule) {\n            this.pdfViewer.textSelectionModule.clearTextSelection();\n        }\n        if (this.isEnableTextMarkupResizer(type)) {\n            this.updateAnnotationBounds();\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.isMultiPageAnnotations = function (pageBounds, type) {\n        var isMultiSelect = false;\n        for (var n = 0; n < pageBounds.length; n++) {\n            if (pageBounds[n].pageIndex !== pageBounds[0].pageIndex && this.isMultiAnnotation(type)) {\n                isMultiSelect = true;\n                break;\n            }\n        }\n        return isMultiSelect;\n    };\n    TextMarkupAnnotation.prototype.isMultiAnnotation = function (type) {\n        var isSelection = false;\n        if (type === 'Highlight' && this.pdfViewer.highlightSettings.enableMultiPageAnnotation) {\n            isSelection = true;\n        }\n        else if (type === 'Underline' && this.pdfViewer.underlineSettings.enableMultiPageAnnotation) {\n            isSelection = true;\n        }\n        else if (type === 'Strikethrough' && this.pdfViewer.strikethroughSettings.enableMultiPageAnnotation) {\n            isSelection = true;\n        }\n        else if (this.pdfViewer.enableMultiPageAnnotation) {\n            isSelection = true;\n        }\n        return isSelection;\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.modifyCurrentAnnotation = function (currentAnnot, pageBounds, index) {\n        for (var c = 0; c < currentAnnot.annotNameCollection.length; c++) {\n            // eslint-disable-next-line\n            var currentAnnots = currentAnnot.annotNameCollection[c];\n            var annotationList = this.getAnnotations(pageBounds[index].pageIndex, null);\n            if (annotationList) {\n                for (var z = 0; z < annotationList.length; z++) {\n                    if (annotationList[z].annotName === currentAnnots) {\n                        this.currentTextMarkupAnnotation = annotationList[z];\n                        this.selectTextMarkupCurrentPage = pageBounds[index].pageIndex;\n                        this.updateTextMarkupAnnotationBounds(pageBounds, index);\n                        break;\n                    }\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.drawAnnotationSelector = function (newAnnotation, annotation, newcanvas) {\n        for (var i = 0; i < newAnnotation.bounds.length; i++) {\n            // eslint-disable-next-line\n            var bound = newAnnotation.bounds[i];\n            var x = bound.left ? bound.left : bound.Left;\n            var y = bound.top ? bound.top : bound.Top;\n            var width = bound.width ? bound.width : bound.Width;\n            var height = bound.height ? bound.height : bound.Height;\n            if (!newcanvas) {\n                newcanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + newAnnotation.pageNumber);\n            }\n            // eslint-disable-next-line max-len\n            this.drawAnnotationSelectRect(newcanvas, this.getMagnifiedValue(x - 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(y - 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(width + 0.5, this.pdfViewerBase.getZoomFactor()), this.getMagnifiedValue(height + 0.5, this.pdfViewerBase.getZoomFactor()), annotation);\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.selectMultiPageAnnotations = function (annotation) {\n        for (var k = 0; k < annotation.annotNameCollection.length; k++) {\n            // eslint-disable-next-line\n            var currentAnnot = annotation.annotNameCollection[k];\n            if (currentAnnot !== annotation.annotName) {\n                for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n                    var currentPage = annotation.annotpageNumbers[p];\n                    var annotationList = this.getAnnotations(currentPage, null);\n                    if (annotationList) {\n                        for (var z = 0; z < annotationList.length; z++) {\n                            if (annotationList[z].annotName === currentAnnot) {\n                                // eslint-disable-next-line\n                                var newAnnotation = annotationList[z];\n                                this.drawAnnotationSelector(newAnnotation, annotation);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.deletMultiPageAnnotation = function (annotation) {\n        for (var k = 0; k < annotation.annotNameCollection.length; k++) {\n            // eslint-disable-next-line\n            var currentAnnot = annotation.annotNameCollection[k];\n            if (currentAnnot !== annotation.annotName) {\n                for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n                    var currentPage = annotation.annotpageNumbers[p];\n                    var annotationList = this.getAnnotations(currentPage, null);\n                    if (annotationList) {\n                        for (var z = 0; z < annotationList.length; z++) {\n                            if (annotationList[z].annotName === currentAnnot) {\n                                // eslint-disable-next-line\n                                var newAnnotation = annotationList[z];\n                                var deletedAnnotation = null;\n                                deletedAnnotation = annotationList.splice(z, 1)[0];\n                                this.pdfViewer.annotationModule.addAction(currentPage, z, deletedAnnotation, 'Text Markup Deleted', null);\n                                this.currentAnnotationIndex = z;\n                                this.pdfViewer.annotation.stickyNotesAnnotationModule.findPosition(deletedAnnotation, 'textMarkup');\n                                var removeDiv = document.getElementById(deletedAnnotation.annotName);\n                                if (removeDiv) {\n                                    if (removeDiv.parentElement.childElementCount === 1) {\n                                        this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAccordionContainer(removeDiv);\n                                    }\n                                    else {\n                                        removeDiv.remove();\n                                    }\n                                }\n                                this.pdfViewer.annotationModule.updateAnnotationCollection(newAnnotation);\n                                this.manageAnnotations(annotationList, currentPage);\n                                // eslint-disable-next-line max-len\n                                this.pdfViewer.annotationModule.updateImportAnnotationCollection(newAnnotation, newAnnotation.pageNumber, 'textMarkupAnnotation');\n                                var annotationId = newAnnotation.annotName;\n                                // eslint-disable-next-line\n                                var annotationBounds = newAnnotation.bounds;\n                                this.pdfViewer.annotationModule.renderAnnotations(currentPage, null, null, null);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.modifyMultiPageAnnotations = function (annotation, property, value) {\n        for (var k = 0; k < annotation.annotNameCollection.length; k++) {\n            // eslint-disable-next-line\n            var currentAnnot = annotation.annotNameCollection[k];\n            if (currentAnnot !== annotation.annotName) {\n                for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n                    var currentPage = annotation.annotpageNumbers[p];\n                    var annotationList = this.getAnnotations(currentPage, null);\n                    if (annotationList) {\n                        for (var z = 0; z < annotationList.length; z++) {\n                            if (annotationList[z].annotName === currentAnnot) {\n                                if (property === 'Color') {\n                                    annotationList[z].color = value;\n                                }\n                                else {\n                                    annotationList[z].opacity = value;\n                                }\n                                annotationList[z].modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n                                this.currentAnnotationIndex = z;\n                                if (status === null || status === 'changed') {\n                                    // eslint-disable-next-line max-len\n                                    this.pdfViewer.annotationModule.addAction(annotationList[z].pageNumber, z, annotationList[z], 'Text Markup Property modified', property);\n                                }\n                                this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAnnotationModifiedDate(annotationList[z]);\n                                this.manageAnnotations(annotationList, currentPage);\n                                this.pdfViewer.annotationModule.renderAnnotations(currentPage, null, null, null);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    TextMarkupAnnotation.prototype.convertSelectionToTextMarkup = function (type, selectionObject, factor) {\n        var isMultiSelect = false;\n        this.triggerAddEvent = false;\n        this.multiPageCollection = [];\n        for (var i = 0; i < selectionObject.length; i++) {\n            var textValue = selectionObject[i].textContent;\n            // eslint-disable-next-line\n            var indexes = void 0;\n            if (selectionObject[i].startNode === selectionObject[i].endNode) {\n                var parentText = document.getElementById(selectionObject[i].startNode).textContent;\n                indexes = this.getIndexNumbers(selectionObject[i].pageNumber, textValue, parentText);\n            }\n            else {\n                indexes = this.getIndexNumbers(selectionObject[i].pageNumber, textValue);\n            }\n            if (!isMultiSelect) {\n                for (var n = 1; n < selectionObject.length; n++) {\n                    if (selectionObject[n].pageNumber !== selectionObject[0].pageNumber && this.isMultiAnnotation(type)) {\n                        isMultiSelect = true;\n                        break;\n                    }\n                }\n            }\n            if (this.isMultiAnnotation(type) && (selectionObject.length - 1) === i) {\n                this.triggerAddEvent = true;\n            }\n            // eslint-disable-next-line max-len\n            this.drawTextMarkups(type, selectionObject[i].rectangleBounds, selectionObject[i].pageNumber, selectionObject[i].bound, factor, textValue, indexes.startIndex, indexes.endIndex, isMultiSelect);\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.updateTextMarkupAnnotationBounds = function (pageBounds, currentIndex) {\n        if (this.currentTextMarkupAnnotation) {\n            var pageAnnotations = this.getAnnotations(pageBounds[currentIndex].pageIndex, null);\n            var annotation = null;\n            if (pageAnnotations) {\n                for (var i = 0; i < pageAnnotations.length; i++) {\n                    if (JSON.stringify(this.currentTextMarkupAnnotation) === JSON.stringify(pageAnnotations[i])) {\n                        pageAnnotations[i].bounds = pageBounds[currentIndex].bounds;\n                        pageAnnotations[i].textMarkupContent = pageBounds[currentIndex].textContent;\n                        pageAnnotations[i].textMarkupStartIndex = pageBounds[currentIndex].startIndex;\n                        pageAnnotations[i].textMarkupEndIndex = pageBounds[currentIndex].endIndex;\n                        pageAnnotations[i].modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n                        annotation = pageAnnotations[i];\n                    }\n                }\n                this.manageAnnotations(pageAnnotations, pageBounds[currentIndex].pageIndex);\n                this.currentTextMarkupAnnotation = null;\n                this.pdfViewer.annotationModule.renderAnnotations(pageBounds[currentIndex].pageIndex, null, null, null);\n                this.pdfViewerBase.updateDocumentEditedProperty(true);\n                if (annotation) {\n                    // eslint-disable-next-line\n                    var settings = { opacity: annotation.opacity, color: annotation.color, author: annotation.author, subject: annotation.subject, modifiedDate: annotation.modifiedDate };\n                    // eslint-disable-next-line max-len\n                    var multiPageCollection = this.multiPageCollectionList(annotation);\n                    if (multiPageCollection.length > 0) {\n                        if ((pageBounds.length - 1) === currentIndex) {\n                            // eslint-disable-next-line max-len\n                            this.pdfViewer.fireAnnotationResize(pageBounds[currentIndex].pageIndex, annotation.annotName, annotation.textMarkupAnnotationType, annotation.bounds, settings, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex, null, multiPageCollection);\n                        }\n                    }\n                    else {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.fireAnnotationResize(pageBounds[currentIndex].pageIndex, annotation.annotName, annotation.textMarkupAnnotationType, annotation.bounds, settings, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex, null);\n                    }\n                }\n                // eslint-disable-next-line max-len\n                this.currentAnnotationIndex = null;\n                this.selectTextMarkupCurrentPage = null;\n            }\n        }\n    };\n    /**\n     * @param annotation\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.multiPageCollectionList = function (annotation) {\n        var multiPageCollectionList = [];\n        if (annotation.isMultiSelect && annotation.annotNameCollection) {\n            multiPageCollectionList.push(annotation);\n            for (var k = 0; k < annotation.annotNameCollection.length; k++) {\n                // eslint-disable-next-line\n                var currentAnnot = annotation.annotNameCollection[k];\n                if (currentAnnot !== annotation.annotName) {\n                    for (var p = 0; p < annotation.annotpageNumbers.length; p++) {\n                        var currentPage = annotation.annotpageNumbers[p];\n                        var annotationList = this.getAnnotations(currentPage, null);\n                        if (annotationList) {\n                            for (var z = 0; z < annotationList.length; z++) {\n                                if (annotationList[z].annotName === currentAnnot) {\n                                    multiPageCollectionList.push(annotationList[z]);\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return multiPageCollectionList;\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.updateAnnotationNames = function (annotations, pageNumber) {\n        if (annotations) {\n            var pageAnnotations = this.getAnnotations(pageNumber, null);\n            var annotation = null;\n            if (pageAnnotations) {\n                for (var i = 0; i < pageAnnotations.length; i++) {\n                    if (annotations.annotName === pageAnnotations[i].annotName) {\n                        // eslint-disable-next-line\n                        var annotNamesCollections = [];\n                        // eslint-disable-next-line\n                        var annotpageNumbers = [];\n                        for (var p = 0; p < this.multiPageCollection.length; p++) {\n                            annotNamesCollections.push(this.multiPageCollection[p].annotName);\n                            annotpageNumbers.push(this.multiPageCollection[p].pageNumber);\n                        }\n                        pageAnnotations[i].isMultiSelect = true;\n                        pageAnnotations[i].annotNameCollection = annotNamesCollections;\n                        pageAnnotations[i].annotpageNumbers = annotpageNumbers;\n                        annotation = pageAnnotations[i];\n                    }\n                }\n                this.manageAnnotations(pageAnnotations, pageNumber);\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.updateAnnotationContent = function (annotation, pageBound) {\n        if (annotation) {\n            var pageAnnotations = this.getAnnotations(this.selectTextMarkupCurrentPage, null);\n            var annotation_1 = null;\n            if (pageAnnotations) {\n                for (var i = 0; i < pageAnnotations.length; i++) {\n                    if (JSON.stringify(this.currentTextMarkupAnnotation) === JSON.stringify(pageAnnotations[i])) {\n                        pageAnnotations[i].textMarkupContent = pageBound.textContent;\n                        pageAnnotations[i].textMarkupStartIndex = pageBound.startIndex;\n                        pageAnnotations[i].textMarkupEndIndex = pageBound.endIndex;\n                        annotation_1 = pageAnnotations[i];\n                    }\n                    this.pdfViewer.annotationModule.storeAnnotationCollections(pageAnnotations[i], this.selectTextMarkupCurrentPage);\n                }\n                this.manageAnnotations(pageAnnotations, this.selectTextMarkupCurrentPage);\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.drawTextMarkups = function (type, bounds, pageNumber, rect, factor, textContent, startIndex, endIndex, isMultiSelect) {\n        var annotation = null;\n        this.isNewAnnotation = false;\n        var author = 'Guest';\n        var subject;\n        var context = this.getPageContext(pageNumber);\n        var modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n        this.highlightColor = this.highlightColor ? this.highlightColor : this.pdfViewer.highlightSettings.color;\n        this.underlineColor = this.underlineColor ? this.underlineColor : this.pdfViewer.underlineSettings.color;\n        this.strikethroughColor = this.strikethroughColor ? this.strikethroughColor : this.pdfViewer.strikethroughSettings.color;\n        this.highlightOpacity = this.pdfViewer.highlightSettings.opacity;\n        this.underlineOpacity = this.pdfViewer.underlineSettings.opacity;\n        this.strikethroughOpacity = this.pdfViewer.strikethroughSettings.opacity;\n        this.annotationAddMode = 'UI Drawn Annotation';\n        // eslint-disable-next-line\n        var allowedInteractions;\n        if (context) {\n            context.setLineDash([]);\n            switch (type) {\n                case 'Highlight':\n                    this.isNewAnnotation = true;\n                    subject = 'Highlight';\n                    // eslint-disable-next-line max-len\n                    author = (this.pdfViewer.highlightSettings.author !== 'Guest' && this.pdfViewer.highlightSettings.author) ? this.pdfViewer.highlightSettings.author : this.pdfViewer.annotationSettings.author ? this.pdfViewer.annotationSettings.author : 'Guest';\n                    allowedInteractions = this.pdfViewer.highlightSettings.allowedInteractions ? this.pdfViewer.highlightSettings.allowedInteractions : 'None';\n                    // eslint-disable-next-line max-len\n                    annotation = this.getAddedAnnotation(type, this.highlightColor, this.highlightOpacity, bounds, author, subject, modifiedDate, '', false, rect, pageNumber, textContent, startIndex, endIndex, isMultiSelect, allowedInteractions);\n                    if (annotation) {\n                        // eslint-disable-next-line max-len\n                        this.renderHighlightAnnotation(annotation.bounds, annotation.opacity, annotation.color, context, factor, annotation.isPrint, pageNumber);\n                    }\n                    break;\n                case 'Strikethrough':\n                    this.isNewAnnotation = true;\n                    subject = 'Strikethrough';\n                    // eslint-disable-next-line max-len\n                    author = (this.pdfViewer.strikethroughSettings.author !== 'Guest' && this.pdfViewer.strikethroughSettings.author) ? this.pdfViewer.strikethroughSettings.author : this.pdfViewer.annotationSettings.author ? this.pdfViewer.annotationSettings.author : 'Guest';\n                    allowedInteractions = this.pdfViewer.strikethroughSettings.allowedInteractions ? this.pdfViewer.strikethroughSettings.allowedInteractions : 'None';\n                    // eslint-disable-next-line max-len\n                    annotation = this.getAddedAnnotation(type, this.strikethroughColor, this.strikethroughOpacity, bounds, author, subject, modifiedDate, '', false, rect, pageNumber, textContent, startIndex, endIndex, isMultiSelect, allowedInteractions);\n                    if (annotation) {\n                        // eslint-disable-next-line max-len\n                        this.renderStrikeoutAnnotation(annotation.bounds, annotation.opacity, annotation.color, context, factor, pageNumber, annotation.isPrint);\n                    }\n                    break;\n                case 'Underline':\n                    this.isNewAnnotation = true;\n                    subject = 'Underline';\n                    // eslint-disable-next-line max-len\n                    author = (this.pdfViewer.underlineSettings.author !== 'Guest' && this.pdfViewer.underlineSettings.author) ? this.pdfViewer.underlineSettings.author : this.pdfViewer.annotationSettings.author ? this.pdfViewer.annotationSettings.author : 'Guest';\n                    allowedInteractions = this.pdfViewer.underlineSettings.allowedInteractions ? this.pdfViewer.underlineSettings.allowedInteractions : 'None';\n                    // eslint-disable-next-line max-len\n                    annotation = this.getAddedAnnotation(type, this.underlineColor, this.underlineOpacity, bounds, author, subject, modifiedDate, '', false, rect, pageNumber, textContent, startIndex, endIndex, isMultiSelect, allowedInteractions);\n                    if (annotation) {\n                        // eslint-disable-next-line max-len\n                        this.renderUnderlineAnnotation(annotation.bounds, annotation.opacity, annotation.color, context, factor, pageNumber, annotation.isPrint);\n                    }\n                    break;\n            }\n            this.isNewAnnotation = false;\n            if (annotation) {\n                this.pdfViewerBase.updateDocumentEditedProperty(true);\n                // eslint-disable-next-line\n                var settings = { opacity: annotation.opacity, color: annotation.color, author: annotation.author, subject: annotation.subject, modifiedDate: annotation.modifiedDate };\n                var index = this.pdfViewer.annotationModule.actionCollection[this.pdfViewer.annotationModule.actionCollection.length - 1].index;\n                // eslint-disable-next-line max-len\n                if (this.isMultiAnnotation(type)) {\n                    if (this.triggerAddEvent) {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.fireAnnotationAdd(pageNumber, annotation.annotName, type, annotation.bounds, settings, textContent, startIndex, endIndex, null, this.multiPageCollection);\n                    }\n                }\n                else {\n                    // eslint-disable-next-line max-len\n                    this.pdfViewer.fireAnnotationAdd(pageNumber, annotation.annotName, type, annotation.bounds, settings, textContent, startIndex, endIndex);\n                }\n            }\n            if (Browser.isDevice && !this.pdfViewer.enableDesktopMode && this.pdfViewer.enableToolbar && this.pdfViewer.enableAnnotationToolbar) {\n                this.pdfViewer.toolbarModule.annotationToolbarModule.createPropertyTools(type);\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.retreiveTextIndex = function (annotation) {\n        if (annotation.textMarkupContent === '') {\n            this.retreieveSelection(annotation, null);\n            var pageBounds = this.getDrawnBounds();\n            window.getSelection().removeAllRanges();\n            if (pageBounds[0] && pageBounds[0].bounds) {\n                this.updateAnnotationContent(annotation, pageBounds[0]);\n                annotation.textMarkupContent = pageBounds[0].textContent;\n                annotation.textMarkupStartIndex = pageBounds[0].startIndex;\n                annotation.textMarkupEndIndex = pageBounds[0].endIndex;\n            }\n        }\n        return annotation;\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.renderHighlightAnnotation = function (bounds, opacity, color, context, factor, isPrint, pageIndex) {\n        var zoomRatio = this.pdfViewerBase.getZoomRatio(factor);\n        for (var i = 0; i < bounds.length; i++) {\n            // eslint-disable-next-line\n            var bound = bounds[i];\n            context.beginPath();\n            var x = bound.X ? bound.X : bound.left;\n            var y = bound.Y ? bound.Y : bound.top;\n            var width = bound.Width ? bound.Width : bound.width;\n            var height = bound.Height ? bound.Height : bound.height;\n            x = x ? x : bound.x;\n            y = y ? y : bound.y;\n            // The highlighted position is slightly increased. So Subtract -1 from the height. \n            height = height - 1;\n            if (context.canvas.id === this.pdfViewer.element.id + '_print_annotation_layer_' + pageIndex) {\n                if (isPrint) {\n                    // eslint-disable-next-line max-len\n                    context.rect((x * zoomRatio), (y * zoomRatio), (width * zoomRatio), (height * zoomRatio));\n                    context.globalAlpha = opacity * 0.5;\n                    context.closePath();\n                    context.fillStyle = color;\n                    context.msFillRule = 'nonzero';\n                    context.fill();\n                }\n            }\n            else {\n                // eslint-disable-next-line max-len\n                context.rect((x * zoomRatio), (y * zoomRatio), (width * zoomRatio), (height * zoomRatio));\n                context.globalAlpha = opacity * 0.5;\n                context.closePath();\n                context.fillStyle = color;\n                context.msFillRule = 'nonzero';\n                context.fill();\n            }\n        }\n        context.save();\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.renderStrikeoutAnnotation = function (bounds, opacity, color, context, factor, pageNumber, isPrint) {\n        for (var i = 0; i < bounds.length; i++) {\n            // eslint-disable-next-line\n            var bound = this.getProperBounds(bounds[i]);\n            var pageDetails = this.pdfViewerBase.pageSize[pageNumber];\n            var factorRatio = this.pdfViewerBase.getZoomRatio(factor);\n            if (context.canvas.id === this.pdfViewer.element.id + '_print_annotation_layer_' + pageNumber) {\n                if (isPrint) {\n                    if (pageDetails.rotation === 1) {\n                        // eslint-disable-next-line max-len\n                        this.drawLine(opacity, (bound.x + (bound.width / 2)), bound.y, bound.width, bound.height, color, factorRatio, context, pageNumber);\n                    }\n                    else if (pageDetails.rotation === 2) {\n                        // eslint-disable-next-line max-len\n                        this.drawLine(opacity, bound.x, (bound.y + (bound.height / 2)), bound.width, bound.height, color, factorRatio, context, pageNumber);\n                    }\n                    else if (pageDetails.rotation === 3) {\n                        this.drawLine(opacity, bound.x, bound.y, (bound.width / 2), bound.height, color, factorRatio, context, pageNumber);\n                    }\n                    else {\n                        this.drawLine(opacity, bound.x, bound.y, bound.width, (bound.height / 2), color, factorRatio, context, pageNumber);\n                    }\n                }\n            }\n            else {\n                if (pageDetails.rotation === 1) {\n                    // eslint-disable-next-line max-len\n                    this.drawLine(opacity, (bound.x + (bound.width / 2)), bound.y, bound.width, bound.height, color, factorRatio, context, pageNumber);\n                }\n                else if (pageDetails.rotation === 2) {\n                    // eslint-disable-next-line max-len\n                    this.drawLine(opacity, bound.x, (bound.y + (bound.height / 2)), bound.width, bound.height, color, factorRatio, context, pageNumber);\n                }\n                else if (pageDetails.rotation === 3) {\n                    this.drawLine(opacity, bound.x, bound.y, (bound.width / 2), bound.height, color, factorRatio, context, pageNumber);\n                }\n                else {\n                    this.drawLine(opacity, bound.x, bound.y, bound.width, (bound.height / 2), color, factorRatio, context, pageNumber);\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.renderUnderlineAnnotation = function (bounds, opacity, color, context, factor, pageNumber, isPrint) {\n        for (var i = 0; i < bounds.length; i++) {\n            // eslint-disable-next-line\n            var boundValues = this.getProperBounds(bounds[i]);\n            var factorRatio = this.pdfViewerBase.getZoomRatio(factor);\n            if (context.canvas.id === this.pdfViewer.element.id + '_print_annotation_layer_' + pageNumber) {\n                if (isPrint) {\n                    // eslint-disable-next-line max-len\n                    this.drawLine(opacity, boundValues.x, boundValues.y, boundValues.width, boundValues.height, color, factorRatio, context, pageNumber);\n                }\n            }\n            else {\n                // eslint-disable-next-line max-len\n                this.drawLine(opacity, boundValues.x, boundValues.y, boundValues.width, boundValues.height, color, factorRatio, context, pageNumber);\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.getProperBounds = function (bound) {\n        var x = bound.X ? bound.X : bound.left;\n        var y = bound.Y ? bound.Y : bound.top;\n        var width = bound.Width ? bound.Width : bound.width;\n        var height = bound.Height ? bound.Height : bound.height;\n        x = x ? x : bound.x;\n        y = y ? y : bound.y;\n        return { x: x, y: y, width: width, height: height };\n    };\n    // eslint-disable-next-line max-len\n    TextMarkupAnnotation.prototype.drawLine = function (opacity, x, y, width, height, color, factor, context, pageNumber) {\n        context.globalAlpha = opacity;\n        if (isBlazor()) {\n            y = y - 1;\n        }\n        height = height - 1;\n        context.beginPath();\n        var pageDetails = this.pdfViewerBase.pageSize[pageNumber];\n        if (pageDetails.rotation === 1) {\n            context.moveTo((x * factor), (y * factor));\n            context.lineTo((x * factor), (y + height) * factor);\n        }\n        else if (pageDetails.rotation === 2) {\n            context.moveTo((x * factor), (y * factor));\n            context.lineTo((width + x) * factor, (y * factor));\n        }\n        else if (pageDetails.rotation === 3) {\n            context.moveTo((width + x) * factor, (y * factor));\n            context.lineTo((width + x) * factor, (y + height) * factor);\n        }\n        else {\n            context.moveTo((x * factor), (y + height) * factor);\n            context.lineTo((width + x) * factor, (y + height) * factor);\n        }\n        context.lineWidth = 1;\n        context.strokeStyle = color;\n        context.closePath();\n        context.msFillRule = 'nonzero';\n        context.stroke();\n    };\n    /**\n     * @param textMarkupAnnotations\n     * @param pageIndex\n     * @param stampData\n     * @param shapeData\n     * @param measureShapeData\n     * @param stickyData\n     * @param textMarkupAnnotations\n     * @param pageIndex\n     * @param stampData\n     * @param shapeData\n     * @param measureShapeData\n     * @param stickyData\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.printTextMarkupAnnotations = function (textMarkupAnnotations, pageIndex, stampData, shapeData, measureShapeData, stickyData) {\n        var canvas = createElement('canvas', { id: this.pdfViewer.element.id + '_print_annotation_layer_' + pageIndex });\n        canvas.style.width = 816 + 'px';\n        canvas.style.height = 1056 + 'px';\n        var pageWidth = this.pdfViewerBase.pageSize[pageIndex].width;\n        var pageHeight = this.pdfViewerBase.pageSize[pageIndex].height;\n        var zoom = this.pdfViewerBase.getZoomFactor();\n        var zoomRatio = this.pdfViewerBase.getZoomRatio(zoom);\n        canvas.height = pageHeight * zoomRatio;\n        canvas.width = pageWidth * zoomRatio;\n        // eslint-disable-next-line\n        var textMarkupannotations = this.getAnnotations(pageIndex, null, '_annotations_textMarkup');\n        // eslint-disable-next-line\n        var shapeAnnotation = this.getAnnotations(pageIndex, null, '_annotations_shape');\n        // eslint-disable-next-line\n        var measureShapeAnnotation = this.getAnnotations(pageIndex, null, '_annotations_shape_measure');\n        // eslint-disable-next-line\n        var stampAnnotation = this.getAnnotations(pageIndex, null, '_annotations_stamp');\n        // eslint-disable-next-line\n        var stickyNoteAnnotation = this.getAnnotations(pageIndex, null, '_annotations_sticky');\n        if (stampAnnotation || shapeAnnotation || stickyNoteAnnotation || measureShapeAnnotation) {\n            this.pdfViewer.renderDrawing(canvas, pageIndex);\n        }\n        else {\n            this.pdfViewer.annotation.renderAnnotations(pageIndex, shapeData, measureShapeData, null, canvas);\n            this.pdfViewer.annotation.stampAnnotationModule.renderStampAnnotations(stampData, pageIndex, canvas);\n            this.pdfViewer.annotation.stickyNotesAnnotationModule.renderStickyNotesAnnotations(stickyData, pageIndex, canvas);\n        }\n        var zoomFactor = this.pdfViewerBase.getZoomFactor();\n        if (textMarkupannotations) {\n            this.renderTextMarkupAnnotations(null, pageIndex, canvas, zoomFactor);\n        }\n        else {\n            this.renderTextMarkupAnnotations(textMarkupAnnotations, pageIndex, canvas, zoomFactor);\n        }\n        var imageSource = canvas.toDataURL();\n        return imageSource;\n    };\n    /**\n     * @private\n     */\n    TextMarkupAnnotation.prototype.saveTextMarkupAnnotations = function () {\n        // eslint-disable-next-line\n        var storeTextMarkupObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n        if (this.pdfViewerBase.isStorageExceed) {\n            storeTextMarkupObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_textMarkup'];\n        }\n        // eslint-disable-next-line\n        var textMarkupAnnotations = new Array();\n        for (var j = 0; j < this.pdfViewerBase.pageCount; j++) {\n            textMarkupAnnotations[j] = [];\n        }\n        if (storeTextMarkupObject && !this.pdfViewer.annotationSettings.skipDownload) {\n            var textMarkupAnnotationCollection = JSON.parse(storeTextMarkupObject);\n            for (var i = 0; i < textMarkupAnnotationCollection.length; i++) {\n                var newArray = [];\n                var pageAnnotationObject = textMarkupAnnotationCollection[i];\n                if (pageAnnotationObject) {\n                    for (var z = 0; pageAnnotationObject.annotations.length > z; z++) {\n                        this.pdfViewer.annotationModule.updateModifiedDate(pageAnnotationObject.annotations[z]);\n                        if (this.pdfViewerBase.isJsonExported) {\n                            if (pageAnnotationObject.annotations[z].isAnnotationRotated) {\n                                pageAnnotationObject.annotations[z].bounds = this.getBoundsForSave(pageAnnotationObject.annotations[z].bounds, i);\n                            }\n                            else {\n                                var pageDetails = this.pdfViewerBase.pageSize[pageAnnotationObject.pageIndex];\n                                if (pageDetails) {\n                                    pageAnnotationObject.annotations[z].annotationRotation = pageDetails.rotation;\n                                }\n                            }\n                        }\n                        // eslint-disable-next-line max-len\n                        pageAnnotationObject.annotations[z].bounds = JSON.stringify(this.getBoundsForSave(pageAnnotationObject.annotations[z].bounds, i));\n                        var colorString = pageAnnotationObject.annotations[z].color;\n                        pageAnnotationObject.annotations[z].color = JSON.stringify(this.getRgbCode(colorString));\n                        pageAnnotationObject.annotations[z].rect = JSON.stringify(pageAnnotationObject.annotations[z].rect);\n                    }\n                    newArray = pageAnnotationObject.annotations;\n                }\n                textMarkupAnnotations[pageAnnotationObject.pageIndex] = newArray;\n            }\n        }\n        return JSON.stringify(textMarkupAnnotations);\n    };\n    /**\n     * @private\n     */\n    TextMarkupAnnotation.prototype.deleteTextMarkupAnnotation = function () {\n        if (this.currentTextMarkupAnnotation) {\n            var isLock = false;\n            if (this.currentTextMarkupAnnotation.annotationSettings) {\n                // eslint-disable-next-line\n                isLock = this.currentTextMarkupAnnotation.annotationSettings.isLock;\n                if (this.pdfViewer.annotationModule.checkAllowedInteractions('Delete', this.currentTextMarkupAnnotation)) {\n                    isLock = false;\n                }\n            }\n            if (!isLock) {\n                var deletedAnnotation = null;\n                this.showHideDropletDiv(true);\n                // eslint-disable-next-line\n                var annotation = this.currentTextMarkupAnnotation;\n                if (this.currentTextMarkupAnnotation.isMultiSelect && annotation.annotNameCollection) {\n                    this.deletMultiPageAnnotation(annotation);\n                }\n                var pageAnnotations = this.getAnnotations(this.selectTextMarkupCurrentPage, null);\n                if (pageAnnotations) {\n                    for (var i = 0; i < pageAnnotations.length; i++) {\n                        if (this.currentTextMarkupAnnotation.annotName === pageAnnotations[i].annotName) {\n                            deletedAnnotation = pageAnnotations.splice(i, 1)[0];\n                            // eslint-disable-next-line max-len\n                            this.pdfViewer.annotationModule.addAction(this.selectTextMarkupCurrentPage, i, deletedAnnotation, 'Text Markup Deleted', null);\n                            this.currentAnnotationIndex = i;\n                            this.pdfViewer.annotation.stickyNotesAnnotationModule.findPosition(deletedAnnotation, 'textMarkup');\n                            var removeDiv = document.getElementById(deletedAnnotation.annotName);\n                            if (removeDiv) {\n                                if (removeDiv.parentElement.childElementCount === 1) {\n                                    this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAccordionContainer(removeDiv);\n                                }\n                                else {\n                                    removeDiv.remove();\n                                }\n                            }\n                        }\n                    }\n                    this.pdfViewer.annotationModule.updateAnnotationCollection(this.currentTextMarkupAnnotation);\n                    this.manageAnnotations(pageAnnotations, this.selectTextMarkupCurrentPage);\n                    // eslint-disable-next-line max-len\n                    this.pdfViewer.annotationModule.updateImportAnnotationCollection(this.currentTextMarkupAnnotation, this.currentTextMarkupAnnotation.pageNumber, 'textMarkupAnnotation');\n                    var annotationId = this.currentTextMarkupAnnotation.annotName;\n                    // eslint-disable-next-line\n                    var annotationBounds = this.currentTextMarkupAnnotation.bounds;\n                    this.currentTextMarkupAnnotation = null;\n                    this.pdfViewer.annotationModule.renderAnnotations(this.selectTextMarkupCurrentPage, null, null, null);\n                    this.pdfViewerBase.updateDocumentEditedProperty(true);\n                    // eslint-disable-next-line max-len\n                    var multiPageCollection = this.multiPageCollectionList(annotation);\n                    if (multiPageCollection.length > 0) {\n                        multiPageCollection.push(deletedAnnotation);\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.fireAnnotationRemove(this.selectTextMarkupCurrentPage, annotationId, deletedAnnotation.textMarkupAnnotationType, annotationBounds, deletedAnnotation.textMarkupContent, deletedAnnotation.textMarkupStartIndex, deletedAnnotation.textMarkupEndIndex, multiPageCollection);\n                    }\n                    else {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.fireAnnotationRemove(this.selectTextMarkupCurrentPage, annotationId, deletedAnnotation.textMarkupAnnotationType, annotationBounds, deletedAnnotation.textMarkupContent, deletedAnnotation.textMarkupStartIndex, deletedAnnotation.textMarkupEndIndex);\n                    }\n                    this.currentAnnotationIndex = null;\n                    this.selectTextMarkupCurrentPage = null;\n                    if (Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.hideMobileAnnotationToolbar();\n                        this.pdfViewer.toolbarModule.showToolbar(true);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @param color\n     * @private\n     */\n    TextMarkupAnnotation.prototype.modifyColorProperty = function (color) {\n        if (this.currentTextMarkupAnnotation) {\n            var pageAnnotations = this.modifyAnnotationProperty('Color', color, null);\n            this.manageAnnotations(pageAnnotations, this.selectTextMarkupCurrentPage);\n            this.pdfViewer.annotationModule.renderAnnotations(this.selectTextMarkupCurrentPage, null, null, null);\n            this.pdfViewerBase.updateDocumentEditedProperty(true);\n            // eslint-disable-next-line\n            var annotation = this.currentTextMarkupAnnotation;\n            // eslint-disable-next-line max-len\n            var multiPageCollection = this.multiPageCollectionList(annotation);\n            if (multiPageCollection.length > 0) {\n                // eslint-disable-next-line max-len\n                this.pdfViewer.fireAnnotationPropertiesChange(this.selectTextMarkupCurrentPage, annotation.annotName, annotation.textMarkupAnnotationType, true, false, false, false, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex, multiPageCollection);\n                this.currentAnnotationIndex = null;\n            }\n            else {\n                // eslint-disable-next-line max-len\n                this.pdfViewer.fireAnnotationPropertiesChange(this.selectTextMarkupCurrentPage, annotation.annotName, annotation.textMarkupAnnotationType, true, false, false, false, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex);\n                this.currentAnnotationIndex = null;\n            }\n        }\n    };\n    /**\n     * @param args\n     * @param isOpacity\n     * @private\n     */\n    TextMarkupAnnotation.prototype.modifyOpacityProperty = function (args, isOpacity) {\n        if (this.currentTextMarkupAnnotation) {\n            var pageAnnotations = void 0;\n            if (isOpacity) {\n                pageAnnotations = this.modifyAnnotationProperty('Opacity', isOpacity, 'changed');\n            }\n            else {\n                pageAnnotations = this.modifyAnnotationProperty('Opacity', args.value / 100, args.name);\n            }\n            if (pageAnnotations) {\n                this.manageAnnotations(pageAnnotations, this.selectTextMarkupCurrentPage);\n                this.pdfViewer.annotationModule.renderAnnotations(this.selectTextMarkupCurrentPage, null, null, null);\n                if (isOpacity || args.name === 'changed') {\n                    this.pdfViewerBase.updateDocumentEditedProperty(true);\n                    // eslint-disable-next-line\n                    var annotation = this.currentTextMarkupAnnotation;\n                    // eslint-disable-next-line max-len\n                    var multiPageCollection = this.multiPageCollectionList(annotation);\n                    if (multiPageCollection.length > 0) {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.fireAnnotationPropertiesChange(this.selectTextMarkupCurrentPage, annotation.annotName, annotation.textMarkupAnnotationType, false, true, false, false, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex, multiPageCollection);\n                        this.currentAnnotationIndex = null;\n                    }\n                    else {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.fireAnnotationPropertiesChange(this.selectTextMarkupCurrentPage, annotation.annotName, annotation.textMarkupAnnotationType, false, true, false, false, annotation.textMarkupContent, annotation.textMarkupStartIndex, annotation.textMarkupEndIndex);\n                        this.currentAnnotationIndex = null;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @param property\n     * @param value\n     * @param status\n     * @param annotName\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.modifyAnnotationProperty = function (property, value, status, annotName) {\n        // eslint-disable-next-line\n        var annotation = this.currentTextMarkupAnnotation;\n        if (annotation.isMultiSelect && annotation.annotNameCollection) {\n            this.modifyMultiPageAnnotations(annotation, property, value);\n        }\n        var pageAnnotations = this.getAnnotations(this.selectTextMarkupCurrentPage, null);\n        if (pageAnnotations) {\n            for (var i = 0; i < pageAnnotations.length; i++) {\n                if (JSON.stringify(this.currentTextMarkupAnnotation) === JSON.stringify(pageAnnotations[i])) {\n                    if (property === 'Color') {\n                        pageAnnotations[i].color = value;\n                    }\n                    else if (property === 'Opacity') {\n                        pageAnnotations[i].opacity = value;\n                    }\n                    else if (property === 'AnnotationSettings') {\n                        pageAnnotations[i].annotationSettings = { isLock: value };\n                    }\n                    pageAnnotations[i].modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n                    this.currentAnnotationIndex = i;\n                    if (status === null || status === 'changed') {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.annotationModule.addAction(this.selectTextMarkupCurrentPage, i, this.currentTextMarkupAnnotation, 'Text Markup Property modified', property);\n                    }\n                    this.currentTextMarkupAnnotation = pageAnnotations[i];\n                    this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAnnotationModifiedDate(pageAnnotations[i]);\n                    this.pdfViewer.annotationModule.storeAnnotationCollections(pageAnnotations[i], this.selectTextMarkupCurrentPage);\n                }\n            }\n        }\n        return pageAnnotations;\n    };\n    /**\n     * @param annotation\n     * @param pageNumber\n     * @param index\n     * @param action\n     * @private\n     */\n    TextMarkupAnnotation.prototype.undoTextMarkupAction = function (annotation, pageNumber, index, action) {\n        var pageAnnotations = this.getAnnotations(pageNumber, null);\n        if (pageAnnotations) {\n            if (action === 'Text Markup Added') {\n                this.pdfViewer.annotation.stickyNotesAnnotationModule.findPosition(pageAnnotations[index], 'textMarkup');\n                // eslint-disable-next-line\n                var removeDiv = document.getElementById(pageAnnotations[index].annotName);\n                if (removeDiv) {\n                    if (removeDiv.parentElement.childElementCount === 1) {\n                        this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAccordionContainer(removeDiv);\n                    }\n                    else {\n                        removeDiv.parentElement.removeChild(removeDiv);\n                    }\n                }\n                pageAnnotations.splice(index, 1);\n            }\n            else if (action === 'Text Markup Deleted') {\n                // eslint-disable-next-line max-len\n                this.pdfViewer.annotationModule.stickyNotesAnnotationModule.addAnnotationComments(pageNumber, annotation.shapeAnnotationType);\n                pageAnnotations.splice(index, 0, annotation);\n            }\n        }\n        this.clearCurrentAnnotation();\n        this.pdfViewerBase.updateDocumentEditedProperty(true);\n        this.manageAnnotations(pageAnnotations, pageNumber);\n        this.pdfViewer.annotationModule.renderAnnotations(pageNumber, null, null, null);\n    };\n    /**\n     * @param annotation\n     * @param pageNumber\n     * @param index\n     * @param property\n     * @param isUndoAction\n     * @param annotation\n     * @param pageNumber\n     * @param index\n     * @param property\n     * @param isUndoAction\n     * @param annotation\n     * @param pageNumber\n     * @param index\n     * @param property\n     * @param isUndoAction\n     * @param annotation\n     * @param pageNumber\n     * @param index\n     * @param property\n     * @param isUndoAction\n     * @private\n     */\n    // eslint-disable-next-line max-len\n    TextMarkupAnnotation.prototype.undoRedoPropertyChange = function (annotation, pageNumber, index, property, isUndoAction) {\n        var pageAnnotations = this.getAnnotations(pageNumber, null);\n        if (pageAnnotations) {\n            if (property === 'Color') {\n                var tempColor = pageAnnotations[index].color;\n                pageAnnotations[index].color = annotation.color;\n                annotation.color = tempColor;\n            }\n            else {\n                var tempOpacity = pageAnnotations[index].opacity;\n                pageAnnotations[index].opacity = annotation.opacity;\n                annotation.opacity = tempOpacity;\n            }\n            this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAnnotationModifiedDate(annotation, null, true);\n            if (isUndoAction) {\n                annotation.modifiedDate = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n            }\n        }\n        this.clearCurrentAnnotation();\n        this.pdfViewerBase.updateDocumentEditedProperty(true);\n        this.manageAnnotations(pageAnnotations, pageNumber);\n        this.pdfViewer.annotationModule.renderAnnotations(pageNumber, null, null, null);\n        return annotation;\n    };\n    /**\n     * @param annotation\n     * @param pageNumber\n     * @param index\n     * @param action\n     * @private\n     */\n    TextMarkupAnnotation.prototype.redoTextMarkupAction = function (annotation, pageNumber, index, action) {\n        var pageAnnotations = this.getAnnotations(pageNumber, null);\n        if (pageAnnotations) {\n            if (action === 'Text Markup Added') {\n                // eslint-disable-next-line max-len\n                this.pdfViewer.annotationModule.stickyNotesAnnotationModule.addAnnotationComments(pageNumber, annotation.shapeAnnotationType);\n                pageAnnotations.push(annotation);\n            }\n            else if (action === 'Text Markup Deleted') {\n                this.pdfViewer.annotation.stickyNotesAnnotationModule.findPosition(pageAnnotations[index], 'textMarkup');\n                // eslint-disable-next-line\n                var removeDiv = document.getElementById(pageAnnotations[index].annotName);\n                if (removeDiv) {\n                    if (removeDiv.parentElement.childElementCount === 1) {\n                        this.pdfViewer.annotationModule.stickyNotesAnnotationModule.updateAccordionContainer(removeDiv);\n                    }\n                    else {\n                        removeDiv.remove();\n                    }\n                }\n                pageAnnotations.splice(index, 1);\n            }\n        }\n        this.clearCurrentAnnotation();\n        this.pdfViewerBase.updateDocumentEditedProperty(true);\n        this.manageAnnotations(pageAnnotations, pageNumber);\n        this.pdfViewer.annotationModule.renderAnnotations(pageNumber, null, null, null);\n    };\n    /**\n     * @param pageNumber\n     * @param note\n     * @param pageNumber\n     * @param note\n     * @private\n     */\n    TextMarkupAnnotation.prototype.saveNoteContent = function (pageNumber, note) {\n        var pageAnnotations = this.getAnnotations(pageNumber, null);\n        if (pageAnnotations) {\n            for (var i = 0; i < pageAnnotations.length; i++) {\n                if (JSON.stringify(this.currentTextMarkupAnnotation) === JSON.stringify(pageAnnotations[i])) {\n                    pageAnnotations[i].note = note;\n                }\n            }\n        }\n        this.manageAnnotations(pageAnnotations, pageNumber);\n        this.pdfViewerBase.updateDocumentEditedProperty(true);\n    };\n    TextMarkupAnnotation.prototype.clearCurrentAnnotation = function () {\n        if (!this.isExtended) {\n            if (this.pdfViewer.isMaintainSelection && !this.pdfViewer.textSelectionModule.isTextSelection) {\n                this.selectTextMarkupCurrentPage = this.selectTextMarkupCurrentPage;\n                this.currentTextMarkupAnnotation = this.currentTextMarkupAnnotation;\n            }\n            else {\n                this.selectTextMarkupCurrentPage = null;\n                this.currentTextMarkupAnnotation = null;\n            }\n            var isSkip = false;\n            // eslint-disable-next-line max-len\n            if (this.pdfViewer.annotation.freeTextAnnotationModule && this.pdfViewer.annotation.freeTextAnnotationModule.isInuptBoxInFocus) {\n                isSkip = true;\n            }\n            if (!isSkip) {\n                this.enableAnnotationPropertiesTool(false);\n            }\n        }\n    };\n    /**\n     * @param pageNumber\n     * @param isSelect\n     * @param pageNumber\n     * @param isSelect\n     * @private\n     */\n    TextMarkupAnnotation.prototype.clearCurrentAnnotationSelection = function (pageNumber, isSelect) {\n        if (isSelect) {\n            this.isAnnotationSelect = true;\n        }\n        else {\n            this.isAnnotationSelect = false;\n        }\n        var lowerPageIndex = (pageNumber - 2) >= 0 ? (pageNumber - 2) : 0;\n        // eslint-disable-next-line max-len\n        var higherPageIndex = (pageNumber + 2) < this.pdfViewerBase.pageCount ? (pageNumber + 2) : this.pdfViewerBase.pageCount - 1;\n        for (var k = lowerPageIndex; k <= higherPageIndex; k++) {\n            this.clearAnnotationSelection(k);\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.getBoundsForSave = function (bounds, pageIndex) {\n        // eslint-disable-next-line\n        var newArray = [];\n        for (var i = 0; i < bounds.length; i++) {\n            // eslint-disable-next-line\n            var bound = this.getAnnotationBounds(bounds[i], pageIndex);\n            newArray.push(bound);\n        }\n        return newArray;\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.getAnnotationBounds = function (bounds, pageIndex) {\n        var left = bounds.left ? bounds.left : bounds.Left;\n        var top = bounds.top ? bounds.top : bounds.Top;\n        var height = bounds.height ? bounds.height : bounds.Height;\n        var width = bounds.width ? bounds.width : bounds.Width;\n        var pageDetails = this.pdfViewerBase.pageSize[pageIndex];\n        left = left ? left : bounds.x;\n        top = top ? top : bounds.y;\n        if (pageDetails) {\n            if (pageDetails.rotation === 1) {\n                return { left: top, top: pageDetails.width - (left + width), width: height, height: width };\n            }\n            else if (pageDetails.rotation === 2) {\n                // eslint-disable-next-line max-len\n                return { left: pageDetails.width - left - width, top: pageDetails.height - top - height, width: width, height: height };\n            }\n            else if (pageDetails.rotation === 3) {\n                return { left: pageDetails.height - top - height, top: left, width: height, height: width };\n            }\n            else {\n                return { left: left, top: top, width: width, height: height };\n            }\n        }\n        else {\n            return { left: left, top: top, width: width, height: height };\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.getRgbCode = function (colorString) {\n        if (!colorString.match(/#([a-z0-9]+)/gi) && !colorString.match(/^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+(?:\\.\\d+)?))?\\)$/)) {\n            colorString = this.pdfViewer.annotationModule.nameToHash(colorString);\n        }\n        var markupStringArray = colorString.split(',');\n        if (isNullOrUndefined(markupStringArray[1])) {\n            colorString = this.pdfViewer.annotationModule.getValue(colorString, 'rgba');\n            markupStringArray = colorString.split(',');\n        }\n        // eslint-disable-next-line radix\n        var textMarkupR = parseInt(markupStringArray[0].split('(')[1]);\n        // eslint-disable-next-line radix\n        var textMarkupG = parseInt(markupStringArray[1]);\n        // eslint-disable-next-line radix\n        var textMarkupB = parseInt(markupStringArray[2]);\n        // eslint-disable-next-line radix\n        var textMarkupA = parseInt(markupStringArray[3]);\n        return { a: textMarkupA, r: textMarkupR, g: textMarkupG, b: textMarkupB };\n    };\n    TextMarkupAnnotation.prototype.getDrawnBounds = function () {\n        var pageBounds = [];\n        var selection = window.getSelection();\n        if (selection.anchorNode !== null) {\n            var range = document.createRange();\n            var isBackWardSelection = this.pdfViewerBase.textLayer.isBackWardSelection(selection);\n            if (selection.anchorNode === selection.focusNode) {\n                var pageId = this.pdfViewerBase.textLayer.getPageIndex(selection.anchorNode);\n                var startIndex = 0;\n                var endIndex = 0;\n                if (!isNaN(pageId)) {\n                    var pageRect = this.pdfViewerBase.getElement('_pageDiv_' + pageId).getBoundingClientRect();\n                    if (this.pdfViewerBase.isMixedSizeDocument) {\n                        pageRect = this.pdfViewerBase.getElement('_textLayer_' + pageId).getBoundingClientRect();\n                    }\n                    if (isBackWardSelection) {\n                        range.setStart(selection.focusNode, selection.focusOffset);\n                        range.setEnd(selection.anchorNode, selection.anchorOffset);\n                    }\n                    else {\n                        if (selection.anchorOffset < selection.focusOffset) {\n                            startIndex = selection.anchorOffset;\n                            endIndex = selection.focusOffset;\n                            range.setStart(selection.anchorNode, selection.anchorOffset);\n                            range.setEnd(selection.focusNode, selection.focusOffset);\n                        }\n                        else {\n                            startIndex = selection.focusOffset;\n                            endIndex = selection.anchorOffset;\n                            range.setStart(selection.focusNode, selection.focusOffset);\n                            range.setEnd(selection.anchorNode, selection.anchorOffset);\n                        }\n                    }\n                    var boundingRect = range.getBoundingClientRect();\n                    // eslint-disable-next-line\n                    var indexes = this.getIndexNumbers(pageId, range.toString(), range.commonAncestorContainer.textContent.toString());\n                    // eslint-disable-next-line max-len\n                    var rectangle = { left: this.getDefaultValue(boundingRect.left - pageRect.left), top: this.getDefaultValue(boundingRect.top - pageRect.top), width: this.getDefaultValue(boundingRect.width), height: this.getDefaultValue(boundingRect.height), right: this.getDefaultValue(boundingRect.right - pageRect.left), bottom: this.getDefaultValue(boundingRect.bottom - pageRect.top) };\n                    var rectangleArray = [];\n                    rectangleArray.push(rectangle);\n                    // eslint-disable-next-line\n                    var rect = { left: rectangle.left, top: rectangle.top, right: rectangle.right, bottom: rectangle.bottom };\n                    pageBounds.push({ pageIndex: pageId, bounds: rectangleArray, rect: rect, startIndex: indexes.startIndex, endIndex: indexes.endIndex, textContent: range.toString() });\n                }\n            }\n            else {\n                var startNode = void 0;\n                var endNode = void 0;\n                var selectionStartOffset = void 0;\n                var selectionEndOffset = void 0;\n                if (isBackWardSelection) {\n                    startNode = selection.focusNode;\n                    selectionStartOffset = selection.focusOffset;\n                    endNode = selection.anchorNode;\n                    selectionEndOffset = selection.anchorOffset;\n                }\n                else {\n                    startNode = selection.anchorNode;\n                    selectionStartOffset = selection.anchorOffset;\n                    endNode = selection.focusNode;\n                    selectionEndOffset = selection.focusOffset;\n                }\n                var anchorPageId = this.pdfViewerBase.textLayer.getPageIndex(startNode);\n                var anchorTextId = this.pdfViewerBase.textLayer.getTextIndex(startNode, anchorPageId);\n                var focusPageId = this.pdfViewerBase.textLayer.getPageIndex(endNode);\n                var focusTextId = this.pdfViewerBase.textLayer.getTextIndex(endNode, focusPageId);\n                var startOffset = 0;\n                var endOffset = 0;\n                var currentId = 0;\n                for (var i = anchorPageId; i <= focusPageId; i++) {\n                    var selectionRects = [];\n                    var pageStartId = void 0;\n                    var pageEndId = void 0;\n                    var pageStartOffset = void 0;\n                    var pageEndOffset = void 0;\n                    var textDivs = this.pdfViewerBase.getElement('_textLayer_' + i).childNodes;\n                    var pageRect = this.pdfViewerBase.getElement('_pageDiv_' + i).getBoundingClientRect();\n                    if (this.pdfViewerBase.isMixedSizeDocument) {\n                        pageRect = this.pdfViewerBase.getElement('_textLayer_' + i).getBoundingClientRect();\n                    }\n                    if (i === anchorPageId) {\n                        currentId = anchorTextId;\n                    }\n                    else {\n                        currentId = 0;\n                    }\n                    for (var j = currentId; j < textDivs.length; j++) {\n                        var textElement = textDivs[j];\n                        if (j === currentId) {\n                            pageStartId = currentId;\n                            pageStartOffset = (i === anchorPageId) ? selectionStartOffset : 0;\n                        }\n                        else {\n                            pageEndId = j;\n                            pageEndOffset = (i === focusPageId) ? selectionEndOffset : textElement.textContent.length;\n                        }\n                        if (j === anchorTextId && i === anchorPageId) {\n                            startOffset = selectionStartOffset;\n                        }\n                        else {\n                            startOffset = 0;\n                        }\n                        if (j === focusTextId && i === focusPageId) {\n                            endOffset = selectionEndOffset;\n                        }\n                        else {\n                            endOffset = textElement.textContent.length;\n                        }\n                        for (var k = 0; k < textElement.childNodes.length; k++) {\n                            var node = textElement.childNodes[k];\n                            range.setStart(node, startOffset);\n                            range.setEnd(node, endOffset);\n                        }\n                        var boundingRect = range.getBoundingClientRect();\n                        // eslint-disable-next-line max-len\n                        var rectangle = { left: this.getDefaultValue(boundingRect.left - pageRect.left), top: this.getDefaultValue(boundingRect.top - pageRect.top), width: this.getDefaultValue(boundingRect.width), height: this.getDefaultValue(boundingRect.height), right: this.getDefaultValue(boundingRect.right - pageRect.left), bottom: this.getDefaultValue(boundingRect.bottom - pageRect.top) };\n                        selectionRects.push(rectangle);\n                        range.detach();\n                        if (i === focusPageId && j === focusTextId) {\n                            break;\n                        }\n                    }\n                    if (!pageEndId) {\n                        pageEndId = pageStartId;\n                    }\n                    if (!pageEndOffset) {\n                        pageEndOffset = endOffset;\n                    }\n                    var startElementNode = this.pdfViewerBase.getElement('_text_' + i + '_' + pageStartId).childNodes[0];\n                    var endElementNode = this.pdfViewerBase.getElement('_text_' + i + '_' + pageEndId).childNodes[0];\n                    var pageRange = document.createRange();\n                    pageRange.setStart(startElementNode, pageStartOffset);\n                    pageRange.setEnd(endElementNode, pageEndOffset);\n                    var pageRectBounds = pageRange.getBoundingClientRect();\n                    var textValue = pageRange.toString();\n                    // eslint-disable-next-line\n                    var indexes = this.getIndexNumbers(i, textValue);\n                    // eslint-disable-next-line max-len\n                    var pageRectangle = { left: this.getDefaultValue(pageRectBounds.left - pageRect.left), top: this.getDefaultValue(pageRectBounds.top - pageRect.top), width: this.getDefaultValue(pageRectBounds.width), height: this.getDefaultValue(pageRectBounds.height), right: this.getDefaultValue(pageRectBounds.right - pageRect.left), bottom: this.getDefaultValue(pageRectBounds.bottom - pageRect.top) };\n                    // eslint-disable-next-line\n                    var rect = { left: pageRectangle.left, top: pageRectangle.top, right: pageRectangle.right, bottom: pageRectangle.bottom };\n                    pageBounds.push({ pageIndex: i, bounds: selectionRects, rect: rect, startIndex: indexes.startIndex, endIndex: indexes.endIndex, textContent: textValue });\n                }\n            }\n        }\n        selection.removeAllRanges();\n        return pageBounds;\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.getIndexNumbers = function (pageNumber, content, parentText) {\n        // eslint-disable-next-line\n        var storedData = this.pdfViewerBase.getStoredData(pageNumber);\n        var startIndex;\n        var endIndex;\n        if (storedData) {\n            var previousIndex = 0;\n            var pageText = storedData.pageText;\n            for (var p = 0; p < pageNumber; p++) {\n                if (this.pdfViewer.isExtractText) {\n                    // eslint-disable-next-line\n                    var documentIndex = this.pdfViewer.textSearchModule.documentTextCollection[p][p];\n                    var pageTextData = documentIndex.pageText ? documentIndex.pageText : documentIndex.PageText;\n                    // eslint-disable-next-line max-len\n                    if (this.pdfViewer.textSearchModule && this.pdfViewer.textSearchModule.documentTextCollection && this.pdfViewer.textSearchModule.isTextRetrieved) {\n                        if (this.pdfViewer.textSearchModule.documentTextCollection[p]) {\n                            previousIndex = previousIndex + pageTextData.length;\n                        }\n                    }\n                    else {\n                        // eslint-disable-next-line max-len\n                        if (this.pdfViewer.textSearchModule && this.pdfViewer.textSearchModule.documentTextCollection) {\n                            if (pageNumber <= this.pdfViewer.textSearchModule.documentTextCollection.length) {\n                                if (this.pdfViewer.textSearchModule.documentTextCollection[p]) {\n                                    // eslint-disable-next-line max-len\n                                    previousIndex = previousIndex + pageTextData.length;\n                                }\n                            }\n                            else {\n                                previousIndex = 0;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n            if (!isNullOrUndefined(parentText)) {\n                var parentIndex = pageText.indexOf(parentText);\n                var initialIndex = parentText.indexOf(content);\n                startIndex = (parentIndex + initialIndex) + previousIndex;\n            }\n            else {\n                startIndex = (pageText.indexOf(content)) + previousIndex;\n            }\n            endIndex = startIndex + (content.length - 1);\n        }\n        return { startIndex: startIndex, endIndex: endIndex };\n    };\n    /**\n     * @param pageNumber\n     * @private\n     */\n    TextMarkupAnnotation.prototype.rerenderAnnotationsPinch = function (pageNumber) {\n        var annotCanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n        if (annotCanvas) {\n            var oldAnnotCanvas = this.pdfViewerBase.getElement('_old_annotationCanvas_' + pageNumber);\n            if (oldAnnotCanvas) {\n                if (annotCanvas) {\n                    oldAnnotCanvas.id = annotCanvas.id;\n                    annotCanvas.parentElement.removeChild(annotCanvas);\n                }\n                else {\n                    oldAnnotCanvas.id = this.pdfViewer.element.id + '_annotationCanvas_' + pageNumber;\n                }\n                annotCanvas = oldAnnotCanvas;\n            }\n            annotCanvas.style.width = '';\n            annotCanvas.style.height = '';\n            if (this.pdfViewer.restrictZoomRequest) {\n                // eslint-disable-next-line max-len\n                annotCanvas.style.width = this.pdfViewerBase.pageSize[pageNumber].width * this.pdfViewerBase.getZoomFactor() + 'px';\n                // eslint-disable-next-line max-len\n                annotCanvas.style.height = this.pdfViewerBase.pageSize[pageNumber].height * this.pdfViewerBase.getZoomFactor() + 'px';\n            }\n            else {\n                // eslint-disable-next-line max-len\n                annotCanvas.width = this.pdfViewerBase.pageSize[pageNumber].width * this.pdfViewerBase.getZoomFactor();\n                annotCanvas.height = this.pdfViewerBase.pageSize[pageNumber].height * this.pdfViewerBase.getZoomFactor();\n            }\n            this.renderTextMarkupAnnotations(null, pageNumber, annotCanvas, this.pdfViewerBase.getZoomFactor());\n        }\n    };\n    /**\n     * @param pageNumber\n     * @private\n     */\n    TextMarkupAnnotation.prototype.rerenderAnnotations = function (pageNumber) {\n        // eslint-disable-next-line\n        var oldCanvasCollection = document.querySelectorAll('#' + this.pdfViewer.element.id + '_old_annotationCanvas_' + pageNumber);\n        for (var i = 0; i < oldCanvasCollection.length; i++) {\n            if (oldCanvasCollection[i]) {\n                oldCanvasCollection[i].parentElement.removeChild(oldCanvasCollection[i]);\n            }\n        }\n        var newCanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n        if (newCanvas) {\n            newCanvas.style.display = 'block';\n        }\n    };\n    /**\n     * @param event\n     * @private\n     */\n    TextMarkupAnnotation.prototype.onTextMarkupAnnotationMouseUp = function (event) {\n        var pageNumber = this.pdfViewer.annotationModule.getEventPageNumber(event);\n        if (!isNullOrUndefined(pageNumber) && !isNaN(pageNumber)) {\n            var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n            if (this.currentTextMarkupAnnotation) {\n                this.selectedTextMarkup = this.currentTextMarkupAnnotation;\n            }\n            else {\n                this.selectedTextMarkup = null;\n            }\n            this.clearCurrentSelectedAnnotation();\n            var currentAnnot = this.getCurrentMarkupAnnotation(event.clientX, event.clientY, pageNumber, canvas);\n            if (currentAnnot && !window.getSelection().toString()) {\n                var isLock = false;\n                var isSelection = false;\n                if (currentAnnot.annotationSettings && currentAnnot.annotationSettings.isLock) {\n                    isLock = currentAnnot.annotationSettings.isLock;\n                    if (isLock && this.pdfViewer.annotationModule.checkAllowedInteractions('Select', currentAnnot)) {\n                        isLock = false;\n                        if (this.pdfViewer.annotationModule.checkAllowedInteractions('PropertyChange', currentAnnot)) {\n                            isSelection = false;\n                        }\n                        else {\n                            isSelection = true;\n                        }\n                    }\n                }\n                if (!isLock) {\n                    var canvasParentPosition = canvas.parentElement.getBoundingClientRect();\n                    var leftClickPosition = event.clientX - canvasParentPosition.left;\n                    var topClickPosition = event.clientY - canvasParentPosition.top;\n                    this.annotationClickPosition = { x: leftClickPosition, y: topClickPosition };\n                    this.selectAnnotation(currentAnnot, canvas, pageNumber, event);\n                    if (Browser.isDevice && !this.pdfViewer.enableDesktopMode && this.pdfViewer.enableToolbar && this.pdfViewer.enableAnnotationToolbar) {\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.createPropertyTools(this.currentTextMarkupAnnotation.textMarkupAnnotationType);\n                    }\n                    this.currentTextMarkupAnnotation = currentAnnot;\n                    this.selectTextMarkupCurrentPage = pageNumber;\n                    if (!isSelection) {\n                        this.enableAnnotationPropertiesTool(true);\n                    }\n                    var commentPanelDiv = document.getElementById(this.pdfViewer.element.id + '_commantPanel');\n                    if (commentPanelDiv && commentPanelDiv.style.display === 'block') {\n                        // eslint-disable-next-line\n                        var accordionExpand = document.getElementById(this.pdfViewer.element.id + '_accordionContainer' + (pageNumber + 1));\n                        if (accordionExpand) {\n                            accordionExpand.ej2_instances[0].expandItem(true);\n                        }\n                        // eslint-disable-next-line\n                        var comments = document.getElementById(currentAnnot.annotName);\n                        if (comments) {\n                            comments.firstChild.click();\n                        }\n                    }\n                    if (!isBlazor()) {\n                        if (this.pdfViewer.toolbarModule && this.pdfViewer.enableAnnotationToolbar) {\n                            this.pdfViewer.toolbarModule.annotationToolbarModule.isToolbarHidden = true;\n                            // eslint-disable-next-line max-len\n                            this.pdfViewer.toolbarModule.annotationToolbarModule.showAnnotationToolbar(this.pdfViewer.toolbarModule.annotationItem);\n                        }\n                    }\n                }\n            }\n            else {\n                this.clearCurrentAnnotation();\n            }\n            if (this.pdfViewer.isMaintainSelection && !this.pdfViewer.textSelectionModule.isTextSelection) {\n                if (currentAnnot) {\n                    this.clearCurrentAnnotationSelection(pageNumber);\n                }\n            }\n            else {\n                this.clearCurrentAnnotationSelection(pageNumber);\n            }\n        }\n        else {\n            if (!this.pdfViewerBase.isClickedOnScrollBar(event, true)) {\n                this.clearCurrentAnnotation();\n                this.clearCurrentAnnotationSelection(pageNumber);\n            }\n        }\n    };\n    /**\n     * @param event\n     * @private\n     */\n    TextMarkupAnnotation.prototype.onTextMarkupAnnotationTouchEnd = function (event) {\n        var pageNumber = this.pdfViewer.annotationModule.getEventPageNumber(event);\n        if (!isNullOrUndefined(pageNumber) && !isNaN(pageNumber)) {\n            if (this.currentTextMarkupAnnotation) {\n                this.selectedTextMarkup = this.currentTextMarkupAnnotation;\n            }\n            else {\n                this.selectedTextMarkup = null;\n            }\n            this.clearCurrentAnnotationSelection(pageNumber);\n            var touchCanvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n            this.clearCurrentSelectedAnnotation();\n            // eslint-disable-next-line max-len\n            var currentAnnot = this.getCurrentMarkupAnnotation(event.touches[0].clientX, event.touches[0].clientY, pageNumber, touchCanvas);\n            if (currentAnnot) {\n                var isLock = false;\n                if (currentAnnot.annotationSettings && currentAnnot.annotationSettings.isLock) {\n                    isLock = currentAnnot.annotationSettings.isLock;\n                }\n                if (!isLock) {\n                    var canvasParentPosition = touchCanvas.parentElement.getBoundingClientRect();\n                    var leftClickPosition = event.touches[0].clientX - canvasParentPosition.left;\n                    var topClickPosition = event.touches[0].clientY - canvasParentPosition.top;\n                    this.annotationClickPosition = { x: leftClickPosition, y: topClickPosition };\n                    this.selectAnnotation(currentAnnot, touchCanvas, pageNumber, event);\n                    if (Browser.isDevice && !this.pdfViewer.enableDesktopMode && this.pdfViewer.enableToolbar && this.pdfViewer.enableAnnotationToolbar) {\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.createPropertyTools(this.currentTextMarkupAnnotation.textMarkupAnnotationType);\n                    }\n                    this.currentTextMarkupAnnotation = currentAnnot;\n                    this.selectTextMarkupCurrentPage = pageNumber;\n                    this.enableAnnotationPropertiesTool(true);\n                    // eslint-disable-next-line\n                    var accordionExpand = document.getElementById(this.pdfViewer.element.id + '_accordionContainer' + (pageNumber + 1));\n                    if (accordionExpand) {\n                        accordionExpand.ej2_instances[0].expandItem(true);\n                    }\n                    // eslint-disable-next-line\n                    var comments = document.getElementById(currentAnnot.annotName);\n                    if (comments) {\n                        if (!Browser.isDevice) {\n                            comments.firstChild.click();\n                        }\n                    }\n                }\n            }\n            else {\n                this.clearCurrentAnnotation();\n            }\n            this.clearCurrentAnnotationSelection(pageNumber);\n        }\n        else if (this.selectTextMarkupCurrentPage != null && (Browser.isDevice && !this.pdfViewer.enableDesktopMode)) {\n            var number = this.selectTextMarkupCurrentPage;\n            this.selectTextMarkupCurrentPage = null;\n            this.clearAnnotationSelection(number);\n        }\n        else {\n            this.clearCurrentAnnotation();\n            this.clearCurrentAnnotationSelection(pageNumber);\n        }\n    };\n    /**\n     * @private\n     */\n    TextMarkupAnnotation.prototype.clearCurrentSelectedAnnotation = function () {\n        if (this.currentTextMarkupAnnotation) {\n            this.clearAnnotationSelection(this.selectTextMarkupCurrentPage);\n            // eslint-disable-next-line\n            var currentAnnot = this.currentTextMarkupAnnotation;\n            this.pdfViewer.fireAnnotationUnSelect(currentAnnot.annotName, currentAnnot.pageNumber, currentAnnot);\n            this.clearCurrentAnnotation();\n        }\n    };\n    /**\n     * @param event\n     * @private\n     */\n    TextMarkupAnnotation.prototype.onTextMarkupAnnotationMouseMove = function (event) {\n        var eventTarget = event.target;\n        // eslint-disable-next-line\n        var pageIndex = parseInt(eventTarget.id.split('_text_')[1]) || parseInt(eventTarget.id.split('_textLayer_')[1]) || parseInt(eventTarget.id.split('_annotationCanvas_')[1]);\n        if (event.target && (eventTarget.id.indexOf('_text') > -1 || eventTarget.id.indexOf('_annotationCanvas') > -1 || eventTarget.classList.contains('e-pv-hyperlink')) && this.pdfViewer.annotation) {\n            pageIndex = this.pdfViewer.annotation.getEventPageNumber(event);\n            var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageIndex);\n            var currentAnnot = this.getCurrentMarkupAnnotation(event.clientX, event.clientY, pageIndex, canvas);\n            if (currentAnnot) {\n                eventTarget.style.cursor = 'pointer';\n                // eslint-disable-next-line\n                var currentPosition = this.pdfViewerBase.getMousePosition(event);\n                // eslint-disable-next-line\n                var relativePosition = this.pdfViewerBase.relativePosition(event);\n                // eslint-disable-next-line\n                var viewerPositions = { left: relativePosition.x, top: relativePosition.y };\n                // eslint-disable-next-line\n                var mousePositions = { left: currentPosition.x, top: currentPosition.y };\n                // eslint-disable-next-line\n                var annotationSettings = { opacity: currentAnnot.opacity, color: currentAnnot.color, author: currentAnnot.author, subject: currentAnnot.subject, modifiedDate: currentAnnot.modifiedDate };\n                // eslint-disable-next-line max-len\n                this.pdfViewerBase.isMousedOver = true;\n                this.pdfViewer.fireAnnotationMouseover(currentAnnot.annotName, currentAnnot.pageNumber, currentAnnot.textMarkupAnnotationType, currentAnnot.bounds, annotationSettings, mousePositions, viewerPositions);\n                // this.showPopupNote(event, currentAnnot);\n            }\n            else {\n                this.pdfViewer.annotationModule.hidePopupNote();\n                if (this.pdfViewerBase.isPanMode && !this.pdfViewerBase.getAnnotationToolStatus()) {\n                    eventTarget.style.cursor = 'grab';\n                }\n                if (this.pdfViewerBase.isMousedOver && !this.pdfViewerBase.isFormFieldMousedOver) {\n                    this.pdfViewer.fireAnnotationMouseLeave(pageIndex);\n                    this.pdfViewerBase.isMousedOver = false;\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.showPopupNote = function (event, annotation) {\n        if (annotation.note) {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.annotationModule.showPopupNote(event, annotation.color, annotation.author, annotation.note, annotation.textMarkupAnnotationType);\n        }\n    };\n    TextMarkupAnnotation.prototype.getCurrentMarkupAnnotation = function (clientX, clientY, pageNumber, canvas) {\n        var currentTextMarkupAnnotations = [];\n        if (canvas) {\n            var canvasParentPosition = canvas.parentElement.getBoundingClientRect();\n            if (canvas.clientWidth !== canvas.parentElement.clientWidth) {\n                canvasParentPosition = canvas.getBoundingClientRect();\n            }\n            var leftClickPosition = clientX - canvasParentPosition.left;\n            var topClickPosition = clientY - canvasParentPosition.top;\n            var annotationList = this.getAnnotations(pageNumber, null);\n            var isAnnotationGot = false;\n            if (annotationList) {\n                for (var i = 0; i < annotationList.length; i++) {\n                    var annotation = annotationList[i];\n                    for (var j = 0; j < annotation.bounds.length; j++) {\n                        // eslint-disable-next-line\n                        var bound = annotation.bounds[j];\n                        var left = bound.left ? bound.left : bound.Left;\n                        var top_2 = bound.top ? bound.top : bound.Top;\n                        var width = bound.width ? bound.width : bound.Width;\n                        var height = bound.height ? bound.height : bound.Height;\n                        // eslint-disable-next-line max-len\n                        if (leftClickPosition >= this.getMagnifiedValue(left, this.pdfViewerBase.getZoomFactor()) && leftClickPosition <= this.getMagnifiedValue(left + width, this.pdfViewerBase.getZoomFactor()) && topClickPosition >= this.getMagnifiedValue(top_2, this.pdfViewerBase.getZoomFactor()) && topClickPosition <= this.getMagnifiedValue(top_2 + height, this.pdfViewerBase.getZoomFactor())) {\n                            currentTextMarkupAnnotations.push(annotation);\n                            isAnnotationGot = true;\n                        }\n                        else {\n                            if (isAnnotationGot) {\n                                isAnnotationGot = false;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n            var currentAnnot = null;\n            if (currentTextMarkupAnnotations.length > 1) {\n                currentAnnot = this.compareCurrentAnnotations(currentTextMarkupAnnotations);\n            }\n            else if (currentTextMarkupAnnotations.length === 1) {\n                currentAnnot = currentTextMarkupAnnotations[0];\n            }\n            return currentAnnot;\n        }\n        else {\n            return null;\n        }\n    };\n    TextMarkupAnnotation.prototype.compareCurrentAnnotations = function (annotations) {\n        var previousX;\n        var currentAnnotation = null;\n        for (var i = 0; i < annotations.length; i++) {\n            if (i === annotations.length - 1) {\n                break;\n            }\n            // eslint-disable-next-line\n            var firstAnnotBounds = annotations[i].bounds;\n            var firstXposition = firstAnnotBounds[0].left ? firstAnnotBounds[0].left : firstAnnotBounds[0].Left;\n            var firstYposition = firstAnnotBounds[0].top ? firstAnnotBounds[0].top : firstAnnotBounds[0].Top;\n            // eslint-disable-next-line\n            var secondAnnotBounds = annotations[i + 1].bounds;\n            var secondXposition = secondAnnotBounds[0].left ? secondAnnotBounds[0].left : secondAnnotBounds[0].Left;\n            var secondYposition = secondAnnotBounds[0].top ? secondAnnotBounds[0].top : secondAnnotBounds[0].Top;\n            if ((firstXposition < secondXposition) || (firstYposition < secondYposition)) {\n                previousX = secondXposition;\n                currentAnnotation = annotations[i + 1];\n            }\n            else {\n                previousX = firstXposition;\n                currentAnnotation = annotations[i];\n            }\n            if (previousX && (i === (annotations.length - 2))) {\n                if ((previousX === firstXposition) && (previousX === secondXposition)) {\n                    previousX = secondXposition;\n                    currentAnnotation = annotations[i + 1];\n                }\n            }\n        }\n        return currentAnnotation;\n    };\n    /**\n     * @param pageNumber\n     * @private\n     */\n    TextMarkupAnnotation.prototype.clearAnnotationSelection = function (pageNumber) {\n        var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n        if (canvas) {\n            var context = canvas.getContext('2d');\n            context.setLineDash([]);\n            this.pdfViewer.annotationModule.renderAnnotations(pageNumber, null, null, null);\n        }\n    };\n    /**\n     * @param annotation\n     * @param canvas\n     * @param pageNumber\n     * @param event\n     * @param isProgrammaticSelection\n     * @param annotation\n     * @param canvas\n     * @param pageNumber\n     * @param event\n     * @param isProgrammaticSelection\n     * @private\n     */\n    // eslint-disable-next-line max-len\n    TextMarkupAnnotation.prototype.selectAnnotation = function (annotation, canvas, pageNumber, event, isProgrammaticSelection) {\n        if (this.pdfViewer.selectedItems.annotations[0]) {\n            this.pdfViewer.clearSelection(this.pdfViewer.selectedItems.annotations[0].pageIndex);\n            this.pdfViewer.clearSelection(this.selectTextMarkupCurrentPage);\n        }\n        var isLock = false;\n        if (annotation.annotationSettings && annotation.annotationSettings.isLock) {\n            isLock = annotation.annotationSettings.isLock;\n            if (isLock && this.pdfViewer.annotationModule.checkAllowedInteractions('Select', annotation)) {\n                isLock = false;\n            }\n        }\n        if (!isLock) {\n            var isCurrentTextMarkup = false;\n            if (!this.currentTextMarkupAnnotation) {\n                isCurrentTextMarkup = true;\n            }\n            if (this.selectedTextMarkup && annotation && !isProgrammaticSelection) {\n                if (this.selectedTextMarkup.annotName === annotation.annotName) {\n                    isCurrentTextMarkup = false;\n                }\n                else {\n                    isCurrentTextMarkup = true;\n                }\n            }\n            if (!isNaN(pageNumber)) {\n                this.selectTextMarkupCurrentPage = pageNumber;\n                this.currentTextMarkupAnnotation = annotation;\n                annotation = this.retreiveTextIndex(annotation);\n                this.currentTextMarkupAnnotation = annotation;\n            }\n            if (this.isSelectedAnnotation && this.pdfViewer.textSelectionModule) {\n                this.pdfViewerBase.isSelection = true;\n                this.updateAnnotationBounds();\n            }\n            // eslint-disable-next-line\n            var currentEvent = event;\n            if (this.isEnableTextMarkupResizer(annotation.textMarkupAnnotationType) && annotation && currentEvent && !currentEvent.touches) {\n                this.updateCurrentResizerPosition(annotation);\n            }\n            this.drawAnnotationSelector(annotation, this.currentTextMarkupAnnotation, canvas);\n            if (annotation.isMultiSelect && annotation.annotNameCollection) {\n                this.selectMultiPageAnnotations(annotation);\n            }\n            if (annotation.annotName !== '' && !this.isNewAnnotation) {\n                if (isCurrentTextMarkup) {\n                    var isSelected = false;\n                    if (!currentEvent) {\n                        isSelected = true;\n                    }\n                    // eslint-disable-next-line max-len\n                    this.pdfViewer.annotationModule.annotationSelect(annotation.annotName, this.selectTextMarkupCurrentPage, annotation, null, false, isSelected);\n                    this.selectedTextMarkup = null;\n                }\n            }\n            if (annotation && this.isEnableTextMarkupResizer(annotation.textMarkupAnnotationType)) {\n                this.isTextMarkupAnnotationMode = true;\n            }\n        }\n    };\n    /**\n     * @param annotation\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.updateCurrentResizerPosition = function (annotation) {\n        if (!annotation) {\n            annotation = this.currentTextMarkupAnnotation;\n        }\n        if (annotation) {\n            if (this.isEnableTextMarkupResizer(annotation.textMarkupAnnotationType) && annotation) {\n                // eslint-disable-next-line\n                var textElement = this.pdfViewerBase.getElement('_textLayer_' + this.selectTextMarkupCurrentPage);\n                if (textElement) {\n                    // eslint-disable-next-line\n                    var boundingRect = textElement.getBoundingClientRect();\n                    var left = annotation.bounds[0].left ? annotation.bounds[0].left : annotation.bounds[0].Left;\n                    var top_3 = annotation.bounds[0].top ? annotation.bounds[0].top : annotation.bounds[0].Top;\n                    this.updateLeftposition(left * this.pdfViewerBase.getZoomFactor() + boundingRect.left, (boundingRect.top + top_3), true);\n                    // eslint-disable-next-line\n                    var endPosition = annotation.bounds[annotation.bounds.length - 1];\n                    var endLeft = endPosition.left ? endPosition.left : endPosition.Left;\n                    var endTop = endPosition.top ? endPosition.top : endPosition.Top;\n                    var endWidth = endPosition.width ? endPosition.width : endPosition.Width;\n                    // eslint-disable-next-line max-len\n                    this.updatePosition((endLeft + endWidth) * this.pdfViewerBase.getZoomFactor() + boundingRect.left, (endTop + boundingRect.top), true);\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.drawAnnotationSelectRect = function (canvas, x, y, width, height, annotation) {\n        var ratio = this.pdfViewerBase.getZoomRatio();\n        if (canvas) {\n            var context = canvas.getContext('2d');\n            context.setTransform(1, 0, 0, 1, 0, 0);\n            context.beginPath();\n            if (typeof (annotation).annotationSelectorSettings === 'string') {\n                // eslint-disable-next-line max-len\n                var lineDash = JSON.parse(annotation.annotationSelectorSettings).selectorLineDashArray.length === 0 ? [4] : JSON.parse(annotation.annotationSelectorSettings).selectorLineDashArray;\n                if (lineDash.length > 2) {\n                    lineDash = [lineDash[0], lineDash[1]];\n                }\n                context.setLineDash(lineDash);\n                context.globalAlpha = 1;\n                context.rect(x * ratio, y * ratio, width * ratio, height * ratio);\n                context.closePath();\n                // eslint-disable-next-line max-len\n                var borderColor = JSON.parse(annotation.annotationSelectorSettings).selectionBorderColor === '' ? '#0000ff' : JSON.parse(annotation.annotationSelectorSettings).selectionBorderColor;\n                context.strokeStyle = borderColor;\n                // eslint-disable-next-line max-len\n                context.lineWidth = JSON.parse(annotation.annotationSelectorSettings).selectionBorderThickness === 1 ? 1 : (annotation.annotationSelectorSettings).selectionBorderThickness;\n                context.stroke();\n                context.save();\n            }\n            else {\n                // eslint-disable-next-line max-len\n                var lineDash = (annotation.annotationSelectorSettings).selectorLineDashArray.length === 0 ? [4] : (annotation.annotationSelectorSettings).selectorLineDashArray;\n                if (lineDash.length > 2) {\n                    lineDash = [lineDash[0], lineDash[1]];\n                }\n                context.setLineDash(lineDash);\n                context.globalAlpha = 1;\n                context.rect(x * ratio, y * ratio, width * ratio, height * ratio);\n                context.closePath();\n                // eslint-disable-next-line max-len\n                var borderColor = (annotation.annotationSelectorSettings).selectionBorderColor === '' ? '#0000ff' : (annotation.annotationSelectorSettings).selectionBorderColor;\n                context.strokeStyle = borderColor;\n                // eslint-disable-next-line max-len\n                context.lineWidth = (annotation.annotationSelectorSettings).selectionBorderThickness ? 1 : (annotation.annotationSelectorSettings).selectionBorderThickness;\n                context.stroke();\n                context.save();\n            }\n        }\n    };\n    /**\n     * @param isEnable\n     * @private\n     */\n    TextMarkupAnnotation.prototype.enableAnnotationPropertiesTool = function (isEnable) {\n        if (this.pdfViewer.toolbarModule && this.pdfViewer.toolbarModule.annotationToolbarModule) {\n            // eslint-disable-next-line max-len\n            this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElementInBlazor = this.pdfViewer.element.querySelector('.e-pv-annotation-color-container');\n        }\n        // eslint-disable-next-line max-len\n        if (this.pdfViewer.toolbarModule && this.pdfViewer.toolbarModule.annotationToolbarModule) {\n            if (!Browser.isDevice) {\n                this.pdfViewer.toolbarModule.annotationToolbarModule.createMobileAnnotationToolbar(isEnable);\n            }\n        }\n        // eslint-disable-next-line max-len\n        if (this.pdfViewer.toolbarModule && this.pdfViewer.toolbarModule.annotationToolbarModule && this.pdfViewer.toolbarModule.annotationToolbarModule.isMobileAnnotEnabled && this.pdfViewer.selectedItems.annotations.length === 0) {\n            if (this.pdfViewer.toolbarModule.annotationToolbarModule) {\n                this.pdfViewer.toolbarModule.annotationToolbarModule.selectAnnotationDeleteItem(isEnable);\n                var enable = isEnable;\n                if (this.isTextMarkupAnnotationMode) {\n                    enable = true;\n                }\n                this.pdfViewer.toolbarModule.annotationToolbarModule.enableTextMarkupAnnotationPropertiesTools(enable);\n                if (this.currentTextMarkupAnnotation) {\n                    if (!isBlazor()) {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.updateColorInIcon(this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElement, this.currentTextMarkupAnnotation.color);\n                    }\n                    else {\n                        // eslint-disable-next-line max-len\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.updateColorInIcon(this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElementInBlazor, this.currentTextMarkupAnnotation.color);\n                    }\n                }\n                else {\n                    if (!isNullOrUndefined(this.isTextMarkupAnnotationMode) && !this.isTextMarkupAnnotationMode) {\n                        if (!isBlazor()) {\n                            // eslint-disable-next-line max-len\n                            this.pdfViewer.toolbarModule.annotationToolbarModule.updateColorInIcon(this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElement, '#000000');\n                        }\n                        else {\n                            // eslint-disable-next-line max-len\n                            this.pdfViewer.toolbarModule.annotationToolbarModule.updateColorInIcon(this.pdfViewer.toolbarModule.annotationToolbarModule.colorDropDownElementInBlazor, '#000000');\n                        }\n                    }\n                    else {\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.setCurrentColorInPicker();\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TextMarkupAnnotation.prototype.maintainAnnotationSelection = function () {\n        if (this.currentTextMarkupAnnotation) {\n            var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + this.selectTextMarkupCurrentPage);\n            if (canvas) {\n                this.selectAnnotation(this.currentTextMarkupAnnotation, canvas, this.selectTextMarkupCurrentPage);\n            }\n        }\n    };\n    // private storeAnnotations(pageNumber: number, annotation: ITextMarkupAnnotation): number {\n    // eslint-disable-next-line\n    //     let storeObject: any = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n    //     let index: number = 0;\n    //     if (!storeObject) {\n    //         let markupAnnotation: IPageAnnotations = { pageIndex: pageNumber, annotations: [] };\n    //         markupAnnotation.annotations.push(annotation);\n    //         index = markupAnnotation.annotations.indexOf(annotation);\n    //         let annotationCollection: IPageAnnotations[] = [];\n    //         annotationCollection.push(markupAnnotation);\n    //         let annotationStringified: string = JSON.stringify(annotationCollection);\n    //         window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_textMarkup', annotationStringified);\n    //     } else {\n    //         let annotObject: IPageAnnotations[] = JSON.parse(storeObject);\n    //         window.sessionStorage.removeItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n    //         let pageIndex: number = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageNumber);\n    //         if (annotObject[pageIndex]) {\n    //             (annotObject[pageIndex] as IPageAnnotations).annotations.push(annotation);\n    //             index = (annotObject[pageIndex] as IPageAnnotations).annotations.indexOf(annotation);\n    //         } else {\n    //             let markupAnnotation: IPageAnnotations = { pageIndex: pageNumber, annotations: [] };\n    //             markupAnnotation.annotations.push(annotation);\n    //             index = markupAnnotation.annotations.indexOf(annotation);\n    //             annotObject.push(markupAnnotation);\n    //         }\n    //         let annotationStringified: string = JSON.stringify(annotObject);\n    //         window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_textMarkup', annotationStringified);\n    //     }\n    //     return index;\n    // }\n    /**\n     * @param pageAnnotations\n     * @param pageNumber\n     * @private\n     */\n    TextMarkupAnnotation.prototype.manageAnnotations = function (pageAnnotations, pageNumber) {\n        // eslint-disable-next-line\n        var storeObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n        if (this.pdfViewerBase.isStorageExceed) {\n            storeObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_textMarkup'];\n        }\n        if (storeObject) {\n            var annotObject = JSON.parse(storeObject);\n            if (!this.pdfViewerBase.isStorageExceed) {\n                window.sessionStorage.removeItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n            }\n            var index = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageNumber);\n            if (annotObject[index]) {\n                annotObject[index].annotations = pageAnnotations;\n            }\n            var annotationStringified = JSON.stringify(annotObject);\n            if (this.pdfViewerBase.isStorageExceed) {\n                this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + '_annotations_textMarkup'] = annotationStringified;\n            }\n            else {\n                window.sessionStorage.setItem(this.pdfViewerBase.documentId + '_annotations_textMarkup', annotationStringified);\n            }\n        }\n    };\n    /**\n     * @param pageIndex\n     * @param textMarkupAnnotations\n     * @param id\n     * @param pageIndex\n     * @param textMarkupAnnotations\n     * @param id\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.getAnnotations = function (pageIndex, textMarkupAnnotations, id) {\n        // eslint-disable-next-line\n        var annotationCollection;\n        // eslint-disable-next-line\n        if (id == null || id == undefined) {\n            id = '_annotations_textMarkup';\n        }\n        // eslint-disable-next-line\n        var storeObject = window.sessionStorage.getItem(this.pdfViewerBase.documentId + id);\n        if (this.pdfViewerBase.isStorageExceed) {\n            storeObject = this.pdfViewerBase.annotationStorage[this.pdfViewerBase.documentId + id];\n        }\n        if (storeObject) {\n            var annotObject = JSON.parse(storeObject);\n            var index = this.pdfViewer.annotationModule.getPageCollection(annotObject, pageIndex);\n            if (annotObject[index]) {\n                annotationCollection = annotObject[index].annotations;\n            }\n            else {\n                annotationCollection = textMarkupAnnotations;\n            }\n        }\n        else {\n            annotationCollection = textMarkupAnnotations;\n        }\n        return annotationCollection;\n    };\n    // eslint-disable-next-line max-len\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.getAddedAnnotation = function (type, color, opacity, bounds, author, subject, predefinedDate, note, isCommentLock, rect, pageNumber, textContent, startIndex, endIndex, isMultiSelect, allowedInteractions) {\n        // eslint-disable-next-line max-len\n        var modifiedDate = predefinedDate ? predefinedDate : this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n        var annotationName = this.pdfViewer.annotation.createGUID();\n        var commentsDivid = this.pdfViewer.annotation.stickyNotesAnnotationModule.addComments('textMarkup', pageNumber + 1, type);\n        if (commentsDivid) {\n            document.getElementById(commentsDivid).id = annotationName;\n        }\n        // eslint-disable-next-line\n        var annotationSettings = this.getAnnotationSettings(type);\n        var isPrint = this.getIsPrintValue(type);\n        var annotation = {\n            // eslint-disable-next-line max-len\n            textMarkupAnnotationType: type, color: color, opacity: opacity, bounds: bounds, author: author, allowedInteractions: allowedInteractions, subject: subject, modifiedDate: modifiedDate, note: note, rect: rect,\n            annotName: annotationName, comments: [], review: { state: '', stateModel: '', author: author, modifiedDate: modifiedDate }, shapeAnnotationType: 'textMarkup', pageNumber: pageNumber,\n            // eslint-disable-next-line max-len\n            textMarkupContent: textContent, textMarkupStartIndex: startIndex, textMarkupEndIndex: endIndex, isMultiSelect: isMultiSelect, annotationSelectorSettings: this.getSelector(type),\n            customData: this.pdfViewer.annotation.getTextMarkupData(subject), annotationAddMode: this.annotationAddMode, annotationSettings: annotationSettings, isPrint: isPrint, isCommentLock: isCommentLock, isAnnotationRotated: false\n        };\n        if (isMultiSelect) {\n            this.multiPageCollection.push(annotation);\n        }\n        var isSkip = false;\n        if (isMultiSelect && this.isExtended) {\n            isSkip = true;\n        }\n        if (document.getElementById(annotationName) && !isSkip) {\n            document.getElementById(annotationName).addEventListener('mouseup', this.annotationDivSelect(annotation, pageNumber));\n        }\n        var storedIndex = this.pdfViewer.annotationModule.storeAnnotations(pageNumber, annotation, '_annotations_textMarkup');\n        this.pdfViewer.annotationModule.addAction(pageNumber, storedIndex, annotation, 'Text Markup Added', null);\n        return annotation;\n    };\n    TextMarkupAnnotation.prototype.getSelector = function (type) {\n        var selector = this.pdfViewer.annotationSelectorSettings;\n        if (type === 'Highlight' && this.pdfViewer.highlightSettings.annotationSelectorSettings) {\n            selector = this.pdfViewer.highlightSettings.annotationSelectorSettings;\n        }\n        else if (type === 'Underline' && this.pdfViewer.underlineSettings.annotationSelectorSettings) {\n            selector = this.pdfViewer.underlineSettings.annotationSelectorSettings;\n        }\n        else if (type === 'Strikethrough' && this.pdfViewer.strikethroughSettings.annotationSelectorSettings) {\n            selector = this.pdfViewer.strikethroughSettings.annotationSelectorSettings;\n        }\n        return selector;\n    };\n    TextMarkupAnnotation.prototype.getAnnotationSettings = function (type) {\n        var annotationSettings = { isLock: false };\n        if (type === 'Highlight' && this.pdfViewer.highlightSettings.isLock) {\n            annotationSettings = { isLock: true };\n        }\n        else if (type === 'Underline' && this.pdfViewer.underlineSettings.isLock) {\n            annotationSettings = { isLock: true };\n        }\n        else if (type === 'Strikethrough' && this.pdfViewer.strikethroughSettings.isLock) {\n            annotationSettings = { isLock: true };\n        }\n        else if (this.pdfViewer.annotationSettings.isLock) {\n            annotationSettings = { isLock: true };\n        }\n        return annotationSettings;\n    };\n    TextMarkupAnnotation.prototype.getIsPrintValue = function (type) {\n        var isPrint = true;\n        if (type === 'Highlight') {\n            isPrint = this.pdfViewer.highlightSettings.isPrint;\n        }\n        if (type === 'Underline') {\n            isPrint = this.pdfViewer.underlineSettings.isPrint;\n        }\n        if (type === 'Strikethrough') {\n            isPrint = this.pdfViewer.strikethroughSettings.isPrint;\n        }\n        return isPrint;\n    };\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.annotationDivSelect = function (annotation, pageNumber) {\n        var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n        this.selectAnnotation(annotation, canvas, pageNumber);\n        if (this.pdfViewer.toolbarModule) {\n            if (this.pdfViewer.toolbarModule.annotationToolbarModule && this.pdfViewer.enableAnnotationToolbar) {\n                this.pdfViewer.toolbarModule.annotationToolbarModule.clearShapeMode();\n                this.pdfViewer.toolbarModule.annotationToolbarModule.clearMeasureMode();\n                var isLock = false;\n                if (annotation.annotationSettings && annotation.annotationSettings.isLock) {\n                    isLock = annotation.annotationSettings.isLock;\n                }\n                if (isLock) {\n                    if (this.pdfViewer.annotationModule.checkAllowedInteractions('PropertyChange', annotation)) {\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.enableTextMarkupAnnotationPropertiesTools(true);\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.setCurrentColorInPicker();\n                    }\n                    if (this.pdfViewer.annotationModule.checkAllowedInteractions('Delete', annotation)) {\n                        this.pdfViewer.toolbarModule.annotationToolbarModule.selectAnnotationDeleteItem(true);\n                    }\n                }\n                else {\n                    this.pdfViewer.toolbarModule.annotationToolbarModule.enableTextMarkupAnnotationPropertiesTools(true);\n                    this.pdfViewer.toolbarModule.annotationToolbarModule.selectAnnotationDeleteItem(true);\n                    this.pdfViewer.toolbarModule.annotationToolbarModule.setCurrentColorInPicker();\n                }\n                this.pdfViewer.toolbarModule.annotationToolbarModule.isToolbarHidden = true;\n                if (!isBlazor()) {\n                    this.pdfViewer.toolbarModule.annotationToolbarModule.showAnnotationToolbar(this.pdfViewer.toolbarModule.annotationItem);\n                }\n            }\n        }\n    };\n    TextMarkupAnnotation.prototype.getPageContext = function (pageNumber) {\n        var canvas = this.pdfViewerBase.getElement('_annotationCanvas_' + pageNumber);\n        var context = null;\n        if (canvas) {\n            context = canvas.getContext('2d');\n        }\n        return context;\n    };\n    TextMarkupAnnotation.prototype.getDefaultValue = function (value) {\n        return value / this.pdfViewerBase.getZoomFactor();\n    };\n    TextMarkupAnnotation.prototype.getMagnifiedValue = function (value, factor) {\n        return value * factor;\n    };\n    /**\n     * @param annotation\n     * @param pageNumber\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.saveImportedTextMarkupAnnotations = function (annotation, pageNumber) {\n        var annotationObject = null;\n        annotation.Author = this.pdfViewer.annotationModule.updateAnnotationAuthor('textMarkup', annotation.Subject);\n        if (annotation.AnnotationSettings && annotation.AnnotationSettings.isLock) {\n            annotation.AnnotationSettings = { isLock: annotation.AnnotationSettings.isLock };\n        }\n        else {\n            annotation.AnnotationSettings = this.getAnnotationSettings(annotation.TextMarkupAnnotationType);\n        }\n        // eslint-disable-next-line max-len\n        annotation.allowedInteractions = this.pdfViewer.annotationModule.updateAnnotationAllowedInteractions(annotation);\n        // eslint-disable-next-line max-len\n        annotationObject = {\n            // eslint-disable-next-line max-len\n            textMarkupAnnotationType: annotation.TextMarkupAnnotationType, color: annotation.Color, opacity: annotation.Opacity, allowedInteractions: annotation.allowedInteractions, bounds: annotation.Bounds, author: annotation.Author, subject: annotation.Subject, modifiedDate: annotation.ModifiedDate, note: annotation.Note, rect: annotation.Rect,\n            annotName: annotation.AnnotName, comments: this.pdfViewer.annotationModule.getAnnotationComments(annotation.Comments, annotation, annotation.Author), review: { state: annotation.State, stateModel: annotation.StateModel, modifiedDate: annotation.ModifiedDate, author: annotation.Author },\n            shapeAnnotationType: 'textMarkup',\n            pageNumber: pageNumber, textMarkupContent: '', textMarkupStartIndex: 0,\n            // eslint-disable-next-line max-len\n            textMarkupEndIndex: 0, annotationSelectorSettings: this.getSettings(annotation), customData: this.pdfViewer.annotation.getCustomData(annotation),\n            isMultiSelect: annotation.IsMultiSelect, annotNameCollection: annotation.AnnotNameCollection, annotpageNumbers: annotation.AnnotpageNumbers,\n            // eslint-disable-next-line max-len\n            annotationAddMode: this.annotationAddMode, annotationSettings: annotation.AnnotationSettings, isPrint: annotation.isPrint, isCommentLock: annotation.IsCommentLock, isAnnotationRotated: false\n        };\n        this.pdfViewer.annotationModule.storeAnnotations(pageNumber, annotationObject, '_annotations_textMarkup');\n    };\n    /**\n     * @param annotation\n     * @param pageNumber\n     * @param annotation\n     * @param pageNumber\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.updateTextMarkupAnnotationCollections = function (annotation, pageNumber) {\n        // eslint-disable-next-line\n        var annotationObject = null;\n        // eslint-disable-next-line max-len\n        annotation.allowedInteractions = annotation.AllowedInteractions ? annotation.AllowedInteractions : this.pdfViewer.annotationModule.updateAnnotationAllowedInteractions(annotation);\n        annotationObject = {\n            // eslint-disable-next-line max-len\n            textMarkupAnnotationType: annotation.TextMarkupAnnotationType, allowedInteractions: annotation.allowedInteractions, color: annotation.Color, opacity: annotation.Opacity, bounds: annotation.Bounds, author: annotation.Author, subject: annotation.Subject, modifiedDate: annotation.ModifiedDate, note: annotation.Note, rect: annotation.Rect,\n            annotationId: annotation.AnnotName, comments: this.pdfViewer.annotationModule.getAnnotationComments(annotation.Comments, annotation, annotation.Author), review: { state: annotation.State, stateModel: annotation.StateModel, modifiedDate: annotation.ModifiedDate, author: annotation.Author }, shapeAnnotationType: 'textMarkup', pageNumber: pageNumber, isMultiSelect: annotation.IsMultiSelect, annotNameCollection: annotation.AnnotNameCollection, annotpageNumbers: annotation.AnnotpageNumbers, customData: this.pdfViewer.annotation.getCustomData(annotation),\n            isPrint: annotation.isPrint, isCommentLock: annotation.IsCommentLock\n        };\n        return annotationObject;\n    };\n    /**\n     * @param textMarkUpSettings\n     * @private\n     */\n    // eslint-disable-next-line\n    TextMarkupAnnotation.prototype.updateTextMarkupSettings = function (textMarkUpSettings) {\n        if (textMarkUpSettings === 'highlightSettings') {\n            // eslint-disable-next-line max-len\n            this.highlightColor = this.pdfViewer.highlightSettings.color ? this.pdfViewer.highlightSettings.color : this.highlightColor;\n            // eslint-disable-next-line max-len\n            this.highlightOpacity = this.pdfViewer.highlightSettings.opacity ? this.pdfViewer.highlightSettings.opacity : this.highlightOpacity;\n        }\n        if (textMarkUpSettings === 'underlineSettings') {\n            // eslint-disable-next-line max-len\n            this.underlineColor = this.pdfViewer.underlineSettings.color ? this.pdfViewer.underlineSettings.color : this.underlineColor;\n            // eslint-disable-next-line max-len\n            this.underlineOpacity = this.pdfViewer.underlineSettings.opacity ? this.pdfViewer.underlineSettings.opacity : this.underlineOpacity;\n        }\n        if (textMarkUpSettings === 'strikethroughSettings') {\n            // eslint-disable-next-line max-len\n            this.strikethroughColor = this.pdfViewer.strikethroughSettings.color ? this.pdfViewer.strikethroughSettings.color : this.strikethroughColor;\n            // eslint-disable-next-line max-len\n            this.strikethroughOpacity = this.pdfViewer.strikethroughSettings.opacity ? this.pdfViewer.strikethroughSettings.opacity : this.strikethroughOpacity;\n        }\n    };\n    /**\n     * @private\n     */\n    TextMarkupAnnotation.prototype.clear = function () {\n        this.selectTextMarkupCurrentPage = null;\n        this.currentTextMarkupAnnotation = null;\n        this.annotationClickPosition = null;\n        window.sessionStorage.removeItem(this.pdfViewerBase.documentId + '_annotations_textMarkup');\n    };\n    /**\n     * Get vertex points properties\n     * @private\n     */\n    TextMarkupAnnotation.prototype.getOffsetPoints = function (points) {\n        var offsetPoints = [];\n        //Converting points model into vertex property\n        for (var j = 0; j < points.length; j++) {\n            offsetPoints[j] = { X: points[j].x, Y: points[j].y, Width: points[j].width, Height: points[j].height, Left: points[j].x, Top: points[j].y };\n        }\n        return offsetPoints;\n    };\n    /**\n     * This method used to add annotations with using program.\n     *\n     * @param annotationType - It describes the annotation type\n     * @param annotationObject - It describes type of annotation object\n     * @returns Object\n     * @private\n     */\n    TextMarkupAnnotation.prototype.updateAddAnnotationDetails = function (annotationType, annotationObject) {\n        //Creating new object if annotationObject is null\n        if (!annotationObject) {\n            annotationObject = { pageNumber: 0 };\n        }\n        //Initialize the annotation settings\n        var annotSelectorSettings = null;\n        var annotallowedInteractions = null;\n        var textMarkupAnnotationType = '';\n        var annotSettings = null;\n        var color = '';\n        var bounds = [];\n        //Creating the CurrentDate and Annotation name\n        var currentDateString = this.pdfViewer.annotation.stickyNotesAnnotationModule.getDateAndTime();\n        var annotationName = this.pdfViewer.annotation.createGUID();\n        if (annotationType == 'Highlight') {\n            //Creating annotation settings\n            annotSelectorSettings = this.pdfViewer.highlightSettings.annotationSelectorSettings ? this.pdfViewer.highlightSettings.annotationSelectorSettings : this.pdfViewer.annotationSelectorSettings;\n            annotSettings = this.pdfViewer.annotationModule.updateSettings(this.pdfViewer.highlightSettings);\n            annotallowedInteractions = this.pdfViewer.highlightSettings.allowedInteractions ? this.pdfViewer.highlightSettings.allowedInteractions : this.pdfViewer.annotationSettings.allowedInteractions;\n            textMarkupAnnotationType = 'Highlight';\n            color = annotationObject.color ? annotationObject.color : '#ffff00';\n        }\n        else if (annotationType == 'Underline') {\n            //Creating annotation settings\n            annotSelectorSettings = this.pdfViewer.underlineSettings.annotationSelectorSettings ? this.pdfViewer.underlineSettings.annotationSelectorSettings : this.pdfViewer.annotationSelectorSettings;\n            annotSettings = this.pdfViewer.annotationModule.updateSettings(this.pdfViewer.underlineSettings);\n            annotallowedInteractions = this.pdfViewer.underlineSettings.allowedInteractions ? this.pdfViewer.underlineSettings.allowedInteractions : this.pdfViewer.annotationSettings.allowedInteractions;\n            textMarkupAnnotationType = 'Underline';\n            color = annotationObject.color ? annotationObject.color : '#00ff00';\n        }\n        else if (annotationType == 'Strikethrough') {\n            //Creating annotation settings\n            annotSelectorSettings = this.pdfViewer.strikethroughSettings.annotationSelectorSettings ? this.pdfViewer.strikethroughSettings.annotationSelectorSettings : this.pdfViewer.annotationSelectorSettings;\n            annotSettings = this.pdfViewer.annotationModule.updateSettings(this.pdfViewer.strikethroughSettings);\n            annotallowedInteractions = this.pdfViewer.strikethroughSettings.allowedInteractions ? this.pdfViewer.strikethroughSettings.allowedInteractions : this.pdfViewer.annotationSettings.allowedInteractions;\n            textMarkupAnnotationType = 'Strikethrough';\n            color = annotationObject.color ? annotationObject.color : '#ff0000';\n        }\n        annotSettings.isLock = annotationObject.isLock ? annotationObject.isLock : false;\n        //Creating the offset points\n        if (annotationObject.bounds) {\n            bounds = this.getOffsetPoints(annotationObject.bounds);\n        }\n        else\n            bounds = [{ X: 1, Y: 1, Width: 100, Height: 14, Left: 1, Top: 1, Location: { X: 1, Y: 1 }, Size: { Height: 14, IsEmpty: false, Width: 100 } }];\n        //Creating Annotation objects with it's proper properties       \n        var textMarkupAnnotation = [];\n        var textmarkup = {\n            AllowedInteractions: annotationObject.allowedInteractions ? annotationObject.allowedInteractions : annotallowedInteractions,\n            AnnotName: annotationName,\n            AnnotNameCollection: null,\n            AnnotType: 'textMarkup',\n            AnnotationSelectorSettings: annotationObject.annotationSelectorSettings ? annotationObject.annotationSelectorSettings : annotSelectorSettings,\n            AnnotationSettings: annotSettings,\n            Author: annotationObject.author ? annotationObject.author : 'Guest',\n            Bounds: bounds,\n            Color: annotationObject.color ? annotationObject.color : color,\n            Comments: null,\n            CreatedDate: currentDateString,\n            CustomData: annotationObject.customData ? annotationObject.customData : null,\n            ExistingCustomData: null,\n            EnableMultiPageAnnotation: annotationObject.enableMultiPageAnnotation ? annotationObject.enableMultiPageAnnotation : false,\n            EnableTextMarkupResizer: annotationObject.enableTextMarkupResizer ? annotationObject.enableTextMarkupResizer : false,\n            IsCommentLock: false,\n            IsMultiSelect: false,\n            IsLock: annotationObject.isLock ? annotationObject.isLock : false,\n            IsPrint: annotationObject.isPrint ? annotationObject.isPrint : true,\n            ModifiedDate: currentDateString,\n            Note: '',\n            Opacity: annotationObject.opacity ? annotationObject.opacity : 1,\n            Rect: {},\n            State: '',\n            StateModel: '',\n            Subject: textMarkupAnnotationType,\n            TextMarkupAnnotationType: textMarkupAnnotationType,\n        };\n        //Adding the annotation object to an array and return it\n        textMarkupAnnotation[0] = textmarkup;\n        return { textMarkupAnnotation: textMarkupAnnotation };\n    };\n    return TextMarkupAnnotation;\n}());\nexport { TextMarkupAnnotation };\n"],"mappings":"AAAA,SAASA,aAAT,EAAwBC,OAAxB,EAAiCC,iBAAjC,EAAoDC,QAApD,QAAoE,sBAApE;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIC,oBAAoB;AAAG;AAAe,YAAY;EAClD;AACJ;AACA;AACA;AACA;EACI,SAASA,oBAAT,CAA8BC,SAA9B,EAAyCC,UAAzC,EAAqD;IACjD,IAAIC,KAAK,GAAG,IAAZ;IACA;AACR;AACA;;;IACQ,KAAKC,wBAAL,GAAgC,EAAhC;IACA;AACR;AACA;;IACQ,KAAKC,2BAAL,GAAmC,IAAnC;IACA;AACR;AACA;;IACQ,KAAKC,2BAAL,GAAmC,IAAnC;IACA;AACR;AACA;;IACQ,KAAKC,8BAAL,GAAsC,KAAtC;IACA,KAAKC,sBAAL,GAA8B,IAA9B;IACA,KAAKC,kBAAL,GAA0B,KAA1B;IACA;AACR;AACA;;IACQ,KAAKC,gBAAL,GAAwB,KAAxB;IACA;AACR;AACA;;IACQ,KAAKC,qBAAL,GAA6B,KAA7B;IACA;AACR;AACA;;IACQ,KAAKC,oBAAL,GAA4B,KAA5B;IACA;AACR;AACA;;IACQ,KAAKC,qBAAL,GAA6B,KAA7B;IACA,KAAKC,UAAL,GAAkB,KAAlB;IACA,KAAKC,eAAL,GAAuB,KAAvB;IACA,KAAKC,kBAAL,GAA0B,IAA1B;IACA,KAAKC,mBAAL,GAA2B,EAA3B;IACA,KAAKC,eAAL,GAAuB,KAAvB;IACA;AACR;AACA;;IACQ,KAAKC,oBAAL,GAA4B,KAA5B;IACA,KAAKC,aAAL,GAAqB,EAArB;IACA;AACR;AACA;;IACQ,KAAKC,uBAAL,GAA+B,EAA/B,CAjDiD,CAkDjD;;IACA,KAAKC,iBAAL,GAAyB,UAAUC,KAAV,EAAiB;MACtCpB,KAAK,CAACO,gBAAN,GAAyB,IAAzB;;MACAP,KAAK,CAACF,SAAN,CAAgBuB,mBAAhB,CAAoCC,wBAApC;;MACAtB,KAAK,CAACW,UAAN,GAAmB,IAAnB;MACAX,KAAK,CAACF,SAAN,CAAgBuB,mBAAhB,CAAoCE,mBAApC,GAA0D,EAA1D;IACH,CALD,CAnDiD,CAyDjD;;;IACA,KAAKC,YAAL,GAAoB,UAAUJ,KAAV,EAAiB;MACjC,IAAIpB,KAAK,CAACO,gBAAV,EAA4B;QACxBP,KAAK,CAACO,gBAAN,GAAyB,KAAzB;MACH;IACJ,CAJD,CA1DiD,CA+DjD;;;IACA,KAAKkB,kBAAL,GAA0B,UAAUL,KAAV,EAAiB;MACvC,IAAIpB,KAAK,CAACO,gBAAV,EAA4B;QACxBP,KAAK,CAACS,oBAAN,GAA6B,IAA7B;MACH;IACJ,CAJD,CAhEiD,CAqEjD;;;IACA,KAAKiB,mBAAL,GAA2B,UAAUN,KAAV,EAAiB;MACxC,IAAIpB,KAAK,CAACO,gBAAV,EAA4B;QACxBP,KAAK,CAACQ,qBAAN,GAA8B,IAA9B;MACH;IACJ,CAJD;;IAKA,KAAKV,SAAL,GAAiBA,SAAjB;IACA,KAAK6B,aAAL,GAAqB5B,UAArB;EACH;EACD;AACJ;AACA;;;EACIF,oBAAoB,CAAC+B,SAArB,CAA+BC,6BAA/B,GAA+D,YAAY;IACvE;IACA,KAAKC,qBAAL,GAA6BrC,aAAa,CAAC,KAAD,EAAQ;MAAEsC,EAAE,EAAE,KAAKjC,SAAL,CAAekC,OAAf,CAAuBD,EAAvB,GAA4B,eAAlC;MAAmDE,SAAS,EAAE;IAA9D,CAAR,CAA1C;IACA,KAAKH,qBAAL,CAA2BI,KAA3B,CAAiCC,WAAjC,GAA+C,WAA/C,CAHuE,CAIvE;;IACA,KAAKC,sBAAL,GAA8B3C,aAAa,CAAC,KAAD,EAAQ;MAAEsC,EAAE,EAAE,KAAKjC,SAAL,CAAekC,OAAf,CAAuBD,EAAvB,GAA4B,gBAAlC;MAAoDE,SAAS,EAAE;IAA/D,CAAR,CAA3C;IACA,KAAKG,sBAAL,CAA4BF,KAA5B,CAAkCG,UAAlC,GAA+C,WAA/C;IACA,KAAKC,eAAL,GAAuB7C,aAAa,CAAC,KAAD,EAAQ;MAAEwC,SAAS,EAAE,cAAb;MAA6BF,EAAE,EAAE,KAAKjC,SAAL,CAAekC,OAAf,CAAuBD,EAAvB,GAA4B;IAA7D,CAAR,CAApC;IACA,KAAKO,eAAL,CAAqBJ,KAArB,CAA2BK,SAA3B,GAAuC,cAAvC;IACA,KAAKT,qBAAL,CAA2BU,WAA3B,CAAuC,KAAKF,eAA5C;IACA,KAAKG,gBAAL,GAAwBhD,aAAa,CAAC,KAAD,EAAQ;MAAEwC,SAAS,EAAE,cAAb;MAA6BF,EAAE,EAAE,KAAKjC,SAAL,CAAekC,OAAf,CAAuBD,EAAvB,GAA4B;IAA7D,CAAR,CAArC;IACA,KAAKU,gBAAL,CAAsBP,KAAtB,CAA4BK,SAA5B,GAAwC,gBAAxC;IACA,KAAKH,sBAAL,CAA4BI,WAA5B,CAAwC,KAAKC,gBAA7C;IACA,KAAKd,aAAL,CAAmBe,aAAnB,CAAiCF,WAAjC,CAA6C,KAAKV,qBAAlD;IACA,KAAKH,aAAL,CAAmBe,aAAnB,CAAiCF,WAAjC,CAA6C,KAAKJ,sBAAlD;IACA,KAAKE,eAAL,CAAqBJ,KAArB,CAA2BS,GAA3B,GAAiC,MAAjC;IACA,KAAKF,gBAAL,CAAsBP,KAAtB,CAA4BS,GAA5B,GAAkC,MAAlC;IACA,KAAKF,gBAAL,CAAsBP,KAAtB,CAA4BU,IAA5B,GAAmC,MAAnC;IACA,KAAKN,eAAL,CAAqBJ,KAArB,CAA2BU,IAA3B,GAAkC,MAAlC;IACA,KAAKd,qBAAL,CAA2BI,KAA3B,CAAiCW,OAAjC,GAA2C,MAA3C;IACA,KAAKT,sBAAL,CAA4BF,KAA5B,CAAkCW,OAAlC,GAA4C,MAA5C;IACA,KAAKf,qBAAL,CAA2BgB,gBAA3B,CAA4C,WAA5C,EAAyD,KAAK3B,iBAA9D;IACA,KAAKW,qBAAL,CAA2BgB,gBAA3B,CAA4C,WAA5C,EAAyD,KAAKrB,kBAA9D;IACA,KAAKK,qBAAL,CAA2BgB,gBAA3B,CAA4C,SAA5C,EAAuD,KAAKtB,YAA5D;IACA,KAAKY,sBAAL,CAA4BU,gBAA5B,CAA6C,WAA7C,EAA0D,KAAK3B,iBAA/D;IACA,KAAKiB,sBAAL,CAA4BU,gBAA5B,CAA6C,WAA7C,EAA0D,KAAKpB,mBAA/D;IACA,KAAKU,sBAAL,CAA4BU,gBAA5B,CAA6C,SAA7C,EAAwD,KAAKtB,YAA7D;EACH,CA3BD;EA4BA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI;;;EACA3B,oBAAoB,CAAC+B,SAArB,CAA+BmB,UAA/B,GAA4C,UAAUC,MAAV,EAAkBC,CAAlB,EAAqBC,CAArB,EAAwB;IAChE,IAAI,KAAKzC,oBAAT,EAA+B;MAC3B,IAAI0C,WAAW,GAAG,KAAKf,sBAAL,CAA4BgB,qBAA5B,EAAlB;MACA,IAAIC,YAAY,GAAG,KAAKvB,qBAAL,CAA2BsB,qBAA3B,EAAnB;MACA,IAAIE,OAAO,GAAGL,CAAd;MACA,IAAIM,OAAO,GAAGL,CAAd;;MACA,IAAIF,MAAM,CAACQ,SAAP,CAAiBC,QAAjB,CAA0B,WAA1B,CAAJ,EAA4C;QACxC,IAAKJ,YAAY,CAACV,GAAb,GAAmB,EAApB,GAA0BQ,WAAW,CAACR,GAA1C,EAA+C;UAC3C,KAAK7C,SAAL,CAAeuB,mBAAf,CAAmCqC,mBAAnC,CAAuDV,MAAvD,EAA+DM,OAA/D,EAAwEC,OAAxE,EAAiF,IAAjF;QACH,CAFD,MAGK;UACD,KAAKzD,SAAL,CAAeuB,mBAAf,CAAmCqC,mBAAnC,CAAuDV,MAAvD,EAA+DM,OAA/D,EAAwEC,OAAxE,EAAiF,KAAjF;QACH;;QACD,KAAKI,kBAAL,CAAwBL,OAAxB,EAAiCC,OAAjC;MACH;IACJ,CAdD,MAeK,IAAI,KAAK/C,qBAAT,EAAgC;MACjC,IAAI2C,WAAW,GAAG,KAAKrB,qBAAL,CAA2BsB,qBAA3B,EAAlB;MACA,IAAIE,OAAO,GAAGL,CAAd;MACA,IAAIM,OAAO,GAAGL,CAAd;;MACA,IAAIF,MAAM,CAACQ,SAAP,CAAiBC,QAAjB,CAA0B,WAA1B,CAAJ,EAA4C;QACxC,IAAKF,OAAD,IAAaJ,WAAW,CAACR,GAA7B,EAAkC;UAC9B,KAAK7C,SAAL,CAAeuB,mBAAf,CAAmCqC,mBAAnC,CAAuDV,MAAvD,EAA+DM,OAA/D,EAAwEC,OAAxE,EAAiF,IAAjF;QACH,CAFD,MAGK;UACD,KAAKzD,SAAL,CAAeuB,mBAAf,CAAmCqC,mBAAnC,CAAuDV,MAAvD,EAA+DM,OAA/D,EAAwEC,OAAxE,EAAiF,KAAjF;QACH;;QACD,KAAKK,cAAL,CAAoBN,OAApB,EAA6BC,OAA7B;MACH;IACJ;EACJ,CA9BD;EA+BA;AACJ;AACA;AACA;;;EACI1D,oBAAoB,CAAC+B,SAArB,CAA+BiC,kBAA/B,GAAoD,UAAUC,IAAV,EAAgB;IAChE,IAAIC,IAAI,GAAG,KAAKjE,SAAL,CAAekE,gBAAf,CAAgCC,0BAAhC,CAA2DhE,wBAAtE;IACA,IAAIiE,eAAe,GAAG,KAAKC,yBAAL,CAA+BJ,IAA/B,CAAtB;;IACA,IAAIG,eAAe,IAAI,KAAKpC,qBAAxB,IAAiD,KAAKM,sBAA1D,EAAkF;MAC9E,IAAI0B,IAAJ,EAAU;QACN,KAAKhC,qBAAL,CAA2BI,KAA3B,CAAiCW,OAAjC,GAA2C,MAA3C;QACA,KAAKT,sBAAL,CAA4BF,KAA5B,CAAkCW,OAAlC,GAA4C,MAA5C;MACH,CAHD,MAIK;QACD,KAAKf,qBAAL,CAA2BI,KAA3B,CAAiCW,OAAjC,GAA2C,EAA3C;QACA,KAAKT,sBAAL,CAA4BF,KAA5B,CAAkCW,OAAlC,GAA4C,EAA5C;QACA,KAAKuB,mBAAL,CAAyBL,IAAzB;MACH;IACJ;EACJ,CAdD;EAeA;AACJ;AACA;AACA;;;EACIlE,oBAAoB,CAAC+B,SAArB,CAA+BuC,yBAA/B,GAA2D,UAAUJ,IAAV,EAAgB;IACvE,IAAIG,eAAe,GAAG,KAAtB;;IACA,IAAIH,IAAJ,EAAU;MACN,IAAIA,IAAI,KAAK,WAAT,IAAwB,KAAKjE,SAAL,CAAeuE,iBAAf,CAAiCC,uBAA7D,EAAsF;QAClFJ,eAAe,GAAG,IAAlB;MACH,CAFD,MAGK,IAAIH,IAAI,KAAK,WAAT,IAAwB,KAAKjE,SAAL,CAAeyE,iBAAf,CAAiCD,uBAA7D,EAAsF;QACvFJ,eAAe,GAAG,IAAlB;MACH,CAFI,MAGA,IAAIH,IAAI,KAAK,eAAT,IAA4B,KAAKjE,SAAL,CAAe0E,qBAAf,CAAqCF,uBAArE,EAA8F;QAC/FJ,eAAe,GAAG,IAAlB;MACH,CAFI,MAGA,IAAI,KAAKpE,SAAL,CAAewE,uBAAnB,EAA4C;QAC7CJ,eAAe,GAAG,IAAlB;MACH;IACJ,CAbD,MAcK;MACD,IAAI,KAAKpE,SAAL,CAAewE,uBAAnB,EAA4C;QACxCJ,eAAe,GAAG,IAAlB;MACH,CAFD,MAGK,IAAI,KAAKpE,SAAL,CAAeuE,iBAAf,CAAiCC,uBAArC,EAA8D;QAC/DJ,eAAe,GAAG,IAAlB;MACH,CAFI,MAGA,IAAI,KAAKpE,SAAL,CAAeyE,iBAAf,CAAiCD,uBAArC,EAA8D;QAC/DJ,eAAe,GAAG,IAAlB;MACH,CAFI,MAGA,IAAI,KAAKpE,SAAL,CAAe0E,qBAAf,CAAqCF,uBAAzC,EAAkE;QACnEJ,eAAe,GAAG,IAAlB;MACH;IACJ;;IACD,OAAOA,eAAP;EACH,CA/BD;;EAgCArE,oBAAoB,CAAC+B,SAArB,CAA+BwC,mBAA/B,GAAqD,UAAUL,IAAV,EAAgB;IACjE,IAAI,KAAKI,yBAAL,CAA+BJ,IAA/B,KAAwC,KAAKjC,qBAA7C,IAAsE,KAAKA,qBAAL,CAA2B2C,WAA3B,GAAyC,CAAnH,EAAsH;MAClH,KAAK3C,qBAAL,CAA2BI,KAA3B,CAAiCwC,KAAjC,GAAyC,KAAKzD,aAAL,GAAqB,KAAKU,aAAL,CAAmBgD,aAAnB,EAArB,GAA0D,IAAnG;MACA,KAAKvC,sBAAL,CAA4BF,KAA5B,CAAkCwC,KAAlC,GAA0C,KAAKzD,aAAL,GAAqB,KAAKU,aAAL,CAAmBgD,aAAnB,EAArB,GAA0D,IAApG;MACA,KAAKrC,eAAL,CAAqBJ,KAArB,CAA2BwC,KAA3B,GAAmC,KAAKzD,aAAL,GAAqB,KAAKU,aAAL,CAAmBgD,aAAnB,EAArB,GAA0D,IAA7F;MACA,KAAKlC,gBAAL,CAAsBP,KAAtB,CAA4BwC,KAA5B,GAAoC,KAAKzD,aAAL,GAAqB,KAAKU,aAAL,CAAmBgD,aAAnB,EAArB,GAA0D,IAA9F;MACA,KAAK7C,qBAAL,CAA2BI,KAA3B,CAAiC0C,MAAjC,GAA0C,KAAK3D,aAAL,GAAqB,KAAKU,aAAL,CAAmBgD,aAAnB,EAArB,GAA0D,IAApG;MACA,KAAKvC,sBAAL,CAA4BF,KAA5B,CAAkC0C,MAAlC,GAA2C,KAAK3D,aAAL,GAAqB,KAAKU,aAAL,CAAmBgD,aAAnB,EAArB,GAA0D,IAArG;MACA,KAAKrC,eAAL,CAAqBJ,KAArB,CAA2B0C,MAA3B,GAAoC,KAAK3D,aAAL,GAAqB,KAAKU,aAAL,CAAmBgD,aAAnB,EAArB,GAA0D,IAA9F;MACA,KAAKlC,gBAAL,CAAsBP,KAAtB,CAA4B0C,MAA5B,GAAqC,KAAK3D,aAAL,GAAqB,KAAKU,aAAL,CAAmBgD,aAAnB,EAArB,GAA0D,IAA/F;MACA,KAAKrC,eAAL,CAAqBJ,KAArB,CAA2BS,GAA3B,GAAiC,KAAK1B,aAAL,GAAqB,KAAKU,aAAL,CAAmBgD,aAAnB,EAArB,GAA0D,IAA3F;MACA,KAAKlC,gBAAL,CAAsBP,KAAtB,CAA4BS,GAA5B,GAAkC,KAAK1B,aAAL,GAAqB,KAAKU,aAAL,CAAmBgD,aAAnB,EAArB,GAA0D,IAA5F;IACH;EACJ,CAbD;;EAcA9E,oBAAoB,CAAC+B,SAArB,CAA+BiD,sBAA/B,GAAwD,YAAY;IAChE,KAAKnE,qBAAL,GAA6B,KAA7B,CADgE,CAEhE;;IACA,IAAIoE,UAAU,GAAG,KAAK3E,2BAAtB;;IACA,IAAI2E,UAAU,IAAIA,UAAU,CAACC,aAA7B,EAA4C;MACxC,KAAKlB,kBAAL,CAAwB,IAAxB;MACA,KAAKmB,sBAAL,CAA4BF,UAA5B;IACH,CAHD,MAIK,IAAIA,UAAU,IAAIA,UAAU,CAACG,MAA7B,EAAqC;MACtC,KAAKC,kBAAL,CAAwBJ,UAAxB,EAAoC,IAApC;MACA,KAAKhF,SAAL,CAAeuB,mBAAf,CAAmCF,iBAAnC,CAAqD,KAAKjB,2BAA1D,EAAuF,KAAvF;MACA,KAAKQ,qBAAL,GAA6B,IAA7B;MACAyE,MAAM,CAACC,YAAP,GAAsBC,eAAtB;IACH;EACJ,CAdD,CApOkD,CAmPlD;;;EACAxF,oBAAoB,CAAC+B,SAArB,CAA+BoD,sBAA/B,GAAwD,UAAUF,UAAV,EAAsB;IAC1E,IAAI,CAACA,UAAU,CAACQ,gBAAhB,EAAkC;MAC9B,IAAIC,cAAc,GAAG,KAAKC,cAAL,CAAoBV,UAAU,CAACW,UAA/B,EAA2C,IAA3C,CAArB;;MACA,IAAIF,cAAJ,EAAoB;QAChB,KAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,cAAc,CAACI,MAAnC,EAA2CD,CAAC,EAA5C,EAAgD;UAC5C,IAAIH,cAAc,CAACG,CAAD,CAAd,CAAkBE,SAAlB,KAAgCd,UAAU,CAACc,SAA/C,EAA0D;YACtDd,UAAU,GAAGS,cAAc,CAACG,CAAD,CAA3B;YACA;UACH;QACJ;MACJ;IACJ;;IACD,IAAIG,YAAY,GAAGf,UAAU,CAACQ,gBAAX,CAA4B,CAA5B,CAAnB;IACA,IAAIQ,aAAa,GAAGhB,UAAU,CAACQ,gBAAX,CAA4B,CAA5B,CAApB;;IACA,KAAK,IAAIS,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjB,UAAU,CAACQ,gBAAX,CAA4BK,MAAhD,EAAwDI,CAAC,EAAzD,EAA6D;MACzD,IAAIC,WAAW,GAAGlB,UAAU,CAACQ,gBAAX,CAA4BS,CAA5B,CAAlB;;MACA,IAAIC,WAAW,IAAIF,aAAnB,EAAkC;QAC9BA,aAAa,GAAGE,WAAhB;MACH;;MACD,IAAIA,WAAW,IAAIH,YAAnB,EAAiC;QAC7BA,YAAY,GAAGG,WAAf;MACH;IACJ;;IACD,KAAK,IAAIC,CAAC,GAAGJ,YAAb,EAA2BI,CAAC,IAAIH,aAAhC,EAA+CG,CAAC,EAAhD,EAAoD;MAChD,IAAIV,cAAc,GAAG,KAAKC,cAAL,CAAoBS,CAApB,EAAuB,IAAvB,CAArB;;MACA,IAAIV,cAAJ,EAAoB;QAChB,KAAK,IAAIW,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGpB,UAAU,CAACqB,mBAAX,CAA+BR,MAAnD,EAA2DO,CAAC,EAA5D,EAAgE;UAC5D;UACA,IAAIE,YAAY,GAAGtB,UAAU,CAACqB,mBAAX,CAA+BD,CAA/B,CAAnB;;UACA,KAAK,IAAIR,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,cAAc,CAACI,MAAnC,EAA2CD,CAAC,EAA5C,EAAgD;YAC5C,IAAIH,cAAc,CAACG,CAAD,CAAd,CAAkBE,SAAlB,KAAgCQ,YAApC,EAAkD;cAC9C;cACA,IAAIC,aAAa,GAAGd,cAAc,CAACG,CAAD,CAAlC;cACA,KAAKR,kBAAL,CAAwBmB,aAAxB,EAAuC,IAAvC;cACA,KAAKvG,SAAL,CAAeuB,mBAAf,CAAmCF,iBAAnC,CAAqDkF,aAAa,CAACZ,UAAnE,EAA+E,KAA/E;YACH;UACJ;QACJ;MACJ;IACJ;;IACD,KAAK/E,qBAAL,GAA6B,IAA7B;IACAyE,MAAM,CAACC,YAAP,GAAsBC,eAAtB;EACH,CA1CD,CApPkD,CA+RlD;;;EACAxF,oBAAoB,CAAC+B,SAArB,CAA+BsD,kBAA/B,GAAoD,UAAUJ,UAAV,EAAsB9C,OAAtB,EAA+B;IAC/E,KAAK,IAAIiE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnB,UAAU,CAACG,MAAX,CAAkBU,MAAtC,EAA8CM,CAAC,EAA/C,EAAmD;MAC/C;MACA,IAAIK,KAAK,GAAGxB,UAAU,CAACG,MAAX,CAAkBgB,CAAlB,CAAZ;MACA,IAAIhD,CAAC,GAAG,CAACqD,KAAK,CAAC1D,IAAN,GAAa0D,KAAK,CAAC1D,IAAnB,GAA0B0D,KAAK,CAACC,IAAjC,IAAyC,KAAK5E,aAAL,CAAmBgD,aAAnB,EAAjD;MACA,IAAIzB,CAAC,GAAG,CAACoD,KAAK,CAAC3D,GAAN,GAAY2D,KAAK,CAAC3D,GAAlB,GAAwB2D,KAAK,CAACE,GAA/B,IAAsC,KAAK7E,aAAL,CAAmBgD,aAAnB,EAA9C;MACA,IAAID,KAAK,GAAG,CAAC4B,KAAK,CAAC5B,KAAN,GAAc4B,KAAK,CAAC5B,KAApB,GAA4B4B,KAAK,CAACG,KAAnC,IAA4C,KAAK9E,aAAL,CAAmBgD,aAAnB,EAAxD;MACA,IAAIC,MAAM,GAAG0B,KAAK,CAAC1B,MAAN,GAAe0B,KAAK,CAAC1B,MAArB,GAA8B0B,KAAK,CAACI,MAAjD,CAN+C,CAO/C;;MACA,IAAIC,SAAS,GAAG,KAAKhF,aAAL,CAAmBiF,UAAnB,CAA8B,gBAAgB9B,UAAU,CAACW,UAAzD,CAAhB;;MACA,IAAIkB,SAAJ,EAAe;QACX;QACA,IAAIE,QAAQ,GAAGF,SAAS,CAACG,UAAzB;;QACA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,QAAQ,CAAClB,MAA7B,EAAqCoB,CAAC,EAAtC,EAA0C;UACtC,IAAIF,QAAQ,CAACE,CAAD,CAAZ,EAAiB;YACb;YACA,IAAIC,WAAW,GAAGH,QAAQ,CAACE,CAAD,CAAR,CAAY3D,qBAAZ,EAAlB;YACA,IAAI6D,KAAK,GAAG,KAAKC,iBAAL,CAAuBF,WAAW,CAACrE,GAAnC,EAAwCmC,UAAU,CAACW,UAAnD,CAAZ,CAHa,CAIb;;YACA,IAAI0B,WAAW,GAAGH,WAAW,CAACpE,IAAZ,GAAmB,KAAKjB,aAAL,CAAmBiF,UAAnB,CAA8B,cAAc9B,UAAU,CAACW,UAAvD,EAAmErC,qBAAnE,GAA2FR,IAAhI;YACA,IAAIwE,SAAS,GAAGD,WAAW,GAAGH,WAAW,CAACtC,KAA1C,CANa,CAOb;;YACA,IAAI2C,WAAW,GAAGC,QAAQ,CAACT,QAAQ,CAACE,CAAD,CAAR,CAAY7E,KAAZ,CAAkBU,IAAnB,CAA1B,CARa,CASb;;YACA,IAAI2E,UAAU,GAAGD,QAAQ,CAACT,QAAQ,CAACE,CAAD,CAAR,CAAY7E,KAAZ,CAAkBS,GAAnB,CAAzB;YACA,IAAI6E,YAAY,GAAG,KAAK1H,SAAL,CAAeuB,mBAAf,CAAmCoG,eAAnC,CAAmDN,WAAnD,EAAgEE,WAAhE,EAA6ED,SAA7E,EAAwFnE,CAAxF,CAAnB;YACA,IAAIyE,WAAW,GAAG,KAAK5H,SAAL,CAAeuB,mBAAf,CAAmCsG,cAAnC,CAAkDV,KAAlD,EAAyDM,UAAzD,EAAqErE,CAArE,CAAlB;;YACA,IAAIsE,YAAY,IAAIE,WAApB,EAAiC;cAC7B1F,OAAO,GAAG6E,QAAQ,CAACE,CAAD,CAAlB;cACA;YACH;UACJ;QACJ;;QACD,IAAI/E,OAAO,IAAI,IAAf,EAAqB;UACjB;UACA,IAAI4F,YAAY,GAAG,KAAKjG,aAAL,CAAmBiF,UAAnB,CAA8B,gBAAgB9B,UAAU,CAACW,UAAzD,EAAqErC,qBAArE,EAAnB;UACA,KAAKtD,SAAL,CAAeuB,mBAAf,CAAmCwG,wBAAnC,CAA4D7F,OAA5D,EAAqEiB,CAAC,GAAG2E,YAAY,CAAChF,IAAtF,EAA4FM,CAAC,GAAG0E,YAAY,CAACjF,GAA7G,EAAkH,KAAlH;;UACA,IAAKmC,UAAU,CAACG,MAAX,CAAkBU,MAAlB,GAA2B,CAA5B,KAAmCM,CAAvC,EAA0C;YACtC;YACA,KAAKnG,SAAL,CAAeuB,mBAAf,CAAmCwG,wBAAnC,CAA4D7F,OAA5D,EAAqEiB,CAAC,GAAG2E,YAAY,CAAChF,IAAjB,GAAwB8B,KAA7F,EAAoGxB,CAAC,GAAG0E,YAAY,CAACjF,GAArH,EAA0H,KAA1H;UACH;QACJ;MACJ;IACJ;EACJ,CA5CD;EA6CA;AACJ;AACA;AACA;AACA;AACA;;;EACI9C,oBAAoB,CAAC+B,SAArB,CAA+BgC,cAA/B,GAAgD,UAAUX,CAAV,EAAaC,CAAb,EAAgB4E,UAAhB,EAA4B;IACxE,KAAKjE,kBAAL,CAAwB,KAAxB;IACA,IAAIkE,YAAY,GAAG,KAAKpG,aAAL,CAAmBqG,QAAnB,CAA4B,KAAKrG,aAAL,CAAmBsG,iBAAnB,GAAuC,CAAnE,EAAsEtF,GAAzF;IACA,IAAIuF,cAAc,GAAG,KAAKhB,iBAAL,CAAuBhE,CAAvB,EAA0B,KAAKvB,aAAL,CAAmBsG,iBAAnB,GAAuC,CAAjE,CAArB,CAHwE,CAIxE;;IACA,IAAIE,eAAe,GAAGC,QAAQ,CAACC,cAAT,CAAwB,KAAKvI,SAAL,CAAekC,OAAf,CAAuBD,EAAvB,GAA4B,gBAApD,CAAtB;;IACA,IAAI+F,UAAJ,EAAgB;MACZ;MACAK,eAAe,CAACjG,KAAhB,CAAsBS,GAAtB,GAA4BuF,cAAc,GAAG,KAAKvG,aAAL,CAAmBgD,aAAnB,EAAjB,GAAsDoD,YAAY,GAAG,KAAKpG,aAAL,CAAmBgD,aAAnB,EAArE,GAA0G,IAAtI;IACH,CAHD,MAIK;MACD;MACAwD,eAAe,CAACjG,KAAhB,CAAsBS,GAAtB,GAA4BuF,cAAc,GAAGH,YAAY,GAAG,KAAKpG,aAAL,CAAmBgD,aAAnB,EAAhC,GAAqE,IAAjG;IACH,CAbuE,CAcxE;;;IACAwD,eAAe,CAACjG,KAAhB,CAAsBU,IAAtB,GAA6BK,CAAC,GAAG,KAAKtB,aAAL,CAAmB2G,eAAnB,CAAmCC,UAAvC,GAAoD,KAAK5G,aAAL,CAAmB2G,eAAnB,CAAmClF,qBAAnC,GAA2DR,IAA/G,GAAsH,IAAnJ;EACH,CAhBD;EAiBA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;EACI/C,oBAAoB,CAAC+B,SAArB,CAA+B+B,kBAA/B,GAAoD,UAAUV,CAAV,EAAaC,CAAb,EAAgB4E,UAAhB,EAA4B;IAC5E,KAAKjE,kBAAL,CAAwB,KAAxB;IACA,IAAIkE,YAAY,GAAG,KAAKpG,aAAL,CAAmBqG,QAAnB,CAA4B,KAAKrG,aAAL,CAAmBsG,iBAAnB,GAAuC,CAAnE,EAAsEtF,GAAzF;IACA,IAAIuF,cAAc,GAAG,KAAKhB,iBAAL,CAAuBhE,CAAvB,EAA0B,KAAKvB,aAAL,CAAmBsG,iBAAnB,GAAuC,CAAjE,CAArB,CAH4E,CAI5E;;IACA,IAAIO,cAAc,GAAGJ,QAAQ,CAACC,cAAT,CAAwB,KAAKvI,SAAL,CAAekC,OAAf,CAAuBD,EAAvB,GAA4B,eAApD,CAArB;IACAyG,cAAc,CAACtG,KAAf,CAAqBW,OAArB,GAA+B,EAA/B;;IACA,IAAIiF,UAAJ,EAAgB;MACZ;MACAU,cAAc,CAACtG,KAAf,CAAqBS,GAArB,GAA2BuF,cAAc,GAAG,KAAKvG,aAAL,CAAmBgD,aAAnB,EAAjB,GAAsDoD,YAAY,GAAG,KAAKpG,aAAL,CAAmBgD,aAAnB,EAArE,GAA0G,IAArI;IACH,CAHD,MAIK;MACD;MACA6D,cAAc,CAACtG,KAAf,CAAqBS,GAArB,GAA2BuF,cAAc,GAAGH,YAAY,GAAG,KAAKpG,aAAL,CAAmBgD,aAAnB,EAAhC,GAAqE,IAAhG;IACH,CAd2E,CAe5E;;;IACA6D,cAAc,CAACtG,KAAf,CAAqBU,IAArB,GAA4BK,CAAC,GAAG,KAAKtB,aAAL,CAAmB2G,eAAnB,CAAmCC,UAAvC,GAAoD,KAAK5G,aAAL,CAAmB2G,eAAnB,CAAmClF,qBAAnC,GAA2DR,IAA/G,GAAuH,KAAK3B,aAAL,GAAqB,KAAKU,aAAL,CAAmBgD,aAAnB,EAA5I,GAAkL,IAA9M;EACH,CAjBD;;EAkBA9E,oBAAoB,CAAC+B,SAArB,CAA+BsF,iBAA/B,GAAmD,UAAUuB,WAAV,EAAuBhD,UAAvB,EAAmC;IAClF,IAAI,KAAK9D,aAAL,CAAmBiF,UAAnB,CAA8B,cAAcnB,UAA5C,CAAJ,EAA6D;MACzD;MACA,OAAOgD,WAAW,GAAG,KAAK9G,aAAL,CAAmBiF,UAAnB,CAA8B,cAAcnB,UAA5C,EAAwDrC,qBAAxD,GAAgFT,GAArG;IACH,CAHD,MAIK;MACD,OAAO8F,WAAP;IACH;EACJ,CARD;EASA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI;;;EACA5I,oBAAoB,CAAC+B,SAArB,CAA+B8G,iCAA/B,GAAmE,UAAUC,qBAAV,EAAiClD,UAAjC,EAA6CmD,kBAA7C,EAAiE;IAChI,IAAIC,MAAM,GAAG,KAAKlH,aAAL,CAAmBiF,UAAnB,CAA8B,uBAAuBnB,UAArD,CAAb;;IACA,IAAImD,kBAAJ,EAAwB;MACpB,KAAKE,2BAAL,CAAiC,IAAjC,EAAuCrD,UAAvC,EAAmDoD,MAAnD,EAA2D,KAAKlH,aAAL,CAAmBgD,aAAnB,EAA3D;MACA,KAAKmE,2BAAL,CAAiCH,qBAAjC,EAAwDlD,UAAxD,EAAoEoD,MAApE,EAA4E,KAAKlH,aAAL,CAAmBgD,aAAnB,EAA5E,EAAgH,IAAhH;IACH,CAHD,MAIK;MACD,KAAKmE,2BAAL,CAAiCH,qBAAjC,EAAwDlD,UAAxD,EAAoEoD,MAApE,EAA4E,KAAKlH,aAAL,CAAmBgD,aAAnB,EAA5E;IACH;EACJ,CATD,CArZkD,CA+ZlD;;;EACA9E,oBAAoB,CAAC+B,SAArB,CAA+BkH,2BAA/B,GAA6D,UAAUH,qBAAV,EAAiClD,UAAjC,EAA6CoD,MAA7C,EAAqDE,MAArD,EAA6DC,cAA7D,EAA6E;IACtI,IAAIH,MAAJ,EAAY;MACR,IAAII,OAAO,GAAGJ,MAAM,CAACK,UAAP,CAAkB,IAAlB,CAAd;MACAD,OAAO,CAACE,YAAR,CAAqB,CAArB,EAAwB,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B,EAAiC,CAAjC,EAAoC,CAApC;MACAF,OAAO,CAACG,WAAR,CAAoB,EAApB,EAHQ,CAIR;;MACA,IAAIC,WAAW,GAAG,KAAK,CAAvB;;MACA,IAAI,CAACL,cAAL,EAAqB;QACjBK,WAAW,GAAG,KAAK7D,cAAL,CAAoBC,UAApB,EAAgCkD,qBAAhC,CAAd;MACH,CAFD,MAGK;QACDU,WAAW,GAAGV,qBAAd;MACH;;MACD,IAAIU,WAAJ,EAAiB;QACb,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,WAAW,CAAC1D,MAAhC,EAAwC2D,CAAC,EAAzC,EAA6C;UACzC;UACA,IAAIxE,UAAU,GAAGuE,WAAW,CAACC,CAAD,CAA5B;UACA,IAAIC,gBAAgB,GAAG,IAAvB;UACA,IAAIC,mBAAmB,GAAG,KAAK,CAA/B;;UACA,IAAI1E,UAAU,CAAC2E,wBAAf,EAAyC;YACrC,IAAIT,cAAJ,EAAoB;cAChB,IAAI,KAAKrH,aAAL,CAAmB+H,cAAvB,EAAuC;gBACnC,IAAIC,QAAQ,GAAG,EAAf;;gBACA,KAAK,IAAIC,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAG9E,UAAU,CAAC+E,MAAX,CAAkBlE,MAA1C,EAAkDiE,GAAG,EAArD,EAAyD;kBACrD;kBACA9E,UAAU,CAAC+E,MAAX,CAAkBD,GAAlB,IAAyB,KAAKjI,aAAL,CAAmBmI,6BAAnB,CAAiDhF,UAAU,CAACiF,MAA5D,EAAoEtE,UAApE,EAAgFX,UAAU,CAAC+E,MAAX,CAAkBD,GAAlB,CAAhF,EAAwG9E,UAAU,CAACkF,kBAAnH,CAAzB;kBACAlF,UAAU,CAAC+E,MAAX,CAAkBD,GAAlB,EAAuBhH,IAAvB,GAA8BkC,UAAU,CAAC+E,MAAX,CAAkBD,GAAlB,EAAuBK,CAArD;kBACAnF,UAAU,CAAC+E,MAAX,CAAkBD,GAAlB,EAAuBjH,GAAvB,GAA6BmC,UAAU,CAAC+E,MAAX,CAAkBD,GAAlB,EAAuBM,CAApD;kBACAP,QAAQ,CAACQ,IAAT,CAAcrF,UAAU,CAAC+E,MAAX,CAAkBD,GAAlB,CAAd;gBACH;;gBACD9E,UAAU,CAAC+E,MAAX,GAAoBF,QAApB;gBACAH,mBAAmB,GAAG,KAAK7H,aAAL,CAAmByI,aAAzC;cACH;YACJ,CAdoC,CAerC;;;YACAtF,UAAU,CAACuF,iBAAX,GAA+B,KAAKvK,SAAL,CAAekE,gBAAf,CAAgCsG,kBAAhC,CAAmDxF,UAAnD,EAA+DW,UAA/D,EAA2EX,UAAU,CAACyF,SAAtF,CAA/B;;YACA,IAAI,CAACzF,UAAU,CAAC0F,MAAhB,EAAwB;cACpB;cACA1F,UAAU,CAAC0F,MAAX,GAAoB,KAAK1K,SAAL,CAAekE,gBAAf,CAAgCyG,sBAAhC,CAAuD,YAAvD,EAAqE3F,UAAU,CAAC2E,wBAAhF,CAApB;YACH;;YACD,IAAI,CAAC3E,UAAU,CAAC4F,OAAhB,EAAyB;cACrB5F,UAAU,CAAC4F,OAAX,GAAqB5F,UAAU,CAAC2E,wBAAhC;YACH;;YACD,IAAI3E,UAAU,CAAC6F,kBAAX,IAAiC7F,UAAU,CAAC6F,kBAAX,CAA8BC,MAAnE,EAA2E;cACvE9F,UAAU,CAAC6F,kBAAX,GAAgC;gBAAEC,MAAM,EAAE9F,UAAU,CAAC6F,kBAAX,CAA8BC;cAAxC,CAAhC;YACH,CAFD,MAGK;cACD9F,UAAU,CAAC6F,kBAAX,GAAgC,KAAKE,qBAAL,CAA2B/F,UAAU,CAAC2E,wBAAtC,CAAhC;YACH;;YACD,IAAIqB,SAAS,GAAG,IAAhB;;YACA,IAAIhG,UAAU,CAACuF,iBAAX,KAAiC,qBAArC,EAA4D;cACxDS,SAAS,GAAGhG,UAAU,CAACiG,OAAvB;YACH,CAFD,MAGK;cACDD,SAAS,GAAG,KAAKE,eAAL,CAAqBlG,UAAU,CAAC2E,wBAAhC,CAAZ;YACH,CApCoC,CAqCrC;;;YACA3E,UAAU,CAACmG,mBAAX,GAAiCnG,UAAU,CAACoG,mBAAX,GAAiCpG,UAAU,CAACoG,mBAA5C,GAAkE,KAAKpL,SAAL,CAAekE,gBAAf,CAAgCmH,mCAAhC,CAAoErG,UAApE,CAAnG,CAtCqC,CAuCrC;;YACAyE,gBAAgB,GAAG;cACf6B,wBAAwB,EAAEtG,UAAU,CAAC2E,wBADtB;cACgD4B,KAAK,EAAEvG,UAAU,CAACwG,KADlE;cACyEL,mBAAmB,EAAEnG,UAAU,CAACmG,mBADzG;cAC8HM,OAAO,EAAEzG,UAAU,CAAC0G,OADlJ;cAC2JvG,MAAM,EAAEH,UAAU,CAAC+E,MAD9K;cACsL4B,MAAM,EAAE3G,UAAU,CAAC0F,MADzM;cACiNkB,OAAO,EAAE5G,UAAU,CAAC4F,OADrO;cAC8OiB,YAAY,EAAE7G,UAAU,CAAC8G,YADvQ;cACqRC,IAAI,EAAE/G,UAAU,CAACgH,IADtS;cAC4SC,IAAI,EAAEjH,UAAU,CAACkH,IAD7T;cAEf;cACApG,SAAS,EAAEd,UAAU,CAACmH,SAHP;cAGkBC,QAAQ,EAAE,KAAKpM,SAAL,CAAekE,gBAAf,CAAgCmI,qBAAhC,CAAsDrH,UAAU,CAACsH,QAAjE,EAA2EtH,UAA3E,EAAuFA,UAAU,CAAC0F,MAAlG,CAH5B;cAGuI6B,MAAM,EAAE;gBAAEC,KAAK,EAAExH,UAAU,CAACyH,KAApB;gBAA2BC,UAAU,EAAE1H,UAAU,CAAC2H,UAAlD;gBAA8Dd,YAAY,EAAE7G,UAAU,CAAC8G,YAAvF;gBAAqGH,MAAM,EAAE3G,UAAU,CAAC0F;cAAxH,CAH/I;cAGiRkC,mBAAmB,EAAE,YAHtS;cAGoTjH,UAAU,EAAEA,UAHhU;cAIfkH,iBAAiB,EAAE7H,UAAU,CAAC8H,iBAJf;cAIkCC,oBAAoB,EAAE,CAJxD;cAI2DC,kBAAkB,EAAE,CAJ/E;cAIkFC,0BAA0B,EAAE,KAAKC,WAAL,CAAiBlI,UAAjB,CAJ9G;cAKf;cACAmI,UAAU,EAAE,KAAKnN,SAAL,CAAegF,UAAf,CAA0BoI,aAA1B,CAAwCpI,UAAxC,CANG;cAMkDuF,iBAAiB,EAAEvF,UAAU,CAACuF,iBANhF;cAMmG8C,kBAAkB,EAAErI,UAAU,CAAC6F,kBANlI;cAMsJyC,OAAO,EAAEtC,SAN/J;cAM0KuC,aAAa,EAAEvI,UAAU,CAACwI,aANpM;cAMmN9D,mBAAmB,EAAEA;YANxO,CAAnB;;YAQA,IAAI1E,UAAU,CAACyI,aAAf,EAA8B;cAC1BhE,gBAAgB,CAACpD,mBAAjB,GAAuCrB,UAAU,CAAC0I,mBAAlD;cACAjE,gBAAgB,CAACjE,gBAAjB,GAAoCR,UAAU,CAAC2I,gBAA/C;cACAlE,gBAAgB,CAACxE,aAAjB,GAAiCD,UAAU,CAACyI,aAA5C;YACH;;YACD,IAAIzI,UAAU,CAAC6H,iBAAX,IAAgC7H,UAAU,CAAC6H,iBAAX,KAAiC,EAArE,EAAyE;cACrEpD,gBAAgB,CAACoD,iBAAjB,GAAqC7H,UAAU,CAAC6H,iBAAhD;cACApD,gBAAgB,CAACsD,oBAAjB,GAAwC/H,UAAU,CAAC+H,oBAAnD;cACAtD,gBAAgB,CAACuD,kBAAjB,GAAsChI,UAAU,CAACgI,kBAAjD;YACH;;YACD,KAAKhN,SAAL,CAAekE,gBAAf,CAAgC0J,gBAAhC,CAAiDjI,UAAjD,EAA6D8D,gBAA7D,EAA+E,yBAA/E;;YACA,IAAI,KAAKnJ,8BAAT,EAAyC;cACrC;cACA,IAAIuN,QAAQ,GAAG;gBACXpC,OAAO,EAAEhC,gBAAgB,CAACgC,OADf;gBACwBE,MAAM,EAAE3G,UAAU,CAAC2G,MAD3C;gBACmDC,OAAO,EAAE5G,UAAU,CAAC4G,OADvE;gBACgFC,YAAY,EAAE7G,UAAU,CAAC6G,YADzG;gBAEX;gBACAjH,KAAK,EAAE6E,gBAAgB,CAACtE,MAAjB,CAAwBP,KAHpB;gBAG2BE,MAAM,EAAE2E,gBAAgB,CAACtE,MAAjB,CAAwBL;cAH3D,CAAf;cAKA,KAAK9E,SAAL,CAAe8N,iBAAf,CAAiCrE,gBAAgB,CAAC9D,UAAlD,EAA8D8D,gBAAgB,CAAC3D,SAA/E,EAA0Fd,UAAU,CAAC2E,wBAArG,EAA+HF,gBAAgB,CAACtE,MAAhJ,EAAwJ0I,QAAxJ;YACH;UACJ,CAzEwC,CA0EzC;;;UACA,IAAI5J,IAAI,GAAGe,UAAU,CAAC2E,wBAAX,GAAsC3E,UAAU,CAAC2E,wBAAjD,GAA4E3E,UAAU,CAACsG,wBAAlG,CA3EyC,CA4EzC;;UACA,IAAIyC,WAAW,GAAG/I,UAAU,CAAC+E,MAAX,GAAoB/E,UAAU,CAAC+E,MAA/B,GAAwC/E,UAAU,CAACG,MAArE;UACA,IAAIsG,OAAO,GAAGzG,UAAU,CAAC0G,OAAX,GAAqB1G,UAAU,CAAC0G,OAAhC,GAA0C1G,UAAU,CAACyG,OAAnE;UACA,IAAIF,KAAK,GAAGvG,UAAU,CAACwG,KAAX,GAAmBxG,UAAU,CAACwG,KAA9B,GAAsCxG,UAAU,CAACuG,KAA7D;UACA,IAAI+B,OAAO,GAAG,IAAd;;UACA,IAAItI,UAAU,CAAC2E,wBAAf,EAAyC;YACrC2D,OAAO,GAAGtI,UAAU,CAACiG,OAArB;UACH;;UACD,IAAIjG,UAAU,CAACsG,wBAAf,EAAyC;YACrCgC,OAAO,GAAGtI,UAAU,CAACsI,OAArB;UACH;;UACD,QAAQrJ,IAAR;YACI,KAAK,WAAL;cACI,KAAK+J,yBAAL,CAA+BD,WAA/B,EAA4CtC,OAA5C,EAAqDF,KAArD,EAA4DpC,OAA5D,EAAqEF,MAArE,EAA6EqE,OAA7E,EAAsF3H,UAAtF;cACA;;YACJ,KAAK,eAAL;cACI,KAAKsI,yBAAL,CAA+BF,WAA/B,EAA4CtC,OAA5C,EAAqDF,KAArD,EAA4DpC,OAA5D,EAAqEF,MAArE,EAA6EtD,UAA7E,EAAyF2H,OAAzF;cACA;;YACJ,KAAK,WAAL;cACI,KAAKY,yBAAL,CAA+BH,WAA/B,EAA4CtC,OAA5C,EAAqDF,KAArD,EAA4DpC,OAA5D,EAAqEF,MAArE,EAA6EtD,UAA7E,EAAyF2H,OAAzF;cACA;UATR;QAWH;MACJ;;MACD,IAAIa,oBAAoB,GAAG,KAA3B;;MACA,IAAI,KAAK9N,2BAAL,IAAoC,KAAKA,2BAAL,CAAiCmF,gBAAzE,EAA2F;QACvF,KAAK,IAAI4I,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK/N,2BAAL,CAAiCmF,gBAAjC,CAAkDK,MAAtE,EAA8EuI,CAAC,EAA/E,EAAmF;UAC/E,IAAIzI,UAAU,KAAK,KAAKtF,2BAAL,CAAiCmF,gBAAjC,CAAkD4I,CAAlD,CAAnB,EAAyE;YACrED,oBAAoB,GAAG,IAAvB;YACA,KAAK3N,kBAAL,GAA0B,KAA1B;YACA;UACH;QACJ;MACJ;;MACD,IAAKmF,UAAU,KAAK,KAAKvF,2BAArB,IAAqD+N,oBAAzD,EAA+E;QAC3E,IAAI,CAAC,KAAK3N,kBAAV,EAA8B;UAC1B,KAAK6N,2BAAL;QACH,CAFD,MAGK;UACD,KAAK7N,kBAAL,GAA0B,KAA1B;QACH;MACJ;IACJ;EACJ,CArID;EAsIA;AACJ;AACA;AACA;EACI;;;EACAT,oBAAoB,CAAC+B,SAArB,CAA+BoL,WAA/B,GAA6C,UAAUlI,UAAV,EAAsB;IAC/D,IAAIsJ,QAAJ;;IACA,IAAItJ,UAAU,CAACuJ,0BAAf,EAA2C;MACvCD,QAAQ,GAAGtJ,UAAU,CAACuJ,0BAAtB;IACH,CAFD,MAGK;MACDD,QAAQ,GAAG,KAAKE,WAAL,CAAiBxJ,UAAU,CAAC2E,wBAA5B,CAAX;IACH;;IACD,OAAO2E,QAAP;EACH,CATD;EAUA;AACJ;AACA;AACA;;;EACIvO,oBAAoB,CAAC+B,SAArB,CAA+B2M,yBAA/B,GAA2D,UAAUxK,IAAV,EAAgB;IACvE,KAAKyK,0BAAL,GAAkC,IAAlC;IACA,KAAKvO,wBAAL,GAAgC8D,IAAhC;IACA,IAAI0K,SAAS,GAAG,IAAhB;IACA,KAAK3N,mBAAL,GAA2B,EAA3B;IACA,IAAI4N,eAAe,GAAG,KAAK5O,SAAL,CAAeuB,mBAAf,GAAqC,KAAKvB,SAAL,CAAeuB,mBAAf,CAAmCE,mBAAxE,GAA8F,EAApH;;IACA,IAAImN,eAAe,CAAC/I,MAAhB,GAAyB,CAAzB,IAA8B,CAAC,KAAKjF,qBAAxC,EAA+D;MAC3D,KAAKiO,4BAAL,CAAkC5K,IAAlC,EAAwC2K,eAAxC,EAAyD,KAAK/M,aAAL,CAAmBgD,aAAnB,EAAzD;IACH;;IACD,IAAI,KAAKR,yBAAL,CAA+BJ,IAA/B,KAAwC,KAAKpD,UAA7C,IAA2DwE,MAAM,CAACC,YAAP,GAAsBwJ,QAAtB,EAA/D,EAAiG;MAC7F,IAAIC,UAAU,GAAG,KAAKC,cAAL,EAAjB;;MACA,IAAID,UAAU,CAAC,CAAD,CAAV,IAAiBA,UAAU,CAAC,CAAD,CAAV,CAAc5J,MAAnC,EAA2C;QACvC;QACA,IAAImB,YAAY,GAAG,KAAKjG,2BAAxB;;QACA,KAAK,IAAI8F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4I,UAAU,CAAClJ,MAA/B,EAAuCM,CAAC,EAAxC,EAA4C;UACxC,IAAIG,YAAY,IAAIA,YAAY,CAACX,UAAb,KAA4BoJ,UAAU,CAAC5I,CAAD,CAAV,CAAc8I,SAA9D,EAAyE;YACrE,KAAK5O,2BAAL,GAAmCiG,YAAnC;YACA,KAAKlG,2BAAL,GAAmC2O,UAAU,CAAC5I,CAAD,CAAV,CAAc8I,SAAjD;YACA,KAAKC,gCAAL,CAAsCH,UAAtC,EAAkD5I,CAAlD;UACH,CAJD,MAKK;YACD,IAAIG,YAAJ,EAAkB;cACd,IAAIrC,IAAI,KAAK,EAAb,EAAiB;gBACbA,IAAI,GAAGqC,YAAY,CAACgF,wBAApB;cACH;YACJ;;YACD,IAAI,CAAChF,YAAY,CAACrB,aAAlB,EAAiC;cAC7B,IAAIA,aAAa,GAAG,KAApB;;cACA,IAAI,KAAKkK,iBAAL,CAAuBlL,IAAvB,CAAJ,EAAkC;gBAC9B,KAAKjD,mBAAL,CAAyBqJ,IAAzB,CAA8B/D,YAA9B;gBACArB,aAAa,GAAG,IAAhB;cACH,CAL4B,CAM7B;;;cACA,KAAKmK,eAAL,CAAqBnL,IAArB,EAA2B8K,UAAU,CAAC5I,CAAD,CAAV,CAAchB,MAAzC,EAAiD4J,UAAU,CAAC5I,CAAD,CAAV,CAAc8I,SAA/D,EAA0EF,UAAU,CAAC5I,CAAD,CAAV,CAAc8F,IAAxF,EAA8F,KAAKpK,aAAL,CAAmBgD,aAAnB,EAA9F,EAAkIkK,UAAU,CAAC5I,CAAD,CAAV,CAAckJ,WAAhJ,EAA6JN,UAAU,CAAC5I,CAAD,CAAV,CAAcmJ,UAA3K,EAAuLP,UAAU,CAAC5I,CAAD,CAAV,CAAcoJ,QAArM,EAA+MtK,aAA/M;YACH,CARD,MASK;cACD,IAAIqB,YAAY,CAACrB,aAAb,IAA8BqB,YAAY,CAACD,mBAA/C,EAAoE;gBAChE,KAAKmJ,uBAAL,CAA6BlJ,YAA7B,EAA2CyI,UAA3C,EAAuD5I,CAAvD;cACH;YACJ;UACJ;QACJ;MACJ;IACJ,CAlCD,MAmCK,IAAId,MAAM,CAACC,YAAP,GAAsBwJ,QAAtB,EAAJ,EAAsC;MACvC,IAAIC,UAAU,GAAG,KAAKC,cAAL,EAAjB;MACA,IAAI/J,aAAa,GAAG,KAAKwK,sBAAL,CAA4BV,UAA5B,EAAwC9K,IAAxC,CAApB;;MACA,IAAI8K,UAAU,CAAClJ,MAAX,GAAoB,CAAxB,EAA2B;QACvB,KAAK,IAAI2D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGuF,UAAU,CAAClJ,MAA/B,EAAuC2D,CAAC,EAAxC,EAA4C;UACxC,IAAIvF,IAAI,KAAK,EAAb,EAAiB;YACb0K,SAAS,GAAG,KAAZ;UACH,CAHuC,CAIxC;;;UACA,KAAKS,eAAL,CAAqBnL,IAArB,EAA2B8K,UAAU,CAACvF,CAAD,CAAV,CAAcrE,MAAzC,EAAiD4J,UAAU,CAACvF,CAAD,CAAV,CAAcyF,SAA/D,EAA0EF,UAAU,CAACvF,CAAD,CAAV,CAAcyC,IAAxF,EAA8F,KAAKpK,aAAL,CAAmBgD,aAAnB,EAA9F,EAAkIkK,UAAU,CAACvF,CAAD,CAAV,CAAc6F,WAAhJ,EAA6JN,UAAU,CAACvF,CAAD,CAAV,CAAc8F,UAA3K,EAAuLP,UAAU,CAACvF,CAAD,CAAV,CAAc+F,QAArM,EAA+MtK,aAA/M;QACH;MACJ;IACJ;;IACD,IAAI,KAAKjE,mBAAT,EAA8B;MAC1B,KAAK,IAAIoF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKpF,mBAAL,CAAyB6E,MAA7C,EAAqDO,CAAC,EAAtD,EAA0D;QACtD,KAAKsJ,qBAAL,CAA2B,KAAK1O,mBAAL,CAAyBoF,CAAzB,CAA3B,EAAwD,KAAKpF,mBAAL,CAAyBoF,CAAzB,EAA4BT,UAApF;MACH;IACJ;;IACD,KAAK9E,UAAL,GAAkB,KAAlB;IACA,KAAKD,qBAAL,GAA6B,KAA7B,CA/DuE,CAgEvE;;IACA,IAAI+N,SAAS,IAAI,KAAK3O,SAAL,CAAeuB,mBAAhC,EAAqD;MACjD,KAAKvB,SAAL,CAAeuB,mBAAf,CAAmCoO,kBAAnC;IACH;;IACD,IAAI,KAAKtL,yBAAL,CAA+BJ,IAA/B,CAAJ,EAA0C;MACtC,KAAKc,sBAAL;IACH;EACJ,CAvED,CAzjBkD,CAioBlD;;;EACAhF,oBAAoB,CAAC+B,SAArB,CAA+B2N,sBAA/B,GAAwD,UAAUV,UAAV,EAAsB9K,IAAtB,EAA4B;IAChF,IAAIgB,aAAa,GAAG,KAApB;;IACA,KAAK,IAAIgC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG8H,UAAU,CAAClJ,MAA/B,EAAuCoB,CAAC,EAAxC,EAA4C;MACxC,IAAI8H,UAAU,CAAC9H,CAAD,CAAV,CAAcgI,SAAd,KAA4BF,UAAU,CAAC,CAAD,CAAV,CAAcE,SAA1C,IAAuD,KAAKE,iBAAL,CAAuBlL,IAAvB,CAA3D,EAAyF;QACrFgB,aAAa,GAAG,IAAhB;QACA;MACH;IACJ;;IACD,OAAOA,aAAP;EACH,CATD;;EAUAlF,oBAAoB,CAAC+B,SAArB,CAA+BqN,iBAA/B,GAAmD,UAAUlL,IAAV,EAAgB;IAC/D,IAAI2L,WAAW,GAAG,KAAlB;;IACA,IAAI3L,IAAI,KAAK,WAAT,IAAwB,KAAKjE,SAAL,CAAeuE,iBAAf,CAAiCsL,yBAA7D,EAAwF;MACpFD,WAAW,GAAG,IAAd;IACH,CAFD,MAGK,IAAI3L,IAAI,KAAK,WAAT,IAAwB,KAAKjE,SAAL,CAAeyE,iBAAf,CAAiCoL,yBAA7D,EAAwF;MACzFD,WAAW,GAAG,IAAd;IACH,CAFI,MAGA,IAAI3L,IAAI,KAAK,eAAT,IAA4B,KAAKjE,SAAL,CAAe0E,qBAAf,CAAqCmL,yBAArE,EAAgG;MACjGD,WAAW,GAAG,IAAd;IACH,CAFI,MAGA,IAAI,KAAK5P,SAAL,CAAe6P,yBAAnB,EAA8C;MAC/CD,WAAW,GAAG,IAAd;IACH;;IACD,OAAOA,WAAP;EACH,CAfD,CA5oBkD,CA4pBlD;;;EACA7P,oBAAoB,CAAC+B,SAArB,CAA+B0N,uBAA/B,GAAyD,UAAUlJ,YAAV,EAAwByI,UAAxB,EAAoCe,KAApC,EAA2C;IAChG,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGzJ,YAAY,CAACD,mBAAb,CAAiCR,MAArD,EAA6DkK,CAAC,EAA9D,EAAkE;MAC9D;MACA,IAAIC,aAAa,GAAG1J,YAAY,CAACD,mBAAb,CAAiC0J,CAAjC,CAApB;MACA,IAAItK,cAAc,GAAG,KAAKC,cAAL,CAAoBqJ,UAAU,CAACe,KAAD,CAAV,CAAkBb,SAAtC,EAAiD,IAAjD,CAArB;;MACA,IAAIxJ,cAAJ,EAAoB;QAChB,KAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,cAAc,CAACI,MAAnC,EAA2CD,CAAC,EAA5C,EAAgD;UAC5C,IAAIH,cAAc,CAACG,CAAD,CAAd,CAAkBE,SAAlB,KAAgCkK,aAApC,EAAmD;YAC/C,KAAK3P,2BAAL,GAAmCoF,cAAc,CAACG,CAAD,CAAjD;YACA,KAAKxF,2BAAL,GAAmC2O,UAAU,CAACe,KAAD,CAAV,CAAkBb,SAArD;YACA,KAAKC,gCAAL,CAAsCH,UAAtC,EAAkDe,KAAlD;YACA;UACH;QACJ;MACJ;IACJ;EACJ,CAhBD,CA7pBkD,CA8qBlD;;;EACA/P,oBAAoB,CAAC+B,SAArB,CAA+BmO,sBAA/B,GAAwD,UAAU1J,aAAV,EAAyBvB,UAAzB,EAAqCkL,SAArC,EAAgD;IACpG,KAAK,IAAI1G,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjD,aAAa,CAACpB,MAAd,CAAqBU,MAAzC,EAAiD2D,CAAC,EAAlD,EAAsD;MAClD;MACA,IAAIhD,KAAK,GAAGD,aAAa,CAACpB,MAAd,CAAqBqE,CAArB,CAAZ;MACA,IAAIrG,CAAC,GAAGqD,KAAK,CAAC1D,IAAN,GAAa0D,KAAK,CAAC1D,IAAnB,GAA0B0D,KAAK,CAACC,IAAxC;MACA,IAAIrD,CAAC,GAAGoD,KAAK,CAAC3D,GAAN,GAAY2D,KAAK,CAAC3D,GAAlB,GAAwB2D,KAAK,CAACE,GAAtC;MACA,IAAI9B,KAAK,GAAG4B,KAAK,CAAC5B,KAAN,GAAc4B,KAAK,CAAC5B,KAApB,GAA4B4B,KAAK,CAACG,KAA9C;MACA,IAAI7B,MAAM,GAAG0B,KAAK,CAAC1B,MAAN,GAAe0B,KAAK,CAAC1B,MAArB,GAA8B0B,KAAK,CAACI,MAAjD;;MACA,IAAI,CAACsJ,SAAL,EAAgB;QACZA,SAAS,GAAG,KAAKrO,aAAL,CAAmBiF,UAAnB,CAA8B,uBAAuBP,aAAa,CAACZ,UAAnE,CAAZ;MACH,CATiD,CAUlD;;;MACA,KAAKwK,wBAAL,CAA8BD,SAA9B,EAAyC,KAAKE,iBAAL,CAAuBjN,CAAC,GAAG,GAA3B,EAAgC,KAAKtB,aAAL,CAAmBgD,aAAnB,EAAhC,CAAzC,EAA8G,KAAKuL,iBAAL,CAAuBhN,CAAC,GAAG,GAA3B,EAAgC,KAAKvB,aAAL,CAAmBgD,aAAnB,EAAhC,CAA9G,EAAmL,KAAKuL,iBAAL,CAAuBxL,KAAK,GAAG,GAA/B,EAAoC,KAAK/C,aAAL,CAAmBgD,aAAnB,EAApC,CAAnL,EAA4P,KAAKuL,iBAAL,CAAuBtL,MAAM,GAAG,GAAhC,EAAqC,KAAKjD,aAAL,CAAmBgD,aAAnB,EAArC,CAA5P,EAAsUG,UAAtU;IACH;EACJ,CAdD,CA/qBkD,CA8rBlD;;;EACAjF,oBAAoB,CAAC+B,SAArB,CAA+BuO,0BAA/B,GAA4D,UAAUrL,UAAV,EAAsB;IAC9E,KAAK,IAAImB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnB,UAAU,CAACqB,mBAAX,CAA+BR,MAAnD,EAA2DM,CAAC,EAA5D,EAAgE;MAC5D;MACA,IAAIG,YAAY,GAAGtB,UAAU,CAACqB,mBAAX,CAA+BF,CAA/B,CAAnB;;MACA,IAAIG,YAAY,KAAKtB,UAAU,CAACc,SAAhC,EAA2C;QACvC,KAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjB,UAAU,CAACQ,gBAAX,CAA4BK,MAAhD,EAAwDI,CAAC,EAAzD,EAA6D;UACzD,IAAIC,WAAW,GAAGlB,UAAU,CAACQ,gBAAX,CAA4BS,CAA5B,CAAlB;UACA,IAAIR,cAAc,GAAG,KAAKC,cAAL,CAAoBQ,WAApB,EAAiC,IAAjC,CAArB;;UACA,IAAIT,cAAJ,EAAoB;YAChB,KAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,cAAc,CAACI,MAAnC,EAA2CD,CAAC,EAA5C,EAAgD;cAC5C,IAAIH,cAAc,CAACG,CAAD,CAAd,CAAkBE,SAAlB,KAAgCQ,YAApC,EAAkD;gBAC9C;gBACA,IAAIC,aAAa,GAAGd,cAAc,CAACG,CAAD,CAAlC;gBACA,KAAKqK,sBAAL,CAA4B1J,aAA5B,EAA2CvB,UAA3C;cACH;YACJ;UACJ;QACJ;MACJ;IACJ;EACJ,CApBD,CA/rBkD,CAotBlD;;;EACAjF,oBAAoB,CAAC+B,SAArB,CAA+BwO,wBAA/B,GAA0D,UAAUtL,UAAV,EAAsB;IAC5E,KAAK,IAAImB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnB,UAAU,CAACqB,mBAAX,CAA+BR,MAAnD,EAA2DM,CAAC,EAA5D,EAAgE;MAC5D;MACA,IAAIG,YAAY,GAAGtB,UAAU,CAACqB,mBAAX,CAA+BF,CAA/B,CAAnB;;MACA,IAAIG,YAAY,KAAKtB,UAAU,CAACc,SAAhC,EAA2C;QACvC,KAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjB,UAAU,CAACQ,gBAAX,CAA4BK,MAAhD,EAAwDI,CAAC,EAAzD,EAA6D;UACzD,IAAIC,WAAW,GAAGlB,UAAU,CAACQ,gBAAX,CAA4BS,CAA5B,CAAlB;UACA,IAAIR,cAAc,GAAG,KAAKC,cAAL,CAAoBQ,WAApB,EAAiC,IAAjC,CAArB;;UACA,IAAIT,cAAJ,EAAoB;YAChB,KAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,cAAc,CAACI,MAAnC,EAA2CD,CAAC,EAA5C,EAAgD;cAC5C,IAAIH,cAAc,CAACG,CAAD,CAAd,CAAkBE,SAAlB,KAAgCQ,YAApC,EAAkD;gBAC9C;gBACA,IAAIC,aAAa,GAAGd,cAAc,CAACG,CAAD,CAAlC;gBACA,IAAI2K,iBAAiB,GAAG,IAAxB;gBACAA,iBAAiB,GAAG9K,cAAc,CAAC+K,MAAf,CAAsB5K,CAAtB,EAAyB,CAAzB,EAA4B,CAA5B,CAApB;gBACA,KAAK5F,SAAL,CAAekE,gBAAf,CAAgCuM,SAAhC,CAA0CvK,WAA1C,EAAuDN,CAAvD,EAA0D2K,iBAA1D,EAA6E,qBAA7E,EAAoG,IAApG;gBACA,KAAKhQ,sBAAL,GAA8BqF,CAA9B;gBACA,KAAK5F,SAAL,CAAegF,UAAf,CAA0B0L,2BAA1B,CAAsDC,YAAtD,CAAmEJ,iBAAnE,EAAsF,YAAtF;gBACA,IAAIK,SAAS,GAAGtI,QAAQ,CAACC,cAAT,CAAwBgI,iBAAiB,CAACzK,SAA1C,CAAhB;;gBACA,IAAI8K,SAAJ,EAAe;kBACX,IAAIA,SAAS,CAACC,aAAV,CAAwBC,iBAAxB,KAA8C,CAAlD,EAAqD;oBACjD,KAAK9Q,SAAL,CAAekE,gBAAf,CAAgCwM,2BAAhC,CAA4DK,wBAA5D,CAAqFH,SAArF;kBACH,CAFD,MAGK;oBACDA,SAAS,CAACI,MAAV;kBACH;gBACJ;;gBACD,KAAKhR,SAAL,CAAekE,gBAAf,CAAgC+M,0BAAhC,CAA2D1K,aAA3D;gBACA,KAAK2K,iBAAL,CAAuBzL,cAAvB,EAAuCS,WAAvC,EAlB8C,CAmB9C;;gBACA,KAAKlG,SAAL,CAAekE,gBAAf,CAAgCiN,gCAAhC,CAAiE5K,aAAjE,EAAgFA,aAAa,CAACZ,UAA9F,EAA0G,sBAA1G;gBACA,IAAIyL,YAAY,GAAG7K,aAAa,CAACT,SAAjC,CArB8C,CAsB9C;;gBACA,IAAIuL,gBAAgB,GAAG9K,aAAa,CAACpB,MAArC;gBACA,KAAKnF,SAAL,CAAekE,gBAAf,CAAgCoN,iBAAhC,CAAkDpL,WAAlD,EAA+D,IAA/D,EAAqE,IAArE,EAA2E,IAA3E;cACH;YACJ;UACJ;QACJ;MACJ;IACJ;EACJ,CAzCD,CArtBkD,CA+vBlD;;;EACAnG,oBAAoB,CAAC+B,SAArB,CAA+ByP,0BAA/B,GAA4D,UAAUvM,UAAV,EAAsBwM,QAAtB,EAAgCC,KAAhC,EAAuC;IAC/F,KAAK,IAAItL,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnB,UAAU,CAACqB,mBAAX,CAA+BR,MAAnD,EAA2DM,CAAC,EAA5D,EAAgE;MAC5D;MACA,IAAIG,YAAY,GAAGtB,UAAU,CAACqB,mBAAX,CAA+BF,CAA/B,CAAnB;;MACA,IAAIG,YAAY,KAAKtB,UAAU,CAACc,SAAhC,EAA2C;QACvC,KAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjB,UAAU,CAACQ,gBAAX,CAA4BK,MAAhD,EAAwDI,CAAC,EAAzD,EAA6D;UACzD,IAAIC,WAAW,GAAGlB,UAAU,CAACQ,gBAAX,CAA4BS,CAA5B,CAAlB;UACA,IAAIR,cAAc,GAAG,KAAKC,cAAL,CAAoBQ,WAApB,EAAiC,IAAjC,CAArB;;UACA,IAAIT,cAAJ,EAAoB;YAChB,KAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,cAAc,CAACI,MAAnC,EAA2CD,CAAC,EAA5C,EAAgD;cAC5C,IAAIH,cAAc,CAACG,CAAD,CAAd,CAAkBE,SAAlB,KAAgCQ,YAApC,EAAkD;gBAC9C,IAAIkL,QAAQ,KAAK,OAAjB,EAA0B;kBACtB/L,cAAc,CAACG,CAAD,CAAd,CAAkB2F,KAAlB,GAA0BkG,KAA1B;gBACH,CAFD,MAGK;kBACDhM,cAAc,CAACG,CAAD,CAAd,CAAkB6F,OAAlB,GAA4BgG,KAA5B;gBACH;;gBACDhM,cAAc,CAACG,CAAD,CAAd,CAAkBiG,YAAlB,GAAiC,KAAK7L,SAAL,CAAegF,UAAf,CAA0B0L,2BAA1B,CAAsDgB,cAAtD,EAAjC;gBACA,KAAKnR,sBAAL,GAA8BqF,CAA9B;;gBACA,IAAI+L,MAAM,KAAK,IAAX,IAAmBA,MAAM,KAAK,SAAlC,EAA6C;kBACzC;kBACA,KAAK3R,SAAL,CAAekE,gBAAf,CAAgCuM,SAAhC,CAA0ChL,cAAc,CAACG,CAAD,CAAd,CAAkBD,UAA5D,EAAwEC,CAAxE,EAA2EH,cAAc,CAACG,CAAD,CAAzF,EAA8F,+BAA9F,EAA+H4L,QAA/H;gBACH;;gBACD,KAAKxR,SAAL,CAAekE,gBAAf,CAAgCwM,2BAAhC,CAA4DkB,4BAA5D,CAAyFnM,cAAc,CAACG,CAAD,CAAvG;gBACA,KAAKsL,iBAAL,CAAuBzL,cAAvB,EAAuCS,WAAvC;gBACA,KAAKlG,SAAL,CAAekE,gBAAf,CAAgCoN,iBAAhC,CAAkDpL,WAAlD,EAA+D,IAA/D,EAAqE,IAArE,EAA2E,IAA3E;cACH;YACJ;UACJ;QACJ;MACJ;IACJ;EACJ,CAhCD;;EAiCAnG,oBAAoB,CAAC+B,SAArB,CAA+B+M,4BAA/B,GAA8D,UAAU5K,IAAV,EAAgB2K,eAAhB,EAAiC3F,MAAjC,EAAyC;IACnG,IAAIhE,aAAa,GAAG,KAApB;IACA,KAAKhE,eAAL,GAAuB,KAAvB;IACA,KAAKD,mBAAL,GAA2B,EAA3B;;IACA,KAAK,IAAIwI,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoF,eAAe,CAAC/I,MAApC,EAA4C2D,CAAC,EAA7C,EAAiD;MAC7C,IAAIqI,SAAS,GAAGjD,eAAe,CAACpF,CAAD,CAAf,CAAmB6F,WAAnC,CAD6C,CAE7C;;MACA,IAAIyC,OAAO,GAAG,KAAK,CAAnB;;MACA,IAAIlD,eAAe,CAACpF,CAAD,CAAf,CAAmBuI,SAAnB,KAAiCnD,eAAe,CAACpF,CAAD,CAAf,CAAmBwI,OAAxD,EAAiE;QAC7D,IAAIC,UAAU,GAAG3J,QAAQ,CAACC,cAAT,CAAwBqG,eAAe,CAACpF,CAAD,CAAf,CAAmBuI,SAA3C,EAAsD1C,WAAvE;QACAyC,OAAO,GAAG,KAAKI,eAAL,CAAqBtD,eAAe,CAACpF,CAAD,CAAf,CAAmB7D,UAAxC,EAAoDkM,SAApD,EAA+DI,UAA/D,CAAV;MACH,CAHD,MAIK;QACDH,OAAO,GAAG,KAAKI,eAAL,CAAqBtD,eAAe,CAACpF,CAAD,CAAf,CAAmB7D,UAAxC,EAAoDkM,SAApD,CAAV;MACH;;MACD,IAAI,CAAC5M,aAAL,EAAoB;QAChB,KAAK,IAAIgC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2H,eAAe,CAAC/I,MAApC,EAA4CoB,CAAC,EAA7C,EAAiD;UAC7C,IAAI2H,eAAe,CAAC3H,CAAD,CAAf,CAAmBtB,UAAnB,KAAkCiJ,eAAe,CAAC,CAAD,CAAf,CAAmBjJ,UAArD,IAAmE,KAAKwJ,iBAAL,CAAuBlL,IAAvB,CAAvE,EAAqG;YACjGgB,aAAa,GAAG,IAAhB;YACA;UACH;QACJ;MACJ;;MACD,IAAI,KAAKkK,iBAAL,CAAuBlL,IAAvB,KAAiC2K,eAAe,CAAC/I,MAAhB,GAAyB,CAA1B,KAAiC2D,CAArE,EAAwE;QACpE,KAAKvI,eAAL,GAAuB,IAAvB;MACH,CArB4C,CAsB7C;;;MACA,KAAKmO,eAAL,CAAqBnL,IAArB,EAA2B2K,eAAe,CAACpF,CAAD,CAAf,CAAmB2I,eAA9C,EAA+DvD,eAAe,CAACpF,CAAD,CAAf,CAAmB7D,UAAlF,EAA8FiJ,eAAe,CAACpF,CAAD,CAAf,CAAmBhD,KAAjH,EAAwHyC,MAAxH,EAAgI4I,SAAhI,EAA2IC,OAAO,CAACxC,UAAnJ,EAA+JwC,OAAO,CAACvC,QAAvK,EAAiLtK,aAAjL;IACH;EACJ,CA7BD,CAjyBkD,CA+zBlD;;;EACAlF,oBAAoB,CAAC+B,SAArB,CAA+BoN,gCAA/B,GAAkE,UAAUH,UAAV,EAAsBqD,YAAtB,EAAoC;IAClG,IAAI,KAAK/R,2BAAT,EAAsC;MAClC,IAAIgS,eAAe,GAAG,KAAK3M,cAAL,CAAoBqJ,UAAU,CAACqD,YAAD,CAAV,CAAyBnD,SAA7C,EAAwD,IAAxD,CAAtB;MACA,IAAIjK,UAAU,GAAG,IAAjB;;MACA,IAAIqN,eAAJ,EAAqB;QACjB,KAAK,IAAI7I,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6I,eAAe,CAACxM,MAApC,EAA4C2D,CAAC,EAA7C,EAAiD;UAC7C,IAAI8I,IAAI,CAACC,SAAL,CAAe,KAAKlS,2BAApB,MAAqDiS,IAAI,CAACC,SAAL,CAAeF,eAAe,CAAC7I,CAAD,CAA9B,CAAzD,EAA6F;YACzF6I,eAAe,CAAC7I,CAAD,CAAf,CAAmBrE,MAAnB,GAA4B4J,UAAU,CAACqD,YAAD,CAAV,CAAyBjN,MAArD;YACAkN,eAAe,CAAC7I,CAAD,CAAf,CAAmBqD,iBAAnB,GAAuCkC,UAAU,CAACqD,YAAD,CAAV,CAAyB/C,WAAhE;YACAgD,eAAe,CAAC7I,CAAD,CAAf,CAAmBuD,oBAAnB,GAA0CgC,UAAU,CAACqD,YAAD,CAAV,CAAyB9C,UAAnE;YACA+C,eAAe,CAAC7I,CAAD,CAAf,CAAmBwD,kBAAnB,GAAwC+B,UAAU,CAACqD,YAAD,CAAV,CAAyB7C,QAAjE;YACA8C,eAAe,CAAC7I,CAAD,CAAf,CAAmBqC,YAAnB,GAAkC,KAAK7L,SAAL,CAAegF,UAAf,CAA0B0L,2BAA1B,CAAsDgB,cAAtD,EAAlC;YACA1M,UAAU,GAAGqN,eAAe,CAAC7I,CAAD,CAA5B;UACH;QACJ;;QACD,KAAK0H,iBAAL,CAAuBmB,eAAvB,EAAwCtD,UAAU,CAACqD,YAAD,CAAV,CAAyBnD,SAAjE;QACA,KAAK5O,2BAAL,GAAmC,IAAnC;QACA,KAAKL,SAAL,CAAekE,gBAAf,CAAgCoN,iBAAhC,CAAkDvC,UAAU,CAACqD,YAAD,CAAV,CAAyBnD,SAA3E,EAAsF,IAAtF,EAA4F,IAA5F,EAAkG,IAAlG;QACA,KAAKpN,aAAL,CAAmB2Q,4BAAnB,CAAgD,IAAhD;;QACA,IAAIxN,UAAJ,EAAgB;UACZ;UACA,IAAI6I,QAAQ,GAAG;YAAEpC,OAAO,EAAEzG,UAAU,CAACyG,OAAtB;YAA+BF,KAAK,EAAEvG,UAAU,CAACuG,KAAjD;YAAwDI,MAAM,EAAE3G,UAAU,CAAC2G,MAA3E;YAAmFC,OAAO,EAAE5G,UAAU,CAAC4G,OAAvG;YAAgHC,YAAY,EAAE7G,UAAU,CAAC6G;UAAzI,CAAf,CAFY,CAGZ;;UACA,IAAI7K,mBAAmB,GAAG,KAAKyR,uBAAL,CAA6BzN,UAA7B,CAA1B;;UACA,IAAIhE,mBAAmB,CAAC6E,MAApB,GAA6B,CAAjC,EAAoC;YAChC,IAAKkJ,UAAU,CAAClJ,MAAX,GAAoB,CAArB,KAA4BuM,YAAhC,EAA8C;cAC1C;cACA,KAAKpS,SAAL,CAAe0S,oBAAf,CAAoC3D,UAAU,CAACqD,YAAD,CAAV,CAAyBnD,SAA7D,EAAwEjK,UAAU,CAACc,SAAnF,EAA8Fd,UAAU,CAACsG,wBAAzG,EAAmItG,UAAU,CAACG,MAA9I,EAAsJ0I,QAAtJ,EAAgK7I,UAAU,CAAC6H,iBAA3K,EAA8L7H,UAAU,CAAC+H,oBAAzM,EAA+N/H,UAAU,CAACgI,kBAA1O,EAA8P,IAA9P,EAAoQhM,mBAApQ;YACH;UACJ,CALD,MAMK;YACD;YACA,KAAKhB,SAAL,CAAe0S,oBAAf,CAAoC3D,UAAU,CAACqD,YAAD,CAAV,CAAyBnD,SAA7D,EAAwEjK,UAAU,CAACc,SAAnF,EAA8Fd,UAAU,CAACsG,wBAAzG,EAAmItG,UAAU,CAACG,MAA9I,EAAsJ0I,QAAtJ,EAAgK7I,UAAU,CAAC6H,iBAA3K,EAA8L7H,UAAU,CAAC+H,oBAAzM,EAA+N/H,UAAU,CAACgI,kBAA1O,EAA8P,IAA9P;UACH;QACJ,CA9BgB,CA+BjB;;;QACA,KAAKzM,sBAAL,GAA8B,IAA9B;QACA,KAAKH,2BAAL,GAAmC,IAAnC;MACH;IACJ;EACJ,CAxCD;EAyCA;AACJ;AACA;AACA;EACI;;;EACAL,oBAAoB,CAAC+B,SAArB,CAA+B2Q,uBAA/B,GAAyD,UAAUzN,UAAV,EAAsB;IAC3E,IAAIyN,uBAAuB,GAAG,EAA9B;;IACA,IAAIzN,UAAU,CAACC,aAAX,IAA4BD,UAAU,CAACqB,mBAA3C,EAAgE;MAC5DoM,uBAAuB,CAACpI,IAAxB,CAA6BrF,UAA7B;;MACA,KAAK,IAAImB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnB,UAAU,CAACqB,mBAAX,CAA+BR,MAAnD,EAA2DM,CAAC,EAA5D,EAAgE;QAC5D;QACA,IAAIG,YAAY,GAAGtB,UAAU,CAACqB,mBAAX,CAA+BF,CAA/B,CAAnB;;QACA,IAAIG,YAAY,KAAKtB,UAAU,CAACc,SAAhC,EAA2C;UACvC,KAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjB,UAAU,CAACQ,gBAAX,CAA4BK,MAAhD,EAAwDI,CAAC,EAAzD,EAA6D;YACzD,IAAIC,WAAW,GAAGlB,UAAU,CAACQ,gBAAX,CAA4BS,CAA5B,CAAlB;YACA,IAAIR,cAAc,GAAG,KAAKC,cAAL,CAAoBQ,WAApB,EAAiC,IAAjC,CAArB;;YACA,IAAIT,cAAJ,EAAoB;cAChB,KAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,cAAc,CAACI,MAAnC,EAA2CD,CAAC,EAA5C,EAAgD;gBAC5C,IAAIH,cAAc,CAACG,CAAD,CAAd,CAAkBE,SAAlB,KAAgCQ,YAApC,EAAkD;kBAC9CmM,uBAAuB,CAACpI,IAAxB,CAA6B5E,cAAc,CAACG,CAAD,CAA3C;gBACH;cACJ;YACJ;UACJ;QACJ;MACJ;IACJ;;IACD,OAAO6M,uBAAP;EACH,CAvBD,CA92BkD,CAs4BlD;;;EACA1S,oBAAoB,CAAC+B,SAArB,CAA+B4N,qBAA/B,GAAuD,UAAUnG,WAAV,EAAuB5D,UAAvB,EAAmC;IACtF,IAAI4D,WAAJ,EAAiB;MACb,IAAI8I,eAAe,GAAG,KAAK3M,cAAL,CAAoBC,UAApB,EAAgC,IAAhC,CAAtB;MACA,IAAIX,UAAU,GAAG,IAAjB;;MACA,IAAIqN,eAAJ,EAAqB;QACjB,KAAK,IAAI7I,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6I,eAAe,CAACxM,MAApC,EAA4C2D,CAAC,EAA7C,EAAiD;UAC7C,IAAID,WAAW,CAACzD,SAAZ,KAA0BuM,eAAe,CAAC7I,CAAD,CAAf,CAAmB1D,SAAjD,EAA4D;YACxD;YACA,IAAI6M,qBAAqB,GAAG,EAA5B,CAFwD,CAGxD;;YACA,IAAInN,gBAAgB,GAAG,EAAvB;;YACA,KAAK,IAAIS,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKjF,mBAAL,CAAyB6E,MAA7C,EAAqDI,CAAC,EAAtD,EAA0D;cACtD0M,qBAAqB,CAACtI,IAAtB,CAA2B,KAAKrJ,mBAAL,CAAyBiF,CAAzB,EAA4BH,SAAvD;cACAN,gBAAgB,CAAC6E,IAAjB,CAAsB,KAAKrJ,mBAAL,CAAyBiF,CAAzB,EAA4BN,UAAlD;YACH;;YACD0M,eAAe,CAAC7I,CAAD,CAAf,CAAmBvE,aAAnB,GAAmC,IAAnC;YACAoN,eAAe,CAAC7I,CAAD,CAAf,CAAmBnD,mBAAnB,GAAyCsM,qBAAzC;YACAN,eAAe,CAAC7I,CAAD,CAAf,CAAmBhE,gBAAnB,GAAsCA,gBAAtC;YACAR,UAAU,GAAGqN,eAAe,CAAC7I,CAAD,CAA5B;UACH;QACJ;;QACD,KAAK0H,iBAAL,CAAuBmB,eAAvB,EAAwC1M,UAAxC;MACH;IACJ;EACJ,CAxBD,CAv4BkD,CAg6BlD;;;EACA5F,oBAAoB,CAAC+B,SAArB,CAA+B8Q,uBAA/B,GAAyD,UAAU5N,UAAV,EAAsB6N,SAAtB,EAAiC;IACtF,IAAI7N,UAAJ,EAAgB;MACZ,IAAIqN,eAAe,GAAG,KAAK3M,cAAL,CAAoB,KAAKtF,2BAAzB,EAAsD,IAAtD,CAAtB;MACA,IAAI0S,YAAY,GAAG,IAAnB;;MACA,IAAIT,eAAJ,EAAqB;QACjB,KAAK,IAAI7I,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6I,eAAe,CAACxM,MAApC,EAA4C2D,CAAC,EAA7C,EAAiD;UAC7C,IAAI8I,IAAI,CAACC,SAAL,CAAe,KAAKlS,2BAApB,MAAqDiS,IAAI,CAACC,SAAL,CAAeF,eAAe,CAAC7I,CAAD,CAA9B,CAAzD,EAA6F;YACzF6I,eAAe,CAAC7I,CAAD,CAAf,CAAmBqD,iBAAnB,GAAuCgG,SAAS,CAACxD,WAAjD;YACAgD,eAAe,CAAC7I,CAAD,CAAf,CAAmBuD,oBAAnB,GAA0C8F,SAAS,CAACvD,UAApD;YACA+C,eAAe,CAAC7I,CAAD,CAAf,CAAmBwD,kBAAnB,GAAwC6F,SAAS,CAACtD,QAAlD;YACAuD,YAAY,GAAGT,eAAe,CAAC7I,CAAD,CAA9B;UACH;;UACD,KAAKxJ,SAAL,CAAekE,gBAAf,CAAgC6O,0BAAhC,CAA2DV,eAAe,CAAC7I,CAAD,CAA1E,EAA+E,KAAKpJ,2BAApF;QACH;;QACD,KAAK8Q,iBAAL,CAAuBmB,eAAvB,EAAwC,KAAKjS,2BAA7C;MACH;IACJ;EACJ,CAjBD,CAj6BkD,CAm7BlD;;;EACAL,oBAAoB,CAAC+B,SAArB,CAA+BsN,eAA/B,GAAiD,UAAUnL,IAAV,EAAgBkB,MAAhB,EAAwBQ,UAAxB,EAAoCsG,IAApC,EAA0ChD,MAA1C,EAAkDoG,WAAlD,EAA+DC,UAA/D,EAA2EC,QAA3E,EAAqFtK,aAArF,EAAoG;IACjJ,IAAID,UAAU,GAAG,IAAjB;IACA,KAAKlE,eAAL,GAAuB,KAAvB;IACA,IAAI6K,MAAM,GAAG,OAAb;IACA,IAAIC,OAAJ;IACA,IAAIzC,OAAO,GAAG,KAAK6J,cAAL,CAAoBrN,UAApB,CAAd;IACA,IAAIkG,YAAY,GAAG,KAAK7L,SAAL,CAAegF,UAAf,CAA0B0L,2BAA1B,CAAsDgB,cAAtD,EAAnB;IACA,KAAKuB,cAAL,GAAsB,KAAKA,cAAL,GAAsB,KAAKA,cAA3B,GAA4C,KAAKjT,SAAL,CAAeuE,iBAAf,CAAiCgH,KAAnG;IACA,KAAK2H,cAAL,GAAsB,KAAKA,cAAL,GAAsB,KAAKA,cAA3B,GAA4C,KAAKlT,SAAL,CAAeyE,iBAAf,CAAiC8G,KAAnG;IACA,KAAK4H,kBAAL,GAA0B,KAAKA,kBAAL,GAA0B,KAAKA,kBAA/B,GAAoD,KAAKnT,SAAL,CAAe0E,qBAAf,CAAqC6G,KAAnH;IACA,KAAK6H,gBAAL,GAAwB,KAAKpT,SAAL,CAAeuE,iBAAf,CAAiCkH,OAAzD;IACA,KAAK4H,gBAAL,GAAwB,KAAKrT,SAAL,CAAeyE,iBAAf,CAAiCgH,OAAzD;IACA,KAAK6H,oBAAL,GAA4B,KAAKtT,SAAL,CAAe0E,qBAAf,CAAqC+G,OAAjE;IACA,KAAKlB,iBAAL,GAAyB,qBAAzB,CAbiJ,CAcjJ;;IACA,IAAIY,mBAAJ;;IACA,IAAIhC,OAAJ,EAAa;MACTA,OAAO,CAACG,WAAR,CAAoB,EAApB;;MACA,QAAQrF,IAAR;QACI,KAAK,WAAL;UACI,KAAKnD,eAAL,GAAuB,IAAvB;UACA8K,OAAO,GAAG,WAAV,CAFJ,CAGI;;UACAD,MAAM,GAAI,KAAK3L,SAAL,CAAeuE,iBAAf,CAAiCoH,MAAjC,KAA4C,OAA5C,IAAuD,KAAK3L,SAAL,CAAeuE,iBAAf,CAAiCoH,MAAzF,GAAmG,KAAK3L,SAAL,CAAeuE,iBAAf,CAAiCoH,MAApI,GAA6I,KAAK3L,SAAL,CAAeqN,kBAAf,CAAkC1B,MAAlC,GAA2C,KAAK3L,SAAL,CAAeqN,kBAAf,CAAkC1B,MAA7E,GAAsF,OAA5O;UACAR,mBAAmB,GAAG,KAAKnL,SAAL,CAAeuE,iBAAf,CAAiC4G,mBAAjC,GAAuD,KAAKnL,SAAL,CAAeuE,iBAAf,CAAiC4G,mBAAxF,GAA8G,MAApI,CALJ,CAMI;;UACAnG,UAAU,GAAG,KAAKuO,kBAAL,CAAwBtP,IAAxB,EAA8B,KAAKgP,cAAnC,EAAmD,KAAKG,gBAAxD,EAA0EjO,MAA1E,EAAkFwG,MAAlF,EAA0FC,OAA1F,EAAmGC,YAAnG,EAAiH,EAAjH,EAAqH,KAArH,EAA4HI,IAA5H,EAAkItG,UAAlI,EAA8I0J,WAA9I,EAA2JC,UAA3J,EAAuKC,QAAvK,EAAiLtK,aAAjL,EAAgMkG,mBAAhM,CAAb;;UACA,IAAInG,UAAJ,EAAgB;YACZ;YACA,KAAKgJ,yBAAL,CAA+BhJ,UAAU,CAACG,MAA1C,EAAkDH,UAAU,CAACyG,OAA7D,EAAsEzG,UAAU,CAACuG,KAAjF,EAAwFpC,OAAxF,EAAiGF,MAAjG,EAAyGjE,UAAU,CAACsI,OAApH,EAA6H3H,UAA7H;UACH;;UACD;;QACJ,KAAK,eAAL;UACI,KAAK7E,eAAL,GAAuB,IAAvB;UACA8K,OAAO,GAAG,eAAV,CAFJ,CAGI;;UACAD,MAAM,GAAI,KAAK3L,SAAL,CAAe0E,qBAAf,CAAqCiH,MAArC,KAAgD,OAAhD,IAA2D,KAAK3L,SAAL,CAAe0E,qBAAf,CAAqCiH,MAAjG,GAA2G,KAAK3L,SAAL,CAAe0E,qBAAf,CAAqCiH,MAAhJ,GAAyJ,KAAK3L,SAAL,CAAeqN,kBAAf,CAAkC1B,MAAlC,GAA2C,KAAK3L,SAAL,CAAeqN,kBAAf,CAAkC1B,MAA7E,GAAsF,OAAxP;UACAR,mBAAmB,GAAG,KAAKnL,SAAL,CAAe0E,qBAAf,CAAqCyG,mBAArC,GAA2D,KAAKnL,SAAL,CAAe0E,qBAAf,CAAqCyG,mBAAhG,GAAsH,MAA5I,CALJ,CAMI;;UACAnG,UAAU,GAAG,KAAKuO,kBAAL,CAAwBtP,IAAxB,EAA8B,KAAKkP,kBAAnC,EAAuD,KAAKG,oBAA5D,EAAkFnO,MAAlF,EAA0FwG,MAA1F,EAAkGC,OAAlG,EAA2GC,YAA3G,EAAyH,EAAzH,EAA6H,KAA7H,EAAoII,IAApI,EAA0ItG,UAA1I,EAAsJ0J,WAAtJ,EAAmKC,UAAnK,EAA+KC,QAA/K,EAAyLtK,aAAzL,EAAwMkG,mBAAxM,CAAb;;UACA,IAAInG,UAAJ,EAAgB;YACZ;YACA,KAAKiJ,yBAAL,CAA+BjJ,UAAU,CAACG,MAA1C,EAAkDH,UAAU,CAACyG,OAA7D,EAAsEzG,UAAU,CAACuG,KAAjF,EAAwFpC,OAAxF,EAAiGF,MAAjG,EAAyGtD,UAAzG,EAAqHX,UAAU,CAACsI,OAAhI;UACH;;UACD;;QACJ,KAAK,WAAL;UACI,KAAKxM,eAAL,GAAuB,IAAvB;UACA8K,OAAO,GAAG,WAAV,CAFJ,CAGI;;UACAD,MAAM,GAAI,KAAK3L,SAAL,CAAeyE,iBAAf,CAAiCkH,MAAjC,KAA4C,OAA5C,IAAuD,KAAK3L,SAAL,CAAeyE,iBAAf,CAAiCkH,MAAzF,GAAmG,KAAK3L,SAAL,CAAeyE,iBAAf,CAAiCkH,MAApI,GAA6I,KAAK3L,SAAL,CAAeqN,kBAAf,CAAkC1B,MAAlC,GAA2C,KAAK3L,SAAL,CAAeqN,kBAAf,CAAkC1B,MAA7E,GAAsF,OAA5O;UACAR,mBAAmB,GAAG,KAAKnL,SAAL,CAAeyE,iBAAf,CAAiC0G,mBAAjC,GAAuD,KAAKnL,SAAL,CAAeyE,iBAAf,CAAiC0G,mBAAxF,GAA8G,MAApI,CALJ,CAMI;;UACAnG,UAAU,GAAG,KAAKuO,kBAAL,CAAwBtP,IAAxB,EAA8B,KAAKiP,cAAnC,EAAmD,KAAKG,gBAAxD,EAA0ElO,MAA1E,EAAkFwG,MAAlF,EAA0FC,OAA1F,EAAmGC,YAAnG,EAAiH,EAAjH,EAAqH,KAArH,EAA4HI,IAA5H,EAAkItG,UAAlI,EAA8I0J,WAA9I,EAA2JC,UAA3J,EAAuKC,QAAvK,EAAiLtK,aAAjL,EAAgMkG,mBAAhM,CAAb;;UACA,IAAInG,UAAJ,EAAgB;YACZ;YACA,KAAKkJ,yBAAL,CAA+BlJ,UAAU,CAACG,MAA1C,EAAkDH,UAAU,CAACyG,OAA7D,EAAsEzG,UAAU,CAACuG,KAAjF,EAAwFpC,OAAxF,EAAiGF,MAAjG,EAAyGtD,UAAzG,EAAqHX,UAAU,CAACsI,OAAhI;UACH;;UACD;MAvCR;;MAyCA,KAAKxM,eAAL,GAAuB,KAAvB;;MACA,IAAIkE,UAAJ,EAAgB;QACZ,KAAKnD,aAAL,CAAmB2Q,4BAAnB,CAAgD,IAAhD,EADY,CAEZ;;QACA,IAAI3E,QAAQ,GAAG;UAAEpC,OAAO,EAAEzG,UAAU,CAACyG,OAAtB;UAA+BF,KAAK,EAAEvG,UAAU,CAACuG,KAAjD;UAAwDI,MAAM,EAAE3G,UAAU,CAAC2G,MAA3E;UAAmFC,OAAO,EAAE5G,UAAU,CAAC4G,OAAvG;UAAgHC,YAAY,EAAE7G,UAAU,CAAC6G;QAAzI,CAAf;QACA,IAAIiE,KAAK,GAAG,KAAK9P,SAAL,CAAekE,gBAAf,CAAgCsP,gBAAhC,CAAiD,KAAKxT,SAAL,CAAekE,gBAAf,CAAgCsP,gBAAhC,CAAiD3N,MAAjD,GAA0D,CAA3G,EAA8GiK,KAA1H,CAJY,CAKZ;;QACA,IAAI,KAAKX,iBAAL,CAAuBlL,IAAvB,CAAJ,EAAkC;UAC9B,IAAI,KAAKhD,eAAT,EAA0B;YACtB;YACA,KAAKjB,SAAL,CAAe8N,iBAAf,CAAiCnI,UAAjC,EAA6CX,UAAU,CAACc,SAAxD,EAAmE7B,IAAnE,EAAyEe,UAAU,CAACG,MAApF,EAA4F0I,QAA5F,EAAsGwB,WAAtG,EAAmHC,UAAnH,EAA+HC,QAA/H,EAAyI,IAAzI,EAA+I,KAAKvO,mBAApJ;UACH;QACJ,CALD,MAMK;UACD;UACA,KAAKhB,SAAL,CAAe8N,iBAAf,CAAiCnI,UAAjC,EAA6CX,UAAU,CAACc,SAAxD,EAAmE7B,IAAnE,EAAyEe,UAAU,CAACG,MAApF,EAA4F0I,QAA5F,EAAsGwB,WAAtG,EAAmHC,UAAnH,EAA+HC,QAA/H;QACH;MACJ;;MACD,IAAI3P,OAAO,CAAC6T,QAAR,IAAoB,CAAC,KAAKzT,SAAL,CAAe0T,iBAApC,IAAyD,KAAK1T,SAAL,CAAe2T,aAAxE,IAAyF,KAAK3T,SAAL,CAAe4T,uBAA5G,EAAqI;QACjI,KAAK5T,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqDC,mBAArD,CAAyE9P,IAAzE;MACH;IACJ;EACJ,CAjFD,CAp7BkD,CAsgClD;;;EACAlE,oBAAoB,CAAC+B,SAArB,CAA+BkS,iBAA/B,GAAmD,UAAUhP,UAAV,EAAsB;IACrE,IAAIA,UAAU,CAAC6H,iBAAX,KAAiC,EAArC,EAAyC;MACrC,KAAKzH,kBAAL,CAAwBJ,UAAxB,EAAoC,IAApC;MACA,IAAI+J,UAAU,GAAG,KAAKC,cAAL,EAAjB;MACA3J,MAAM,CAACC,YAAP,GAAsBC,eAAtB;;MACA,IAAIwJ,UAAU,CAAC,CAAD,CAAV,IAAiBA,UAAU,CAAC,CAAD,CAAV,CAAc5J,MAAnC,EAA2C;QACvC,KAAKyN,uBAAL,CAA6B5N,UAA7B,EAAyC+J,UAAU,CAAC,CAAD,CAAnD;QACA/J,UAAU,CAAC6H,iBAAX,GAA+BkC,UAAU,CAAC,CAAD,CAAV,CAAcM,WAA7C;QACArK,UAAU,CAAC+H,oBAAX,GAAkCgC,UAAU,CAAC,CAAD,CAAV,CAAcO,UAAhD;QACAtK,UAAU,CAACgI,kBAAX,GAAgC+B,UAAU,CAAC,CAAD,CAAV,CAAcQ,QAA9C;MACH;IACJ;;IACD,OAAOvK,UAAP;EACH,CAbD,CAvgCkD,CAqhClD;;;EACAjF,oBAAoB,CAAC+B,SAArB,CAA+BkM,yBAA/B,GAA2D,UAAU7I,MAAV,EAAkBsG,OAAlB,EAA2BF,KAA3B,EAAkCpC,OAAlC,EAA2CF,MAA3C,EAAmDqE,OAAnD,EAA4D2B,SAA5D,EAAuE;IAC9H,IAAIgF,SAAS,GAAG,KAAKpS,aAAL,CAAmBqS,YAAnB,CAAgCjL,MAAhC,CAAhB;;IACA,KAAK,IAAIO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGrE,MAAM,CAACU,MAA3B,EAAmC2D,CAAC,EAApC,EAAwC;MACpC;MACA,IAAIhD,KAAK,GAAGrB,MAAM,CAACqE,CAAD,CAAlB;MACAL,OAAO,CAACgL,SAAR;MACA,IAAIhR,CAAC,GAAGqD,KAAK,CAAC2D,CAAN,GAAU3D,KAAK,CAAC2D,CAAhB,GAAoB3D,KAAK,CAAC1D,IAAlC;MACA,IAAIM,CAAC,GAAGoD,KAAK,CAAC4D,CAAN,GAAU5D,KAAK,CAAC4D,CAAhB,GAAoB5D,KAAK,CAAC3D,GAAlC;MACA,IAAI+B,KAAK,GAAG4B,KAAK,CAACG,KAAN,GAAcH,KAAK,CAACG,KAApB,GAA4BH,KAAK,CAAC5B,KAA9C;MACA,IAAIE,MAAM,GAAG0B,KAAK,CAACI,MAAN,GAAeJ,KAAK,CAACI,MAArB,GAA8BJ,KAAK,CAAC1B,MAAjD;MACA3B,CAAC,GAAGA,CAAC,GAAGA,CAAH,GAAOqD,KAAK,CAACrD,CAAlB;MACAC,CAAC,GAAGA,CAAC,GAAGA,CAAH,GAAOoD,KAAK,CAACpD,CAAlB,CAToC,CAUpC;;MACA0B,MAAM,GAAGA,MAAM,GAAG,CAAlB;;MACA,IAAIqE,OAAO,CAACJ,MAAR,CAAe9G,EAAf,KAAsB,KAAKjC,SAAL,CAAekC,OAAf,CAAuBD,EAAvB,GAA4B,0BAA5B,GAAyDgN,SAAnF,EAA8F;QAC1F,IAAI3B,OAAJ,EAAa;UACT;UACAnE,OAAO,CAAC8C,IAAR,CAAc9I,CAAC,GAAG8Q,SAAlB,EAA+B7Q,CAAC,GAAG6Q,SAAnC,EAAgDrP,KAAK,GAAGqP,SAAxD,EAAqEnP,MAAM,GAAGmP,SAA9E;UACA9K,OAAO,CAACiL,WAAR,GAAsB3I,OAAO,GAAG,GAAhC;UACAtC,OAAO,CAACkL,SAAR;UACAlL,OAAO,CAACmL,SAAR,GAAoB/I,KAApB;UACApC,OAAO,CAACoL,UAAR,GAAqB,SAArB;UACApL,OAAO,CAACqL,IAAR;QACH;MACJ,CAVD,MAWK;QACD;QACArL,OAAO,CAAC8C,IAAR,CAAc9I,CAAC,GAAG8Q,SAAlB,EAA+B7Q,CAAC,GAAG6Q,SAAnC,EAAgDrP,KAAK,GAAGqP,SAAxD,EAAqEnP,MAAM,GAAGmP,SAA9E;QACA9K,OAAO,CAACiL,WAAR,GAAsB3I,OAAO,GAAG,GAAhC;QACAtC,OAAO,CAACkL,SAAR;QACAlL,OAAO,CAACmL,SAAR,GAAoB/I,KAApB;QACApC,OAAO,CAACoL,UAAR,GAAqB,SAArB;QACApL,OAAO,CAACqL,IAAR;MACH;IACJ;;IACDrL,OAAO,CAACsL,IAAR;EACH,CApCD,CAthCkD,CA2jClD;;;EACA1U,oBAAoB,CAAC+B,SAArB,CAA+BmM,yBAA/B,GAA2D,UAAU9I,MAAV,EAAkBsG,OAAlB,EAA2BF,KAA3B,EAAkCpC,OAAlC,EAA2CF,MAA3C,EAAmDtD,UAAnD,EAA+D2H,OAA/D,EAAwE;IAC/H,KAAK,IAAI9D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGrE,MAAM,CAACU,MAA3B,EAAmC2D,CAAC,EAApC,EAAwC;MACpC;MACA,IAAIhD,KAAK,GAAG,KAAKkO,eAAL,CAAqBvP,MAAM,CAACqE,CAAD,CAA3B,CAAZ;MACA,IAAImL,WAAW,GAAG,KAAK9S,aAAL,CAAmBqG,QAAnB,CAA4BvC,UAA5B,CAAlB;MACA,IAAIiP,WAAW,GAAG,KAAK/S,aAAL,CAAmBqS,YAAnB,CAAgCjL,MAAhC,CAAlB;;MACA,IAAIE,OAAO,CAACJ,MAAR,CAAe9G,EAAf,KAAsB,KAAKjC,SAAL,CAAekC,OAAf,CAAuBD,EAAvB,GAA4B,0BAA5B,GAAyD0D,UAAnF,EAA+F;QAC3F,IAAI2H,OAAJ,EAAa;UACT,IAAIqH,WAAW,CAACE,QAAZ,KAAyB,CAA7B,EAAgC;YAC5B;YACA,KAAKC,QAAL,CAAcrJ,OAAd,EAAwBjF,KAAK,CAACrD,CAAN,GAAWqD,KAAK,CAAC5B,KAAN,GAAc,CAAjD,EAAsD4B,KAAK,CAACpD,CAA5D,EAA+DoD,KAAK,CAAC5B,KAArE,EAA4E4B,KAAK,CAAC1B,MAAlF,EAA0FyG,KAA1F,EAAiGqJ,WAAjG,EAA8GzL,OAA9G,EAAuHxD,UAAvH;UACH,CAHD,MAIK,IAAIgP,WAAW,CAACE,QAAZ,KAAyB,CAA7B,EAAgC;YACjC;YACA,KAAKC,QAAL,CAAcrJ,OAAd,EAAuBjF,KAAK,CAACrD,CAA7B,EAAiCqD,KAAK,CAACpD,CAAN,GAAWoD,KAAK,CAAC1B,MAAN,GAAe,CAA3D,EAAgE0B,KAAK,CAAC5B,KAAtE,EAA6E4B,KAAK,CAAC1B,MAAnF,EAA2FyG,KAA3F,EAAkGqJ,WAAlG,EAA+GzL,OAA/G,EAAwHxD,UAAxH;UACH,CAHI,MAIA,IAAIgP,WAAW,CAACE,QAAZ,KAAyB,CAA7B,EAAgC;YACjC,KAAKC,QAAL,CAAcrJ,OAAd,EAAuBjF,KAAK,CAACrD,CAA7B,EAAgCqD,KAAK,CAACpD,CAAtC,EAA0CoD,KAAK,CAAC5B,KAAN,GAAc,CAAxD,EAA4D4B,KAAK,CAAC1B,MAAlE,EAA0EyG,KAA1E,EAAiFqJ,WAAjF,EAA8FzL,OAA9F,EAAuGxD,UAAvG;UACH,CAFI,MAGA;YACD,KAAKmP,QAAL,CAAcrJ,OAAd,EAAuBjF,KAAK,CAACrD,CAA7B,EAAgCqD,KAAK,CAACpD,CAAtC,EAAyCoD,KAAK,CAAC5B,KAA/C,EAAuD4B,KAAK,CAAC1B,MAAN,GAAe,CAAtE,EAA0EyG,KAA1E,EAAiFqJ,WAAjF,EAA8FzL,OAA9F,EAAuGxD,UAAvG;UACH;QACJ;MACJ,CAjBD,MAkBK;QACD,IAAIgP,WAAW,CAACE,QAAZ,KAAyB,CAA7B,EAAgC;UAC5B;UACA,KAAKC,QAAL,CAAcrJ,OAAd,EAAwBjF,KAAK,CAACrD,CAAN,GAAWqD,KAAK,CAAC5B,KAAN,GAAc,CAAjD,EAAsD4B,KAAK,CAACpD,CAA5D,EAA+DoD,KAAK,CAAC5B,KAArE,EAA4E4B,KAAK,CAAC1B,MAAlF,EAA0FyG,KAA1F,EAAiGqJ,WAAjG,EAA8GzL,OAA9G,EAAuHxD,UAAvH;QACH,CAHD,MAIK,IAAIgP,WAAW,CAACE,QAAZ,KAAyB,CAA7B,EAAgC;UACjC;UACA,KAAKC,QAAL,CAAcrJ,OAAd,EAAuBjF,KAAK,CAACrD,CAA7B,EAAiCqD,KAAK,CAACpD,CAAN,GAAWoD,KAAK,CAAC1B,MAAN,GAAe,CAA3D,EAAgE0B,KAAK,CAAC5B,KAAtE,EAA6E4B,KAAK,CAAC1B,MAAnF,EAA2FyG,KAA3F,EAAkGqJ,WAAlG,EAA+GzL,OAA/G,EAAwHxD,UAAxH;QACH,CAHI,MAIA,IAAIgP,WAAW,CAACE,QAAZ,KAAyB,CAA7B,EAAgC;UACjC,KAAKC,QAAL,CAAcrJ,OAAd,EAAuBjF,KAAK,CAACrD,CAA7B,EAAgCqD,KAAK,CAACpD,CAAtC,EAA0CoD,KAAK,CAAC5B,KAAN,GAAc,CAAxD,EAA4D4B,KAAK,CAAC1B,MAAlE,EAA0EyG,KAA1E,EAAiFqJ,WAAjF,EAA8FzL,OAA9F,EAAuGxD,UAAvG;QACH,CAFI,MAGA;UACD,KAAKmP,QAAL,CAAcrJ,OAAd,EAAuBjF,KAAK,CAACrD,CAA7B,EAAgCqD,KAAK,CAACpD,CAAtC,EAAyCoD,KAAK,CAAC5B,KAA/C,EAAuD4B,KAAK,CAAC1B,MAAN,GAAe,CAAtE,EAA0EyG,KAA1E,EAAiFqJ,WAAjF,EAA8FzL,OAA9F,EAAuGxD,UAAvG;QACH;MACJ;IACJ;EACJ,CAzCD,CA5jCkD,CAsmClD;;;EACA5F,oBAAoB,CAAC+B,SAArB,CAA+BoM,yBAA/B,GAA2D,UAAU/I,MAAV,EAAkBsG,OAAlB,EAA2BF,KAA3B,EAAkCpC,OAAlC,EAA2CF,MAA3C,EAAmDtD,UAAnD,EAA+D2H,OAA/D,EAAwE;IAC/H,KAAK,IAAI9D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGrE,MAAM,CAACU,MAA3B,EAAmC2D,CAAC,EAApC,EAAwC;MACpC;MACA,IAAIuL,WAAW,GAAG,KAAKL,eAAL,CAAqBvP,MAAM,CAACqE,CAAD,CAA3B,CAAlB;MACA,IAAIoL,WAAW,GAAG,KAAK/S,aAAL,CAAmBqS,YAAnB,CAAgCjL,MAAhC,CAAlB;;MACA,IAAIE,OAAO,CAACJ,MAAR,CAAe9G,EAAf,KAAsB,KAAKjC,SAAL,CAAekC,OAAf,CAAuBD,EAAvB,GAA4B,0BAA5B,GAAyD0D,UAAnF,EAA+F;QAC3F,IAAI2H,OAAJ,EAAa;UACT;UACA,KAAKwH,QAAL,CAAcrJ,OAAd,EAAuBsJ,WAAW,CAAC5R,CAAnC,EAAsC4R,WAAW,CAAC3R,CAAlD,EAAqD2R,WAAW,CAACnQ,KAAjE,EAAwEmQ,WAAW,CAACjQ,MAApF,EAA4FyG,KAA5F,EAAmGqJ,WAAnG,EAAgHzL,OAAhH,EAAyHxD,UAAzH;QACH;MACJ,CALD,MAMK;QACD;QACA,KAAKmP,QAAL,CAAcrJ,OAAd,EAAuBsJ,WAAW,CAAC5R,CAAnC,EAAsC4R,WAAW,CAAC3R,CAAlD,EAAqD2R,WAAW,CAACnQ,KAAjE,EAAwEmQ,WAAW,CAACjQ,MAApF,EAA4FyG,KAA5F,EAAmGqJ,WAAnG,EAAgHzL,OAAhH,EAAyHxD,UAAzH;MACH;IACJ;EACJ,CAhBD,CAvmCkD,CAwnClD;;;EACA5F,oBAAoB,CAAC+B,SAArB,CAA+B4S,eAA/B,GAAiD,UAAUlO,KAAV,EAAiB;IAC9D,IAAIrD,CAAC,GAAGqD,KAAK,CAAC2D,CAAN,GAAU3D,KAAK,CAAC2D,CAAhB,GAAoB3D,KAAK,CAAC1D,IAAlC;IACA,IAAIM,CAAC,GAAGoD,KAAK,CAAC4D,CAAN,GAAU5D,KAAK,CAAC4D,CAAhB,GAAoB5D,KAAK,CAAC3D,GAAlC;IACA,IAAI+B,KAAK,GAAG4B,KAAK,CAACG,KAAN,GAAcH,KAAK,CAACG,KAApB,GAA4BH,KAAK,CAAC5B,KAA9C;IACA,IAAIE,MAAM,GAAG0B,KAAK,CAACI,MAAN,GAAeJ,KAAK,CAACI,MAArB,GAA8BJ,KAAK,CAAC1B,MAAjD;IACA3B,CAAC,GAAGA,CAAC,GAAGA,CAAH,GAAOqD,KAAK,CAACrD,CAAlB;IACAC,CAAC,GAAGA,CAAC,GAAGA,CAAH,GAAOoD,KAAK,CAACpD,CAAlB;IACA,OAAO;MAAED,CAAC,EAAEA,CAAL;MAAQC,CAAC,EAAEA,CAAX;MAAcwB,KAAK,EAAEA,KAArB;MAA4BE,MAAM,EAAEA;IAApC,CAAP;EACH,CARD,CAznCkD,CAkoClD;;;EACA/E,oBAAoB,CAAC+B,SAArB,CAA+BgT,QAA/B,GAA0C,UAAUrJ,OAAV,EAAmBtI,CAAnB,EAAsBC,CAAtB,EAAyBwB,KAAzB,EAAgCE,MAAhC,EAAwCyG,KAAxC,EAA+CtC,MAA/C,EAAuDE,OAAvD,EAAgExD,UAAhE,EAA4E;IAClHwD,OAAO,CAACiL,WAAR,GAAsB3I,OAAtB;;IACA,IAAI3L,QAAQ,EAAZ,EAAgB;MACZsD,CAAC,GAAGA,CAAC,GAAG,CAAR;IACH;;IACD0B,MAAM,GAAGA,MAAM,GAAG,CAAlB;IACAqE,OAAO,CAACgL,SAAR;IACA,IAAIQ,WAAW,GAAG,KAAK9S,aAAL,CAAmBqG,QAAnB,CAA4BvC,UAA5B,CAAlB;;IACA,IAAIgP,WAAW,CAACE,QAAZ,KAAyB,CAA7B,EAAgC;MAC5B1L,OAAO,CAAC6L,MAAR,CAAgB7R,CAAC,GAAG8F,MAApB,EAA8B7F,CAAC,GAAG6F,MAAlC;MACAE,OAAO,CAAC8L,MAAR,CAAgB9R,CAAC,GAAG8F,MAApB,EAA6B,CAAC7F,CAAC,GAAG0B,MAAL,IAAemE,MAA5C;IACH,CAHD,MAIK,IAAI0L,WAAW,CAACE,QAAZ,KAAyB,CAA7B,EAAgC;MACjC1L,OAAO,CAAC6L,MAAR,CAAgB7R,CAAC,GAAG8F,MAApB,EAA8B7F,CAAC,GAAG6F,MAAlC;MACAE,OAAO,CAAC8L,MAAR,CAAe,CAACrQ,KAAK,GAAGzB,CAAT,IAAc8F,MAA7B,EAAsC7F,CAAC,GAAG6F,MAA1C;IACH,CAHI,MAIA,IAAI0L,WAAW,CAACE,QAAZ,KAAyB,CAA7B,EAAgC;MACjC1L,OAAO,CAAC6L,MAAR,CAAe,CAACpQ,KAAK,GAAGzB,CAAT,IAAc8F,MAA7B,EAAsC7F,CAAC,GAAG6F,MAA1C;MACAE,OAAO,CAAC8L,MAAR,CAAe,CAACrQ,KAAK,GAAGzB,CAAT,IAAc8F,MAA7B,EAAqC,CAAC7F,CAAC,GAAG0B,MAAL,IAAemE,MAApD;IACH,CAHI,MAIA;MACDE,OAAO,CAAC6L,MAAR,CAAgB7R,CAAC,GAAG8F,MAApB,EAA6B,CAAC7F,CAAC,GAAG0B,MAAL,IAAemE,MAA5C;MACAE,OAAO,CAAC8L,MAAR,CAAe,CAACrQ,KAAK,GAAGzB,CAAT,IAAc8F,MAA7B,EAAqC,CAAC7F,CAAC,GAAG0B,MAAL,IAAemE,MAApD;IACH;;IACDE,OAAO,CAAC+L,SAAR,GAAoB,CAApB;IACA/L,OAAO,CAACgM,WAAR,GAAsB5J,KAAtB;IACApC,OAAO,CAACkL,SAAR;IACAlL,OAAO,CAACoL,UAAR,GAAqB,SAArB;IACApL,OAAO,CAACiM,MAAR;EACH,CA7BD;EA8BA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI;;;EACArV,oBAAoB,CAAC+B,SAArB,CAA+BuT,0BAA/B,GAA4D,UAAUxM,qBAAV,EAAiCoG,SAAjC,EAA4CqG,SAA5C,EAAuDC,SAAvD,EAAkEC,gBAAlE,EAAoFC,UAApF,EAAgG;IACxJ,IAAI1M,MAAM,GAAGpJ,aAAa,CAAC,QAAD,EAAW;MAAEsC,EAAE,EAAE,KAAKjC,SAAL,CAAekC,OAAf,CAAuBD,EAAvB,GAA4B,0BAA5B,GAAyDgN;IAA/D,CAAX,CAA1B;IACAlG,MAAM,CAAC3G,KAAP,CAAawC,KAAb,GAAqB,MAAM,IAA3B;IACAmE,MAAM,CAAC3G,KAAP,CAAa0C,MAAb,GAAsB,OAAO,IAA7B;IACA,IAAI4Q,SAAS,GAAG,KAAK7T,aAAL,CAAmBqG,QAAnB,CAA4B+G,SAA5B,EAAuCrK,KAAvD;IACA,IAAI+Q,UAAU,GAAG,KAAK9T,aAAL,CAAmBqG,QAAnB,CAA4B+G,SAA5B,EAAuCnK,MAAxD;IACA,IAAI8Q,IAAI,GAAG,KAAK/T,aAAL,CAAmBgD,aAAnB,EAAX;IACA,IAAIoP,SAAS,GAAG,KAAKpS,aAAL,CAAmBqS,YAAnB,CAAgC0B,IAAhC,CAAhB;IACA7M,MAAM,CAACjE,MAAP,GAAgB6Q,UAAU,GAAG1B,SAA7B;IACAlL,MAAM,CAACnE,KAAP,GAAe8Q,SAAS,GAAGzB,SAA3B,CATwJ,CAUxJ;;IACA,IAAI4B,qBAAqB,GAAG,KAAKnQ,cAAL,CAAoBuJ,SAApB,EAA+B,IAA/B,EAAqC,yBAArC,CAA5B,CAXwJ,CAYxJ;;IACA,IAAI6G,eAAe,GAAG,KAAKpQ,cAAL,CAAoBuJ,SAApB,EAA+B,IAA/B,EAAqC,oBAArC,CAAtB,CAbwJ,CAcxJ;;IACA,IAAI8G,sBAAsB,GAAG,KAAKrQ,cAAL,CAAoBuJ,SAApB,EAA+B,IAA/B,EAAqC,4BAArC,CAA7B,CAfwJ,CAgBxJ;;IACA,IAAI+G,eAAe,GAAG,KAAKtQ,cAAL,CAAoBuJ,SAApB,EAA+B,IAA/B,EAAqC,oBAArC,CAAtB,CAjBwJ,CAkBxJ;;IACA,IAAIgH,oBAAoB,GAAG,KAAKvQ,cAAL,CAAoBuJ,SAApB,EAA+B,IAA/B,EAAqC,qBAArC,CAA3B;;IACA,IAAI+G,eAAe,IAAIF,eAAnB,IAAsCG,oBAAtC,IAA8DF,sBAAlE,EAA0F;MACtF,KAAK/V,SAAL,CAAekW,aAAf,CAA6BnN,MAA7B,EAAqCkG,SAArC;IACH,CAFD,MAGK;MACD,KAAKjP,SAAL,CAAegF,UAAf,CAA0BsM,iBAA1B,CAA4CrC,SAA5C,EAAuDsG,SAAvD,EAAkEC,gBAAlE,EAAoF,IAApF,EAA0FzM,MAA1F;MACA,KAAK/I,SAAL,CAAegF,UAAf,CAA0BmR,qBAA1B,CAAgDC,sBAAhD,CAAuEd,SAAvE,EAAkFrG,SAAlF,EAA6FlG,MAA7F;MACA,KAAK/I,SAAL,CAAegF,UAAf,CAA0B0L,2BAA1B,CAAsD2F,4BAAtD,CAAmFZ,UAAnF,EAA+FxG,SAA/F,EAA0GlG,MAA1G;IACH;;IACD,IAAIuN,UAAU,GAAG,KAAKzU,aAAL,CAAmBgD,aAAnB,EAAjB;;IACA,IAAIgR,qBAAJ,EAA2B;MACvB,KAAK7M,2BAAL,CAAiC,IAAjC,EAAuCiG,SAAvC,EAAkDlG,MAAlD,EAA0DuN,UAA1D;IACH,CAFD,MAGK;MACD,KAAKtN,2BAAL,CAAiCH,qBAAjC,EAAwDoG,SAAxD,EAAmElG,MAAnE,EAA2EuN,UAA3E;IACH;;IACD,IAAIC,WAAW,GAAGxN,MAAM,CAACyN,SAAP,EAAlB;IACA,OAAOD,WAAP;EACH,CArCD;EAsCA;AACJ;AACA;;;EACIxW,oBAAoB,CAAC+B,SAArB,CAA+B2U,yBAA/B,GAA2D,YAAY;IACnE;IACA,IAAIC,qBAAqB,GAAGrR,MAAM,CAACsR,cAAP,CAAsBC,OAAtB,CAA8B,KAAK/U,aAAL,CAAmBgV,UAAnB,GAAgC,yBAA9D,CAA5B;;IACA,IAAI,KAAKhV,aAAL,CAAmBiV,eAAvB,EAAwC;MACpCJ,qBAAqB,GAAG,KAAK7U,aAAL,CAAmBkV,iBAAnB,CAAqC,KAAKlV,aAAL,CAAmBgV,UAAnB,GAAgC,yBAArE,CAAxB;IACH,CALkE,CAMnE;;;IACA,IAAIhO,qBAAqB,GAAG,IAAImO,KAAJ,EAA5B;;IACA,KAAK,IAAI5Q,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKvE,aAAL,CAAmBoV,SAAvC,EAAkD7Q,CAAC,EAAnD,EAAuD;MACnDyC,qBAAqB,CAACzC,CAAD,CAArB,GAA2B,EAA3B;IACH;;IACD,IAAIsQ,qBAAqB,IAAI,CAAC,KAAK1W,SAAL,CAAeqN,kBAAf,CAAkC6J,YAAhE,EAA8E;MAC1E,IAAIC,8BAA8B,GAAG7E,IAAI,CAAC8E,KAAL,CAAWV,qBAAX,CAArC;;MACA,KAAK,IAAIlN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2N,8BAA8B,CAACtR,MAAnD,EAA2D2D,CAAC,EAA5D,EAAgE;QAC5D,IAAIK,QAAQ,GAAG,EAAf;QACA,IAAIwN,oBAAoB,GAAGF,8BAA8B,CAAC3N,CAAD,CAAzD;;QACA,IAAI6N,oBAAJ,EAA0B;UACtB,KAAK,IAAIzR,CAAC,GAAG,CAAb,EAAgByR,oBAAoB,CAAC9N,WAArB,CAAiC1D,MAAjC,GAA0CD,CAA1D,EAA6DA,CAAC,EAA9D,EAAkE;YAC9D,KAAK5F,SAAL,CAAekE,gBAAf,CAAgCoT,kBAAhC,CAAmDD,oBAAoB,CAAC9N,WAArB,CAAiC3D,CAAjC,CAAnD;;YACA,IAAI,KAAK/D,aAAL,CAAmB0V,cAAvB,EAAuC;cACnC,IAAIF,oBAAoB,CAAC9N,WAArB,CAAiC3D,CAAjC,EAAoC8D,mBAAxC,EAA6D;gBACzD2N,oBAAoB,CAAC9N,WAArB,CAAiC3D,CAAjC,EAAoCT,MAApC,GAA6C,KAAKqS,gBAAL,CAAsBH,oBAAoB,CAAC9N,WAArB,CAAiC3D,CAAjC,EAAoCT,MAA1D,EAAkEqE,CAAlE,CAA7C;cACH,CAFD,MAGK;gBACD,IAAImL,WAAW,GAAG,KAAK9S,aAAL,CAAmBqG,QAAnB,CAA4BmP,oBAAoB,CAACpI,SAAjD,CAAlB;;gBACA,IAAI0F,WAAJ,EAAiB;kBACb0C,oBAAoB,CAAC9N,WAArB,CAAiC3D,CAAjC,EAAoC6R,kBAApC,GAAyD9C,WAAW,CAACE,QAArE;gBACH;cACJ;YACJ,CAZ6D,CAa9D;;;YACAwC,oBAAoB,CAAC9N,WAArB,CAAiC3D,CAAjC,EAAoCT,MAApC,GAA6CmN,IAAI,CAACC,SAAL,CAAe,KAAKiF,gBAAL,CAAsBH,oBAAoB,CAAC9N,WAArB,CAAiC3D,CAAjC,EAAoCT,MAA1D,EAAkEqE,CAAlE,CAAf,CAA7C;YACA,IAAIkO,WAAW,GAAGL,oBAAoB,CAAC9N,WAArB,CAAiC3D,CAAjC,EAAoC2F,KAAtD;YACA8L,oBAAoB,CAAC9N,WAArB,CAAiC3D,CAAjC,EAAoC2F,KAApC,GAA4C+G,IAAI,CAACC,SAAL,CAAe,KAAKoF,UAAL,CAAgBD,WAAhB,CAAf,CAA5C;YACAL,oBAAoB,CAAC9N,WAArB,CAAiC3D,CAAjC,EAAoCqG,IAApC,GAA2CqG,IAAI,CAACC,SAAL,CAAe8E,oBAAoB,CAAC9N,WAArB,CAAiC3D,CAAjC,EAAoCqG,IAAnD,CAA3C;UACH;;UACDpC,QAAQ,GAAGwN,oBAAoB,CAAC9N,WAAhC;QACH;;QACDV,qBAAqB,CAACwO,oBAAoB,CAACpI,SAAtB,CAArB,GAAwDpF,QAAxD;MACH;IACJ;;IACD,OAAOyI,IAAI,CAACC,SAAL,CAAe1J,qBAAf,CAAP;EACH,CA1CD;EA2CA;AACJ;AACA;;;EACI9I,oBAAoB,CAAC+B,SAArB,CAA+B8V,0BAA/B,GAA4D,YAAY;IACpE,IAAI,KAAKvX,2BAAT,EAAsC;MAClC,IAAIyK,MAAM,GAAG,KAAb;;MACA,IAAI,KAAKzK,2BAAL,CAAiCgN,kBAArC,EAAyD;QACrD;QACAvC,MAAM,GAAG,KAAKzK,2BAAL,CAAiCgN,kBAAjC,CAAoDvC,MAA7D;;QACA,IAAI,KAAK9K,SAAL,CAAekE,gBAAf,CAAgC2T,wBAAhC,CAAyD,QAAzD,EAAmE,KAAKxX,2BAAxE,CAAJ,EAA0G;UACtGyK,MAAM,GAAG,KAAT;QACH;MACJ;;MACD,IAAI,CAACA,MAAL,EAAa;QACT,IAAIyF,iBAAiB,GAAG,IAAxB;QACA,KAAKxM,kBAAL,CAAwB,IAAxB,EAFS,CAGT;;QACA,IAAIiB,UAAU,GAAG,KAAK3E,2BAAtB;;QACA,IAAI,KAAKA,2BAAL,CAAiC4E,aAAjC,IAAkDD,UAAU,CAACqB,mBAAjE,EAAsF;UAClF,KAAKiK,wBAAL,CAA8BtL,UAA9B;QACH;;QACD,IAAIqN,eAAe,GAAG,KAAK3M,cAAL,CAAoB,KAAKtF,2BAAzB,EAAsD,IAAtD,CAAtB;;QACA,IAAIiS,eAAJ,EAAqB;UACjB,KAAK,IAAI7I,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6I,eAAe,CAACxM,MAApC,EAA4C2D,CAAC,EAA7C,EAAiD;YAC7C,IAAI,KAAKnJ,2BAAL,CAAiCyF,SAAjC,KAA+CuM,eAAe,CAAC7I,CAAD,CAAf,CAAmB1D,SAAtE,EAAiF;cAC7EyK,iBAAiB,GAAG8B,eAAe,CAAC7B,MAAhB,CAAuBhH,CAAvB,EAA0B,CAA1B,EAA6B,CAA7B,CAApB,CAD6E,CAE7E;;cACA,KAAKxJ,SAAL,CAAekE,gBAAf,CAAgCuM,SAAhC,CAA0C,KAAKrQ,2BAA/C,EAA4EoJ,CAA5E,EAA+E+G,iBAA/E,EAAkG,qBAAlG,EAAyH,IAAzH;cACA,KAAKhQ,sBAAL,GAA8BiJ,CAA9B;cACA,KAAKxJ,SAAL,CAAegF,UAAf,CAA0B0L,2BAA1B,CAAsDC,YAAtD,CAAmEJ,iBAAnE,EAAsF,YAAtF;cACA,IAAIK,SAAS,GAAGtI,QAAQ,CAACC,cAAT,CAAwBgI,iBAAiB,CAACzK,SAA1C,CAAhB;;cACA,IAAI8K,SAAJ,EAAe;gBACX,IAAIA,SAAS,CAACC,aAAV,CAAwBC,iBAAxB,KAA8C,CAAlD,EAAqD;kBACjD,KAAK9Q,SAAL,CAAekE,gBAAf,CAAgCwM,2BAAhC,CAA4DK,wBAA5D,CAAqFH,SAArF;gBACH,CAFD,MAGK;kBACDA,SAAS,CAACI,MAAV;gBACH;cACJ;YACJ;UACJ;;UACD,KAAKhR,SAAL,CAAekE,gBAAf,CAAgC+M,0BAAhC,CAA2D,KAAK5Q,2BAAhE;UACA,KAAK6Q,iBAAL,CAAuBmB,eAAvB,EAAwC,KAAKjS,2BAA7C,EApBiB,CAqBjB;;UACA,KAAKJ,SAAL,CAAekE,gBAAf,CAAgCiN,gCAAhC,CAAiE,KAAK9Q,2BAAtE,EAAmG,KAAKA,2BAAL,CAAiCsF,UAApI,EAAgJ,sBAAhJ;UACA,IAAIyL,YAAY,GAAG,KAAK/Q,2BAAL,CAAiCyF,SAApD,CAvBiB,CAwBjB;;UACA,IAAIuL,gBAAgB,GAAG,KAAKhR,2BAAL,CAAiC8E,MAAxD;UACA,KAAK9E,2BAAL,GAAmC,IAAnC;UACA,KAAKL,SAAL,CAAekE,gBAAf,CAAgCoN,iBAAhC,CAAkD,KAAKlR,2BAAvD,EAAoF,IAApF,EAA0F,IAA1F,EAAgG,IAAhG;UACA,KAAKyB,aAAL,CAAmB2Q,4BAAnB,CAAgD,IAAhD,EA5BiB,CA6BjB;;UACA,IAAIxR,mBAAmB,GAAG,KAAKyR,uBAAL,CAA6BzN,UAA7B,CAA1B;;UACA,IAAIhE,mBAAmB,CAAC6E,MAApB,GAA6B,CAAjC,EAAoC;YAChC7E,mBAAmB,CAACqJ,IAApB,CAAyBkG,iBAAzB,EADgC,CAEhC;;YACA,KAAKvQ,SAAL,CAAe8X,oBAAf,CAAoC,KAAK1X,2BAAzC,EAAsEgR,YAAtE,EAAoFb,iBAAiB,CAACjF,wBAAtG,EAAgI+F,gBAAhI,EAAkJd,iBAAiB,CAAC1D,iBAApK,EAAuL0D,iBAAiB,CAACxD,oBAAzM,EAA+NwD,iBAAiB,CAACvD,kBAAjP,EAAqQhM,mBAArQ;UACH,CAJD,MAKK;YACD;YACA,KAAKhB,SAAL,CAAe8X,oBAAf,CAAoC,KAAK1X,2BAAzC,EAAsEgR,YAAtE,EAAoFb,iBAAiB,CAACjF,wBAAtG,EAAgI+F,gBAAhI,EAAkJd,iBAAiB,CAAC1D,iBAApK,EAAuL0D,iBAAiB,CAACxD,oBAAzM,EAA+NwD,iBAAiB,CAACvD,kBAAjP;UACH;;UACD,KAAKzM,sBAAL,GAA8B,IAA9B;UACA,KAAKH,2BAAL,GAAmC,IAAnC;;UACA,IAAIR,OAAO,CAAC6T,QAAR,IAAoB,CAAC,KAAKzT,SAAL,CAAe0T,iBAAxC,EAA2D;YACvD;YACA,KAAK1T,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqDiE,2BAArD;YACA,KAAK/X,SAAL,CAAe6T,aAAf,CAA6BmE,WAA7B,CAAyC,IAAzC;UACH;QACJ;MACJ;IACJ;EACJ,CArED;EAsEA;AACJ;AACA;AACA;;;EACIjY,oBAAoB,CAAC+B,SAArB,CAA+BmW,mBAA/B,GAAqD,UAAU1M,KAAV,EAAiB;IAClE,IAAI,KAAKlL,2BAAT,EAAsC;MAClC,IAAIgS,eAAe,GAAG,KAAK6F,wBAAL,CAA8B,OAA9B,EAAuC3M,KAAvC,EAA8C,IAA9C,CAAtB;MACA,KAAK2F,iBAAL,CAAuBmB,eAAvB,EAAwC,KAAKjS,2BAA7C;MACA,KAAKJ,SAAL,CAAekE,gBAAf,CAAgCoN,iBAAhC,CAAkD,KAAKlR,2BAAvD,EAAoF,IAApF,EAA0F,IAA1F,EAAgG,IAAhG;MACA,KAAKyB,aAAL,CAAmB2Q,4BAAnB,CAAgD,IAAhD,EAJkC,CAKlC;;MACA,IAAIxN,UAAU,GAAG,KAAK3E,2BAAtB,CANkC,CAOlC;;MACA,IAAIW,mBAAmB,GAAG,KAAKyR,uBAAL,CAA6BzN,UAA7B,CAA1B;;MACA,IAAIhE,mBAAmB,CAAC6E,MAApB,GAA6B,CAAjC,EAAoC;QAChC;QACA,KAAK7F,SAAL,CAAemY,8BAAf,CAA8C,KAAK/X,2BAAnD,EAAgF4E,UAAU,CAACc,SAA3F,EAAsGd,UAAU,CAACsG,wBAAjH,EAA2I,IAA3I,EAAiJ,KAAjJ,EAAwJ,KAAxJ,EAA+J,KAA/J,EAAsKtG,UAAU,CAAC6H,iBAAjL,EAAoM7H,UAAU,CAAC+H,oBAA/M,EAAqO/H,UAAU,CAACgI,kBAAhP,EAAoQhM,mBAApQ;QACA,KAAKT,sBAAL,GAA8B,IAA9B;MACH,CAJD,MAKK;QACD;QACA,KAAKP,SAAL,CAAemY,8BAAf,CAA8C,KAAK/X,2BAAnD,EAAgF4E,UAAU,CAACc,SAA3F,EAAsGd,UAAU,CAACsG,wBAAjH,EAA2I,IAA3I,EAAiJ,KAAjJ,EAAwJ,KAAxJ,EAA+J,KAA/J,EAAsKtG,UAAU,CAAC6H,iBAAjL,EAAoM7H,UAAU,CAAC+H,oBAA/M,EAAqO/H,UAAU,CAACgI,kBAAhP;QACA,KAAKzM,sBAAL,GAA8B,IAA9B;MACH;IACJ;EACJ,CArBD;EAsBA;AACJ;AACA;AACA;AACA;;;EACIR,oBAAoB,CAAC+B,SAArB,CAA+BsW,qBAA/B,GAAuD,UAAUC,IAAV,EAAgBC,SAAhB,EAA2B;IAC9E,IAAI,KAAKjY,2BAAT,EAAsC;MAClC,IAAIgS,eAAe,GAAG,KAAK,CAA3B;;MACA,IAAIiG,SAAJ,EAAe;QACXjG,eAAe,GAAG,KAAK6F,wBAAL,CAA8B,SAA9B,EAAyCI,SAAzC,EAAoD,SAApD,CAAlB;MACH,CAFD,MAGK;QACDjG,eAAe,GAAG,KAAK6F,wBAAL,CAA8B,SAA9B,EAAyCG,IAAI,CAAC5G,KAAL,GAAa,GAAtD,EAA2D4G,IAAI,CAACE,IAAhE,CAAlB;MACH;;MACD,IAAIlG,eAAJ,EAAqB;QACjB,KAAKnB,iBAAL,CAAuBmB,eAAvB,EAAwC,KAAKjS,2BAA7C;QACA,KAAKJ,SAAL,CAAekE,gBAAf,CAAgCoN,iBAAhC,CAAkD,KAAKlR,2BAAvD,EAAoF,IAApF,EAA0F,IAA1F,EAAgG,IAAhG;;QACA,IAAIkY,SAAS,IAAID,IAAI,CAACE,IAAL,KAAc,SAA/B,EAA0C;UACtC,KAAK1W,aAAL,CAAmB2Q,4BAAnB,CAAgD,IAAhD,EADsC,CAEtC;;UACA,IAAIxN,UAAU,GAAG,KAAK3E,2BAAtB,CAHsC,CAItC;;UACA,IAAIW,mBAAmB,GAAG,KAAKyR,uBAAL,CAA6BzN,UAA7B,CAA1B;;UACA,IAAIhE,mBAAmB,CAAC6E,MAApB,GAA6B,CAAjC,EAAoC;YAChC;YACA,KAAK7F,SAAL,CAAemY,8BAAf,CAA8C,KAAK/X,2BAAnD,EAAgF4E,UAAU,CAACc,SAA3F,EAAsGd,UAAU,CAACsG,wBAAjH,EAA2I,KAA3I,EAAkJ,IAAlJ,EAAwJ,KAAxJ,EAA+J,KAA/J,EAAsKtG,UAAU,CAAC6H,iBAAjL,EAAoM7H,UAAU,CAAC+H,oBAA/M,EAAqO/H,UAAU,CAACgI,kBAAhP,EAAoQhM,mBAApQ;YACA,KAAKT,sBAAL,GAA8B,IAA9B;UACH,CAJD,MAKK;YACD;YACA,KAAKP,SAAL,CAAemY,8BAAf,CAA8C,KAAK/X,2BAAnD,EAAgF4E,UAAU,CAACc,SAA3F,EAAsGd,UAAU,CAACsG,wBAAjH,EAA2I,KAA3I,EAAkJ,IAAlJ,EAAwJ,KAAxJ,EAA+J,KAA/J,EAAsKtG,UAAU,CAAC6H,iBAAjL,EAAoM7H,UAAU,CAAC+H,oBAA/M,EAAqO/H,UAAU,CAACgI,kBAAhP;YACA,KAAKzM,sBAAL,GAA8B,IAA9B;UACH;QACJ;MACJ;IACJ;EACJ,CA/BD;EAgCA;AACJ;AACA;AACA;AACA;AACA;AACA;EACI;;;EACAR,oBAAoB,CAAC+B,SAArB,CAA+BoW,wBAA/B,GAA0D,UAAU1G,QAAV,EAAoBC,KAApB,EAA2BE,MAA3B,EAAmC7L,SAAnC,EAA8C;IACpG;IACA,IAAId,UAAU,GAAG,KAAK3E,2BAAtB;;IACA,IAAI2E,UAAU,CAACC,aAAX,IAA4BD,UAAU,CAACqB,mBAA3C,EAAgE;MAC5D,KAAKkL,0BAAL,CAAgCvM,UAAhC,EAA4CwM,QAA5C,EAAsDC,KAAtD;IACH;;IACD,IAAIY,eAAe,GAAG,KAAK3M,cAAL,CAAoB,KAAKtF,2BAAzB,EAAsD,IAAtD,CAAtB;;IACA,IAAIiS,eAAJ,EAAqB;MACjB,KAAK,IAAI7I,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6I,eAAe,CAACxM,MAApC,EAA4C2D,CAAC,EAA7C,EAAiD;QAC7C,IAAI8I,IAAI,CAACC,SAAL,CAAe,KAAKlS,2BAApB,MAAqDiS,IAAI,CAACC,SAAL,CAAeF,eAAe,CAAC7I,CAAD,CAA9B,CAAzD,EAA6F;UACzF,IAAIgI,QAAQ,KAAK,OAAjB,EAA0B;YACtBa,eAAe,CAAC7I,CAAD,CAAf,CAAmB+B,KAAnB,GAA2BkG,KAA3B;UACH,CAFD,MAGK,IAAID,QAAQ,KAAK,SAAjB,EAA4B;YAC7Ba,eAAe,CAAC7I,CAAD,CAAf,CAAmBiC,OAAnB,GAA6BgG,KAA7B;UACH,CAFI,MAGA,IAAID,QAAQ,KAAK,oBAAjB,EAAuC;YACxCa,eAAe,CAAC7I,CAAD,CAAf,CAAmB6D,kBAAnB,GAAwC;cAAEvC,MAAM,EAAE2G;YAAV,CAAxC;UACH;;UACDY,eAAe,CAAC7I,CAAD,CAAf,CAAmBqC,YAAnB,GAAkC,KAAK7L,SAAL,CAAegF,UAAf,CAA0B0L,2BAA1B,CAAsDgB,cAAtD,EAAlC;UACA,KAAKnR,sBAAL,GAA8BiJ,CAA9B;;UACA,IAAImI,MAAM,KAAK,IAAX,IAAmBA,MAAM,KAAK,SAAlC,EAA6C;YACzC;YACA,KAAK3R,SAAL,CAAekE,gBAAf,CAAgCuM,SAAhC,CAA0C,KAAKrQ,2BAA/C,EAA4EoJ,CAA5E,EAA+E,KAAKnJ,2BAApF,EAAiH,+BAAjH,EAAkJmR,QAAlJ;UACH;;UACD,KAAKnR,2BAAL,GAAmCgS,eAAe,CAAC7I,CAAD,CAAlD;UACA,KAAKxJ,SAAL,CAAekE,gBAAf,CAAgCwM,2BAAhC,CAA4DkB,4BAA5D,CAAyFS,eAAe,CAAC7I,CAAD,CAAxG;UACA,KAAKxJ,SAAL,CAAekE,gBAAf,CAAgC6O,0BAAhC,CAA2DV,eAAe,CAAC7I,CAAD,CAA1E,EAA+E,KAAKpJ,2BAApF;QACH;MACJ;IACJ;;IACD,OAAOiS,eAAP;EACH,CAhCD;EAiCA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACItS,oBAAoB,CAAC+B,SAArB,CAA+B0W,oBAA/B,GAAsD,UAAUxT,UAAV,EAAsBW,UAAtB,EAAkCmK,KAAlC,EAAyC2I,MAAzC,EAAiD;IACnG,IAAIpG,eAAe,GAAG,KAAK3M,cAAL,CAAoBC,UAApB,EAAgC,IAAhC,CAAtB;;IACA,IAAI0M,eAAJ,EAAqB;MACjB,IAAIoG,MAAM,KAAK,mBAAf,EAAoC;QAChC,KAAKzY,SAAL,CAAegF,UAAf,CAA0B0L,2BAA1B,CAAsDC,YAAtD,CAAmE0B,eAAe,CAACvC,KAAD,CAAlF,EAA2F,YAA3F,EADgC,CAEhC;;QACA,IAAIc,SAAS,GAAGtI,QAAQ,CAACC,cAAT,CAAwB8J,eAAe,CAACvC,KAAD,CAAf,CAAuBhK,SAA/C,CAAhB;;QACA,IAAI8K,SAAJ,EAAe;UACX,IAAIA,SAAS,CAACC,aAAV,CAAwBC,iBAAxB,KAA8C,CAAlD,EAAqD;YACjD,KAAK9Q,SAAL,CAAekE,gBAAf,CAAgCwM,2BAAhC,CAA4DK,wBAA5D,CAAqFH,SAArF;UACH,CAFD,MAGK;YACDA,SAAS,CAACC,aAAV,CAAwB6H,WAAxB,CAAoC9H,SAApC;UACH;QACJ;;QACDyB,eAAe,CAAC7B,MAAhB,CAAuBV,KAAvB,EAA8B,CAA9B;MACH,CAbD,MAcK,IAAI2I,MAAM,KAAK,qBAAf,EAAsC;QACvC;QACA,KAAKzY,SAAL,CAAekE,gBAAf,CAAgCwM,2BAAhC,CAA4DiI,qBAA5D,CAAkFhT,UAAlF,EAA8FX,UAAU,CAAC4H,mBAAzG;QACAyF,eAAe,CAAC7B,MAAhB,CAAuBV,KAAvB,EAA8B,CAA9B,EAAiC9K,UAAjC;MACH;IACJ;;IACD,KAAK4T,sBAAL;IACA,KAAK/W,aAAL,CAAmB2Q,4BAAnB,CAAgD,IAAhD;IACA,KAAKtB,iBAAL,CAAuBmB,eAAvB,EAAwC1M,UAAxC;IACA,KAAK3F,SAAL,CAAekE,gBAAf,CAAgCoN,iBAAhC,CAAkD3L,UAAlD,EAA8D,IAA9D,EAAoE,IAApE,EAA0E,IAA1E;EACH,CA3BD;EA4BA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI;;;EACA5F,oBAAoB,CAAC+B,SAArB,CAA+B+W,sBAA/B,GAAwD,UAAU7T,UAAV,EAAsBW,UAAtB,EAAkCmK,KAAlC,EAAyC0B,QAAzC,EAAmDsH,YAAnD,EAAiE;IACrH,IAAIzG,eAAe,GAAG,KAAK3M,cAAL,CAAoBC,UAApB,EAAgC,IAAhC,CAAtB;;IACA,IAAI0M,eAAJ,EAAqB;MACjB,IAAIb,QAAQ,KAAK,OAAjB,EAA0B;QACtB,IAAIuH,SAAS,GAAG1G,eAAe,CAACvC,KAAD,CAAf,CAAuBvE,KAAvC;QACA8G,eAAe,CAACvC,KAAD,CAAf,CAAuBvE,KAAvB,GAA+BvG,UAAU,CAACuG,KAA1C;QACAvG,UAAU,CAACuG,KAAX,GAAmBwN,SAAnB;MACH,CAJD,MAKK;QACD,IAAIC,WAAW,GAAG3G,eAAe,CAACvC,KAAD,CAAf,CAAuBrE,OAAzC;QACA4G,eAAe,CAACvC,KAAD,CAAf,CAAuBrE,OAAvB,GAAiCzG,UAAU,CAACyG,OAA5C;QACAzG,UAAU,CAACyG,OAAX,GAAqBuN,WAArB;MACH;;MACD,KAAKhZ,SAAL,CAAekE,gBAAf,CAAgCwM,2BAAhC,CAA4DkB,4BAA5D,CAAyF5M,UAAzF,EAAqG,IAArG,EAA2G,IAA3G;;MACA,IAAI8T,YAAJ,EAAkB;QACd9T,UAAU,CAAC6G,YAAX,GAA0B,KAAK7L,SAAL,CAAegF,UAAf,CAA0B0L,2BAA1B,CAAsDgB,cAAtD,EAA1B;MACH;IACJ;;IACD,KAAKkH,sBAAL;IACA,KAAK/W,aAAL,CAAmB2Q,4BAAnB,CAAgD,IAAhD;IACA,KAAKtB,iBAAL,CAAuBmB,eAAvB,EAAwC1M,UAAxC;IACA,KAAK3F,SAAL,CAAekE,gBAAf,CAAgCoN,iBAAhC,CAAkD3L,UAAlD,EAA8D,IAA9D,EAAoE,IAApE,EAA0E,IAA1E;IACA,OAAOX,UAAP;EACH,CAvBD;EAwBA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACIjF,oBAAoB,CAAC+B,SAArB,CAA+BmX,oBAA/B,GAAsD,UAAUjU,UAAV,EAAsBW,UAAtB,EAAkCmK,KAAlC,EAAyC2I,MAAzC,EAAiD;IACnG,IAAIpG,eAAe,GAAG,KAAK3M,cAAL,CAAoBC,UAApB,EAAgC,IAAhC,CAAtB;;IACA,IAAI0M,eAAJ,EAAqB;MACjB,IAAIoG,MAAM,KAAK,mBAAf,EAAoC;QAChC;QACA,KAAKzY,SAAL,CAAekE,gBAAf,CAAgCwM,2BAAhC,CAA4DiI,qBAA5D,CAAkFhT,UAAlF,EAA8FX,UAAU,CAAC4H,mBAAzG;QACAyF,eAAe,CAAChI,IAAhB,CAAqBrF,UAArB;MACH,CAJD,MAKK,IAAIyT,MAAM,KAAK,qBAAf,EAAsC;QACvC,KAAKzY,SAAL,CAAegF,UAAf,CAA0B0L,2BAA1B,CAAsDC,YAAtD,CAAmE0B,eAAe,CAACvC,KAAD,CAAlF,EAA2F,YAA3F,EADuC,CAEvC;;QACA,IAAIc,SAAS,GAAGtI,QAAQ,CAACC,cAAT,CAAwB8J,eAAe,CAACvC,KAAD,CAAf,CAAuBhK,SAA/C,CAAhB;;QACA,IAAI8K,SAAJ,EAAe;UACX,IAAIA,SAAS,CAACC,aAAV,CAAwBC,iBAAxB,KAA8C,CAAlD,EAAqD;YACjD,KAAK9Q,SAAL,CAAekE,gBAAf,CAAgCwM,2BAAhC,CAA4DK,wBAA5D,CAAqFH,SAArF;UACH,CAFD,MAGK;YACDA,SAAS,CAACI,MAAV;UACH;QACJ;;QACDqB,eAAe,CAAC7B,MAAhB,CAAuBV,KAAvB,EAA8B,CAA9B;MACH;IACJ;;IACD,KAAK8I,sBAAL;IACA,KAAK/W,aAAL,CAAmB2Q,4BAAnB,CAAgD,IAAhD;IACA,KAAKtB,iBAAL,CAAuBmB,eAAvB,EAAwC1M,UAAxC;IACA,KAAK3F,SAAL,CAAekE,gBAAf,CAAgCoN,iBAAhC,CAAkD3L,UAAlD,EAA8D,IAA9D,EAAoE,IAApE,EAA0E,IAA1E;EACH,CA3BD;EA4BA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACI5F,oBAAoB,CAAC+B,SAArB,CAA+BoX,eAA/B,GAAiD,UAAUvT,UAAV,EAAsBoG,IAAtB,EAA4B;IACzE,IAAIsG,eAAe,GAAG,KAAK3M,cAAL,CAAoBC,UAApB,EAAgC,IAAhC,CAAtB;;IACA,IAAI0M,eAAJ,EAAqB;MACjB,KAAK,IAAI7I,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6I,eAAe,CAACxM,MAApC,EAA4C2D,CAAC,EAA7C,EAAiD;QAC7C,IAAI8I,IAAI,CAACC,SAAL,CAAe,KAAKlS,2BAApB,MAAqDiS,IAAI,CAACC,SAAL,CAAeF,eAAe,CAAC7I,CAAD,CAA9B,CAAzD,EAA6F;UACzF6I,eAAe,CAAC7I,CAAD,CAAf,CAAmBuC,IAAnB,GAA0BA,IAA1B;QACH;MACJ;IACJ;;IACD,KAAKmF,iBAAL,CAAuBmB,eAAvB,EAAwC1M,UAAxC;IACA,KAAK9D,aAAL,CAAmB2Q,4BAAnB,CAAgD,IAAhD;EACH,CAXD;;EAYAzS,oBAAoB,CAAC+B,SAArB,CAA+B8W,sBAA/B,GAAwD,YAAY;IAChE,IAAI,CAAC,KAAK/X,UAAV,EAAsB;MAClB,IAAI,KAAKb,SAAL,CAAemZ,mBAAf,IAAsC,CAAC,KAAKnZ,SAAL,CAAeuB,mBAAf,CAAmC6X,eAA9E,EAA+F;QAC3F,KAAKhZ,2BAAL,GAAmC,KAAKA,2BAAxC;QACA,KAAKC,2BAAL,GAAmC,KAAKA,2BAAxC;MACH,CAHD,MAIK;QACD,KAAKD,2BAAL,GAAmC,IAAnC;QACA,KAAKC,2BAAL,GAAmC,IAAnC;MACH;;MACD,IAAIgZ,MAAM,GAAG,KAAb,CATkB,CAUlB;;MACA,IAAI,KAAKrZ,SAAL,CAAegF,UAAf,CAA0BsU,wBAA1B,IAAsD,KAAKtZ,SAAL,CAAegF,UAAf,CAA0BsU,wBAA1B,CAAmDC,iBAA7G,EAAgI;QAC5HF,MAAM,GAAG,IAAT;MACH;;MACD,IAAI,CAACA,MAAL,EAAa;QACT,KAAKG,8BAAL,CAAoC,KAApC;MACH;IACJ;EACJ,CAnBD;EAoBA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EACIzZ,oBAAoB,CAAC+B,SAArB,CAA+B2X,+BAA/B,GAAiE,UAAU9T,UAAV,EAAsB+T,QAAtB,EAAgC;IAC7F,IAAIA,QAAJ,EAAc;MACV,KAAKlZ,kBAAL,GAA0B,IAA1B;IACH,CAFD,MAGK;MACD,KAAKA,kBAAL,GAA0B,KAA1B;IACH;;IACD,IAAImZ,cAAc,GAAIhU,UAAU,GAAG,CAAd,IAAoB,CAApB,GAAyBA,UAAU,GAAG,CAAtC,GAA2C,CAAhE,CAP6F,CAQ7F;;IACA,IAAIiU,eAAe,GAAIjU,UAAU,GAAG,CAAd,GAAmB,KAAK9D,aAAL,CAAmBoV,SAAtC,GAAmDtR,UAAU,GAAG,CAAhE,GAAqE,KAAK9D,aAAL,CAAmBoV,SAAnB,GAA+B,CAA1H;;IACA,KAAK,IAAI9Q,CAAC,GAAGwT,cAAb,EAA6BxT,CAAC,IAAIyT,eAAlC,EAAmDzT,CAAC,EAApD,EAAwD;MACpD,KAAK0T,wBAAL,CAA8B1T,CAA9B;IACH;EACJ,CAbD,CA1lDkD,CAwmDlD;;;EACApG,oBAAoB,CAAC+B,SAArB,CAA+B0V,gBAA/B,GAAkD,UAAUrS,MAAV,EAAkB8J,SAAlB,EAA6B;IAC3E;IACA,IAAIpF,QAAQ,GAAG,EAAf;;IACA,KAAK,IAAIL,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGrE,MAAM,CAACU,MAA3B,EAAmC2D,CAAC,EAApC,EAAwC;MACpC;MACA,IAAIhD,KAAK,GAAG,KAAKsT,mBAAL,CAAyB3U,MAAM,CAACqE,CAAD,CAA/B,EAAoCyF,SAApC,CAAZ;MACApF,QAAQ,CAACQ,IAAT,CAAc7D,KAAd;IACH;;IACD,OAAOqD,QAAP;EACH,CATD,CAzmDkD,CAmnDlD;;;EACA9J,oBAAoB,CAAC+B,SAArB,CAA+BgY,mBAA/B,GAAqD,UAAU3U,MAAV,EAAkB8J,SAAlB,EAA6B;IAC9E,IAAInM,IAAI,GAAGqC,MAAM,CAACrC,IAAP,GAAcqC,MAAM,CAACrC,IAArB,GAA4BqC,MAAM,CAACsB,IAA9C;IACA,IAAI5D,GAAG,GAAGsC,MAAM,CAACtC,GAAP,GAAasC,MAAM,CAACtC,GAApB,GAA0BsC,MAAM,CAACuB,GAA3C;IACA,IAAI5B,MAAM,GAAGK,MAAM,CAACL,MAAP,GAAgBK,MAAM,CAACL,MAAvB,GAAgCK,MAAM,CAACyB,MAApD;IACA,IAAIhC,KAAK,GAAGO,MAAM,CAACP,KAAP,GAAeO,MAAM,CAACP,KAAtB,GAA8BO,MAAM,CAACwB,KAAjD;IACA,IAAIgO,WAAW,GAAG,KAAK9S,aAAL,CAAmBqG,QAAnB,CAA4B+G,SAA5B,CAAlB;IACAnM,IAAI,GAAGA,IAAI,GAAGA,IAAH,GAAUqC,MAAM,CAAChC,CAA5B;IACAN,GAAG,GAAGA,GAAG,GAAGA,GAAH,GAASsC,MAAM,CAAC/B,CAAzB;;IACA,IAAIuR,WAAJ,EAAiB;MACb,IAAIA,WAAW,CAACE,QAAZ,KAAyB,CAA7B,EAAgC;QAC5B,OAAO;UAAE/R,IAAI,EAAED,GAAR;UAAaA,GAAG,EAAE8R,WAAW,CAAC/P,KAAZ,IAAqB9B,IAAI,GAAG8B,KAA5B,CAAlB;UAAsDA,KAAK,EAAEE,MAA7D;UAAqEA,MAAM,EAAEF;QAA7E,CAAP;MACH,CAFD,MAGK,IAAI+P,WAAW,CAACE,QAAZ,KAAyB,CAA7B,EAAgC;QACjC;QACA,OAAO;UAAE/R,IAAI,EAAE6R,WAAW,CAAC/P,KAAZ,GAAoB9B,IAApB,GAA2B8B,KAAnC;UAA0C/B,GAAG,EAAE8R,WAAW,CAAC7P,MAAZ,GAAqBjC,GAArB,GAA2BiC,MAA1E;UAAkFF,KAAK,EAAEA,KAAzF;UAAgGE,MAAM,EAAEA;QAAxG,CAAP;MACH,CAHI,MAIA,IAAI6P,WAAW,CAACE,QAAZ,KAAyB,CAA7B,EAAgC;QACjC,OAAO;UAAE/R,IAAI,EAAE6R,WAAW,CAAC7P,MAAZ,GAAqBjC,GAArB,GAA2BiC,MAAnC;UAA2CjC,GAAG,EAAEC,IAAhD;UAAsD8B,KAAK,EAAEE,MAA7D;UAAqEA,MAAM,EAAEF;QAA7E,CAAP;MACH,CAFI,MAGA;QACD,OAAO;UAAE9B,IAAI,EAAEA,IAAR;UAAcD,GAAG,EAAEA,GAAnB;UAAwB+B,KAAK,EAAEA,KAA/B;UAAsCE,MAAM,EAAEA;QAA9C,CAAP;MACH;IACJ,CAdD,MAeK;MACD,OAAO;QAAEhC,IAAI,EAAEA,IAAR;QAAcD,GAAG,EAAEA,GAAnB;QAAwB+B,KAAK,EAAEA,KAA/B;QAAsCE,MAAM,EAAEA;MAA9C,CAAP;IACH;EACJ,CA1BD,CApnDkD,CA+oDlD;;;EACA/E,oBAAoB,CAAC+B,SAArB,CAA+B6V,UAA/B,GAA4C,UAAUD,WAAV,EAAuB;IAC/D,IAAI,CAACA,WAAW,CAACqC,KAAZ,CAAkB,gBAAlB,CAAD,IAAwC,CAACrC,WAAW,CAACqC,KAAZ,CAAkB,4DAAlB,CAA7C,EAA8H;MAC1HrC,WAAW,GAAG,KAAK1X,SAAL,CAAekE,gBAAf,CAAgC8V,UAAhC,CAA2CtC,WAA3C,CAAd;IACH;;IACD,IAAIuC,iBAAiB,GAAGvC,WAAW,CAACwC,KAAZ,CAAkB,GAAlB,CAAxB;;IACA,IAAIra,iBAAiB,CAACoa,iBAAiB,CAAC,CAAD,CAAlB,CAArB,EAA6C;MACzCvC,WAAW,GAAG,KAAK1X,SAAL,CAAekE,gBAAf,CAAgCiW,QAAhC,CAAyCzC,WAAzC,EAAsD,MAAtD,CAAd;MACAuC,iBAAiB,GAAGvC,WAAW,CAACwC,KAAZ,CAAkB,GAAlB,CAApB;IACH,CAR8D,CAS/D;;;IACA,IAAIE,WAAW,GAAG5S,QAAQ,CAACyS,iBAAiB,CAAC,CAAD,CAAjB,CAAqBC,KAArB,CAA2B,GAA3B,EAAgC,CAAhC,CAAD,CAA1B,CAV+D,CAW/D;;IACA,IAAIG,WAAW,GAAG7S,QAAQ,CAACyS,iBAAiB,CAAC,CAAD,CAAlB,CAA1B,CAZ+D,CAa/D;;IACA,IAAIK,WAAW,GAAG9S,QAAQ,CAACyS,iBAAiB,CAAC,CAAD,CAAlB,CAA1B,CAd+D,CAe/D;;IACA,IAAIM,WAAW,GAAG/S,QAAQ,CAACyS,iBAAiB,CAAC,CAAD,CAAlB,CAA1B;IACA,OAAO;MAAEO,CAAC,EAAED,WAAL;MAAkBE,CAAC,EAAEL,WAArB;MAAkCM,CAAC,EAAEL,WAArC;MAAkDM,CAAC,EAAEL;IAArD,CAAP;EACH,CAlBD;;EAmBAva,oBAAoB,CAAC+B,SAArB,CAA+BkN,cAA/B,GAAgD,YAAY;IACxD,IAAID,UAAU,GAAG,EAAjB;IACA,IAAI6L,SAAS,GAAGvV,MAAM,CAACC,YAAP,EAAhB;;IACA,IAAIsV,SAAS,CAACC,UAAV,KAAyB,IAA7B,EAAmC;MAC/B,IAAIC,KAAK,GAAGxS,QAAQ,CAACyS,WAAT,EAAZ;MACA,IAAIC,mBAAmB,GAAG,KAAKnZ,aAAL,CAAmBgF,SAAnB,CAA6BmU,mBAA7B,CAAiDJ,SAAjD,CAA1B;;MACA,IAAIA,SAAS,CAACC,UAAV,KAAyBD,SAAS,CAACK,SAAvC,EAAkD;QAC9C,IAAIC,MAAM,GAAG,KAAKrZ,aAAL,CAAmBgF,SAAnB,CAA6BsU,YAA7B,CAA0CP,SAAS,CAACC,UAApD,CAAb;QACA,IAAIvL,UAAU,GAAG,CAAjB;QACA,IAAIC,QAAQ,GAAG,CAAf;;QACA,IAAI,CAAC6L,KAAK,CAACF,MAAD,CAAV,EAAoB;UAChB,IAAIG,QAAQ,GAAG,KAAKxZ,aAAL,CAAmBiF,UAAnB,CAA8B,cAAcoU,MAA5C,EAAoD5X,qBAApD,EAAf;;UACA,IAAI,KAAKzB,aAAL,CAAmByZ,mBAAvB,EAA4C;YACxCD,QAAQ,GAAG,KAAKxZ,aAAL,CAAmBiF,UAAnB,CAA8B,gBAAgBoU,MAA9C,EAAsD5X,qBAAtD,EAAX;UACH;;UACD,IAAI0X,mBAAJ,EAAyB;YACrBF,KAAK,CAACS,QAAN,CAAeX,SAAS,CAACK,SAAzB,EAAoCL,SAAS,CAACY,WAA9C;YACAV,KAAK,CAACW,MAAN,CAAab,SAAS,CAACC,UAAvB,EAAmCD,SAAS,CAACc,YAA7C;UACH,CAHD,MAIK;YACD,IAAId,SAAS,CAACc,YAAV,GAAyBd,SAAS,CAACY,WAAvC,EAAoD;cAChDlM,UAAU,GAAGsL,SAAS,CAACc,YAAvB;cACAnM,QAAQ,GAAGqL,SAAS,CAACY,WAArB;cACAV,KAAK,CAACS,QAAN,CAAeX,SAAS,CAACC,UAAzB,EAAqCD,SAAS,CAACc,YAA/C;cACAZ,KAAK,CAACW,MAAN,CAAab,SAAS,CAACK,SAAvB,EAAkCL,SAAS,CAACY,WAA5C;YACH,CALD,MAMK;cACDlM,UAAU,GAAGsL,SAAS,CAACY,WAAvB;cACAjM,QAAQ,GAAGqL,SAAS,CAACc,YAArB;cACAZ,KAAK,CAACS,QAAN,CAAeX,SAAS,CAACK,SAAzB,EAAoCL,SAAS,CAACY,WAA9C;cACAV,KAAK,CAACW,MAAN,CAAab,SAAS,CAACC,UAAvB,EAAmCD,SAAS,CAACc,YAA7C;YACH;UACJ;;UACD,IAAI5T,YAAY,GAAGgT,KAAK,CAACxX,qBAAN,EAAnB,CAvBgB,CAwBhB;;UACA,IAAIwO,OAAO,GAAG,KAAKI,eAAL,CAAqBgJ,MAArB,EAA6BJ,KAAK,CAAChM,QAAN,EAA7B,EAA+CgM,KAAK,CAACa,uBAAN,CAA8BtM,WAA9B,CAA0CP,QAA1C,EAA/C,CAAd,CAzBgB,CA0BhB;;UACA,IAAI8M,SAAS,GAAG;YAAE9Y,IAAI,EAAE,KAAK+Y,eAAL,CAAqB/T,YAAY,CAAChF,IAAb,GAAoBuY,QAAQ,CAACvY,IAAlD,CAAR;YAAiED,GAAG,EAAE,KAAKgZ,eAAL,CAAqB/T,YAAY,CAACjF,GAAb,GAAmBwY,QAAQ,CAACxY,GAAjD,CAAtE;YAA6H+B,KAAK,EAAE,KAAKiX,eAAL,CAAqB/T,YAAY,CAAClD,KAAlC,CAApI;YAA8KE,MAAM,EAAE,KAAK+W,eAAL,CAAqB/T,YAAY,CAAChD,MAAlC,CAAtL;YAAiOgX,KAAK,EAAE,KAAKD,eAAL,CAAqB/T,YAAY,CAACgU,KAAb,GAAqBT,QAAQ,CAACvY,IAAnD,CAAxO;YAAkSiZ,MAAM,EAAE,KAAKF,eAAL,CAAqB/T,YAAY,CAACiU,MAAb,GAAsBV,QAAQ,CAACxY,GAApD;UAA1S,CAAhB;UACA,IAAImZ,cAAc,GAAG,EAArB;UACAA,cAAc,CAAC3R,IAAf,CAAoBuR,SAApB,EA7BgB,CA8BhB;;UACA,IAAI3P,IAAI,GAAG;YAAEnJ,IAAI,EAAE8Y,SAAS,CAAC9Y,IAAlB;YAAwBD,GAAG,EAAE+Y,SAAS,CAAC/Y,GAAvC;YAA4CiZ,KAAK,EAAEF,SAAS,CAACE,KAA7D;YAAoEC,MAAM,EAAEH,SAAS,CAACG;UAAtF,CAAX;UACAhN,UAAU,CAAC1E,IAAX,CAAgB;YAAE4E,SAAS,EAAEiM,MAAb;YAAqB/V,MAAM,EAAE6W,cAA7B;YAA6C/P,IAAI,EAAEA,IAAnD;YAAyDqD,UAAU,EAAEwC,OAAO,CAACxC,UAA7E;YAAyFC,QAAQ,EAAEuC,OAAO,CAACvC,QAA3G;YAAqHF,WAAW,EAAEyL,KAAK,CAAChM,QAAN;UAAlI,CAAhB;QACH;MACJ,CAtCD,MAuCK;QACD,IAAIiD,SAAS,GAAG,KAAK,CAArB;QACA,IAAIC,OAAO,GAAG,KAAK,CAAnB;QACA,IAAIiK,oBAAoB,GAAG,KAAK,CAAhC;QACA,IAAIC,kBAAkB,GAAG,KAAK,CAA9B;;QACA,IAAIlB,mBAAJ,EAAyB;UACrBjJ,SAAS,GAAG6I,SAAS,CAACK,SAAtB;UACAgB,oBAAoB,GAAGrB,SAAS,CAACY,WAAjC;UACAxJ,OAAO,GAAG4I,SAAS,CAACC,UAApB;UACAqB,kBAAkB,GAAGtB,SAAS,CAACc,YAA/B;QACH,CALD,MAMK;UACD3J,SAAS,GAAG6I,SAAS,CAACC,UAAtB;UACAoB,oBAAoB,GAAGrB,SAAS,CAACc,YAAjC;UACA1J,OAAO,GAAG4I,SAAS,CAACK,SAApB;UACAiB,kBAAkB,GAAGtB,SAAS,CAACY,WAA/B;QACH;;QACD,IAAIW,YAAY,GAAG,KAAKta,aAAL,CAAmBgF,SAAnB,CAA6BsU,YAA7B,CAA0CpJ,SAA1C,CAAnB;QACA,IAAIqK,YAAY,GAAG,KAAKva,aAAL,CAAmBgF,SAAnB,CAA6BwV,YAA7B,CAA0CtK,SAA1C,EAAqDoK,YAArD,CAAnB;QACA,IAAIG,WAAW,GAAG,KAAKza,aAAL,CAAmBgF,SAAnB,CAA6BsU,YAA7B,CAA0CnJ,OAA1C,CAAlB;QACA,IAAIuK,WAAW,GAAG,KAAK1a,aAAL,CAAmBgF,SAAnB,CAA6BwV,YAA7B,CAA0CrK,OAA1C,EAAmDsK,WAAnD,CAAlB;QACA,IAAIE,WAAW,GAAG,CAAlB;QACA,IAAIC,SAAS,GAAG,CAAhB;QACA,IAAIC,SAAS,GAAG,CAAhB;;QACA,KAAK,IAAIlT,CAAC,GAAG2S,YAAb,EAA2B3S,CAAC,IAAI8S,WAAhC,EAA6C9S,CAAC,EAA9C,EAAkD;UAC9C,IAAImT,cAAc,GAAG,EAArB;UACA,IAAIC,WAAW,GAAG,KAAK,CAAvB;UACA,IAAIC,SAAS,GAAG,KAAK,CAArB;UACA,IAAIC,eAAe,GAAG,KAAK,CAA3B;UACA,IAAIC,aAAa,GAAG,KAAK,CAAzB;UACA,IAAIhW,QAAQ,GAAG,KAAKlF,aAAL,CAAmBiF,UAAnB,CAA8B,gBAAgB0C,CAA9C,EAAiDxC,UAAhE;UACA,IAAIqU,QAAQ,GAAG,KAAKxZ,aAAL,CAAmBiF,UAAnB,CAA8B,cAAc0C,CAA5C,EAA+ClG,qBAA/C,EAAf;;UACA,IAAI,KAAKzB,aAAL,CAAmByZ,mBAAvB,EAA4C;YACxCD,QAAQ,GAAG,KAAKxZ,aAAL,CAAmBiF,UAAnB,CAA8B,gBAAgB0C,CAA9C,EAAiDlG,qBAAjD,EAAX;UACH;;UACD,IAAIkG,CAAC,KAAK2S,YAAV,EAAwB;YACpBO,SAAS,GAAGN,YAAZ;UACH,CAFD,MAGK;YACDM,SAAS,GAAG,CAAZ;UACH;;UACD,KAAK,IAAItW,CAAC,GAAGsW,SAAb,EAAwBtW,CAAC,GAAGW,QAAQ,CAAClB,MAArC,EAA6CO,CAAC,EAA9C,EAAkD;YAC9C,IAAI4W,WAAW,GAAGjW,QAAQ,CAACX,CAAD,CAA1B;;YACA,IAAIA,CAAC,KAAKsW,SAAV,EAAqB;cACjBE,WAAW,GAAGF,SAAd;cACAI,eAAe,GAAItT,CAAC,KAAK2S,YAAP,GAAuBF,oBAAvB,GAA8C,CAAhE;YACH,CAHD,MAIK;cACDY,SAAS,GAAGzW,CAAZ;cACA2W,aAAa,GAAIvT,CAAC,KAAK8S,WAAP,GAAsBJ,kBAAtB,GAA2Cc,WAAW,CAAC3N,WAAZ,CAAwBxJ,MAAnF;YACH;;YACD,IAAIO,CAAC,KAAKgW,YAAN,IAAsB5S,CAAC,KAAK2S,YAAhC,EAA8C;cAC1CK,WAAW,GAAGP,oBAAd;YACH,CAFD,MAGK;cACDO,WAAW,GAAG,CAAd;YACH;;YACD,IAAIpW,CAAC,KAAKmW,WAAN,IAAqB/S,CAAC,KAAK8S,WAA/B,EAA4C;cACxCG,SAAS,GAAGP,kBAAZ;YACH,CAFD,MAGK;cACDO,SAAS,GAAGO,WAAW,CAAC3N,WAAZ,CAAwBxJ,MAApC;YACH;;YACD,KAAK,IAAIM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6W,WAAW,CAAChW,UAAZ,CAAuBnB,MAA3C,EAAmDM,CAAC,EAApD,EAAwD;cACpD,IAAI8W,IAAI,GAAGD,WAAW,CAAChW,UAAZ,CAAuBb,CAAvB,CAAX;cACA2U,KAAK,CAACS,QAAN,CAAe0B,IAAf,EAAqBT,WAArB;cACA1B,KAAK,CAACW,MAAN,CAAawB,IAAb,EAAmBR,SAAnB;YACH;;YACD,IAAI3U,YAAY,GAAGgT,KAAK,CAACxX,qBAAN,EAAnB,CA3B8C,CA4B9C;;YACA,IAAIsY,SAAS,GAAG;cAAE9Y,IAAI,EAAE,KAAK+Y,eAAL,CAAqB/T,YAAY,CAAChF,IAAb,GAAoBuY,QAAQ,CAACvY,IAAlD,CAAR;cAAiED,GAAG,EAAE,KAAKgZ,eAAL,CAAqB/T,YAAY,CAACjF,GAAb,GAAmBwY,QAAQ,CAACxY,GAAjD,CAAtE;cAA6H+B,KAAK,EAAE,KAAKiX,eAAL,CAAqB/T,YAAY,CAAClD,KAAlC,CAApI;cAA8KE,MAAM,EAAE,KAAK+W,eAAL,CAAqB/T,YAAY,CAAChD,MAAlC,CAAtL;cAAiOgX,KAAK,EAAE,KAAKD,eAAL,CAAqB/T,YAAY,CAACgU,KAAb,GAAqBT,QAAQ,CAACvY,IAAnD,CAAxO;cAAkSiZ,MAAM,EAAE,KAAKF,eAAL,CAAqB/T,YAAY,CAACiU,MAAb,GAAsBV,QAAQ,CAACxY,GAApD;YAA1S,CAAhB;YACA8Z,cAAc,CAACtS,IAAf,CAAoBuR,SAApB;YACAd,KAAK,CAACoC,MAAN;;YACA,IAAI1T,CAAC,KAAK8S,WAAN,IAAqBlW,CAAC,KAAKmW,WAA/B,EAA4C;cACxC;YACH;UACJ;;UACD,IAAI,CAACM,SAAL,EAAgB;YACZA,SAAS,GAAGD,WAAZ;UACH;;UACD,IAAI,CAACG,aAAL,EAAoB;YAChBA,aAAa,GAAGN,SAAhB;UACH;;UACD,IAAIU,gBAAgB,GAAG,KAAKtb,aAAL,CAAmBiF,UAAnB,CAA8B,WAAW0C,CAAX,GAAe,GAAf,GAAqBoT,WAAnD,EAAgE5V,UAAhE,CAA2E,CAA3E,CAAvB;UACA,IAAIoW,cAAc,GAAG,KAAKvb,aAAL,CAAmBiF,UAAnB,CAA8B,WAAW0C,CAAX,GAAe,GAAf,GAAqBqT,SAAnD,EAA8D7V,UAA9D,CAAyE,CAAzE,CAArB;UACA,IAAIqW,SAAS,GAAG/U,QAAQ,CAACyS,WAAT,EAAhB;UACAsC,SAAS,CAAC9B,QAAV,CAAmB4B,gBAAnB,EAAqCL,eAArC;UACAO,SAAS,CAAC5B,MAAV,CAAiB2B,cAAjB,EAAiCL,aAAjC;UACA,IAAIO,cAAc,GAAGD,SAAS,CAAC/Z,qBAAV,EAArB;UACA,IAAIuO,SAAS,GAAGwL,SAAS,CAACvO,QAAV,EAAhB,CAjE8C,CAkE9C;;UACA,IAAIgD,OAAO,GAAG,KAAKI,eAAL,CAAqB1I,CAArB,EAAwBqI,SAAxB,CAAd,CAnE8C,CAoE9C;;UACA,IAAI0L,aAAa,GAAG;YAAEza,IAAI,EAAE,KAAK+Y,eAAL,CAAqByB,cAAc,CAACxa,IAAf,GAAsBuY,QAAQ,CAACvY,IAApD,CAAR;YAAmED,GAAG,EAAE,KAAKgZ,eAAL,CAAqByB,cAAc,CAACza,GAAf,GAAqBwY,QAAQ,CAACxY,GAAnD,CAAxE;YAAiI+B,KAAK,EAAE,KAAKiX,eAAL,CAAqByB,cAAc,CAAC1Y,KAApC,CAAxI;YAAoLE,MAAM,EAAE,KAAK+W,eAAL,CAAqByB,cAAc,CAACxY,MAApC,CAA5L;YAAyOgX,KAAK,EAAE,KAAKD,eAAL,CAAqByB,cAAc,CAACxB,KAAf,GAAuBT,QAAQ,CAACvY,IAArD,CAAhP;YAA4SiZ,MAAM,EAAE,KAAKF,eAAL,CAAqByB,cAAc,CAACvB,MAAf,GAAwBV,QAAQ,CAACxY,GAAtD;UAApT,CAApB,CArE8C,CAsE9C;;UACA,IAAIoJ,IAAI,GAAG;YAAEnJ,IAAI,EAAEya,aAAa,CAACza,IAAtB;YAA4BD,GAAG,EAAE0a,aAAa,CAAC1a,GAA/C;YAAoDiZ,KAAK,EAAEyB,aAAa,CAACzB,KAAzE;YAAgFC,MAAM,EAAEwB,aAAa,CAACxB;UAAtG,CAAX;UACAhN,UAAU,CAAC1E,IAAX,CAAgB;YAAE4E,SAAS,EAAEzF,CAAb;YAAgBrE,MAAM,EAAEwX,cAAxB;YAAwC1Q,IAAI,EAAEA,IAA9C;YAAoDqD,UAAU,EAAEwC,OAAO,CAACxC,UAAxE;YAAoFC,QAAQ,EAAEuC,OAAO,CAACvC,QAAtG;YAAgHF,WAAW,EAAEwC;UAA7H,CAAhB;QACH;MACJ;IACJ;;IACD+I,SAAS,CAACrV,eAAV;IACA,OAAOwJ,UAAP;EACH,CAnJD,CAnqDkD,CAuzDlD;;;EACAhP,oBAAoB,CAAC+B,SAArB,CAA+BoQ,eAA/B,GAAiD,UAAUvM,UAAV,EAAsB6X,OAAtB,EAA+BvL,UAA/B,EAA2C;IACxF;IACA,IAAIwL,UAAU,GAAG,KAAK5b,aAAL,CAAmB6b,aAAnB,CAAiC/X,UAAjC,CAAjB;IACA,IAAI2J,UAAJ;IACA,IAAIC,QAAJ;;IACA,IAAIkO,UAAJ,EAAgB;MACZ,IAAIE,aAAa,GAAG,CAApB;MACA,IAAIC,QAAQ,GAAGH,UAAU,CAACG,QAA1B;;MACA,KAAK,IAAI3X,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGN,UAApB,EAAgCM,CAAC,EAAjC,EAAqC;QACjC,IAAI,KAAKjG,SAAL,CAAe6d,aAAnB,EAAkC;UAC9B;UACA,IAAIC,aAAa,GAAG,KAAK9d,SAAL,CAAe+d,gBAAf,CAAgCC,sBAAhC,CAAuD/X,CAAvD,EAA0DA,CAA1D,CAApB;UACA,IAAIgY,YAAY,GAAGH,aAAa,CAACF,QAAd,GAAyBE,aAAa,CAACF,QAAvC,GAAkDE,aAAa,CAACI,QAAnF,CAH8B,CAI9B;;UACA,IAAI,KAAKle,SAAL,CAAe+d,gBAAf,IAAmC,KAAK/d,SAAL,CAAe+d,gBAAf,CAAgCC,sBAAnE,IAA6F,KAAKhe,SAAL,CAAe+d,gBAAf,CAAgCI,eAAjI,EAAkJ;YAC9I,IAAI,KAAKne,SAAL,CAAe+d,gBAAf,CAAgCC,sBAAhC,CAAuD/X,CAAvD,CAAJ,EAA+D;cAC3D0X,aAAa,GAAGA,aAAa,GAAGM,YAAY,CAACpY,MAA7C;YACH;UACJ,CAJD,MAKK;YACD;YACA,IAAI,KAAK7F,SAAL,CAAe+d,gBAAf,IAAmC,KAAK/d,SAAL,CAAe+d,gBAAf,CAAgCC,sBAAvE,EAA+F;cAC3F,IAAIrY,UAAU,IAAI,KAAK3F,SAAL,CAAe+d,gBAAf,CAAgCC,sBAAhC,CAAuDnY,MAAzE,EAAiF;gBAC7E,IAAI,KAAK7F,SAAL,CAAe+d,gBAAf,CAAgCC,sBAAhC,CAAuD/X,CAAvD,CAAJ,EAA+D;kBAC3D;kBACA0X,aAAa,GAAGA,aAAa,GAAGM,YAAY,CAACpY,MAA7C;gBACH;cACJ,CALD,MAMK;gBACD8X,aAAa,GAAG,CAAhB;gBACA;cACH;YACJ;UACJ;QACJ;MACJ;;MACD,IAAI,CAAC9d,iBAAiB,CAACoS,UAAD,CAAtB,EAAoC;QAChC,IAAImM,WAAW,GAAGR,QAAQ,CAACS,OAAT,CAAiBpM,UAAjB,CAAlB;QACA,IAAIqM,YAAY,GAAGrM,UAAU,CAACoM,OAAX,CAAmBb,OAAnB,CAAnB;QACAlO,UAAU,GAAI8O,WAAW,GAAGE,YAAf,GAA+BX,aAA5C;MACH,CAJD,MAKK;QACDrO,UAAU,GAAIsO,QAAQ,CAACS,OAAT,CAAiBb,OAAjB,CAAD,GAA8BG,aAA3C;MACH;;MACDpO,QAAQ,GAAGD,UAAU,IAAIkO,OAAO,CAAC3X,MAAR,GAAiB,CAArB,CAArB;IACH;;IACD,OAAO;MAAEyJ,UAAU,EAAEA,UAAd;MAA0BC,QAAQ,EAAEA;IAApC,CAAP;EACH,CA/CD;EAgDA;AACJ;AACA;AACA;;;EACIxP,oBAAoB,CAAC+B,SAArB,CAA+Byc,wBAA/B,GAA0D,UAAU5Y,UAAV,EAAsB;IAC5E,IAAI6Y,WAAW,GAAG,KAAK3c,aAAL,CAAmBiF,UAAnB,CAA8B,uBAAuBnB,UAArD,CAAlB;;IACA,IAAI6Y,WAAJ,EAAiB;MACb,IAAIC,cAAc,GAAG,KAAK5c,aAAL,CAAmBiF,UAAnB,CAA8B,2BAA2BnB,UAAzD,CAArB;;MACA,IAAI8Y,cAAJ,EAAoB;QAChB,IAAID,WAAJ,EAAiB;UACbC,cAAc,CAACxc,EAAf,GAAoBuc,WAAW,CAACvc,EAAhC;UACAuc,WAAW,CAAC3N,aAAZ,CAA0B6H,WAA1B,CAAsC8F,WAAtC;QACH,CAHD,MAIK;UACDC,cAAc,CAACxc,EAAf,GAAoB,KAAKjC,SAAL,CAAekC,OAAf,CAAuBD,EAAvB,GAA4B,oBAA5B,GAAmD0D,UAAvE;QACH;;QACD6Y,WAAW,GAAGC,cAAd;MACH;;MACDD,WAAW,CAACpc,KAAZ,CAAkBwC,KAAlB,GAA0B,EAA1B;MACA4Z,WAAW,CAACpc,KAAZ,CAAkB0C,MAAlB,GAA2B,EAA3B;;MACA,IAAI,KAAK9E,SAAL,CAAe0e,mBAAnB,EAAwC;QACpC;QACAF,WAAW,CAACpc,KAAZ,CAAkBwC,KAAlB,GAA0B,KAAK/C,aAAL,CAAmBqG,QAAnB,CAA4BvC,UAA5B,EAAwCf,KAAxC,GAAgD,KAAK/C,aAAL,CAAmBgD,aAAnB,EAAhD,GAAqF,IAA/G,CAFoC,CAGpC;;QACA2Z,WAAW,CAACpc,KAAZ,CAAkB0C,MAAlB,GAA2B,KAAKjD,aAAL,CAAmBqG,QAAnB,CAA4BvC,UAA5B,EAAwCb,MAAxC,GAAiD,KAAKjD,aAAL,CAAmBgD,aAAnB,EAAjD,GAAsF,IAAjH;MACH,CALD,MAMK;QACD;QACA2Z,WAAW,CAAC5Z,KAAZ,GAAoB,KAAK/C,aAAL,CAAmBqG,QAAnB,CAA4BvC,UAA5B,EAAwCf,KAAxC,GAAgD,KAAK/C,aAAL,CAAmBgD,aAAnB,EAApE;QACA2Z,WAAW,CAAC1Z,MAAZ,GAAqB,KAAKjD,aAAL,CAAmBqG,QAAnB,CAA4BvC,UAA5B,EAAwCb,MAAxC,GAAiD,KAAKjD,aAAL,CAAmBgD,aAAnB,EAAtE;MACH;;MACD,KAAKmE,2BAAL,CAAiC,IAAjC,EAAuCrD,UAAvC,EAAmD6Y,WAAnD,EAAgE,KAAK3c,aAAL,CAAmBgD,aAAnB,EAAhE;IACH;EACJ,CA7BD;EA8BA;AACJ;AACA;AACA;;;EACI9E,oBAAoB,CAAC+B,SAArB,CAA+B6c,mBAA/B,GAAqD,UAAUhZ,UAAV,EAAsB;IACvE;IACA,IAAIiZ,mBAAmB,GAAGtW,QAAQ,CAACuW,gBAAT,CAA0B,MAAM,KAAK7e,SAAL,CAAekC,OAAf,CAAuBD,EAA7B,GAAkC,wBAAlC,GAA6D0D,UAAvF,CAA1B;;IACA,KAAK,IAAI6D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoV,mBAAmB,CAAC/Y,MAAxC,EAAgD2D,CAAC,EAAjD,EAAqD;MACjD,IAAIoV,mBAAmB,CAACpV,CAAD,CAAvB,EAA4B;QACxBoV,mBAAmB,CAACpV,CAAD,CAAnB,CAAuBqH,aAAvB,CAAqC6H,WAArC,CAAiDkG,mBAAmB,CAACpV,CAAD,CAApE;MACH;IACJ;;IACD,IAAIsV,SAAS,GAAG,KAAKjd,aAAL,CAAmBiF,UAAnB,CAA8B,uBAAuBnB,UAArD,CAAhB;;IACA,IAAImZ,SAAJ,EAAe;MACXA,SAAS,CAAC1c,KAAV,CAAgBW,OAAhB,GAA0B,OAA1B;IACH;EACJ,CAZD;EAaA;AACJ;AACA;AACA;;;EACIhD,oBAAoB,CAAC+B,SAArB,CAA+Bid,6BAA/B,GAA+D,UAAUzd,KAAV,EAAiB;IAC5E,IAAIqE,UAAU,GAAG,KAAK3F,SAAL,CAAekE,gBAAf,CAAgC8a,kBAAhC,CAAmD1d,KAAnD,CAAjB;;IACA,IAAI,CAACzB,iBAAiB,CAAC8F,UAAD,CAAlB,IAAkC,CAACyV,KAAK,CAACzV,UAAD,CAA5C,EAA0D;MACtD,IAAIoD,MAAM,GAAG,KAAKlH,aAAL,CAAmBiF,UAAnB,CAA8B,uBAAuBnB,UAArD,CAAb;;MACA,IAAI,KAAKtF,2BAAT,EAAsC;QAClC,KAAKU,kBAAL,GAA0B,KAAKV,2BAA/B;MACH,CAFD,MAGK;QACD,KAAKU,kBAAL,GAA0B,IAA1B;MACH;;MACD,KAAKke,8BAAL;MACA,IAAI3Y,YAAY,GAAG,KAAK4Y,0BAAL,CAAgC5d,KAAK,CAACkC,OAAtC,EAA+ClC,KAAK,CAACmC,OAArD,EAA8DkC,UAA9D,EAA0EoD,MAA1E,CAAnB;;MACA,IAAIzC,YAAY,IAAI,CAACjB,MAAM,CAACC,YAAP,GAAsBwJ,QAAtB,EAArB,EAAuD;QACnD,IAAIhE,MAAM,GAAG,KAAb;QACA,IAAI8E,WAAW,GAAG,KAAlB;;QACA,IAAItJ,YAAY,CAAC+G,kBAAb,IAAmC/G,YAAY,CAAC+G,kBAAb,CAAgCvC,MAAvE,EAA+E;UAC3EA,MAAM,GAAGxE,YAAY,CAAC+G,kBAAb,CAAgCvC,MAAzC;;UACA,IAAIA,MAAM,IAAI,KAAK9K,SAAL,CAAekE,gBAAf,CAAgC2T,wBAAhC,CAAyD,QAAzD,EAAmEvR,YAAnE,CAAd,EAAgG;YAC5FwE,MAAM,GAAG,KAAT;;YACA,IAAI,KAAK9K,SAAL,CAAekE,gBAAf,CAAgC2T,wBAAhC,CAAyD,gBAAzD,EAA2EvR,YAA3E,CAAJ,EAA8F;cAC1FsJ,WAAW,GAAG,KAAd;YACH,CAFD,MAGK;cACDA,WAAW,GAAG,IAAd;YACH;UACJ;QACJ;;QACD,IAAI,CAAC9E,MAAL,EAAa;UACT,IAAIqU,oBAAoB,GAAGpW,MAAM,CAAC8H,aAAP,CAAqBvN,qBAArB,EAA3B;UACA,IAAI8b,iBAAiB,GAAG9d,KAAK,CAACkC,OAAN,GAAgB2b,oBAAoB,CAACrc,IAA7D;UACA,IAAIuc,gBAAgB,GAAG/d,KAAK,CAACmC,OAAN,GAAgB0b,oBAAoB,CAACtc,GAA5D;UACA,KAAKzB,uBAAL,GAA+B;YAAE+B,CAAC,EAAEic,iBAAL;YAAwBhc,CAAC,EAAEic;UAA3B,CAA/B;UACA,KAAKC,gBAAL,CAAsBhZ,YAAtB,EAAoCyC,MAApC,EAA4CpD,UAA5C,EAAwDrE,KAAxD;;UACA,IAAI1B,OAAO,CAAC6T,QAAR,IAAoB,CAAC,KAAKzT,SAAL,CAAe0T,iBAApC,IAAyD,KAAK1T,SAAL,CAAe2T,aAAxE,IAAyF,KAAK3T,SAAL,CAAe4T,uBAA5G,EAAqI;YACjI,KAAK5T,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqDC,mBAArD,CAAyE,KAAK1T,2BAAL,CAAiCiL,wBAA1G;UACH;;UACD,KAAKjL,2BAAL,GAAmCiG,YAAnC;UACA,KAAKlG,2BAAL,GAAmCuF,UAAnC;;UACA,IAAI,CAACiK,WAAL,EAAkB;YACd,KAAK4J,8BAAL,CAAoC,IAApC;UACH;;UACD,IAAI+F,eAAe,GAAGjX,QAAQ,CAACC,cAAT,CAAwB,KAAKvI,SAAL,CAAekC,OAAf,CAAuBD,EAAvB,GAA4B,eAApD,CAAtB;;UACA,IAAIsd,eAAe,IAAIA,eAAe,CAACnd,KAAhB,CAAsBW,OAAtB,KAAkC,OAAzD,EAAkE;YAC9D;YACA,IAAIyc,eAAe,GAAGlX,QAAQ,CAACC,cAAT,CAAwB,KAAKvI,SAAL,CAAekC,OAAf,CAAuBD,EAAvB,GAA4B,qBAA5B,IAAqD0D,UAAU,GAAG,CAAlE,CAAxB,CAAtB;;YACA,IAAI6Z,eAAJ,EAAqB;cACjBA,eAAe,CAACC,aAAhB,CAA8B,CAA9B,EAAiCC,UAAjC,CAA4C,IAA5C;YACH,CAL6D,CAM9D;;;YACA,IAAItT,QAAQ,GAAG9D,QAAQ,CAACC,cAAT,CAAwBjC,YAAY,CAACR,SAArC,CAAf;;YACA,IAAIsG,QAAJ,EAAc;cACVA,QAAQ,CAACuT,UAAT,CAAoBC,KAApB;YACH;UACJ;;UACD,IAAI,CAAC9f,QAAQ,EAAb,EAAiB;YACb,IAAI,KAAKE,SAAL,CAAe6T,aAAf,IAAgC,KAAK7T,SAAL,CAAe4T,uBAAnD,EAA4E;cACxE,KAAK5T,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqD+L,eAArD,GAAuE,IAAvE,CADwE,CAExE;;cACA,KAAK7f,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqDgM,qBAArD,CAA2E,KAAK9f,SAAL,CAAe6T,aAAf,CAA6BkM,cAAxG;YACH;UACJ;QACJ;MACJ,CAlDD,MAmDK;QACD,KAAKnH,sBAAL;MACH;;MACD,IAAI,KAAK5Y,SAAL,CAAemZ,mBAAf,IAAsC,CAAC,KAAKnZ,SAAL,CAAeuB,mBAAf,CAAmC6X,eAA9E,EAA+F;QAC3F,IAAI9S,YAAJ,EAAkB;UACd,KAAKmT,+BAAL,CAAqC9T,UAArC;QACH;MACJ,CAJD,MAKK;QACD,KAAK8T,+BAAL,CAAqC9T,UAArC;MACH;IACJ,CAxED,MAyEK;MACD,IAAI,CAAC,KAAK9D,aAAL,CAAmBme,oBAAnB,CAAwC1e,KAAxC,EAA+C,IAA/C,CAAL,EAA2D;QACvD,KAAKsX,sBAAL;QACA,KAAKa,+BAAL,CAAqC9T,UAArC;MACH;IACJ;EACJ,CAjFD;EAkFA;AACJ;AACA;AACA;;;EACI5F,oBAAoB,CAAC+B,SAArB,CAA+Bme,8BAA/B,GAAgE,UAAU3e,KAAV,EAAiB;IAC7E,IAAIqE,UAAU,GAAG,KAAK3F,SAAL,CAAekE,gBAAf,CAAgC8a,kBAAhC,CAAmD1d,KAAnD,CAAjB;;IACA,IAAI,CAACzB,iBAAiB,CAAC8F,UAAD,CAAlB,IAAkC,CAACyV,KAAK,CAACzV,UAAD,CAA5C,EAA0D;MACtD,IAAI,KAAKtF,2BAAT,EAAsC;QAClC,KAAKU,kBAAL,GAA0B,KAAKV,2BAA/B;MACH,CAFD,MAGK;QACD,KAAKU,kBAAL,GAA0B,IAA1B;MACH;;MACD,KAAK0Y,+BAAL,CAAqC9T,UAArC;MACA,IAAIua,WAAW,GAAG,KAAKre,aAAL,CAAmBiF,UAAnB,CAA8B,uBAAuBnB,UAArD,CAAlB;MACA,KAAKsZ,8BAAL,GATsD,CAUtD;;MACA,IAAI3Y,YAAY,GAAG,KAAK4Y,0BAAL,CAAgC5d,KAAK,CAAC6e,OAAN,CAAc,CAAd,EAAiB3c,OAAjD,EAA0DlC,KAAK,CAAC6e,OAAN,CAAc,CAAd,EAAiB1c,OAA3E,EAAoFkC,UAApF,EAAgGua,WAAhG,CAAnB;;MACA,IAAI5Z,YAAJ,EAAkB;QACd,IAAIwE,MAAM,GAAG,KAAb;;QACA,IAAIxE,YAAY,CAAC+G,kBAAb,IAAmC/G,YAAY,CAAC+G,kBAAb,CAAgCvC,MAAvE,EAA+E;UAC3EA,MAAM,GAAGxE,YAAY,CAAC+G,kBAAb,CAAgCvC,MAAzC;QACH;;QACD,IAAI,CAACA,MAAL,EAAa;UACT,IAAIqU,oBAAoB,GAAGe,WAAW,CAACrP,aAAZ,CAA0BvN,qBAA1B,EAA3B;UACA,IAAI8b,iBAAiB,GAAG9d,KAAK,CAAC6e,OAAN,CAAc,CAAd,EAAiB3c,OAAjB,GAA2B2b,oBAAoB,CAACrc,IAAxE;UACA,IAAIuc,gBAAgB,GAAG/d,KAAK,CAAC6e,OAAN,CAAc,CAAd,EAAiB1c,OAAjB,GAA2B0b,oBAAoB,CAACtc,GAAvE;UACA,KAAKzB,uBAAL,GAA+B;YAAE+B,CAAC,EAAEic,iBAAL;YAAwBhc,CAAC,EAAEic;UAA3B,CAA/B;UACA,KAAKC,gBAAL,CAAsBhZ,YAAtB,EAAoC4Z,WAApC,EAAiDva,UAAjD,EAA6DrE,KAA7D;;UACA,IAAI1B,OAAO,CAAC6T,QAAR,IAAoB,CAAC,KAAKzT,SAAL,CAAe0T,iBAApC,IAAyD,KAAK1T,SAAL,CAAe2T,aAAxE,IAAyF,KAAK3T,SAAL,CAAe4T,uBAA5G,EAAqI;YACjI,KAAK5T,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqDC,mBAArD,CAAyE,KAAK1T,2BAAL,CAAiCiL,wBAA1G;UACH;;UACD,KAAKjL,2BAAL,GAAmCiG,YAAnC;UACA,KAAKlG,2BAAL,GAAmCuF,UAAnC;UACA,KAAK6T,8BAAL,CAAoC,IAApC,EAXS,CAYT;;UACA,IAAIgG,eAAe,GAAGlX,QAAQ,CAACC,cAAT,CAAwB,KAAKvI,SAAL,CAAekC,OAAf,CAAuBD,EAAvB,GAA4B,qBAA5B,IAAqD0D,UAAU,GAAG,CAAlE,CAAxB,CAAtB;;UACA,IAAI6Z,eAAJ,EAAqB;YACjBA,eAAe,CAACC,aAAhB,CAA8B,CAA9B,EAAiCC,UAAjC,CAA4C,IAA5C;UACH,CAhBQ,CAiBT;;;UACA,IAAItT,QAAQ,GAAG9D,QAAQ,CAACC,cAAT,CAAwBjC,YAAY,CAACR,SAArC,CAAf;;UACA,IAAIsG,QAAJ,EAAc;YACV,IAAI,CAACxM,OAAO,CAAC6T,QAAb,EAAuB;cACnBrH,QAAQ,CAACuT,UAAT,CAAoBC,KAApB;YACH;UACJ;QACJ;MACJ,CA9BD,MA+BK;QACD,KAAKhH,sBAAL;MACH;;MACD,KAAKa,+BAAL,CAAqC9T,UAArC;IACH,CA/CD,MAgDK,IAAI,KAAKvF,2BAAL,IAAoC,IAApC,IAA6CR,OAAO,CAAC6T,QAAR,IAAoB,CAAC,KAAKzT,SAAL,CAAe0T,iBAArF,EAAyG;MAC1G,IAAI0M,MAAM,GAAG,KAAKhgB,2BAAlB;MACA,KAAKA,2BAAL,GAAmC,IAAnC;MACA,KAAKyZ,wBAAL,CAA8BuG,MAA9B;IACH,CAJI,MAKA;MACD,KAAKxH,sBAAL;MACA,KAAKa,+BAAL,CAAqC9T,UAArC;IACH;EACJ,CA3DD;EA4DA;AACJ;AACA;;;EACI5F,oBAAoB,CAAC+B,SAArB,CAA+Bmd,8BAA/B,GAAgE,YAAY;IACxE,IAAI,KAAK5e,2BAAT,EAAsC;MAClC,KAAKwZ,wBAAL,CAA8B,KAAKzZ,2BAAnC,EADkC,CAElC;;MACA,IAAIkG,YAAY,GAAG,KAAKjG,2BAAxB;MACA,KAAKL,SAAL,CAAeqgB,sBAAf,CAAsC/Z,YAAY,CAACR,SAAnD,EAA8DQ,YAAY,CAACX,UAA3E,EAAuFW,YAAvF;MACA,KAAKsS,sBAAL;IACH;EACJ,CARD;EASA;AACJ;AACA;AACA;;;EACI7Y,oBAAoB,CAAC+B,SAArB,CAA+Bwe,+BAA/B,GAAiE,UAAUhf,KAAV,EAAiB;IAC9E,IAAIif,WAAW,GAAGjf,KAAK,CAAC4B,MAAxB,CAD8E,CAE9E;;IACA,IAAI+L,SAAS,GAAGzH,QAAQ,CAAC+Y,WAAW,CAACte,EAAZ,CAAeiY,KAAf,CAAqB,QAArB,EAA+B,CAA/B,CAAD,CAAR,IAA+C1S,QAAQ,CAAC+Y,WAAW,CAACte,EAAZ,CAAeiY,KAAf,CAAqB,aAArB,EAAoC,CAApC,CAAD,CAAvD,IAAmG1S,QAAQ,CAAC+Y,WAAW,CAACte,EAAZ,CAAeiY,KAAf,CAAqB,oBAArB,EAA2C,CAA3C,CAAD,CAA3H;;IACA,IAAI5Y,KAAK,CAAC4B,MAAN,KAAiBqd,WAAW,CAACte,EAAZ,CAAeoc,OAAf,CAAuB,OAAvB,IAAkC,CAAC,CAAnC,IAAwCkC,WAAW,CAACte,EAAZ,CAAeoc,OAAf,CAAuB,mBAAvB,IAA8C,CAAC,CAAvF,IAA4FkC,WAAW,CAAC7c,SAAZ,CAAsBC,QAAtB,CAA+B,gBAA/B,CAA7G,KAAkK,KAAK3D,SAAL,CAAegF,UAArL,EAAiM;MAC7LiK,SAAS,GAAG,KAAKjP,SAAL,CAAegF,UAAf,CAA0Bga,kBAA1B,CAA6C1d,KAA7C,CAAZ;MACA,IAAIyH,MAAM,GAAG,KAAKlH,aAAL,CAAmBiF,UAAnB,CAA8B,uBAAuBmI,SAArD,CAAb;MACA,IAAI3I,YAAY,GAAG,KAAK4Y,0BAAL,CAAgC5d,KAAK,CAACkC,OAAtC,EAA+ClC,KAAK,CAACmC,OAArD,EAA8DwL,SAA9D,EAAyElG,MAAzE,CAAnB;;MACA,IAAIzC,YAAJ,EAAkB;QACdia,WAAW,CAACne,KAAZ,CAAkBoe,MAAlB,GAA2B,SAA3B,CADc,CAEd;;QACA,IAAIC,eAAe,GAAG,KAAK5e,aAAL,CAAmB6e,gBAAnB,CAAoCpf,KAApC,CAAtB,CAHc,CAId;;QACA,IAAIqf,gBAAgB,GAAG,KAAK9e,aAAL,CAAmB8e,gBAAnB,CAAoCrf,KAApC,CAAvB,CALc,CAMd;;QACA,IAAIsf,eAAe,GAAG;UAAE9d,IAAI,EAAE6d,gBAAgB,CAACxd,CAAzB;UAA4BN,GAAG,EAAE8d,gBAAgB,CAACvd;QAAlD,CAAtB,CAPc,CAQd;;QACA,IAAIyd,cAAc,GAAG;UAAE/d,IAAI,EAAE2d,eAAe,CAACtd,CAAxB;UAA2BN,GAAG,EAAE4d,eAAe,CAACrd;QAAhD,CAArB,CATc,CAUd;;QACA,IAAIiK,kBAAkB,GAAG;UAAE5B,OAAO,EAAEnF,YAAY,CAACmF,OAAxB;UAAiCF,KAAK,EAAEjF,YAAY,CAACiF,KAArD;UAA4DI,MAAM,EAAErF,YAAY,CAACqF,MAAjF;UAAyFC,OAAO,EAAEtF,YAAY,CAACsF,OAA/G;UAAwHC,YAAY,EAAEvF,YAAY,CAACuF;QAAnJ,CAAzB,CAXc,CAYd;;QACA,KAAKhK,aAAL,CAAmBif,YAAnB,GAAkC,IAAlC;QACA,KAAK9gB,SAAL,CAAe+gB,uBAAf,CAAuCza,YAAY,CAACR,SAApD,EAA+DQ,YAAY,CAACX,UAA5E,EAAwFW,YAAY,CAACgF,wBAArG,EAA+HhF,YAAY,CAACnB,MAA5I,EAAoJkI,kBAApJ,EAAwKwT,cAAxK,EAAwLD,eAAxL,EAdc,CAed;MACH,CAhBD,MAiBK;QACD,KAAK5gB,SAAL,CAAekE,gBAAf,CAAgC8c,aAAhC;;QACA,IAAI,KAAKnf,aAAL,CAAmBof,SAAnB,IAAgC,CAAC,KAAKpf,aAAL,CAAmBqf,uBAAnB,EAArC,EAAmF;UAC/EX,WAAW,CAACne,KAAZ,CAAkBoe,MAAlB,GAA2B,MAA3B;QACH;;QACD,IAAI,KAAK3e,aAAL,CAAmBif,YAAnB,IAAmC,CAAC,KAAKjf,aAAL,CAAmBsf,qBAA3D,EAAkF;UAC9E,KAAKnhB,SAAL,CAAeohB,wBAAf,CAAwCnS,SAAxC;UACA,KAAKpN,aAAL,CAAmBif,YAAnB,GAAkC,KAAlC;QACH;MACJ;IACJ;EACJ,CApCD,CAjkEkD,CAsmElD;;;EACA/gB,oBAAoB,CAAC+B,SAArB,CAA+Buf,aAA/B,GAA+C,UAAU/f,KAAV,EAAiB0D,UAAjB,EAA6B;IACxE,IAAIA,UAAU,CAAC+G,IAAf,EAAqB;MACjB;MACA,KAAK/L,SAAL,CAAekE,gBAAf,CAAgCmd,aAAhC,CAA8C/f,KAA9C,EAAqD0D,UAAU,CAACuG,KAAhE,EAAuEvG,UAAU,CAAC2G,MAAlF,EAA0F3G,UAAU,CAAC+G,IAArG,EAA2G/G,UAAU,CAACsG,wBAAtH;IACH;EACJ,CALD;;EAMAvL,oBAAoB,CAAC+B,SAArB,CAA+Bod,0BAA/B,GAA4D,UAAU1b,OAAV,EAAmBC,OAAnB,EAA4BkC,UAA5B,EAAwCoD,MAAxC,EAAgD;IACxG,IAAIuY,4BAA4B,GAAG,EAAnC;;IACA,IAAIvY,MAAJ,EAAY;MACR,IAAIoW,oBAAoB,GAAGpW,MAAM,CAAC8H,aAAP,CAAqBvN,qBAArB,EAA3B;;MACA,IAAIyF,MAAM,CAACwY,WAAP,KAAuBxY,MAAM,CAAC8H,aAAP,CAAqB0Q,WAAhD,EAA6D;QACzDpC,oBAAoB,GAAGpW,MAAM,CAACzF,qBAAP,EAAvB;MACH;;MACD,IAAI8b,iBAAiB,GAAG5b,OAAO,GAAG2b,oBAAoB,CAACrc,IAAvD;MACA,IAAIuc,gBAAgB,GAAG5b,OAAO,GAAG0b,oBAAoB,CAACtc,GAAtD;MACA,IAAI4C,cAAc,GAAG,KAAKC,cAAL,CAAoBC,UAApB,EAAgC,IAAhC,CAArB;MACA,IAAI6b,eAAe,GAAG,KAAtB;;MACA,IAAI/b,cAAJ,EAAoB;QAChB,KAAK,IAAI+D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG/D,cAAc,CAACI,MAAnC,EAA2C2D,CAAC,EAA5C,EAAgD;UAC5C,IAAIxE,UAAU,GAAGS,cAAc,CAAC+D,CAAD,CAA/B;;UACA,KAAK,IAAIpD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGpB,UAAU,CAACG,MAAX,CAAkBU,MAAtC,EAA8CO,CAAC,EAA/C,EAAmD;YAC/C;YACA,IAAII,KAAK,GAAGxB,UAAU,CAACG,MAAX,CAAkBiB,CAAlB,CAAZ;YACA,IAAItD,IAAI,GAAG0D,KAAK,CAAC1D,IAAN,GAAa0D,KAAK,CAAC1D,IAAnB,GAA0B0D,KAAK,CAACC,IAA3C;YACA,IAAIgb,KAAK,GAAGjb,KAAK,CAAC3D,GAAN,GAAY2D,KAAK,CAAC3D,GAAlB,GAAwB2D,KAAK,CAACE,GAA1C;YACA,IAAI9B,KAAK,GAAG4B,KAAK,CAAC5B,KAAN,GAAc4B,KAAK,CAAC5B,KAApB,GAA4B4B,KAAK,CAACG,KAA9C;YACA,IAAI7B,MAAM,GAAG0B,KAAK,CAAC1B,MAAN,GAAe0B,KAAK,CAAC1B,MAArB,GAA8B0B,KAAK,CAACI,MAAjD,CAN+C,CAO/C;;YACA,IAAIwY,iBAAiB,IAAI,KAAKhP,iBAAL,CAAuBtN,IAAvB,EAA6B,KAAKjB,aAAL,CAAmBgD,aAAnB,EAA7B,CAArB,IAAyFua,iBAAiB,IAAI,KAAKhP,iBAAL,CAAuBtN,IAAI,GAAG8B,KAA9B,EAAqC,KAAK/C,aAAL,CAAmBgD,aAAnB,EAArC,CAA9G,IAA0Lwa,gBAAgB,IAAI,KAAKjP,iBAAL,CAAuBqR,KAAvB,EAA8B,KAAK5f,aAAL,CAAmBgD,aAAnB,EAA9B,CAA9M,IAAmRwa,gBAAgB,IAAI,KAAKjP,iBAAL,CAAuBqR,KAAK,GAAG3c,MAA/B,EAAuC,KAAKjD,aAAL,CAAmBgD,aAAnB,EAAvC,CAA3S,EAAuX;cACnXyc,4BAA4B,CAACjX,IAA7B,CAAkCrF,UAAlC;cACAwc,eAAe,GAAG,IAAlB;YACH,CAHD,MAIK;cACD,IAAIA,eAAJ,EAAqB;gBACjBA,eAAe,GAAG,KAAlB;gBACA;cACH;YACJ;UACJ;QACJ;MACJ;;MACD,IAAIlb,YAAY,GAAG,IAAnB;;MACA,IAAIgb,4BAA4B,CAACzb,MAA7B,GAAsC,CAA1C,EAA6C;QACzCS,YAAY,GAAG,KAAKob,yBAAL,CAA+BJ,4BAA/B,CAAf;MACH,CAFD,MAGK,IAAIA,4BAA4B,CAACzb,MAA7B,KAAwC,CAA5C,EAA+C;QAChDS,YAAY,GAAGgb,4BAA4B,CAAC,CAAD,CAA3C;MACH;;MACD,OAAOhb,YAAP;IACH,CAzCD,MA0CK;MACD,OAAO,IAAP;IACH;EACJ,CA/CD;;EAgDAvG,oBAAoB,CAAC+B,SAArB,CAA+B4f,yBAA/B,GAA2D,UAAUnY,WAAV,EAAuB;IAC9E,IAAIoY,SAAJ;IACA,IAAIC,iBAAiB,GAAG,IAAxB;;IACA,KAAK,IAAIpY,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,WAAW,CAAC1D,MAAhC,EAAwC2D,CAAC,EAAzC,EAA6C;MACzC,IAAIA,CAAC,KAAKD,WAAW,CAAC1D,MAAZ,GAAqB,CAA/B,EAAkC;QAC9B;MACH,CAHwC,CAIzC;;;MACA,IAAIgc,gBAAgB,GAAGtY,WAAW,CAACC,CAAD,CAAX,CAAerE,MAAtC;MACA,IAAI2c,cAAc,GAAGD,gBAAgB,CAAC,CAAD,CAAhB,CAAoB/e,IAApB,GAA2B+e,gBAAgB,CAAC,CAAD,CAAhB,CAAoB/e,IAA/C,GAAsD+e,gBAAgB,CAAC,CAAD,CAAhB,CAAoBpb,IAA/F;MACA,IAAIsb,cAAc,GAAGF,gBAAgB,CAAC,CAAD,CAAhB,CAAoBhf,GAApB,GAA0Bgf,gBAAgB,CAAC,CAAD,CAAhB,CAAoBhf,GAA9C,GAAoDgf,gBAAgB,CAAC,CAAD,CAAhB,CAAoBnb,GAA7F,CAPyC,CAQzC;;MACA,IAAIsb,iBAAiB,GAAGzY,WAAW,CAACC,CAAC,GAAG,CAAL,CAAX,CAAmBrE,MAA3C;MACA,IAAI8c,eAAe,GAAGD,iBAAiB,CAAC,CAAD,CAAjB,CAAqBlf,IAArB,GAA4Bkf,iBAAiB,CAAC,CAAD,CAAjB,CAAqBlf,IAAjD,GAAwDkf,iBAAiB,CAAC,CAAD,CAAjB,CAAqBvb,IAAnG;MACA,IAAIyb,eAAe,GAAGF,iBAAiB,CAAC,CAAD,CAAjB,CAAqBnf,GAArB,GAA2Bmf,iBAAiB,CAAC,CAAD,CAAjB,CAAqBnf,GAAhD,GAAsDmf,iBAAiB,CAAC,CAAD,CAAjB,CAAqBtb,GAAjG;;MACA,IAAKob,cAAc,GAAGG,eAAlB,IAAuCF,cAAc,GAAGG,eAA5D,EAA8E;QAC1EP,SAAS,GAAGM,eAAZ;QACAL,iBAAiB,GAAGrY,WAAW,CAACC,CAAC,GAAG,CAAL,CAA/B;MACH,CAHD,MAIK;QACDmY,SAAS,GAAGG,cAAZ;QACAF,iBAAiB,GAAGrY,WAAW,CAACC,CAAD,CAA/B;MACH;;MACD,IAAImY,SAAS,IAAKnY,CAAC,KAAMD,WAAW,CAAC1D,MAAZ,GAAqB,CAA9C,EAAmD;QAC/C,IAAK8b,SAAS,KAAKG,cAAf,IAAmCH,SAAS,KAAKM,eAArD,EAAuE;UACnEN,SAAS,GAAGM,eAAZ;UACAL,iBAAiB,GAAGrY,WAAW,CAACC,CAAC,GAAG,CAAL,CAA/B;QACH;MACJ;IACJ;;IACD,OAAOoY,iBAAP;EACH,CA/BD;EAgCA;AACJ;AACA;AACA;;;EACI7hB,oBAAoB,CAAC+B,SAArB,CAA+B+X,wBAA/B,GAA0D,UAAUlU,UAAV,EAAsB;IAC5E,IAAIoD,MAAM,GAAG,KAAKlH,aAAL,CAAmBiF,UAAnB,CAA8B,uBAAuBnB,UAArD,CAAb;;IACA,IAAIoD,MAAJ,EAAY;MACR,IAAII,OAAO,GAAGJ,MAAM,CAACK,UAAP,CAAkB,IAAlB,CAAd;MACAD,OAAO,CAACG,WAAR,CAAoB,EAApB;MACA,KAAKtJ,SAAL,CAAekE,gBAAf,CAAgCoN,iBAAhC,CAAkD3L,UAAlD,EAA8D,IAA9D,EAAoE,IAApE,EAA0E,IAA1E;IACH;EACJ,CAPD;EAQA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI;;;EACA5F,oBAAoB,CAAC+B,SAArB,CAA+Bwd,gBAA/B,GAAkD,UAAUta,UAAV,EAAsB+D,MAAtB,EAA8BpD,UAA9B,EAA0CrE,KAA1C,EAAiD6gB,uBAAjD,EAA0E;IACxH,IAAI,KAAKniB,SAAL,CAAeoiB,aAAf,CAA6B7Y,WAA7B,CAAyC,CAAzC,CAAJ,EAAiD;MAC7C,KAAKvJ,SAAL,CAAeqiB,cAAf,CAA8B,KAAKriB,SAAL,CAAeoiB,aAAf,CAA6B7Y,WAA7B,CAAyC,CAAzC,EAA4C0F,SAA1E;MACA,KAAKjP,SAAL,CAAeqiB,cAAf,CAA8B,KAAKjiB,2BAAnC;IACH;;IACD,IAAI0K,MAAM,GAAG,KAAb;;IACA,IAAI9F,UAAU,CAACqI,kBAAX,IAAiCrI,UAAU,CAACqI,kBAAX,CAA8BvC,MAAnE,EAA2E;MACvEA,MAAM,GAAG9F,UAAU,CAACqI,kBAAX,CAA8BvC,MAAvC;;MACA,IAAIA,MAAM,IAAI,KAAK9K,SAAL,CAAekE,gBAAf,CAAgC2T,wBAAhC,CAAyD,QAAzD,EAAmE7S,UAAnE,CAAd,EAA8F;QAC1F8F,MAAM,GAAG,KAAT;MACH;IACJ;;IACD,IAAI,CAACA,MAAL,EAAa;MACT,IAAIwX,mBAAmB,GAAG,KAA1B;;MACA,IAAI,CAAC,KAAKjiB,2BAAV,EAAuC;QACnCiiB,mBAAmB,GAAG,IAAtB;MACH;;MACD,IAAI,KAAKvhB,kBAAL,IAA2BiE,UAA3B,IAAyC,CAACmd,uBAA9C,EAAuE;QACnE,IAAI,KAAKphB,kBAAL,CAAwB+E,SAAxB,KAAsCd,UAAU,CAACc,SAArD,EAAgE;UAC5Dwc,mBAAmB,GAAG,KAAtB;QACH,CAFD,MAGK;UACDA,mBAAmB,GAAG,IAAtB;QACH;MACJ;;MACD,IAAI,CAAClH,KAAK,CAACzV,UAAD,CAAV,EAAwB;QACpB,KAAKvF,2BAAL,GAAmCuF,UAAnC;QACA,KAAKtF,2BAAL,GAAmC2E,UAAnC;QACAA,UAAU,GAAG,KAAKgP,iBAAL,CAAuBhP,UAAvB,CAAb;QACA,KAAK3E,2BAAL,GAAmC2E,UAAnC;MACH;;MACD,IAAI,KAAK9D,oBAAL,IAA6B,KAAKlB,SAAL,CAAeuB,mBAAhD,EAAqE;QACjE,KAAKM,aAAL,CAAmB+N,WAAnB,GAAiC,IAAjC;QACA,KAAK7K,sBAAL;MACH,CAtBQ,CAuBT;;;MACA,IAAIwd,YAAY,GAAGjhB,KAAnB;;MACA,IAAI,KAAK+C,yBAAL,CAA+BW,UAAU,CAACsG,wBAA1C,KAAuEtG,UAAvE,IAAqFud,YAArF,IAAqG,CAACA,YAAY,CAACpC,OAAvH,EAAgI;QAC5H,KAAKqC,4BAAL,CAAkCxd,UAAlC;MACH;;MACD,KAAKiL,sBAAL,CAA4BjL,UAA5B,EAAwC,KAAK3E,2BAA7C,EAA0E0I,MAA1E;;MACA,IAAI/D,UAAU,CAACC,aAAX,IAA4BD,UAAU,CAACqB,mBAA3C,EAAgE;QAC5D,KAAKgK,0BAAL,CAAgCrL,UAAhC;MACH;;MACD,IAAIA,UAAU,CAACc,SAAX,KAAyB,EAAzB,IAA+B,CAAC,KAAKhF,eAAzC,EAA0D;QACtD,IAAIwhB,mBAAJ,EAAyB;UACrB,IAAIta,UAAU,GAAG,KAAjB;;UACA,IAAI,CAACua,YAAL,EAAmB;YACfva,UAAU,GAAG,IAAb;UACH,CAJoB,CAKrB;;;UACA,KAAKhI,SAAL,CAAekE,gBAAf,CAAgCue,gBAAhC,CAAiDzd,UAAU,CAACc,SAA5D,EAAuE,KAAK1F,2BAA5E,EAAyG4E,UAAzG,EAAqH,IAArH,EAA2H,KAA3H,EAAkIgD,UAAlI;UACA,KAAKjH,kBAAL,GAA0B,IAA1B;QACH;MACJ;;MACD,IAAIiE,UAAU,IAAI,KAAKX,yBAAL,CAA+BW,UAAU,CAACsG,wBAA1C,CAAlB,EAAuF;QACnF,KAAKoD,0BAAL,GAAkC,IAAlC;MACH;IACJ;EACJ,CA3DD;EA4DA;AACJ;AACA;AACA;EACI;;;EACA3O,oBAAoB,CAAC+B,SAArB,CAA+B0gB,4BAA/B,GAA8D,UAAUxd,UAAV,EAAsB;IAChF,IAAI,CAACA,UAAL,EAAiB;MACbA,UAAU,GAAG,KAAK3E,2BAAlB;IACH;;IACD,IAAI2E,UAAJ,EAAgB;MACZ,IAAI,KAAKX,yBAAL,CAA+BW,UAAU,CAACsG,wBAA1C,KAAuEtG,UAA3E,EAAuF;QACnF;QACA,IAAIgY,WAAW,GAAG,KAAKnb,aAAL,CAAmBiF,UAAnB,CAA8B,gBAAgB,KAAK1G,2BAAnD,CAAlB;;QACA,IAAI4c,WAAJ,EAAiB;UACb;UACA,IAAIlV,YAAY,GAAGkV,WAAW,CAAC1Z,qBAAZ,EAAnB;UACA,IAAIR,IAAI,GAAGkC,UAAU,CAACG,MAAX,CAAkB,CAAlB,EAAqBrC,IAArB,GAA4BkC,UAAU,CAACG,MAAX,CAAkB,CAAlB,EAAqBrC,IAAjD,GAAwDkC,UAAU,CAACG,MAAX,CAAkB,CAAlB,EAAqBsB,IAAxF;UACA,IAAIic,KAAK,GAAG1d,UAAU,CAACG,MAAX,CAAkB,CAAlB,EAAqBtC,GAArB,GAA2BmC,UAAU,CAACG,MAAX,CAAkB,CAAlB,EAAqBtC,GAAhD,GAAsDmC,UAAU,CAACG,MAAX,CAAkB,CAAlB,EAAqBuB,GAAvF;UACA,KAAK7C,kBAAL,CAAwBf,IAAI,GAAG,KAAKjB,aAAL,CAAmBgD,aAAnB,EAAP,GAA4CiD,YAAY,CAAChF,IAAjF,EAAwFgF,YAAY,CAACjF,GAAb,GAAmB6f,KAA3G,EAAmH,IAAnH,EALa,CAMb;;UACA,IAAIC,WAAW,GAAG3d,UAAU,CAACG,MAAX,CAAkBH,UAAU,CAACG,MAAX,CAAkBU,MAAlB,GAA2B,CAA7C,CAAlB;UACA,IAAI+c,OAAO,GAAGD,WAAW,CAAC7f,IAAZ,GAAmB6f,WAAW,CAAC7f,IAA/B,GAAsC6f,WAAW,CAAClc,IAAhE;UACA,IAAIoc,MAAM,GAAGF,WAAW,CAAC9f,GAAZ,GAAkB8f,WAAW,CAAC9f,GAA9B,GAAoC8f,WAAW,CAACjc,GAA7D;UACA,IAAIoc,QAAQ,GAAGH,WAAW,CAAC/d,KAAZ,GAAoB+d,WAAW,CAAC/d,KAAhC,GAAwC+d,WAAW,CAAChc,KAAnE,CAVa,CAWb;;UACA,KAAK7C,cAAL,CAAoB,CAAC8e,OAAO,GAAGE,QAAX,IAAuB,KAAKjhB,aAAL,CAAmBgD,aAAnB,EAAvB,GAA4DiD,YAAY,CAAChF,IAA7F,EAAoG+f,MAAM,GAAG/a,YAAY,CAACjF,GAA1H,EAAgI,IAAhI;QACH;MACJ;IACJ;EACJ,CAxBD,CAxxEkD,CAizElD;;;EACA9C,oBAAoB,CAAC+B,SAArB,CAA+BqO,wBAA/B,GAA0D,UAAUpH,MAAV,EAAkB5F,CAAlB,EAAqBC,CAArB,EAAwBwB,KAAxB,EAA+BE,MAA/B,EAAuCE,UAAvC,EAAmD;IACzG,IAAI+d,KAAK,GAAG,KAAKlhB,aAAL,CAAmBqS,YAAnB,EAAZ;;IACA,IAAInL,MAAJ,EAAY;MACR,IAAII,OAAO,GAAGJ,MAAM,CAACK,UAAP,CAAkB,IAAlB,CAAd;MACAD,OAAO,CAACE,YAAR,CAAqB,CAArB,EAAwB,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B,EAAiC,CAAjC,EAAoC,CAApC;MACAF,OAAO,CAACgL,SAAR;;MACA,IAAI,OAAQnP,UAAD,CAAaiI,0BAApB,KAAmD,QAAvD,EAAiE;QAC7D;QACA,IAAI+V,QAAQ,GAAG1Q,IAAI,CAAC8E,KAAL,CAAWpS,UAAU,CAACiI,0BAAtB,EAAkDgW,qBAAlD,CAAwEpd,MAAxE,KAAmF,CAAnF,GAAuF,CAAC,CAAD,CAAvF,GAA6FyM,IAAI,CAAC8E,KAAL,CAAWpS,UAAU,CAACiI,0BAAtB,EAAkDgW,qBAA9J;;QACA,IAAID,QAAQ,CAACnd,MAAT,GAAkB,CAAtB,EAAyB;UACrBmd,QAAQ,GAAG,CAACA,QAAQ,CAAC,CAAD,CAAT,EAAcA,QAAQ,CAAC,CAAD,CAAtB,CAAX;QACH;;QACD7Z,OAAO,CAACG,WAAR,CAAoB0Z,QAApB;QACA7Z,OAAO,CAACiL,WAAR,GAAsB,CAAtB;QACAjL,OAAO,CAAC8C,IAAR,CAAa9I,CAAC,GAAG4f,KAAjB,EAAwB3f,CAAC,GAAG2f,KAA5B,EAAmCne,KAAK,GAAGme,KAA3C,EAAkDje,MAAM,GAAGie,KAA3D;QACA5Z,OAAO,CAACkL,SAAR,GAT6D,CAU7D;;QACA,IAAI6O,WAAW,GAAG5Q,IAAI,CAAC8E,KAAL,CAAWpS,UAAU,CAACiI,0BAAtB,EAAkDkW,oBAAlD,KAA2E,EAA3E,GAAgF,SAAhF,GAA4F7Q,IAAI,CAAC8E,KAAL,CAAWpS,UAAU,CAACiI,0BAAtB,EAAkDkW,oBAAhK;QACAha,OAAO,CAACgM,WAAR,GAAsB+N,WAAtB,CAZ6D,CAa7D;;QACA/Z,OAAO,CAAC+L,SAAR,GAAoB5C,IAAI,CAAC8E,KAAL,CAAWpS,UAAU,CAACiI,0BAAtB,EAAkDmW,wBAAlD,KAA+E,CAA/E,GAAmF,CAAnF,GAAwFpe,UAAU,CAACiI,0BAAZ,CAAwCmW,wBAAnJ;QACAja,OAAO,CAACiM,MAAR;QACAjM,OAAO,CAACsL,IAAR;MACH,CAjBD,MAkBK;QACD;QACA,IAAIuO,QAAQ,GAAIhe,UAAU,CAACiI,0BAAZ,CAAwCgW,qBAAxC,CAA8Dpd,MAA9D,KAAyE,CAAzE,GAA6E,CAAC,CAAD,CAA7E,GAAoFb,UAAU,CAACiI,0BAAZ,CAAwCgW,qBAA1I;;QACA,IAAID,QAAQ,CAACnd,MAAT,GAAkB,CAAtB,EAAyB;UACrBmd,QAAQ,GAAG,CAACA,QAAQ,CAAC,CAAD,CAAT,EAAcA,QAAQ,CAAC,CAAD,CAAtB,CAAX;QACH;;QACD7Z,OAAO,CAACG,WAAR,CAAoB0Z,QAApB;QACA7Z,OAAO,CAACiL,WAAR,GAAsB,CAAtB;QACAjL,OAAO,CAAC8C,IAAR,CAAa9I,CAAC,GAAG4f,KAAjB,EAAwB3f,CAAC,GAAG2f,KAA5B,EAAmCne,KAAK,GAAGme,KAA3C,EAAkDje,MAAM,GAAGie,KAA3D;QACA5Z,OAAO,CAACkL,SAAR,GATC,CAUD;;QACA,IAAI6O,WAAW,GAAIle,UAAU,CAACiI,0BAAZ,CAAwCkW,oBAAxC,KAAiE,EAAjE,GAAsE,SAAtE,GAAmFne,UAAU,CAACiI,0BAAZ,CAAwCkW,oBAA5I;QACAha,OAAO,CAACgM,WAAR,GAAsB+N,WAAtB,CAZC,CAaD;;QACA/Z,OAAO,CAAC+L,SAAR,GAAqBlQ,UAAU,CAACiI,0BAAZ,CAAwCmW,wBAAxC,GAAmE,CAAnE,GAAwEpe,UAAU,CAACiI,0BAAZ,CAAwCmW,wBAAnI;QACAja,OAAO,CAACiM,MAAR;QACAjM,OAAO,CAACsL,IAAR;MACH;IACJ;EACJ,CA3CD;EA4CA;AACJ;AACA;AACA;;;EACI1U,oBAAoB,CAAC+B,SAArB,CAA+B0X,8BAA/B,GAAgE,UAAU6J,QAAV,EAAoB;IAChF,IAAI,KAAKrjB,SAAL,CAAe6T,aAAf,IAAgC,KAAK7T,SAAL,CAAe6T,aAAf,CAA6BC,uBAAjE,EAA0F;MACtF;MACA,KAAK9T,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqDwP,4BAArD,GAAoF,KAAKtjB,SAAL,CAAekC,OAAf,CAAuBqhB,aAAvB,CAAqC,kCAArC,CAApF;IACH,CAJ+E,CAKhF;;;IACA,IAAI,KAAKvjB,SAAL,CAAe6T,aAAf,IAAgC,KAAK7T,SAAL,CAAe6T,aAAf,CAA6BC,uBAAjE,EAA0F;MACtF,IAAI,CAAClU,OAAO,CAAC6T,QAAb,EAAuB;QACnB,KAAKzT,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqD0P,6BAArD,CAAmFH,QAAnF;MACH;IACJ,CAV+E,CAWhF;;;IACA,IAAI,KAAKrjB,SAAL,CAAe6T,aAAf,IAAgC,KAAK7T,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7D,IAAwF,KAAK9T,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqD2P,oBAA7I,IAAqK,KAAKzjB,SAAL,CAAeoiB,aAAf,CAA6B7Y,WAA7B,CAAyC1D,MAAzC,KAAoD,CAA7N,EAAgO;MAC5N,IAAI,KAAK7F,SAAL,CAAe6T,aAAf,CAA6BC,uBAAjC,EAA0D;QACtD,KAAK9T,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqD4P,0BAArD,CAAgFL,QAAhF;QACA,IAAIM,MAAM,GAAGN,QAAb;;QACA,IAAI,KAAK3U,0BAAT,EAAqC;UACjCiV,MAAM,GAAG,IAAT;QACH;;QACD,KAAK3jB,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqD8P,yCAArD,CAA+FD,MAA/F;;QACA,IAAI,KAAKtjB,2BAAT,EAAsC;UAClC,IAAI,CAACP,QAAQ,EAAb,EAAiB;YACb;YACA,KAAKE,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqD+P,iBAArD,CAAuE,KAAK7jB,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqDgQ,oBAA5H,EAAkJ,KAAKzjB,2BAAL,CAAiCkL,KAAnL;UACH,CAHD,MAIK;YACD;YACA,KAAKvL,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqD+P,iBAArD,CAAuE,KAAK7jB,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqDwP,4BAA5H,EAA0J,KAAKjjB,2BAAL,CAAiCkL,KAA3L;UACH;QACJ,CATD,MAUK;UACD,IAAI,CAAC1L,iBAAiB,CAAC,KAAK6O,0BAAN,CAAlB,IAAuD,CAAC,KAAKA,0BAAjE,EAA6F;YACzF,IAAI,CAAC5O,QAAQ,EAAb,EAAiB;cACb;cACA,KAAKE,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqD+P,iBAArD,CAAuE,KAAK7jB,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqDgQ,oBAA5H,EAAkJ,SAAlJ;YACH,CAHD,MAIK;cACD;cACA,KAAK9jB,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqD+P,iBAArD,CAAuE,KAAK7jB,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqDwP,4BAA5H,EAA0J,SAA1J;YACH;UACJ,CATD,MAUK;YACD,KAAKtjB,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqDiQ,uBAArD;UACH;QACJ;MACJ;IACJ;EACJ,CA/CD;EAgDA;AACJ;AACA;;;EACIhkB,oBAAoB,CAAC+B,SAArB,CAA+BuM,2BAA/B,GAA6D,YAAY;IACrE,IAAI,KAAKhO,2BAAT,EAAsC;MAClC,IAAI0I,MAAM,GAAG,KAAKlH,aAAL,CAAmBiF,UAAnB,CAA8B,uBAAuB,KAAK1G,2BAA1D,CAAb;;MACA,IAAI2I,MAAJ,EAAY;QACR,KAAKuW,gBAAL,CAAsB,KAAKjf,2BAA3B,EAAwD0I,MAAxD,EAAgE,KAAK3I,2BAArE;MACH;IACJ;EACJ,CAPD,CAr5EkD,CA65ElD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EACA;AACJ;AACA;AACA;AACA;;;EACIL,oBAAoB,CAAC+B,SAArB,CAA+BoP,iBAA/B,GAAmD,UAAUmB,eAAV,EAA2B1M,UAA3B,EAAuC;IACtF;IACA,IAAIqe,WAAW,GAAG3e,MAAM,CAACsR,cAAP,CAAsBC,OAAtB,CAA8B,KAAK/U,aAAL,CAAmBgV,UAAnB,GAAgC,yBAA9D,CAAlB;;IACA,IAAI,KAAKhV,aAAL,CAAmBiV,eAAvB,EAAwC;MACpCkN,WAAW,GAAG,KAAKniB,aAAL,CAAmBkV,iBAAnB,CAAqC,KAAKlV,aAAL,CAAmBgV,UAAnB,GAAgC,yBAArE,CAAd;IACH;;IACD,IAAImN,WAAJ,EAAiB;MACb,IAAIC,WAAW,GAAG3R,IAAI,CAAC8E,KAAL,CAAW4M,WAAX,CAAlB;;MACA,IAAI,CAAC,KAAKniB,aAAL,CAAmBiV,eAAxB,EAAyC;QACrCzR,MAAM,CAACsR,cAAP,CAAsBuN,UAAtB,CAAiC,KAAKriB,aAAL,CAAmBgV,UAAnB,GAAgC,yBAAjE;MACH;;MACD,IAAI/G,KAAK,GAAG,KAAK9P,SAAL,CAAekE,gBAAf,CAAgCigB,iBAAhC,CAAkDF,WAAlD,EAA+Dte,UAA/D,CAAZ;;MACA,IAAIse,WAAW,CAACnU,KAAD,CAAf,EAAwB;QACpBmU,WAAW,CAACnU,KAAD,CAAX,CAAmBvG,WAAnB,GAAiC8I,eAAjC;MACH;;MACD,IAAI+R,qBAAqB,GAAG9R,IAAI,CAACC,SAAL,CAAe0R,WAAf,CAA5B;;MACA,IAAI,KAAKpiB,aAAL,CAAmBiV,eAAvB,EAAwC;QACpC,KAAKjV,aAAL,CAAmBkV,iBAAnB,CAAqC,KAAKlV,aAAL,CAAmBgV,UAAnB,GAAgC,yBAArE,IAAkGuN,qBAAlG;MACH,CAFD,MAGK;QACD/e,MAAM,CAACsR,cAAP,CAAsB0N,OAAtB,CAA8B,KAAKxiB,aAAL,CAAmBgV,UAAnB,GAAgC,yBAA9D,EAAyFuN,qBAAzF;MACH;IACJ;EACJ,CAvBD;EAwBA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI;;;EACArkB,oBAAoB,CAAC+B,SAArB,CAA+B4D,cAA/B,GAAgD,UAAUuJ,SAAV,EAAqBpG,qBAArB,EAA4C5G,EAA5C,EAAgD;IAC5F;IACA,IAAIqiB,oBAAJ,CAF4F,CAG5F;;IACA,IAAIriB,EAAE,IAAI,IAAN,IAAcA,EAAE,IAAIsiB,SAAxB,EAAmC;MAC/BtiB,EAAE,GAAG,yBAAL;IACH,CAN2F,CAO5F;;;IACA,IAAI+hB,WAAW,GAAG3e,MAAM,CAACsR,cAAP,CAAsBC,OAAtB,CAA8B,KAAK/U,aAAL,CAAmBgV,UAAnB,GAAgC5U,EAA9D,CAAlB;;IACA,IAAI,KAAKJ,aAAL,CAAmBiV,eAAvB,EAAwC;MACpCkN,WAAW,GAAG,KAAKniB,aAAL,CAAmBkV,iBAAnB,CAAqC,KAAKlV,aAAL,CAAmBgV,UAAnB,GAAgC5U,EAArE,CAAd;IACH;;IACD,IAAI+hB,WAAJ,EAAiB;MACb,IAAIC,WAAW,GAAG3R,IAAI,CAAC8E,KAAL,CAAW4M,WAAX,CAAlB;MACA,IAAIlU,KAAK,GAAG,KAAK9P,SAAL,CAAekE,gBAAf,CAAgCigB,iBAAhC,CAAkDF,WAAlD,EAA+DhV,SAA/D,CAAZ;;MACA,IAAIgV,WAAW,CAACnU,KAAD,CAAf,EAAwB;QACpBwU,oBAAoB,GAAGL,WAAW,CAACnU,KAAD,CAAX,CAAmBvG,WAA1C;MACH,CAFD,MAGK;QACD+a,oBAAoB,GAAGzb,qBAAvB;MACH;IACJ,CATD,MAUK;MACDyb,oBAAoB,GAAGzb,qBAAvB;IACH;;IACD,OAAOyb,oBAAP;EACH,CA1BD,CAl+EkD,CA6/ElD;EACA;;;EACAvkB,oBAAoB,CAAC+B,SAArB,CAA+ByR,kBAA/B,GAAoD,UAAUtP,IAAV,EAAgBsH,KAAhB,EAAuBE,OAAvB,EAAgCtG,MAAhC,EAAwCwG,MAAxC,EAAgDC,OAAhD,EAAyD4Y,cAAzD,EAAyEzY,IAAzE,EAA+EwB,aAA/E,EAA8FtB,IAA9F,EAAoGtG,UAApG,EAAgH0J,WAAhH,EAA6HC,UAA7H,EAAyIC,QAAzI,EAAmJtK,aAAnJ,EAAkKkG,mBAAlK,EAAuL;IACvO;IACA,IAAIU,YAAY,GAAG2Y,cAAc,GAAGA,cAAH,GAAoB,KAAKxkB,SAAL,CAAegF,UAAf,CAA0B0L,2BAA1B,CAAsDgB,cAAtD,EAArD;IACA,IAAI+S,cAAc,GAAG,KAAKzkB,SAAL,CAAegF,UAAf,CAA0B0f,UAA1B,EAArB;IACA,IAAIC,aAAa,GAAG,KAAK3kB,SAAL,CAAegF,UAAf,CAA0B0L,2BAA1B,CAAsDkU,WAAtD,CAAkE,YAAlE,EAAgFjf,UAAU,GAAG,CAA7F,EAAgG1B,IAAhG,CAApB;;IACA,IAAI0gB,aAAJ,EAAmB;MACfrc,QAAQ,CAACC,cAAT,CAAwBoc,aAAxB,EAAuC1iB,EAAvC,GAA4CwiB,cAA5C;IACH,CAPsO,CAQvO;;;IACA,IAAIpX,kBAAkB,GAAG,KAAKtC,qBAAL,CAA2B9G,IAA3B,CAAzB;IACA,IAAIqJ,OAAO,GAAG,KAAKpC,eAAL,CAAqBjH,IAArB,CAAd;IACA,IAAIe,UAAU,GAAG;MACb;MACAsG,wBAAwB,EAAErH,IAFb;MAEmBsH,KAAK,EAAEA,KAF1B;MAEiCE,OAAO,EAAEA,OAF1C;MAEmDtG,MAAM,EAAEA,MAF3D;MAEmEwG,MAAM,EAAEA,MAF3E;MAEmFR,mBAAmB,EAAEA,mBAFxG;MAE6HS,OAAO,EAAEA,OAFtI;MAE+IC,YAAY,EAAEA,YAF7J;MAE2KE,IAAI,EAAEA,IAFjL;MAEuLE,IAAI,EAAEA,IAF7L;MAGbnG,SAAS,EAAE2e,cAHE;MAGcrY,QAAQ,EAAE,EAHxB;MAG4BG,MAAM,EAAE;QAAEC,KAAK,EAAE,EAAT;QAAaE,UAAU,EAAE,EAAzB;QAA6Bf,MAAM,EAAEA,MAArC;QAA6CE,YAAY,EAAEA;MAA3D,CAHpC;MAG+Ge,mBAAmB,EAAE,YAHpI;MAGkJjH,UAAU,EAAEA,UAH9J;MAIb;MACAkH,iBAAiB,EAAEwC,WALN;MAKmBtC,oBAAoB,EAAEuC,UALzC;MAKqDtC,kBAAkB,EAAEuC,QALzE;MAKmFtK,aAAa,EAAEA,aALlG;MAKiHgI,0BAA0B,EAAE,KAAKuB,WAAL,CAAiBvK,IAAjB,CAL7I;MAMbkJ,UAAU,EAAE,KAAKnN,SAAL,CAAegF,UAAf,CAA0B6f,iBAA1B,CAA4CjZ,OAA5C,CANC;MAMqDrB,iBAAiB,EAAE,KAAKA,iBAN7E;MAMgG8C,kBAAkB,EAAEA,kBANpH;MAMwIC,OAAO,EAAEA,OANjJ;MAM0JC,aAAa,EAAEA,aANzK;MAMwL7D,mBAAmB,EAAE;IAN7M,CAAjB;;IAQA,IAAIzE,aAAJ,EAAmB;MACf,KAAKjE,mBAAL,CAAyBqJ,IAAzB,CAA8BrF,UAA9B;IACH;;IACD,IAAIqU,MAAM,GAAG,KAAb;;IACA,IAAIpU,aAAa,IAAI,KAAKpE,UAA1B,EAAsC;MAClCwY,MAAM,GAAG,IAAT;IACH;;IACD,IAAI/Q,QAAQ,CAACC,cAAT,CAAwBkc,cAAxB,KAA2C,CAACpL,MAAhD,EAAwD;MACpD/Q,QAAQ,CAACC,cAAT,CAAwBkc,cAAxB,EAAwCzhB,gBAAxC,CAAyD,SAAzD,EAAoE,KAAK8hB,mBAAL,CAAyB9f,UAAzB,EAAqCW,UAArC,CAApE;IACH;;IACD,IAAIof,WAAW,GAAG,KAAK/kB,SAAL,CAAekE,gBAAf,CAAgC0J,gBAAhC,CAAiDjI,UAAjD,EAA6DX,UAA7D,EAAyE,yBAAzE,CAAlB;IACA,KAAKhF,SAAL,CAAekE,gBAAf,CAAgCuM,SAAhC,CAA0C9K,UAA1C,EAAsDof,WAAtD,EAAmE/f,UAAnE,EAA+E,mBAA/E,EAAoG,IAApG;IACA,OAAOA,UAAP;EACH,CAhCD;;EAiCAjF,oBAAoB,CAAC+B,SAArB,CAA+B0M,WAA/B,GAA6C,UAAUvK,IAAV,EAAgB;IACzD,IAAIqK,QAAQ,GAAG,KAAKtO,SAAL,CAAeiN,0BAA9B;;IACA,IAAIhJ,IAAI,KAAK,WAAT,IAAwB,KAAKjE,SAAL,CAAeuE,iBAAf,CAAiC0I,0BAA7D,EAAyF;MACrFqB,QAAQ,GAAG,KAAKtO,SAAL,CAAeuE,iBAAf,CAAiC0I,0BAA5C;IACH,CAFD,MAGK,IAAIhJ,IAAI,KAAK,WAAT,IAAwB,KAAKjE,SAAL,CAAeyE,iBAAf,CAAiCwI,0BAA7D,EAAyF;MAC1FqB,QAAQ,GAAG,KAAKtO,SAAL,CAAeyE,iBAAf,CAAiCwI,0BAA5C;IACH,CAFI,MAGA,IAAIhJ,IAAI,KAAK,eAAT,IAA4B,KAAKjE,SAAL,CAAe0E,qBAAf,CAAqCuI,0BAArE,EAAiG;MAClGqB,QAAQ,GAAG,KAAKtO,SAAL,CAAe0E,qBAAf,CAAqCuI,0BAAhD;IACH;;IACD,OAAOqB,QAAP;EACH,CAZD;;EAaAvO,oBAAoB,CAAC+B,SAArB,CAA+BiJ,qBAA/B,GAAuD,UAAU9G,IAAV,EAAgB;IACnE,IAAIoJ,kBAAkB,GAAG;MAAEvC,MAAM,EAAE;IAAV,CAAzB;;IACA,IAAI7G,IAAI,KAAK,WAAT,IAAwB,KAAKjE,SAAL,CAAeuE,iBAAf,CAAiCuG,MAA7D,EAAqE;MACjEuC,kBAAkB,GAAG;QAAEvC,MAAM,EAAE;MAAV,CAArB;IACH,CAFD,MAGK,IAAI7G,IAAI,KAAK,WAAT,IAAwB,KAAKjE,SAAL,CAAeyE,iBAAf,CAAiCqG,MAA7D,EAAqE;MACtEuC,kBAAkB,GAAG;QAAEvC,MAAM,EAAE;MAAV,CAArB;IACH,CAFI,MAGA,IAAI7G,IAAI,KAAK,eAAT,IAA4B,KAAKjE,SAAL,CAAe0E,qBAAf,CAAqCoG,MAArE,EAA6E;MAC9EuC,kBAAkB,GAAG;QAAEvC,MAAM,EAAE;MAAV,CAArB;IACH,CAFI,MAGA,IAAI,KAAK9K,SAAL,CAAeqN,kBAAf,CAAkCvC,MAAtC,EAA8C;MAC/CuC,kBAAkB,GAAG;QAAEvC,MAAM,EAAE;MAAV,CAArB;IACH;;IACD,OAAOuC,kBAAP;EACH,CAfD;;EAgBAtN,oBAAoB,CAAC+B,SAArB,CAA+BoJ,eAA/B,GAAiD,UAAUjH,IAAV,EAAgB;IAC7D,IAAIqJ,OAAO,GAAG,IAAd;;IACA,IAAIrJ,IAAI,KAAK,WAAb,EAA0B;MACtBqJ,OAAO,GAAG,KAAKtN,SAAL,CAAeuE,iBAAf,CAAiC+I,OAA3C;IACH;;IACD,IAAIrJ,IAAI,KAAK,WAAb,EAA0B;MACtBqJ,OAAO,GAAG,KAAKtN,SAAL,CAAeyE,iBAAf,CAAiC6I,OAA3C;IACH;;IACD,IAAIrJ,IAAI,KAAK,eAAb,EAA8B;MAC1BqJ,OAAO,GAAG,KAAKtN,SAAL,CAAe0E,qBAAf,CAAqC4I,OAA/C;IACH;;IACD,OAAOA,OAAP;EACH,CAZD,CA7jFkD,CA0kFlD;;;EACAvN,oBAAoB,CAAC+B,SAArB,CAA+BgjB,mBAA/B,GAAqD,UAAU9f,UAAV,EAAsBW,UAAtB,EAAkC;IACnF,IAAIoD,MAAM,GAAG,KAAKlH,aAAL,CAAmBiF,UAAnB,CAA8B,uBAAuBnB,UAArD,CAAb;IACA,KAAK2Z,gBAAL,CAAsBta,UAAtB,EAAkC+D,MAAlC,EAA0CpD,UAA1C;;IACA,IAAI,KAAK3F,SAAL,CAAe6T,aAAnB,EAAkC;MAC9B,IAAI,KAAK7T,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,IAAwD,KAAK9T,SAAL,CAAe4T,uBAA3E,EAAoG;QAChG,KAAK5T,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqDkR,cAArD;QACA,KAAKhlB,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqDmR,gBAArD;QACA,IAAIna,MAAM,GAAG,KAAb;;QACA,IAAI9F,UAAU,CAACqI,kBAAX,IAAiCrI,UAAU,CAACqI,kBAAX,CAA8BvC,MAAnE,EAA2E;UACvEA,MAAM,GAAG9F,UAAU,CAACqI,kBAAX,CAA8BvC,MAAvC;QACH;;QACD,IAAIA,MAAJ,EAAY;UACR,IAAI,KAAK9K,SAAL,CAAekE,gBAAf,CAAgC2T,wBAAhC,CAAyD,gBAAzD,EAA2E7S,UAA3E,CAAJ,EAA4F;YACxF,KAAKhF,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqD8P,yCAArD,CAA+F,IAA/F;YACA,KAAK5jB,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqDiQ,uBAArD;UACH;;UACD,IAAI,KAAK/jB,SAAL,CAAekE,gBAAf,CAAgC2T,wBAAhC,CAAyD,QAAzD,EAAmE7S,UAAnE,CAAJ,EAAoF;YAChF,KAAKhF,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqD4P,0BAArD,CAAgF,IAAhF;UACH;QACJ,CARD,MASK;UACD,KAAK1jB,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqD8P,yCAArD,CAA+F,IAA/F;UACA,KAAK5jB,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqD4P,0BAArD,CAAgF,IAAhF;UACA,KAAK1jB,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqDiQ,uBAArD;QACH;;QACD,KAAK/jB,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqD+L,eAArD,GAAuE,IAAvE;;QACA,IAAI,CAAC/f,QAAQ,EAAb,EAAiB;UACb,KAAKE,SAAL,CAAe6T,aAAf,CAA6BC,uBAA7B,CAAqDgM,qBAArD,CAA2E,KAAK9f,SAAL,CAAe6T,aAAf,CAA6BkM,cAAxG;QACH;MACJ;IACJ;EACJ,CA/BD;;EAgCAhgB,oBAAoB,CAAC+B,SAArB,CAA+BkR,cAA/B,GAAgD,UAAUrN,UAAV,EAAsB;IAClE,IAAIoD,MAAM,GAAG,KAAKlH,aAAL,CAAmBiF,UAAnB,CAA8B,uBAAuBnB,UAArD,CAAb;IACA,IAAIwD,OAAO,GAAG,IAAd;;IACA,IAAIJ,MAAJ,EAAY;MACRI,OAAO,GAAGJ,MAAM,CAACK,UAAP,CAAkB,IAAlB,CAAV;IACH;;IACD,OAAOD,OAAP;EACH,CAPD;;EAQApJ,oBAAoB,CAAC+B,SAArB,CAA+B+Z,eAA/B,GAAiD,UAAUpK,KAAV,EAAiB;IAC9D,OAAOA,KAAK,GAAG,KAAK5P,aAAL,CAAmBgD,aAAnB,EAAf;EACH,CAFD;;EAGA9E,oBAAoB,CAAC+B,SAArB,CAA+BsO,iBAA/B,GAAmD,UAAUqB,KAAV,EAAiBxI,MAAjB,EAAyB;IACxE,OAAOwI,KAAK,GAAGxI,MAAf;EACH,CAFD;EAGA;AACJ;AACA;AACA;AACA;EACI;;;EACAlJ,oBAAoB,CAAC+B,SAArB,CAA+BojB,iCAA/B,GAAmE,UAAUlgB,UAAV,EAAsBW,UAAtB,EAAkC;IACjG,IAAI8D,gBAAgB,GAAG,IAAvB;IACAzE,UAAU,CAAC0F,MAAX,GAAoB,KAAK1K,SAAL,CAAekE,gBAAf,CAAgCyG,sBAAhC,CAAuD,YAAvD,EAAqE3F,UAAU,CAAC4F,OAAhF,CAApB;;IACA,IAAI5F,UAAU,CAAC6F,kBAAX,IAAiC7F,UAAU,CAAC6F,kBAAX,CAA8BC,MAAnE,EAA2E;MACvE9F,UAAU,CAAC6F,kBAAX,GAAgC;QAAEC,MAAM,EAAE9F,UAAU,CAAC6F,kBAAX,CAA8BC;MAAxC,CAAhC;IACH,CAFD,MAGK;MACD9F,UAAU,CAAC6F,kBAAX,GAAgC,KAAKE,qBAAL,CAA2B/F,UAAU,CAAC2E,wBAAtC,CAAhC;IACH,CARgG,CASjG;;;IACA3E,UAAU,CAACmG,mBAAX,GAAiC,KAAKnL,SAAL,CAAekE,gBAAf,CAAgCmH,mCAAhC,CAAoErG,UAApE,CAAjC,CAViG,CAWjG;;IACAyE,gBAAgB,GAAG;MACf;MACA6B,wBAAwB,EAAEtG,UAAU,CAAC2E,wBAFtB;MAEgD4B,KAAK,EAAEvG,UAAU,CAACwG,KAFlE;MAEyEC,OAAO,EAAEzG,UAAU,CAAC0G,OAF7F;MAEsGP,mBAAmB,EAAEnG,UAAU,CAACmG,mBAFtI;MAE2JhG,MAAM,EAAEH,UAAU,CAAC+E,MAF9K;MAEsL4B,MAAM,EAAE3G,UAAU,CAAC0F,MAFzM;MAEiNkB,OAAO,EAAE5G,UAAU,CAAC4F,OAFrO;MAE8OiB,YAAY,EAAE7G,UAAU,CAAC8G,YAFvQ;MAEqRC,IAAI,EAAE/G,UAAU,CAACgH,IAFtS;MAE4SC,IAAI,EAAEjH,UAAU,CAACkH,IAF7T;MAGfpG,SAAS,EAAEd,UAAU,CAACmH,SAHP;MAGkBC,QAAQ,EAAE,KAAKpM,SAAL,CAAekE,gBAAf,CAAgCmI,qBAAhC,CAAsDrH,UAAU,CAACsH,QAAjE,EAA2EtH,UAA3E,EAAuFA,UAAU,CAAC0F,MAAlG,CAH5B;MAGuI6B,MAAM,EAAE;QAAEC,KAAK,EAAExH,UAAU,CAACyH,KAApB;QAA2BC,UAAU,EAAE1H,UAAU,CAAC2H,UAAlD;QAA8Dd,YAAY,EAAE7G,UAAU,CAAC8G,YAAvF;QAAqGH,MAAM,EAAE3G,UAAU,CAAC0F;MAAxH,CAH/I;MAIfkC,mBAAmB,EAAE,YAJN;MAKfjH,UAAU,EAAEA,UALG;MAKSkH,iBAAiB,EAAE,EAL5B;MAKgCE,oBAAoB,EAAE,CALtD;MAMf;MACAC,kBAAkB,EAAE,CAPL;MAOQC,0BAA0B,EAAE,KAAKC,WAAL,CAAiBlI,UAAjB,CAPpC;MAOkEmI,UAAU,EAAE,KAAKnN,SAAL,CAAegF,UAAf,CAA0BoI,aAA1B,CAAwCpI,UAAxC,CAP9E;MAQfC,aAAa,EAAED,UAAU,CAACyI,aARX;MAQ0BpH,mBAAmB,EAAErB,UAAU,CAAC0I,mBAR1D;MAQ+ElI,gBAAgB,EAAER,UAAU,CAAC2I,gBAR5G;MASf;MACApD,iBAAiB,EAAE,KAAKA,iBAVT;MAU4B8C,kBAAkB,EAAErI,UAAU,CAAC6F,kBAV3D;MAU+EyC,OAAO,EAAEtI,UAAU,CAACsI,OAVnG;MAU4GC,aAAa,EAAEvI,UAAU,CAACwI,aAVtI;MAUqJ9D,mBAAmB,EAAE;IAV1K,CAAnB;IAYA,KAAK1J,SAAL,CAAekE,gBAAf,CAAgC0J,gBAAhC,CAAiDjI,UAAjD,EAA6D8D,gBAA7D,EAA+E,yBAA/E;EACH,CAzBD;EA0BA;AACJ;AACA;AACA;AACA;AACA;AACA;EACI;;;EACA1J,oBAAoB,CAAC+B,SAArB,CAA+BqjB,qCAA/B,GAAuE,UAAUngB,UAAV,EAAsBW,UAAtB,EAAkC;IACrG;IACA,IAAI8D,gBAAgB,GAAG,IAAvB,CAFqG,CAGrG;;IACAzE,UAAU,CAACmG,mBAAX,GAAiCnG,UAAU,CAACoG,mBAAX,GAAiCpG,UAAU,CAACoG,mBAA5C,GAAkE,KAAKpL,SAAL,CAAekE,gBAAf,CAAgCmH,mCAAhC,CAAoErG,UAApE,CAAnG;IACAyE,gBAAgB,GAAG;MACf;MACA6B,wBAAwB,EAAEtG,UAAU,CAAC2E,wBAFtB;MAEgDwB,mBAAmB,EAAEnG,UAAU,CAACmG,mBAFhF;MAEqGI,KAAK,EAAEvG,UAAU,CAACwG,KAFvH;MAE8HC,OAAO,EAAEzG,UAAU,CAAC0G,OAFlJ;MAE2JvG,MAAM,EAAEH,UAAU,CAAC+E,MAF9K;MAEsL4B,MAAM,EAAE3G,UAAU,CAAC0F,MAFzM;MAEiNkB,OAAO,EAAE5G,UAAU,CAAC4F,OAFrO;MAE8OiB,YAAY,EAAE7G,UAAU,CAAC8G,YAFvQ;MAEqRC,IAAI,EAAE/G,UAAU,CAACgH,IAFtS;MAE4SC,IAAI,EAAEjH,UAAU,CAACkH,IAF7T;MAGfkF,YAAY,EAAEpM,UAAU,CAACmH,SAHV;MAGqBC,QAAQ,EAAE,KAAKpM,SAAL,CAAekE,gBAAf,CAAgCmI,qBAAhC,CAAsDrH,UAAU,CAACsH,QAAjE,EAA2EtH,UAA3E,EAAuFA,UAAU,CAAC0F,MAAlG,CAH/B;MAG0I6B,MAAM,EAAE;QAAEC,KAAK,EAAExH,UAAU,CAACyH,KAApB;QAA2BC,UAAU,EAAE1H,UAAU,CAAC2H,UAAlD;QAA8Dd,YAAY,EAAE7G,UAAU,CAAC8G,YAAvF;QAAqGH,MAAM,EAAE3G,UAAU,CAAC0F;MAAxH,CAHlJ;MAGoRkC,mBAAmB,EAAE,YAHzS;MAGuTjH,UAAU,EAAEA,UAHnU;MAG+UV,aAAa,EAAED,UAAU,CAACyI,aAHzW;MAGwXpH,mBAAmB,EAAErB,UAAU,CAAC0I,mBAHxZ;MAG6alI,gBAAgB,EAAER,UAAU,CAAC2I,gBAH1c;MAG4dR,UAAU,EAAE,KAAKnN,SAAL,CAAegF,UAAf,CAA0BoI,aAA1B,CAAwCpI,UAAxC,CAHxe;MAIfsI,OAAO,EAAEtI,UAAU,CAACsI,OAJL;MAIcC,aAAa,EAAEvI,UAAU,CAACwI;IAJxC,CAAnB;IAMA,OAAO/D,gBAAP;EACH,CAZD;EAaA;AACJ;AACA;AACA;EACI;;;EACA1J,oBAAoB,CAAC+B,SAArB,CAA+BsjB,wBAA/B,GAA0D,UAAUC,kBAAV,EAA8B;IACpF,IAAIA,kBAAkB,KAAK,mBAA3B,EAAgD;MAC5C;MACA,KAAKpS,cAAL,GAAsB,KAAKjT,SAAL,CAAeuE,iBAAf,CAAiCgH,KAAjC,GAAyC,KAAKvL,SAAL,CAAeuE,iBAAf,CAAiCgH,KAA1E,GAAkF,KAAK0H,cAA7G,CAF4C,CAG5C;;MACA,KAAKG,gBAAL,GAAwB,KAAKpT,SAAL,CAAeuE,iBAAf,CAAiCkH,OAAjC,GAA2C,KAAKzL,SAAL,CAAeuE,iBAAf,CAAiCkH,OAA5E,GAAsF,KAAK2H,gBAAnH;IACH;;IACD,IAAIiS,kBAAkB,KAAK,mBAA3B,EAAgD;MAC5C;MACA,KAAKnS,cAAL,GAAsB,KAAKlT,SAAL,CAAeyE,iBAAf,CAAiC8G,KAAjC,GAAyC,KAAKvL,SAAL,CAAeyE,iBAAf,CAAiC8G,KAA1E,GAAkF,KAAK2H,cAA7G,CAF4C,CAG5C;;MACA,KAAKG,gBAAL,GAAwB,KAAKrT,SAAL,CAAeyE,iBAAf,CAAiCgH,OAAjC,GAA2C,KAAKzL,SAAL,CAAeyE,iBAAf,CAAiCgH,OAA5E,GAAsF,KAAK4H,gBAAnH;IACH;;IACD,IAAIgS,kBAAkB,KAAK,uBAA3B,EAAoD;MAChD;MACA,KAAKlS,kBAAL,GAA0B,KAAKnT,SAAL,CAAe0E,qBAAf,CAAqC6G,KAArC,GAA6C,KAAKvL,SAAL,CAAe0E,qBAAf,CAAqC6G,KAAlF,GAA0F,KAAK4H,kBAAzH,CAFgD,CAGhD;;MACA,KAAKG,oBAAL,GAA4B,KAAKtT,SAAL,CAAe0E,qBAAf,CAAqC+G,OAArC,GAA+C,KAAKzL,SAAL,CAAe0E,qBAAf,CAAqC+G,OAApF,GAA8F,KAAK6H,oBAA/H;IACH;EACJ,CAnBD;EAoBA;AACJ;AACA;;;EACIvT,oBAAoB,CAAC+B,SAArB,CAA+BwjB,KAA/B,GAAuC,YAAY;IAC/C,KAAKllB,2BAAL,GAAmC,IAAnC;IACA,KAAKC,2BAAL,GAAmC,IAAnC;IACA,KAAKe,uBAAL,GAA+B,IAA/B;IACAiE,MAAM,CAACsR,cAAP,CAAsBuN,UAAtB,CAAiC,KAAKriB,aAAL,CAAmBgV,UAAnB,GAAgC,yBAAjE;EACH,CALD;EAMA;AACJ;AACA;AACA;;;EACI9W,oBAAoB,CAAC+B,SAArB,CAA+ByjB,eAA/B,GAAiD,UAAUC,MAAV,EAAkB;IAC/D,IAAIC,YAAY,GAAG,EAAnB,CAD+D,CAE/D;;IACA,KAAK,IAAIrf,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGof,MAAM,CAAC3f,MAA3B,EAAmCO,CAAC,EAApC,EAAwC;MACpCqf,YAAY,CAACrf,CAAD,CAAZ,GAAkB;QAAE+D,CAAC,EAAEqb,MAAM,CAACpf,CAAD,CAAN,CAAUjD,CAAf;QAAkBiH,CAAC,EAAEob,MAAM,CAACpf,CAAD,CAAN,CAAUhD,CAA/B;QAAkCuD,KAAK,EAAE6e,MAAM,CAACpf,CAAD,CAAN,CAAUxB,KAAnD;QAA0DgC,MAAM,EAAE4e,MAAM,CAACpf,CAAD,CAAN,CAAUtB,MAA5E;QAAoF2B,IAAI,EAAE+e,MAAM,CAACpf,CAAD,CAAN,CAAUjD,CAApG;QAAuGuD,GAAG,EAAE8e,MAAM,CAACpf,CAAD,CAAN,CAAUhD;MAAtH,CAAlB;IACH;;IACD,OAAOqiB,YAAP;EACH,CAPD;EAQA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;EACI1lB,oBAAoB,CAAC+B,SAArB,CAA+B4jB,0BAA/B,GAA4D,UAAUC,cAAV,EAA0Blc,gBAA1B,EAA4C;IACpG;IACA,IAAI,CAACA,gBAAL,EAAuB;MACnBA,gBAAgB,GAAG;QAAE9D,UAAU,EAAE;MAAd,CAAnB;IACH,CAJmG,CAKpG;;;IACA,IAAIigB,qBAAqB,GAAG,IAA5B;IACA,IAAIC,wBAAwB,GAAG,IAA/B;IACA,IAAIva,wBAAwB,GAAG,EAA/B;IACA,IAAIwa,aAAa,GAAG,IAApB;IACA,IAAIva,KAAK,GAAG,EAAZ;IACA,IAAIpG,MAAM,GAAG,EAAb,CAXoG,CAYpG;;IACA,IAAI4gB,iBAAiB,GAAG,KAAK/lB,SAAL,CAAegF,UAAf,CAA0B0L,2BAA1B,CAAsDgB,cAAtD,EAAxB;IACA,IAAI+S,cAAc,GAAG,KAAKzkB,SAAL,CAAegF,UAAf,CAA0B0f,UAA1B,EAArB;;IACA,IAAIiB,cAAc,IAAI,WAAtB,EAAmC;MAC/B;MACAC,qBAAqB,GAAG,KAAK5lB,SAAL,CAAeuE,iBAAf,CAAiC0I,0BAAjC,GAA8D,KAAKjN,SAAL,CAAeuE,iBAAf,CAAiC0I,0BAA/F,GAA4H,KAAKjN,SAAL,CAAeiN,0BAAnK;MACA6Y,aAAa,GAAG,KAAK9lB,SAAL,CAAekE,gBAAf,CAAgC8hB,cAAhC,CAA+C,KAAKhmB,SAAL,CAAeuE,iBAA9D,CAAhB;MACAshB,wBAAwB,GAAG,KAAK7lB,SAAL,CAAeuE,iBAAf,CAAiC4G,mBAAjC,GAAuD,KAAKnL,SAAL,CAAeuE,iBAAf,CAAiC4G,mBAAxF,GAA8G,KAAKnL,SAAL,CAAeqN,kBAAf,CAAkClC,mBAA3K;MACAG,wBAAwB,GAAG,WAA3B;MACAC,KAAK,GAAG9B,gBAAgB,CAAC8B,KAAjB,GAAyB9B,gBAAgB,CAAC8B,KAA1C,GAAkD,SAA1D;IACH,CAPD,MAQK,IAAIoa,cAAc,IAAI,WAAtB,EAAmC;MACpC;MACAC,qBAAqB,GAAG,KAAK5lB,SAAL,CAAeyE,iBAAf,CAAiCwI,0BAAjC,GAA8D,KAAKjN,SAAL,CAAeyE,iBAAf,CAAiCwI,0BAA/F,GAA4H,KAAKjN,SAAL,CAAeiN,0BAAnK;MACA6Y,aAAa,GAAG,KAAK9lB,SAAL,CAAekE,gBAAf,CAAgC8hB,cAAhC,CAA+C,KAAKhmB,SAAL,CAAeyE,iBAA9D,CAAhB;MACAohB,wBAAwB,GAAG,KAAK7lB,SAAL,CAAeyE,iBAAf,CAAiC0G,mBAAjC,GAAuD,KAAKnL,SAAL,CAAeyE,iBAAf,CAAiC0G,mBAAxF,GAA8G,KAAKnL,SAAL,CAAeqN,kBAAf,CAAkClC,mBAA3K;MACAG,wBAAwB,GAAG,WAA3B;MACAC,KAAK,GAAG9B,gBAAgB,CAAC8B,KAAjB,GAAyB9B,gBAAgB,CAAC8B,KAA1C,GAAkD,SAA1D;IACH,CAPI,MAQA,IAAIoa,cAAc,IAAI,eAAtB,EAAuC;MACxC;MACAC,qBAAqB,GAAG,KAAK5lB,SAAL,CAAe0E,qBAAf,CAAqCuI,0BAArC,GAAkE,KAAKjN,SAAL,CAAe0E,qBAAf,CAAqCuI,0BAAvG,GAAoI,KAAKjN,SAAL,CAAeiN,0BAA3K;MACA6Y,aAAa,GAAG,KAAK9lB,SAAL,CAAekE,gBAAf,CAAgC8hB,cAAhC,CAA+C,KAAKhmB,SAAL,CAAe0E,qBAA9D,CAAhB;MACAmhB,wBAAwB,GAAG,KAAK7lB,SAAL,CAAe0E,qBAAf,CAAqCyG,mBAArC,GAA2D,KAAKnL,SAAL,CAAe0E,qBAAf,CAAqCyG,mBAAhG,GAAsH,KAAKnL,SAAL,CAAeqN,kBAAf,CAAkClC,mBAAnL;MACAG,wBAAwB,GAAG,eAA3B;MACAC,KAAK,GAAG9B,gBAAgB,CAAC8B,KAAjB,GAAyB9B,gBAAgB,CAAC8B,KAA1C,GAAkD,SAA1D;IACH;;IACDua,aAAa,CAAChb,MAAd,GAAuBrB,gBAAgB,CAACqB,MAAjB,GAA0BrB,gBAAgB,CAACqB,MAA3C,GAAoD,KAA3E,CAvCoG,CAwCpG;;IACA,IAAIrB,gBAAgB,CAACtE,MAArB,EAA6B;MACzBA,MAAM,GAAG,KAAKogB,eAAL,CAAqB9b,gBAAgB,CAACtE,MAAtC,CAAT;IACH,CAFD,MAIIA,MAAM,GAAG,CAAC;MAAEgF,CAAC,EAAE,CAAL;MAAQC,CAAC,EAAE,CAAX;MAAczD,KAAK,EAAE,GAArB;MAA0BC,MAAM,EAAE,EAAlC;MAAsCH,IAAI,EAAE,CAA5C;MAA+CC,GAAG,EAAE,CAApD;MAAuDuf,QAAQ,EAAE;QAAE9b,CAAC,EAAE,CAAL;QAAQC,CAAC,EAAE;MAAX,CAAjE;MAAiF8b,IAAI,EAAE;QAAEtf,MAAM,EAAE,EAAV;QAAcuf,OAAO,EAAE,KAAvB;QAA8Bxf,KAAK,EAAE;MAArC;IAAvF,CAAD,CAAT,CA7CgG,CA8CpG;;;IACA,IAAIyf,oBAAoB,GAAG,EAA3B;IACA,IAAIC,UAAU,GAAG;MACbjb,mBAAmB,EAAE3B,gBAAgB,CAAC0B,mBAAjB,GAAuC1B,gBAAgB,CAAC0B,mBAAxD,GAA8E0a,wBADtF;MAEb1Z,SAAS,EAAEsY,cAFE;MAGb/W,mBAAmB,EAAE,IAHR;MAIbjD,SAAS,EAAE,YAJE;MAKb8D,0BAA0B,EAAE9E,gBAAgB,CAACwD,0BAAjB,GAA8CxD,gBAAgB,CAACwD,0BAA/D,GAA4F2Y,qBAL3G;MAMb/a,kBAAkB,EAAEib,aANP;MAObpb,MAAM,EAAEjB,gBAAgB,CAACkC,MAAjB,GAA0BlC,gBAAgB,CAACkC,MAA3C,GAAoD,OAP/C;MAQb5B,MAAM,EAAE5E,MARK;MASbqG,KAAK,EAAE/B,gBAAgB,CAAC8B,KAAjB,GAAyB9B,gBAAgB,CAAC8B,KAA1C,GAAkDA,KAT5C;MAUbe,QAAQ,EAAE,IAVG;MAWbga,WAAW,EAAEP,iBAXA;MAYbQ,UAAU,EAAE9c,gBAAgB,CAAC0D,UAAjB,GAA8B1D,gBAAgB,CAAC0D,UAA/C,GAA4D,IAZ3D;MAabqZ,kBAAkB,EAAE,IAbP;MAcbC,yBAAyB,EAAEhd,gBAAgB,CAACoG,yBAAjB,GAA6CpG,gBAAgB,CAACoG,yBAA9D,GAA0F,KAdxG;MAeb6W,uBAAuB,EAAEjd,gBAAgB,CAACjF,uBAAjB,GAA2CiF,gBAAgB,CAACjF,uBAA5D,GAAsF,KAflG;MAgBbgJ,aAAa,EAAE,KAhBF;MAiBbC,aAAa,EAAE,KAjBF;MAkBbkZ,MAAM,EAAEld,gBAAgB,CAACqB,MAAjB,GAA0BrB,gBAAgB,CAACqB,MAA3C,GAAoD,KAlB/C;MAmBbG,OAAO,EAAExB,gBAAgB,CAAC6D,OAAjB,GAA2B7D,gBAAgB,CAAC6D,OAA5C,GAAsD,IAnBlD;MAoBbxB,YAAY,EAAEia,iBApBD;MAqBb/Z,IAAI,EAAE,EArBO;MAsBbN,OAAO,EAAEjC,gBAAgB,CAACgC,OAAjB,GAA2BhC,gBAAgB,CAACgC,OAA5C,GAAsD,CAtBlD;MAuBbS,IAAI,EAAE,EAvBO;MAwBbO,KAAK,EAAE,EAxBM;MAyBbE,UAAU,EAAE,EAzBC;MA0Bb/B,OAAO,EAAEU,wBA1BI;MA2Bb3B,wBAAwB,EAAE2B;IA3Bb,CAAjB,CAhDoG,CA6EpG;;IACA8a,oBAAoB,CAAC,CAAD,CAApB,GAA0BC,UAA1B;IACA,OAAO;MAAED,oBAAoB,EAAEA;IAAxB,CAAP;EACH,CAhFD;;EAiFA,OAAOrmB,oBAAP;AACH,CAtzFyC,EAA1C;;AAuzFA,SAASA,oBAAT"},"metadata":{},"sourceType":"module"}