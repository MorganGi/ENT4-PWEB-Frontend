{"ast":null,"code":"import { select, isNullOrUndefined, Browser, addClass, removeClass, EventHandler, closest, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport { RenderType } from '../base/enum';\nimport * as events from '../base/constant';\nimport { pageYOffset, hasClass, isIDevice } from '../base/util';\nimport { BaseQuickToolbar } from './base-quick-toolbar';\nimport { PopupRenderer } from '../renderer/popup-renderer';\nimport { CLS_INLINE_POP, CLS_INLINE } from '../base/classes';\n/**\n * `Quick toolbar` module is used to handle Quick toolbar actions.\n */\n\nvar QuickToolbar =\n/** @class */\nfunction () {\n  function QuickToolbar(parent, locator) {\n    this.parent = parent;\n    this.locator = locator;\n    this.renderFactory = this.locator.getService('rendererFactory');\n    this.renderFactory.addRenderer(RenderType.Popup, new PopupRenderer(this.parent));\n    this.addEventListener();\n  }\n\n  QuickToolbar.prototype.formatItems = function (items) {\n    var formattedItems = [];\n    items.forEach(function (item) {\n      if (typeof item === 'string') {\n        switch (item.toLocaleLowerCase()) {\n          case 'open':\n            formattedItems.push('openLink');\n            break;\n\n          case 'edit':\n            formattedItems.push('editLink');\n            break;\n\n          case 'unlink':\n            formattedItems.push('removeLink');\n            break;\n\n          default:\n            formattedItems.push(item);\n            break;\n        }\n      } else {\n        formattedItems.push(item);\n      }\n    });\n    return formattedItems;\n  };\n\n  QuickToolbar.prototype.getQTBarOptions = function (popType, mode, items, type) {\n    return {\n      popupType: popType,\n      toolbarItems: items,\n      mode: mode,\n      renderType: type,\n      cssClass: this.parent.cssClass\n    };\n  };\n  /**\n   * createQTBar method\n   *\n   * @param {string} popupType - specifies the string value\n   * @param {string} mode - specifies the string value.\n   * @param {string} items - specifies the string.\n   * @param {RenderType} type - specifies the render type.\n   * @returns {BaseQuickToolbar} - specifies the quick toolbar\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.createQTBar = function (popupType, mode, items, type) {\n    if (items.length < 1) {\n      return null;\n    }\n\n    var qTBar = new BaseQuickToolbar(this.parent, this.locator);\n    qTBar.render(this.getQTBarOptions(popupType, mode, this.formatItems(items), type));\n    return qTBar;\n  };\n\n  QuickToolbar.prototype.initializeQuickToolbars = function () {\n    this.parent.quickToolbarModule = this;\n    this.contentRenderer = this.renderFactory.getRenderer(RenderType.Content);\n\n    if (this.parent.inlineMode.enable && this.parent.inlineMode.onSelection && isIDevice()) {\n      EventHandler.add(this.contentRenderer.getDocument(), 'selectionchange', this.selectionChangeHandler, this);\n    }\n  }; // eslint-disable-next-line\n\n\n  QuickToolbar.prototype.onMouseDown = function (e) {\n    this.parent.isBlur = false;\n    this.parent.isRTE = true;\n  };\n\n  QuickToolbar.prototype.keyUpQT = function (e) {\n    if (e.which == 27) {\n      this.hideQuickToolbars();\n    }\n  };\n\n  QuickToolbar.prototype.renderQuickToolbars = function () {\n    if (this.linkQTBar || this.imageQTBar || this.textQTBar || this.tableQTBar) {\n      return;\n    }\n\n    this.linkQTBar = this.createQTBar('Link', 'Scrollable', this.parent.quickToolbarSettings.link, RenderType.LinkToolbar);\n    this.renderFactory.addRenderer(RenderType.LinkToolbar, this.linkQTBar);\n    this.textQTBar = this.createQTBar('Text', 'Scrollable', this.parent.quickToolbarSettings.text, RenderType.TextToolbar);\n    this.renderFactory.addRenderer(RenderType.TextToolbar, this.textQTBar);\n    this.imageQTBar = this.createQTBar('Image', 'MultiRow', this.parent.quickToolbarSettings.image, RenderType.ImageToolbar);\n    this.renderFactory.addRenderer(RenderType.ImageToolbar, this.imageQTBar);\n    this.tableQTBar = this.createQTBar('Table', 'MultiRow', this.parent.quickToolbarSettings.table, RenderType.TableToolbar);\n    this.renderFactory.addRenderer(RenderType.TableToolbar, this.tableQTBar);\n\n    if (this.linkQTBar) {\n      EventHandler.add(this.linkQTBar.element, 'mousedown', this.onMouseDown, this);\n      EventHandler.add(this.linkQTBar.element, 'keyup', this.keyUpQT, this);\n    }\n\n    if (this.imageQTBar) {\n      EventHandler.add(this.imageQTBar.element, 'mousedown', this.onMouseDown, this);\n      EventHandler.add(this.imageQTBar.element, 'keyup', this.keyUpQT, this);\n    }\n\n    if (this.textQTBar) {\n      EventHandler.add(this.textQTBar.element, 'mousedown', this.onMouseDown, this);\n      EventHandler.add(this.textQTBar.element, 'keyup', this.keyUpQT, this);\n    }\n\n    if (this.tableQTBar) {\n      EventHandler.add(this.tableQTBar.element, 'mousedown', this.onMouseDown, this);\n      EventHandler.add(this.tableQTBar.element, 'keyup', this.keyUpQT, this);\n    }\n  };\n\n  QuickToolbar.prototype.renderInlineQuickToolbar = function () {\n    if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice())) {\n      addClass([this.parent.element], [CLS_INLINE]);\n      this.inlineQTBar = this.createQTBar('Inline', 'MultiRow', this.parent.toolbarSettings.items, RenderType.InlineToolbar);\n      this.renderFactory.addRenderer(RenderType.InlineToolbar, this.inlineQTBar);\n      EventHandler.add(this.inlineQTBar.element, 'mousedown', this.onMouseDown, this);\n      EventHandler.add(this.inlineQTBar.element, 'keyup', this.keyUpQT, this);\n    }\n  };\n  /**\n   * Method for showing the inline quick toolbar\n   *\n   * @param {number} x -specifies the value of x.\n   * @param {number} y - specifies the y valu.\n   * @param {HTMLElement} target - specifies the target element.\n   * @returns {void}\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.showInlineQTBar = function (x, y, target) {\n    if (this.parent.readonly || target.tagName.toLowerCase() === \"img\") {\n      return;\n    }\n\n    this.inlineQTBar.showPopup(x, y, target);\n  };\n  /**\n   * Method for hidding the inline quick toolbar\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.hideInlineQTBar = function () {\n    if (this.inlineQTBar && !hasClass(this.inlineQTBar.element, 'e-popup-close')) {\n      this.inlineQTBar.hidePopup();\n    }\n  };\n  /**\n   * Method for hidding the quick toolbar\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.hideQuickToolbars = function () {\n    if (this.linkQTBar && !hasClass(this.linkQTBar.element, 'e-popup-close') && document.body.contains(this.linkQTBar.element)) {\n      this.linkQTBar.hidePopup();\n    }\n\n    if (this.textQTBar && !hasClass(this.textQTBar.element, 'e-popup-close') && document.body.contains(this.textQTBar.element)) {\n      this.textQTBar.hidePopup();\n    }\n\n    if (this.imageQTBar && !hasClass(this.imageQTBar.element, 'e-popup-close') && document.body.contains(this.imageQTBar.element)) {\n      this.imageQTBar.hidePopup();\n    }\n\n    if (this.tableQTBar && !hasClass(this.tableQTBar.element, 'e-popup-close') && document.body.contains(this.tableQTBar.element)) {\n      this.tableQTBar.hidePopup();\n    }\n\n    if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice())) {\n      this.hideInlineQTBar();\n    }\n  };\n\n  QuickToolbar.prototype.deBounce = function (x, y, target) {\n    var _this = this;\n\n    clearTimeout(this.deBouncer);\n    this.deBouncer = window.setTimeout(function () {\n      _this.showInlineQTBar(x, y, target);\n    }, 1000);\n  };\n\n  QuickToolbar.prototype.mouseUpHandler = function (e) {\n    if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice())) {\n      var args = e.args.touches ? e.args.changedTouches[0] : e.args;\n      var range = this.parent.getRange();\n      var target = e.args.target;\n\n      if (isNullOrUndefined(select('.' + CLS_INLINE_POP, document.body))) {\n        if (isIDevice() && e.touchData && e.touchData.prevClientX !== e.touchData.clientX && e.touchData.prevClientY !== e.touchData.clientY) {\n          return;\n        }\n\n        this.hideInlineQTBar();\n        var parentLeft = this.parent.element.getBoundingClientRect().left;\n        this.offsetX = this.parent.iframeSettings.enable ? window.pageXOffset + parentLeft + args.clientX : args.pageX;\n        this.offsetY = pageYOffset(args, this.parent.element, this.parent.iframeSettings.enable);\n\n        if (target.nodeName === 'TEXTAREA') {\n          this.showInlineQTBar(this.offsetX, this.offsetY, target);\n        } else {\n          var closestAnchor = closest(target, 'a');\n          target = closestAnchor ? closestAnchor : target;\n          var startNode = this.parent.getRange().startContainer.parentElement;\n          var endNode = this.parent.getRange().endContainer.parentElement;\n\n          if ((isNOU(closest(startNode, 'A')) || isNOU(closest(endNode, 'A'))) && (!closest(target, 'td,th') || !range.collapsed) && (target.tagName !== 'IMG' || this.parent.getRange().startOffset !== this.parent.getRange().endOffset)) {\n            if (this.parent.inlineMode.onSelection && range.collapsed) {\n              return;\n            }\n\n            this.target = target;\n            this.showInlineQTBar(this.offsetX, this.offsetY, target);\n          }\n        }\n      }\n    }\n  };\n\n  QuickToolbar.prototype.keyDownHandler = function () {\n    if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice()) && !isNullOrUndefined(select('.' + CLS_INLINE_POP, document))) {\n      this.hideInlineQTBar();\n    }\n  };\n\n  QuickToolbar.prototype.inlineQTBarMouseDownHandler = function () {\n    if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice()) && !isNullOrUndefined(select('.' + CLS_INLINE_POP, document))) {\n      this.hideInlineQTBar();\n    }\n  };\n\n  QuickToolbar.prototype.keyUpHandler = function (e) {\n    if (this.parent.inlineMode.enable && !Browser.isDevice) {\n      if (this.parent.inlineMode.onSelection) {\n        return;\n      }\n\n      var args = e.args;\n      this.deBounce(this.offsetX, this.offsetY, args.target);\n    }\n  };\n\n  QuickToolbar.prototype.selectionChangeHandler = function (e) {\n    var _this = this;\n\n    clearTimeout(this.deBouncer);\n    this.deBouncer = window.setTimeout(function () {\n      _this.onSelectionChange(e);\n    }, 1000);\n  };\n\n  QuickToolbar.prototype.onSelectionChange = function (e) {\n    if (!isNullOrUndefined(select('.' + CLS_INLINE_POP, document.body))) {\n      return;\n    }\n\n    var selection = this.contentRenderer.getDocument().getSelection();\n\n    if (!selection.isCollapsed) {\n      this.mouseUpHandler({\n        args: e\n      });\n    }\n  };\n  /**\n   * getInlineBaseToolbar method\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.getInlineBaseToolbar = function () {\n    return this.inlineQTBar && this.inlineQTBar.quickTBarObj;\n  };\n  /**\n   * Destroys the ToolBar.\n   *\n   * @function destroy\n   * @returns {void}\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.destroy = function () {\n    if (this.linkQTBar) {\n      EventHandler.remove(this.linkQTBar.element, 'mousedown', this.onMouseDown);\n      EventHandler.remove(this.linkQTBar.element, 'keyup', this.keyUpQT);\n      this.linkQTBar.destroy();\n    }\n\n    if (this.textQTBar) {\n      EventHandler.remove(this.textQTBar.element, 'mousedown', this.onMouseDown);\n      EventHandler.remove(this.textQTBar.element, 'keyup', this.keyUpQT);\n      this.textQTBar.destroy();\n    }\n\n    if (this.imageQTBar) {\n      EventHandler.remove(this.imageQTBar.element, 'mousedown', this.onMouseDown);\n      EventHandler.remove(this.imageQTBar.element, 'keyup', this.keyUpQT);\n      this.imageQTBar.destroy();\n    }\n\n    if (this.tableQTBar) {\n      EventHandler.remove(this.tableQTBar.element, 'mousedown', this.onMouseDown);\n      EventHandler.remove(this.tableQTBar.element, 'keyup', this.keyUpQT);\n      this.tableQTBar.destroy();\n    }\n\n    if (this.inlineQTBar) {\n      EventHandler.remove(this.inlineQTBar.element, 'mousedown', this.onMouseDown);\n      EventHandler.remove(this.inlineQTBar.element, 'keyup', this.keyUpQT);\n\n      if (isIDevice()) {\n        EventHandler.remove(document, 'selectionchange', this.selectionChangeHandler);\n      }\n\n      this.inlineQTBar.destroy();\n    }\n\n    this.removeEventListener();\n  };\n\n  QuickToolbar.prototype.wireInlineQTBarEvents = function () {\n    this.parent.on(events.mouseUp, this.mouseUpHandler, this);\n    this.parent.on(events.mouseDown, this.inlineQTBarMouseDownHandler, this);\n    this.parent.on(events.keyDown, this.keyDownHandler, this);\n    this.parent.on(events.keyUp, this.keyUpHandler, this);\n    this.parent.on(events.sourceCodeMouseDown, this.mouseUpHandler, this);\n    this.parent.on(events.renderInlineToolbar, this.renderInlineQuickToolbar, this);\n  };\n\n  QuickToolbar.prototype.unWireInlineQTBarEvents = function () {\n    this.parent.off(events.mouseUp, this.mouseUpHandler);\n    this.parent.off(events.mouseDown, this.inlineQTBarMouseDownHandler);\n    this.parent.off(events.keyDown, this.keyDownHandler);\n    this.parent.off(events.keyUp, this.keyUpHandler);\n    this.parent.off(events.sourceCodeMouseDown, this.mouseUpHandler);\n    this.parent.off(events.renderInlineToolbar, this.renderInlineQuickToolbar);\n  }; // eslint-disable-next-line\n\n\n  QuickToolbar.prototype.toolbarUpdated = function (args) {\n    if (this.linkQTBar && !hasClass(this.linkQTBar.element, 'e-popup-close')) {\n      this.linkQTBar.hidePopup();\n    }\n\n    if (this.imageQTBar && !hasClass(this.imageQTBar.element, 'e-popup-close')) {\n      this.imageQTBar.hidePopup();\n    }\n\n    if (this.tableQTBar && !hasClass(this.tableQTBar.element, 'e-popup-close')) {\n      this.tableQTBar.hidePopup();\n    }\n  };\n  /**\n   * addEventListener\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.on(events.initialEnd, this.initializeQuickToolbars, this);\n    this.parent.on(events.mouseDown, this.renderQuickToolbars, this);\n    this.parent.on(events.toolbarUpdated, this.toolbarUpdated, this);\n    this.parent.on(events.drop, this.renderQuickToolbars, this);\n    this.wireInlineQTBarEvents();\n    this.parent.on(events.modelChanged, this.onPropertyChanged, this);\n\n    if (this.parent.quickToolbarSettings.actionOnScroll === 'hide') {\n      this.parent.on(events.scroll, this.hideQuickToolbars, this);\n      this.parent.on(events.contentscroll, this.hideQuickToolbars, this);\n    }\n\n    this.parent.on(events.focusChange, this.hideQuickToolbars, this);\n    this.parent.on(events.iframeMouseDown, this.onIframeMouseDown, this);\n    this.parent.on(events.destroy, this.destroy, this);\n    this.parent.on(events.keyDown, this.onKeyDown, this);\n    this.parent.on(events.rtlMode, this.setRtl, this);\n    this.parent.on(events.bindCssClass, this.setCssClass, this);\n  };\n\n  QuickToolbar.prototype.onKeyDown = function (e) {\n    var args = e.args;\n\n    if (args.which === 8 || args.which === 46) {\n      if (this.imageQTBar && !hasClass(this.imageQTBar.element, 'e-popup-close')) {\n        this.imageQTBar.hidePopup();\n      }\n    }\n  };\n\n  QuickToolbar.prototype.onIframeMouseDown = function () {\n    this.hideQuickToolbars();\n    this.hideInlineQTBar();\n  };\n\n  QuickToolbar.prototype.updateCss = function (baseQTObj, e) {\n    if (baseQTObj && e.cssClass) {\n      if (isNullOrUndefined(e.oldCssClass && baseQTObj.quickTBarObj.toolbarObj.cssClass !== e.cssClass)) {\n        baseQTObj.quickTBarObj.toolbarObj.setProperties({\n          cssClass: (baseQTObj.quickTBarObj.toolbarObj.cssClass + ' ' + e.cssClass).trim()\n        });\n      } else {\n        baseQTObj.quickTBarObj.toolbarObj.setProperties({\n          cssClass: (baseQTObj.quickTBarObj.toolbarObj.cssClass.replace(e.oldCssClass, '').trim() + ' ' + e.cssClass).trim()\n        });\n      }\n    }\n  };\n\n  QuickToolbar.prototype.setCssClass = function (e) {\n    var baseQuickToolbarObj = [this.inlineQTBar, this.imageQTBar, this.linkQTBar, this.textQTBar, this.tableQTBar];\n\n    for (var i = 0; i < baseQuickToolbarObj.length; i++) {\n      this.updateCss(baseQuickToolbarObj[i], e);\n    }\n  };\n\n  QuickToolbar.prototype.setRtl = function (args) {\n    if (this.inlineQTBar) {\n      this.inlineQTBar.quickTBarObj.toolbarObj.setProperties({\n        enableRtl: args.enableRtl\n      });\n    }\n\n    if (this.imageQTBar) {\n      this.imageQTBar.quickTBarObj.toolbarObj.setProperties({\n        enableRtl: args.enableRtl\n      });\n    }\n\n    if (this.linkQTBar) {\n      this.linkQTBar.quickTBarObj.toolbarObj.setProperties({\n        enableRtl: args.enableRtl\n      });\n    }\n  };\n  /**\n   * removeEventListener\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off(events.initialEnd, this.initializeQuickToolbars);\n    this.parent.off(events.mouseDown, this.renderQuickToolbars);\n    this.parent.off(events.toolbarUpdated, this.toolbarUpdated);\n    this.parent.off(events.drop, this.renderQuickToolbars);\n    this.unWireInlineQTBarEvents();\n    this.parent.off(events.modelChanged, this.onPropertyChanged);\n\n    if (this.parent.quickToolbarSettings.actionOnScroll === 'hide') {\n      this.parent.off(events.scroll, this.hideQuickToolbars);\n      this.parent.off(events.contentscroll, this.hideQuickToolbars);\n    }\n\n    this.parent.off(events.focusChange, this.hideQuickToolbars);\n    this.parent.off(events.destroy, this.destroy);\n    this.parent.off(events.iframeMouseDown, this.onIframeMouseDown);\n    this.parent.off(events.keyDown, this.onKeyDown);\n    this.parent.off(events.rtlMode, this.setRtl);\n    this.parent.off(events.bindCssClass, this.setCssClass);\n  };\n  /**\n   * Called internally if any of the property value changed.\n   *\n   * @param {RichTextEditorModel} e - specifies the element.\n   * @returns {void}\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.onPropertyChanged = function (e) {\n    if (!isNullOrUndefined(e.newProp.quickToolbarSettings)) {\n      for (var _i = 0, _a = Object.keys(e.newProp.quickToolbarSettings); _i < _a.length; _i++) {\n        var prop = _a[_i];\n\n        switch (prop) {\n          case 'actionOnScroll':\n            if (e.newProp.quickToolbarSettings.actionOnScroll === 'none') {\n              this.parent.off(events.scroll, this.hideQuickToolbars);\n              this.parent.off(events.contentscroll, this.hideQuickToolbars);\n            } else {\n              this.parent.on(events.scroll, this.hideQuickToolbars, this);\n              this.parent.on(events.contentscroll, this.hideQuickToolbars, this);\n            }\n\n            break;\n        }\n      }\n    }\n\n    if (e.module !== this.getModuleName()) {\n      return;\n    }\n\n    if (this.inlineQTBar) {\n      removeClass([this.parent.element], [CLS_INLINE]);\n      this.unWireInlineQTBarEvents();\n      this.hideInlineQTBar();\n    }\n\n    if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice())) {\n      addClass([this.parent.element], [CLS_INLINE]);\n      this.wireInlineQTBarEvents();\n    }\n  };\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {void}\n   * @hidden\n   */\n\n\n  QuickToolbar.prototype.getModuleName = function () {\n    return 'quickToolbar';\n  };\n\n  return QuickToolbar;\n}();\n\nexport { QuickToolbar };","map":{"version":3,"names":["select","isNullOrUndefined","Browser","addClass","removeClass","EventHandler","closest","isNOU","RenderType","events","pageYOffset","hasClass","isIDevice","BaseQuickToolbar","PopupRenderer","CLS_INLINE_POP","CLS_INLINE","QuickToolbar","parent","locator","renderFactory","getService","addRenderer","Popup","addEventListener","prototype","formatItems","items","formattedItems","forEach","item","toLocaleLowerCase","push","getQTBarOptions","popType","mode","type","popupType","toolbarItems","renderType","cssClass","createQTBar","length","qTBar","render","initializeQuickToolbars","quickToolbarModule","contentRenderer","getRenderer","Content","inlineMode","enable","onSelection","add","getDocument","selectionChangeHandler","onMouseDown","e","isBlur","isRTE","keyUpQT","which","hideQuickToolbars","renderQuickToolbars","linkQTBar","imageQTBar","textQTBar","tableQTBar","quickToolbarSettings","link","LinkToolbar","text","TextToolbar","image","ImageToolbar","table","TableToolbar","element","renderInlineQuickToolbar","isDevice","inlineQTBar","toolbarSettings","InlineToolbar","showInlineQTBar","x","y","target","readonly","tagName","toLowerCase","showPopup","hideInlineQTBar","hidePopup","document","body","contains","deBounce","_this","clearTimeout","deBouncer","window","setTimeout","mouseUpHandler","args","touches","changedTouches","range","getRange","touchData","prevClientX","clientX","prevClientY","clientY","parentLeft","getBoundingClientRect","left","offsetX","iframeSettings","pageXOffset","pageX","offsetY","nodeName","closestAnchor","startNode","startContainer","parentElement","endNode","endContainer","collapsed","startOffset","endOffset","keyDownHandler","inlineQTBarMouseDownHandler","keyUpHandler","onSelectionChange","selection","getSelection","isCollapsed","getInlineBaseToolbar","quickTBarObj","destroy","remove","removeEventListener","wireInlineQTBarEvents","on","mouseUp","mouseDown","keyDown","keyUp","sourceCodeMouseDown","renderInlineToolbar","unWireInlineQTBarEvents","off","toolbarUpdated","isDestroyed","initialEnd","drop","modelChanged","onPropertyChanged","actionOnScroll","scroll","contentscroll","focusChange","iframeMouseDown","onIframeMouseDown","onKeyDown","rtlMode","setRtl","bindCssClass","setCssClass","updateCss","baseQTObj","oldCssClass","toolbarObj","setProperties","trim","replace","baseQuickToolbarObj","i","enableRtl","newProp","_i","_a","Object","keys","prop","module","getModuleName"],"sources":["/home/morgan/Desktop/Projets/ENT4/Jwt-Auth-pdf/react-jwt-auth/react-jwt-auth/node_modules/@syncfusion/ej2-richtexteditor/src/rich-text-editor/actions/quick-toolbar.js"],"sourcesContent":["import { select, isNullOrUndefined, Browser, addClass, removeClass, EventHandler, closest, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport { RenderType } from '../base/enum';\nimport * as events from '../base/constant';\nimport { pageYOffset, hasClass, isIDevice } from '../base/util';\nimport { BaseQuickToolbar } from './base-quick-toolbar';\nimport { PopupRenderer } from '../renderer/popup-renderer';\nimport { CLS_INLINE_POP, CLS_INLINE } from '../base/classes';\n/**\n * `Quick toolbar` module is used to handle Quick toolbar actions.\n */\nvar QuickToolbar = /** @class */ (function () {\n    function QuickToolbar(parent, locator) {\n        this.parent = parent;\n        this.locator = locator;\n        this.renderFactory = this.locator.getService('rendererFactory');\n        this.renderFactory.addRenderer(RenderType.Popup, new PopupRenderer(this.parent));\n        this.addEventListener();\n    }\n    QuickToolbar.prototype.formatItems = function (items) {\n        var formattedItems = [];\n        items.forEach(function (item) {\n            if (typeof item === 'string') {\n                switch (item.toLocaleLowerCase()) {\n                    case 'open':\n                        formattedItems.push('openLink');\n                        break;\n                    case 'edit':\n                        formattedItems.push('editLink');\n                        break;\n                    case 'unlink':\n                        formattedItems.push('removeLink');\n                        break;\n                    default:\n                        formattedItems.push(item);\n                        break;\n                }\n            }\n            else {\n                formattedItems.push(item);\n            }\n        });\n        return formattedItems;\n    };\n    QuickToolbar.prototype.getQTBarOptions = function (popType, mode, items, type) {\n        return {\n            popupType: popType,\n            toolbarItems: items,\n            mode: mode,\n            renderType: type,\n            cssClass: this.parent.cssClass\n        };\n    };\n    /**\n     * createQTBar method\n     *\n     * @param {string} popupType - specifies the string value\n     * @param {string} mode - specifies the string value.\n     * @param {string} items - specifies the string.\n     * @param {RenderType} type - specifies the render type.\n     * @returns {BaseQuickToolbar} - specifies the quick toolbar\n     * @hidden\n\n     */\n    QuickToolbar.prototype.createQTBar = function (popupType, mode, items, type) {\n        if (items.length < 1) {\n            return null;\n        }\n        var qTBar = new BaseQuickToolbar(this.parent, this.locator);\n        qTBar.render(this.getQTBarOptions(popupType, mode, this.formatItems(items), type));\n        return qTBar;\n    };\n    QuickToolbar.prototype.initializeQuickToolbars = function () {\n        this.parent.quickToolbarModule = this;\n        this.contentRenderer = this.renderFactory.getRenderer(RenderType.Content);\n        if (this.parent.inlineMode.enable && this.parent.inlineMode.onSelection && isIDevice()) {\n            EventHandler.add(this.contentRenderer.getDocument(), 'selectionchange', this.selectionChangeHandler, this);\n        }\n    };\n    // eslint-disable-next-line\n    QuickToolbar.prototype.onMouseDown = function (e) {\n        this.parent.isBlur = false;\n        this.parent.isRTE = true;\n    };\n    QuickToolbar.prototype.keyUpQT = function (e) {\n        if (e.which == 27) {\n            this.hideQuickToolbars();\n        }\n    };\n    QuickToolbar.prototype.renderQuickToolbars = function () {\n        if (this.linkQTBar || this.imageQTBar || this.textQTBar || this.tableQTBar) {\n            return;\n        }\n        this.linkQTBar = this.createQTBar('Link', 'Scrollable', this.parent.quickToolbarSettings.link, RenderType.LinkToolbar);\n        this.renderFactory.addRenderer(RenderType.LinkToolbar, this.linkQTBar);\n        this.textQTBar = this.createQTBar('Text', 'Scrollable', this.parent.quickToolbarSettings.text, RenderType.TextToolbar);\n        this.renderFactory.addRenderer(RenderType.TextToolbar, this.textQTBar);\n        this.imageQTBar = this.createQTBar('Image', 'MultiRow', this.parent.quickToolbarSettings.image, RenderType.ImageToolbar);\n        this.renderFactory.addRenderer(RenderType.ImageToolbar, this.imageQTBar);\n        this.tableQTBar = this.createQTBar('Table', 'MultiRow', this.parent.quickToolbarSettings.table, RenderType.TableToolbar);\n        this.renderFactory.addRenderer(RenderType.TableToolbar, this.tableQTBar);\n        if (this.linkQTBar) {\n            EventHandler.add(this.linkQTBar.element, 'mousedown', this.onMouseDown, this);\n            EventHandler.add(this.linkQTBar.element, 'keyup', this.keyUpQT, this);\n        }\n        if (this.imageQTBar) {\n            EventHandler.add(this.imageQTBar.element, 'mousedown', this.onMouseDown, this);\n            EventHandler.add(this.imageQTBar.element, 'keyup', this.keyUpQT, this);\n        }\n        if (this.textQTBar) {\n            EventHandler.add(this.textQTBar.element, 'mousedown', this.onMouseDown, this);\n            EventHandler.add(this.textQTBar.element, 'keyup', this.keyUpQT, this);\n        }\n        if (this.tableQTBar) {\n            EventHandler.add(this.tableQTBar.element, 'mousedown', this.onMouseDown, this);\n            EventHandler.add(this.tableQTBar.element, 'keyup', this.keyUpQT, this);\n        }\n    };\n    QuickToolbar.prototype.renderInlineQuickToolbar = function () {\n        if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice())) {\n            addClass([this.parent.element], [CLS_INLINE]);\n            this.inlineQTBar = this.createQTBar('Inline', 'MultiRow', this.parent.toolbarSettings.items, RenderType.InlineToolbar);\n            this.renderFactory.addRenderer(RenderType.InlineToolbar, this.inlineQTBar);\n            EventHandler.add(this.inlineQTBar.element, 'mousedown', this.onMouseDown, this);\n            EventHandler.add(this.inlineQTBar.element, 'keyup', this.keyUpQT, this);\n        }\n    };\n    /**\n     * Method for showing the inline quick toolbar\n     *\n     * @param {number} x -specifies the value of x.\n     * @param {number} y - specifies the y valu.\n     * @param {HTMLElement} target - specifies the target element.\n     * @returns {void}\n     * @hidden\n\n     */\n    QuickToolbar.prototype.showInlineQTBar = function (x, y, target) {\n        if (this.parent.readonly || target.tagName.toLowerCase() === \"img\") {\n            return;\n        }\n        this.inlineQTBar.showPopup(x, y, target);\n    };\n    /**\n     * Method for hidding the inline quick toolbar\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    QuickToolbar.prototype.hideInlineQTBar = function () {\n        if (this.inlineQTBar && !hasClass(this.inlineQTBar.element, 'e-popup-close')) {\n            this.inlineQTBar.hidePopup();\n        }\n    };\n    /**\n     * Method for hidding the quick toolbar\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    QuickToolbar.prototype.hideQuickToolbars = function () {\n        if (this.linkQTBar && !hasClass(this.linkQTBar.element, 'e-popup-close') && document.body.contains(this.linkQTBar.element)) {\n            this.linkQTBar.hidePopup();\n        }\n        if (this.textQTBar && !hasClass(this.textQTBar.element, 'e-popup-close') && document.body.contains(this.textQTBar.element)) {\n            this.textQTBar.hidePopup();\n        }\n        if (this.imageQTBar && !hasClass(this.imageQTBar.element, 'e-popup-close') && document.body.contains(this.imageQTBar.element)) {\n            this.imageQTBar.hidePopup();\n        }\n        if (this.tableQTBar && !hasClass(this.tableQTBar.element, 'e-popup-close') && document.body.contains(this.tableQTBar.element)) {\n            this.tableQTBar.hidePopup();\n        }\n        if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice())) {\n            this.hideInlineQTBar();\n        }\n    };\n    QuickToolbar.prototype.deBounce = function (x, y, target) {\n        var _this = this;\n        clearTimeout(this.deBouncer);\n        this.deBouncer = window.setTimeout(function () {\n            _this.showInlineQTBar(x, y, target);\n        }, 1000);\n    };\n    QuickToolbar.prototype.mouseUpHandler = function (e) {\n        if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice())) {\n            var args = e.args.touches ?\n                e.args.changedTouches[0] : e.args;\n            var range = this.parent.getRange();\n            var target = e.args.target;\n            if (isNullOrUndefined(select('.' + CLS_INLINE_POP, document.body))) {\n                if (isIDevice() && e.touchData && e.touchData.prevClientX !== e.touchData.clientX\n                    && e.touchData.prevClientY !== e.touchData.clientY) {\n                    return;\n                }\n                this.hideInlineQTBar();\n                var parentLeft = this.parent.element.getBoundingClientRect().left;\n                this.offsetX = this.parent.iframeSettings.enable ? window.pageXOffset + parentLeft + args.clientX : args.pageX;\n                this.offsetY = pageYOffset(args, this.parent.element, this.parent.iframeSettings.enable);\n                if (target.nodeName === 'TEXTAREA') {\n                    this.showInlineQTBar(this.offsetX, this.offsetY, target);\n                }\n                else {\n                    var closestAnchor = closest(target, 'a');\n                    target = closestAnchor ? closestAnchor : target;\n                    var startNode = this.parent.getRange().startContainer.parentElement;\n                    var endNode = this.parent.getRange().endContainer.parentElement;\n                    if ((isNOU(closest(startNode, 'A')) || isNOU(closest(endNode, 'A'))) && (!closest(target, 'td,th') || !range.collapsed) &&\n                        (target.tagName !== 'IMG' || this.parent.getRange().startOffset !== this.parent.getRange().endOffset)) {\n                        if (this.parent.inlineMode.onSelection && range.collapsed) {\n                            return;\n                        }\n                        this.target = target;\n                        this.showInlineQTBar(this.offsetX, this.offsetY, target);\n                    }\n                }\n            }\n        }\n    };\n    QuickToolbar.prototype.keyDownHandler = function () {\n        if ((this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice()))\n            && !isNullOrUndefined(select('.' + CLS_INLINE_POP, document))) {\n            this.hideInlineQTBar();\n        }\n    };\n    QuickToolbar.prototype.inlineQTBarMouseDownHandler = function () {\n        if ((this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice()))\n            && !isNullOrUndefined(select('.' + CLS_INLINE_POP, document))) {\n            this.hideInlineQTBar();\n        }\n    };\n    QuickToolbar.prototype.keyUpHandler = function (e) {\n        if (this.parent.inlineMode.enable && !Browser.isDevice) {\n            if (this.parent.inlineMode.onSelection) {\n                return;\n            }\n            var args = e.args;\n            this.deBounce(this.offsetX, this.offsetY, args.target);\n        }\n    };\n    QuickToolbar.prototype.selectionChangeHandler = function (e) {\n        var _this = this;\n        clearTimeout(this.deBouncer);\n        this.deBouncer = window.setTimeout(function () {\n            _this.onSelectionChange(e);\n        }, 1000);\n    };\n    QuickToolbar.prototype.onSelectionChange = function (e) {\n        if (!isNullOrUndefined(select('.' + CLS_INLINE_POP, document.body))) {\n            return;\n        }\n        var selection = this.contentRenderer.getDocument().getSelection();\n        if (!selection.isCollapsed) {\n            this.mouseUpHandler({ args: e });\n        }\n    };\n    /**\n     * getInlineBaseToolbar method\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    QuickToolbar.prototype.getInlineBaseToolbar = function () {\n        return this.inlineQTBar && this.inlineQTBar.quickTBarObj;\n    };\n    /**\n     * Destroys the ToolBar.\n     *\n     * @function destroy\n     * @returns {void}\n     * @hidden\n\n     */\n    QuickToolbar.prototype.destroy = function () {\n        if (this.linkQTBar) {\n            EventHandler.remove(this.linkQTBar.element, 'mousedown', this.onMouseDown);\n            EventHandler.remove(this.linkQTBar.element, 'keyup', this.keyUpQT);\n            this.linkQTBar.destroy();\n        }\n        if (this.textQTBar) {\n            EventHandler.remove(this.textQTBar.element, 'mousedown', this.onMouseDown);\n            EventHandler.remove(this.textQTBar.element, 'keyup', this.keyUpQT);\n            this.textQTBar.destroy();\n        }\n        if (this.imageQTBar) {\n            EventHandler.remove(this.imageQTBar.element, 'mousedown', this.onMouseDown);\n            EventHandler.remove(this.imageQTBar.element, 'keyup', this.keyUpQT);\n            this.imageQTBar.destroy();\n        }\n        if (this.tableQTBar) {\n            EventHandler.remove(this.tableQTBar.element, 'mousedown', this.onMouseDown);\n            EventHandler.remove(this.tableQTBar.element, 'keyup', this.keyUpQT);\n            this.tableQTBar.destroy();\n        }\n        if (this.inlineQTBar) {\n            EventHandler.remove(this.inlineQTBar.element, 'mousedown', this.onMouseDown);\n            EventHandler.remove(this.inlineQTBar.element, 'keyup', this.keyUpQT);\n            if (isIDevice()) {\n                EventHandler.remove(document, 'selectionchange', this.selectionChangeHandler);\n            }\n            this.inlineQTBar.destroy();\n        }\n        this.removeEventListener();\n    };\n    QuickToolbar.prototype.wireInlineQTBarEvents = function () {\n        this.parent.on(events.mouseUp, this.mouseUpHandler, this);\n        this.parent.on(events.mouseDown, this.inlineQTBarMouseDownHandler, this);\n        this.parent.on(events.keyDown, this.keyDownHandler, this);\n        this.parent.on(events.keyUp, this.keyUpHandler, this);\n        this.parent.on(events.sourceCodeMouseDown, this.mouseUpHandler, this);\n        this.parent.on(events.renderInlineToolbar, this.renderInlineQuickToolbar, this);\n    };\n    QuickToolbar.prototype.unWireInlineQTBarEvents = function () {\n        this.parent.off(events.mouseUp, this.mouseUpHandler);\n        this.parent.off(events.mouseDown, this.inlineQTBarMouseDownHandler);\n        this.parent.off(events.keyDown, this.keyDownHandler);\n        this.parent.off(events.keyUp, this.keyUpHandler);\n        this.parent.off(events.sourceCodeMouseDown, this.mouseUpHandler);\n        this.parent.off(events.renderInlineToolbar, this.renderInlineQuickToolbar);\n    };\n    // eslint-disable-next-line\n    QuickToolbar.prototype.toolbarUpdated = function (args) {\n        if (this.linkQTBar && !hasClass(this.linkQTBar.element, 'e-popup-close')) {\n            this.linkQTBar.hidePopup();\n        }\n        if (this.imageQTBar && !hasClass(this.imageQTBar.element, 'e-popup-close')) {\n            this.imageQTBar.hidePopup();\n        }\n        if (this.tableQTBar && !hasClass(this.tableQTBar.element, 'e-popup-close')) {\n            this.tableQTBar.hidePopup();\n        }\n    };\n    /**\n     * addEventListener\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    QuickToolbar.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.initialEnd, this.initializeQuickToolbars, this);\n        this.parent.on(events.mouseDown, this.renderQuickToolbars, this);\n        this.parent.on(events.toolbarUpdated, this.toolbarUpdated, this);\n        this.parent.on(events.drop, this.renderQuickToolbars, this);\n        this.wireInlineQTBarEvents();\n        this.parent.on(events.modelChanged, this.onPropertyChanged, this);\n        if (this.parent.quickToolbarSettings.actionOnScroll === 'hide') {\n            this.parent.on(events.scroll, this.hideQuickToolbars, this);\n            this.parent.on(events.contentscroll, this.hideQuickToolbars, this);\n        }\n        this.parent.on(events.focusChange, this.hideQuickToolbars, this);\n        this.parent.on(events.iframeMouseDown, this.onIframeMouseDown, this);\n        this.parent.on(events.destroy, this.destroy, this);\n        this.parent.on(events.keyDown, this.onKeyDown, this);\n        this.parent.on(events.rtlMode, this.setRtl, this);\n        this.parent.on(events.bindCssClass, this.setCssClass, this);\n    };\n    QuickToolbar.prototype.onKeyDown = function (e) {\n        var args = e.args;\n        if (args.which === 8 || args.which === 46) {\n            if (this.imageQTBar && !hasClass(this.imageQTBar.element, 'e-popup-close')) {\n                this.imageQTBar.hidePopup();\n            }\n        }\n    };\n    QuickToolbar.prototype.onIframeMouseDown = function () {\n        this.hideQuickToolbars();\n        this.hideInlineQTBar();\n    };\n    QuickToolbar.prototype.updateCss = function (baseQTObj, e) {\n        if (baseQTObj && e.cssClass) {\n            if (isNullOrUndefined(e.oldCssClass && baseQTObj.quickTBarObj.toolbarObj.cssClass !== e.cssClass)) {\n                baseQTObj.quickTBarObj.toolbarObj.setProperties({ cssClass: (baseQTObj.quickTBarObj.toolbarObj.cssClass + ' ' + e.cssClass).trim() });\n            }\n            else {\n                baseQTObj.quickTBarObj.toolbarObj.setProperties({ cssClass: (baseQTObj.quickTBarObj.toolbarObj.cssClass.replace(e.oldCssClass, '').trim() + ' ' + e.cssClass).trim() });\n            }\n        }\n    };\n    QuickToolbar.prototype.setCssClass = function (e) {\n        var baseQuickToolbarObj = [\n            this.inlineQTBar, this.imageQTBar, this.linkQTBar, this.textQTBar, this.tableQTBar\n        ];\n        for (var i = 0; i < baseQuickToolbarObj.length; i++) {\n            this.updateCss(baseQuickToolbarObj[i], e);\n        }\n    };\n    QuickToolbar.prototype.setRtl = function (args) {\n        if (this.inlineQTBar) {\n            this.inlineQTBar.quickTBarObj.toolbarObj.setProperties({ enableRtl: args.enableRtl });\n        }\n        if (this.imageQTBar) {\n            this.imageQTBar.quickTBarObj.toolbarObj.setProperties({ enableRtl: args.enableRtl });\n        }\n        if (this.linkQTBar) {\n            this.linkQTBar.quickTBarObj.toolbarObj.setProperties({ enableRtl: args.enableRtl });\n        }\n    };\n    /**\n     * removeEventListener\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    QuickToolbar.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.initialEnd, this.initializeQuickToolbars);\n        this.parent.off(events.mouseDown, this.renderQuickToolbars);\n        this.parent.off(events.toolbarUpdated, this.toolbarUpdated);\n        this.parent.off(events.drop, this.renderQuickToolbars);\n        this.unWireInlineQTBarEvents();\n        this.parent.off(events.modelChanged, this.onPropertyChanged);\n        if (this.parent.quickToolbarSettings.actionOnScroll === 'hide') {\n            this.parent.off(events.scroll, this.hideQuickToolbars);\n            this.parent.off(events.contentscroll, this.hideQuickToolbars);\n        }\n        this.parent.off(events.focusChange, this.hideQuickToolbars);\n        this.parent.off(events.destroy, this.destroy);\n        this.parent.off(events.iframeMouseDown, this.onIframeMouseDown);\n        this.parent.off(events.keyDown, this.onKeyDown);\n        this.parent.off(events.rtlMode, this.setRtl);\n        this.parent.off(events.bindCssClass, this.setCssClass);\n    };\n    /**\n     * Called internally if any of the property value changed.\n     *\n     * @param {RichTextEditorModel} e - specifies the element.\n     * @returns {void}\n     * @hidden\n\n     */\n    QuickToolbar.prototype.onPropertyChanged = function (e) {\n        if (!isNullOrUndefined(e.newProp.quickToolbarSettings)) {\n            for (var _i = 0, _a = Object.keys(e.newProp.quickToolbarSettings); _i < _a.length; _i++) {\n                var prop = _a[_i];\n                switch (prop) {\n                    case 'actionOnScroll':\n                        if (e.newProp.quickToolbarSettings.actionOnScroll === 'none') {\n                            this.parent.off(events.scroll, this.hideQuickToolbars);\n                            this.parent.off(events.contentscroll, this.hideQuickToolbars);\n                        }\n                        else {\n                            this.parent.on(events.scroll, this.hideQuickToolbars, this);\n                            this.parent.on(events.contentscroll, this.hideQuickToolbars, this);\n                        }\n                        break;\n                }\n            }\n        }\n        if (e.module !== this.getModuleName()) {\n            return;\n        }\n        if (this.inlineQTBar) {\n            removeClass([this.parent.element], [CLS_INLINE]);\n            this.unWireInlineQTBarEvents();\n            this.hideInlineQTBar();\n        }\n        if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice())) {\n            addClass([this.parent.element], [CLS_INLINE]);\n            this.wireInlineQTBarEvents();\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {void}\n     * @hidden\n     */\n    QuickToolbar.prototype.getModuleName = function () {\n        return 'quickToolbar';\n    };\n    return QuickToolbar;\n}());\nexport { QuickToolbar };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}