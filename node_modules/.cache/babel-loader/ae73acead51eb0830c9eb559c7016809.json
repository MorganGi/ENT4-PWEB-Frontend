{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar core = require('@react-pdf-viewer/core');\n\nvar React = require('react');\n\nfunction _interopNamespace(e) {\n  if (e && e.__esModule) return e;\n  var n = Object.create(null);\n\n  if (e) {\n    Object.keys(e).forEach(function (k) {\n      if (k !== 'default') {\n        var d = Object.getOwnPropertyDescriptor(e, k);\n        Object.defineProperty(n, k, d.get ? d : {\n          enumerable: true,\n          get: function () {\n            return e[k];\n          }\n        });\n      }\n    });\n  }\n\n  n[\"default\"] = e;\n  return Object.freeze(n);\n}\n\nvar React__namespace = /*#__PURE__*/_interopNamespace(React);\n\nvar NextIcon = function () {\n  return React__namespace.createElement(core.Icon, {\n    size: 16\n  }, React__namespace.createElement(\"path\", {\n    d: \"M0.541,5.627L11.666,18.2c0.183,0.207,0.499,0.226,0.706,0.043c0.015-0.014,0.03-0.028,0.043-0.043\\n            L23.541,5.627\"\n  }));\n};\n\nvar PreviousIcon = function () {\n  return React__namespace.createElement(core.Icon, {\n    size: 16\n  }, React__namespace.createElement(\"path\", {\n    d: \"M23.535,18.373L12.409,5.8c-0.183-0.207-0.499-0.226-0.706-0.043C11.688,5.77,11.674,5.785,11.66,5.8\\n            L0.535,18.373\"\n  }));\n};\n\nvar SearchIcon = function () {\n  return React__namespace.createElement(core.Icon, {\n    ignoreDirection: true,\n    size: 16\n  }, React__namespace.createElement(\"path\", {\n    d: \"M10.5,0.5c5.523,0,10,4.477,10,10s-4.477,10-10,10s-10-4.477-10-10S4.977,0.5,10.5,0.5z\\n            M23.5,23.5\\n            l-5.929-5.929\"\n  }));\n};\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar EMPTY_KEYWORD_REGEXP = {\n  keyword: '',\n  regExp: new RegExp(' '),\n  wholeWords: false\n};\n\nvar calculateOffset = function (children, parent) {\n  var top = children.offsetTop;\n  var left = children.offsetLeft;\n  var p = children.parentElement;\n\n  while (p && p !== parent) {\n    top += p.offsetTop;\n    left += p.offsetLeft;\n    p = p.parentElement;\n  }\n\n  return {\n    left: left,\n    top: top\n  };\n};\n\nvar getCssProperties = function (area) {\n  return {\n    left: \"\".concat(area.left, \"%\"),\n    top: \"\".concat(area.top, \"%\"),\n    height: \"\".concat(area.height, \"%\"),\n    width: \"\".concat(area.width, \"%\")\n  };\n};\n\nvar HightlightItem = function (_a) {\n  var index = _a.index,\n      area = _a.area,\n      onHighlightKeyword = _a.onHighlightKeyword;\n  var containerRef = React__namespace.useRef();\n  core.useIsomorphicLayoutEffect(function () {\n    var highlightEle = containerRef.current;\n\n    if (onHighlightKeyword && highlightEle) {\n      onHighlightKeyword({\n        highlightEle: highlightEle,\n        keyword: area.keyword\n      });\n    }\n  }, []);\n  return React__namespace.createElement(\"div\", {\n    className: \"rpv-search__highlight\",\n    \"data-index\": index,\n    ref: containerRef,\n    style: getCssProperties(area),\n    title: area.keywordStr.trim()\n  });\n};\n\nvar removeNode = function (ele) {\n  var parent = ele.parentNode;\n\n  if (parent) {\n    parent.removeChild(ele);\n  }\n};\n\nvar replaceNode = function (replacementNode, node) {\n  removeNode(replacementNode);\n  var parent = node.parentNode;\n\n  if (parent) {\n    parent.insertBefore(replacementNode, node);\n  }\n\n  removeNode(node);\n};\n\nvar unwrap = function (ele) {\n  var parent = ele.parentNode;\n\n  if (!parent) {\n    return;\n  }\n\n  var range = document.createRange();\n  range.selectNodeContents(ele);\n  replaceNode(range.extractContents(), ele);\n  parent.normalize();\n};\n\nvar sortHighlightPosition = function (a, b) {\n  if (a.top < b.top) {\n    return -1;\n  }\n\n  if (a.top > b.top) {\n    return 1;\n  }\n\n  if (a.left < b.left) {\n    return -1;\n  }\n\n  if (a.left > b.left) {\n    return 1;\n  }\n\n  return 0;\n};\n\nvar Highlights = function (_a) {\n  var numPages = _a.numPages,\n      pageIndex = _a.pageIndex,\n      renderHighlights = _a.renderHighlights,\n      store = _a.store,\n      onHighlightKeyword = _a.onHighlightKeyword;\n  var containerRef = React__namespace.useRef();\n  var defaultRenderHighlights = React__namespace.useCallback(function (renderProps) {\n    return React__namespace.createElement(React__namespace.Fragment, null, renderProps.highlightAreas.map(function (area, index) {\n      return React__namespace.createElement(HightlightItem, {\n        index: index,\n        key: index,\n        area: area,\n        onHighlightKeyword: onHighlightKeyword\n      });\n    }));\n  }, []);\n  var renderHighlightElements = renderHighlights || defaultRenderHighlights;\n\n  var _b = React__namespace.useState(store.get('matchPosition')),\n      matchPosition = _b[0],\n      setMatchPosition = _b[1];\n\n  var _c = React__namespace.useState(store.get('keyword') || [EMPTY_KEYWORD_REGEXP]),\n      keywordRegexp = _c[0],\n      setKeywordRegexp = _c[1];\n\n  var _d = React__namespace.useState({\n    pageIndex: pageIndex,\n    scale: 1,\n    status: core.LayerRenderStatus.PreRender\n  }),\n      renderStatus = _d[0],\n      setRenderStatus = _d[1];\n\n  var currentMatchRef = React__namespace.useRef(null);\n  var characterIndexesRef = React__namespace.useRef([]);\n\n  var _e = React__namespace.useState([]),\n      highlightAreas = _e[0],\n      setHighlightAreas = _e[1];\n\n  var defaultTargetPageFilter = function () {\n    return true;\n  };\n\n  var targetPageFilter = React__namespace.useCallback(function () {\n    return store.get('targetPageFilter') || defaultTargetPageFilter;\n  }, [store.get('targetPageFilter')]);\n\n  var highlight = function (keywordStr, keyword, textLayerEle, span, charIndexSpan) {\n    var range = document.createRange();\n    var firstChild = span.firstChild;\n\n    if (!firstChild || firstChild.nodeType !== Node.TEXT_NODE) {\n      return null;\n    }\n\n    var length = firstChild.textContent.length;\n    var startOffset = charIndexSpan[0].charIndexInSpan;\n    var endOffset = charIndexSpan.length === 1 ? startOffset : charIndexSpan[charIndexSpan.length - 1].charIndexInSpan;\n\n    if (startOffset > length || endOffset + 1 > length) {\n      return null;\n    }\n\n    range.setStart(firstChild, startOffset);\n    range.setEnd(firstChild, endOffset + 1);\n    var wrapper = document.createElement('span');\n    range.surroundContents(wrapper);\n    var wrapperRect = wrapper.getBoundingClientRect();\n    var textLayerRect = textLayerEle.getBoundingClientRect();\n    var pageHeight = textLayerRect.height;\n    var pageWidth = textLayerRect.width;\n    var left = 100 * (wrapperRect.left - textLayerRect.left) / pageWidth;\n    var top = 100 * (wrapperRect.top - textLayerRect.top) / pageHeight;\n    var height = 100 * wrapperRect.height / pageHeight;\n    var width = 100 * wrapperRect.width / pageWidth;\n    unwrap(wrapper);\n    return {\n      keyword: keyword,\n      keywordStr: keywordStr,\n      numPages: numPages,\n      pageIndex: pageIndex,\n      left: left,\n      top: top,\n      height: height,\n      width: width,\n      pageHeight: pageHeight,\n      pageWidth: pageWidth\n    };\n  };\n\n  var highlightAll = function (textLayerEle) {\n    var charIndexes = characterIndexesRef.current;\n\n    if (charIndexes.length === 0) {\n      return [];\n    }\n\n    var highlightPos = [];\n    var spans = [].slice.call(textLayerEle.querySelectorAll('.rpv-core__text-layer-text'));\n    var fullText = charIndexes.map(function (item) {\n      return item.char;\n    }).join('');\n    keywordRegexp.forEach(function (keyword) {\n      var keywordStr = keyword.keyword;\n\n      if (!keywordStr.trim()) {\n        return;\n      }\n\n      var cloneKeyword = keyword.regExp.flags.indexOf('g') === -1 ? new RegExp(keyword.regExp, \"\".concat(keyword.regExp.flags, \"g\")) : keyword.regExp;\n      var match;\n      var matches = [];\n\n      while ((match = cloneKeyword.exec(fullText)) !== null) {\n        matches.push({\n          keyword: cloneKeyword,\n          startIndex: match.index,\n          endIndex: cloneKeyword.lastIndex\n        });\n      }\n\n      matches.map(function (item) {\n        return {\n          keyword: item.keyword,\n          indexes: charIndexes.slice(item.startIndex, item.endIndex)\n        };\n      }).forEach(function (item) {\n        var spanIndexes = item.indexes.reduce(function (acc, item) {\n          acc[item.spanIndex] = (acc[item.spanIndex] || []).concat([item]);\n          return acc;\n        }, {});\n        Object.values(spanIndexes).forEach(function (charIndexSpan) {\n          if (charIndexSpan.length !== 1 || charIndexSpan[0].char.trim() !== '') {\n            var normalizedCharSpan = keyword.wholeWords ? charIndexSpan.slice(1, -1) : charIndexSpan;\n            var hightlighPosition = highlight(keywordStr, item.keyword, textLayerEle, spans[normalizedCharSpan[0].spanIndex], normalizedCharSpan);\n\n            if (hightlighPosition) {\n              highlightPos.push(hightlighPosition);\n            }\n          }\n        });\n      });\n    });\n    return highlightPos.sort(sortHighlightPosition);\n  };\n\n  var handleKeywordChanged = function (keyword) {\n    if (keyword && keyword.length > 0) {\n      setKeywordRegexp(keyword);\n    }\n  };\n\n  var handleMatchPositionChanged = function (currentPosition) {\n    return setMatchPosition(currentPosition);\n  };\n\n  var handleRenderStatusChanged = function (status) {\n    if (!status.has(pageIndex)) {\n      return;\n    }\n\n    var currentStatus = status.get(pageIndex);\n\n    if (currentStatus) {\n      setRenderStatus({\n        ele: currentStatus.ele,\n        pageIndex: pageIndex,\n        scale: currentStatus.scale,\n        status: currentStatus.status\n      });\n    }\n  };\n\n  var isEmptyKeyword = function () {\n    return keywordRegexp.length === 0 || keywordRegexp.length === 1 && keywordRegexp[0].keyword.trim() === '';\n  };\n\n  React__namespace.useEffect(function () {\n    if (isEmptyKeyword() || renderStatus.status !== core.LayerRenderStatus.DidRender || characterIndexesRef.current.length) {\n      return;\n    }\n\n    var textLayerEle = renderStatus.ele;\n    var spans = [].slice.call(textLayerEle.querySelectorAll('.rpv-core__text-layer-text'));\n    var charIndexes = spans.map(function (span) {\n      return span.textContent;\n    }).reduce(function (prev, curr, index) {\n      return prev.concat(curr.split('').map(function (c, i) {\n        return {\n          char: c,\n          charIndexInSpan: i,\n          spanIndex: index\n        };\n      }));\n    }, [{\n      char: '',\n      charIndexInSpan: 0,\n      spanIndex: 0\n    }]).slice(1);\n    characterIndexesRef.current = charIndexes;\n  }, [keywordRegexp, renderStatus.status]);\n  React__namespace.useEffect(function () {\n    if (isEmptyKeyword() || !renderStatus.ele || renderStatus.status !== core.LayerRenderStatus.DidRender || !targetPageFilter()({\n      pageIndex: pageIndex,\n      numPages: numPages\n    })) {\n      return;\n    }\n\n    var textLayerEle = renderStatus.ele;\n    var highlightPos = highlightAll(textLayerEle);\n    setHighlightAreas(highlightPos);\n  }, [keywordRegexp, matchPosition, renderStatus.status, characterIndexesRef.current]);\n  React__namespace.useEffect(function () {\n    if (isEmptyKeyword() && renderStatus.ele && renderStatus.status === core.LayerRenderStatus.DidRender) {\n      setHighlightAreas([]);\n    }\n  }, [keywordRegexp, renderStatus.status]);\n  React__namespace.useEffect(function () {\n    if (highlightAreas.length === 0) {\n      return;\n    }\n\n    var container = containerRef.current;\n\n    if (matchPosition.pageIndex !== pageIndex || !container || renderStatus.status !== core.LayerRenderStatus.DidRender) {\n      return;\n    }\n\n    var highlightEle = container.querySelector(\".rpv-search__highlight[data-index=\\\"\".concat(matchPosition.matchIndex, \"\\\"]\"));\n\n    if (!highlightEle) {\n      return;\n    }\n\n    var _a = calculateOffset(highlightEle, container),\n        left = _a.left,\n        top = _a.top;\n\n    var jump = store.get('jumpToDestination');\n\n    if (jump) {\n      jump(pageIndex, (container.getBoundingClientRect().height - top) / renderStatus.scale, left / renderStatus.scale, renderStatus.scale);\n\n      if (currentMatchRef.current) {\n        currentMatchRef.current.classList.remove('rpv-search__highlight--current');\n      }\n\n      currentMatchRef.current = highlightEle;\n      highlightEle.classList.add('rpv-search__highlight--current');\n    }\n  }, [highlightAreas, matchPosition]);\n  React__namespace.useEffect(function () {\n    store.subscribe('keyword', handleKeywordChanged);\n    store.subscribe('matchPosition', handleMatchPositionChanged);\n    store.subscribe('renderStatus', handleRenderStatusChanged);\n    return function () {\n      store.unsubscribe('keyword', handleKeywordChanged);\n      store.unsubscribe('matchPosition', handleMatchPositionChanged);\n      store.unsubscribe('renderStatus', handleRenderStatusChanged);\n    };\n  }, []);\n  return React__namespace.createElement(\"div\", {\n    className: \"rpv-search__highlights\",\n    \"data-testid\": \"search__highlights-\".concat(pageIndex),\n    ref: containerRef\n  }, renderHighlightElements({\n    getCssProperties: getCssProperties,\n    highlightAreas: highlightAreas\n  }));\n};\n\nvar escapeRegExp = function (input) {\n  return input.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n};\n\nvar normalizeFlagKeyword = function (flagKeyword) {\n  var source = flagKeyword.wholeWords ? \" \".concat(flagKeyword.keyword, \" \") : flagKeyword.keyword;\n  var flags = flagKeyword.matchCase ? 'g' : 'gi';\n  return {\n    keyword: flagKeyword.keyword,\n    regExp: new RegExp(escapeRegExp(source), flags),\n    wholeWords: flagKeyword.wholeWords || false\n  };\n};\n\nvar normalizeSingleKeyword = function (keyword, matchCase, wholeWords) {\n  if (keyword instanceof RegExp) {\n    return {\n      keyword: keyword.source,\n      regExp: keyword,\n      wholeWords: wholeWords || false\n    };\n  }\n\n  if (typeof keyword === 'string') {\n    return keyword === '' ? EMPTY_KEYWORD_REGEXP : normalizeFlagKeyword({\n      keyword: keyword,\n      matchCase: matchCase || false,\n      wholeWords: wholeWords || false\n    });\n  }\n\n  if (typeof matchCase !== 'undefined') {\n    keyword.matchCase = matchCase;\n  }\n\n  if (typeof wholeWords !== 'undefined') {\n    keyword.wholeWords = wholeWords;\n  }\n\n  return normalizeFlagKeyword(keyword);\n};\n\nvar useDocument = function (store) {\n  var currentDocRef = React__namespace.useRef(store.get('doc'));\n\n  var handleDocumentChanged = function (doc) {\n    currentDocRef.current = doc;\n  };\n\n  React__namespace.useEffect(function () {\n    store.subscribe('doc', handleDocumentChanged);\n    return function () {\n      store.unsubscribe('doc', handleDocumentChanged);\n    };\n  }, []);\n  return currentDocRef;\n};\n\nvar useSearch = function (store) {\n  var currentDocRef = useDocument(store);\n\n  var _a = React__namespace.useState([]),\n      keywords = _a[0],\n      setKeywords = _a[1];\n\n  var _b = React__namespace.useState([]),\n      found = _b[0],\n      setFound = _b[1];\n\n  var _c = React__namespace.useState(0),\n      currentMatch = _c[0],\n      setCurrentMatch = _c[1];\n\n  var _d = React__namespace.useState(false),\n      matchCase = _d[0],\n      setMatchCase = _d[1];\n\n  var textContents = React__namespace.useRef([]);\n\n  var _e = React__namespace.useState(false),\n      wholeWords = _e[0],\n      setWholeWords = _e[1];\n\n  var defaultTargetPageFilter = function () {\n    return true;\n  };\n\n  var targetPageFilter = React__namespace.useCallback(function () {\n    return store.get('targetPageFilter') || defaultTargetPageFilter;\n  }, [store.get('targetPageFilter')]);\n\n  var changeMatchCase = function (isChecked) {\n    setMatchCase(isChecked);\n\n    if (keywords.length > 0) {\n      searchFor(keywords, isChecked, wholeWords);\n    }\n  };\n\n  var changeWholeWords = function (isChecked) {\n    setWholeWords(isChecked);\n\n    if (keywords.length > 0) {\n      searchFor(keywords, matchCase, isChecked);\n    }\n  };\n\n  var jumpToMatch = function (index) {\n    var numMatches = found.length;\n\n    if (keywords.length === 0 || numMatches === 0) {\n      return null;\n    }\n\n    var normalizedIndex = index === numMatches + 1 ? 1 : Math.max(1, Math.min(numMatches, index));\n    setCurrentMatch(normalizedIndex);\n    return jumpToGivenMatch(found[normalizedIndex - 1]);\n  };\n\n  var jumpToPreviousMatch = function () {\n    return jumpToMatch(currentMatch - 1);\n  };\n\n  var jumpToNextMatch = function () {\n    return jumpToMatch(currentMatch + 1);\n  };\n\n  var clearKeyword = function () {\n    store.update('keyword', [EMPTY_KEYWORD_REGEXP]);\n    setKeyword('');\n    setCurrentMatch(0);\n    setFound([]);\n    setMatchCase(false);\n    setWholeWords(false);\n  };\n\n  var search = function () {\n    return searchFor(keywords, matchCase, wholeWords);\n  };\n\n  var setKeyword = function (keyword) {\n    return setKeywords(keyword === '' ? [] : [keyword]);\n  };\n\n  var setTargetPages = function (targetPageFilter) {\n    store.update('targetPageFilter', targetPageFilter);\n  };\n\n  var getTextContents = function () {\n    var currentDoc = currentDocRef.current;\n\n    if (!currentDoc) {\n      return Promise.resolve([]);\n    }\n\n    var promises = Array(currentDoc.numPages).fill(0).map(function (_, pageIndex) {\n      return core.getPage(currentDoc, pageIndex).then(function (page) {\n        return page.getTextContent();\n      }).then(function (content) {\n        var pageContent = content.items.map(function (item) {\n          return item.str || '';\n        }).join('');\n        return Promise.resolve({\n          pageContent: pageContent,\n          pageIndex: pageIndex\n        });\n      });\n    });\n    return Promise.all(promises).then(function (data) {\n      data.sort(function (a, b) {\n        return a.pageIndex - b.pageIndex;\n      });\n      return Promise.resolve(data.map(function (item) {\n        return item.pageContent;\n      }));\n    });\n  };\n\n  var jumpToGivenMatch = function (match) {\n    var jumpToPage = store.get('jumpToPage');\n\n    if (jumpToPage) {\n      jumpToPage(match.pageIndex);\n    }\n\n    store.update('matchPosition', {\n      matchIndex: match.matchIndex,\n      pageIndex: match.pageIndex\n    });\n    return match;\n  };\n\n  var getKeywordSource = function (keyword) {\n    if (keyword instanceof RegExp) {\n      return keyword.source;\n    }\n\n    if (typeof keyword === 'string') {\n      return keyword;\n    }\n\n    return keyword.keyword;\n  };\n\n  var searchFor = function (keywordParam, matchCaseParam, wholeWordsParam) {\n    var currentDoc = currentDocRef.current;\n\n    if (!currentDoc) {\n      return Promise.resolve([]);\n    }\n\n    var numPages = currentDoc.numPages;\n    var keywords = keywordParam.map(function (k) {\n      return normalizeSingleKeyword(k, matchCaseParam, wholeWordsParam);\n    });\n    store.update('keyword', keywords);\n    setCurrentMatch(0);\n    setFound([]);\n    return new Promise(function (resolve, _) {\n      var getTextPromise = textContents.current.length === 0 ? getTextContents().then(function (response) {\n        textContents.current = response;\n        return Promise.resolve(response);\n      }) : Promise.resolve(textContents.current);\n      getTextPromise.then(function (response) {\n        var arr = [];\n        response.forEach(function (pageText, pageIndex) {\n          if (targetPageFilter()({\n            pageIndex: pageIndex,\n            numPages: numPages\n          })) {\n            keywords.forEach(function (keyword) {\n              var matchIndex = 0;\n              var matches;\n\n              while ((matches = keyword.regExp.exec(pageText)) !== null) {\n                arr.push({\n                  keyword: keyword.regExp,\n                  matchIndex: matchIndex,\n                  pageIndex: pageIndex,\n                  pageText: pageText,\n                  startIndex: matches.index,\n                  endIndex: keyword.regExp.lastIndex\n                });\n                matchIndex++;\n              }\n            });\n          }\n        });\n        setFound(arr);\n\n        if (arr.length > 0) {\n          setCurrentMatch(1);\n          jumpToGivenMatch(arr[0]);\n        }\n\n        resolve(arr);\n      });\n    });\n  };\n\n  React__namespace.useEffect(function () {\n    textContents.current = [];\n  }, [currentDocRef.current]);\n  return {\n    clearKeyword: clearKeyword,\n    changeMatchCase: changeMatchCase,\n    changeWholeWords: changeWholeWords,\n    currentMatch: currentMatch,\n    jumpToMatch: jumpToMatch,\n    jumpToNextMatch: jumpToNextMatch,\n    jumpToPreviousMatch: jumpToPreviousMatch,\n    keywords: keywords,\n    matchCase: matchCase,\n    numberOfMatches: found.length,\n    wholeWords: wholeWords,\n    search: search,\n    searchFor: searchFor,\n    setKeywords: setKeywords,\n    keyword: keywords.length === 0 ? '' : getKeywordSource(keywords[0]),\n    setKeyword: setKeyword,\n    setTargetPages: setTargetPages\n  };\n};\n\nvar Search = function (_a) {\n  var children = _a.children,\n      store = _a.store;\n  var result = useSearch(store);\n  return children(__assign({}, result));\n};\n\nvar ShortcutHandler = function (_a) {\n  var containerRef = _a.containerRef,\n      store = _a.store;\n\n  var _b = React__namespace.useState(true),\n      isMouseInside = _b[0],\n      setMouseInside = _b[1];\n\n  var handleMouseEnter = function () {\n    return setMouseInside(true);\n  };\n\n  var handleMouseLeave = function () {\n    return setMouseInside(false);\n  };\n\n  var handleKeydown = function (e) {\n    var containerEle = containerRef.current;\n\n    if (!containerEle) {\n      return;\n    }\n\n    if (e.shiftKey || e.altKey || e.key !== 'f') {\n      return;\n    }\n\n    var isCommandPressed = core.isMac() ? e.metaKey && !e.ctrlKey : e.ctrlKey;\n\n    if (!isCommandPressed) {\n      return;\n    }\n\n    if (isMouseInside || document.activeElement && containerEle.contains(document.activeElement)) {\n      e.preventDefault();\n      store.update('areShortcutsPressed', true);\n    }\n  };\n\n  React__namespace.useEffect(function () {\n    var containerEle = containerRef.current;\n\n    if (!containerEle) {\n      return;\n    }\n\n    document.addEventListener('keydown', handleKeydown);\n    containerEle.addEventListener('mouseenter', handleMouseEnter);\n    containerEle.addEventListener('mouseleave', handleMouseLeave);\n    return function () {\n      document.removeEventListener('keydown', handleKeydown);\n      containerEle.removeEventListener('mouseenter', handleMouseEnter);\n      containerEle.removeEventListener('mouseleave', handleMouseLeave);\n    };\n  }, [containerRef.current]);\n  return React__namespace.createElement(React__namespace.Fragment, null);\n};\n\nvar PORTAL_OFFSET$1 = {\n  left: 0,\n  top: 8\n};\n\nvar SearchPopover = function (_a) {\n  var store = _a.store,\n      onToggle = _a.onToggle;\n  var l10n = React__namespace.useContext(core.LocalizationContext).l10n;\n  var direction = React__namespace.useContext(core.ThemeContext).direction;\n\n  var _b = React__namespace.useState(false),\n      isQuerying = _b[0],\n      setIsQuerying = _b[1];\n\n  var _c = React__namespace.useState(false),\n      searchDone = _c[0],\n      setSearchDone = _c[1];\n\n  var isRtl = direction === core.TextDirection.RightToLeft;\n\n  var _d = useSearch(store),\n      clearKeyword = _d.clearKeyword,\n      changeMatchCase = _d.changeMatchCase,\n      changeWholeWords = _d.changeWholeWords,\n      currentMatch = _d.currentMatch,\n      jumpToNextMatch = _d.jumpToNextMatch,\n      jumpToPreviousMatch = _d.jumpToPreviousMatch,\n      keyword = _d.keyword,\n      matchCase = _d.matchCase,\n      numberOfMatches = _d.numberOfMatches,\n      wholeWords = _d.wholeWords,\n      search = _d.search,\n      setKeyword = _d.setKeyword;\n\n  var onKeydownSearch = function (e) {\n    if (e.key === 'Enter' && keyword) {\n      if (searchDone) {\n        jumpToNextMatch();\n      } else {\n        setIsQuerying(true);\n        search().then(function (_) {\n          setIsQuerying(false);\n          setSearchDone(true);\n        });\n      }\n    }\n  };\n\n  var onChangeMatchCase = function (e) {\n    setSearchDone(false);\n    changeMatchCase(e.target.checked);\n  };\n\n  var onChangeWholeWords = function (e) {\n    setSearchDone(false);\n    changeWholeWords(e.target.checked);\n  };\n\n  var onClose = function () {\n    onToggle();\n    clearKeyword();\n  };\n\n  var onChangeKeyword = function (value) {\n    setSearchDone(false);\n    setKeyword(value);\n  };\n\n  var searchLabel = l10n && l10n.search ? l10n.search.enterToSearch : 'Enter to search';\n  var previousMatchLabel = l10n && l10n.search ? l10n.search.previousMatch : 'Previous match';\n  var nextMatchLabel = l10n && l10n.search ? l10n.search.nextMatch : 'Next match';\n  return React__namespace.createElement(\"div\", {\n    className: \"rpv-search__popover\"\n  }, React__namespace.createElement(\"div\", {\n    className: \"rpv-search__popover-input-counter\"\n  }, React__namespace.createElement(core.TextBox, {\n    ariaLabel: searchLabel,\n    autoFocus: true,\n    placeholder: searchLabel,\n    type: \"text\",\n    value: keyword,\n    onChange: onChangeKeyword,\n    onKeyDown: onKeydownSearch\n  }), React__namespace.createElement(\"div\", {\n    className: core.classNames({\n      'rpv-search__popover-counter': true,\n      'rpv-search__popover-counter--ltr': !isRtl,\n      'rpv-search__popover-counter--rtl': isRtl\n    })\n  }, isQuerying && React__namespace.createElement(core.Spinner, {\n    testId: \"search__popover-searching\",\n    size: \"1rem\"\n  }), !isQuerying && React__namespace.createElement(\"span\", {\n    \"data-testid\": \"search__popover-num-matches\"\n  }, currentMatch, \"/\", numberOfMatches))), React__namespace.createElement(\"label\", {\n    className: \"rpv-search__popover-label\"\n  }, React__namespace.createElement(\"input\", {\n    className: \"rpv-search__popover-label-checkbox\",\n    checked: matchCase,\n    type: \"checkbox\",\n    onChange: onChangeMatchCase\n  }), ' ', l10n && l10n.search ? l10n.search.matchCase : 'Match case'), React__namespace.createElement(\"label\", {\n    className: \"rpv-search__popover-label\"\n  }, React__namespace.createElement(\"input\", {\n    className: \"rpv-search__popover-label-checkbox\",\n    checked: wholeWords,\n    type: \"checkbox\",\n    onChange: onChangeWholeWords\n  }), ' ', l10n && l10n.search ? l10n.search.wholeWords : 'Whole words'), React__namespace.createElement(\"div\", {\n    className: \"rpv-search__popover-footer\"\n  }, React__namespace.createElement(\"div\", {\n    className: \"rpv-search__popover-footer-item\"\n  }, React__namespace.createElement(core.Tooltip, {\n    ariaControlsSuffix: \"search-previous-match\",\n    position: isRtl ? core.Position.BottomRight : core.Position.BottomCenter,\n    target: React__namespace.createElement(core.MinimalButton, {\n      ariaLabel: previousMatchLabel,\n      isDisabled: currentMatch <= 1,\n      onClick: jumpToPreviousMatch\n    }, React__namespace.createElement(PreviousIcon, null)),\n    content: function () {\n      return previousMatchLabel;\n    },\n    offset: PORTAL_OFFSET$1\n  })), React__namespace.createElement(\"div\", {\n    className: \"rpv-search__popover-footer-item\"\n  }, React__namespace.createElement(core.Tooltip, {\n    ariaControlsSuffix: \"search-next-match\",\n    position: core.Position.BottomCenter,\n    target: React__namespace.createElement(core.MinimalButton, {\n      ariaLabel: nextMatchLabel,\n      isDisabled: currentMatch > numberOfMatches - 1,\n      onClick: jumpToNextMatch\n    }, React__namespace.createElement(NextIcon, null)),\n    content: function () {\n      return nextMatchLabel;\n    },\n    offset: PORTAL_OFFSET$1\n  })), React__namespace.createElement(\"div\", {\n    className: core.classNames({\n      'rpv-search__popover-footer-button': true,\n      'rpv-search__popover-footer-button--ltr': !isRtl,\n      'rpv-search__popover-footer-button--rtl': isRtl\n    })\n  }, React__namespace.createElement(core.Button, {\n    onClick: onClose\n  }, l10n && l10n.search ? l10n.search.close : 'Close'))));\n};\n\nvar ShowSearchPopoverDecorator = function (_a) {\n  var children = _a.children,\n      onClick = _a.onClick;\n  var l10n = React__namespace.useContext(core.LocalizationContext).l10n;\n  var label = l10n && l10n.search ? l10n.search.search : 'Search';\n  var icon = React__namespace.createElement(SearchIcon, null);\n  return children({\n    icon: icon,\n    label: label,\n    onClick: onClick\n  });\n};\n\nvar TOOLTIP_OFFSET = {\n  left: 0,\n  top: 8\n};\n\nvar ShowSearchPopoverButton = function (_a) {\n  var enableShortcuts = _a.enableShortcuts,\n      store = _a.store,\n      onClick = _a.onClick;\n  var ariaKeyShortcuts = enableShortcuts ? core.isMac() ? 'Meta+F' : 'Ctrl+F' : '';\n\n  var handleShortcutsPressed = function (areShortcutsPressed) {\n    if (areShortcutsPressed) {\n      onClick();\n    }\n  };\n\n  React__namespace.useEffect(function () {\n    store.subscribe('areShortcutsPressed', handleShortcutsPressed);\n    return function () {\n      store.unsubscribe('areShortcutsPressed', handleShortcutsPressed);\n    };\n  }, []);\n  return React__namespace.createElement(ShowSearchPopoverDecorator, {\n    onClick: onClick\n  }, function (p) {\n    return React__namespace.createElement(core.Tooltip, {\n      ariaControlsSuffix: \"search-popover\",\n      position: core.Position.BottomCenter,\n      target: React__namespace.createElement(core.MinimalButton, {\n        ariaKeyShortcuts: ariaKeyShortcuts,\n        ariaLabel: p.label,\n        testId: \"search__popover-button\",\n        onClick: onClick\n      }, p.icon),\n      content: function () {\n        return p.label;\n      },\n      offset: TOOLTIP_OFFSET\n    });\n  });\n};\n\nvar PORTAL_OFFSET = {\n  left: 0,\n  top: 8\n};\n\nvar ShowSearchPopover = function (_a) {\n  var children = _a.children,\n      enableShortcuts = _a.enableShortcuts,\n      store = _a.store;\n  var direction = React__namespace.useContext(core.ThemeContext).direction;\n  var portalPosition = direction === core.TextDirection.RightToLeft ? core.Position.BottomRight : core.Position.BottomLeft;\n\n  var defaultChildren = function (props) {\n    return React__namespace.createElement(ShowSearchPopoverButton, __assign({\n      enableShortcuts: enableShortcuts,\n      store: store\n    }, props));\n  };\n\n  var render = children || defaultChildren;\n  return React__namespace.createElement(core.Popover, {\n    ariaControlsSuffix: \"search\",\n    lockScroll: false,\n    position: portalPosition,\n    target: function (toggle) {\n      return render({\n        onClick: toggle\n      });\n    },\n    content: function (toggle) {\n      return React__namespace.createElement(SearchPopover, {\n        store: store,\n        onToggle: toggle\n      });\n    },\n    offset: PORTAL_OFFSET,\n    closeOnClickOutside: false,\n    closeOnEscape: true\n  });\n};\n\nvar normalizeKeywords = function (keyword) {\n  return Array.isArray(keyword) ? keyword.map(function (k) {\n    return normalizeSingleKeyword(k);\n  }) : [normalizeSingleKeyword(keyword)];\n};\n\nvar searchPlugin = function (props) {\n  var searchPluginProps = React__namespace.useMemo(function () {\n    return Object.assign({}, {\n      enableShortcuts: true,\n      onHighlightKeyword: function () {}\n    }, props);\n  }, []);\n  var store = React__namespace.useMemo(function () {\n    return core.createStore({\n      matchPosition: {\n        matchIndex: -1,\n        pageIndex: -1\n      },\n      renderStatus: new Map(),\n      keyword: props && props.keyword ? normalizeKeywords(props.keyword) : [EMPTY_KEYWORD_REGEXP]\n    });\n  }, []);\n\n  var _a = useSearch(store),\n      clearKeyword = _a.clearKeyword,\n      jumpToMatch = _a.jumpToMatch,\n      jumpToNextMatch = _a.jumpToNextMatch,\n      jumpToPreviousMatch = _a.jumpToPreviousMatch,\n      searchFor = _a.searchFor,\n      setKeywords = _a.setKeywords,\n      setTargetPages = _a.setTargetPages;\n\n  var SearchDecorator = function (props) {\n    return React__namespace.createElement(Search, __assign({}, props, {\n      store: store\n    }));\n  };\n\n  var ShowSearchPopoverDecorator = function (props) {\n    return React__namespace.createElement(ShowSearchPopover, __assign({\n      enableShortcuts: searchPluginProps.enableShortcuts\n    }, props, {\n      store: store\n    }));\n  };\n\n  var ShowSearchPopoverButtonDecorator = function () {\n    return React__namespace.createElement(ShowSearchPopoverDecorator, null, function (props) {\n      return React__namespace.createElement(ShowSearchPopoverButton, __assign({\n        enableShortcuts: searchPluginProps.enableShortcuts,\n        store: store\n      }, props));\n    });\n  };\n\n  var renderViewer = function (renderViewerProps) {\n    var currentSlot = renderViewerProps.slot;\n\n    if (currentSlot.subSlot) {\n      currentSlot.subSlot.children = React__namespace.createElement(React__namespace.Fragment, null, searchPluginProps.enableShortcuts && React__namespace.createElement(ShortcutHandler, {\n        containerRef: renderViewerProps.containerRef,\n        store: store\n      }), currentSlot.subSlot.children);\n    }\n\n    return currentSlot;\n  };\n\n  var renderPageLayer = function (renderProps) {\n    return React__namespace.createElement(Highlights, {\n      key: renderProps.pageIndex,\n      numPages: renderProps.doc.numPages,\n      pageIndex: renderProps.pageIndex,\n      renderHighlights: props === null || props === void 0 ? void 0 : props.renderHighlights,\n      store: store,\n      onHighlightKeyword: searchPluginProps.onHighlightKeyword\n    });\n  };\n\n  return {\n    install: function (pluginFunctions) {\n      var keyword = props && props.keyword ? normalizeKeywords(props.keyword) : [EMPTY_KEYWORD_REGEXP];\n      store.update('jumpToDestination', pluginFunctions.jumpToDestination);\n      store.update('jumpToPage', pluginFunctions.jumpToPage);\n      store.update('keyword', keyword);\n    },\n    renderPageLayer: renderPageLayer,\n    renderViewer: renderViewer,\n    uninstall: function (props) {\n      var renderStatus = store.get('renderStatus');\n\n      if (renderStatus) {\n        renderStatus.clear();\n      }\n    },\n    onDocumentLoad: function (props) {\n      store.update('doc', props.doc);\n    },\n    onTextLayerRender: function (props) {\n      var renderStatus = store.get('renderStatus');\n\n      if (renderStatus) {\n        renderStatus = renderStatus.set(props.pageIndex, props);\n        store.update('renderStatus', renderStatus);\n      }\n    },\n    Search: SearchDecorator,\n    ShowSearchPopover: ShowSearchPopoverDecorator,\n    ShowSearchPopoverButton: ShowSearchPopoverButtonDecorator,\n    clearHighlights: function () {\n      clearKeyword();\n    },\n    highlight: function (keyword) {\n      var keywords = Array.isArray(keyword) ? keyword : [keyword];\n      setKeywords(keywords);\n      return searchFor(keywords);\n    },\n    jumpToMatch: jumpToMatch,\n    jumpToNextMatch: jumpToNextMatch,\n    jumpToPreviousMatch: jumpToPreviousMatch,\n    setTargetPages: setTargetPages\n  };\n};\n\nexports.NextIcon = NextIcon;\nexports.PreviousIcon = PreviousIcon;\nexports.SearchIcon = SearchIcon;\nexports.searchPlugin = searchPlugin;","map":{"version":3,"names":["Object","defineProperty","exports","value","core","require","React","_interopNamespace","e","__esModule","n","create","keys","forEach","k","d","getOwnPropertyDescriptor","get","enumerable","freeze","React__namespace","NextIcon","createElement","Icon","size","PreviousIcon","SearchIcon","ignoreDirection","__assign","assign","t","s","i","arguments","length","p","prototype","hasOwnProperty","call","apply","EMPTY_KEYWORD_REGEXP","keyword","regExp","RegExp","wholeWords","calculateOffset","children","parent","top","offsetTop","left","offsetLeft","parentElement","getCssProperties","area","concat","height","width","HightlightItem","_a","index","onHighlightKeyword","containerRef","useRef","useIsomorphicLayoutEffect","highlightEle","current","className","ref","style","title","keywordStr","trim","removeNode","ele","parentNode","removeChild","replaceNode","replacementNode","node","insertBefore","unwrap","range","document","createRange","selectNodeContents","extractContents","normalize","sortHighlightPosition","a","b","Highlights","numPages","pageIndex","renderHighlights","store","defaultRenderHighlights","useCallback","renderProps","Fragment","highlightAreas","map","key","renderHighlightElements","_b","useState","matchPosition","setMatchPosition","_c","keywordRegexp","setKeywordRegexp","_d","scale","status","LayerRenderStatus","PreRender","renderStatus","setRenderStatus","currentMatchRef","characterIndexesRef","_e","setHighlightAreas","defaultTargetPageFilter","targetPageFilter","highlight","textLayerEle","span","charIndexSpan","firstChild","nodeType","Node","TEXT_NODE","textContent","startOffset","charIndexInSpan","endOffset","setStart","setEnd","wrapper","surroundContents","wrapperRect","getBoundingClientRect","textLayerRect","pageHeight","pageWidth","highlightAll","charIndexes","highlightPos","spans","slice","querySelectorAll","fullText","item","char","join","cloneKeyword","flags","indexOf","match","matches","exec","push","startIndex","endIndex","lastIndex","indexes","spanIndexes","reduce","acc","spanIndex","values","normalizedCharSpan","hightlighPosition","sort","handleKeywordChanged","handleMatchPositionChanged","currentPosition","handleRenderStatusChanged","has","currentStatus","isEmptyKeyword","useEffect","DidRender","prev","curr","split","c","container","querySelector","matchIndex","jump","classList","remove","add","subscribe","unsubscribe","escapeRegExp","input","replace","normalizeFlagKeyword","flagKeyword","source","matchCase","normalizeSingleKeyword","useDocument","currentDocRef","handleDocumentChanged","doc","useSearch","keywords","setKeywords","found","setFound","currentMatch","setCurrentMatch","setMatchCase","textContents","setWholeWords","changeMatchCase","isChecked","searchFor","changeWholeWords","jumpToMatch","numMatches","normalizedIndex","Math","max","min","jumpToGivenMatch","jumpToPreviousMatch","jumpToNextMatch","clearKeyword","update","setKeyword","search","setTargetPages","getTextContents","currentDoc","Promise","resolve","promises","Array","fill","_","getPage","then","page","getTextContent","content","pageContent","items","str","all","data","jumpToPage","getKeywordSource","keywordParam","matchCaseParam","wholeWordsParam","getTextPromise","response","arr","pageText","numberOfMatches","Search","result","ShortcutHandler","isMouseInside","setMouseInside","handleMouseEnter","handleMouseLeave","handleKeydown","containerEle","shiftKey","altKey","isCommandPressed","isMac","metaKey","ctrlKey","activeElement","contains","preventDefault","addEventListener","removeEventListener","PORTAL_OFFSET$1","SearchPopover","onToggle","l10n","useContext","LocalizationContext","direction","ThemeContext","isQuerying","setIsQuerying","searchDone","setSearchDone","isRtl","TextDirection","RightToLeft","onKeydownSearch","onChangeMatchCase","target","checked","onChangeWholeWords","onClose","onChangeKeyword","searchLabel","enterToSearch","previousMatchLabel","previousMatch","nextMatchLabel","nextMatch","TextBox","ariaLabel","autoFocus","placeholder","type","onChange","onKeyDown","classNames","Spinner","testId","Tooltip","ariaControlsSuffix","position","Position","BottomRight","BottomCenter","MinimalButton","isDisabled","onClick","offset","Button","close","ShowSearchPopoverDecorator","label","icon","TOOLTIP_OFFSET","ShowSearchPopoverButton","enableShortcuts","ariaKeyShortcuts","handleShortcutsPressed","areShortcutsPressed","PORTAL_OFFSET","ShowSearchPopover","portalPosition","BottomLeft","defaultChildren","props","render","Popover","lockScroll","toggle","closeOnClickOutside","closeOnEscape","normalizeKeywords","isArray","searchPlugin","searchPluginProps","useMemo","createStore","Map","SearchDecorator","ShowSearchPopoverButtonDecorator","renderViewer","renderViewerProps","currentSlot","slot","subSlot","renderPageLayer","install","pluginFunctions","jumpToDestination","uninstall","clear","onDocumentLoad","onTextLayerRender","set","clearHighlights"],"sources":["/home/morgan/Desktop/Projets/ENT4/Jwt-Auth-pdf/react-jwt-auth/react-jwt-auth/node_modules/@react-pdf-viewer/search/lib/cjs/search.js"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar core = require('@react-pdf-viewer/core');\nvar React = require('react');\n\nfunction _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = Object.create(null);\n    if (e) {\n        Object.keys(e).forEach(function (k) {\n            if (k !== 'default') {\n                var d = Object.getOwnPropertyDescriptor(e, k);\n                Object.defineProperty(n, k, d.get ? d : {\n                    enumerable: true,\n                    get: function () { return e[k]; }\n                });\n            }\n        });\n    }\n    n[\"default\"] = e;\n    return Object.freeze(n);\n}\n\nvar React__namespace = /*#__PURE__*/_interopNamespace(React);\n\nvar NextIcon = function () { return (React__namespace.createElement(core.Icon, { size: 16 },\n    React__namespace.createElement(\"path\", { d: \"M0.541,5.627L11.666,18.2c0.183,0.207,0.499,0.226,0.706,0.043c0.015-0.014,0.03-0.028,0.043-0.043\\n            L23.541,5.627\" }))); };\n\nvar PreviousIcon = function () { return (React__namespace.createElement(core.Icon, { size: 16 },\n    React__namespace.createElement(\"path\", { d: \"M23.535,18.373L12.409,5.8c-0.183-0.207-0.499-0.226-0.706-0.043C11.688,5.77,11.674,5.785,11.66,5.8\\n            L0.535,18.373\" }))); };\n\nvar SearchIcon = function () { return (React__namespace.createElement(core.Icon, { ignoreDirection: true, size: 16 },\n    React__namespace.createElement(\"path\", { d: \"M10.5,0.5c5.523,0,10,4.477,10,10s-4.477,10-10,10s-10-4.477-10-10S4.977,0.5,10.5,0.5z\\n            M23.5,23.5\\n            l-5.929-5.929\" }))); };\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nvar EMPTY_KEYWORD_REGEXP = {\n    keyword: '',\n    regExp: new RegExp(' '),\n    wholeWords: false,\n};\n\nvar calculateOffset = function (children, parent) {\n    var top = children.offsetTop;\n    var left = children.offsetLeft;\n    var p = children.parentElement;\n    while (p && p !== parent) {\n        top += p.offsetTop;\n        left += p.offsetLeft;\n        p = p.parentElement;\n    }\n    return {\n        left: left,\n        top: top,\n    };\n};\n\nvar getCssProperties = function (area) {\n    return {\n        left: \"\".concat(area.left, \"%\"),\n        top: \"\".concat(area.top, \"%\"),\n        height: \"\".concat(area.height, \"%\"),\n        width: \"\".concat(area.width, \"%\"),\n    };\n};\n\nvar HightlightItem = function (_a) {\n    var index = _a.index, area = _a.area, onHighlightKeyword = _a.onHighlightKeyword;\n    var containerRef = React__namespace.useRef();\n    core.useIsomorphicLayoutEffect(function () {\n        var highlightEle = containerRef.current;\n        if (onHighlightKeyword && highlightEle) {\n            onHighlightKeyword({\n                highlightEle: highlightEle,\n                keyword: area.keyword,\n            });\n        }\n    }, []);\n    return (React__namespace.createElement(\"div\", { className: \"rpv-search__highlight\", \"data-index\": index, ref: containerRef, style: getCssProperties(area), title: area.keywordStr.trim() }));\n};\n\nvar removeNode = function (ele) {\n    var parent = ele.parentNode;\n    if (parent) {\n        parent.removeChild(ele);\n    }\n};\nvar replaceNode = function (replacementNode, node) {\n    removeNode(replacementNode);\n    var parent = node.parentNode;\n    if (parent) {\n        parent.insertBefore(replacementNode, node);\n    }\n    removeNode(node);\n};\nvar unwrap = function (ele) {\n    var parent = ele.parentNode;\n    if (!parent) {\n        return;\n    }\n    var range = document.createRange();\n    range.selectNodeContents(ele);\n    replaceNode(range.extractContents(), ele);\n    parent.normalize();\n};\n\nvar sortHighlightPosition = function (a, b) {\n    if (a.top < b.top) {\n        return -1;\n    }\n    if (a.top > b.top) {\n        return 1;\n    }\n    if (a.left < b.left) {\n        return -1;\n    }\n    if (a.left > b.left) {\n        return 1;\n    }\n    return 0;\n};\nvar Highlights = function (_a) {\n    var numPages = _a.numPages, pageIndex = _a.pageIndex, renderHighlights = _a.renderHighlights, store = _a.store, onHighlightKeyword = _a.onHighlightKeyword;\n    var containerRef = React__namespace.useRef();\n    var defaultRenderHighlights = React__namespace.useCallback(function (renderProps) { return (React__namespace.createElement(React__namespace.Fragment, null, renderProps.highlightAreas.map(function (area, index) { return (React__namespace.createElement(HightlightItem, { index: index, key: index, area: area, onHighlightKeyword: onHighlightKeyword })); }))); }, []);\n    var renderHighlightElements = renderHighlights || defaultRenderHighlights;\n    var _b = React__namespace.useState(store.get('matchPosition')), matchPosition = _b[0], setMatchPosition = _b[1];\n    var _c = React__namespace.useState(store.get('keyword') || [EMPTY_KEYWORD_REGEXP]), keywordRegexp = _c[0], setKeywordRegexp = _c[1];\n    var _d = React__namespace.useState({\n        pageIndex: pageIndex,\n        scale: 1,\n        status: core.LayerRenderStatus.PreRender,\n    }), renderStatus = _d[0], setRenderStatus = _d[1];\n    var currentMatchRef = React__namespace.useRef(null);\n    var characterIndexesRef = React__namespace.useRef([]);\n    var _e = React__namespace.useState([]), highlightAreas = _e[0], setHighlightAreas = _e[1];\n    var defaultTargetPageFilter = function () { return true; };\n    var targetPageFilter = React__namespace.useCallback(function () { return store.get('targetPageFilter') || defaultTargetPageFilter; }, [store.get('targetPageFilter')]);\n    var highlight = function (keywordStr, keyword, textLayerEle, span, charIndexSpan) {\n        var range = document.createRange();\n        var firstChild = span.firstChild;\n        if (!firstChild || firstChild.nodeType !== Node.TEXT_NODE) {\n            return null;\n        }\n        var length = firstChild.textContent.length;\n        var startOffset = charIndexSpan[0].charIndexInSpan;\n        var endOffset = charIndexSpan.length === 1 ? startOffset : charIndexSpan[charIndexSpan.length - 1].charIndexInSpan;\n        if (startOffset > length || endOffset + 1 > length) {\n            return null;\n        }\n        range.setStart(firstChild, startOffset);\n        range.setEnd(firstChild, endOffset + 1);\n        var wrapper = document.createElement('span');\n        range.surroundContents(wrapper);\n        var wrapperRect = wrapper.getBoundingClientRect();\n        var textLayerRect = textLayerEle.getBoundingClientRect();\n        var pageHeight = textLayerRect.height;\n        var pageWidth = textLayerRect.width;\n        var left = (100 * (wrapperRect.left - textLayerRect.left)) / pageWidth;\n        var top = (100 * (wrapperRect.top - textLayerRect.top)) / pageHeight;\n        var height = (100 * wrapperRect.height) / pageHeight;\n        var width = (100 * wrapperRect.width) / pageWidth;\n        unwrap(wrapper);\n        return {\n            keyword: keyword,\n            keywordStr: keywordStr,\n            numPages: numPages,\n            pageIndex: pageIndex,\n            left: left,\n            top: top,\n            height: height,\n            width: width,\n            pageHeight: pageHeight,\n            pageWidth: pageWidth,\n        };\n    };\n    var highlightAll = function (textLayerEle) {\n        var charIndexes = characterIndexesRef.current;\n        if (charIndexes.length === 0) {\n            return [];\n        }\n        var highlightPos = [];\n        var spans = [].slice.call(textLayerEle.querySelectorAll('.rpv-core__text-layer-text'));\n        var fullText = charIndexes.map(function (item) { return item.char; }).join('');\n        keywordRegexp.forEach(function (keyword) {\n            var keywordStr = keyword.keyword;\n            if (!keywordStr.trim()) {\n                return;\n            }\n            var cloneKeyword = keyword.regExp.flags.indexOf('g') === -1\n                ? new RegExp(keyword.regExp, \"\".concat(keyword.regExp.flags, \"g\"))\n                : keyword.regExp;\n            var match;\n            var matches = [];\n            while ((match = cloneKeyword.exec(fullText)) !== null) {\n                matches.push({\n                    keyword: cloneKeyword,\n                    startIndex: match.index,\n                    endIndex: cloneKeyword.lastIndex,\n                });\n            }\n            matches\n                .map(function (item) { return ({\n                keyword: item.keyword,\n                indexes: charIndexes.slice(item.startIndex, item.endIndex),\n            }); })\n                .forEach(function (item) {\n                var spanIndexes = item.indexes.reduce(function (acc, item) {\n                    acc[item.spanIndex] = (acc[item.spanIndex] || []).concat([item]);\n                    return acc;\n                }, {});\n                Object.values(spanIndexes).forEach(function (charIndexSpan) {\n                    if (charIndexSpan.length !== 1 || charIndexSpan[0].char.trim() !== '') {\n                        var normalizedCharSpan = keyword.wholeWords ? charIndexSpan.slice(1, -1) : charIndexSpan;\n                        var hightlighPosition = highlight(keywordStr, item.keyword, textLayerEle, spans[normalizedCharSpan[0].spanIndex], normalizedCharSpan);\n                        if (hightlighPosition) {\n                            highlightPos.push(hightlighPosition);\n                        }\n                    }\n                });\n            });\n        });\n        return highlightPos.sort(sortHighlightPosition);\n    };\n    var handleKeywordChanged = function (keyword) {\n        if (keyword && keyword.length > 0) {\n            setKeywordRegexp(keyword);\n        }\n    };\n    var handleMatchPositionChanged = function (currentPosition) { return setMatchPosition(currentPosition); };\n    var handleRenderStatusChanged = function (status) {\n        if (!status.has(pageIndex)) {\n            return;\n        }\n        var currentStatus = status.get(pageIndex);\n        if (currentStatus) {\n            setRenderStatus({\n                ele: currentStatus.ele,\n                pageIndex: pageIndex,\n                scale: currentStatus.scale,\n                status: currentStatus.status,\n            });\n        }\n    };\n    var isEmptyKeyword = function () {\n        return keywordRegexp.length === 0 || (keywordRegexp.length === 1 && keywordRegexp[0].keyword.trim() === '');\n    };\n    React__namespace.useEffect(function () {\n        if (isEmptyKeyword() ||\n            renderStatus.status !== core.LayerRenderStatus.DidRender ||\n            characterIndexesRef.current.length) {\n            return;\n        }\n        var textLayerEle = renderStatus.ele;\n        var spans = [].slice.call(textLayerEle.querySelectorAll('.rpv-core__text-layer-text'));\n        var charIndexes = spans\n            .map(function (span) { return span.textContent; })\n            .reduce(function (prev, curr, index) {\n            return prev.concat(curr.split('').map(function (c, i) { return ({\n                char: c,\n                charIndexInSpan: i,\n                spanIndex: index,\n            }); }));\n        }, [\n            {\n                char: '',\n                charIndexInSpan: 0,\n                spanIndex: 0,\n            },\n        ])\n            .slice(1);\n        characterIndexesRef.current = charIndexes;\n    }, [keywordRegexp, renderStatus.status]);\n    React__namespace.useEffect(function () {\n        if (isEmptyKeyword() ||\n            !renderStatus.ele ||\n            renderStatus.status !== core.LayerRenderStatus.DidRender ||\n            !targetPageFilter()({ pageIndex: pageIndex, numPages: numPages })) {\n            return;\n        }\n        var textLayerEle = renderStatus.ele;\n        var highlightPos = highlightAll(textLayerEle);\n        setHighlightAreas(highlightPos);\n    }, [keywordRegexp, matchPosition, renderStatus.status, characterIndexesRef.current]);\n    React__namespace.useEffect(function () {\n        if (isEmptyKeyword() && renderStatus.ele && renderStatus.status === core.LayerRenderStatus.DidRender) {\n            setHighlightAreas([]);\n        }\n    }, [keywordRegexp, renderStatus.status]);\n    React__namespace.useEffect(function () {\n        if (highlightAreas.length === 0) {\n            return;\n        }\n        var container = containerRef.current;\n        if (matchPosition.pageIndex !== pageIndex ||\n            !container ||\n            renderStatus.status !== core.LayerRenderStatus.DidRender) {\n            return;\n        }\n        var highlightEle = container.querySelector(\".rpv-search__highlight[data-index=\\\"\".concat(matchPosition.matchIndex, \"\\\"]\"));\n        if (!highlightEle) {\n            return;\n        }\n        var _a = calculateOffset(highlightEle, container), left = _a.left, top = _a.top;\n        var jump = store.get('jumpToDestination');\n        if (jump) {\n            jump(pageIndex, (container.getBoundingClientRect().height - top) / renderStatus.scale, left / renderStatus.scale, renderStatus.scale);\n            if (currentMatchRef.current) {\n                currentMatchRef.current.classList.remove('rpv-search__highlight--current');\n            }\n            currentMatchRef.current = highlightEle;\n            highlightEle.classList.add('rpv-search__highlight--current');\n        }\n    }, [highlightAreas, matchPosition]);\n    React__namespace.useEffect(function () {\n        store.subscribe('keyword', handleKeywordChanged);\n        store.subscribe('matchPosition', handleMatchPositionChanged);\n        store.subscribe('renderStatus', handleRenderStatusChanged);\n        return function () {\n            store.unsubscribe('keyword', handleKeywordChanged);\n            store.unsubscribe('matchPosition', handleMatchPositionChanged);\n            store.unsubscribe('renderStatus', handleRenderStatusChanged);\n        };\n    }, []);\n    return (React__namespace.createElement(\"div\", { className: \"rpv-search__highlights\", \"data-testid\": \"search__highlights-\".concat(pageIndex), ref: containerRef }, renderHighlightElements({\n        getCssProperties: getCssProperties,\n        highlightAreas: highlightAreas,\n    })));\n};\n\nvar escapeRegExp = function (input) { return input.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); };\nvar normalizeFlagKeyword = function (flagKeyword) {\n    var source = flagKeyword.wholeWords ? \" \".concat(flagKeyword.keyword, \" \") : flagKeyword.keyword;\n    var flags = flagKeyword.matchCase ? 'g' : 'gi';\n    return {\n        keyword: flagKeyword.keyword,\n        regExp: new RegExp(escapeRegExp(source), flags),\n        wholeWords: flagKeyword.wholeWords || false,\n    };\n};\nvar normalizeSingleKeyword = function (keyword, matchCase, wholeWords) {\n    if (keyword instanceof RegExp) {\n        return {\n            keyword: keyword.source,\n            regExp: keyword,\n            wholeWords: wholeWords || false,\n        };\n    }\n    if (typeof keyword === 'string') {\n        return keyword === ''\n            ? EMPTY_KEYWORD_REGEXP\n            : normalizeFlagKeyword({\n                keyword: keyword,\n                matchCase: matchCase || false,\n                wholeWords: wholeWords || false,\n            });\n    }\n    if (typeof matchCase !== 'undefined') {\n        keyword.matchCase = matchCase;\n    }\n    if (typeof wholeWords !== 'undefined') {\n        keyword.wholeWords = wholeWords;\n    }\n    return normalizeFlagKeyword(keyword);\n};\n\nvar useDocument = function (store) {\n    var currentDocRef = React__namespace.useRef(store.get('doc'));\n    var handleDocumentChanged = function (doc) {\n        currentDocRef.current = doc;\n    };\n    React__namespace.useEffect(function () {\n        store.subscribe('doc', handleDocumentChanged);\n        return function () {\n            store.unsubscribe('doc', handleDocumentChanged);\n        };\n    }, []);\n    return currentDocRef;\n};\n\nvar useSearch = function (store) {\n    var currentDocRef = useDocument(store);\n    var _a = React__namespace.useState([]), keywords = _a[0], setKeywords = _a[1];\n    var _b = React__namespace.useState([]), found = _b[0], setFound = _b[1];\n    var _c = React__namespace.useState(0), currentMatch = _c[0], setCurrentMatch = _c[1];\n    var _d = React__namespace.useState(false), matchCase = _d[0], setMatchCase = _d[1];\n    var textContents = React__namespace.useRef([]);\n    var _e = React__namespace.useState(false), wholeWords = _e[0], setWholeWords = _e[1];\n    var defaultTargetPageFilter = function () { return true; };\n    var targetPageFilter = React__namespace.useCallback(function () { return store.get('targetPageFilter') || defaultTargetPageFilter; }, [store.get('targetPageFilter')]);\n    var changeMatchCase = function (isChecked) {\n        setMatchCase(isChecked);\n        if (keywords.length > 0) {\n            searchFor(keywords, isChecked, wholeWords);\n        }\n    };\n    var changeWholeWords = function (isChecked) {\n        setWholeWords(isChecked);\n        if (keywords.length > 0) {\n            searchFor(keywords, matchCase, isChecked);\n        }\n    };\n    var jumpToMatch = function (index) {\n        var numMatches = found.length;\n        if (keywords.length === 0 || numMatches === 0) {\n            return null;\n        }\n        var normalizedIndex = index === numMatches + 1 ? 1 : Math.max(1, Math.min(numMatches, index));\n        setCurrentMatch(normalizedIndex);\n        return jumpToGivenMatch(found[normalizedIndex - 1]);\n    };\n    var jumpToPreviousMatch = function () { return jumpToMatch(currentMatch - 1); };\n    var jumpToNextMatch = function () { return jumpToMatch(currentMatch + 1); };\n    var clearKeyword = function () {\n        store.update('keyword', [EMPTY_KEYWORD_REGEXP]);\n        setKeyword('');\n        setCurrentMatch(0);\n        setFound([]);\n        setMatchCase(false);\n        setWholeWords(false);\n    };\n    var search = function () { return searchFor(keywords, matchCase, wholeWords); };\n    var setKeyword = function (keyword) { return setKeywords(keyword === '' ? [] : [keyword]); };\n    var setTargetPages = function (targetPageFilter) {\n        store.update('targetPageFilter', targetPageFilter);\n    };\n    var getTextContents = function () {\n        var currentDoc = currentDocRef.current;\n        if (!currentDoc) {\n            return Promise.resolve([]);\n        }\n        var promises = Array(currentDoc.numPages)\n            .fill(0)\n            .map(function (_, pageIndex) {\n            return core.getPage(currentDoc, pageIndex)\n                .then(function (page) {\n                return page.getTextContent();\n            })\n                .then(function (content) {\n                var pageContent = content.items.map(function (item) { return item.str || ''; }).join('');\n                return Promise.resolve({\n                    pageContent: pageContent,\n                    pageIndex: pageIndex,\n                });\n            });\n        });\n        return Promise.all(promises).then(function (data) {\n            data.sort(function (a, b) { return a.pageIndex - b.pageIndex; });\n            return Promise.resolve(data.map(function (item) { return item.pageContent; }));\n        });\n    };\n    var jumpToGivenMatch = function (match) {\n        var jumpToPage = store.get('jumpToPage');\n        if (jumpToPage) {\n            jumpToPage(match.pageIndex);\n        }\n        store.update('matchPosition', {\n            matchIndex: match.matchIndex,\n            pageIndex: match.pageIndex,\n        });\n        return match;\n    };\n    var getKeywordSource = function (keyword) {\n        if (keyword instanceof RegExp) {\n            return keyword.source;\n        }\n        if (typeof keyword === 'string') {\n            return keyword;\n        }\n        return keyword.keyword;\n    };\n    var searchFor = function (keywordParam, matchCaseParam, wholeWordsParam) {\n        var currentDoc = currentDocRef.current;\n        if (!currentDoc) {\n            return Promise.resolve([]);\n        }\n        var numPages = currentDoc.numPages;\n        var keywords = keywordParam.map(function (k) { return normalizeSingleKeyword(k, matchCaseParam, wholeWordsParam); });\n        store.update('keyword', keywords);\n        setCurrentMatch(0);\n        setFound([]);\n        return new Promise(function (resolve, _) {\n            var getTextPromise = textContents.current.length === 0\n                ? getTextContents().then(function (response) {\n                    textContents.current = response;\n                    return Promise.resolve(response);\n                })\n                : Promise.resolve(textContents.current);\n            getTextPromise.then(function (response) {\n                var arr = [];\n                response.forEach(function (pageText, pageIndex) {\n                    if (targetPageFilter()({ pageIndex: pageIndex, numPages: numPages })) {\n                        keywords.forEach(function (keyword) {\n                            var matchIndex = 0;\n                            var matches;\n                            while ((matches = keyword.regExp.exec(pageText)) !== null) {\n                                arr.push({\n                                    keyword: keyword.regExp,\n                                    matchIndex: matchIndex,\n                                    pageIndex: pageIndex,\n                                    pageText: pageText,\n                                    startIndex: matches.index,\n                                    endIndex: keyword.regExp.lastIndex,\n                                });\n                                matchIndex++;\n                            }\n                        });\n                    }\n                });\n                setFound(arr);\n                if (arr.length > 0) {\n                    setCurrentMatch(1);\n                    jumpToGivenMatch(arr[0]);\n                }\n                resolve(arr);\n            });\n        });\n    };\n    React__namespace.useEffect(function () {\n        textContents.current = [];\n    }, [currentDocRef.current]);\n    return {\n        clearKeyword: clearKeyword,\n        changeMatchCase: changeMatchCase,\n        changeWholeWords: changeWholeWords,\n        currentMatch: currentMatch,\n        jumpToMatch: jumpToMatch,\n        jumpToNextMatch: jumpToNextMatch,\n        jumpToPreviousMatch: jumpToPreviousMatch,\n        keywords: keywords,\n        matchCase: matchCase,\n        numberOfMatches: found.length,\n        wholeWords: wholeWords,\n        search: search,\n        searchFor: searchFor,\n        setKeywords: setKeywords,\n        keyword: keywords.length === 0 ? '' : getKeywordSource(keywords[0]),\n        setKeyword: setKeyword,\n        setTargetPages: setTargetPages,\n    };\n};\n\nvar Search = function (_a) {\n    var children = _a.children, store = _a.store;\n    var result = useSearch(store);\n    return children(__assign({}, result));\n};\n\nvar ShortcutHandler = function (_a) {\n    var containerRef = _a.containerRef, store = _a.store;\n    var _b = React__namespace.useState(true), isMouseInside = _b[0], setMouseInside = _b[1];\n    var handleMouseEnter = function () { return setMouseInside(true); };\n    var handleMouseLeave = function () { return setMouseInside(false); };\n    var handleKeydown = function (e) {\n        var containerEle = containerRef.current;\n        if (!containerEle) {\n            return;\n        }\n        if (e.shiftKey || e.altKey || e.key !== 'f') {\n            return;\n        }\n        var isCommandPressed = core.isMac() ? e.metaKey && !e.ctrlKey : e.ctrlKey;\n        if (!isCommandPressed) {\n            return;\n        }\n        if (isMouseInside || (document.activeElement && containerEle.contains(document.activeElement))) {\n            e.preventDefault();\n            store.update('areShortcutsPressed', true);\n        }\n    };\n    React__namespace.useEffect(function () {\n        var containerEle = containerRef.current;\n        if (!containerEle) {\n            return;\n        }\n        document.addEventListener('keydown', handleKeydown);\n        containerEle.addEventListener('mouseenter', handleMouseEnter);\n        containerEle.addEventListener('mouseleave', handleMouseLeave);\n        return function () {\n            document.removeEventListener('keydown', handleKeydown);\n            containerEle.removeEventListener('mouseenter', handleMouseEnter);\n            containerEle.removeEventListener('mouseleave', handleMouseLeave);\n        };\n    }, [containerRef.current]);\n    return React__namespace.createElement(React__namespace.Fragment, null);\n};\n\nvar PORTAL_OFFSET$1 = { left: 0, top: 8 };\nvar SearchPopover = function (_a) {\n    var store = _a.store, onToggle = _a.onToggle;\n    var l10n = React__namespace.useContext(core.LocalizationContext).l10n;\n    var direction = React__namespace.useContext(core.ThemeContext).direction;\n    var _b = React__namespace.useState(false), isQuerying = _b[0], setIsQuerying = _b[1];\n    var _c = React__namespace.useState(false), searchDone = _c[0], setSearchDone = _c[1];\n    var isRtl = direction === core.TextDirection.RightToLeft;\n    var _d = useSearch(store), clearKeyword = _d.clearKeyword, changeMatchCase = _d.changeMatchCase, changeWholeWords = _d.changeWholeWords, currentMatch = _d.currentMatch, jumpToNextMatch = _d.jumpToNextMatch, jumpToPreviousMatch = _d.jumpToPreviousMatch, keyword = _d.keyword, matchCase = _d.matchCase, numberOfMatches = _d.numberOfMatches, wholeWords = _d.wholeWords, search = _d.search, setKeyword = _d.setKeyword;\n    var onKeydownSearch = function (e) {\n        if (e.key === 'Enter' && keyword) {\n            if (searchDone) {\n                jumpToNextMatch();\n            }\n            else {\n                setIsQuerying(true);\n                search().then(function (_) {\n                    setIsQuerying(false);\n                    setSearchDone(true);\n                });\n            }\n        }\n    };\n    var onChangeMatchCase = function (e) {\n        setSearchDone(false);\n        changeMatchCase(e.target.checked);\n    };\n    var onChangeWholeWords = function (e) {\n        setSearchDone(false);\n        changeWholeWords(e.target.checked);\n    };\n    var onClose = function () {\n        onToggle();\n        clearKeyword();\n    };\n    var onChangeKeyword = function (value) {\n        setSearchDone(false);\n        setKeyword(value);\n    };\n    var searchLabel = l10n && l10n.search ? l10n.search.enterToSearch : 'Enter to search';\n    var previousMatchLabel = l10n && l10n.search ? l10n.search.previousMatch : 'Previous match';\n    var nextMatchLabel = l10n && l10n.search ? l10n.search.nextMatch : 'Next match';\n    return (React__namespace.createElement(\"div\", { className: \"rpv-search__popover\" },\n        React__namespace.createElement(\"div\", { className: \"rpv-search__popover-input-counter\" },\n            React__namespace.createElement(core.TextBox, { ariaLabel: searchLabel, autoFocus: true, placeholder: searchLabel, type: \"text\", value: keyword, onChange: onChangeKeyword, onKeyDown: onKeydownSearch }),\n            React__namespace.createElement(\"div\", { className: core.classNames({\n                    'rpv-search__popover-counter': true,\n                    'rpv-search__popover-counter--ltr': !isRtl,\n                    'rpv-search__popover-counter--rtl': isRtl,\n                }) },\n                isQuerying && React__namespace.createElement(core.Spinner, { testId: \"search__popover-searching\", size: \"1rem\" }),\n                !isQuerying && (React__namespace.createElement(\"span\", { \"data-testid\": \"search__popover-num-matches\" },\n                    currentMatch,\n                    \"/\",\n                    numberOfMatches)))),\n        React__namespace.createElement(\"label\", { className: \"rpv-search__popover-label\" },\n            React__namespace.createElement(\"input\", { className: \"rpv-search__popover-label-checkbox\", checked: matchCase, type: \"checkbox\", onChange: onChangeMatchCase }),\n            ' ',\n            l10n && l10n.search ? l10n.search.matchCase : 'Match case'),\n        React__namespace.createElement(\"label\", { className: \"rpv-search__popover-label\" },\n            React__namespace.createElement(\"input\", { className: \"rpv-search__popover-label-checkbox\", checked: wholeWords, type: \"checkbox\", onChange: onChangeWholeWords }),\n            ' ',\n            l10n && l10n.search ? l10n.search.wholeWords : 'Whole words'),\n        React__namespace.createElement(\"div\", { className: \"rpv-search__popover-footer\" },\n            React__namespace.createElement(\"div\", { className: \"rpv-search__popover-footer-item\" },\n                React__namespace.createElement(core.Tooltip, { ariaControlsSuffix: \"search-previous-match\", position: isRtl ? core.Position.BottomRight : core.Position.BottomCenter, target: React__namespace.createElement(core.MinimalButton, { ariaLabel: previousMatchLabel, isDisabled: currentMatch <= 1, onClick: jumpToPreviousMatch },\n                        React__namespace.createElement(PreviousIcon, null)), content: function () { return previousMatchLabel; }, offset: PORTAL_OFFSET$1 })),\n            React__namespace.createElement(\"div\", { className: \"rpv-search__popover-footer-item\" },\n                React__namespace.createElement(core.Tooltip, { ariaControlsSuffix: \"search-next-match\", position: core.Position.BottomCenter, target: React__namespace.createElement(core.MinimalButton, { ariaLabel: nextMatchLabel, isDisabled: currentMatch > numberOfMatches - 1, onClick: jumpToNextMatch },\n                        React__namespace.createElement(NextIcon, null)), content: function () { return nextMatchLabel; }, offset: PORTAL_OFFSET$1 })),\n            React__namespace.createElement(\"div\", { className: core.classNames({\n                    'rpv-search__popover-footer-button': true,\n                    'rpv-search__popover-footer-button--ltr': !isRtl,\n                    'rpv-search__popover-footer-button--rtl': isRtl,\n                }) },\n                React__namespace.createElement(core.Button, { onClick: onClose }, l10n && l10n.search ? l10n.search.close : 'Close')))));\n};\n\nvar ShowSearchPopoverDecorator = function (_a) {\n    var children = _a.children, onClick = _a.onClick;\n    var l10n = React__namespace.useContext(core.LocalizationContext).l10n;\n    var label = l10n && l10n.search ? l10n.search.search : 'Search';\n    var icon = React__namespace.createElement(SearchIcon, null);\n    return children({ icon: icon, label: label, onClick: onClick });\n};\n\nvar TOOLTIP_OFFSET = { left: 0, top: 8 };\nvar ShowSearchPopoverButton = function (_a) {\n    var enableShortcuts = _a.enableShortcuts, store = _a.store, onClick = _a.onClick;\n    var ariaKeyShortcuts = enableShortcuts ? (core.isMac() ? 'Meta+F' : 'Ctrl+F') : '';\n    var handleShortcutsPressed = function (areShortcutsPressed) {\n        if (areShortcutsPressed) {\n            onClick();\n        }\n    };\n    React__namespace.useEffect(function () {\n        store.subscribe('areShortcutsPressed', handleShortcutsPressed);\n        return function () {\n            store.unsubscribe('areShortcutsPressed', handleShortcutsPressed);\n        };\n    }, []);\n    return (React__namespace.createElement(ShowSearchPopoverDecorator, { onClick: onClick }, function (p) { return (React__namespace.createElement(core.Tooltip, { ariaControlsSuffix: \"search-popover\", position: core.Position.BottomCenter, target: React__namespace.createElement(core.MinimalButton, { ariaKeyShortcuts: ariaKeyShortcuts, ariaLabel: p.label, testId: \"search__popover-button\", onClick: onClick }, p.icon), content: function () { return p.label; }, offset: TOOLTIP_OFFSET })); }));\n};\n\nvar PORTAL_OFFSET = { left: 0, top: 8 };\nvar ShowSearchPopover = function (_a) {\n    var children = _a.children, enableShortcuts = _a.enableShortcuts, store = _a.store;\n    var direction = React__namespace.useContext(core.ThemeContext).direction;\n    var portalPosition = direction === core.TextDirection.RightToLeft ? core.Position.BottomRight : core.Position.BottomLeft;\n    var defaultChildren = function (props) { return (React__namespace.createElement(ShowSearchPopoverButton, __assign({ enableShortcuts: enableShortcuts, store: store }, props))); };\n    var render = children || defaultChildren;\n    return (React__namespace.createElement(core.Popover, { ariaControlsSuffix: \"search\", lockScroll: false, position: portalPosition, target: function (toggle) {\n            return render({\n                onClick: toggle,\n            });\n        }, content: function (toggle) { return React__namespace.createElement(SearchPopover, { store: store, onToggle: toggle }); }, offset: PORTAL_OFFSET, closeOnClickOutside: false, closeOnEscape: true }));\n};\n\nvar normalizeKeywords = function (keyword) {\n    return Array.isArray(keyword) ? keyword.map(function (k) { return normalizeSingleKeyword(k); }) : [normalizeSingleKeyword(keyword)];\n};\nvar searchPlugin = function (props) {\n    var searchPluginProps = React__namespace.useMemo(function () { return Object.assign({}, { enableShortcuts: true, onHighlightKeyword: function () { } }, props); }, []);\n    var store = React__namespace.useMemo(function () {\n        return core.createStore({\n            matchPosition: {\n                matchIndex: -1,\n                pageIndex: -1,\n            },\n            renderStatus: new Map(),\n            keyword: props && props.keyword ? normalizeKeywords(props.keyword) : [EMPTY_KEYWORD_REGEXP],\n        });\n    }, []);\n    var _a = useSearch(store), clearKeyword = _a.clearKeyword, jumpToMatch = _a.jumpToMatch, jumpToNextMatch = _a.jumpToNextMatch, jumpToPreviousMatch = _a.jumpToPreviousMatch, searchFor = _a.searchFor, setKeywords = _a.setKeywords, setTargetPages = _a.setTargetPages;\n    var SearchDecorator = function (props) { return React__namespace.createElement(Search, __assign({}, props, { store: store })); };\n    var ShowSearchPopoverDecorator = function (props) { return (React__namespace.createElement(ShowSearchPopover, __assign({ enableShortcuts: searchPluginProps.enableShortcuts }, props, { store: store }))); };\n    var ShowSearchPopoverButtonDecorator = function () { return (React__namespace.createElement(ShowSearchPopoverDecorator, null, function (props) { return (React__namespace.createElement(ShowSearchPopoverButton, __assign({ enableShortcuts: searchPluginProps.enableShortcuts, store: store }, props))); })); };\n    var renderViewer = function (renderViewerProps) {\n        var currentSlot = renderViewerProps.slot;\n        if (currentSlot.subSlot) {\n            currentSlot.subSlot.children = (React__namespace.createElement(React__namespace.Fragment, null,\n                searchPluginProps.enableShortcuts && (React__namespace.createElement(ShortcutHandler, { containerRef: renderViewerProps.containerRef, store: store })),\n                currentSlot.subSlot.children));\n        }\n        return currentSlot;\n    };\n    var renderPageLayer = function (renderProps) { return (React__namespace.createElement(Highlights, { key: renderProps.pageIndex, numPages: renderProps.doc.numPages, pageIndex: renderProps.pageIndex, renderHighlights: props === null || props === void 0 ? void 0 : props.renderHighlights, store: store, onHighlightKeyword: searchPluginProps.onHighlightKeyword })); };\n    return {\n        install: function (pluginFunctions) {\n            var keyword = props && props.keyword ? normalizeKeywords(props.keyword) : [EMPTY_KEYWORD_REGEXP];\n            store.update('jumpToDestination', pluginFunctions.jumpToDestination);\n            store.update('jumpToPage', pluginFunctions.jumpToPage);\n            store.update('keyword', keyword);\n        },\n        renderPageLayer: renderPageLayer,\n        renderViewer: renderViewer,\n        uninstall: function (props) {\n            var renderStatus = store.get('renderStatus');\n            if (renderStatus) {\n                renderStatus.clear();\n            }\n        },\n        onDocumentLoad: function (props) {\n            store.update('doc', props.doc);\n        },\n        onTextLayerRender: function (props) {\n            var renderStatus = store.get('renderStatus');\n            if (renderStatus) {\n                renderStatus = renderStatus.set(props.pageIndex, props);\n                store.update('renderStatus', renderStatus);\n            }\n        },\n        Search: SearchDecorator,\n        ShowSearchPopover: ShowSearchPopoverDecorator,\n        ShowSearchPopoverButton: ShowSearchPopoverButtonDecorator,\n        clearHighlights: function () {\n            clearKeyword();\n        },\n        highlight: function (keyword) {\n            var keywords = Array.isArray(keyword) ? keyword : [keyword];\n            setKeywords(keywords);\n            return searchFor(keywords);\n        },\n        jumpToMatch: jumpToMatch,\n        jumpToNextMatch: jumpToNextMatch,\n        jumpToPreviousMatch: jumpToPreviousMatch,\n        setTargetPages: setTargetPages,\n    };\n};\n\nexports.NextIcon = NextIcon;\nexports.PreviousIcon = PreviousIcon;\nexports.SearchIcon = SearchIcon;\nexports.searchPlugin = searchPlugin;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}