{"ast":null,"code":"/* eslint-disable */\nimport { createElement, Browser, isNullOrUndefined, isBlazor } from '@syncfusion/ej2-base';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { AjaxHandler } from '../index';\nimport { createSpinner, showSpinner, hideSpinner } from '../index';\n/**\n * TextSearch module\n */\n\nvar TextSearch =\n/** @class */\nfunction () {\n  /**\n   * @param pdfViewer\n   * @param pdfViewerBase\n   * @param pdfViewer\n   * @param pdfViewerBase\n   * @private\n   */\n  function TextSearch(pdfViewer, pdfViewerBase) {\n    var _this = this;\n    /**\n     * @private\n     */\n\n\n    this.isTextSearch = false;\n    /**\n     * @private\n     */\n\n    this.searchCount = 0;\n    this.searchIndex = 0;\n    this.currentSearchIndex = 0;\n    this.startIndex = null;\n    this.searchPageIndex = null;\n    this.searchString = null;\n    this.isMatchCase = false;\n    this.searchRequestHandler = null; // eslint-disable-next-line\n\n    this.textContents = new Array(); // eslint-disable-next-line\n\n    this.searchMatches = new Array(); // eslint-disable-next-line\n\n    this.searchCollection = new Array();\n    this.searchedPages = [];\n    this.isPrevSearch = false; // eslint-disable-next-line\n\n    this.tempElementStorage = new Array();\n    /**\n     * @private\n     */\n\n    this.isMessagePopupOpened = false;\n    /**\n     * @private\n     */\n\n    this.isTextRetrieved = false;\n    this.isTextSearched = false;\n    this.isTextSearchEventTriggered = false;\n    this.isSearchText = false; // eslint-disable-next-line\n\n    this.checkBoxOnChange = function (event) {\n      if (isBlazor()) {\n        if (event.currentTarget && event.currentTarget.checked) {\n          _this.isMatchCase = true;\n        } else {\n          _this.isMatchCase = false;\n        }\n      } else {\n        if (event.checked) {\n          _this.isMatchCase = true;\n        } else {\n          _this.isMatchCase = false;\n        }\n      }\n\n      if (_this.isTextSearch) {\n        _this.resetVariables();\n\n        _this.clearAllOccurrences();\n\n        var inputString = _this.searchInput.value;\n        _this.searchIndex = 0;\n\n        _this.textSearch(inputString);\n      }\n    };\n\n    this.searchKeypressHandler = function (event) {\n      _this.enableNextButton(true);\n\n      _this.enablePrevButton(true);\n\n      if (event.which === 13) {\n        _this.initiateTextSearch(_this.searchInput);\n\n        _this.updateSearchInputIcon(false);\n      } else {\n        _this.resetVariables();\n      }\n    };\n\n    this.searchClickHandler = function (event) {\n      _this.searchButtonClick(_this.searchBtn, _this.searchInput);\n    };\n\n    this.nextButtonOnClick = function (event) {\n      _this.nextSearch();\n    };\n\n    this.prevButtonOnClick = function (event) {\n      _this.prevSearch();\n    };\n\n    this.pdfViewer = pdfViewer;\n    this.pdfViewerBase = pdfViewerBase;\n  }\n  /**\n   * @private\n   */\n\n\n  TextSearch.prototype.createTextSearchBox = function () {\n    var _this = this; // eslint-disable-next-line max-len\n\n\n    this.searchBox = createElement('div', {\n      id: this.pdfViewer.element.id + '_search_box',\n      className: 'e-pv-search-bar'\n    });\n    var toolbarElement;\n\n    if (isBlazor()) {\n      toolbarElement = document.getElementById('toolbarContainer');\n    } else {\n      toolbarElement = this.pdfViewerBase.getElement('_toolbarContainer');\n    }\n\n    if (toolbarElement) {\n      if (isBlazor()) {\n        this.searchBox.style.top = toolbarElement.clientHeight + 'px';\n      } else {\n        this.searchBox.style.top = toolbarElement.clientHeight + 'px';\n      }\n    }\n\n    var searchElementsContainer = createElement('div', {\n      id: this.pdfViewer.element.id + '_search_box_elements',\n      className: 'e-pv-search-bar-elements'\n    }); // eslint-disable-next-line max-len\n\n    var searchInputContainer = createElement('div', {\n      id: this.pdfViewer.element.id + '_search_input_container',\n      className: 'e-input-group e-pv-search-input'\n    });\n    this.searchInput = createElement('input', {\n      id: this.pdfViewer.element.id + '_search_input',\n      className: 'e-input'\n    });\n    this.searchInput.type = 'text';\n\n    if (isBlazor()) {\n      var promise = this.pdfViewer._dotnetInstance.invokeMethodAsync('GetLocaleText', 'PdfViewer_Findindocument');\n\n      promise.then(function (value) {\n        _this.searchInput.placeholder = value;\n      });\n    } else {\n      this.searchInput.placeholder = this.pdfViewer.localeObj.getConstant('Find in document');\n    } // eslint-disable-next-line max-len\n\n\n    this.searchBtn = createElement('span', {\n      id: this.pdfViewer.element.id + '_search_box-icon',\n      className: 'e-input-group-icon e-input-search-group-icon e-pv-search-icon'\n    });\n    searchInputContainer.appendChild(this.searchInput);\n    searchInputContainer.appendChild(this.searchBtn);\n    searchElementsContainer.appendChild(searchInputContainer);\n\n    if (this.pdfViewer.enableRtl) {\n      this.prevSearchBtn = this.createSearchBoxButtons('prev_occurrence', 'e-pv-next-search');\n    } else {\n      this.prevSearchBtn = this.createSearchBoxButtons('prev_occurrence', 'e-pv-prev-search');\n    }\n\n    this.prevSearchBtn.setAttribute('aria-label', 'Previous Search text');\n    searchElementsContainer.appendChild(this.prevSearchBtn);\n\n    if (this.pdfViewer.enableRtl) {\n      this.nextSearchBtn = this.createSearchBoxButtons('next_occurrence', 'e-pv-prev-search');\n    } else {\n      this.nextSearchBtn = this.createSearchBoxButtons('next_occurrence', 'e-pv-next-search');\n    }\n\n    this.nextSearchBtn.setAttribute('aria-label', 'Next Search text');\n    searchElementsContainer.appendChild(this.nextSearchBtn); // eslint-disable-next-line max-len\n\n    var matchCaseContainer = createElement('div', {\n      id: this.pdfViewer.element.id + '_match_case_container',\n      className: 'e-pv-match-case-container'\n    });\n    var matchCaseInput = createElement('input', {\n      id: this.pdfViewer.element.id + '_match_case'\n    });\n    matchCaseInput.type = 'checkbox';\n\n    if (isBlazor()) {\n      matchCaseInput.style.height = '17px';\n      matchCaseInput.style.width = '17px';\n      matchCaseInput.addEventListener('change', this.checkBoxOnChange.bind(this));\n    }\n\n    matchCaseContainer.appendChild(matchCaseInput);\n    this.searchBox.appendChild(searchElementsContainer);\n    this.searchBox.appendChild(matchCaseContainer);\n    this.pdfViewerBase.mainContainer.appendChild(this.searchBox);\n\n    if (isBlazor()) {\n      // eslint-disable-next-line max-len\n      var matchCaseText_1 = createElement('span', {\n        id: this.pdfViewer.element.id + '_search_box_text',\n        styles: 'position: absolute; padding-top: 3px; padding-left: 8px; padding-right: 8px; font-size: 13px'\n      });\n\n      var promise = this.pdfViewer._dotnetInstance.invokeMethodAsync('GetLocaleText', 'PdfViewer_Matchcase');\n\n      promise.then(function (value) {\n        matchCaseText_1.textContent = value;\n      });\n      matchCaseContainer.appendChild(matchCaseText_1);\n    } else {\n      // eslint-disable-next-line max-len\n      var checkBox = new CheckBox({\n        cssClass: 'e-pv-match-case',\n        label: this.pdfViewer.localeObj.getConstant('Match case'),\n        change: this.checkBoxOnChange.bind(this)\n      });\n      checkBox.appendTo(matchCaseInput);\n    }\n\n    var waitingPopup = createElement('div', {\n      id: this.pdfViewer.element.id + '_textSearchLoadingIndicator'\n    });\n    searchInputContainer.appendChild(waitingPopup);\n    waitingPopup.style.position = 'absolute';\n    waitingPopup.style.top = '15px';\n    waitingPopup.style.left = searchInputContainer.clientWidth - 46 + 'px';\n    createSpinner({\n      target: waitingPopup,\n      cssClass: 'e-spin-center'\n    });\n    this.setLoaderProperties(waitingPopup);\n    this.showSearchBox(false);\n\n    if (this.pdfViewer.enableRtl) {\n      this.searchBox.classList.add('e-rtl');\n      this.searchBox.style.left = '88.3px';\n    } else {\n      this.searchBox.classList.remove('e-rtl');\n      this.searchBox.style.right = '88.3px';\n    }\n\n    this.searchInput.addEventListener('focus', function () {\n      _this.searchInput.parentElement.classList.add('e-input-focus');\n    });\n    this.searchInput.addEventListener('blur', function () {\n      _this.searchInput.parentElement.classList.remove('e-input-focus');\n    });\n    this.searchInput.addEventListener('keydown', this.searchKeypressHandler.bind(this));\n    this.searchBtn.addEventListener('click', this.searchClickHandler.bind(this));\n    this.nextSearchBtn.addEventListener('click', this.nextButtonOnClick.bind(this));\n    this.prevSearchBtn.addEventListener('click', this.prevButtonOnClick.bind(this));\n  };\n\n  TextSearch.prototype.setLoaderProperties = function (element) {\n    var spinnerElement = element.firstChild.firstChild.firstChild;\n\n    if (spinnerElement) {\n      spinnerElement.style.height = '18px';\n      spinnerElement.style.width = '18px';\n      spinnerElement.style.transformOrigin = '9px 9px 9px';\n    }\n  };\n\n  TextSearch.prototype.showLoadingIndicator = function (isShow) {\n    var waitingPopup = document.getElementById(this.pdfViewer.element.id + '_textSearchLoadingIndicator');\n\n    if (waitingPopup) {\n      if (isShow) {\n        showSpinner(waitingPopup);\n      } else {\n        hideSpinner(waitingPopup);\n      }\n    }\n  };\n  /**\n   * @private\n   */\n\n\n  TextSearch.prototype.textSearchBoxOnResize = function () {\n    if (this.pdfViewer.toolbarModule && this.pdfViewer.enableToolbar) {\n      var secondaryToolbar = this.pdfViewerBase.getElement('_toolbarContainer_popup');\n\n      if (secondaryToolbar) {\n        if (secondaryToolbar.contains(this.pdfViewerBase.getElement('_search').parentElement)) {\n          this.searchBox.style.right = '0px';\n        }\n      }\n    } else {\n      // eslint-disable-next-line max-len\n      if (this.pdfViewerBase.viewerContainer.clientWidth + this.pdfViewerBase.viewerContainer.offsetLeft < this.searchBox.offsetLeft + this.searchBox.clientWidth) {\n        this.searchBox.style.right = '0px'; // eslint-disable-next-line\n\n        this.searchBox.style.width = parseInt(this.searchBox.style.width) - (this.searchBox.offsetLeft + this.searchBox.clientWidth - this.pdfViewerBase.viewerContainer.clientWidth) + 'px'; // eslint-disable-next-line\n\n        this.searchInput.style.width = parseInt(this.searchInput.style.width) - (this.searchBox.offsetLeft + this.searchBox.clientWidth - this.pdfViewerBase.viewerContainer.clientWidth) + 'px';\n      } else {\n        this.searchBox.style.right = '88.3px';\n        this.searchBox.style.width = '';\n        this.searchInput.style.width = '';\n      }\n    }\n  };\n  /**\n   * @param isShow\n   * @private\n   */\n\n\n  TextSearch.prototype.showSearchBox = function (isShow) {\n    if (isShow) {\n      this.searchBox.style.display = 'block';\n    } else {\n      this.searchBox.style.display = 'none';\n      this.searchInput.value = '';\n    }\n\n    this.onTextSearchClose();\n  };\n  /**\n   * @private\n   */\n\n\n  TextSearch.prototype.searchAfterSelection = function () {\n    if (this.isTextSearch) {\n      this.initSearch(this.searchPageIndex, true);\n      this.highlightOthers();\n    }\n  };\n\n  TextSearch.prototype.initiateTextSearch = function (searchElement) {\n    var inputString = searchElement.value;\n\n    if (inputString && inputString.length > 0 && inputString[inputString.length - 1] === ' ') {\n      inputString = inputString.slice(0, inputString.length - 1);\n    }\n\n    this.initiateSearch(inputString);\n  };\n  /**\n   * @param inputString\n   * @private\n   */\n\n\n  TextSearch.prototype.initiateSearch = function (inputString) {\n    if (inputString !== this.searchString) {\n      this.isTextSearch = false;\n      this.searchPageIndex = this.pdfViewerBase.currentPageNumber - 1;\n    }\n\n    this.clearAllOccurrences();\n\n    if (inputString !== '') {\n      // eslint-disable-next-line\n      if (this.searchMatches[this.searchPageIndex] && inputString === this.searchString) {\n        if (this.searchMatches[this.searchPageIndex].length === 0) {\n          this.initSearch(this.searchPageIndex, false);\n        } else {\n          this.nextSearch();\n        }\n      } else {\n        this.resetVariables();\n        this.searchIndex = 0;\n        this.textSearch(inputString);\n      }\n    }\n  };\n\n  TextSearch.prototype.textSearch = function (inputString) {\n    if (inputString !== '' || inputString) {\n      this.searchString = inputString;\n      this.isTextSearch = true;\n      this.isSearchText = true;\n      this.searchPageIndex = this.pdfViewerBase.currentPageNumber - 1;\n      this.searchCount = 0;\n      this.isTextSearchEventTriggered = false;\n      this.showLoadingIndicator(true);\n      this.pdfViewer.fireTextSearchStart(inputString, this.isMatchCase);\n\n      if (this.pdfViewer.isExtractText) {\n        if (this.isTextRetrieved) {\n          for (var i = 0; i < this.pdfViewerBase.pageCount; i++) {\n            this.initSearch(i, false, true);\n          }\n        } else {\n          this.isTextSearched = true;\n\n          for (var i = 0; i < this.documentTextCollection.length; i++) {\n            this.initSearch(i, false, true);\n          }\n        }\n      }\n\n      this.initSearch(this.searchPageIndex, false);\n      this.highlightOthers();\n    }\n  };\n\n  TextSearch.prototype.nextSearch = function () {\n    this.isPrevSearch = false;\n    this.isTextSearch = true;\n    this.isSearchText = false;\n\n    if (this.searchString) {\n      this.clearAllOccurrences();\n      this.searchIndex = this.searchIndex + 1;\n\n      if (this.searchMatches[this.searchPageIndex]) {\n        // eslint-disable-next-line max-len\n        if (this.searchIndex >= this.searchMatches[this.searchPageIndex].length) {\n          this.searchIndex = 0;\n          this.searchPageIndex = this.searchPageIndex + 1 < this.pdfViewerBase.pageCount ? this.searchPageIndex + 1 : 0;\n\n          if (this.pdfViewerBase.pageCount > 1) {\n            this.initSearch(this.searchPageIndex, false);\n          } else {\n            this.initSearch(this.searchPageIndex, true);\n\n            if (!this.isMessagePopupOpened) {\n              this.onMessageBoxOpen();\n            }\n\n            this.pdfViewerBase.updateScrollTop(this.searchPageIndex);\n          }\n\n          this.showLoadingIndicator(true);\n        } else {\n          this.highlightSearchedTexts(this.searchPageIndex, false, undefined);\n          this.showLoadingIndicator(false);\n        }\n\n        this.highlightOthers(true);\n      } else {\n        this.initiateTextSearch(this.searchInput);\n      }\n    } else {\n      this.initiateTextSearch(this.searchInput);\n    }\n  };\n\n  TextSearch.prototype.prevSearch = function () {\n    this.isPrevSearch = true;\n    this.isTextSearch = true;\n    this.isSearchText = false;\n\n    if (this.searchString) {\n      this.clearAllOccurrences();\n      this.searchIndex = this.searchIndex - 1;\n\n      if (this.searchIndex < 0) {\n        this.searchPageIndex = this.searchPageIndex - 1 < 0 ? this.pdfViewerBase.pageCount - 1 : this.searchPageIndex - 1;\n        this.initSearch(this.searchPageIndex, false);\n        this.showLoadingIndicator(true);\n      } else {\n        this.highlightSearchedTexts(this.searchPageIndex, false, undefined);\n        this.showLoadingIndicator(false);\n      }\n\n      this.highlightOthers(true);\n    } else {\n      this.searchIndex = this.searchIndex - 1;\n      this.searchPageIndex = this.searchPageIndex - 1 < 0 ? this.pdfViewerBase.pageCount - 1 : this.searchPageIndex - 1;\n      var inputString = this.searchInput.value;\n      this.textSearch(inputString);\n    }\n  };\n\n  TextSearch.prototype.initSearch = function (pageIndex, isSinglePageSearch, isCount) {\n    // eslint-disable-next-line\n    var storedData = this.pdfViewerBase.getStoredData(pageIndex, true);\n    var pageText = null;\n    var textContents = null; // eslint-disable-next-line\n\n    var characterBounds = null;\n\n    if (isCount) {\n      if (this.documentTextCollection.length !== 0) {\n        // eslint-disable-next-line\n        var documentIndex = this.documentTextCollection[pageIndex][pageIndex];\n        var pageTextData = documentIndex.pageText ? documentIndex.pageText : documentIndex.PageText;\n\n        if (this.documentTextCollection[pageIndex] && documentIndex) {\n          // eslint-disable-next-line max-len\n          this.getSearchTextContent(pageIndex, this.searchString, pageTextData, textContents, isSinglePageSearch, this.documentTextCollection[pageIndex]);\n        }\n      }\n    } else {\n      if (storedData) {\n        // eslint-disable-next-line\n        pageText = storedData['pageText']; // eslint-disable-next-line\n\n        textContents = storedData['textContent'];\n        characterBounds = this.pdfViewerBase.textLayer.characterBound[pageIndex];\n        this.textContents[pageIndex] = textContents;\n        this.getPossibleMatches(pageIndex, this.searchString, pageText, textContents, isSinglePageSearch, characterBounds);\n      } else {\n        if (!isSinglePageSearch) {\n          this.createRequestForSearch(pageIndex);\n        }\n      }\n    }\n\n    if (this.pdfViewerBase.pageCount === (this.searchedPages && this.searchedPages.length)) {\n      if (!this.isTextSearchEventTriggered) {\n        this.isTextSearchEventTriggered = true;\n        this.pdfViewer.fireTextSearchComplete(this.searchString, this.isMatchCase);\n      }\n    }\n  }; // eslint-disable-next-line\n\n\n  TextSearch.prototype.getPossibleMatches = function (pageIndex, searchString, pageString, textContents, isSinglePageSearch, characterBounds) {\n    var arrayReturns;\n\n    if (this.searchMatches && !this.searchMatches[pageIndex]) {\n      var pageText = pageString;\n      var searchText = searchString;\n      var multiSearch = pageText.replace(/(\\s\\r\\n)/gm, ' ').replace(/(\\r\\n)/gm, \" \");\n      var Multiline = pageString.replace(/(\\s\\r\\n)/gm, '  ').replace(/(\\r\\n)/gm, \" \");\n      var specialCharcterSearch = multiSearch.replace(/[^a-zA-z0-9\" \"]/g, \"\");\n      var queryLength = searchString.length;\n\n      if (!this.isMatchCase) {\n        searchText = searchString.toLowerCase();\n        pageText = pageString.toLowerCase();\n        multiSearch = multiSearch.toLowerCase();\n        Multiline = Multiline.toLowerCase();\n        specialCharcterSearch = specialCharcterSearch.toLowerCase();\n      }\n\n      var matches = [];\n      var matchedArray = [];\n      var matchIndex = -queryLength;\n      var newIndex = -queryLength;\n      var multiSearchIndex = -queryLength;\n      var MultilineIndex = -queryLength;\n      var specialcharcterIndex = -queryLength;\n\n      while (matchIndex !== 0 || matchIndex === 0) {\n        if (searchText === '' || searchText === ' ' || !searchText) {\n          break;\n        }\n\n        matchIndex = pageText.indexOf(searchText, matchIndex + queryLength);\n\n        if (searchText.indexOf(' ') !== -1) {\n          var newString = searchString.replace(' ', '\\r\\n');\n          newIndex = pageText.indexOf(newString, newIndex + queryLength);\n          newIndex = -1;\n\n          if (!(newIndex <= -1)) {\n            if (newIndex < matchIndex) {\n              matches.push(newIndex);\n            }\n          }\n        }\n\n        if (matchIndex <= -1 && newIndex <= -1) {\n          break;\n        }\n\n        if (!(matchIndex <= -1)) {\n          matches.push(matchIndex);\n        }\n\n        if (newIndex > matchIndex && !(newIndex <= -1)) {\n          matches.push(newIndex);\n        }\n      }\n\n      if (matches.length == 0) {\n        multiSearchIndex = multiSearch.indexOf(searchText, multiSearchIndex + queryLength);\n        MultilineIndex = Multiline.indexOf(searchText, MultilineIndex + queryLength);\n        specialcharcterIndex = specialCharcterSearch.indexOf(searchText, specialcharcterIndex + queryLength);\n\n        if (multiSearchIndex !== -1) {\n          arrayReturns = this.correctLinetext(searchString, matchIndex, pageText);\n          matchIndex = -arrayReturns[0].length;\n\n          for (var i = 0; i < arrayReturns.length; i++) {\n            matchIndex = pageText.indexOf(arrayReturns[i].trim(), matchIndex + (arrayReturns[i - 1] === undefined || null ? arrayReturns[0].length : arrayReturns[i - 1].length));\n            matchedArray.push(matchIndex);\n\n            if (matchedArray.length > 1) {\n              if (matchedArray[1] - (matchedArray[0] + arrayReturns[0].length) <= 3) {\n                matches.push(matchedArray);\n                this.searchMatches[pageIndex] = matches;\n              } else {\n                i = -1;\n                matchIndex = matchedArray[0] + arrayReturns[0].length;\n                matchedArray.splice(0, matchedArray.length);\n              }\n            }\n          }\n        } else if (specialcharcterIndex !== -1) {\n          arrayReturns = this.correctLinetext(searchString, matchIndex, pageText);\n          matchIndex = -arrayReturns[0].length;\n\n          for (var i = 0; i < arrayReturns.length; i++) {\n            matchIndex = pageText.indexOf(arrayReturns[i].trim(), matchIndex + (arrayReturns[i - 1] === undefined || null ? arrayReturns[0].length : arrayReturns[i - 1].length));\n            matchedArray.push(matchIndex);\n\n            if (matchedArray.length > 1) {\n              if (matchedArray[1] - (matchedArray[0] + arrayReturns[0].length) <= 3) {\n                matches.push(matchedArray);\n                this.searchMatches[pageIndex] = matches;\n              } else {\n                i = -1;\n                matchIndex = matchedArray[0] + arrayReturns[0].length;\n                matchedArray.splice(0, matchedArray.length);\n              }\n            }\n          }\n        } else if (MultilineIndex !== -1) {\n          arrayReturns = this.correctLinetext(searchString, matchIndex, pageText);\n          matchIndex = -arrayReturns[0].length;\n\n          for (var i = 0; i < arrayReturns.length; i++) {\n            matchIndex = pageText.indexOf(arrayReturns[i].trim(), matchIndex + (arrayReturns[i - 1] === undefined || null ? arrayReturns[0].length : arrayReturns[i - 1].length));\n            matchedArray.push(matchIndex);\n\n            if (matchedArray.length > 1) {\n              if (matchedArray[1] - (matchedArray[0] + arrayReturns[0].length) <= 3) {\n                matches.push(matchedArray);\n                this.searchMatches[pageIndex] = matches;\n              } else {\n                i = -1;\n                matchIndex = matchedArray[0] + arrayReturns[0].length;\n                matchedArray.splice(0, matchedArray.length);\n              }\n            }\n          }\n        }\n\n        if (matches.length > 1) {\n          matches.splice(1, matches.length);\n        }\n      }\n\n      if (this.searchMatches && matches.length > 0) {\n        this.searchMatches[pageIndex] = matches;\n      }\n    }\n\n    if (!isSinglePageSearch) {\n      if (this.searchedPages.indexOf(pageIndex) === -1) {\n        this.searchedPages.push(pageIndex);\n        this.startIndex = this.searchedPages[0];\n      }\n\n      this.updateSearchInputIcon(false);\n    }\n\n    if (this.searchMatches && this.searchMatches[pageIndex] && this.searchMatches[pageIndex].length !== 0) {\n      if (!isSinglePageSearch) {\n        if (this.isPrevSearch) {\n          this.searchIndex = this.searchMatches[pageIndex].length - 1;\n        }\n\n        if (this.pdfViewerBase.currentPageNumber - 1 !== this.searchPageIndex) {\n          // eslint-disable-next-line max-len\n          if (this.searchMatches.length > 0 && (this.searchIndex === 0 || this.searchIndex === -1) && this.searchPageIndex === this.currentSearchIndex) {\n            if (!this.isMessagePopupOpened && !this.isSearchText) {\n              this.onMessageBoxOpen();\n            }\n\n            this.searchPageIndex = this.getSearchPage(this.pdfViewerBase.currentPageNumber - 1);\n            this.searchedPages = [this.searchPageIndex];\n          } // eslint-disable-next-line max-len\n          else if (this.isPrevSearch && this.searchMatches && this.searchMatches.length > 0 && this.searchMatches[this.searchPageIndex] && this.searchMatches[this.searchPageIndex].length > 0 && this.searchedPages.length === this.pdfViewerBase.pageCount && this.startIndex - 1 === this.searchPageIndex) {\n            if (!this.isMessagePopupOpened) {\n              this.onMessageBoxOpen();\n            }\n\n            this.searchedPages = [this.startIndex];\n          }\n\n          this.pdfViewerBase.updateScrollTop(this.searchPageIndex);\n        } else if (this.searchMatches && this.searchMatches[this.searchPageIndex] && this.searchMatches[this.searchPageIndex].length > 0 && this.searchedPages.length === this.pdfViewerBase.pageCount && this.startIndex === this.searchPageIndex && this.pdfViewerBase.pageCount > 1) {\n          if (!this.isMessagePopupOpened) {\n            this.onMessageBoxOpen();\n          }\n\n          this.searchedPages = [this.startIndex];\n        }\n      }\n\n      this.highlightSearchedTexts(pageIndex, isSinglePageSearch, arrayReturns);\n    } else {\n      if (!isSinglePageSearch) {\n        if (this.isPrevSearch) {\n          this.searchPageIndex = this.searchPageIndex - 1 < 0 ? this.pdfViewerBase.pageCount - 1 : this.searchPageIndex - 1;\n        } else {\n          this.searchPageIndex = this.searchPageIndex + 1 < this.pdfViewerBase.pageCount ? this.searchPageIndex + 1 : 0;\n        }\n\n        if (this.searchedPages.indexOf(this.searchPageIndex) === -1 && this.searchedPages.length !== this.pdfViewerBase.pageCount) {\n          this.showLoadingIndicator(true);\n          this.initSearch(this.searchPageIndex, false);\n        } else {\n          var searchPageIndex = this.getSearchPage(pageIndex); // eslint-disable-next-line max-len\n\n          if (this.searchMatches && isNullOrUndefined(this.searchMatches[this.searchPageIndex]) && this.searchedPages.length === this.pdfViewerBase.pageCount) {\n            // eslint-disable-next-line max-len\n            if (!this.isMessagePopupOpened) {\n              this.onMessageBoxOpen();\n            }\n\n            this.pdfViewerBase.updateScrollTop(this.startIndex); // eslint-disable-next-line max-len\n          } else if (this.searchMatches && this.searchMatches.length > 0 && (this.searchIndex === 0 || this.searchIndex === -1) && searchPageIndex === this.currentSearchIndex) {\n            if (this.isPrevSearch) {\n              // eslint-disable-next-line max-len\n              if (!this.isMessagePopupOpened) {\n                this.onMessageBoxOpen();\n              }\n\n              this.searchPageIndex = searchPageIndex;\n              this.searchedPages = [searchPageIndex];\n              this.searchIndex = -1;\n            } else {\n              if (!this.isMessagePopupOpened && this.pdfViewerBase.currentPageNumber !== 1 && !this.isSearchText) {\n                this.onMessageBoxOpen();\n              }\n\n              this.searchPageIndex = searchPageIndex;\n              this.searchedPages = [searchPageIndex];\n              this.searchIndex = 0;\n            }\n\n            this.highlightSearchedTexts(this.searchPageIndex, isSinglePageSearch, undefined);\n          } else if (this.searchMatches && this.searchMatches[this.searchPageIndex] && this.searchMatches[this.searchPageIndex].length > 0 && this.searchedPages.length === this.pdfViewerBase.pageCount) {\n            if (!this.isMessagePopupOpened) {\n              this.onMessageBoxOpen();\n            }\n\n            this.searchPageIndex = this.startIndex;\n            this.searchedPages = [this.searchPageIndex];\n            this.searchIndex = 0;\n            this.pdfViewerBase.updateScrollTop(this.startIndex);\n            this.highlightSearchedTexts(this.searchPageIndex, isSinglePageSearch, undefined);\n          }\n        }\n      }\n    }\n  };\n\n  TextSearch.prototype.correctLinetext = function (searchString, matchIndex, pageText) {\n    var indiuvalLineArray = [];\n    var searchArray = searchString.toLowerCase().split(/[\" \"]+/);\n    matchIndex = 0;\n    var linestring = \"\";\n\n    for (var i = 0; i < searchArray.length; i++) {\n      var searchArrayText = linestring + searchArray[i];\n      matchIndex = pageText.indexOf(searchArrayText, matchIndex);\n\n      if (matchIndex !== -1) {\n        linestring += searchArray[i] + \" \";\n\n        if (i == searchArray.length - 1) {\n          indiuvalLineArray.push(linestring);\n        }\n      } else {\n        indiuvalLineArray.push(linestring);\n        linestring = searchArray[i] + \" \";\n\n        if (i == searchArray.length - 1) {\n          indiuvalLineArray.push(linestring);\n        }\n      }\n    }\n\n    return indiuvalLineArray;\n  }; // eslint-disable-next-line\n\n\n  TextSearch.prototype.getSearchTextContent = function (pageIndex, searchString, pageString, textContents, isSinglePageSearch, characterBounds) {\n    var pageText = pageString;\n    var searchText = searchString;\n    var queryLength = searchString.length;\n\n    if (!this.isMatchCase) {\n      searchText = searchString.toLowerCase();\n      pageText = pageString.toLowerCase();\n    }\n\n    var matches = [];\n    var matchIndex = -queryLength;\n    var newIndex = -queryLength;\n\n    while (matchIndex !== 0) {\n      if (searchText === '' || searchText === ' ' || !searchText) {\n        break;\n      }\n\n      matchIndex = pageText.indexOf(searchText, matchIndex + queryLength);\n\n      if (searchText.indexOf(' ') !== -1) {\n        var newString = searchString.replace(' ', '\\r\\n');\n        newIndex = pageText.indexOf(newString, newIndex + queryLength);\n\n        if (!(newIndex <= -1)) {\n          if (newIndex < matchIndex) {\n            matches.push(newIndex);\n          }\n        }\n      }\n\n      if (matchIndex <= -1 && newIndex <= -1) {\n        break;\n      }\n\n      if (!(matchIndex <= -1)) {\n        matches.push(matchIndex);\n      }\n\n      if (newIndex > matchIndex && !(newIndex <= -1)) {\n        matches.push(newIndex);\n      }\n    }\n\n    if (matches.length !== 0) {\n      this.searchCount = this.searchCount + matches.length;\n    }\n\n    this.searchMatches[pageIndex] = matches;\n  };\n\n  TextSearch.prototype.getSearchPage = function (pageIndex) {\n    var pageNumber = null;\n\n    if (this.isPrevSearch) {\n      for (var i = pageIndex; i >= 0; i--) {\n        if (i !== pageIndex && this.searchMatches[i]) {\n          pageNumber = i;\n          break;\n        }\n      }\n\n      if (!pageNumber) {\n        for (var j = this.pdfViewerBase.pageCount - 1; j > pageIndex; j--) {\n          if (this.searchMatches[j]) {\n            pageNumber = j;\n            break;\n          }\n        }\n      }\n    } else {\n      for (var i = pageIndex; i < this.pdfViewerBase.pageCount; i++) {\n        if (i !== pageIndex && this.searchMatches[i]) {\n          pageNumber = i;\n          break;\n        }\n      }\n\n      if (!pageNumber) {\n        if (pageIndex === 0) {\n          pageNumber = pageIndex;\n        } else {\n          for (var j = 0; j < pageIndex; j++) {\n            if (this.searchMatches[j]) {\n              pageNumber = j;\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    return pageNumber;\n  };\n\n  TextSearch.prototype.highlightSearchedTexts = function (pageIndex, isSinglePageSearch, ArrayReturns) {\n    // eslint-disable-next-line\n    var matches = this.searchMatches[pageIndex];\n    var prevEnd = null; // eslint-disable-next-line\n\n    var scrollPoint = {\n      y: -100,\n      x: -100\n    };\n    var startId;\n    var className;\n    var searchingText = this.searchString; // eslint-disable-next-line\n\n    var characterBounds = this.pdfViewerBase.textLayer.characterBound[pageIndex];\n    var isHighlight = false;\n\n    if (isSinglePageSearch && this.pdfViewerBase.currentPageNumber - 1 !== this.searchPageIndex) {\n      if (this.searchMatches.length > 0) {\n        if (pageIndex === this.getSearchPage(this.pdfViewerBase.currentPageNumber - 1)) {\n          isHighlight = true;\n        }\n      }\n    }\n\n    if (characterBounds) {\n      for (var i = 0; i < matches.length; i++) {\n        if (matches[i].length !== undefined && ArrayReturns !== undefined) {\n          if (i === this.searchIndex && pageIndex === this.searchPageIndex) {\n            for (var j = 0; j < ArrayReturns.length; j++) {\n              className = 'e-pv-search-text-highlight';\n              this.searchString = ArrayReturns[j].trim();\n              this.addDivForSearch(i, pageIndex, characterBounds, this.searchString.length, className, j);\n            }\n          } else {\n            for (var j = 0; j < ArrayReturns.length; j++) {\n              className = 'e-pv-search-text-highlightother';\n              this.searchString = ArrayReturns[j].trim();\n              this.addDivForSearch(i, pageIndex, characterBounds, this.searchString.length, className, j);\n            }\n          }\n        } else if (i === this.searchIndex && pageIndex === this.searchPageIndex) {\n          className = 'e-pv-search-text-highlight';\n        } else {\n          className = 'e-pv-search-text-highlightother';\n        }\n\n        if (matches[i].length == undefined) {\n          this.addDivForSearch(i, pageIndex, characterBounds, this.searchString.length, className, undefined);\n        }\n      }\n\n      this.searchString = searchingText;\n\n      if (pageIndex === this.searchPageIndex && !isSinglePageSearch) {\n        var element = this.pdfViewerBase.getElement('_searchtext_' + pageIndex + '_' + this.searchIndex);\n\n        if (element) {\n          var targetScrollElement = this.getScrollElement(element);\n          this.scrollToSearchStr(targetScrollElement, scrollPoint);\n        } else {\n          this.pdfViewerBase.updateScrollTop(pageIndex);\n          var element_1 = this.pdfViewerBase.getElement('_searchtext_' + pageIndex + '_' + this.searchIndex);\n\n          if (element_1) {\n            var targetScrollElement = this.getScrollElement(element_1);\n            this.scrollToSearchStr(targetScrollElement, scrollPoint);\n          }\n        }\n      }\n    }\n  }; // eslint-disable-next-line\n\n\n  TextSearch.prototype.addDivForSearch = function (index, pageIndex, characterBounds, queryLength, className, nestedIndex) {\n    var textLayer = this.pdfViewerBase.getElement('_textLayer_' + pageIndex);\n\n    if (isNullOrUndefined(textLayer) && className === 'e-pv-search-text-highlight') {\n      if (this.pdfViewer.navigation) {\n        this.pdfViewer.navigation.goToPage(pageIndex + 1);\n      }\n    }\n\n    var count;\n\n    if (this.searchMatches[pageIndex][index].length !== undefined) {\n      count = this.searchMatches[pageIndex][index][nestedIndex];\n    } else {\n      count = this.searchMatches[pageIndex][index];\n    }\n\n    var initial = count;\n    var divCount = 0;\n\n    while (count < initial + queryLength) {\n      count = this.addDivElement(count, characterBounds, queryLength, className, index, pageIndex, initial, divCount, nestedIndex);\n      divCount++;\n    }\n\n    if (className === 'e-pv-search-text-highlight') {\n      this.showLoadingIndicator(false);\n    }\n  }; // eslint-disable-next-line\n\n\n  TextSearch.prototype.addDivElement = function (count, characterBounds, queryLength, className, index, pageIndex, initial, divCount, nestedIndex) {\n    var height = 0;\n    var width = 0;\n    var top = 0;\n    var left = 0;\n    var isRTL = false;\n\n    if (characterBounds[count]) {\n      left = characterBounds[count].X;\n      top = characterBounds[count].Y;\n    }\n\n    var v = 0;\n\n    if (count - initial !== 0) {\n      v = count - initial;\n      queryLength += 1;\n    }\n\n    for (v = v; v < queryLength; v++) {\n      if (characterBounds[count]) {\n        // eslint-disable-next-line\n        var charBound = characterBounds[count];\n\n        if (left > charBound.X) {\n          isRTL = true;\n        }\n\n        top = top < charBound.Y ? top : charBound.Y;\n        var topDifference = top < charBound.Y ? charBound.Y - top : top - charBound.Y;\n        height = height > topDifference + charBound.Height ? height : topDifference + charBound.Height;\n        count++;\n      }\n    }\n\n    var isContinuation = false;\n\n    if (!isRTL) {\n      if (initial + queryLength !== count) {\n        isContinuation = true;\n\n        if (characterBounds[count - 1]) {\n          width = characterBounds[count - 1].X - left;\n        }\n      } else {\n        isContinuation = false; // eslint-disable-next-line\n\n        var storedData = this.pdfViewerBase.getStoredData(pageIndex, true);\n        var pageText = null;\n\n        if (storedData) {\n          pageText = storedData['pageText'];\n        } else if (this.pdfViewer.isExtractText && this.documentTextCollection.length !== 0) {\n          // eslint-disable-next-line\n          var documentIndex = this.documentTextCollection[pageIndex][pageIndex];\n          pageText = documentIndex.pageText ? documentIndex.pageText : documentIndex.PageText;\n        }\n\n        if (characterBounds[count]) {\n          if (pageText && (pageText[count] === '' || pageText[count] === ' ' || pageText[count] === '\\r' || pageText[count] === '\\n') && characterBounds[count].Width === 0) {\n            width = characterBounds[count - 1].X - left + characterBounds[count - 1].Width;\n          } else {\n            width = characterBounds[count].X - left;\n          }\n        } else {\n          if (characterBounds[count - 1]) {\n            width = characterBounds[count - 1].X - left;\n          }\n        }\n      }\n    } else {\n      var charBound = characterBounds[initial + queryLength - 1];\n      left = charBound.X;\n      width = characterBounds[initial].X - characterBounds[initial + queryLength - 1].X;\n      top = top < charBound.Y ? top : charBound.Y;\n      var topDifference = top < charBound.Y ? charBound.Y - top : top - charBound.Y;\n      height = height > topDifference + charBound.Height ? height : topDifference + charBound.Height; //some RTL character calculated width is zero and width difference value calculated from Y possition difference in the same line.\n\n      var widthDifference = characterBounds[initial - 1].Y - characterBounds[initial].Y;\n\n      for (var j = initial + queryLength - 1; j >= initial; j--) {\n        charBound = characterBounds[j];\n\n        if (charBound.Width === 0) {\n          widthDifference = charBound.Y - characterBounds[j - 1].Y;\n        }\n      }\n\n      width = width + widthDifference;\n    }\n\n    this.createSearchTextDiv(index, pageIndex, height, width, top, left, className, isContinuation, divCount, nestedIndex);\n    return count;\n  }; // eslint-disable-next-line\n\n\n  TextSearch.prototype.createSearchTextDiv = function (index, pageIndex, height, width, top, left, className, isContinuation, divCount, nestedIndex) {\n    var idString = '_searchtext_' + pageIndex + '_' + index;\n\n    if (isContinuation) {\n      idString += '_' + divCount;\n    }\n\n    if (nestedIndex !== undefined && this.pdfViewerBase.getElement(idString)) {\n      var textDiv = createElement('div', {\n        id: this.pdfViewer.element.id + idString + \"_\" + nestedIndex\n      }); // eslint-disable-next-line\n\n      var pageDetails = this.pdfViewerBase.pageSize[pageIndex];\n      this.calculateBounds(textDiv, height, width, top, left, pageDetails);\n      textDiv.classList.add(className);\n\n      if (className === 'e-pv-search-text-highlight') {\n        // eslint-disable-next-line max-len\n        textDiv.style.backgroundColor = this.pdfViewer.textSearchColorSettings.searchHighlightColor === '' ? '#fdd835' : this.pdfViewer.textSearchColorSettings.searchHighlightColor;\n        var bounds = {\n          left: left,\n          top: top,\n          width: width,\n          height: height\n        };\n        this.pdfViewer.fireTextSearchHighlight(this.searchString, this.isMatchCase, bounds, pageIndex + 1);\n      } else if (className === 'e-pv-search-text-highlightother') {\n        // eslint-disable-next-line max-len\n        textDiv.style.backgroundColor = this.pdfViewer.textSearchColorSettings.searchColor === '' ? '#8b4c12' : this.pdfViewer.textSearchColorSettings.searchColor;\n      }\n\n      var textLayer = this.pdfViewerBase.getElement('_textLayer_' + pageIndex);\n\n      if (textLayer) {\n        textLayer.appendChild(textDiv);\n      }\n    }\n\n    if (!this.pdfViewerBase.getElement(idString)) {\n      var textDiv = createElement('div', {\n        id: this.pdfViewer.element.id + idString\n      }); // eslint-disable-next-line\n\n      var pageDetails = this.pdfViewerBase.pageSize[pageIndex];\n      this.calculateBounds(textDiv, height, width, top, left, pageDetails);\n      textDiv.classList.add(className);\n\n      if (className === 'e-pv-search-text-highlight') {\n        // eslint-disable-next-line max-len\n        textDiv.style.backgroundColor = this.pdfViewer.textSearchColorSettings.searchHighlightColor === '' ? '#fdd835' : this.pdfViewer.textSearchColorSettings.searchHighlightColor;\n        var bounds = {\n          left: left,\n          top: top,\n          width: width,\n          height: height\n        };\n        this.pdfViewer.fireTextSearchHighlight(this.searchString, this.isMatchCase, bounds, pageIndex + 1);\n      } else if (className === 'e-pv-search-text-highlightother') {\n        // eslint-disable-next-line max-len\n        textDiv.style.backgroundColor = this.pdfViewer.textSearchColorSettings.searchColor === '' ? '#8b4c12' : this.pdfViewer.textSearchColorSettings.searchColor;\n      }\n\n      var textLayer = this.pdfViewerBase.getElement('_textLayer_' + pageIndex);\n\n      if (textLayer) {\n        textLayer.appendChild(textDiv);\n      }\n    }\n  }; // eslint-disable-next-line\n\n\n  TextSearch.prototype.calculateBounds = function (textDiv, height, width, top, left, pageDetails) {\n    if (pageDetails.rotation === 0 || pageDetails.rotation === 2) {\n      textDiv.style.height = Math.ceil(height) * this.pdfViewerBase.getZoomFactor() + 'px';\n      textDiv.style.width = width * this.pdfViewerBase.getZoomFactor() + 'px';\n\n      if (pageDetails.rotation === 2) {\n        textDiv.style.top = (pageDetails.height - top - height) * this.pdfViewerBase.getZoomFactor() + 'px';\n        textDiv.style.left = Math.ceil(pageDetails.width - left - width) * this.pdfViewerBase.getZoomFactor() + 'px';\n      } else {\n        textDiv.style.top = top * this.pdfViewerBase.getZoomFactor() + 'px';\n        textDiv.style.left = left * this.pdfViewerBase.getZoomFactor() + 'px';\n      }\n    } else if (pageDetails.rotation === 1) {\n      textDiv.style.height = width * this.pdfViewerBase.getZoomFactor() + 'px';\n      textDiv.style.width = height * this.pdfViewerBase.getZoomFactor() + 'px';\n      textDiv.style.top = left * this.pdfViewerBase.getZoomFactor() + 'px';\n      textDiv.style.left = (pageDetails.height - top - height) * this.pdfViewerBase.getZoomFactor() + 'px';\n    } else if (pageDetails.rotation === 3) {\n      textDiv.style.height = width * this.pdfViewerBase.getZoomFactor() + 'px';\n      textDiv.style.width = height * this.pdfViewerBase.getZoomFactor() + 'px';\n      textDiv.style.left = (pageDetails.width - pageDetails.height + top) * this.pdfViewerBase.getZoomFactor() + 'px';\n      textDiv.style.top = (pageDetails.height - left - width) * this.pdfViewerBase.getZoomFactor() + 'px';\n    }\n  };\n\n  TextSearch.prototype.isClassAvailable = function () {\n    var isClass = false;\n\n    for (var j = 0; j < this.tempElementStorage.length; j++) {\n      if (this.tempElementStorage[j].classString) {\n        // eslint-disable-next-line max-len\n        if (this.tempElementStorage[j].classString === 'e-pv-search-text-highlight' || this.tempElementStorage[j].classString === 'e-pv-search-text-highlightother') {\n          isClass = true;\n          break;\n        }\n      }\n    }\n\n    return isClass;\n  };\n\n  TextSearch.prototype.getScrollElement = function (element) {\n    var targetElement = element;\n\n    if (element.childNodes.length > 0) {\n      for (var i = 0; i < element.childNodes.length; i++) {\n        if (element.childNodes[i].classList) {\n          if (element.childNodes[i].classList.contains('e-pv-search-text-highlight')) {\n            targetElement = element.childNodes[i];\n          }\n        }\n      }\n    }\n\n    return targetElement;\n  }; // eslint-disable-next-line\n\n\n  TextSearch.prototype.scrollToSearchStr = function (element, scrollPoint) {\n    var parent = element.offsetParent;\n    var offsetY = element.offsetTop + element.clientTop;\n    var offsetX = element.offsetLeft + element.clientLeft;\n\n    while (parent.id !== this.pdfViewerBase.viewerContainer.id) {\n      offsetY += parent.offsetTop;\n      offsetX += parent.offsetLeft;\n      parent = parent.offsetParent;\n    }\n\n    if (scrollPoint) {\n      offsetY += scrollPoint.y;\n      offsetX += scrollPoint.x;\n\n      if (Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n        parent.scrollLeft = offsetX;\n      } else {\n        if (this.pdfViewerBase.getZoomFactor() > 1.5) {\n          parent.scrollLeft = offsetX;\n        }\n      }\n    }\n\n    parent.scrollTop = offsetY;\n    this.pdfViewerBase.updateMobileScrollerPosition();\n  };\n  /**\n   * @param pageIndex\n   * @private\n   */\n\n\n  TextSearch.prototype.resizeSearchElements = function (pageIndex) {\n    var searchDivs = document.querySelectorAll('div[id*=\"' + this.pdfViewer.element.id + '_searchtext_' + pageIndex + '\"]');\n\n    for (var i = 0; i < searchDivs.length; i++) {\n      var textDiv = searchDivs[i];\n      var previousZoomFactor = 1;\n\n      if (this.pdfViewer.magnificationModule) {\n        previousZoomFactor = this.pdfViewer.magnificationModule.previousZoomFactor;\n      } // eslint-disable-next-line max-len\n\n\n      var outputdata = pageIndex + '_' + previousZoomFactor + '_' + this.pdfViewerBase.getZoomFactor();\n\n      if (textDiv.getAttribute('name') !== outputdata) {\n        // eslint-disable-next-line\n        textDiv.style.width = parseFloat(textDiv.style.width) / previousZoomFactor * this.pdfViewerBase.getZoomFactor() + 'px'; // eslint-disable-next-line\n\n        textDiv.style.height = parseFloat(textDiv.style.height) / previousZoomFactor * this.pdfViewerBase.getZoomFactor() + 'px'; // eslint-disable-next-line\n\n        textDiv.style.top = parseFloat(textDiv.style.top) / previousZoomFactor * this.pdfViewerBase.getZoomFactor() + 'px'; // eslint-disable-next-line\n\n        textDiv.style.left = parseFloat(textDiv.style.left) / previousZoomFactor * this.pdfViewerBase.getZoomFactor() + 'px';\n        textDiv.setAttribute('name', outputdata);\n      }\n    }\n  };\n  /**\n   * @param pageNumber\n   * @private\n   */\n\n\n  TextSearch.prototype.highlightOtherOccurrences = function (pageNumber) {\n    this.initSearch(pageNumber, true);\n  };\n\n  TextSearch.prototype.highlightOthers = function (isSearched) {\n    var indexes = this.getIndexes();\n    var lowerPageValue = parseFloat(indexes.lowerPageValue.toString());\n    var higherPageValue = parseFloat(indexes.higherPageValue.toString());\n\n    for (var i = lowerPageValue; i <= higherPageValue; i++) {\n      this.highlightOtherOccurrences(i);\n    }\n\n    if (isSearched) {\n      this.showLoadingIndicator(false);\n    }\n  };\n  /**\n   * @private\n   */\n\n\n  TextSearch.prototype.clearAllOccurrences = function () {\n    var searchTextDivs = document.querySelectorAll('div[id*=\"' + this.pdfViewer.element.id + '_searchtext_\"]');\n\n    for (var i = 0; i < searchTextDivs.length; i++) {\n      searchTextDivs[i].parentElement.removeChild(searchTextDivs[i]);\n    }\n  };\n  /**\n   * @private\n   */\n  // eslint-disable-next-line\n\n\n  TextSearch.prototype.getIndexes = function () {\n    var lowerPageValue = this.pdfViewerBase.currentPageNumber - 3;\n    lowerPageValue = lowerPageValue > 0 ? lowerPageValue : 0;\n    var higherPageValue = this.pdfViewerBase.currentPageNumber + 1;\n    higherPageValue = higherPageValue < this.pdfViewerBase.pageCount ? higherPageValue : this.pdfViewerBase.pageCount - 1;\n    return {\n      lowerPageValue: lowerPageValue,\n      higherPageValue: higherPageValue\n    };\n  };\n\n  TextSearch.prototype.applyTextSelection = function () {\n    if (this.pdfViewer.textSelectionModule && !this.pdfViewerBase.isTextSelectionDisabled) {\n      var indexes = this.getIndexes();\n      var lowerPageValue = parseFloat(indexes.lowerPageValue.toString());\n      var higherPageValue = parseFloat(indexes.higherPageValue.toString());\n\n      for (var i = lowerPageValue; i <= higherPageValue; i++) {\n        this.pdfViewer.textSelectionModule.applySelectionRangeOnScroll(i);\n      }\n    }\n  };\n  /**\n   * @private\n   */\n\n\n  TextSearch.prototype.resetTextSearch = function () {\n    this.resetVariables();\n    this.onTextSearchClose();\n    this.searchPageIndex = null;\n    this.searchIndex = 0;\n    this.updateSearchInputIcon(true);\n    this.enableNextButton(false);\n    this.enablePrevButton(false);\n    this.documentTextCollection = [];\n    this.isTextRetrieved = false;\n    this.isTextSearched = false;\n    this.isSearchText = false;\n\n    if (this.searchRequestHandler) {\n      this.searchRequestHandler.clear();\n    }\n  };\n\n  TextSearch.prototype.onTextSearchClose = function () {\n    this.isPrevSearch = false;\n    this.isTextSearch = false;\n\n    if (this.pdfViewerBase.pageCount > 0) {\n      this.clearAllOccurrences();\n    }\n  };\n\n  TextSearch.prototype.createRequestForSearch = function (pageIndex) {\n    var proxy = this;\n    var viewPortWidth = 816;\n    var viewPortHeight = this.pdfViewer.element.clientHeight;\n    var pageWidth = this.pdfViewerBase.pageSize[pageIndex].width;\n    var pageHeight = this.pdfViewerBase.pageSize[pageIndex].height;\n    var tileCount = this.pdfViewerBase.getTileCount(pageWidth);\n    var noTileX = viewPortWidth >= pageWidth ? 1 : tileCount;\n    var noTileY = viewPortWidth >= pageWidth ? 1 : tileCount;\n    var isTileRendering = false;\n    var tileSettings = this.pdfViewer.tileRenderingSettings;\n\n    if (tileSettings.enableTileRendering && tileSettings.x > 0 && tileSettings.y > 0) {\n      noTileX = viewPortWidth >= pageWidth ? 1 : tileSettings.x;\n      noTileY = viewPortWidth >= pageWidth ? 1 : tileSettings.y;\n    }\n\n    if (noTileX > 1 && noTileY > 1) {\n      isTileRendering = true;\n    }\n\n    var _loop_1 = function (x) {\n      var _loop_2 = function (y) {\n        var jsonObject = void 0; // eslint-disable-next-line max-len\n\n        jsonObject = {\n          xCoordinate: x,\n          yCoordinate: y,\n          pageNumber: pageIndex,\n          viewPortWidth: viewPortWidth,\n          viewPortHeight: viewPortHeight,\n          documentId: proxy.pdfViewerBase.getDocumentId(),\n          hashId: proxy.pdfViewerBase.hashId,\n          zoomFactor: proxy.pdfViewerBase.getZoomFactor(),\n          tilecount: tileCount,\n          action: 'Search',\n          elementId: proxy.pdfViewer.element.id,\n          uniqueId: proxy.pdfViewerBase.documentId,\n          tileXCount: noTileX,\n          tileYCount: noTileY\n        };\n\n        if (this_1.pdfViewerBase.jsonDocumentId) {\n          // eslint-disable-next-line\n          jsonObject.documentId = this_1.pdfViewerBase.jsonDocumentId;\n        }\n\n        this_1.searchRequestHandler = new AjaxHandler(this_1.pdfViewer);\n        this_1.searchRequestHandler.url = this_1.pdfViewer.serviceUrl + '/' + this_1.pdfViewer.serverActionSettings.renderPages;\n        this_1.searchRequestHandler.responseType = 'json';\n        this_1.searchRequestHandler.send(jsonObject); // eslint-disable-next-line\n\n        this_1.searchRequestHandler.onSuccess = function (result) {\n          // eslint-disable-next-line\n          var data = result.data;\n\n          if (data) {\n            if (typeof data !== 'object') {\n              try {\n                data = JSON.parse(data);\n              } catch (error) {\n                proxy.pdfViewerBase.onControlError(500, data, this.pdfViewer.serverActionSettings.renderPages);\n                data = null;\n              }\n            }\n\n            if (data) {\n              if (!isNullOrUndefined(data.pageText) && data.uniqueId === proxy.pdfViewerBase.documentId) {\n                proxy.pdfViewer.fireAjaxRequestSuccess(this.pdfViewer.serverActionSettings.renderPages, data);\n                var pageNumber = data.pageNumber !== undefined ? data.pageNumber : pageIndex;\n\n                if (viewPortWidth >= pageWidth) {\n                  proxy.pdfViewerBase.storeWinData(data, pageNumber);\n                } else {\n                  proxy.pdfViewerBase.storeWinData(data, pageNumber, data.tileX, data.tileY);\n                }\n\n                if (!isTileRendering) {\n                  proxy.initSearch(pageIndex, false);\n                } else {\n                  if (x === noTileX - 1 && y === noTileY - 1) {\n                    proxy.initSearch(pageIndex, false);\n                  }\n                }\n              } else if (isTileRendering && data.uniqueId === proxy.pdfViewerBase.documentId) {\n                proxy.pdfViewer.fireAjaxRequestSuccess(this.pdfViewer.serverActionSettings.renderPages, data);\n                var pageNumber = data.pageNumber !== undefined ? data.pageNumber : pageIndex;\n                proxy.pdfViewerBase.storeWinData(data, pageNumber, data.tileX, data.tileY);\n\n                if (x === noTileX - 1 && y === noTileY - 1) {\n                  proxy.initSearch(pageIndex, false);\n                }\n              }\n            }\n          }\n        }; // eslint-disable-next-line\n\n\n        this_1.searchRequestHandler.onFailure = function (result) {\n          proxy.pdfViewer.fireAjaxRequestFailed(result.status, result.statusText, this.pdfViewer.serverActionSettings.renderPages);\n        }; // eslint-disable-next-line\n\n\n        this_1.searchRequestHandler.onError = function (result) {\n          proxy.pdfViewerBase.openNotificationPopup(); // eslint-disable-next-line max-len\n\n          proxy.pdfViewer.fireAjaxRequestFailed(result.status, result.statusText, this.pdfViewer.serverActionSettings.renderPages);\n        };\n      };\n\n      for (var y = 0; y < noTileY; y++) {\n        _loop_2(y);\n      }\n    };\n\n    var this_1 = this;\n\n    for (var x = 0; x < noTileX; x++) {\n      _loop_1(x);\n    }\n  };\n  /**\n   * @private\n   */\n\n\n  TextSearch.prototype.getPDFDocumentTexts = function () {\n    var startIndex = 0;\n    var endIndex = 50;\n    var pageCount = this.pdfViewerBase.pageCount;\n\n    if (endIndex >= pageCount) {\n      endIndex = pageCount;\n    }\n\n    this.createRequestForGetPdfTexts(startIndex, endIndex);\n  };\n  /**\n   * @param startIndex\n   * @param endIndex\n   * @private\n   */\n\n\n  TextSearch.prototype.createRequestForGetPdfTexts = function (startIndex, endIndex) {\n    var proxy = this;\n    var jsonObject; // eslint-disable-next-line max-len\n\n    jsonObject = {\n      pageStartIndex: startIndex,\n      pageEndIndex: endIndex,\n      documentId: proxy.pdfViewerBase.getDocumentId(),\n      hashId: proxy.pdfViewerBase.hashId,\n      action: 'RenderPdfTexts',\n      elementId: proxy.pdfViewer.element.id,\n      uniqueId: proxy.pdfViewerBase.documentId\n    };\n\n    if (this.pdfViewerBase.jsonDocumentId) {\n      // eslint-disable-next-line\n      jsonObject.documentId = this.pdfViewerBase.jsonDocumentId;\n    }\n\n    this.searchRequestHandler = new AjaxHandler(this.pdfViewer);\n    this.searchRequestHandler.url = this.pdfViewer.serviceUrl + '/' + this.pdfViewer.serverActionSettings.renderTexts;\n    this.searchRequestHandler.responseType = 'json';\n    this.searchRequestHandler.send(jsonObject); // eslint-disable-next-line\n\n    this.searchRequestHandler.onSuccess = function (result) {\n      // eslint-disable-next-line\n      var data = result.data;\n\n      if (data) {\n        if (typeof data !== 'object') {\n          try {\n            data = JSON.parse(data);\n          } catch (error) {\n            proxy.pdfViewerBase.onControlError(500, data, this.pdfViewer.serverActionSettings.renderTexts);\n            data = null;\n          }\n        }\n\n        if (data) {\n          if (data.documentTextCollection && data.uniqueId === proxy.pdfViewerBase.documentId) {\n            proxy.pdfViewer.fireAjaxRequestSuccess(this.pdfViewer.serverActionSettings.renderTexts, data);\n\n            if (proxy.documentTextCollection.length > 0) {\n              proxy.documentTextCollection = data.documentTextCollection.concat(proxy.documentTextCollection);\n              proxy.documentTextCollection = proxy.orderPdfTextCollections(proxy.documentTextCollection);\n            } else {\n              proxy.documentTextCollection = data.documentTextCollection;\n            }\n\n            var pageCount = proxy.pdfViewerBase.pageCount;\n\n            if (endIndex !== pageCount) {\n              startIndex = endIndex;\n              endIndex = endIndex + 50;\n\n              if (endIndex >= pageCount) {\n                endIndex = pageCount;\n              }\n\n              proxy.createRequestForGetPdfTexts(startIndex, endIndex);\n            } else {\n              proxy.isTextRetrieved = true;\n              proxy.pdfViewer.fireTextExtractionCompleted(proxy.documentTextCollection);\n\n              if (proxy.isTextSearched && proxy.searchString.length > 0) {\n                proxy.textSearch(proxy.searchString);\n                proxy.isTextSearched = false;\n              }\n            }\n          }\n        }\n      }\n    }; // eslint-disable-next-line\n\n\n    this.searchRequestHandler.onFailure = function (result) {\n      proxy.pdfViewer.fireAjaxRequestFailed(result.status, result.statusText, this.pdfViewer.serverActionSettings.renderTexts);\n    }; // eslint-disable-next-line\n\n\n    this.searchRequestHandler.onError = function (result) {\n      proxy.pdfViewerBase.openNotificationPopup();\n      proxy.pdfViewer.fireAjaxRequestFailed(result.status, result.statusText, this.pdfViewer.serverActionSettings.renderTexts);\n    };\n  }; // eslint-disable-next-line\n\n\n  TextSearch.prototype.orderPdfTextCollections = function (oldCollection) {\n    // eslint-disable-next-line\n    var annotationCollectionList = [];\n\n    for (var i = 0; i < oldCollection.length; i++) {\n      if (annotationCollectionList.length === 0) {\n        annotationCollectionList.push(oldCollection[i]);\n      } else {\n        // eslint-disable-next-line\n        if (parseInt(Object.keys(oldCollection[i])[0]) > parseInt(Object.keys(annotationCollectionList[annotationCollectionList.length - 1])[0])) {\n          annotationCollectionList.push(oldCollection[i]);\n        } else {\n          for (var j = 0; j < annotationCollectionList.length; j++) {\n            // eslint-disable-next-line\n            if (parseInt(Object.keys(oldCollection[i])[0]) < parseInt(Object.keys(annotationCollectionList[j])[0])) {\n              annotationCollectionList.splice(j, 0, oldCollection[i]);\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    return annotationCollectionList;\n  };\n\n  TextSearch.prototype.createSearchBoxButtons = function (id, className) {\n    // eslint-disable-next-line max-len\n    var button = createElement('button', {\n      id: this.pdfViewer.element.id + '_' + id,\n      className: 'e-btn e-icon-btn e-pv-search-btn ' + className\n    });\n    button.setAttribute('type', 'button'); // eslint-disable-next-line max-len\n\n    var iconSpan = createElement('span', {\n      id: this.pdfViewer.element.id + '_' + id + 'Icon',\n      className: 'e-pv-icon-search ' + className + '-icon'\n    });\n    button.disabled = true;\n    button.appendChild(iconSpan);\n    return button;\n  };\n\n  TextSearch.prototype.enablePrevButton = function (isEnable) {\n    if (!Browser.isDevice || this.pdfViewer.enableDesktopMode) {\n      if (isEnable) {\n        this.prevSearchBtn.removeAttribute('disabled');\n      } else {\n        if (this.prevSearchBtn) {\n          this.prevSearchBtn.disabled = true;\n        }\n      }\n    }\n  };\n\n  TextSearch.prototype.enableNextButton = function (isEnable) {\n    if (!Browser.isDevice || this.pdfViewer.enableDesktopMode) {\n      if (isEnable) {\n        this.nextSearchBtn.removeAttribute('disabled');\n      } else {\n        if (this.nextSearchBtn) {\n          this.nextSearchBtn.disabled = true;\n        }\n      }\n    }\n  };\n  /**\n   * @private\n   */\n\n\n  TextSearch.prototype.resetVariables = function () {\n    this.searchedPages = []; // eslint-disable-next-line\n\n    this.searchMatches = new Array();\n  };\n  /**\n   * @param element\n   * @param inputElement\n   * @private\n   */\n\n\n  TextSearch.prototype.searchButtonClick = function (element, inputElement) {\n    this.isMessagePopupOpened = false;\n\n    if (isBlazor() && Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n      var searchElement = this.pdfViewerBase.getElement('_search_box-icon');\n      element = searchElement.children[0].children[0];\n      inputElement = this.pdfViewerBase.getElement('_search_input');\n    }\n\n    if (element.classList.contains('e-pv-search-icon')) {\n      this.initiateTextSearch(inputElement);\n    } else if (element.classList.contains('e-pv-search-close')) {\n      this.showLoadingIndicator(false);\n      inputElement.value = '';\n      this.resetTextSearch();\n      inputElement.focus();\n    }\n  };\n\n  TextSearch.prototype.updateSearchInputIcon = function (isEnable) {\n    if (isBlazor()) {\n      if (this.searchBtn && Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n        this.searchBtn = this.pdfViewerBase.getElement('_search_box-icon').children[0].children[0];\n      }\n    }\n\n    if (this.searchBtn) {\n      if (isEnable) {\n        this.searchBtn.classList.remove('e-pv-search-close');\n        this.searchBtn.classList.add('e-pv-search-icon');\n      } else {\n        this.searchBtn.classList.remove('e-pv-search-icon');\n        this.searchBtn.classList.add('e-pv-search-close');\n      }\n    }\n  };\n\n  TextSearch.prototype.onMessageBoxOpen = function () {\n    var _this = this;\n\n    this.showLoadingIndicator(false);\n    this.pdfViewerBase.getElement('_search_input').blur();\n    this.isMessagePopupOpened = true;\n\n    if (!Browser.isDevice || this.pdfViewer.enableDesktopMode) {\n      if (isBlazor()) {\n        var promise = this.pdfViewer._dotnetInstance.invokeMethodAsync('GetLocaleText', 'PdfViewer_Nomatches');\n\n        promise.then(function (value) {\n          _this.pdfViewerBase.textLayer.createNotificationPopup(value);\n        });\n      } else {\n        this.pdfViewerBase.textLayer.createNotificationPopup(this.pdfViewer.localeObj.getConstant('No matches'));\n      }\n    } else {\n      if (isBlazor()) {\n        var promise = this.pdfViewer._dotnetInstance.invokeMethodAsync('GetLocaleText', 'PdfViewer_NoTextFound');\n\n        promise.then(function (value) {\n          _this.pdfViewerBase.navigationPane.createTooltipMobile(value);\n        });\n      } else {\n        this.pdfViewerBase.navigationPane.createTooltipMobile(this.pdfViewer.localeObj.getConstant('No Text Found'));\n      }\n    }\n  };\n  /**\n   * Searches the target text in the PDF document and highlights the occurrences in the pages\n   *\n   * @param  {string} searchText - Specifies the searchText content\n   * @param  {boolean} isMatchCase - If set true , its highlights the MatchCase content\n   * @returns void\n   */\n\n\n  TextSearch.prototype.searchText = function (searchText, isMatchCase) {\n    if (searchText && searchText.length > 0 && searchText[searchText.length - 1] === ' ') {\n      searchText = searchText.slice(0, searchText.length - 1);\n    }\n\n    this.searchString = searchText;\n    this.isMatchCase = isMatchCase;\n    this.searchIndex = 0;\n    this.textSearch(searchText);\n  };\n  /**\n   * Searches the next occurrence of the searched text from the current occurrence of the PdfViewer.\n   *\n   * @returns void\n   */\n\n\n  TextSearch.prototype.searchNext = function () {\n    this.nextSearch();\n  };\n  /**\n   * Searches the previous occurrence of the searched text from the current occurrence of the PdfViewer.\n   *\n   * @returns void\n   */\n\n\n  TextSearch.prototype.searchPrevious = function () {\n    this.prevSearch();\n  };\n  /**\n   * Cancels the text search of the PdfViewer.\n   *\n   * @returns void\n   */\n\n\n  TextSearch.prototype.cancelTextSearch = function () {\n    this.resetTextSearch();\n  };\n  /**\n   * @private\n   */\n\n\n  TextSearch.prototype.destroy = function () {\n    this.searchMatches = undefined;\n  };\n  /**\n   * @private\n   */\n\n\n  TextSearch.prototype.getModuleName = function () {\n    return 'TextSearch';\n  };\n\n  return TextSearch;\n}();\n\nexport { TextSearch };","map":{"version":3,"names":["createElement","Browser","isNullOrUndefined","isBlazor","CheckBox","AjaxHandler","createSpinner","showSpinner","hideSpinner","TextSearch","pdfViewer","pdfViewerBase","_this","isTextSearch","searchCount","searchIndex","currentSearchIndex","startIndex","searchPageIndex","searchString","isMatchCase","searchRequestHandler","textContents","Array","searchMatches","searchCollection","searchedPages","isPrevSearch","tempElementStorage","isMessagePopupOpened","isTextRetrieved","isTextSearched","isTextSearchEventTriggered","isSearchText","checkBoxOnChange","event","currentTarget","checked","resetVariables","clearAllOccurrences","inputString","searchInput","value","textSearch","searchKeypressHandler","enableNextButton","enablePrevButton","which","initiateTextSearch","updateSearchInputIcon","searchClickHandler","searchButtonClick","searchBtn","nextButtonOnClick","nextSearch","prevButtonOnClick","prevSearch","prototype","createTextSearchBox","searchBox","id","element","className","toolbarElement","document","getElementById","getElement","style","top","clientHeight","searchElementsContainer","searchInputContainer","type","promise","_dotnetInstance","invokeMethodAsync","then","placeholder","localeObj","getConstant","appendChild","enableRtl","prevSearchBtn","createSearchBoxButtons","setAttribute","nextSearchBtn","matchCaseContainer","matchCaseInput","height","width","addEventListener","bind","mainContainer","matchCaseText_1","styles","textContent","checkBox","cssClass","label","change","appendTo","waitingPopup","position","left","clientWidth","target","setLoaderProperties","showSearchBox","classList","add","remove","right","parentElement","spinnerElement","firstChild","transformOrigin","showLoadingIndicator","isShow","textSearchBoxOnResize","toolbarModule","enableToolbar","secondaryToolbar","contains","viewerContainer","offsetLeft","parseInt","display","onTextSearchClose","searchAfterSelection","initSearch","highlightOthers","searchElement","length","slice","initiateSearch","currentPageNumber","fireTextSearchStart","isExtractText","i","pageCount","documentTextCollection","onMessageBoxOpen","updateScrollTop","highlightSearchedTexts","undefined","pageIndex","isSinglePageSearch","isCount","storedData","getStoredData","pageText","characterBounds","documentIndex","pageTextData","PageText","getSearchTextContent","textLayer","characterBound","getPossibleMatches","createRequestForSearch","fireTextSearchComplete","pageString","arrayReturns","searchText","multiSearch","replace","Multiline","specialCharcterSearch","queryLength","toLowerCase","matches","matchedArray","matchIndex","newIndex","multiSearchIndex","MultilineIndex","specialcharcterIndex","indexOf","newString","push","correctLinetext","trim","splice","getSearchPage","indiuvalLineArray","searchArray","split","linestring","searchArrayText","pageNumber","j","ArrayReturns","prevEnd","scrollPoint","y","x","startId","searchingText","isHighlight","addDivForSearch","targetScrollElement","getScrollElement","scrollToSearchStr","element_1","index","nestedIndex","navigation","goToPage","count","initial","divCount","addDivElement","isRTL","X","Y","v","charBound","topDifference","Height","isContinuation","Width","widthDifference","createSearchTextDiv","idString","textDiv","pageDetails","pageSize","calculateBounds","backgroundColor","textSearchColorSettings","searchHighlightColor","bounds","fireTextSearchHighlight","searchColor","rotation","Math","ceil","getZoomFactor","isClassAvailable","isClass","classString","targetElement","childNodes","parent","offsetParent","offsetY","offsetTop","clientTop","offsetX","clientLeft","isDevice","enableDesktopMode","scrollLeft","scrollTop","updateMobileScrollerPosition","resizeSearchElements","searchDivs","querySelectorAll","previousZoomFactor","magnificationModule","outputdata","getAttribute","parseFloat","highlightOtherOccurrences","isSearched","indexes","getIndexes","lowerPageValue","toString","higherPageValue","searchTextDivs","removeChild","applyTextSelection","textSelectionModule","isTextSelectionDisabled","applySelectionRangeOnScroll","resetTextSearch","clear","proxy","viewPortWidth","viewPortHeight","pageWidth","pageHeight","tileCount","getTileCount","noTileX","noTileY","isTileRendering","tileSettings","tileRenderingSettings","enableTileRendering","_loop_1","_loop_2","jsonObject","xCoordinate","yCoordinate","documentId","getDocumentId","hashId","zoomFactor","tilecount","action","elementId","uniqueId","tileXCount","tileYCount","this_1","jsonDocumentId","url","serviceUrl","serverActionSettings","renderPages","responseType","send","onSuccess","result","data","JSON","parse","error","onControlError","fireAjaxRequestSuccess","storeWinData","tileX","tileY","onFailure","fireAjaxRequestFailed","status","statusText","onError","openNotificationPopup","getPDFDocumentTexts","endIndex","createRequestForGetPdfTexts","pageStartIndex","pageEndIndex","renderTexts","concat","orderPdfTextCollections","fireTextExtractionCompleted","oldCollection","annotationCollectionList","Object","keys","button","iconSpan","disabled","isEnable","removeAttribute","inputElement","children","focus","blur","createNotificationPopup","navigationPane","createTooltipMobile","searchNext","searchPrevious","cancelTextSearch","destroy","getModuleName"],"sources":["/home/morgan/Desktop/Projets/ENT4/Jwt-Auth-pdf/react-jwt-auth/react-jwt-auth/node_modules/@syncfusion/ej2-pdfviewer/src/pdfviewer/text-search/text-search.js"],"sourcesContent":["/* eslint-disable */\nimport { createElement, Browser, isNullOrUndefined, isBlazor } from '@syncfusion/ej2-base';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { AjaxHandler } from '../index';\nimport { createSpinner, showSpinner, hideSpinner } from '../index';\n/**\n * TextSearch module\n */\nvar TextSearch = /** @class */ (function () {\n    /**\n     * @param pdfViewer\n     * @param pdfViewerBase\n     * @param pdfViewer\n     * @param pdfViewerBase\n     * @private\n     */\n    function TextSearch(pdfViewer, pdfViewerBase) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.isTextSearch = false;\n        /**\n         * @private\n         */\n        this.searchCount = 0;\n        this.searchIndex = 0;\n        this.currentSearchIndex = 0;\n        this.startIndex = null;\n        this.searchPageIndex = null;\n        this.searchString = null;\n        this.isMatchCase = false;\n        this.searchRequestHandler = null;\n        // eslint-disable-next-line\n        this.textContents = new Array();\n        // eslint-disable-next-line\n        this.searchMatches = new Array();\n        // eslint-disable-next-line\n        this.searchCollection = new Array();\n        this.searchedPages = [];\n        this.isPrevSearch = false;\n        // eslint-disable-next-line\n        this.tempElementStorage = new Array();\n        /**\n         * @private\n         */\n        this.isMessagePopupOpened = false;\n        /**\n         * @private\n         */\n        this.isTextRetrieved = false;\n        this.isTextSearched = false;\n        this.isTextSearchEventTriggered = false;\n        this.isSearchText = false;\n        // eslint-disable-next-line\n        this.checkBoxOnChange = function (event) {\n            if (isBlazor()) {\n                if (event.currentTarget && event.currentTarget.checked) {\n                    _this.isMatchCase = true;\n                }\n                else {\n                    _this.isMatchCase = false;\n                }\n            }\n            else {\n                if (event.checked) {\n                    _this.isMatchCase = true;\n                }\n                else {\n                    _this.isMatchCase = false;\n                }\n            }\n            if (_this.isTextSearch) {\n                _this.resetVariables();\n                _this.clearAllOccurrences();\n                var inputString = _this.searchInput.value;\n                _this.searchIndex = 0;\n                _this.textSearch(inputString);\n            }\n        };\n        this.searchKeypressHandler = function (event) {\n            _this.enableNextButton(true);\n            _this.enablePrevButton(true);\n            if (event.which === 13) {\n                _this.initiateTextSearch(_this.searchInput);\n                _this.updateSearchInputIcon(false);\n            }\n            else {\n                _this.resetVariables();\n            }\n        };\n        this.searchClickHandler = function (event) {\n            _this.searchButtonClick(_this.searchBtn, _this.searchInput);\n        };\n        this.nextButtonOnClick = function (event) {\n            _this.nextSearch();\n        };\n        this.prevButtonOnClick = function (event) {\n            _this.prevSearch();\n        };\n        this.pdfViewer = pdfViewer;\n        this.pdfViewerBase = pdfViewerBase;\n    }\n    /**\n     * @private\n     */\n    TextSearch.prototype.createTextSearchBox = function () {\n        var _this = this;\n        // eslint-disable-next-line max-len\n        this.searchBox = createElement('div', { id: this.pdfViewer.element.id + '_search_box', className: 'e-pv-search-bar' });\n        var toolbarElement;\n        if (isBlazor()) {\n            toolbarElement = document.getElementById('toolbarContainer');\n        }\n        else {\n            toolbarElement = this.pdfViewerBase.getElement('_toolbarContainer');\n        }\n        if (toolbarElement) {\n            if (isBlazor()) {\n                this.searchBox.style.top = toolbarElement.clientHeight + 'px';\n            }\n            else {\n                this.searchBox.style.top = toolbarElement.clientHeight + 'px';\n            }\n        }\n        var searchElementsContainer = createElement('div', { id: this.pdfViewer.element.id + '_search_box_elements', className: 'e-pv-search-bar-elements' });\n        // eslint-disable-next-line max-len\n        var searchInputContainer = createElement('div', { id: this.pdfViewer.element.id + '_search_input_container', className: 'e-input-group e-pv-search-input' });\n        this.searchInput = createElement('input', { id: this.pdfViewer.element.id + '_search_input', className: 'e-input' });\n        this.searchInput.type = 'text';\n        if (isBlazor()) {\n            var promise = this.pdfViewer._dotnetInstance.invokeMethodAsync('GetLocaleText', 'PdfViewer_Findindocument');\n            promise.then(function (value) {\n                _this.searchInput.placeholder = value;\n            });\n        }\n        else {\n            this.searchInput.placeholder = this.pdfViewer.localeObj.getConstant('Find in document');\n        }\n        // eslint-disable-next-line max-len\n        this.searchBtn = createElement('span', { id: this.pdfViewer.element.id + '_search_box-icon', className: 'e-input-group-icon e-input-search-group-icon e-pv-search-icon' });\n        searchInputContainer.appendChild(this.searchInput);\n        searchInputContainer.appendChild(this.searchBtn);\n        searchElementsContainer.appendChild(searchInputContainer);\n        if (this.pdfViewer.enableRtl) {\n            this.prevSearchBtn = this.createSearchBoxButtons('prev_occurrence', 'e-pv-next-search');\n        }\n        else {\n            this.prevSearchBtn = this.createSearchBoxButtons('prev_occurrence', 'e-pv-prev-search');\n        }\n        this.prevSearchBtn.setAttribute('aria-label', 'Previous Search text');\n        searchElementsContainer.appendChild(this.prevSearchBtn);\n        if (this.pdfViewer.enableRtl) {\n            this.nextSearchBtn = this.createSearchBoxButtons('next_occurrence', 'e-pv-prev-search');\n        }\n        else {\n            this.nextSearchBtn = this.createSearchBoxButtons('next_occurrence', 'e-pv-next-search');\n        }\n        this.nextSearchBtn.setAttribute('aria-label', 'Next Search text');\n        searchElementsContainer.appendChild(this.nextSearchBtn);\n        // eslint-disable-next-line max-len\n        var matchCaseContainer = createElement('div', { id: this.pdfViewer.element.id + '_match_case_container', className: 'e-pv-match-case-container' });\n        var matchCaseInput = createElement('input', { id: this.pdfViewer.element.id + '_match_case' });\n        matchCaseInput.type = 'checkbox';\n        if (isBlazor()) {\n            matchCaseInput.style.height = '17px';\n            matchCaseInput.style.width = '17px';\n            matchCaseInput.addEventListener('change', this.checkBoxOnChange.bind(this));\n        }\n        matchCaseContainer.appendChild(matchCaseInput);\n        this.searchBox.appendChild(searchElementsContainer);\n        this.searchBox.appendChild(matchCaseContainer);\n        this.pdfViewerBase.mainContainer.appendChild(this.searchBox);\n        if (isBlazor()) {\n            // eslint-disable-next-line max-len\n            var matchCaseText_1 = createElement('span', { id: this.pdfViewer.element.id + '_search_box_text', styles: 'position: absolute; padding-top: 3px; padding-left: 8px; padding-right: 8px; font-size: 13px' });\n            var promise = this.pdfViewer._dotnetInstance.invokeMethodAsync('GetLocaleText', 'PdfViewer_Matchcase');\n            promise.then(function (value) {\n                matchCaseText_1.textContent = value;\n            });\n            matchCaseContainer.appendChild(matchCaseText_1);\n        }\n        else {\n            // eslint-disable-next-line max-len\n            var checkBox = new CheckBox({ cssClass: 'e-pv-match-case', label: this.pdfViewer.localeObj.getConstant('Match case'), change: this.checkBoxOnChange.bind(this) });\n            checkBox.appendTo(matchCaseInput);\n        }\n        var waitingPopup = createElement('div', { id: this.pdfViewer.element.id + '_textSearchLoadingIndicator' });\n        searchInputContainer.appendChild(waitingPopup);\n        waitingPopup.style.position = 'absolute';\n        waitingPopup.style.top = '15px';\n        waitingPopup.style.left = searchInputContainer.clientWidth - 46 + 'px';\n        createSpinner({ target: waitingPopup, cssClass: 'e-spin-center' });\n        this.setLoaderProperties(waitingPopup);\n        this.showSearchBox(false);\n        if (this.pdfViewer.enableRtl) {\n            this.searchBox.classList.add('e-rtl');\n            this.searchBox.style.left = '88.3px';\n        }\n        else {\n            this.searchBox.classList.remove('e-rtl');\n            this.searchBox.style.right = '88.3px';\n        }\n        this.searchInput.addEventListener('focus', function () {\n            _this.searchInput.parentElement.classList.add('e-input-focus');\n        });\n        this.searchInput.addEventListener('blur', function () {\n            _this.searchInput.parentElement.classList.remove('e-input-focus');\n        });\n        this.searchInput.addEventListener('keydown', this.searchKeypressHandler.bind(this));\n        this.searchBtn.addEventListener('click', this.searchClickHandler.bind(this));\n        this.nextSearchBtn.addEventListener('click', this.nextButtonOnClick.bind(this));\n        this.prevSearchBtn.addEventListener('click', this.prevButtonOnClick.bind(this));\n    };\n    TextSearch.prototype.setLoaderProperties = function (element) {\n        var spinnerElement = element.firstChild.firstChild.firstChild;\n        if (spinnerElement) {\n            spinnerElement.style.height = '18px';\n            spinnerElement.style.width = '18px';\n            spinnerElement.style.transformOrigin = '9px 9px 9px';\n        }\n    };\n    TextSearch.prototype.showLoadingIndicator = function (isShow) {\n        var waitingPopup = document.getElementById(this.pdfViewer.element.id + '_textSearchLoadingIndicator');\n        if (waitingPopup) {\n            if (isShow) {\n                showSpinner(waitingPopup);\n            }\n            else {\n                hideSpinner(waitingPopup);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TextSearch.prototype.textSearchBoxOnResize = function () {\n        if (this.pdfViewer.toolbarModule && this.pdfViewer.enableToolbar) {\n            var secondaryToolbar = this.pdfViewerBase.getElement('_toolbarContainer_popup');\n            if (secondaryToolbar) {\n                if (secondaryToolbar.contains(this.pdfViewerBase.getElement('_search').parentElement)) {\n                    this.searchBox.style.right = '0px';\n                }\n            }\n        }\n        else {\n            // eslint-disable-next-line max-len\n            if (this.pdfViewerBase.viewerContainer.clientWidth + this.pdfViewerBase.viewerContainer.offsetLeft < this.searchBox.offsetLeft + this.searchBox.clientWidth) {\n                this.searchBox.style.right = '0px';\n                // eslint-disable-next-line\n                this.searchBox.style.width = parseInt(this.searchBox.style.width) - ((this.searchBox.offsetLeft + this.searchBox.clientWidth) - (this.pdfViewerBase.viewerContainer.clientWidth)) + 'px';\n                // eslint-disable-next-line\n                this.searchInput.style.width = parseInt(this.searchInput.style.width) - ((this.searchBox.offsetLeft + this.searchBox.clientWidth) - (this.pdfViewerBase.viewerContainer.clientWidth)) + 'px';\n            }\n            else {\n                this.searchBox.style.right = '88.3px';\n                this.searchBox.style.width = '';\n                this.searchInput.style.width = '';\n            }\n        }\n    };\n    /**\n     * @param isShow\n     * @private\n     */\n    TextSearch.prototype.showSearchBox = function (isShow) {\n        if (isShow) {\n            this.searchBox.style.display = 'block';\n        }\n        else {\n            this.searchBox.style.display = 'none';\n            this.searchInput.value = '';\n        }\n        this.onTextSearchClose();\n    };\n    /**\n     * @private\n     */\n    TextSearch.prototype.searchAfterSelection = function () {\n        if (this.isTextSearch) {\n            this.initSearch(this.searchPageIndex, true);\n            this.highlightOthers();\n        }\n    };\n    TextSearch.prototype.initiateTextSearch = function (searchElement) {\n        var inputString = searchElement.value;\n        if (inputString && inputString.length > 0 && inputString[inputString.length - 1] === ' ') {\n            inputString = inputString.slice(0, inputString.length - 1);\n        }\n        this.initiateSearch(inputString);\n    };\n    /**\n     * @param inputString\n     * @private\n     */\n    TextSearch.prototype.initiateSearch = function (inputString) {\n        if (inputString !== this.searchString) {\n            this.isTextSearch = false;\n            this.searchPageIndex = this.pdfViewerBase.currentPageNumber - 1;\n        }\n        this.clearAllOccurrences();\n        if (inputString !== '') {\n            // eslint-disable-next-line\n            if (this.searchMatches[this.searchPageIndex] && inputString === this.searchString) {\n                if (this.searchMatches[this.searchPageIndex].length === 0) {\n                    this.initSearch(this.searchPageIndex, false);\n                }\n                else {\n                    this.nextSearch();\n                }\n            }\n            else {\n                this.resetVariables();\n                this.searchIndex = 0;\n                this.textSearch(inputString);\n            }\n        }\n    };\n    TextSearch.prototype.textSearch = function (inputString) {\n        if (inputString !== '' || inputString) {\n            this.searchString = inputString;\n            this.isTextSearch = true;\n            this.isSearchText = true;\n            this.searchPageIndex = this.pdfViewerBase.currentPageNumber - 1;\n            this.searchCount = 0;\n            this.isTextSearchEventTriggered = false;\n            this.showLoadingIndicator(true);\n            this.pdfViewer.fireTextSearchStart(inputString, this.isMatchCase);\n            if (this.pdfViewer.isExtractText) {\n                if (this.isTextRetrieved) {\n                    for (var i = 0; i < this.pdfViewerBase.pageCount; i++) {\n                        this.initSearch(i, false, true);\n                    }\n                }\n                else {\n                    this.isTextSearched = true;\n                    for (var i = 0; i < this.documentTextCollection.length; i++) {\n                        this.initSearch(i, false, true);\n                    }\n                }\n            }\n            this.initSearch(this.searchPageIndex, false);\n            this.highlightOthers();\n        }\n    };\n    TextSearch.prototype.nextSearch = function () {\n        this.isPrevSearch = false;\n        this.isTextSearch = true;\n        this.isSearchText = false;\n        if (this.searchString) {\n            this.clearAllOccurrences();\n            this.searchIndex = this.searchIndex + 1;\n            if (this.searchMatches[this.searchPageIndex]) {\n                // eslint-disable-next-line max-len\n                if (this.searchIndex >= this.searchMatches[this.searchPageIndex].length) {\n                    this.searchIndex = 0;\n                    this.searchPageIndex = ((this.searchPageIndex + 1) < this.pdfViewerBase.pageCount) ? (this.searchPageIndex + 1) : 0;\n                    if (this.pdfViewerBase.pageCount > 1) {\n                        this.initSearch(this.searchPageIndex, false);\n                    }\n                    else {\n                        this.initSearch(this.searchPageIndex, true);\n                        if (!this.isMessagePopupOpened) {\n                            this.onMessageBoxOpen();\n                        }\n                        this.pdfViewerBase.updateScrollTop(this.searchPageIndex);\n                    }\n                    this.showLoadingIndicator(true);\n                }\n                else {\n                    this.highlightSearchedTexts(this.searchPageIndex, false, undefined);\n                    this.showLoadingIndicator(false);\n                }\n                this.highlightOthers(true);\n            }\n            else {\n                this.initiateTextSearch(this.searchInput);\n            }\n        }\n        else {\n            this.initiateTextSearch(this.searchInput);\n        }\n    };\n    TextSearch.prototype.prevSearch = function () {\n        this.isPrevSearch = true;\n        this.isTextSearch = true;\n        this.isSearchText = false;\n        if (this.searchString) {\n            this.clearAllOccurrences();\n            this.searchIndex = this.searchIndex - 1;\n            if (this.searchIndex < 0) {\n                this.searchPageIndex = ((this.searchPageIndex - 1) < 0) ? (this.pdfViewerBase.pageCount - 1) : this.searchPageIndex - 1;\n                this.initSearch(this.searchPageIndex, false);\n                this.showLoadingIndicator(true);\n            }\n            else {\n                this.highlightSearchedTexts(this.searchPageIndex, false, undefined);\n                this.showLoadingIndicator(false);\n            }\n            this.highlightOthers(true);\n        }\n        else {\n            this.searchIndex = this.searchIndex - 1;\n            this.searchPageIndex = ((this.searchPageIndex - 1) < 0) ? (this.pdfViewerBase.pageCount - 1) : this.searchPageIndex - 1;\n            var inputString = this.searchInput.value;\n            this.textSearch(inputString);\n        }\n    };\n    TextSearch.prototype.initSearch = function (pageIndex, isSinglePageSearch, isCount) {\n        // eslint-disable-next-line\n        var storedData = this.pdfViewerBase.getStoredData(pageIndex, true);\n        var pageText = null;\n        var textContents = null;\n        // eslint-disable-next-line\n        var characterBounds = null;\n        if (isCount) {\n            if (this.documentTextCollection.length !== 0) {\n                // eslint-disable-next-line\n                var documentIndex = this.documentTextCollection[pageIndex][pageIndex];\n                var pageTextData = documentIndex.pageText ? documentIndex.pageText : documentIndex.PageText;\n                if (this.documentTextCollection[pageIndex] && documentIndex) {\n                    // eslint-disable-next-line max-len\n                    this.getSearchTextContent(pageIndex, this.searchString, pageTextData, textContents, isSinglePageSearch, this.documentTextCollection[pageIndex]);\n                }\n            }\n        }\n        else {\n            if (storedData) {\n                // eslint-disable-next-line\n                pageText = storedData['pageText'];\n                // eslint-disable-next-line\n                textContents = storedData['textContent'];\n                characterBounds = this.pdfViewerBase.textLayer.characterBound[pageIndex];\n                this.textContents[pageIndex] = textContents;\n                this.getPossibleMatches(pageIndex, this.searchString, pageText, textContents, isSinglePageSearch, characterBounds);\n            }\n            else {\n                if (!isSinglePageSearch) {\n                    this.createRequestForSearch(pageIndex);\n                }\n            }\n        }\n        if (this.pdfViewerBase.pageCount === (this.searchedPages && this.searchedPages.length)) {\n            if (!this.isTextSearchEventTriggered) {\n                this.isTextSearchEventTriggered = true;\n                this.pdfViewer.fireTextSearchComplete(this.searchString, this.isMatchCase);\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextSearch.prototype.getPossibleMatches = function (pageIndex, searchString, pageString, textContents, isSinglePageSearch, characterBounds) {\n        var arrayReturns;\n        if (this.searchMatches && !this.searchMatches[pageIndex]) {\n            var pageText = pageString;\n            var searchText = searchString;\n            var multiSearch = (pageText.replace((/(\\s\\r\\n)/gm), ' ')).replace((/(\\r\\n)/gm), \" \");\n            var Multiline = (pageString.replace((/(\\s\\r\\n)/gm), '  ')).replace((/(\\r\\n)/gm), \" \");\n            var specialCharcterSearch = multiSearch.replace(/[^a-zA-z0-9\" \"]/g, \"\");\n            var queryLength = searchString.length;\n            if (!this.isMatchCase) {\n                searchText = searchString.toLowerCase();\n                pageText = pageString.toLowerCase();\n                multiSearch = multiSearch.toLowerCase();\n                Multiline = Multiline.toLowerCase();\n                specialCharcterSearch = specialCharcterSearch.toLowerCase();\n            }\n            var matches = [];\n            var matchedArray = [];\n            var matchIndex = -queryLength;\n            var newIndex = -queryLength;\n            var multiSearchIndex = -queryLength;\n            var MultilineIndex = -queryLength;\n            var specialcharcterIndex = -queryLength;\n            while (matchIndex !== 0 || matchIndex === 0) {\n                if (searchText === '' || searchText === ' ' || !searchText) {\n                    break;\n                }\n                matchIndex = pageText.indexOf(searchText, matchIndex + queryLength);\n                if (searchText.indexOf(' ') !== -1) {\n                    var newString = searchString.replace(' ', '\\r\\n');\n                    newIndex = pageText.indexOf(newString, newIndex + queryLength);\n                    newIndex = -1;\n                    if (!(newIndex <= -1)) {\n                        if (newIndex < matchIndex) {\n                            matches.push(newIndex);\n                        }\n                    }\n                }\n                if (matchIndex <= -1 && newIndex <= -1) {\n                    break;\n                }\n                if (!(matchIndex <= -1)) {\n                    matches.push(matchIndex);\n                }\n                if (newIndex > matchIndex && !(newIndex <= -1)) {\n                    matches.push(newIndex);\n                }\n            }\n            if (matches.length == 0) {\n                multiSearchIndex = multiSearch.indexOf(searchText, multiSearchIndex + queryLength);\n                MultilineIndex = Multiline.indexOf(searchText, MultilineIndex + queryLength);\n                specialcharcterIndex = specialCharcterSearch.indexOf(searchText, specialcharcterIndex + queryLength);\n                if (multiSearchIndex !== -1) {\n                    arrayReturns = this.correctLinetext(searchString, matchIndex, pageText);\n                    matchIndex = -arrayReturns[0].length;\n                    for (var i = 0; i < arrayReturns.length; i++) {\n                        matchIndex = pageText.indexOf(arrayReturns[i].trim(), matchIndex + (arrayReturns[i - 1] === undefined || null ? arrayReturns[0].length : arrayReturns[i - 1].length));\n                        matchedArray.push(matchIndex);\n                        if (matchedArray.length > 1) {\n                            if ((matchedArray[1] - (matchedArray[0] + arrayReturns[0].length)) <= 3) {\n                                matches.push(matchedArray);\n                                this.searchMatches[pageIndex] = matches;\n                            }\n                            else {\n                                i = -1;\n                                matchIndex = matchedArray[0] + arrayReturns[0].length;\n                                matchedArray.splice(0, matchedArray.length);\n                            }\n                        }\n                    }\n                }\n                else if (specialcharcterIndex !== -1) {\n                    arrayReturns = this.correctLinetext(searchString, matchIndex, pageText);\n                    matchIndex = -arrayReturns[0].length;\n                    for (var i = 0; i < arrayReturns.length; i++) {\n                        matchIndex = pageText.indexOf(arrayReturns[i].trim(), matchIndex + (arrayReturns[i - 1] === undefined || null ? arrayReturns[0].length : arrayReturns[i - 1].length));\n                        matchedArray.push(matchIndex);\n                        if (matchedArray.length > 1) {\n                            if ((matchedArray[1] - (matchedArray[0] + arrayReturns[0].length)) <= 3) {\n                                matches.push(matchedArray);\n                                this.searchMatches[pageIndex] = matches;\n                            }\n                            else {\n                                i = -1;\n                                matchIndex = matchedArray[0] + arrayReturns[0].length;\n                                matchedArray.splice(0, matchedArray.length);\n                            }\n                        }\n                    }\n                }\n                else if (MultilineIndex !== -1) {\n                    arrayReturns = this.correctLinetext(searchString, matchIndex, pageText);\n                    matchIndex = -arrayReturns[0].length;\n                    for (var i = 0; i < arrayReturns.length; i++) {\n                        matchIndex = pageText.indexOf(arrayReturns[i].trim(), matchIndex + (arrayReturns[i - 1] === undefined || null ? arrayReturns[0].length : arrayReturns[i - 1].length));\n                        matchedArray.push(matchIndex);\n                        if (matchedArray.length > 1) {\n                            if ((matchedArray[1] - (matchedArray[0] + arrayReturns[0].length)) <= 3) {\n                                matches.push(matchedArray);\n                                this.searchMatches[pageIndex] = matches;\n                            }\n                            else {\n                                i = -1;\n                                matchIndex = matchedArray[0] + arrayReturns[0].length;\n                                matchedArray.splice(0, matchedArray.length);\n                            }\n                        }\n                    }\n                }\n                if (matches.length > 1) {\n                    matches.splice(1, matches.length);\n                }\n            }\n            if (this.searchMatches && matches.length > 0) {\n                this.searchMatches[pageIndex] = matches;\n            }\n        }\n        if (!isSinglePageSearch) {\n            if (this.searchedPages.indexOf(pageIndex) === -1) {\n                this.searchedPages.push(pageIndex);\n                this.startIndex = this.searchedPages[0];\n            }\n            this.updateSearchInputIcon(false);\n        }\n        if (this.searchMatches && this.searchMatches[pageIndex] && this.searchMatches[pageIndex].length !== 0) {\n            if (!isSinglePageSearch) {\n                if (this.isPrevSearch) {\n                    this.searchIndex = this.searchMatches[pageIndex].length - 1;\n                }\n                if ((this.pdfViewerBase.currentPageNumber - 1) !== this.searchPageIndex) {\n                    // eslint-disable-next-line max-len\n                    if (this.searchMatches.length > 0 && (this.searchIndex === 0 || this.searchIndex === -1) && (this.searchPageIndex) === this.currentSearchIndex) {\n                        if (!this.isMessagePopupOpened && !this.isSearchText) {\n                            this.onMessageBoxOpen();\n                        }\n                        this.searchPageIndex = this.getSearchPage(this.pdfViewerBase.currentPageNumber - 1);\n                        this.searchedPages = [this.searchPageIndex];\n                    }\n                    // eslint-disable-next-line max-len\n                    else if (this.isPrevSearch && this.searchMatches && this.searchMatches.length > 0 && (this.searchMatches[this.searchPageIndex] && this.searchMatches[this.searchPageIndex].length > 0) && this.searchedPages.length === this.pdfViewerBase.pageCount && this.startIndex - 1 === this.searchPageIndex) {\n                        if (!this.isMessagePopupOpened) {\n                            this.onMessageBoxOpen();\n                        }\n                        this.searchedPages = [this.startIndex];\n                    }\n                    this.pdfViewerBase.updateScrollTop(this.searchPageIndex);\n                }\n                else if (this.searchMatches && (this.searchMatches[this.searchPageIndex] && this.searchMatches[this.searchPageIndex].length > 0) && this.searchedPages.length === this.pdfViewerBase.pageCount && this.startIndex === this.searchPageIndex && this.pdfViewerBase.pageCount > 1) {\n                    if (!this.isMessagePopupOpened) {\n                        this.onMessageBoxOpen();\n                    }\n                    this.searchedPages = [this.startIndex];\n                }\n            }\n            this.highlightSearchedTexts(pageIndex, isSinglePageSearch, arrayReturns);\n        }\n        else {\n            if (!isSinglePageSearch) {\n                if (this.isPrevSearch) {\n                    this.searchPageIndex = ((this.searchPageIndex - 1) < 0) ? (this.pdfViewerBase.pageCount - 1) : this.searchPageIndex - 1;\n                }\n                else {\n                    this.searchPageIndex = ((this.searchPageIndex + 1) < this.pdfViewerBase.pageCount) ? (this.searchPageIndex + 1) : 0;\n                }\n                if (this.searchedPages.indexOf(this.searchPageIndex) === -1 && this.searchedPages.length !== this.pdfViewerBase.pageCount) {\n                    this.showLoadingIndicator(true);\n                    this.initSearch(this.searchPageIndex, false);\n                }\n                else {\n                    var searchPageIndex = this.getSearchPage(pageIndex);\n                    // eslint-disable-next-line max-len\n                    if (this.searchMatches && isNullOrUndefined(this.searchMatches[this.searchPageIndex]) && this.searchedPages.length === this.pdfViewerBase.pageCount) {\n                        // eslint-disable-next-line max-len\n                        if (!this.isMessagePopupOpened) {\n                            this.onMessageBoxOpen();\n                        }\n                        this.pdfViewerBase.updateScrollTop(this.startIndex);\n                        // eslint-disable-next-line max-len\n                    }\n                    else if (this.searchMatches && this.searchMatches.length > 0 && (this.searchIndex === 0 || this.searchIndex === -1) && (searchPageIndex) === this.currentSearchIndex) {\n                        if (this.isPrevSearch) {\n                            // eslint-disable-next-line max-len\n                            if (!this.isMessagePopupOpened) {\n                                this.onMessageBoxOpen();\n                            }\n                            this.searchPageIndex = searchPageIndex;\n                            this.searchedPages = [searchPageIndex];\n                            this.searchIndex = -1;\n                        }\n                        else {\n                            if (!this.isMessagePopupOpened && this.pdfViewerBase.currentPageNumber !== 1 && !this.isSearchText) {\n                                this.onMessageBoxOpen();\n                            }\n                            this.searchPageIndex = searchPageIndex;\n                            this.searchedPages = [searchPageIndex];\n                            this.searchIndex = 0;\n                        }\n                        this.highlightSearchedTexts(this.searchPageIndex, isSinglePageSearch, undefined);\n                    }\n                    else if (this.searchMatches && (this.searchMatches[this.searchPageIndex] && this.searchMatches[this.searchPageIndex].length > 0) && this.searchedPages.length === this.pdfViewerBase.pageCount) {\n                        if (!this.isMessagePopupOpened) {\n                            this.onMessageBoxOpen();\n                        }\n                        this.searchPageIndex = this.startIndex;\n                        this.searchedPages = [this.searchPageIndex];\n                        this.searchIndex = 0;\n                        this.pdfViewerBase.updateScrollTop(this.startIndex);\n                        this.highlightSearchedTexts(this.searchPageIndex, isSinglePageSearch, undefined);\n                    }\n                }\n            }\n        }\n    };\n    TextSearch.prototype.correctLinetext = function (searchString, matchIndex, pageText) {\n        var indiuvalLineArray = [];\n        var searchArray = searchString.toLowerCase().split(/[\" \"]+/);\n        matchIndex = 0;\n        var linestring = \"\";\n        for (var i = 0; i < searchArray.length; i++) {\n            var searchArrayText = linestring + searchArray[i];\n            matchIndex = pageText.indexOf(searchArrayText, matchIndex);\n            if (matchIndex !== -1) {\n                linestring += searchArray[i] + \" \";\n                if (i == (searchArray.length - 1)) {\n                    indiuvalLineArray.push(linestring);\n                }\n            }\n            else {\n                indiuvalLineArray.push(linestring);\n                linestring = searchArray[i] + \" \";\n                if (i == (searchArray.length - 1)) {\n                    indiuvalLineArray.push(linestring);\n                }\n            }\n        }\n        return indiuvalLineArray;\n    };\n    // eslint-disable-next-line\n    TextSearch.prototype.getSearchTextContent = function (pageIndex, searchString, pageString, textContents, isSinglePageSearch, characterBounds) {\n        var pageText = pageString;\n        var searchText = searchString;\n        var queryLength = searchString.length;\n        if (!this.isMatchCase) {\n            searchText = searchString.toLowerCase();\n            pageText = pageString.toLowerCase();\n        }\n        var matches = [];\n        var matchIndex = -queryLength;\n        var newIndex = -queryLength;\n        while (matchIndex !== 0) {\n            if (searchText === '' || searchText === ' ' || !searchText) {\n                break;\n            }\n            matchIndex = pageText.indexOf(searchText, matchIndex + queryLength);\n            if (searchText.indexOf(' ') !== -1) {\n                var newString = searchString.replace(' ', '\\r\\n');\n                newIndex = pageText.indexOf(newString, newIndex + queryLength);\n                if (!(newIndex <= -1)) {\n                    if (newIndex < matchIndex) {\n                        matches.push(newIndex);\n                    }\n                }\n            }\n            if (matchIndex <= -1 && newIndex <= -1) {\n                break;\n            }\n            if (!(matchIndex <= -1)) {\n                matches.push(matchIndex);\n            }\n            if (newIndex > matchIndex && !(newIndex <= -1)) {\n                matches.push(newIndex);\n            }\n        }\n        if (matches.length !== 0) {\n            this.searchCount = this.searchCount + matches.length;\n        }\n        this.searchMatches[pageIndex] = matches;\n    };\n    TextSearch.prototype.getSearchPage = function (pageIndex) {\n        var pageNumber = null;\n        if (this.isPrevSearch) {\n            for (var i = pageIndex; i >= 0; i--) {\n                if (i !== pageIndex && this.searchMatches[i]) {\n                    pageNumber = i;\n                    break;\n                }\n            }\n            if (!pageNumber) {\n                for (var j = this.pdfViewerBase.pageCount - 1; j > pageIndex; j--) {\n                    if (this.searchMatches[j]) {\n                        pageNumber = j;\n                        break;\n                    }\n                }\n            }\n        }\n        else {\n            for (var i = pageIndex; i < this.pdfViewerBase.pageCount; i++) {\n                if (i !== pageIndex && this.searchMatches[i]) {\n                    pageNumber = i;\n                    break;\n                }\n            }\n            if (!pageNumber) {\n                if (pageIndex === 0) {\n                    pageNumber = pageIndex;\n                }\n                else {\n                    for (var j = 0; j < pageIndex; j++) {\n                        if (this.searchMatches[j]) {\n                            pageNumber = j;\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n        return pageNumber;\n    };\n    TextSearch.prototype.highlightSearchedTexts = function (pageIndex, isSinglePageSearch, ArrayReturns) {\n        // eslint-disable-next-line\n        var matches = this.searchMatches[pageIndex];\n        var prevEnd = null;\n        // eslint-disable-next-line\n        var scrollPoint = { y: -100, x: -100 };\n        var startId;\n        var className;\n        var searchingText = this.searchString;\n        // eslint-disable-next-line\n        var characterBounds = this.pdfViewerBase.textLayer.characterBound[pageIndex];\n        var isHighlight = false;\n        if (isSinglePageSearch && (this.pdfViewerBase.currentPageNumber - 1) !== this.searchPageIndex) {\n            if (this.searchMatches.length > 0) {\n                if (pageIndex === this.getSearchPage(this.pdfViewerBase.currentPageNumber - 1)) {\n                    isHighlight = true;\n                }\n            }\n        }\n        if (characterBounds) {\n            for (var i = 0; i < matches.length; i++) {\n                if (matches[i].length !== undefined && ArrayReturns !== undefined) {\n                    if (i === this.searchIndex && pageIndex === this.searchPageIndex) {\n                        for (var j = 0; j < ArrayReturns.length; j++) {\n                            className = 'e-pv-search-text-highlight';\n                            this.searchString = ArrayReturns[j].trim();\n                            this.addDivForSearch(i, pageIndex, characterBounds, this.searchString.length, className, j);\n                        }\n                    }\n                    else {\n                        for (var j = 0; j < ArrayReturns.length; j++) {\n                            className = 'e-pv-search-text-highlightother';\n                            this.searchString = ArrayReturns[j].trim();\n                            this.addDivForSearch(i, pageIndex, characterBounds, this.searchString.length, className, j);\n                        }\n                    }\n                }\n                else if (i === this.searchIndex && pageIndex === this.searchPageIndex) {\n                    className = 'e-pv-search-text-highlight';\n                }\n                else {\n                    className = 'e-pv-search-text-highlightother';\n                }\n                if (matches[i].length == undefined) {\n                    this.addDivForSearch(i, pageIndex, characterBounds, this.searchString.length, className, undefined);\n                }\n            }\n            this.searchString = searchingText;\n            if (pageIndex === this.searchPageIndex && !isSinglePageSearch) {\n                var element = this.pdfViewerBase.getElement('_searchtext_' + pageIndex + '_' + this.searchIndex);\n                if (element) {\n                    var targetScrollElement = this.getScrollElement(element);\n                    this.scrollToSearchStr(targetScrollElement, scrollPoint);\n                }\n                else {\n                    this.pdfViewerBase.updateScrollTop(pageIndex);\n                    var element_1 = this.pdfViewerBase.getElement('_searchtext_' + pageIndex + '_' + this.searchIndex);\n                    if (element_1) {\n                        var targetScrollElement = this.getScrollElement(element_1);\n                        this.scrollToSearchStr(targetScrollElement, scrollPoint);\n                    }\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextSearch.prototype.addDivForSearch = function (index, pageIndex, characterBounds, queryLength, className, nestedIndex) {\n        var textLayer = this.pdfViewerBase.getElement('_textLayer_' + pageIndex);\n        if (isNullOrUndefined(textLayer) && className === 'e-pv-search-text-highlight') {\n            if (this.pdfViewer.navigation) {\n                this.pdfViewer.navigation.goToPage(pageIndex + 1);\n            }\n        }\n        var count;\n        if (this.searchMatches[pageIndex][index].length !== undefined) {\n            count = this.searchMatches[pageIndex][index][nestedIndex];\n        }\n        else {\n            count = this.searchMatches[pageIndex][index];\n        }\n        var initial = count;\n        var divCount = 0;\n        while (count < initial + queryLength) {\n            count = this.addDivElement(count, characterBounds, queryLength, className, index, pageIndex, initial, divCount, nestedIndex);\n            divCount++;\n        }\n        if (className === 'e-pv-search-text-highlight') {\n            this.showLoadingIndicator(false);\n        }\n    };\n    // eslint-disable-next-line\n    TextSearch.prototype.addDivElement = function (count, characterBounds, queryLength, className, index, pageIndex, initial, divCount, nestedIndex) {\n        var height = 0;\n        var width = 0;\n        var top = 0;\n        var left = 0;\n        var isRTL = false;\n        if (characterBounds[count]) {\n            left = characterBounds[count].X;\n            top = characterBounds[count].Y;\n        }\n        var v = 0;\n        if ((count - initial) !== 0) {\n            v = count - initial;\n            queryLength += 1;\n        }\n        for (v = v; v < queryLength; v++) {\n            if (characterBounds[count]) {\n                // eslint-disable-next-line\n                var charBound = characterBounds[count];\n                if (left > charBound.X) {\n                    isRTL = true;\n                }\n                top = (top < charBound.Y) ? top : charBound.Y;\n                var topDifference = (top < charBound.Y) ? (charBound.Y - top) : (top - charBound.Y);\n                height = (height > (topDifference + charBound.Height)) ? height : (topDifference + charBound.Height);\n                count++;\n            }\n        }\n        var isContinuation = false;\n        if (!isRTL) {\n            if (initial + queryLength !== count) {\n                isContinuation = true;\n                if (characterBounds[count - 1]) {\n                    width = (characterBounds[count - 1].X - left);\n                }\n            }\n            else {\n                isContinuation = false;\n                // eslint-disable-next-line\n                var storedData = this.pdfViewerBase.getStoredData(pageIndex, true);\n                var pageText = null;\n                if (storedData) {\n                    pageText = storedData['pageText'];\n                }\n                else if (this.pdfViewer.isExtractText && this.documentTextCollection.length !== 0) {\n                    // eslint-disable-next-line\n                    var documentIndex = this.documentTextCollection[pageIndex][pageIndex];\n                    pageText = documentIndex.pageText ? documentIndex.pageText : documentIndex.PageText;\n                }\n                if (characterBounds[count]) {\n                    if (pageText && (pageText[count] === '' || pageText[count] === ' ' || pageText[count] === '\\r' || pageText[count] === '\\n') && (characterBounds[count].Width) === 0) {\n                        width = (characterBounds[count - 1].X - left) + characterBounds[count - 1].Width;\n                    }\n                    else {\n                        width = (characterBounds[count].X - left);\n                    }\n                }\n                else {\n                    if (characterBounds[count - 1]) {\n                        width = (characterBounds[count - 1].X - left);\n                    }\n                }\n            }\n        }\n        else {\n            var charBound = characterBounds[(initial + queryLength) - 1];\n            left = charBound.X;\n            width = characterBounds[initial].X - characterBounds[(initial + queryLength) - 1].X;\n            top = (top < charBound.Y) ? top : charBound.Y;\n            var topDifference = (top < charBound.Y) ? (charBound.Y - top) : (top - charBound.Y);\n            height = (height > (topDifference + charBound.Height)) ? height : (topDifference + charBound.Height);\n            //some RTL character calculated width is zero and width difference value calculated from Y possition difference in the same line.\n            var widthDifference = characterBounds[initial - 1].Y - characterBounds[initial].Y;\n            for (var j = (initial + queryLength) - 1; j >= initial; j--) {\n                charBound = characterBounds[j];\n                if (charBound.Width === 0) {\n                    widthDifference = charBound.Y - characterBounds[j - 1].Y;\n                }\n            }\n            width = width + widthDifference;\n        }\n        this.createSearchTextDiv(index, pageIndex, height, width, top, left, className, isContinuation, divCount, nestedIndex);\n        return count;\n    };\n    // eslint-disable-next-line\n    TextSearch.prototype.createSearchTextDiv = function (index, pageIndex, height, width, top, left, className, isContinuation, divCount, nestedIndex) {\n        var idString = '_searchtext_' + pageIndex + '_' + index;\n        if (isContinuation) {\n            idString += '_' + divCount;\n        }\n        if (nestedIndex !== undefined && this.pdfViewerBase.getElement(idString)) {\n            var textDiv = createElement('div', { id: this.pdfViewer.element.id + idString + \"_\" + nestedIndex });\n            // eslint-disable-next-line\n            var pageDetails = this.pdfViewerBase.pageSize[pageIndex];\n            this.calculateBounds(textDiv, height, width, top, left, pageDetails);\n            textDiv.classList.add(className);\n            if (className === 'e-pv-search-text-highlight') {\n                // eslint-disable-next-line max-len\n                textDiv.style.backgroundColor = (this.pdfViewer.textSearchColorSettings.searchHighlightColor === '') ? '#fdd835' : this.pdfViewer.textSearchColorSettings.searchHighlightColor;\n                var bounds = { left: left, top: top, width: width, height: height };\n                this.pdfViewer.fireTextSearchHighlight(this.searchString, this.isMatchCase, bounds, (pageIndex + 1));\n            }\n            else if (className === 'e-pv-search-text-highlightother') {\n                // eslint-disable-next-line max-len\n                textDiv.style.backgroundColor = (this.pdfViewer.textSearchColorSettings.searchColor === '') ? '#8b4c12' : this.pdfViewer.textSearchColorSettings.searchColor;\n            }\n            var textLayer = this.pdfViewerBase.getElement('_textLayer_' + pageIndex);\n            if (textLayer) {\n                textLayer.appendChild(textDiv);\n            }\n        }\n        if (!this.pdfViewerBase.getElement(idString)) {\n            var textDiv = createElement('div', { id: this.pdfViewer.element.id + idString });\n            // eslint-disable-next-line\n            var pageDetails = this.pdfViewerBase.pageSize[pageIndex];\n            this.calculateBounds(textDiv, height, width, top, left, pageDetails);\n            textDiv.classList.add(className);\n            if (className === 'e-pv-search-text-highlight') {\n                // eslint-disable-next-line max-len\n                textDiv.style.backgroundColor = (this.pdfViewer.textSearchColorSettings.searchHighlightColor === '') ? '#fdd835' : this.pdfViewer.textSearchColorSettings.searchHighlightColor;\n                var bounds = { left: left, top: top, width: width, height: height };\n                this.pdfViewer.fireTextSearchHighlight(this.searchString, this.isMatchCase, bounds, (pageIndex + 1));\n            }\n            else if (className === 'e-pv-search-text-highlightother') {\n                // eslint-disable-next-line max-len\n                textDiv.style.backgroundColor = (this.pdfViewer.textSearchColorSettings.searchColor === '') ? '#8b4c12' : this.pdfViewer.textSearchColorSettings.searchColor;\n            }\n            var textLayer = this.pdfViewerBase.getElement('_textLayer_' + pageIndex);\n            if (textLayer) {\n                textLayer.appendChild(textDiv);\n            }\n        }\n    };\n    // eslint-disable-next-line\n    TextSearch.prototype.calculateBounds = function (textDiv, height, width, top, left, pageDetails) {\n        if (pageDetails.rotation === 0 || pageDetails.rotation === 2) {\n            textDiv.style.height = Math.ceil(height) * this.pdfViewerBase.getZoomFactor() + 'px';\n            textDiv.style.width = width * this.pdfViewerBase.getZoomFactor() + 'px';\n            if (pageDetails.rotation === 2) {\n                textDiv.style.top = (pageDetails.height - top - height) * this.pdfViewerBase.getZoomFactor() + 'px';\n                textDiv.style.left = Math.ceil(pageDetails.width - left - width) * this.pdfViewerBase.getZoomFactor() + 'px';\n            }\n            else {\n                textDiv.style.top = top * this.pdfViewerBase.getZoomFactor() + 'px';\n                textDiv.style.left = left * this.pdfViewerBase.getZoomFactor() + 'px';\n            }\n        }\n        else if (pageDetails.rotation === 1) {\n            textDiv.style.height = width * this.pdfViewerBase.getZoomFactor() + 'px';\n            textDiv.style.width = height * this.pdfViewerBase.getZoomFactor() + 'px';\n            textDiv.style.top = left * this.pdfViewerBase.getZoomFactor() + 'px';\n            textDiv.style.left = (pageDetails.height - top - height) * this.pdfViewerBase.getZoomFactor() + 'px';\n        }\n        else if (pageDetails.rotation === 3) {\n            textDiv.style.height = width * this.pdfViewerBase.getZoomFactor() + 'px';\n            textDiv.style.width = height * this.pdfViewerBase.getZoomFactor() + 'px';\n            textDiv.style.left = ((pageDetails.width - pageDetails.height) + top) * this.pdfViewerBase.getZoomFactor() + 'px';\n            textDiv.style.top = (pageDetails.height - left - width) * this.pdfViewerBase.getZoomFactor() + 'px';\n        }\n    };\n    TextSearch.prototype.isClassAvailable = function () {\n        var isClass = false;\n        for (var j = 0; j < this.tempElementStorage.length; j++) {\n            if (this.tempElementStorage[j].classString) {\n                // eslint-disable-next-line max-len\n                if (this.tempElementStorage[j].classString === 'e-pv-search-text-highlight' || this.tempElementStorage[j].classString === 'e-pv-search-text-highlightother') {\n                    isClass = true;\n                    break;\n                }\n            }\n        }\n        return isClass;\n    };\n    TextSearch.prototype.getScrollElement = function (element) {\n        var targetElement = element;\n        if (element.childNodes.length > 0) {\n            for (var i = 0; i < element.childNodes.length; i++) {\n                if (element.childNodes[i].classList) {\n                    if (element.childNodes[i].classList.contains('e-pv-search-text-highlight')) {\n                        targetElement = element.childNodes[i];\n                    }\n                }\n            }\n        }\n        return targetElement;\n    };\n    // eslint-disable-next-line\n    TextSearch.prototype.scrollToSearchStr = function (element, scrollPoint) {\n        var parent = element.offsetParent;\n        var offsetY = element.offsetTop + element.clientTop;\n        var offsetX = element.offsetLeft + element.clientLeft;\n        while (parent.id !== this.pdfViewerBase.viewerContainer.id) {\n            offsetY += parent.offsetTop;\n            offsetX += parent.offsetLeft;\n            parent = parent.offsetParent;\n        }\n        if (scrollPoint) {\n            offsetY += scrollPoint.y;\n            offsetX += scrollPoint.x;\n            if (Browser.isDevice && !this.pdfViewer.enableDesktopMode) {\n                parent.scrollLeft = offsetX;\n            }\n            else {\n                if (this.pdfViewerBase.getZoomFactor() > 1.5) {\n                    parent.scrollLeft = offsetX;\n                }\n            }\n        }\n        parent.scrollTop = offsetY;\n        this.pdfViewerBase.updateMobileScrollerPosition();\n    };\n    /**\n     * @param pageIndex\n     * @private\n     */\n    TextSearch.prototype.resizeSearchElements = function (pageIndex) {\n        var searchDivs = document.querySelectorAll('div[id*=\"' + this.pdfViewer.element.id + '_searchtext_' + pageIndex + '\"]');\n        for (var i = 0; i < searchDivs.length; i++) {\n            var textDiv = searchDivs[i];\n            var previousZoomFactor = 1;\n            if (this.pdfViewer.magnificationModule) {\n                previousZoomFactor = this.pdfViewer.magnificationModule.previousZoomFactor;\n            }\n            // eslint-disable-next-line max-len\n            var outputdata = pageIndex + '_' + previousZoomFactor + '_' + this.pdfViewerBase.getZoomFactor();\n            if (textDiv.getAttribute('name') !== outputdata) {\n                // eslint-disable-next-line\n                textDiv.style.width = (parseFloat(textDiv.style.width) / previousZoomFactor) * this.pdfViewerBase.getZoomFactor() + 'px';\n                // eslint-disable-next-line\n                textDiv.style.height = (parseFloat(textDiv.style.height) / previousZoomFactor) * this.pdfViewerBase.getZoomFactor() + 'px';\n                // eslint-disable-next-line\n                textDiv.style.top = (parseFloat(textDiv.style.top) / previousZoomFactor) * this.pdfViewerBase.getZoomFactor() + 'px';\n                // eslint-disable-next-line\n                textDiv.style.left = (parseFloat(textDiv.style.left) / previousZoomFactor) * this.pdfViewerBase.getZoomFactor() + 'px';\n                textDiv.setAttribute('name', outputdata);\n            }\n        }\n    };\n    /**\n     * @param pageNumber\n     * @private\n     */\n    TextSearch.prototype.highlightOtherOccurrences = function (pageNumber) {\n        this.initSearch(pageNumber, true);\n    };\n    TextSearch.prototype.highlightOthers = function (isSearched) {\n        var indexes = this.getIndexes();\n        var lowerPageValue = parseFloat(indexes.lowerPageValue.toString());\n        var higherPageValue = parseFloat(indexes.higherPageValue.toString());\n        for (var i = lowerPageValue; i <= higherPageValue; i++) {\n            this.highlightOtherOccurrences(i);\n        }\n        if (isSearched) {\n            this.showLoadingIndicator(false);\n        }\n    };\n    /**\n     * @private\n     */\n    TextSearch.prototype.clearAllOccurrences = function () {\n        var searchTextDivs = document.querySelectorAll('div[id*=\"' + this.pdfViewer.element.id + '_searchtext_\"]');\n        for (var i = 0; i < searchTextDivs.length; i++) {\n            searchTextDivs[i].parentElement.removeChild(searchTextDivs[i]);\n        }\n    };\n    /**\n     * @private\n     */\n    // eslint-disable-next-line\n    TextSearch.prototype.getIndexes = function () {\n        var lowerPageValue = this.pdfViewerBase.currentPageNumber - 3;\n        lowerPageValue = (lowerPageValue > 0) ? lowerPageValue : 0;\n        var higherPageValue = this.pdfViewerBase.currentPageNumber + 1;\n        higherPageValue = (higherPageValue < this.pdfViewerBase.pageCount) ? higherPageValue : (this.pdfViewerBase.pageCount - 1);\n        return { lowerPageValue: lowerPageValue, higherPageValue: higherPageValue };\n    };\n    TextSearch.prototype.applyTextSelection = function () {\n        if (this.pdfViewer.textSelectionModule && !this.pdfViewerBase.isTextSelectionDisabled) {\n            var indexes = this.getIndexes();\n            var lowerPageValue = parseFloat(indexes.lowerPageValue.toString());\n            var higherPageValue = parseFloat(indexes.higherPageValue.toString());\n            for (var i = lowerPageValue; i <= higherPageValue; i++) {\n                this.pdfViewer.textSelectionModule.applySelectionRangeOnScroll(i);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TextSearch.prototype.resetTextSearch = function () {\n        this.resetVariables();\n        this.onTextSearchClose();\n        this.searchPageIndex = null;\n        this.searchIndex = 0;\n        this.updateSearchInputIcon(true);\n        this.enableNextButton(false);\n        this.enablePrevButton(false);\n        this.documentTextCollection = [];\n        this.isTextRetrieved = false;\n        this.isTextSearched = false;\n        this.isSearchText = false;\n        if (this.searchRequestHandler) {\n            this.searchRequestHandler.clear();\n        }\n    };\n    TextSearch.prototype.onTextSearchClose = function () {\n        this.isPrevSearch = false;\n        this.isTextSearch = false;\n        if (this.pdfViewerBase.pageCount > 0) {\n            this.clearAllOccurrences();\n        }\n    };\n    TextSearch.prototype.createRequestForSearch = function (pageIndex) {\n        var proxy = this;\n        var viewPortWidth = 816;\n        var viewPortHeight = this.pdfViewer.element.clientHeight;\n        var pageWidth = this.pdfViewerBase.pageSize[pageIndex].width;\n        var pageHeight = this.pdfViewerBase.pageSize[pageIndex].height;\n        var tileCount = this.pdfViewerBase.getTileCount(pageWidth);\n        var noTileX = viewPortWidth >= pageWidth ? 1 : tileCount;\n        var noTileY = viewPortWidth >= pageWidth ? 1 : tileCount;\n        var isTileRendering = false;\n        var tileSettings = this.pdfViewer.tileRenderingSettings;\n        if (tileSettings.enableTileRendering && tileSettings.x > 0 && tileSettings.y > 0) {\n            noTileX = viewPortWidth >= pageWidth ? 1 : tileSettings.x;\n            noTileY = viewPortWidth >= pageWidth ? 1 : tileSettings.y;\n        }\n        if (noTileX > 1 && noTileY > 1) {\n            isTileRendering = true;\n        }\n        var _loop_1 = function (x) {\n            var _loop_2 = function (y) {\n                var jsonObject = void 0;\n                // eslint-disable-next-line max-len\n                jsonObject = { xCoordinate: x, yCoordinate: y, pageNumber: pageIndex, viewPortWidth: viewPortWidth, viewPortHeight: viewPortHeight, documentId: proxy.pdfViewerBase.getDocumentId(), hashId: proxy.pdfViewerBase.hashId, zoomFactor: proxy.pdfViewerBase.getZoomFactor(), tilecount: tileCount, action: 'Search', elementId: proxy.pdfViewer.element.id, uniqueId: proxy.pdfViewerBase.documentId,\n                    tileXCount: noTileX, tileYCount: noTileY };\n                if (this_1.pdfViewerBase.jsonDocumentId) {\n                    // eslint-disable-next-line\n                    jsonObject.documentId = this_1.pdfViewerBase.jsonDocumentId;\n                }\n                this_1.searchRequestHandler = new AjaxHandler(this_1.pdfViewer);\n                this_1.searchRequestHandler.url = this_1.pdfViewer.serviceUrl + '/' + this_1.pdfViewer.serverActionSettings.renderPages;\n                this_1.searchRequestHandler.responseType = 'json';\n                this_1.searchRequestHandler.send(jsonObject);\n                // eslint-disable-next-line\n                this_1.searchRequestHandler.onSuccess = function (result) {\n                    // eslint-disable-next-line\n                    var data = result.data;\n                    if (data) {\n                        if (typeof data !== 'object') {\n                            try {\n                                data = JSON.parse(data);\n                            }\n                            catch (error) {\n                                proxy.pdfViewerBase.onControlError(500, data, this.pdfViewer.serverActionSettings.renderPages);\n                                data = null;\n                            }\n                        }\n                        if (data) {\n                            if (!isNullOrUndefined(data.pageText) && data.uniqueId === proxy.pdfViewerBase.documentId) {\n                                proxy.pdfViewer.fireAjaxRequestSuccess(this.pdfViewer.serverActionSettings.renderPages, data);\n                                var pageNumber = (data.pageNumber !== undefined) ? data.pageNumber : pageIndex;\n                                if (viewPortWidth >= pageWidth) {\n                                    proxy.pdfViewerBase.storeWinData(data, pageNumber);\n                                }\n                                else {\n                                    proxy.pdfViewerBase.storeWinData(data, pageNumber, data.tileX, data.tileY);\n                                }\n                                if (!isTileRendering) {\n                                    proxy.initSearch(pageIndex, false);\n                                }\n                                else {\n                                    if (x === (noTileX - 1) && y === (noTileY - 1)) {\n                                        proxy.initSearch(pageIndex, false);\n                                    }\n                                }\n                            }\n                            else if (isTileRendering && data.uniqueId === proxy.pdfViewerBase.documentId) {\n                                proxy.pdfViewer.fireAjaxRequestSuccess(this.pdfViewer.serverActionSettings.renderPages, data);\n                                var pageNumber = (data.pageNumber !== undefined) ? data.pageNumber : pageIndex;\n                                proxy.pdfViewerBase.storeWinData(data, pageNumber, data.tileX, data.tileY);\n                                if (x === (noTileX - 1) && y === (noTileY - 1)) {\n                                    proxy.initSearch(pageIndex, false);\n                                }\n                            }\n                        }\n                    }\n                };\n                // eslint-disable-next-line\n                this_1.searchRequestHandler.onFailure = function (result) {\n                    proxy.pdfViewer.fireAjaxRequestFailed(result.status, result.statusText, this.pdfViewer.serverActionSettings.renderPages);\n                };\n                // eslint-disable-next-line\n                this_1.searchRequestHandler.onError = function (result) {\n                    proxy.pdfViewerBase.openNotificationPopup();\n                    // eslint-disable-next-line max-len\n                    proxy.pdfViewer.fireAjaxRequestFailed(result.status, result.statusText, this.pdfViewer.serverActionSettings.renderPages);\n                };\n            };\n            for (var y = 0; y < noTileY; y++) {\n                _loop_2(y);\n            }\n        };\n        var this_1 = this;\n        for (var x = 0; x < noTileX; x++) {\n            _loop_1(x);\n        }\n    };\n    /**\n     * @private\n     */\n    TextSearch.prototype.getPDFDocumentTexts = function () {\n        var startIndex = 0;\n        var endIndex = 50;\n        var pageCount = this.pdfViewerBase.pageCount;\n        if (endIndex >= pageCount) {\n            endIndex = pageCount;\n        }\n        this.createRequestForGetPdfTexts(startIndex, endIndex);\n    };\n    /**\n     * @param startIndex\n     * @param endIndex\n     * @private\n     */\n    TextSearch.prototype.createRequestForGetPdfTexts = function (startIndex, endIndex) {\n        var proxy = this;\n        var jsonObject;\n        // eslint-disable-next-line max-len\n        jsonObject = { pageStartIndex: startIndex, pageEndIndex: endIndex, documentId: proxy.pdfViewerBase.getDocumentId(), hashId: proxy.pdfViewerBase.hashId, action: 'RenderPdfTexts', elementId: proxy.pdfViewer.element.id, uniqueId: proxy.pdfViewerBase.documentId };\n        if (this.pdfViewerBase.jsonDocumentId) {\n            // eslint-disable-next-line\n            jsonObject.documentId = this.pdfViewerBase.jsonDocumentId;\n        }\n        this.searchRequestHandler = new AjaxHandler(this.pdfViewer);\n        this.searchRequestHandler.url = this.pdfViewer.serviceUrl + '/' + this.pdfViewer.serverActionSettings.renderTexts;\n        this.searchRequestHandler.responseType = 'json';\n        this.searchRequestHandler.send(jsonObject);\n        // eslint-disable-next-line\n        this.searchRequestHandler.onSuccess = function (result) {\n            // eslint-disable-next-line\n            var data = result.data;\n            if (data) {\n                if (typeof data !== 'object') {\n                    try {\n                        data = JSON.parse(data);\n                    }\n                    catch (error) {\n                        proxy.pdfViewerBase.onControlError(500, data, this.pdfViewer.serverActionSettings.renderTexts);\n                        data = null;\n                    }\n                }\n                if (data) {\n                    if (data.documentTextCollection && data.uniqueId === proxy.pdfViewerBase.documentId) {\n                        proxy.pdfViewer.fireAjaxRequestSuccess(this.pdfViewer.serverActionSettings.renderTexts, data);\n                        if (proxy.documentTextCollection.length > 0) {\n                            proxy.documentTextCollection = data.documentTextCollection.concat(proxy.documentTextCollection);\n                            proxy.documentTextCollection = proxy.orderPdfTextCollections(proxy.documentTextCollection);\n                        }\n                        else {\n                            proxy.documentTextCollection = data.documentTextCollection;\n                        }\n                        var pageCount = proxy.pdfViewerBase.pageCount;\n                        if (endIndex !== pageCount) {\n                            startIndex = endIndex;\n                            endIndex = endIndex + 50;\n                            if (endIndex >= pageCount) {\n                                endIndex = pageCount;\n                            }\n                            proxy.createRequestForGetPdfTexts(startIndex, endIndex);\n                        }\n                        else {\n                            proxy.isTextRetrieved = true;\n                            proxy.pdfViewer.fireTextExtractionCompleted(proxy.documentTextCollection);\n                            if (proxy.isTextSearched && proxy.searchString.length > 0) {\n                                proxy.textSearch(proxy.searchString);\n                                proxy.isTextSearched = false;\n                            }\n                        }\n                    }\n                }\n            }\n        };\n        // eslint-disable-next-line\n        this.searchRequestHandler.onFailure = function (result) {\n            proxy.pdfViewer.fireAjaxRequestFailed(result.status, result.statusText, this.pdfViewer.serverActionSettings.renderTexts);\n        };\n        // eslint-disable-next-line\n        this.searchRequestHandler.onError = function (result) {\n            proxy.pdfViewerBase.openNotificationPopup();\n            proxy.pdfViewer.fireAjaxRequestFailed(result.status, result.statusText, this.pdfViewer.serverActionSettings.renderTexts);\n        };\n    };\n    // eslint-disable-next-line\n    TextSearch.prototype.orderPdfTextCollections = function (oldCollection) {\n        // eslint-disable-next-line\n        var annotationCollectionList = [];\n        for (var i = 0; i < oldCollection.length; i++) {\n            if (annotationCollectionList.length === 0) {\n                annotationCollectionList.push(oldCollection[i]);\n            }\n            else {\n                // eslint-disable-next-line\n                if (parseInt(Object.keys(oldCollection[i])[0]) > parseInt(Object.keys(annotationCollectionList[annotationCollectionList.length - 1])[0])) {\n                    annotationCollectionList.push(oldCollection[i]);\n                }\n                else {\n                    for (var j = 0; j < annotationCollectionList.length; j++) {\n                        // eslint-disable-next-line\n                        if ((parseInt(Object.keys(oldCollection[i])[0]) < parseInt(Object.keys(annotationCollectionList[j])[0]))) {\n                            annotationCollectionList.splice(j, 0, oldCollection[i]);\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n        return annotationCollectionList;\n    };\n    TextSearch.prototype.createSearchBoxButtons = function (id, className) {\n        // eslint-disable-next-line max-len\n        var button = createElement('button', { id: this.pdfViewer.element.id + '_' + id, className: 'e-btn e-icon-btn e-pv-search-btn ' + className });\n        button.setAttribute('type', 'button');\n        // eslint-disable-next-line max-len\n        var iconSpan = createElement('span', { id: this.pdfViewer.element.id + '_' + id + 'Icon', className: 'e-pv-icon-search ' + className + '-icon' });\n        button.disabled = true;\n        button.appendChild(iconSpan);\n        return button;\n    };\n    TextSearch.prototype.enablePrevButton = function (isEnable) {\n        if ((!Browser.isDevice || this.pdfViewer.enableDesktopMode)) {\n            if (isEnable) {\n                this.prevSearchBtn.removeAttribute('disabled');\n            }\n            else {\n                if (this.prevSearchBtn) {\n                    this.prevSearchBtn.disabled = true;\n                }\n            }\n        }\n    };\n    TextSearch.prototype.enableNextButton = function (isEnable) {\n        if (!Browser.isDevice || this.pdfViewer.enableDesktopMode) {\n            if (isEnable) {\n                this.nextSearchBtn.removeAttribute('disabled');\n            }\n            else {\n                if (this.nextSearchBtn) {\n                    this.nextSearchBtn.disabled = true;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TextSearch.prototype.resetVariables = function () {\n        this.searchedPages = [];\n        // eslint-disable-next-line\n        this.searchMatches = new Array();\n    };\n    /**\n     * @param element\n     * @param inputElement\n     * @private\n     */\n    TextSearch.prototype.searchButtonClick = function (element, inputElement) {\n        this.isMessagePopupOpened = false;\n        if (isBlazor() && (Browser.isDevice && !this.pdfViewer.enableDesktopMode)) {\n            var searchElement = this.pdfViewerBase.getElement('_search_box-icon');\n            element = searchElement.children[0].children[0];\n            inputElement = this.pdfViewerBase.getElement('_search_input');\n        }\n        if (element.classList.contains('e-pv-search-icon')) {\n            this.initiateTextSearch(inputElement);\n        }\n        else if (element.classList.contains('e-pv-search-close')) {\n            this.showLoadingIndicator(false);\n            inputElement.value = '';\n            this.resetTextSearch();\n            inputElement.focus();\n        }\n    };\n    TextSearch.prototype.updateSearchInputIcon = function (isEnable) {\n        if (isBlazor()) {\n            if (this.searchBtn && (Browser.isDevice && !this.pdfViewer.enableDesktopMode)) {\n                this.searchBtn = this.pdfViewerBase.getElement('_search_box-icon').children[0].children[0];\n            }\n        }\n        if (this.searchBtn) {\n            if (isEnable) {\n                this.searchBtn.classList.remove('e-pv-search-close');\n                this.searchBtn.classList.add('e-pv-search-icon');\n            }\n            else {\n                this.searchBtn.classList.remove('e-pv-search-icon');\n                this.searchBtn.classList.add('e-pv-search-close');\n            }\n        }\n    };\n    TextSearch.prototype.onMessageBoxOpen = function () {\n        var _this = this;\n        this.showLoadingIndicator(false);\n        this.pdfViewerBase.getElement('_search_input').blur();\n        this.isMessagePopupOpened = true;\n        if (!Browser.isDevice || this.pdfViewer.enableDesktopMode) {\n            if (isBlazor()) {\n                var promise = this.pdfViewer._dotnetInstance.invokeMethodAsync('GetLocaleText', 'PdfViewer_Nomatches');\n                promise.then(function (value) {\n                    _this.pdfViewerBase.textLayer.createNotificationPopup(value);\n                });\n            }\n            else {\n                this.pdfViewerBase.textLayer.createNotificationPopup(this.pdfViewer.localeObj.getConstant('No matches'));\n            }\n        }\n        else {\n            if (isBlazor()) {\n                var promise = this.pdfViewer._dotnetInstance.invokeMethodAsync('GetLocaleText', 'PdfViewer_NoTextFound');\n                promise.then(function (value) {\n                    _this.pdfViewerBase.navigationPane.createTooltipMobile(value);\n                });\n            }\n            else {\n                this.pdfViewerBase.navigationPane.createTooltipMobile(this.pdfViewer.localeObj.getConstant('No Text Found'));\n            }\n        }\n    };\n    /**\n     * Searches the target text in the PDF document and highlights the occurrences in the pages\n     *\n     * @param  {string} searchText - Specifies the searchText content\n     * @param  {boolean} isMatchCase - If set true , its highlights the MatchCase content\n     * @returns void\n     */\n    TextSearch.prototype.searchText = function (searchText, isMatchCase) {\n        if (searchText && searchText.length > 0 && searchText[searchText.length - 1] === ' ') {\n            searchText = searchText.slice(0, searchText.length - 1);\n        }\n        this.searchString = searchText;\n        this.isMatchCase = isMatchCase;\n        this.searchIndex = 0;\n        this.textSearch(searchText);\n    };\n    /**\n     * Searches the next occurrence of the searched text from the current occurrence of the PdfViewer.\n     *\n     * @returns void\n     */\n    TextSearch.prototype.searchNext = function () {\n        this.nextSearch();\n    };\n    /**\n     * Searches the previous occurrence of the searched text from the current occurrence of the PdfViewer.\n     *\n     * @returns void\n     */\n    TextSearch.prototype.searchPrevious = function () {\n        this.prevSearch();\n    };\n    /**\n     * Cancels the text search of the PdfViewer.\n     *\n     * @returns void\n     */\n    TextSearch.prototype.cancelTextSearch = function () {\n        this.resetTextSearch();\n    };\n    /**\n     * @private\n     */\n    TextSearch.prototype.destroy = function () {\n        this.searchMatches = undefined;\n    };\n    /**\n     * @private\n     */\n    TextSearch.prototype.getModuleName = function () {\n        return 'TextSearch';\n    };\n    return TextSearch;\n}());\nexport { TextSearch };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}