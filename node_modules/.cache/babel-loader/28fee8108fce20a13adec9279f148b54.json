{"ast":null,"code":"import { detach, closest, Browser, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, EventHandler, addClass, removeClass } from '@syncfusion/ej2-base';\nimport { Popup } from '@syncfusion/ej2-popups';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport * as events from '../base/constant';\nimport { RenderType } from '../base/enum';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport * as classes from '../base/classes';\nimport { dispatchEvent, parseHtml, hasClass } from '../base/util';\n/**\n * `Table` module is used to handle table actions.\n */\n\nvar Table =\n/** @class */\nfunction () {\n  function Table(parent, serviceLocator) {\n    this.ensureInsideTableList = true;\n    this.pageX = null;\n    this.pageY = null;\n    this.moveEle = null;\n    this.currentColumnResize = '';\n    this.currentMarginLeft = 0;\n    this.parent = parent;\n    this.rteID = parent.element.id;\n    this.l10n = serviceLocator.getService('rteLocale');\n    this.rendererFactory = serviceLocator.getService('rendererFactory');\n    this.dialogRenderObj = serviceLocator.getService('dialogRenderObject');\n    this.addEventListener();\n  }\n\n  Table.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.on(events.createTable, this.renderDlgContent, this);\n    this.parent.on(events.initialEnd, this.afterRender, this);\n    this.parent.on(events.dynamicModule, this.afterRender, this);\n    this.parent.on(events.showTableDialog, this.showDialog, this);\n    this.parent.on(events.closeTableDialog, this.closeDialog, this);\n    this.parent.on(events.docClick, this.docClick, this);\n    this.parent.on(events.editAreaClick, this.editAreaClickHandler, this);\n    this.parent.on(events.clearDialogObj, this.clearDialogObj, this);\n    this.parent.on(events.tableToolbarAction, this.onToolbarAction, this);\n    this.parent.on(events.dropDownSelect, this.dropdownSelect, this);\n    this.parent.on(events.keyDown, this.keyDown, this);\n    this.parent.on(events.mouseUp, this.selectionTable, this);\n    this.parent.on(events.bindCssClass, this.setCssClass, this);\n    this.parent.on(events.destroy, this.destroy, this);\n  };\n\n  Table.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off(events.createTable, this.renderDlgContent);\n    this.parent.off(events.initialEnd, this.afterRender);\n    this.parent.off(events.dynamicModule, this.afterRender);\n    this.parent.off(events.docClick, this.docClick);\n    this.parent.off(events.showTableDialog, this.showDialog);\n    this.parent.off(events.closeTableDialog, this.closeDialog);\n    this.parent.off(events.editAreaClick, this.editAreaClickHandler);\n    this.parent.off(events.clearDialogObj, this.clearDialogObj);\n    this.parent.off(events.tableToolbarAction, this.onToolbarAction);\n    this.parent.off(events.dropDownSelect, this.dropdownSelect);\n    this.parent.off(events.mouseDown, this.cellSelect);\n    this.parent.off(events.tableColorPickerChanged, this.setBGColor);\n    this.parent.off(events.keyDown, this.keyDown);\n    this.parent.off(events.mouseUp, this.selectionTable);\n    this.parent.off(events.bindCssClass, this.setCssClass);\n    this.parent.off(events.destroy, this.destroy);\n  };\n\n  Table.prototype.updateCss = function (currentObj, e) {\n    if (currentObj && e.cssClass) {\n      if (isNullOrUndefined(e.oldCssClass)) {\n        currentObj.setProperties({\n          cssClass: (currentObj.cssClass + ' ' + e.cssClass).trim()\n        });\n      } else {\n        currentObj.setProperties({\n          cssClass: (currentObj.cssClass.replace(e.oldCssClass, '').trim() + ' ' + e.cssClass).trim()\n        });\n      }\n    }\n  };\n\n  Table.prototype.setCssClass = function (e) {\n    if (this.popupObj && e.cssClass) {\n      if (isNullOrUndefined(e.oldCssClass)) {\n        addClass([this.popupObj.element], e.cssClass);\n      } else {\n        removeClass([this.popupObj.element], e.oldCssClass);\n        addClass([this.popupObj.element], e.cssClass);\n      }\n    }\n\n    this.updateCss(this.createTableButton, e);\n    this.updateCss(this.editdlgObj, e);\n    var numericTextBoxObj = [this.columnTextBox, this.rowTextBox, this.tableWidthNum, this.tableCellPadding, this.tableCellSpacing];\n\n    for (var i = 0; i < numericTextBoxObj.length; i++) {\n      this.updateCss(numericTextBoxObj[i], e);\n    }\n  };\n\n  Table.prototype.selectionTable = function (e) {\n    var target = e.args.target;\n\n    if (Browser.info.name === 'mozilla' && !isNOU(closest(target, 'table')) && closest(target, 'table').tagName === 'TABLE') {\n      this.parent.contentModule.getEditPanel().setAttribute('contenteditable', 'true');\n    }\n  };\n\n  Table.prototype.afterRender = function () {\n    if (isNullOrUndefined(this.contentModule)) {\n      this.contentModule = this.rendererFactory.getRenderer(RenderType.Content);\n      this.parent.on(events.tableColorPickerChanged, this.setBGColor, this);\n      this.parent.on(events.mouseDown, this.cellSelect, this);\n\n      if (this.parent.tableSettings.resize) {\n        EventHandler.add(this.parent.contentModule.getEditPanel(), Browser.touchStartEvent, this.resizeStart, this);\n      }\n\n      if (!Browser.isDevice && this.parent.tableSettings.resize) {\n        EventHandler.add(this.contentModule.getEditPanel(), 'mouseover', this.resizeHelper, this);\n      }\n    }\n  };\n\n  Table.prototype.dropdownSelect = function (e) {\n    var item = e.item;\n\n    if (!document.body.contains(document.body.querySelector('.e-rte-quick-toolbar')) || item.command !== 'Table') {\n      return;\n    }\n\n    var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n    var args = {\n      args: e,\n      selection: this.parent.formatter.editorManager.nodeSelection.save(range, this.contentModule.getDocument()),\n      selectParent: this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range)\n    };\n\n    switch (item.subCommand) {\n      case 'InsertRowBefore':\n      case 'InsertRowAfter':\n        this.addRow(args.selection, e);\n        break;\n\n      case 'InsertColumnLeft':\n      case 'InsertColumnRight':\n        this.addColumn(args.selection, e);\n        break;\n\n      case 'DeleteColumn':\n      case 'DeleteRow':\n        this.removeRowColumn(args.selection, e);\n        break;\n\n      case 'AlignTop':\n      case 'AlignMiddle':\n      case 'AlignBottom':\n        this.verticalAlign(args, e);\n        break;\n\n      case 'Dashed':\n      case 'Alternate':\n      case 'Custom':\n        this.tableStyles(args, item.subCommand);\n        break;\n\n      case 'Merge':\n      case 'VerticalSplit':\n      case 'HorizontalSplit':\n        this.UpdateCells(args.selection, e);\n        break;\n    }\n  };\n\n  Table.prototype.UpdateCells = function (selectCell, e) {\n    this.parent.formatter.process(this.parent, e, e, {\n      selection: selectCell,\n      subCommand: e.item.subCommand\n    });\n    this.hideTableQuickToolbar();\n  };\n\n  Table.prototype.keyDown = function (e) {\n    var event = e.args; // eslint-disable-next-line\n\n    var proxy = this;\n\n    switch (event.action) {\n      case 'escape':\n        break;\n\n      case 'insert-table':\n        this.openDialog(true, e);\n        event.preventDefault();\n        break;\n    }\n\n    if (!isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection) && this.contentModule && event.code !== 'KeyK') {\n      var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n      var selection = this.parent.formatter.editorManager.nodeSelection.save(range, this.contentModule.getDocument());\n      var ele = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range)[0];\n      ele = ele && ele.tagName !== 'TD' && ele.tagName !== 'TH' ? ele.parentElement : ele;\n\n      if (event.keyCode === 8 || event.keyCode === 46 || event.ctrlKey && event.keyCode === 88) {\n        if (ele && ele.tagName === 'TBODY') {\n          event.preventDefault();\n          proxy.removeTable(selection, event, true);\n        } else if (ele && ele.querySelectorAll('table').length > 0) {\n          this.removeResizeElement();\n          this.hideTableQuickToolbar();\n        }\n      }\n\n      if (ele && ele.tagName !== 'TD' && ele.tagName !== 'TH') {\n        var closestTd = closest(ele, 'td');\n        ele = !isNullOrUndefined(closestTd) && this.parent.inputElement.contains(closestTd) ? closestTd : ele;\n      }\n\n      if (ele && (ele.tagName === 'TD' || ele.tagName === 'TH')) {\n        switch (event.keyCode) {\n          case 9:\n          case 37:\n          case 39:\n            proxy.tabSelection(event, selection, ele);\n            break;\n\n          case 40:\n          case 38:\n            proxy.tableArrowNavigation(event, selection, ele);\n            break;\n        }\n      }\n    }\n  };\n\n  Table.prototype.openDialog = function (isInternal, e) {\n    if (!isInternal) {\n      this.parent.contentModule.getEditPanel().focus();\n    }\n\n    if (this.parent.editorMode === 'HTML') {\n      var docElement = this.parent.contentModule.getDocument();\n      var range = this.parent.formatter.editorManager.nodeSelection.getRange(docElement);\n      var selection = this.parent.formatter.editorManager.nodeSelection.save(range, docElement);\n      var args = {\n        originalEvent: e ? e.args : {\n          action: 'insert-table'\n        },\n        item: {\n          command: 'Table',\n          subCommand: 'CreateTable'\n        }\n      };\n      this.insertTableDialog({\n        self: this,\n        args: args,\n        selection: selection\n      });\n    }\n  };\n\n  Table.prototype.showDialog = function () {\n    this.openDialog(false);\n    this.setCssClass({\n      cssClass: this.parent.cssClass\n    });\n  };\n\n  Table.prototype.closeDialog = function () {\n    if (this.editdlgObj) {\n      this.editdlgObj.hide({\n        returnValue: true\n      });\n    }\n  };\n\n  Table.prototype.onToolbarAction = function (args) {\n    var item = args.args.item;\n\n    switch (item.subCommand) {\n      case 'TableHeader':\n        this.tableHeader(args.selection, args.args);\n        break;\n\n      case 'TableRemove':\n        this.removeTable(args.selection, args.args);\n        break;\n\n      case 'TableEditProperties':\n        this.editTable(args);\n        break;\n    }\n  };\n\n  Table.prototype.verticalAlign = function (args, e) {\n    var tdEle = closest(args.selectParent[0], 'td') || closest(args.selectParent[0], 'th');\n\n    if (tdEle) {\n      this.parent.formatter.process(this.parent, e, e, {\n        tableCell: tdEle,\n        subCommand: e.item.subCommand\n      });\n    }\n  };\n\n  Table.prototype.tableStyles = function (args, command) {\n    var table = closest(args.selectParent[0], 'table');\n\n    if (command === 'Dashed') {\n      /* eslint-disable */\n      this.parent.element.classList.contains(classes.CLS_TB_DASH_BOR) ? this.parent.element.classList.remove(classes.CLS_TB_DASH_BOR) : this.parent.element.classList.add(classes.CLS_TB_DASH_BOR);\n      table.classList.contains(classes.CLS_TB_DASH_BOR) ? table.classList.remove(classes.CLS_TB_DASH_BOR) : table.classList.add(classes.CLS_TB_DASH_BOR);\n    }\n\n    if (command === 'Alternate') {\n      this.parent.element.classList.contains(classes.CLS_TB_ALT_BOR) ? this.parent.element.classList.remove(classes.CLS_TB_ALT_BOR) : this.parent.element.classList.add(classes.CLS_TB_ALT_BOR);\n      table.classList.contains(classes.CLS_TB_ALT_BOR) ? table.classList.remove(classes.CLS_TB_ALT_BOR) : table.classList.add(classes.CLS_TB_ALT_BOR);\n      /* eslint-enable */\n    }\n\n    if (args.args && args.args.item.cssClass) {\n      var classList = args.args.item.cssClass.split(' ');\n\n      for (var i = 0; i < classList.length; i++) {\n        if (table.classList.contains(classList[i])) {\n          table.classList.remove(classList[i]);\n        } else {\n          table.classList.add(classList[i]);\n        }\n      }\n    }\n\n    this.parent.formatter.saveData();\n    this.parent.formatter.editorManager.nodeSelection.restore();\n  };\n\n  Table.prototype.insideList = function (range) {\n    var blockNodes = this.parent.formatter.editorManager.domNode.blockNodes();\n    var nodes = [];\n\n    for (var i = 0; i < blockNodes.length; i++) {\n      if (blockNodes[i].parentNode.tagName === 'LI') {\n        nodes.push(blockNodes[i].parentNode);\n      } else if (blockNodes[i].tagName === 'LI' && blockNodes[i].childNodes[0].tagName !== 'P' && blockNodes[i].childNodes[0].tagName !== 'OL' && blockNodes[i].childNodes[0].tagName !== 'UL') {\n        nodes.push(blockNodes[i]);\n      }\n    }\n\n    if (nodes.length > 1 || nodes.length && range.startOffset === 0 && range.endOffset === 0) {\n      this.ensureInsideTableList = true;\n      return true;\n    } else {\n      this.ensureInsideTableList = false;\n      return false;\n    }\n  };\n\n  Table.prototype.tabSelection = function (event, selection, ele) {\n    var insideList = this.insideList(selection.range);\n\n    if ((event.keyCode === 37 || event.keyCode === 39) && selection.range.startContainer.nodeType === 3 || insideList) {\n      return;\n    }\n\n    event.preventDefault();\n    ele.classList.remove(classes.CLS_TABLE_SEL);\n\n    if (!event.shiftKey && event.keyCode !== 37) {\n      var nextElement = !isNullOrUndefined(ele.nextSibling) ? ele.nextSibling : !isNullOrUndefined(closest(ele, 'tr').nextSibling) ? closest(ele, 'tr').nextSibling.childNodes[0] : !isNullOrUndefined(closest(ele, 'table').nextSibling) ? closest(ele, 'table').nextSibling.nodeName.toLowerCase() === 'td' ? closest(ele, 'table').nextSibling : ele : ele;\n\n      if (ele === nextElement && ele.nodeName === 'TH') {\n        nextElement = closest(ele, 'table').rows[1].cells[0];\n      }\n\n      if (event.keyCode === 39 && ele === nextElement) {\n        nextElement = closest(ele, 'table').nextSibling;\n      }\n\n      if (nextElement) {\n        // eslint-disable-next-line\n        nextElement.textContent.trim() !== '' && closest(nextElement, 'td') ? selection.setSelectionNode(this.contentModule.getDocument(), nextElement) : selection.setSelectionText(this.contentModule.getDocument(), nextElement, nextElement, 0, 0);\n      }\n\n      if (ele === nextElement && event.keyCode !== 39 && nextElement) {\n        ele.classList.add(classes.CLS_TABLE_SEL);\n        this.addRow(selection, event, true);\n        ele.classList.remove(classes.CLS_TABLE_SEL);\n        nextElement = nextElement.parentElement.nextSibling ? nextElement.parentElement.nextSibling.firstChild : nextElement.parentElement.firstChild; // eslint-disable-next-line\n\n        nextElement.textContent.trim() !== '' && closest(nextElement, 'td') ? selection.setSelectionNode(this.contentModule.getDocument(), nextElement) : selection.setSelectionText(this.contentModule.getDocument(), nextElement, nextElement, 0, 0);\n      }\n    } else {\n      var prevElement = !isNullOrUndefined(ele.previousSibling) ? ele.previousSibling : !isNullOrUndefined(closest(ele, 'tr').previousSibling) ? closest(ele, 'tr').previousSibling.childNodes[closest(ele, 'tr').previousSibling.childNodes.length - 1] : !isNullOrUndefined(closest(ele, 'table').previousSibling) ? closest(ele, 'table').previousSibling.nodeName.toLowerCase() === 'td' ? closest(ele, 'table').previousSibling : ele : ele;\n\n      if (ele === prevElement && ele.cellIndex === 0 && closest(ele, 'table').tHead) {\n        var clsTble = closest(ele, 'table');\n        prevElement = clsTble.rows[0].cells[clsTble.rows[0].cells.length - 1];\n      }\n\n      if (event.keyCode === 37 && ele === prevElement) {\n        prevElement = closest(ele, 'table').previousSibling;\n      }\n\n      if (prevElement) {\n        // eslint-disable-next-line\n        prevElement.textContent.trim() !== '' && closest(prevElement, 'td') ? selection.setSelectionNode(this.contentModule.getDocument(), prevElement) : selection.setSelectionText(this.contentModule.getDocument(), prevElement, prevElement, 0, 0);\n      }\n    }\n  };\n\n  Table.prototype.tableArrowNavigation = function (event, selection, ele) {\n    var selText = selection.range.startContainer;\n\n    if (event.keyCode === 40 && selText.nodeType === 3 && (selText.nextSibling && selText.nextSibling.nodeName === 'BR' || selText.parentNode && selText.parentNode.nodeName !== 'TD') || event.keyCode === 38 && selText.nodeType === 3 && (selText.previousSibling && selText.previousSibling.nodeName === 'BR' || selText.parentNode && selText.parentNode.nodeName !== 'TD')) {\n      return;\n    }\n\n    event.preventDefault();\n    ele.classList.remove(classes.CLS_TABLE_SEL);\n\n    if (event.keyCode === 40) {\n      ele = !isNullOrUndefined(closest(ele, 'tr').nextElementSibling) ? closest(ele, 'tr').nextElementSibling.children[ele.cellIndex] : closest(ele, 'table').tHead && ele.nodeName === 'TH' ? closest(ele, 'table').rows[1].cells[ele.cellIndex] : !isNullOrUndefined(closest(ele, 'table').nextSibling) ? closest(ele, 'table').nextSibling : ele;\n    } else {\n      ele = !isNullOrUndefined(closest(ele, 'tr').previousElementSibling) ? closest(ele, 'tr').previousElementSibling.children[ele.cellIndex] : closest(ele, 'table').tHead && ele.nodeName !== 'TH' ? closest(ele, 'table').tHead.rows[0].cells[ele.cellIndex] : !isNullOrUndefined(closest(ele, 'table').previousSibling) ? closest(ele, 'table').previousSibling : ele;\n    }\n\n    if (ele) {\n      selection.setSelectionText(this.contentModule.getDocument(), ele, ele, 0, 0);\n    }\n  };\n\n  Table.prototype.setBGColor = function (args) {\n    var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument()); // eslint-disable-next-line\n\n    var selection = this.parent.formatter.editorManager.nodeSelection.save(range, this.contentModule.getDocument()); // eslint-disable-next-line\n\n    var selectedCells = this.curTable.querySelectorAll('.e-cell-select');\n\n    for (var i = 0; i < selectedCells.length; i++) {\n      selectedCells[i].style.backgroundColor = args.item.value;\n    }\n\n    this.parent.formatter.saveData();\n  };\n\n  Table.prototype.hideTableQuickToolbar = function () {\n    if (this.quickToolObj && this.quickToolObj.tableQTBar && document.body.contains(this.quickToolObj.tableQTBar.element)) {\n      this.quickToolObj.tableQTBar.hidePopup();\n    }\n  };\n\n  Table.prototype.tableHeader = function (selection, e) {\n    this.parent.formatter.process(this.parent, e, e.originalEvent, {\n      selection: selection,\n      subCommand: e.item.subCommand\n    });\n  };\n\n  Table.prototype.editAreaClickHandler = function (e) {\n    if (this.parent.readonly || !isNOU(closest(e.args.target, '.e-img-caption'))) {\n      return;\n    }\n\n    var args = e.args;\n    var showOnRightClick = this.parent.quickToolbarSettings.showOnRightClick;\n\n    if (args.which === 2 || showOnRightClick && args.which === 1 || !showOnRightClick && args.which === 3) {\n      return;\n    }\n\n    if (this.parent.editorMode === 'HTML' && this.parent.quickToolbarModule && this.parent.quickToolbarModule.tableQTBar) {\n      this.quickToolObj = this.parent.quickToolbarModule;\n      var target = args.target;\n      this.contentModule = this.rendererFactory.getRenderer(RenderType.Content);\n      var isPopupOpen = this.quickToolObj.tableQTBar.element.classList.contains('e-rte-pop');\n\n      if (isPopupOpen) {\n        return;\n      }\n\n      var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument());\n      var closestTable = closest(target, 'table');\n      var startNode = this.parent.getRange().startContainer.parentElement;\n      var endNode = this.parent.getRange().endContainer.parentElement;\n\n      if (target && target.nodeName !== 'A' && target.nodeName !== 'IMG' && startNode === endNode && (target.nodeName === 'TD' || target.nodeName === 'TH' || target.nodeName === 'TABLE' || closestTable && this.parent.contentModule.getEditPanel().contains(closestTable)) && !(range.startContainer.nodeType === 3 && !range.collapsed)) {\n        var range_1 = this.parent.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument());\n        this.parent.formatter.editorManager.nodeSelection.save(range_1, this.contentModule.getDocument());\n        this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument());\n        var pageY = this.parent.iframeSettings.enable ? window.pageYOffset + this.parent.element.getBoundingClientRect().top + args.clientY : args.pageY;\n        this.quickToolObj.tableQTBar.showPopup(args.pageX, pageY, target);\n        this.parent.formatter.editorManager.nodeSelection.restore();\n      } else {\n        this.hideTableQuickToolbar();\n      }\n    }\n  };\n\n  Table.prototype.tableCellSelect = function (e) {\n    var target = e.target;\n    var row = Array.prototype.slice.call(target.parentElement.parentElement.children).indexOf(target.parentElement);\n    var col = Array.prototype.slice.call(target.parentElement.children).indexOf(target);\n    var list = this.dlgDiv.querySelectorAll('.e-rte-tablecell');\n    Array.prototype.forEach.call(list, function (item) {\n      var parentIndex = Array.prototype.slice.call(item.parentElement.parentElement.children).indexOf(item.parentElement);\n      var cellIndex = Array.prototype.slice.call(item.parentElement.children).indexOf(item);\n      removeClass([item], 'e-active');\n\n      if (parentIndex <= row && cellIndex <= col) {\n        addClass([item], 'e-active');\n      }\n    });\n    this.tblHeader.innerHTML = col + 1 + 'x' + (row + 1);\n  }; // eslint-disable-next-line\n\n\n  Table.prototype.tableMouseUp = function (e) {\n    EventHandler.remove(this.curTable, 'mousemove', this.tableMove);\n  }; // eslint-disable-next-line\n\n\n  Table.prototype.tableCellLeave = function (e) {\n    removeClass(this.dlgDiv.querySelectorAll('.e-rte-tablecell'), 'e-active');\n    addClass([this.dlgDiv.querySelector('.e-rte-tablecell')], 'e-active');\n    this.tblHeader.innerHTML = 1 + 'x' + 1;\n  };\n\n  Table.prototype.tableCellClick = function (e) {\n    var target = e.target;\n    var row = Array.prototype.slice.call(target.parentElement.parentElement.children).indexOf(target.parentElement) + 1;\n    var col = Array.prototype.slice.call(target.parentElement.children).indexOf(target) + 1;\n    this.self.tableInsert(row, col, e, this);\n  };\n\n  Table.prototype.tableInsert = function (row, col, e, selectionObj) {\n    var proxy = selectionObj.self ? selectionObj.self : this;\n    var startContainer = selectionObj.selection.range.startContainer;\n\n    if (startContainer.nodeName === 'P' && startContainer.textContent.trim() === '' && !(startContainer.childNodes.length > 0)) {\n      startContainer.innerHTML = '<br />';\n    }\n\n    var parentNode = startContainer.parentNode;\n\n    if (proxy.parent.editorMode === 'HTML' && (proxy.parent.iframeSettings.enable && !hasClass(parentNode.ownerDocument.querySelector('body'), 'e-lib') || // eslint-disable-next-line\n    !proxy.parent.iframeSettings.enable && isNOU(closest(parentNode, '[id=' + \"'\" + proxy.contentModule.getPanel().id + \"'\" + ']')))) {\n      proxy.contentModule.getEditPanel().focus();\n      var range = proxy.parent.formatter.editorManager.nodeSelection.getRange(proxy.contentModule.getDocument());\n      selectionObj.selection = proxy.parent.formatter.editorManager.nodeSelection.save(range, proxy.contentModule.getDocument());\n    }\n\n    var value = {\n      rows: row,\n      columns: col,\n      width: {\n        minWidth: proxy.parent.tableSettings.minWidth,\n        maxWidth: proxy.parent.tableSettings.maxWidth,\n        width: proxy.parent.tableSettings.width\n      },\n      selection: selectionObj.selection\n    };\n\n    if (proxy.popupObj) {\n      proxy.popupObj.hide();\n    }\n\n    if (proxy.editdlgObj) {\n      proxy.editdlgObj.hide();\n    }\n\n    proxy.parent.formatter.process(proxy.parent, selectionObj.args, selectionObj.args.originalEvent, value);\n    proxy.contentModule.getEditPanel().focus();\n    proxy.parent.on(events.mouseDown, proxy.cellSelect, proxy);\n  };\n\n  Table.prototype.cellSelect = function (e) {\n    var target = e.args.target;\n    var tdNode = closest(target, 'td,th');\n    target = target.nodeName !== 'TD' && tdNode && this.parent.contentModule.getEditPanel().contains(tdNode) ? tdNode : target;\n    removeClass(this.contentModule.getEditPanel().querySelectorAll('table td, table th'), classes.CLS_TABLE_SEL);\n\n    if (target && (target.tagName === 'TD' || target.tagName === 'TH')) {\n      addClass([target], classes.CLS_TABLE_SEL);\n      this.activeCell = target;\n      this.curTable = this.curTable ? this.curTable : closest(target, 'table');\n      EventHandler.add(this.curTable, 'mousemove', this.tableMove, this);\n      EventHandler.add(this.curTable, 'mouseup', this.tableMouseUp, this);\n      this.removeResizeElement();\n\n      if (this.helper && this.contentModule.getEditPanel().contains(this.helper)) {\n        detach(this.helper);\n      }\n    }\n\n    if (Browser.info.name === 'mozilla' && !isNOU(closest(target, 'table')) && closest(target, 'table').tagName === 'TABLE') {\n      this.parent.contentModule.getEditPanel().setAttribute('contenteditable', 'false');\n    }\n  };\n\n  Table.prototype.tableMove = function (event) {\n    this.parent.formatter.editorManager.observer.notify('TABLE_MOVE', {\n      event: event,\n      selectNode: [this.activeCell]\n    });\n  };\n\n  Table.prototype.resizeHelper = function (e) {\n    if (this.parent.readonly) {\n      return;\n    }\n\n    var target = e.target || e.targetTouches[0].target;\n    var closestTable = closest(target, 'table.e-rte-table');\n\n    if (!isNOU(this.curTable) && !isNOU(closestTable) && closestTable !== this.curTable) {\n      this.removeResizeElement();\n      this.removeHelper(e);\n      this.cancelResizeAction();\n    }\n\n    if (target.nodeName === 'TABLE' || target.nodeName === 'TD' || target.nodeName === 'TH') {\n      this.curTable = closestTable && this.parent.contentModule.getEditPanel().contains(closestTable) && (target.nodeName === 'TD' || target.nodeName === 'TH') ? closestTable : target;\n      this.removeResizeElement();\n      this.tableResizeEleCreation(this.curTable, e);\n    }\n  };\n\n  Table.prototype.tableResizeEleCreation = function (table, e) {\n    this.parent.preventDefaultResize(e);\n    var columns = table.rows[this.calMaxCol(table)].cells;\n    var rows = [];\n\n    for (var i = 0; i < table.rows.length; i++) {\n      rows.push(Array.prototype.slice.call(table.rows[i].cells, 0, 1)[0]);\n    }\n\n    var height = parseInt(getComputedStyle(table).height, 10);\n    var width = parseInt(getComputedStyle(table).width, 10);\n    var pos = this.calcPos(table);\n\n    for (var i = 0; columns.length >= i; i++) {\n      var colReEle = this.parent.createElement('span', {\n        attrs: {\n          'data-col': i.toString(),\n          'unselectable': 'on',\n          'contenteditable': 'false'\n        }\n      });\n      colReEle.classList.add(classes.CLS_RTE_TABLE_RESIZE, classes.CLS_TB_COL_RES);\n\n      if (columns.length === i) {\n        colReEle.style.cssText = 'height: ' + height + 'px; width: 4px; top: ' + pos.top + 'px; left:' + (pos.left + this.calcPos(columns[i - 1]).left + columns[i - 1].offsetWidth) + 'px;';\n      } else {\n        colReEle.style.cssText = 'height: ' + height + 'px; width: 4px; top: ' + pos.top + 'px; left:' + (pos.left + this.calcPos(columns[i]).left) + 'px;';\n      }\n\n      this.contentModule.getEditPanel().appendChild(colReEle);\n    }\n\n    for (var i = 0; rows.length > i; i++) {\n      var rowReEle = this.parent.createElement('span', {\n        attrs: {\n          'data-row': i.toString(),\n          'unselectable': 'on',\n          'contenteditable': 'false'\n        }\n      });\n      rowReEle.classList.add(classes.CLS_RTE_TABLE_RESIZE, classes.CLS_TB_ROW_RES);\n      var rowPosLeft = !isNOU(table.getAttribute('cellspacing')) || table.getAttribute('cellspacing') !== '' ? 0 : this.calcPos(rows[i]).left;\n      rowReEle.style.cssText = 'width: ' + width + 'px; height: 4px; top: ' + (this.calcPos(rows[i]).top + pos.top + rows[i].offsetHeight - 2) + 'px; left:' + (rowPosLeft + pos.left) + 'px;';\n      this.contentModule.getEditPanel().appendChild(rowReEle);\n    }\n\n    var tableReBox = this.parent.createElement('span', {\n      className: classes.CLS_TB_BOX_RES + ' ' + this.parent.cssClass,\n      attrs: {\n        'data-col': columns.length.toString(),\n        'unselectable': 'on',\n        'contenteditable': 'false'\n      }\n    });\n    tableReBox.style.cssText = 'top: ' + (pos.top + height - 4) + 'px; left:' + (pos.left + width - 4) + 'px;';\n\n    if (Browser.isDevice) {\n      tableReBox.classList.add('e-rmob');\n    }\n\n    this.contentModule.getEditPanel().appendChild(tableReBox);\n  };\n\n  Table.prototype.removeResizeElement = function () {\n    var item = this.parent.contentModule.getEditPanel().querySelectorAll('.e-column-resize, .e-row-resize, .e-table-box');\n\n    if (item.length > 0) {\n      for (var i = 0; i < item.length; i++) {\n        detach(item[i]);\n      }\n    }\n  };\n\n  Table.prototype.calcPos = function (elem) {\n    var parentOffset = {\n      top: 0,\n      left: 0\n    }; // eslint-disable-next-line\n\n    var offset = elem.getBoundingClientRect();\n    var doc = elem.ownerDocument;\n    var offsetParent = elem.offsetParent || doc.documentElement;\n    var isNestedTable = false;\n\n    while (offsetParent && (offsetParent === doc.body || offsetParent === doc.documentElement) && offsetParent.style.position === 'static') {\n      offsetParent = offsetParent.parentNode;\n    }\n\n    if (offsetParent.nodeName === 'TD' && elem.nodeName === 'TABLE') {\n      offsetParent = closest(offsetParent, '.e-rte-content');\n      isNestedTable = true;\n    }\n\n    if (offsetParent && offsetParent !== elem && offsetParent.nodeType === 1) {\n      // eslint-disable-next-line\n      parentOffset = offsetParent.getBoundingClientRect();\n    }\n\n    if (isNestedTable) {\n      isNestedTable = false;\n      var topValue = this.parent.inputElement && this.parent.inputElement.scrollTop > 0 ? this.parent.inputElement.scrollTop + offset.top - parentOffset.top : offset.top - parentOffset.top;\n      var leftValue = this.parent.inputElement && this.parent.inputElement.scrollLeft > 0 ? this.parent.inputElement.scrollLeft + offset.left - parentOffset.left : offset.left - parentOffset.left;\n      return {\n        top: topValue,\n        left: leftValue\n      };\n    } else {\n      return {\n        top: elem.offsetTop,\n        left: elem.offsetLeft\n      };\n    }\n  };\n\n  Table.prototype.getPointX = function (e) {\n    if (e.touches && e.touches.length) {\n      return e.touches[0].pageX;\n    } else {\n      return e.pageX;\n    }\n  };\n\n  Table.prototype.getPointY = function (e) {\n    if (e.touches && e.touches.length) {\n      return e.touches[0].pageY;\n    } else {\n      return e.pageY;\n    }\n  };\n\n  Table.prototype.resizeStart = function (e) {\n    var _this = this;\n\n    if (this.parent.readonly) {\n      return;\n    }\n\n    if (Browser.isDevice) {\n      this.resizeHelper(e);\n    }\n\n    var target = e.target;\n\n    if (target.classList.contains(classes.CLS_TB_COL_RES) || target.classList.contains(classes.CLS_TB_ROW_RES) || target.classList.contains(classes.CLS_TB_BOX_RES)) {\n      e.preventDefault();\n      this.parent.preventDefaultResize(e);\n      removeClass(this.curTable.querySelectorAll('td,th'), classes.CLS_TABLE_SEL);\n      this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument());\n      this.pageX = this.getPointX(e);\n      this.pageY = this.getPointY(e);\n      this.resizeBtnInit();\n      this.hideTableQuickToolbar();\n\n      if (target.classList.contains(classes.CLS_TB_COL_RES)) {\n        this.resizeBtnStat.column = true;\n\n        if (parseInt(target.getAttribute('data-col'), 10) === this.curTable.rows[this.calMaxCol(this.curTable)].cells.length) {\n          this.currentColumnResize = 'last';\n          this.columnEle = this.curTable.rows[this.calMaxCol(this.curTable)].cells[parseInt(target.getAttribute('data-col'), 10) - 1];\n        } else {\n          if (parseInt(target.getAttribute('data-col'), 10) === 0) {\n            this.currentColumnResize = 'first';\n          } else {\n            this.currentColumnResize = 'middle';\n          }\n\n          this.columnEle = this.curTable.rows[this.calMaxCol(this.curTable)].cells[parseInt(target.getAttribute('data-col'), 10)];\n        }\n\n        this.colIndex = this.columnEle.cellIndex;\n        this.moveEle = e.target;\n        this.appendHelper();\n      }\n\n      if (target.classList.contains(classes.CLS_TB_ROW_RES)) {\n        this.rowEle = this.curTable.rows[parseInt(target.getAttribute('data-row'), 10)];\n        this.resizeBtnStat.row = true;\n        this.appendHelper();\n      }\n\n      if (target.classList.contains(classes.CLS_TB_BOX_RES)) {\n        this.resizeBtnStat.tableBox = true;\n      }\n\n      if (Browser.isDevice && this.helper && !this.helper.classList.contains('e-reicon')) {\n        this.helper.classList.add('e-reicon');\n        EventHandler.add(document, Browser.touchStartEvent, this.removeHelper, this);\n        EventHandler.add(this.helper, Browser.touchStartEvent, this.resizeStart, this);\n      } else {\n        var args = {\n          event: e,\n          requestType: 'Table'\n        };\n        this.parent.trigger(events.resizeStart, args, function (resizeStartArgs) {\n          if (resizeStartArgs.cancel) {\n            _this.cancelResizeAction();\n          }\n        });\n      }\n\n      EventHandler.add(this.contentModule.getDocument(), Browser.touchMoveEvent, this.resizing, this);\n      EventHandler.add(this.contentModule.getDocument(), Browser.touchEndEvent, this.resizeEnd, this);\n    }\n  };\n\n  Table.prototype.removeHelper = function (e) {\n    var cls = e.target.classList;\n\n    if (!cls.contains('e-reicon') && this.helper) {\n      EventHandler.remove(document, Browser.touchStartEvent, this.removeHelper);\n      EventHandler.remove(this.helper, Browser.touchStartEvent, this.resizeStart);\n\n      if (this.helper && this.contentModule.getEditPanel().contains(this.helper)) {\n        detach(this.helper);\n      }\n\n      this.pageX = null;\n      this.helper = null;\n    }\n  };\n\n  Table.prototype.appendHelper = function () {\n    this.helper = this.parent.createElement('div', {\n      className: 'e-table-rhelper' + ' ' + this.parent.cssClass\n    });\n\n    if (Browser.isDevice) {\n      this.helper.classList.add('e-reicon');\n    }\n\n    this.contentModule.getEditPanel().appendChild(this.helper);\n    this.setHelperHeight();\n  };\n\n  Table.prototype.setHelperHeight = function () {\n    var pos = this.calcPos(this.curTable);\n\n    if (this.resizeBtnStat.column) {\n      this.helper.classList.add('e-column-helper');\n      this.helper.style.cssText = 'height: ' + getComputedStyle(this.curTable).height + '; top: ' + pos.top + 'px; left:' + (pos.left + this.calcPos(this.columnEle).left + (this.currentColumnResize === 'last' ? this.columnEle.offsetWidth + 2 : 0) - 1) + 'px;';\n    } else {\n      this.helper.classList.add('e-row-helper');\n      this.helper.style.cssText = 'width: ' + getComputedStyle(this.curTable).width + '; top: ' + (this.calcPos(this.rowEle).top + pos.top + this.rowEle.offsetHeight) + 'px; left:' + (this.calcPos(this.rowEle).left + pos.left) + 'px;';\n    }\n  };\n\n  Table.prototype.updateHelper = function () {\n    var pos = this.calcPos(this.curTable);\n\n    if (this.resizeBtnStat.column) {\n      var left = pos.left + this.calcPos(this.columnEle).left + (this.currentColumnResize === 'last' ? this.columnEle.offsetWidth + 2 : 0) - 1;\n      this.helper.style.left = left + 'px';\n    } else {\n      var top_1 = this.calcPos(this.rowEle).top + pos.top + this.rowEle.offsetHeight;\n      this.helper.style.top = top_1 + 'px';\n    }\n  };\n\n  Table.prototype.calMaxCol = function (element) {\n    var max = 0;\n    var maxRowIndex;\n\n    for (var i = 0; i < element.rows.length; i++) {\n      if (max < element.rows[i].cells.length) {\n        maxRowIndex = i;\n        max = element.rows[i].cells.length;\n      }\n    }\n\n    return maxRowIndex;\n  };\n\n  Table.prototype.resizing = function (e) {\n    var _this = this;\n\n    var pageX = this.getPointX(e);\n    var pageY = this.getPointY(e);\n    var mouseX = this.parent.enableRtl ? -(pageX - this.pageX) : pageX - this.pageX;\n    var mouseY = this.parent.enableRtl ? -(pageY - this.pageY) : pageY - this.pageY;\n    this.pageX = pageX;\n    this.pageY = pageY;\n    var args = {\n      event: e,\n      requestType: 'table'\n    };\n    this.parent.trigger(events.onResize, args, function (resizingArgs) {\n      if (resizingArgs.cancel) {\n        _this.cancelResizeAction();\n      } else {\n        var tableReBox = _this.contentModule.getEditPanel().querySelector('.e-table-box');\n\n        var tableWidth = parseInt(getComputedStyle(_this.curTable).width, 10);\n        var tableHeight = parseInt(getComputedStyle(_this.curTable).height, 10);\n        var paddingSize = +getComputedStyle(_this.contentModule.getEditPanel()).paddingRight.match(/\\d/g).join('');\n        var rteWidth = _this.contentModule.getEditPanel().offsetWidth - (_this.contentModule.getEditPanel().offsetWidth - _this.contentModule.getEditPanel().clientWidth) - paddingSize * 2;\n        var widthCompare = void 0;\n\n        if (!isNOU(_this.curTable.parentElement.closest('table'))) {\n          var currentTd = _this.curTable.closest('td');\n\n          var currentTDPad = +getComputedStyle(currentTd).paddingRight.match(/\\d/g).join(''); // Padding of the current table with the parent element multiply with 2.\n\n          widthCompare = currentTd.offsetWidth - (currentTd.offsetWidth - currentTd.clientWidth) - currentTDPad * 2;\n        } else {\n          widthCompare = rteWidth;\n        }\n\n        if (_this.resizeBtnStat.column) {\n          var width = parseFloat(_this.columnEle.offsetWidth.toString());\n          var cellRow = _this.curTable.rows[0].cells[0].nodeName === 'TH' ? 1 : 0;\n          var currentTableWidth = parseFloat(_this.curTable.style.width.split('%')[0]);\n          var currentColumnCellWidth = parseFloat(_this.curTable.rows[cellRow].cells[_this.colIndex].style.width.split('%')[0]);\n\n          if (_this.currentColumnResize === 'first') {\n            mouseX = mouseX - 0.75; //This was done for to make the gripper and the table first/last column will be close.\n\n            _this.removeResizeElement(); // Below the value '100' is the 100% width of the parent element.\n\n\n            if ((mouseX !== 0 && 5 < currentColumnCellWidth || mouseX < 0) && currentTableWidth <= 100 && _this.convertPixelToPercentage(tableWidth - mouseX, widthCompare) <= 100) {\n              var firstColumnsCell = _this.findFirstLastColCells(_this.curTable, true);\n\n              _this.curTable.style.width = _this.convertPixelToPercentage(tableWidth - mouseX, widthCompare) > 100 ? 100 + '%' : _this.convertPixelToPercentage(tableWidth - mouseX, widthCompare) + '%';\n\n              var differenceWidth = currentTableWidth - _this.convertPixelToPercentage(tableWidth - mouseX, widthCompare);\n\n              _this.currentMarginLeft = _this.currentMarginLeft + differenceWidth;\n              _this.curTable.style.marginLeft = 'calc(' + (_this.curTable.style.width === '100%' ? 0 : _this.currentMarginLeft) + '%)';\n\n              for (var i = 0; i < firstColumnsCell.length; i++) {\n                _this.curTable.rows[i].cells[_this.colIndex].style.width = currentColumnCellWidth - differenceWidth + '%';\n              }\n            }\n          } else if (_this.currentColumnResize === 'last') {\n            mouseX = mouseX + 0.75; //This was done for to make the gripper and the table first/last column will be close.\n\n            _this.removeResizeElement(); // Below the value '100' is the 100% width of the parent element.\n\n\n            if ((mouseX !== 0 && 5 < currentColumnCellWidth || mouseX > 0) && currentTableWidth <= 100 && _this.convertPixelToPercentage(tableWidth + mouseX, widthCompare) <= 100) {\n              var lastColumnsCell = _this.findFirstLastColCells(_this.curTable, false);\n\n              _this.curTable.style.width = _this.convertPixelToPercentage(tableWidth + mouseX, widthCompare) > 100 ? 100 + '%' : _this.convertPixelToPercentage(tableWidth + mouseX, widthCompare) + '%';\n\n              var differenceWidth = currentTableWidth - _this.convertPixelToPercentage(tableWidth + mouseX, widthCompare);\n\n              for (var i = 0; i < lastColumnsCell.length; i++) {\n                _this.curTable.rows[i].cells[_this.colIndex].style.width = currentColumnCellWidth - differenceWidth + '%';\n              }\n            }\n          } else {\n            var cellColl = _this.curTable.rows[_this.calMaxCol(_this.curTable)].cells;\n\n            var actualwid = width - mouseX;\n            var totalwid = parseFloat(_this.columnEle.offsetWidth.toString()) + parseFloat(cellColl[_this.colIndex - 1].offsetWidth.toString());\n\n            for (var i = 0; i < _this.curTable.rows.length; i++) {\n              if (totalwid - actualwid > 20 && actualwid > 20) {\n                var leftColumnWidth = totalwid - actualwid;\n                var rightColWidth = actualwid;\n\n                if (!isNOU(_this.curTable.rows[i].cells[_this.colIndex - 1])) {\n                  _this.curTable.rows[i].cells[_this.colIndex - 1].style.width = _this.convertPixelToPercentage(leftColumnWidth, tableWidth) + '%';\n                }\n\n                if (!isNOU(_this.curTable.rows[i].cells[_this.colIndex])) {\n                  _this.curTable.rows[i].cells[_this.colIndex].style.width = _this.convertPixelToPercentage(rightColWidth, tableWidth) + '%';\n                }\n              }\n            }\n          }\n\n          _this.updateHelper();\n        } else if (_this.resizeBtnStat.row) {\n          _this.parent.preventDefaultResize(e);\n\n          var height = parseFloat(_this.rowEle.clientHeight.toString()) + mouseY;\n\n          if (height > 20) {\n            _this.rowEle.style.height = height + 'px';\n          }\n\n          _this.curTable.style.height = '';\n\n          if (!isNOU(tableReBox)) {\n            tableReBox.style.cssText = 'top: ' + (_this.calcPos(_this.curTable).top + tableHeight - 4) + 'px; left:' + (_this.calcPos(_this.curTable).left + tableWidth - 4) + 'px;';\n          }\n\n          _this.updateHelper();\n        } else if (_this.resizeBtnStat.tableBox) {\n          if (!Browser.isDevice) {\n            EventHandler.remove(_this.contentModule.getEditPanel(), 'mouseover', _this.resizeHelper);\n          }\n\n          var widthType = _this.curTable.style.width.indexOf('%') > -1;\n          _this.curTable.style.width = widthType ? _this.convertPixelToPercentage(tableWidth + mouseX, widthCompare) + '%' : tableWidth + mouseX + 'px';\n          _this.curTable.style.height = tableHeight + mouseY + 'px';\n          tableReBox.classList.add('e-rbox-select');\n          tableReBox.style.cssText = 'top: ' + (_this.calcPos(_this.curTable).top + tableHeight - 4) + 'px; left:' + (_this.calcPos(_this.curTable).left + tableWidth - 4) + 'px;';\n        }\n      }\n    });\n  };\n\n  Table.prototype.findFirstLastColCells = function (table, isFirst) {\n    var resultColumns = [];\n    var rows = table.querySelectorAll('tr');\n\n    for (var i = 0; i < rows.length; i++) {\n      if (rows[i].closest('table') === table) {\n        var columns = rows[i].querySelectorAll('th, td');\n        resultColumns.push(isFirst ? columns[0] : columns[columns.length - 1]);\n      }\n    }\n\n    return resultColumns;\n  };\n\n  Table.prototype.convertPixelToPercentage = function (value, offsetValue) {\n    return value / offsetValue * 100;\n  };\n\n  Table.prototype.cancelResizeAction = function () {\n    EventHandler.remove(this.contentModule.getDocument(), Browser.touchMoveEvent, this.resizing);\n    EventHandler.remove(this.contentModule.getDocument(), Browser.touchEndEvent, this.resizeEnd);\n    this.removeResizeElement();\n  };\n\n  Table.prototype.resizeEnd = function (e) {\n    this.resizeBtnInit();\n    EventHandler.remove(this.contentModule.getDocument(), Browser.touchMoveEvent, this.resizing);\n    EventHandler.remove(this.contentModule.getDocument(), Browser.touchEndEvent, this.resizeEnd);\n\n    if (this.contentModule.getEditPanel().querySelector('.e-table-box') && this.contentModule.getEditPanel().contains(this.contentModule.getEditPanel().querySelector('.e-table-box'))) {\n      if (!Browser.isDevice) {\n        EventHandler.add(this.contentModule.getEditPanel(), 'mouseover', this.resizeHelper, this);\n      }\n\n      this.removeResizeElement();\n    }\n\n    if (this.helper && this.contentModule.getEditPanel().contains(this.helper)) {\n      detach(this.helper);\n      this.helper = null;\n    }\n\n    this.pageX = null;\n    this.pageY = null;\n    this.moveEle = null;\n    var args = {\n      event: e,\n      requestType: 'table'\n    };\n    this.parent.trigger(events.resizeStop, args);\n    this.parent.formatter.saveData();\n  };\n\n  Table.prototype.resizeBtnInit = function () {\n    return this.resizeBtnStat = {\n      column: false,\n      row: false,\n      tableBox: false\n    };\n  };\n\n  Table.prototype.addRow = function (selectCell, e, tabkey) {\n    var cmd;\n\n    if (tabkey) {\n      cmd = {\n        item: {\n          command: 'Table',\n          subCommand: 'InsertRowAfter'\n        }\n      };\n    }\n\n    var value = {\n      selection: selectCell,\n      subCommand: tabkey ? cmd.item.subCommand : e.item.subCommand\n    };\n    this.parent.formatter.process(this.parent, tabkey ? cmd : e, e, value);\n  };\n\n  Table.prototype.addColumn = function (selectCell, e) {\n    this.parent.formatter.process(this.parent, e, e, {\n      selection: selectCell,\n      width: this.parent.tableSettings.width,\n      subCommand: e.item.subCommand\n    });\n  };\n\n  Table.prototype.removeRowColumn = function (selectCell, e) {\n    this.parent.formatter.process(this.parent, e, e, {\n      selection: selectCell,\n      subCommand: e.item.subCommand\n    });\n    this.hideTableQuickToolbar();\n  };\n\n  Table.prototype.removeTable = function (selection, args, delKey) {\n    var cmd;\n\n    if (delKey) {\n      cmd = {\n        item: {\n          command: 'Table',\n          subCommand: 'TableRemove'\n        }\n      };\n    }\n\n    var value = {\n      selection: selection,\n      subCommand: delKey ? cmd.item.subCommand : args.item.subCommand\n    };\n    this.parent.formatter.process(this.parent, delKey ? cmd : args, args.originalEvent, value);\n    this.contentModule.getEditPanel().focus();\n    this.removeResizeElement();\n    this.hideTableQuickToolbar();\n  };\n\n  Table.prototype.renderDlgContent = function (args) {\n    var _this = this;\n\n    if (Browser.isDevice || this.parent.inlineMode.enable) {\n      this.insertTableDialog(args);\n      return;\n    }\n\n    if (this.popupObj) {\n      this.popupObj.hide();\n      return;\n    }\n\n    this.hideTableQuickToolbar();\n    var header = '1X1';\n    var insertbtn = this.l10n.getConstant('inserttablebtn');\n    this.dlgDiv = this.parent.createElement('div', {\n      className: 'e-rte-table-popup' + ' ' + this.parent.cssClass,\n      id: this.rteID + '_table'\n    });\n    this.tblHeader = this.parent.createElement('div', {\n      className: 'e-rte-popup-header' + ' ' + this.parent.cssClass\n    });\n    this.tblHeader.innerHTML = header;\n    this.dlgDiv.appendChild(this.tblHeader);\n    var tableDiv = this.parent.createElement('div', {\n      className: 'e-rte-table-span' + ' ' + this.parent.cssClass\n    });\n    this.drawTable(tableDiv, args);\n    this.dlgDiv.appendChild(tableDiv);\n    this.dlgDiv.appendChild(this.parent.createElement('span', {\n      className: 'e-span-border' + ' ' + this.parent.cssClass\n    }));\n    var btnEle = this.parent.createElement('button', {\n      className: 'e-insert-table-btn' + ' ' + this.parent.cssClass,\n      id: this.rteID + '_insertTable',\n      attrs: {\n        type: 'button',\n        tabindex: '0'\n      }\n    });\n\n    if (!isNOU(this.parent.getToolbarElement().querySelector('.e-expended-nav'))) {\n      this.parent.getToolbarElement().querySelector('.e-expended-nav').setAttribute('tabindex', '1');\n    }\n\n    this.dlgDiv.appendChild(btnEle);\n    this.createTableButton = new Button({\n      iconCss: 'e-icons e-create-table',\n      content: insertbtn,\n      cssClass: 'e-flat' + ' ' + this.parent.cssClass,\n      enableRtl: this.parent.enableRtl,\n      locale: this.parent.locale\n    });\n    this.createTableButton.isStringTemplate = true;\n    this.createTableButton.appendTo(btnEle);\n    EventHandler.add(btnEle, 'click', this.insertTableDialog, {\n      self: this,\n      args: args.args,\n      selection: args.selection\n    });\n    this.parent.getToolbar().appendChild(this.dlgDiv);\n    var target = args.args.originalEvent.target;\n    target = target.classList.contains('e-toolbar-item') ? target.firstChild : target.parentElement;\n    this.popupObj = new Popup(this.dlgDiv, {\n      targetType: 'relative',\n      relateTo: target,\n      collision: {\n        X: 'fit',\n        Y: 'none'\n      },\n      offsetY: 8,\n      viewPortElement: this.parent.element,\n      position: {\n        X: 'left',\n        Y: 'bottom'\n      },\n      enableRtl: this.parent.enableRtl,\n      zIndex: 10001,\n      // eslint-disable-next-line\n      close: function (event) {\n        _this.parent.isBlur = false;\n\n        _this.popupObj.destroy();\n\n        detach(_this.popupObj.element);\n        _this.popupObj = null;\n      }\n    });\n    addClass([this.popupObj.element], 'e-popup-open');\n\n    if (!isNOU(this.parent.cssClass)) {\n      addClass([this.popupObj.element], this.parent.cssClass);\n    }\n\n    this.popupObj.refreshPosition(target);\n  };\n\n  Table.prototype.docClick = function (e) {\n    var target = e.args.target; // eslint-disable-next-line\n\n    if (target && target.classList && (this.popupObj && !closest(target, '[id=' + \"'\" + this.popupObj.element.id + \"'\" + ']') || this.editdlgObj && !closest(target, '#' + this.editdlgObj.element.id)) && !target.classList.contains('e-create-table') && target.offsetParent && !target.offsetParent.classList.contains('e-rte-backgroundcolor-dropdown')) {\n      if (this.popupObj) {\n        this.popupObj.hide();\n      }\n\n      if (this.editdlgObj) {\n        this.editdlgObj.hide();\n      }\n\n      this.parent.isBlur = true;\n      dispatchEvent(this.parent.element, 'focusout');\n    }\n\n    var closestEle = closest(target, 'td');\n    var isExist = closestEle && this.parent.contentModule.getEditPanel().contains(closestEle) ? true : false;\n\n    if (target && target.tagName !== 'TD' && target.tagName !== 'TH' && !isExist && closest(target, '.e-rte-quick-popup') === null && target.offsetParent && !target.offsetParent.classList.contains('e-quick-dropdown') && !target.offsetParent.classList.contains('e-rte-backgroundcolor-dropdown') && !closest(target, '.e-rte-dropdown-popup') && !closest(target, '.e-rte-elements')) {\n      removeClass(this.parent.inputElement.querySelectorAll('table td'), classes.CLS_TABLE_SEL);\n\n      if (!Browser.isIE) {\n        this.hideTableQuickToolbar();\n      }\n    }\n\n    if (target && target.classList && !target.classList.contains(classes.CLS_TB_COL_RES) && !target.classList.contains(classes.CLS_TB_ROW_RES) && !target.classList.contains(classes.CLS_TB_BOX_RES)) {\n      this.removeResizeElement();\n    }\n  };\n\n  Table.prototype.drawTable = function (tableDiv, args) {\n    var rowDiv;\n    var tableCell;\n\n    for (var row = 0; row < 3; row++) {\n      rowDiv = this.parent.createElement('div', {\n        className: 'e-rte-table-row' + ' ' + this.parent.cssClass,\n        attrs: {\n          'data-column': '' + row\n        }\n      });\n\n      for (var col = 0; col < 10; col++) {\n        var display = row > 2 ? 'none' : 'inline-block';\n        tableCell = this.parent.createElement('div', {\n          className: 'e-rte-tablecell e-default' + ' ' + this.parent.cssClass,\n          attrs: {\n            'data-cell': '' + col\n          }\n        });\n        rowDiv.appendChild(tableCell);\n        tableCell.style.display = display;\n\n        if (col === 0 && row === 0) {\n          addClass([tableCell], 'e-active');\n        }\n\n        EventHandler.add(tableCell, 'mousemove', this.tableCellSelect, this);\n        EventHandler.add(rowDiv, 'mouseleave', this.tableCellLeave, this);\n        EventHandler.add(tableCell, 'mouseup', this.tableCellClick, {\n          self: this,\n          args: args.args,\n          selection: args.selection\n        });\n      }\n\n      tableDiv.appendChild(rowDiv);\n    }\n  };\n\n  Table.prototype.editTable = function (args) {\n    var _this = this;\n\n    this.createDialog(args);\n    var editContent = this.tableDlgContent(args);\n    var update = this.l10n.getConstant('dialogUpdate');\n    var cancel = this.l10n.getConstant('dialogCancel');\n    var editHeader = this.l10n.getConstant('tableEditHeader');\n    this.editdlgObj.setProperties({\n      height: 'initial',\n      width: '290px',\n      content: editContent,\n      header: editHeader,\n      buttons: [{\n        click: this.applyProperties.bind(this, args),\n        buttonModel: {\n          content: update,\n          cssClass: 'e-flat e-size-update' + ' ' + this.parent.cssClass,\n          isPrimary: true\n        }\n      }, {\n        click: function (e) {\n          _this.cancelDialog(e);\n        },\n        buttonModel: {\n          cssClass: 'e-flat e-cancel' + ' ' + this.parent.cssClass,\n          content: cancel\n        }\n      }],\n      cssClass: this.editdlgObj.cssClass + ' e-rte-edit-table-prop-dialog'\n    });\n    this.editdlgObj.element.style.maxHeight = 'none';\n    this.editdlgObj.content.querySelector('input').focus();\n    this.hideTableQuickToolbar();\n  };\n\n  Table.prototype.insertTableDialog = function (args) {\n    var proxy = this.self ? this.self : this;\n\n    if (proxy.popupObj) {\n      proxy.popupObj.hide();\n    }\n\n    proxy.createDialog(args);\n    var dlgContent = proxy.tableCellDlgContent();\n    var insert = proxy.l10n.getConstant('dialogInsert');\n    var cancel = proxy.l10n.getConstant('dialogCancel');\n\n    if (isNullOrUndefined(proxy.editdlgObj)) {\n      return;\n    }\n\n    proxy.editdlgObj.setProperties({\n      height: 'initial',\n      width: '290px',\n      content: dlgContent,\n      buttons: [{\n        click: proxy.customTable.bind(this, args),\n        buttonModel: {\n          content: insert,\n          cssClass: 'e-flat e-insert-table' + ' ' + proxy.parent.cssClass,\n          isPrimary: true\n        }\n      }, {\n        click: function (e) {\n          proxy.cancelDialog(e);\n        },\n        buttonModel: {\n          cssClass: 'e-flat e-cancel' + ' ' + proxy.parent.cssClass,\n          content: cancel\n        }\n      }]\n    });\n\n    if (!isNOU(proxy.parent.cssClass)) {\n      proxy.editdlgObj.setProperties({\n        cssClass: proxy.parent.cssClass\n      });\n    }\n\n    proxy.editdlgObj.element.style.maxHeight = 'none';\n    proxy.editdlgObj.content.querySelector('input').focus();\n  };\n\n  Table.prototype.tableCellDlgContent = function () {\n    var tableColumn = this.l10n.getConstant('columns');\n    var tableRow = this.l10n.getConstant('rows');\n    var tableWrap = this.parent.createElement('div', {\n      className: 'e-cell-wrap' + ' ' + this.parent.cssClass\n    });\n    var content = '<div class=\"e-rte-field' + ' ' + this.parent.cssClass + '\"><input type=\"text\" ' + ' data-role =\"none\" id=\"tableColumn\" class=\"e-table-column' + ' ' + this.parent.cssClass + '\"/></div>' + '<div class=\"e-rte-field' + ' ' + this.parent.cssClass + '\"><input type=\"text\" data-role =\"none\" id=\"tableRow\" class=\"e-table-row' + ' ' + this.parent.cssClass + '\" /></div>';\n    var contentElem = parseHtml(content);\n    tableWrap.appendChild(contentElem);\n    this.columnTextBox = new NumericTextBox({\n      format: 'n0',\n      min: 1,\n      value: 3,\n      placeholder: tableColumn,\n      floatLabelType: 'Auto',\n      max: 50,\n      enableRtl: this.parent.enableRtl,\n      locale: this.parent.locale,\n      cssClass: this.parent.cssClass\n    });\n    this.columnTextBox.isStringTemplate = true;\n    this.columnTextBox.appendTo(tableWrap.querySelector('#tableColumn'));\n    this.rowTextBox = new NumericTextBox({\n      format: 'n0',\n      min: 1,\n      value: 3,\n      placeholder: tableRow,\n      floatLabelType: 'Auto',\n      max: 50,\n      enableRtl: this.parent.enableRtl,\n      locale: this.parent.locale,\n      cssClass: this.parent.cssClass\n    });\n    this.rowTextBox.isStringTemplate = true;\n    this.rowTextBox.appendTo(tableWrap.querySelector('#tableRow'));\n    return tableWrap;\n  };\n\n  Table.prototype.clearDialogObj = function () {\n    if (this.editdlgObj) {\n      this.editdlgObj.destroy();\n      detach(this.editdlgObj.element);\n      this.editdlgObj = null;\n    }\n  }; // eslint-disable-next-line\n\n\n  Table.prototype.createDialog = function (args) {\n    var _this = this;\n\n    if (this.editdlgObj) {\n      this.editdlgObj.hide({\n        returnValue: true\n      });\n      return;\n    }\n\n    var tableDialog = this.parent.createElement('div', {\n      className: 'e-rte-edit-table' + ' ' + this.parent.cssClass,\n      id: this.rteID + '_tabledialog'\n    });\n    this.parent.element.appendChild(tableDialog);\n    var insert = this.l10n.getConstant('dialogInsert');\n    var cancel = this.l10n.getConstant('dialogCancel');\n    var header = this.l10n.getConstant('tabledialogHeader');\n    var dialogModel = {\n      header: header,\n      cssClass: classes.CLS_RTE_ELEMENTS + ' ' + this.parent.cssClass,\n      enableRtl: this.parent.enableRtl,\n      locale: this.parent.locale,\n      showCloseIcon: true,\n      closeOnEscape: true,\n      width: Browser.isDevice ? '290px' : '340px',\n      height: 'initial',\n      position: {\n        X: 'center',\n        Y: Browser.isDevice ? 'center' : 'top'\n      },\n      isModal: Browser.isDevice,\n      buttons: [{\n        buttonModel: {\n          content: insert,\n          cssClass: 'e-flat e-insert-table' + ' ' + this.parent.cssClass,\n          isPrimary: true\n        }\n      }, {\n        click: function (e) {\n          _this.cancelDialog(e);\n        },\n        buttonModel: {\n          cssClass: 'e-flat e-cancel' + ' ' + this.parent.cssClass,\n          content: cancel\n        }\n      }],\n      target: Browser.isDevice ? document.body : this.parent.element,\n      animationSettings: {\n        effect: 'None'\n      },\n      close: function (event) {\n        _this.parent.isBlur = false;\n\n        _this.editdlgObj.destroy();\n\n        detach(_this.editdlgObj.element);\n\n        _this.dialogRenderObj.close(event);\n\n        _this.editdlgObj = null;\n      }\n    };\n    this.editdlgObj = this.dialogRenderObj.render(dialogModel);\n    this.editdlgObj.appendTo(tableDialog);\n\n    if (this.quickToolObj && this.quickToolObj.inlineQTBar && document.body.contains(this.quickToolObj.inlineQTBar.element)) {\n      this.quickToolObj.inlineQTBar.hidePopup();\n    }\n  };\n\n  Table.prototype.customTable = function (args, e) {\n    var proxy = this.self ? this.self : this;\n\n    if (proxy.rowTextBox.value && proxy.columnTextBox.value) {\n      var argument = Browser.isDevice || !isNullOrUndefined(args.args) && !isNullOrUndefined(args.args.originalEvent) && args.args.originalEvent.action === 'insert-table' || proxy.parent.inlineMode.enable ? args : this;\n      proxy.tableInsert(proxy.rowTextBox.value, proxy.columnTextBox.value, e, argument);\n    }\n  }; // eslint-disable-next-line\n\n\n  Table.prototype.cancelDialog = function (e) {\n    this.parent.isBlur = false;\n    this.editdlgObj.hide({\n      returnValue: true\n    });\n  }; // eslint-disable-next-line\n\n\n  Table.prototype.applyProperties = function (args, e) {\n    var dialogEle = this.editdlgObj.element;\n    var table = closest(args.selectNode[0], 'table');\n    table.style.width = dialogEle.querySelector('.e-table-width').value + 'px';\n\n    if (dialogEle.querySelector('.e-cell-padding').value !== '') {\n      var tdElm = table.querySelectorAll('td');\n\n      for (var i = 0; i < tdElm.length; i++) {\n        var padVal = '';\n\n        if (tdElm[i].style.padding === '') {\n          padVal = tdElm[i].getAttribute('style') + ' padding:' + dialogEle.querySelector('.e-cell-padding').value + 'px;';\n        } else {\n          tdElm[i].style.padding = dialogEle.querySelector('.e-cell-padding').value + 'px';\n          padVal = tdElm[i].getAttribute('style');\n        }\n\n        tdElm[i].setAttribute('style', padVal);\n      }\n    }\n\n    table.cellSpacing = dialogEle.querySelector('.e-cell-spacing').value;\n\n    if (!isNOU(table.cellSpacing) || table.cellSpacing !== '0') {\n      addClass([table], classes.CLS_TABLE_BORDER);\n    } else {\n      removeClass([table], classes.CLS_TABLE_BORDER);\n    }\n\n    this.parent.formatter.saveData();\n    this.editdlgObj.hide({\n      returnValue: true\n    });\n  };\n\n  Table.prototype.tableDlgContent = function (e) {\n    var selectNode = e.selectParent[0];\n    var tableWidth = this.l10n.getConstant('tableWidth');\n    var cellPadding = this.l10n.getConstant('cellpadding');\n    var cellSpacing = this.l10n.getConstant('cellspacing');\n    var tableWrap = this.parent.createElement('div', {\n      className: 'e-table-sizewrap' + ' ' + this.parent.cssClass\n    });\n    var widthVal = closest(selectNode, 'table').getClientRects()[0].width;\n    var padVal = closest(selectNode, 'td').style.padding;\n    var brdSpcVal = closest(selectNode, 'table').getAttribute('cellspacing');\n    var content = '<div class=\"e-rte-field' + ' ' + this.parent.cssClass + '\"><input type=\"text\" data-role =\"none\" id=\"tableWidth\" class=\"e-table-width' + ' ' + this.parent.cssClass + '\" ' + ' /></div>' + '<div class=\"e-rte-field' + ' ' + this.parent.cssClass + '\"><input type=\"text\" data-role =\"none\" id=\"cellPadding\" class=\"e-cell-padding' + ' ' + this.parent.cssClass + '\" />' + ' </div><div class=\"e-rte-field' + ' ' + this.parent.cssClass + '\"><input type=\"text\" data-role =\"none\" id=\"cellSpacing\" class=\"e-cell-spacing' + ' ' + this.parent.cssClass + '\" /></div>';\n    var contentElem = parseHtml(content);\n    tableWrap.appendChild(contentElem);\n    this.tableWidthNum = new NumericTextBox({\n      format: 'n0',\n      min: 0,\n      value: widthVal,\n      placeholder: tableWidth,\n      floatLabelType: 'Auto',\n      enableRtl: this.parent.enableRtl,\n      locale: this.parent.locale\n    });\n    this.tableWidthNum.isStringTemplate = true;\n    this.tableWidthNum.appendTo(tableWrap.querySelector('#tableWidth'));\n    this.tableCellPadding = new NumericTextBox({\n      format: 'n0',\n      min: 0,\n      // eslint-disable-next-line\n      value: padVal !== '' ? parseInt(padVal, null) : 0,\n      placeholder: cellPadding,\n      floatLabelType: 'Auto',\n      enableRtl: this.parent.enableRtl,\n      locale: this.parent.locale\n    });\n    this.tableCellPadding.isStringTemplate = true;\n    this.tableCellPadding.appendTo(tableWrap.querySelector('#cellPadding'));\n    this.tableCellSpacing = new NumericTextBox({\n      format: 'n0',\n      min: 0,\n      // eslint-disable-next-line\n      value: brdSpcVal !== '' && !isNOU(brdSpcVal) ? parseInt(brdSpcVal, null) : 0,\n      placeholder: cellSpacing,\n      floatLabelType: 'Auto',\n      enableRtl: this.parent.enableRtl,\n      locale: this.parent.locale\n    });\n    this.tableCellSpacing.isStringTemplate = true;\n    this.tableCellSpacing.appendTo(tableWrap.querySelector('#cellSpacing'));\n    return tableWrap;\n  };\n  /**\n   * Destroys the ToolBar.\n   *\n   * @function destroy\n   * @returns {void}\n   * @hidden\n    */\n\n\n  Table.prototype.destroy = function () {\n    this.removeEventListener();\n  };\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {void}\n   */\n\n\n  Table.prototype.getModuleName = function () {\n    return 'table';\n  };\n\n  return Table;\n}();\n\nexport { Table };","map":{"version":3,"names":["detach","closest","Browser","isNullOrUndefined","isNOU","EventHandler","addClass","removeClass","Popup","Button","events","RenderType","NumericTextBox","classes","dispatchEvent","parseHtml","hasClass","Table","parent","serviceLocator","ensureInsideTableList","pageX","pageY","moveEle","currentColumnResize","currentMarginLeft","rteID","element","id","l10n","getService","rendererFactory","dialogRenderObj","addEventListener","prototype","isDestroyed","on","createTable","renderDlgContent","initialEnd","afterRender","dynamicModule","showTableDialog","showDialog","closeTableDialog","closeDialog","docClick","editAreaClick","editAreaClickHandler","clearDialogObj","tableToolbarAction","onToolbarAction","dropDownSelect","dropdownSelect","keyDown","mouseUp","selectionTable","bindCssClass","setCssClass","destroy","removeEventListener","off","mouseDown","cellSelect","tableColorPickerChanged","setBGColor","updateCss","currentObj","e","cssClass","oldCssClass","setProperties","trim","replace","popupObj","createTableButton","editdlgObj","numericTextBoxObj","columnTextBox","rowTextBox","tableWidthNum","tableCellPadding","tableCellSpacing","i","length","target","args","info","name","tagName","contentModule","getEditPanel","setAttribute","getRenderer","Content","tableSettings","resize","add","touchStartEvent","resizeStart","isDevice","resizeHelper","item","document","body","contains","querySelector","command","range","formatter","editorManager","nodeSelection","getRange","getDocument","selection","save","selectParent","getParentNodeCollection","subCommand","addRow","addColumn","removeRowColumn","verticalAlign","tableStyles","UpdateCells","selectCell","process","hideTableQuickToolbar","event","proxy","action","openDialog","preventDefault","code","ele","parentElement","keyCode","ctrlKey","removeTable","querySelectorAll","removeResizeElement","closestTd","inputElement","tabSelection","tableArrowNavigation","isInternal","focus","editorMode","docElement","originalEvent","insertTableDialog","self","hide","returnValue","tableHeader","editTable","tdEle","tableCell","table","classList","CLS_TB_DASH_BOR","remove","CLS_TB_ALT_BOR","split","saveData","restore","insideList","blockNodes","domNode","nodes","parentNode","push","childNodes","startOffset","endOffset","startContainer","nodeType","CLS_TABLE_SEL","shiftKey","nextElement","nextSibling","nodeName","toLowerCase","rows","cells","textContent","setSelectionNode","setSelectionText","firstChild","prevElement","previousSibling","cellIndex","tHead","clsTble","selText","nextElementSibling","children","previousElementSibling","selectedCells","curTable","style","backgroundColor","value","quickToolObj","tableQTBar","hidePopup","readonly","showOnRightClick","quickToolbarSettings","which","quickToolbarModule","isPopupOpen","closestTable","startNode","endNode","endContainer","collapsed","range_1","Clear","iframeSettings","enable","window","pageYOffset","getBoundingClientRect","top","clientY","showPopup","tableCellSelect","row","Array","slice","call","indexOf","col","list","dlgDiv","forEach","parentIndex","tblHeader","innerHTML","tableMouseUp","tableMove","tableCellLeave","tableCellClick","tableInsert","selectionObj","ownerDocument","getPanel","columns","width","minWidth","maxWidth","tdNode","activeCell","helper","observer","notify","selectNode","targetTouches","removeHelper","cancelResizeAction","tableResizeEleCreation","preventDefaultResize","calMaxCol","height","parseInt","getComputedStyle","pos","calcPos","colReEle","createElement","attrs","toString","CLS_RTE_TABLE_RESIZE","CLS_TB_COL_RES","cssText","left","offsetWidth","appendChild","rowReEle","CLS_TB_ROW_RES","rowPosLeft","getAttribute","offsetHeight","tableReBox","className","CLS_TB_BOX_RES","elem","parentOffset","offset","doc","offsetParent","documentElement","isNestedTable","position","topValue","scrollTop","leftValue","scrollLeft","offsetTop","offsetLeft","getPointX","touches","getPointY","_this","resizeBtnInit","resizeBtnStat","column","columnEle","colIndex","appendHelper","rowEle","tableBox","requestType","trigger","resizeStartArgs","cancel","touchMoveEvent","resizing","touchEndEvent","resizeEnd","cls","setHelperHeight","updateHelper","top_1","max","maxRowIndex","mouseX","enableRtl","mouseY","onResize","resizingArgs","tableWidth","tableHeight","paddingSize","paddingRight","match","join","rteWidth","clientWidth","widthCompare","currentTd","currentTDPad","parseFloat","cellRow","currentTableWidth","currentColumnCellWidth","convertPixelToPercentage","firstColumnsCell","findFirstLastColCells","differenceWidth","marginLeft","lastColumnsCell","cellColl","actualwid","totalwid","leftColumnWidth","rightColWidth","clientHeight","widthType","isFirst","resultColumns","offsetValue","resizeStop","tabkey","cmd","delKey","inlineMode","header","insertbtn","getConstant","tableDiv","drawTable","btnEle","type","tabindex","getToolbarElement","iconCss","content","locale","isStringTemplate","appendTo","getToolbar","targetType","relateTo","collision","X","Y","offsetY","viewPortElement","zIndex","close","isBlur","refreshPosition","closestEle","isExist","isIE","rowDiv","display","createDialog","editContent","tableDlgContent","update","editHeader","buttons","click","applyProperties","bind","buttonModel","isPrimary","cancelDialog","maxHeight","dlgContent","tableCellDlgContent","insert","customTable","tableColumn","tableRow","tableWrap","contentElem","format","min","placeholder","floatLabelType","tableDialog","dialogModel","CLS_RTE_ELEMENTS","showCloseIcon","closeOnEscape","isModal","animationSettings","effect","render","inlineQTBar","argument","dialogEle","tdElm","padVal","padding","cellSpacing","CLS_TABLE_BORDER","cellPadding","widthVal","getClientRects","brdSpcVal","getModuleName"],"sources":["/home/morgan/Desktop/Projets/ENT4/Jwt-Auth-pdf/react-jwt-auth/react-jwt-auth/node_modules/@syncfusion/ej2-richtexteditor/src/rich-text-editor/renderer/table-module.js"],"sourcesContent":["import { detach, closest, Browser, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, EventHandler, addClass, removeClass } from '@syncfusion/ej2-base';\nimport { Popup } from '@syncfusion/ej2-popups';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport * as events from '../base/constant';\nimport { RenderType } from '../base/enum';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport * as classes from '../base/classes';\nimport { dispatchEvent, parseHtml, hasClass } from '../base/util';\n/**\n * `Table` module is used to handle table actions.\n */\nvar Table = /** @class */ (function () {\n    function Table(parent, serviceLocator) {\n        this.ensureInsideTableList = true;\n        this.pageX = null;\n        this.pageY = null;\n        this.moveEle = null;\n        this.currentColumnResize = '';\n        this.currentMarginLeft = 0;\n        this.parent = parent;\n        this.rteID = parent.element.id;\n        this.l10n = serviceLocator.getService('rteLocale');\n        this.rendererFactory = serviceLocator.getService('rendererFactory');\n        this.dialogRenderObj = serviceLocator.getService('dialogRenderObject');\n        this.addEventListener();\n    }\n    Table.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.createTable, this.renderDlgContent, this);\n        this.parent.on(events.initialEnd, this.afterRender, this);\n        this.parent.on(events.dynamicModule, this.afterRender, this);\n        this.parent.on(events.showTableDialog, this.showDialog, this);\n        this.parent.on(events.closeTableDialog, this.closeDialog, this);\n        this.parent.on(events.docClick, this.docClick, this);\n        this.parent.on(events.editAreaClick, this.editAreaClickHandler, this);\n        this.parent.on(events.clearDialogObj, this.clearDialogObj, this);\n        this.parent.on(events.tableToolbarAction, this.onToolbarAction, this);\n        this.parent.on(events.dropDownSelect, this.dropdownSelect, this);\n        this.parent.on(events.keyDown, this.keyDown, this);\n        this.parent.on(events.mouseUp, this.selectionTable, this);\n        this.parent.on(events.bindCssClass, this.setCssClass, this);\n        this.parent.on(events.destroy, this.destroy, this);\n    };\n    Table.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.createTable, this.renderDlgContent);\n        this.parent.off(events.initialEnd, this.afterRender);\n        this.parent.off(events.dynamicModule, this.afterRender);\n        this.parent.off(events.docClick, this.docClick);\n        this.parent.off(events.showTableDialog, this.showDialog);\n        this.parent.off(events.closeTableDialog, this.closeDialog);\n        this.parent.off(events.editAreaClick, this.editAreaClickHandler);\n        this.parent.off(events.clearDialogObj, this.clearDialogObj);\n        this.parent.off(events.tableToolbarAction, this.onToolbarAction);\n        this.parent.off(events.dropDownSelect, this.dropdownSelect);\n        this.parent.off(events.mouseDown, this.cellSelect);\n        this.parent.off(events.tableColorPickerChanged, this.setBGColor);\n        this.parent.off(events.keyDown, this.keyDown);\n        this.parent.off(events.mouseUp, this.selectionTable);\n        this.parent.off(events.bindCssClass, this.setCssClass);\n        this.parent.off(events.destroy, this.destroy);\n    };\n    Table.prototype.updateCss = function (currentObj, e) {\n        if (currentObj && e.cssClass) {\n            if (isNullOrUndefined(e.oldCssClass)) {\n                currentObj.setProperties({ cssClass: (currentObj.cssClass + ' ' + e.cssClass).trim() });\n            }\n            else {\n                currentObj.setProperties({ cssClass: (currentObj.cssClass.replace(e.oldCssClass, '').trim() + ' ' + e.cssClass).trim() });\n            }\n        }\n    };\n    Table.prototype.setCssClass = function (e) {\n        if (this.popupObj && e.cssClass) {\n            if (isNullOrUndefined(e.oldCssClass)) {\n                addClass([this.popupObj.element], e.cssClass);\n            }\n            else {\n                removeClass([this.popupObj.element], e.oldCssClass);\n                addClass([this.popupObj.element], e.cssClass);\n            }\n        }\n        this.updateCss(this.createTableButton, e);\n        this.updateCss(this.editdlgObj, e);\n        var numericTextBoxObj = [\n            this.columnTextBox, this.rowTextBox, this.tableWidthNum, this.tableCellPadding, this.tableCellSpacing\n        ];\n        for (var i = 0; i < numericTextBoxObj.length; i++) {\n            this.updateCss(numericTextBoxObj[i], e);\n        }\n    };\n    Table.prototype.selectionTable = function (e) {\n        var target = e.args.target;\n        if (Browser.info.name === 'mozilla' && !isNOU(closest(target, 'table')) && closest(target, 'table').tagName === 'TABLE') {\n            this.parent.contentModule.getEditPanel().setAttribute('contenteditable', 'true');\n        }\n    };\n    Table.prototype.afterRender = function () {\n        if (isNullOrUndefined(this.contentModule)) {\n            this.contentModule = this.rendererFactory.getRenderer(RenderType.Content);\n            this.parent.on(events.tableColorPickerChanged, this.setBGColor, this);\n            this.parent.on(events.mouseDown, this.cellSelect, this);\n            if (this.parent.tableSettings.resize) {\n                EventHandler.add(this.parent.contentModule.getEditPanel(), Browser.touchStartEvent, this.resizeStart, this);\n            }\n            if (!Browser.isDevice && this.parent.tableSettings.resize) {\n                EventHandler.add(this.contentModule.getEditPanel(), 'mouseover', this.resizeHelper, this);\n            }\n        }\n    };\n    Table.prototype.dropdownSelect = function (e) {\n        var item = e.item;\n        if (!document.body.contains(document.body.querySelector('.e-rte-quick-toolbar')) || item.command !== 'Table') {\n            return;\n        }\n        var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n        var args = {\n            args: e,\n            selection: this.parent.formatter.editorManager.nodeSelection.save(range, this.contentModule.getDocument()),\n            selectParent: this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range)\n        };\n        switch (item.subCommand) {\n            case 'InsertRowBefore':\n            case 'InsertRowAfter':\n                this.addRow(args.selection, e);\n                break;\n            case 'InsertColumnLeft':\n            case 'InsertColumnRight':\n                this.addColumn(args.selection, e);\n                break;\n            case 'DeleteColumn':\n            case 'DeleteRow':\n                this.removeRowColumn(args.selection, e);\n                break;\n            case 'AlignTop':\n            case 'AlignMiddle':\n            case 'AlignBottom':\n                this.verticalAlign(args, e);\n                break;\n            case 'Dashed':\n            case 'Alternate':\n            case 'Custom':\n                this.tableStyles(args, item.subCommand);\n                break;\n            case 'Merge':\n            case 'VerticalSplit':\n            case 'HorizontalSplit':\n                this.UpdateCells(args.selection, e);\n                break;\n        }\n    };\n    Table.prototype.UpdateCells = function (selectCell, e) {\n        this.parent.formatter.process(this.parent, e, e, { selection: selectCell, subCommand: e.item.subCommand });\n        this.hideTableQuickToolbar();\n    };\n    Table.prototype.keyDown = function (e) {\n        var event = e.args;\n        // eslint-disable-next-line\n        var proxy = this;\n        switch (event.action) {\n            case 'escape':\n                break;\n            case 'insert-table':\n                this.openDialog(true, e);\n                event.preventDefault();\n                break;\n        }\n        if (!isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection) && this.contentModule\n            && event.code !== 'KeyK') {\n            var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n            var selection = this.parent.formatter.editorManager.\n                nodeSelection.save(range, this.contentModule.getDocument());\n            var ele = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range)[0];\n            ele = (ele && ele.tagName !== 'TD' && ele.tagName !== 'TH') ? ele.parentElement : ele;\n            if ((event.keyCode === 8 || event.keyCode === 46) ||\n                (event.ctrlKey && event.keyCode === 88)) {\n                if (ele && ele.tagName === 'TBODY') {\n                    event.preventDefault();\n                    proxy.removeTable(selection, event, true);\n                }\n                else if (ele && ele.querySelectorAll('table').length > 0) {\n                    this.removeResizeElement();\n                    this.hideTableQuickToolbar();\n                }\n            }\n            if (ele && ele.tagName !== 'TD' && ele.tagName !== 'TH') {\n                var closestTd = closest(ele, 'td');\n                ele = !isNullOrUndefined(closestTd) && this.parent.inputElement.contains(closestTd) ? closestTd : ele;\n            }\n            if (ele && (ele.tagName === 'TD' || ele.tagName === 'TH')) {\n                switch (event.keyCode) {\n                    case 9:\n                    case 37:\n                    case 39:\n                        proxy.tabSelection(event, selection, ele);\n                        break;\n                    case 40:\n                    case 38:\n                        proxy.tableArrowNavigation(event, selection, ele);\n                        break;\n                }\n            }\n        }\n    };\n    Table.prototype.openDialog = function (isInternal, e) {\n        if (!isInternal) {\n            this.parent.contentModule.getEditPanel().focus();\n        }\n        if (this.parent.editorMode === 'HTML') {\n            var docElement = this.parent.contentModule.getDocument();\n            var range = this.parent.formatter.editorManager.nodeSelection.getRange(docElement);\n            var selection = this.parent.formatter.editorManager.nodeSelection.save(range, docElement);\n            var args = {\n                originalEvent: e ? e.args : { action: 'insert-table' },\n                item: {\n                    command: 'Table',\n                    subCommand: 'CreateTable'\n                }\n            };\n            this.insertTableDialog({ self: this, args: args, selection: selection });\n        }\n    };\n    Table.prototype.showDialog = function () {\n        this.openDialog(false);\n        this.setCssClass({ cssClass: this.parent.cssClass });\n    };\n    Table.prototype.closeDialog = function () {\n        if (this.editdlgObj) {\n            this.editdlgObj.hide({ returnValue: true });\n        }\n    };\n    Table.prototype.onToolbarAction = function (args) {\n        var item = args.args.item;\n        switch (item.subCommand) {\n            case 'TableHeader':\n                this.tableHeader(args.selection, args.args);\n                break;\n            case 'TableRemove':\n                this.removeTable(args.selection, args.args);\n                break;\n            case 'TableEditProperties':\n                this.editTable(args);\n                break;\n        }\n    };\n    Table.prototype.verticalAlign = function (args, e) {\n        var tdEle = closest(args.selectParent[0], 'td') || closest(args.selectParent[0], 'th');\n        if (tdEle) {\n            this.parent.formatter.process(this.parent, e, e, { tableCell: tdEle, subCommand: e.item.subCommand });\n        }\n    };\n    Table.prototype.tableStyles = function (args, command) {\n        var table = closest(args.selectParent[0], 'table');\n        if (command === 'Dashed') {\n            /* eslint-disable */\n            (this.parent.element.classList.contains(classes.CLS_TB_DASH_BOR)) ?\n                this.parent.element.classList.remove(classes.CLS_TB_DASH_BOR) : this.parent.element.classList.add(classes.CLS_TB_DASH_BOR);\n            (table.classList.contains(classes.CLS_TB_DASH_BOR)) ? table.classList.remove(classes.CLS_TB_DASH_BOR) :\n                table.classList.add(classes.CLS_TB_DASH_BOR);\n        }\n        if (command === 'Alternate') {\n            (this.parent.element.classList.contains(classes.CLS_TB_ALT_BOR)) ?\n                this.parent.element.classList.remove(classes.CLS_TB_ALT_BOR) : this.parent.element.classList.add(classes.CLS_TB_ALT_BOR);\n            (table.classList.contains(classes.CLS_TB_ALT_BOR)) ? table.classList.remove(classes.CLS_TB_ALT_BOR) :\n                table.classList.add(classes.CLS_TB_ALT_BOR);\n            /* eslint-enable */\n        }\n        if (args.args && args.args.item.cssClass) {\n            var classList = args.args.item.cssClass.split(' ');\n            for (var i = 0; i < classList.length; i++) {\n                if (table.classList.contains(classList[i])) {\n                    table.classList.remove(classList[i]);\n                }\n                else {\n                    table.classList.add(classList[i]);\n                }\n            }\n        }\n        this.parent.formatter.saveData();\n        this.parent.formatter.editorManager.nodeSelection.restore();\n    };\n    Table.prototype.insideList = function (range) {\n        var blockNodes = this.parent.formatter.editorManager.domNode.blockNodes();\n        var nodes = [];\n        for (var i = 0; i < blockNodes.length; i++) {\n            if (blockNodes[i].parentNode.tagName === 'LI') {\n                nodes.push(blockNodes[i].parentNode);\n            }\n            else if (blockNodes[i].tagName === 'LI' && blockNodes[i].childNodes[0].tagName !== 'P' &&\n                (blockNodes[i].childNodes[0].tagName !== 'OL' &&\n                    blockNodes[i].childNodes[0].tagName !== 'UL')) {\n                nodes.push(blockNodes[i]);\n            }\n        }\n        if (nodes.length > 1 || nodes.length && ((range.startOffset === 0 && range.endOffset === 0))) {\n            this.ensureInsideTableList = true;\n            return true;\n        }\n        else {\n            this.ensureInsideTableList = false;\n            return false;\n        }\n    };\n    Table.prototype.tabSelection = function (event, selection, ele) {\n        var insideList = this.insideList(selection.range);\n        if ((event.keyCode === 37 || event.keyCode === 39) && selection.range.startContainer.nodeType === 3 ||\n            insideList) {\n            return;\n        }\n        event.preventDefault();\n        ele.classList.remove(classes.CLS_TABLE_SEL);\n        if (!event.shiftKey && event.keyCode !== 37) {\n            var nextElement = (!isNullOrUndefined(ele.nextSibling)) ? ele.nextSibling :\n                (!isNullOrUndefined(closest(ele, 'tr').nextSibling) ? closest(ele, 'tr').nextSibling.childNodes[0] :\n                    (!isNullOrUndefined(closest(ele, 'table').nextSibling)) ?\n                        (closest(ele, 'table').nextSibling.nodeName.toLowerCase() === 'td') ?\n                            closest(ele, 'table').nextSibling : ele : ele);\n            if (ele === nextElement && ele.nodeName === 'TH') {\n                nextElement = closest(ele, 'table').rows[1].cells[0];\n            }\n            if (event.keyCode === 39 && ele === nextElement) {\n                nextElement = closest(ele, 'table').nextSibling;\n            }\n            if (nextElement) {\n                // eslint-disable-next-line\n                (nextElement.textContent.trim() !== '' && closest(nextElement, 'td')) ?\n                    selection.setSelectionNode(this.contentModule.getDocument(), nextElement) :\n                    selection.setSelectionText(this.contentModule.getDocument(), nextElement, nextElement, 0, 0);\n            }\n            if (ele === nextElement && event.keyCode !== 39 && nextElement) {\n                ele.classList.add(classes.CLS_TABLE_SEL);\n                this.addRow(selection, event, true);\n                ele.classList.remove(classes.CLS_TABLE_SEL);\n                nextElement = nextElement.parentElement.nextSibling ? nextElement.parentElement.nextSibling.firstChild : nextElement.parentElement.firstChild;\n                // eslint-disable-next-line\n                (nextElement.textContent.trim() !== '' && closest(nextElement, 'td')) ?\n                    selection.setSelectionNode(this.contentModule.getDocument(), nextElement) :\n                    selection.setSelectionText(this.contentModule.getDocument(), nextElement, nextElement, 0, 0);\n            }\n        }\n        else {\n            var prevElement = (!isNullOrUndefined(ele.previousSibling)) ? ele.previousSibling :\n                (!isNullOrUndefined(closest(ele, 'tr').previousSibling) ?\n                    closest(ele, 'tr').previousSibling.childNodes[closest(ele, 'tr').previousSibling.childNodes.length - 1] :\n                    (!isNullOrUndefined(closest(ele, 'table').previousSibling)) ?\n                        (closest(ele, 'table').previousSibling.nodeName.toLowerCase() === 'td') ? closest(ele, 'table').previousSibling :\n                            ele : ele);\n            if (ele === prevElement && ele.cellIndex === 0 &&\n                closest(ele, 'table').tHead) {\n                var clsTble = closest(ele, 'table');\n                prevElement = clsTble.rows[0].cells[clsTble.rows[0].cells.length - 1];\n            }\n            if (event.keyCode === 37 && ele === prevElement) {\n                prevElement = closest(ele, 'table').previousSibling;\n            }\n            if (prevElement) {\n                // eslint-disable-next-line\n                (prevElement.textContent.trim() !== '' && closest(prevElement, 'td')) ?\n                    selection.setSelectionNode(this.contentModule.getDocument(), prevElement) :\n                    selection.setSelectionText(this.contentModule.getDocument(), prevElement, prevElement, 0, 0);\n            }\n        }\n    };\n    Table.prototype.tableArrowNavigation = function (event, selection, ele) {\n        var selText = selection.range.startContainer;\n        if ((event.keyCode === 40 && selText.nodeType === 3 && (selText.nextSibling && selText.nextSibling.nodeName === 'BR' ||\n            selText.parentNode && selText.parentNode.nodeName !== 'TD')) ||\n            (event.keyCode === 38 && selText.nodeType === 3 && (selText.previousSibling && selText.previousSibling.nodeName === 'BR' ||\n                selText.parentNode && selText.parentNode.nodeName !== 'TD'))) {\n            return;\n        }\n        event.preventDefault();\n        ele.classList.remove(classes.CLS_TABLE_SEL);\n        if (event.keyCode === 40) {\n            ele = (!isNullOrUndefined(closest(ele, 'tr').nextElementSibling)) ?\n                closest(ele, 'tr').nextElementSibling.children[ele.cellIndex] :\n                (closest(ele, 'table').tHead && ele.nodeName === 'TH') ?\n                    closest(ele, 'table').rows[1].cells[ele.cellIndex] :\n                    (!isNullOrUndefined(closest(ele, 'table').nextSibling)) ? closest(ele, 'table').nextSibling :\n                        ele;\n        }\n        else {\n            ele = (!isNullOrUndefined(closest(ele, 'tr').previousElementSibling)) ?\n                closest(ele, 'tr').previousElementSibling.children[ele.cellIndex] :\n                (closest(ele, 'table').tHead && ele.nodeName !== 'TH') ?\n                    closest(ele, 'table').tHead.rows[0].cells[ele.cellIndex] :\n                    (!isNullOrUndefined(closest(ele, 'table').previousSibling)) ? closest(ele, 'table').previousSibling :\n                        ele;\n        }\n        if (ele) {\n            selection.setSelectionText(this.contentModule.getDocument(), ele, ele, 0, 0);\n        }\n    };\n    Table.prototype.setBGColor = function (args) {\n        var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument());\n        // eslint-disable-next-line\n        var selection = this.parent.formatter.editorManager.nodeSelection.save(range, this.contentModule.getDocument());\n        // eslint-disable-next-line\n        var selectedCells = this.curTable.querySelectorAll('.e-cell-select');\n        for (var i = 0; i < selectedCells.length; i++) {\n            selectedCells[i].style.backgroundColor = args.item.value;\n        }\n        this.parent.formatter.saveData();\n    };\n    Table.prototype.hideTableQuickToolbar = function () {\n        if (this.quickToolObj && this.quickToolObj.tableQTBar && document.body.contains(this.quickToolObj.tableQTBar.element)) {\n            this.quickToolObj.tableQTBar.hidePopup();\n        }\n    };\n    Table.prototype.tableHeader = function (selection, e) {\n        this.parent.formatter.process(this.parent, e, e.originalEvent, { selection: selection, subCommand: e.item.subCommand });\n    };\n    Table.prototype.editAreaClickHandler = function (e) {\n        if (this.parent.readonly || !isNOU(closest(e.args.target, '.e-img-caption'))) {\n            return;\n        }\n        var args = e.args;\n        var showOnRightClick = this.parent.quickToolbarSettings.showOnRightClick;\n        if (args.which === 2 || (showOnRightClick && args.which === 1) || (!showOnRightClick && args.which === 3)) {\n            return;\n        }\n        if (this.parent.editorMode === 'HTML' && this.parent.quickToolbarModule && this.parent.quickToolbarModule.tableQTBar) {\n            this.quickToolObj = this.parent.quickToolbarModule;\n            var target = args.target;\n            this.contentModule = this.rendererFactory.getRenderer(RenderType.Content);\n            var isPopupOpen = this.quickToolObj.tableQTBar.element.classList.contains('e-rte-pop');\n            if (isPopupOpen) {\n                return;\n            }\n            var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument());\n            var closestTable = closest(target, 'table');\n            var startNode = this.parent.getRange().startContainer.parentElement;\n            var endNode = this.parent.getRange().endContainer.parentElement;\n            if (target && target.nodeName !== 'A' && target.nodeName !== 'IMG' && startNode === endNode && (target.nodeName === 'TD' || target.nodeName === 'TH' ||\n                target.nodeName === 'TABLE' || (closestTable && this.parent.contentModule.getEditPanel().contains(closestTable)))\n                && !(range.startContainer.nodeType === 3 && !range.collapsed)) {\n                var range_1 = this.parent.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument());\n                this.parent.formatter.editorManager.nodeSelection.save(range_1, this.contentModule.getDocument());\n                this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument());\n                var pageY = (this.parent.iframeSettings.enable) ? window.pageYOffset +\n                    this.parent.element.getBoundingClientRect().top + args.clientY : args.pageY;\n                this.quickToolObj.tableQTBar.showPopup(args.pageX, pageY, target);\n                this.parent.formatter.editorManager.nodeSelection.restore();\n            }\n            else {\n                this.hideTableQuickToolbar();\n            }\n        }\n    };\n    Table.prototype.tableCellSelect = function (e) {\n        var target = e.target;\n        var row = Array.prototype.slice.call(target.parentElement.parentElement.children).indexOf(target.parentElement);\n        var col = Array.prototype.slice.call(target.parentElement.children).indexOf(target);\n        var list = this.dlgDiv.querySelectorAll('.e-rte-tablecell');\n        Array.prototype.forEach.call(list, function (item) {\n            var parentIndex = Array.prototype.slice.call(item.parentElement.parentElement.children).indexOf(item.parentElement);\n            var cellIndex = Array.prototype.slice.call(item.parentElement.children).indexOf(item);\n            removeClass([item], 'e-active');\n            if (parentIndex <= row && cellIndex <= col) {\n                addClass([item], 'e-active');\n            }\n        });\n        this.tblHeader.innerHTML = (col + 1) + 'x' + (row + 1);\n    };\n    // eslint-disable-next-line\n    Table.prototype.tableMouseUp = function (e) {\n        EventHandler.remove(this.curTable, 'mousemove', this.tableMove);\n    };\n    // eslint-disable-next-line\n    Table.prototype.tableCellLeave = function (e) {\n        removeClass(this.dlgDiv.querySelectorAll('.e-rte-tablecell'), 'e-active');\n        addClass([this.dlgDiv.querySelector('.e-rte-tablecell')], 'e-active');\n        this.tblHeader.innerHTML = 1 + 'x' + 1;\n    };\n    Table.prototype.tableCellClick = function (e) {\n        var target = e.target;\n        var row = Array.prototype.slice.call(target.parentElement.parentElement.children).indexOf(target.parentElement) + 1;\n        var col = Array.prototype.slice.call(target.parentElement.children).indexOf(target) + 1;\n        this.self.tableInsert(row, col, e, this);\n    };\n    Table.prototype.tableInsert = function (row, col, e, selectionObj) {\n        var proxy = (selectionObj.self) ? selectionObj.self : this;\n        var startContainer = selectionObj.selection.range.startContainer;\n        if (startContainer.nodeName === 'P' && startContainer.textContent.trim() === '' && !(startContainer.childNodes.length > 0)) {\n            startContainer.innerHTML = '<br />';\n        }\n        var parentNode = startContainer.parentNode;\n        if (proxy.parent.editorMode === 'HTML' &&\n            ((proxy.parent.iframeSettings.enable && !hasClass(parentNode.ownerDocument.querySelector('body'), 'e-lib')) ||\n                // eslint-disable-next-line\n                (!proxy.parent.iframeSettings.enable && isNOU(closest(parentNode, '[id=' + \"'\" + proxy.contentModule.getPanel().id + \"'\" + ']'))))) {\n            proxy.contentModule.getEditPanel().focus();\n            var range = proxy.parent.formatter.editorManager.nodeSelection.getRange(proxy.contentModule.getDocument());\n            selectionObj.selection = proxy.parent.formatter.editorManager.nodeSelection.save(range, proxy.contentModule.getDocument());\n        }\n        var value = {\n            rows: row, columns: col, width: {\n                minWidth: proxy.parent.tableSettings.minWidth,\n                maxWidth: proxy.parent.tableSettings.maxWidth,\n                width: proxy.parent.tableSettings.width\n            },\n            selection: selectionObj.selection\n        };\n        if (proxy.popupObj) {\n            proxy.popupObj.hide();\n        }\n        if (proxy.editdlgObj) {\n            proxy.editdlgObj.hide();\n        }\n        proxy.parent.formatter.process(proxy.parent, selectionObj.args, selectionObj.args.originalEvent, value);\n        proxy.contentModule.getEditPanel().focus();\n        proxy.parent.on(events.mouseDown, proxy.cellSelect, proxy);\n    };\n    Table.prototype.cellSelect = function (e) {\n        var target = e.args.target;\n        var tdNode = closest(target, 'td,th');\n        target = (target.nodeName !== 'TD' && tdNode && this.parent.contentModule.getEditPanel().contains(tdNode)) ?\n            tdNode : target;\n        removeClass(this.contentModule.getEditPanel().querySelectorAll('table td, table th'), classes.CLS_TABLE_SEL);\n        if (target && (target.tagName === 'TD' || target.tagName === 'TH')) {\n            addClass([target], classes.CLS_TABLE_SEL);\n            this.activeCell = target;\n            this.curTable = (this.curTable) ? this.curTable : closest(target, 'table');\n            EventHandler.add(this.curTable, 'mousemove', this.tableMove, this);\n            EventHandler.add(this.curTable, 'mouseup', this.tableMouseUp, this);\n            this.removeResizeElement();\n            if (this.helper && this.contentModule.getEditPanel().contains(this.helper)) {\n                detach(this.helper);\n            }\n        }\n        if (Browser.info.name === 'mozilla' && !isNOU(closest(target, 'table')) &&\n            closest(target, 'table').tagName === 'TABLE') {\n            this.parent.contentModule.getEditPanel().setAttribute('contenteditable', 'false');\n        }\n    };\n    Table.prototype.tableMove = function (event) {\n        this.parent.formatter.editorManager.observer.notify('TABLE_MOVE', { event: event, selectNode: [this.activeCell] });\n    };\n    Table.prototype.resizeHelper = function (e) {\n        if (this.parent.readonly) {\n            return;\n        }\n        var target = e.target || e.targetTouches[0].target;\n        var closestTable = closest(target, 'table.e-rte-table');\n        if (!isNOU(this.curTable) && !isNOU(closestTable) && closestTable !== this.curTable) {\n            this.removeResizeElement();\n            this.removeHelper(e);\n            this.cancelResizeAction();\n        }\n        if (target.nodeName === 'TABLE' || target.nodeName === 'TD' || target.nodeName === 'TH') {\n            this.curTable = (closestTable && this.parent.contentModule.getEditPanel().contains(closestTable))\n                && (target.nodeName === 'TD' || target.nodeName === 'TH') ?\n                closestTable : target;\n            this.removeResizeElement();\n            this.tableResizeEleCreation(this.curTable, e);\n        }\n    };\n    Table.prototype.tableResizeEleCreation = function (table, e) {\n        this.parent.preventDefaultResize(e);\n        var columns = table.rows[this.calMaxCol(table)].cells;\n        var rows = [];\n        for (var i = 0; i < table.rows.length; i++) {\n            rows.push(Array.prototype.slice.call(table.rows[i].cells, 0, 1)[0]);\n        }\n        var height = parseInt(getComputedStyle(table).height, 10);\n        var width = parseInt(getComputedStyle(table).width, 10);\n        var pos = this.calcPos(table);\n        for (var i = 0; columns.length >= i; i++) {\n            var colReEle = this.parent.createElement('span', {\n                attrs: {\n                    'data-col': (i).toString(), 'unselectable': 'on', 'contenteditable': 'false'\n                }\n            });\n            colReEle.classList.add(classes.CLS_RTE_TABLE_RESIZE, classes.CLS_TB_COL_RES);\n            if (columns.length === i) {\n                colReEle.style.cssText = 'height: ' + height + 'px; width: 4px; top: ' + pos.top +\n                    'px; left:' + (pos.left + this.calcPos(columns[i - 1]).left + columns[i - 1].offsetWidth) + 'px;';\n            }\n            else {\n                colReEle.style.cssText = 'height: ' + height + 'px; width: 4px; top: ' + pos.top +\n                    'px; left:' + (pos.left + this.calcPos(columns[i]).left) + 'px;';\n            }\n            this.contentModule.getEditPanel().appendChild(colReEle);\n        }\n        for (var i = 0; rows.length > i; i++) {\n            var rowReEle = this.parent.createElement('span', {\n                attrs: {\n                    'data-row': (i).toString(), 'unselectable': 'on', 'contenteditable': 'false'\n                }\n            });\n            rowReEle.classList.add(classes.CLS_RTE_TABLE_RESIZE, classes.CLS_TB_ROW_RES);\n            var rowPosLeft = !isNOU(table.getAttribute('cellspacing')) || table.getAttribute('cellspacing') !== '' ?\n                0 : this.calcPos(rows[i]).left;\n            rowReEle.style.cssText = 'width: ' + width + 'px; height: 4px; top: ' +\n                (this.calcPos(rows[i]).top + pos.top + rows[i].offsetHeight - 2) +\n                'px; left:' + (rowPosLeft + pos.left) + 'px;';\n            this.contentModule.getEditPanel().appendChild(rowReEle);\n        }\n        var tableReBox = this.parent.createElement('span', {\n            className: classes.CLS_TB_BOX_RES + ' ' + this.parent.cssClass, attrs: {\n                'data-col': columns.length.toString(), 'unselectable': 'on', 'contenteditable': 'false'\n            }\n        });\n        tableReBox.style.cssText = 'top: ' + (pos.top + height - 4) +\n            'px; left:' + (pos.left + width - 4) + 'px;';\n        if (Browser.isDevice) {\n            tableReBox.classList.add('e-rmob');\n        }\n        this.contentModule.getEditPanel().appendChild(tableReBox);\n    };\n    Table.prototype.removeResizeElement = function () {\n        var item = this.parent.contentModule.getEditPanel().\n            querySelectorAll('.e-column-resize, .e-row-resize, .e-table-box');\n        if (item.length > 0) {\n            for (var i = 0; i < item.length; i++) {\n                detach(item[i]);\n            }\n        }\n    };\n    Table.prototype.calcPos = function (elem) {\n        var parentOffset = {\n            top: 0,\n            left: 0\n        };\n        // eslint-disable-next-line\n        var offset = elem.getBoundingClientRect();\n        var doc = elem.ownerDocument;\n        var offsetParent = elem.offsetParent || doc.documentElement;\n        var isNestedTable = false;\n        while (offsetParent &&\n            (offsetParent === doc.body || offsetParent === doc.documentElement) &&\n            offsetParent.style.position === 'static') {\n            offsetParent = offsetParent.parentNode;\n        }\n        if (offsetParent.nodeName === 'TD' && elem.nodeName === 'TABLE') {\n            offsetParent = closest(offsetParent, '.e-rte-content');\n            isNestedTable = true;\n        }\n        if (offsetParent && offsetParent !== elem && offsetParent.nodeType === 1) {\n            // eslint-disable-next-line\n            parentOffset = offsetParent.getBoundingClientRect();\n        }\n        if (isNestedTable) {\n            isNestedTable = false;\n            var topValue = this.parent.inputElement && this.parent.inputElement.scrollTop > 0 ?\n                (this.parent.inputElement.scrollTop + offset.top) - parentOffset.top : offset.top - parentOffset.top;\n            var leftValue = this.parent.inputElement && this.parent.inputElement.scrollLeft > 0 ?\n                (this.parent.inputElement.scrollLeft + offset.left) - parentOffset.left : offset.left - parentOffset.left;\n            return {\n                top: topValue,\n                left: leftValue\n            };\n        }\n        else {\n            return {\n                top: elem.offsetTop,\n                left: elem.offsetLeft\n            };\n        }\n    };\n    Table.prototype.getPointX = function (e) {\n        if (e.touches && e.touches.length) {\n            return e.touches[0].pageX;\n        }\n        else {\n            return e.pageX;\n        }\n    };\n    Table.prototype.getPointY = function (e) {\n        if (e.touches && e.touches.length) {\n            return e.touches[0].pageY;\n        }\n        else {\n            return e.pageY;\n        }\n    };\n    Table.prototype.resizeStart = function (e) {\n        var _this = this;\n        if (this.parent.readonly) {\n            return;\n        }\n        if (Browser.isDevice) {\n            this.resizeHelper(e);\n        }\n        var target = e.target;\n        if (target.classList.contains(classes.CLS_TB_COL_RES) ||\n            target.classList.contains(classes.CLS_TB_ROW_RES) ||\n            target.classList.contains(classes.CLS_TB_BOX_RES)) {\n            e.preventDefault();\n            this.parent.preventDefaultResize(e);\n            removeClass(this.curTable.querySelectorAll('td,th'), classes.CLS_TABLE_SEL);\n            this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument());\n            this.pageX = this.getPointX(e);\n            this.pageY = this.getPointY(e);\n            this.resizeBtnInit();\n            this.hideTableQuickToolbar();\n            if (target.classList.contains(classes.CLS_TB_COL_RES)) {\n                this.resizeBtnStat.column = true;\n                if (parseInt(target.getAttribute('data-col'), 10) === this.curTable.rows[this.calMaxCol(this.curTable)].cells.length) {\n                    this.currentColumnResize = 'last';\n                    this.columnEle = this.curTable.rows[this.calMaxCol(this.curTable)].cells[parseInt(target.getAttribute('data-col'), 10) - 1];\n                }\n                else {\n                    if (parseInt(target.getAttribute('data-col'), 10) === 0) {\n                        this.currentColumnResize = 'first';\n                    }\n                    else {\n                        this.currentColumnResize = 'middle';\n                    }\n                    this.columnEle = this.curTable.rows[this.calMaxCol(this.curTable)].cells[parseInt(target.getAttribute('data-col'), 10)];\n                }\n                this.colIndex = this.columnEle.cellIndex;\n                this.moveEle = e.target;\n                this.appendHelper();\n            }\n            if (target.classList.contains(classes.CLS_TB_ROW_RES)) {\n                this.rowEle = this.curTable.rows[parseInt(target.getAttribute('data-row'), 10)];\n                this.resizeBtnStat.row = true;\n                this.appendHelper();\n            }\n            if (target.classList.contains(classes.CLS_TB_BOX_RES)) {\n                this.resizeBtnStat.tableBox = true;\n            }\n            if (Browser.isDevice && this.helper && !this.helper.classList.contains('e-reicon')) {\n                this.helper.classList.add('e-reicon');\n                EventHandler.add(document, Browser.touchStartEvent, this.removeHelper, this);\n                EventHandler.add(this.helper, Browser.touchStartEvent, this.resizeStart, this);\n            }\n            else {\n                var args = { event: e, requestType: 'Table' };\n                this.parent.trigger(events.resizeStart, args, function (resizeStartArgs) {\n                    if (resizeStartArgs.cancel) {\n                        _this.cancelResizeAction();\n                    }\n                });\n            }\n            EventHandler.add(this.contentModule.getDocument(), Browser.touchMoveEvent, this.resizing, this);\n            EventHandler.add(this.contentModule.getDocument(), Browser.touchEndEvent, this.resizeEnd, this);\n        }\n    };\n    Table.prototype.removeHelper = function (e) {\n        var cls = e.target.classList;\n        if (!(cls.contains('e-reicon')) && this.helper) {\n            EventHandler.remove(document, Browser.touchStartEvent, this.removeHelper);\n            EventHandler.remove(this.helper, Browser.touchStartEvent, this.resizeStart);\n            if (this.helper && this.contentModule.getEditPanel().contains(this.helper)) {\n                detach(this.helper);\n            }\n            this.pageX = null;\n            this.helper = null;\n        }\n    };\n    Table.prototype.appendHelper = function () {\n        this.helper = this.parent.createElement('div', {\n            className: 'e-table-rhelper' + ' ' + this.parent.cssClass\n        });\n        if (Browser.isDevice) {\n            this.helper.classList.add('e-reicon');\n        }\n        this.contentModule.getEditPanel().appendChild(this.helper);\n        this.setHelperHeight();\n    };\n    Table.prototype.setHelperHeight = function () {\n        var pos = this.calcPos(this.curTable);\n        if (this.resizeBtnStat.column) {\n            this.helper.classList.add('e-column-helper');\n            this.helper.style.cssText = 'height: ' + getComputedStyle(this.curTable).height + '; top: ' +\n                pos.top + 'px; left:' + ((pos.left + this.calcPos(this.columnEle).left) +\n                (this.currentColumnResize === 'last' ? this.columnEle.offsetWidth + 2 : 0) - 1) + 'px;';\n        }\n        else {\n            this.helper.classList.add('e-row-helper');\n            this.helper.style.cssText = 'width: ' + getComputedStyle(this.curTable).width + '; top: ' +\n                (this.calcPos(this.rowEle).top + pos.top + this.rowEle.offsetHeight) +\n                'px; left:' + (this.calcPos(this.rowEle).left + pos.left) + 'px;';\n        }\n    };\n    Table.prototype.updateHelper = function () {\n        var pos = this.calcPos(this.curTable);\n        if (this.resizeBtnStat.column) {\n            var left = (pos.left + this.calcPos(this.columnEle).left) +\n                (this.currentColumnResize === 'last' ? this.columnEle.offsetWidth + 2 : 0) - 1;\n            this.helper.style.left = left + 'px';\n        }\n        else {\n            var top_1 = this.calcPos(this.rowEle).top + pos.top + this.rowEle.offsetHeight;\n            this.helper.style.top = top_1 + 'px';\n        }\n    };\n    Table.prototype.calMaxCol = function (element) {\n        var max = 0;\n        var maxRowIndex;\n        for (var i = 0; i < element.rows.length; i++) {\n            if (max < element.rows[i].cells.length) {\n                maxRowIndex = i;\n                max = element.rows[i].cells.length;\n            }\n        }\n        return maxRowIndex;\n    };\n    Table.prototype.resizing = function (e) {\n        var _this = this;\n        var pageX = this.getPointX(e);\n        var pageY = this.getPointY(e);\n        var mouseX = (this.parent.enableRtl) ? -(pageX - this.pageX) : (pageX - this.pageX);\n        var mouseY = (this.parent.enableRtl) ? -(pageY - this.pageY) : (pageY - this.pageY);\n        this.pageX = pageX;\n        this.pageY = pageY;\n        var args = { event: e, requestType: 'table' };\n        this.parent.trigger(events.onResize, args, function (resizingArgs) {\n            if (resizingArgs.cancel) {\n                _this.cancelResizeAction();\n            }\n            else {\n                var tableReBox = _this.contentModule.getEditPanel().querySelector('.e-table-box');\n                var tableWidth = parseInt(getComputedStyle(_this.curTable).width, 10);\n                var tableHeight = parseInt(getComputedStyle(_this.curTable).height, 10);\n                var paddingSize = +getComputedStyle(_this.contentModule.getEditPanel()).paddingRight.match(/\\d/g).join('');\n                var rteWidth = _this.contentModule.getEditPanel().offsetWidth - (_this.contentModule.getEditPanel().offsetWidth -\n                    _this.contentModule.getEditPanel().clientWidth) - paddingSize * 2;\n                var widthCompare = void 0;\n                if (!isNOU(_this.curTable.parentElement.closest('table'))) {\n                    var currentTd = _this.curTable.closest('td');\n                    var currentTDPad = +getComputedStyle(currentTd).paddingRight.match(/\\d/g).join('');\n                    // Padding of the current table with the parent element multiply with 2.\n                    widthCompare = currentTd.offsetWidth - (currentTd.offsetWidth - currentTd.clientWidth) - currentTDPad * 2;\n                }\n                else {\n                    widthCompare = rteWidth;\n                }\n                if (_this.resizeBtnStat.column) {\n                    var width = parseFloat(_this.columnEle.offsetWidth.toString());\n                    var cellRow = _this.curTable.rows[0].cells[0].nodeName === 'TH' ? 1 : 0;\n                    var currentTableWidth = parseFloat(_this.curTable.style.width.split('%')[0]);\n                    var currentColumnCellWidth = parseFloat(_this.curTable.rows[cellRow].cells[_this.colIndex].style.width.split('%')[0]);\n                    if (_this.currentColumnResize === 'first') {\n                        mouseX = mouseX - 0.75; //This was done for to make the gripper and the table first/last column will be close.\n                        _this.removeResizeElement();\n                        // Below the value '100' is the 100% width of the parent element.\n                        if (((mouseX !== 0 && 5 < currentColumnCellWidth) || mouseX < 0) && currentTableWidth <= 100 && _this.convertPixelToPercentage(tableWidth - mouseX, widthCompare) <= 100) {\n                            var firstColumnsCell = _this.findFirstLastColCells(_this.curTable, true);\n                            _this.curTable.style.width = _this.convertPixelToPercentage(tableWidth - mouseX, widthCompare) > 100 ? (100 + '%') : (_this.convertPixelToPercentage(tableWidth - mouseX, widthCompare) + '%');\n                            var differenceWidth = currentTableWidth - _this.convertPixelToPercentage(tableWidth - mouseX, widthCompare);\n                            _this.currentMarginLeft = _this.currentMarginLeft + differenceWidth;\n                            _this.curTable.style.marginLeft = 'calc(' + (_this.curTable.style.width === '100%' ? 0 : _this.currentMarginLeft) + '%)';\n                            for (var i = 0; i < firstColumnsCell.length; i++) {\n                                _this.curTable.rows[i].cells[_this.colIndex].style.width = (currentColumnCellWidth - differenceWidth) + '%';\n                            }\n                        }\n                    }\n                    else if (_this.currentColumnResize === 'last') {\n                        mouseX = mouseX + 0.75; //This was done for to make the gripper and the table first/last column will be close.\n                        _this.removeResizeElement();\n                        // Below the value '100' is the 100% width of the parent element.\n                        if (((mouseX !== 0 && 5 < currentColumnCellWidth) || mouseX > 0) && currentTableWidth <= 100 && _this.convertPixelToPercentage(tableWidth + mouseX, widthCompare) <= 100) {\n                            var lastColumnsCell = _this.findFirstLastColCells(_this.curTable, false);\n                            _this.curTable.style.width = _this.convertPixelToPercentage(tableWidth + mouseX, widthCompare) > 100 ? (100 + '%') : (_this.convertPixelToPercentage(tableWidth + mouseX, widthCompare) + '%');\n                            var differenceWidth = currentTableWidth - _this.convertPixelToPercentage(tableWidth + mouseX, widthCompare);\n                            for (var i = 0; i < lastColumnsCell.length; i++) {\n                                _this.curTable.rows[i].cells[_this.colIndex].style.width = (currentColumnCellWidth - differenceWidth) + '%';\n                            }\n                        }\n                    }\n                    else {\n                        var cellColl = _this.curTable.rows[_this.calMaxCol(_this.curTable)].cells;\n                        var actualwid = width - mouseX;\n                        var totalwid = parseFloat(_this.columnEle.offsetWidth.toString()) +\n                            parseFloat(cellColl[_this.colIndex - 1].offsetWidth.toString());\n                        for (var i = 0; i < _this.curTable.rows.length; i++) {\n                            if ((totalwid - actualwid) > 20 && actualwid > 20) {\n                                var leftColumnWidth = totalwid - actualwid;\n                                var rightColWidth = actualwid;\n                                if (!isNOU(_this.curTable.rows[i].cells[_this.colIndex - 1])) {\n                                    _this.curTable.rows[i].cells[_this.colIndex - 1].style.width =\n                                        _this.convertPixelToPercentage(leftColumnWidth, tableWidth) + '%';\n                                }\n                                if (!isNOU(_this.curTable.rows[i].cells[_this.colIndex])) {\n                                    _this.curTable.rows[i].cells[_this.colIndex].style.width =\n                                        _this.convertPixelToPercentage(rightColWidth, tableWidth) + '%';\n                                }\n                            }\n                        }\n                    }\n                    _this.updateHelper();\n                }\n                else if (_this.resizeBtnStat.row) {\n                    _this.parent.preventDefaultResize(e);\n                    var height = parseFloat(_this.rowEle.clientHeight.toString()) + mouseY;\n                    if (height > 20) {\n                        _this.rowEle.style.height = height + 'px';\n                    }\n                    _this.curTable.style.height = '';\n                    if (!isNOU(tableReBox)) {\n                        tableReBox.style.cssText = 'top: ' + (_this.calcPos(_this.curTable).top + tableHeight - 4) +\n                            'px; left:' + (_this.calcPos(_this.curTable).left + tableWidth - 4) + 'px;';\n                    }\n                    _this.updateHelper();\n                }\n                else if (_this.resizeBtnStat.tableBox) {\n                    if (!Browser.isDevice) {\n                        EventHandler.remove(_this.contentModule.getEditPanel(), 'mouseover', _this.resizeHelper);\n                    }\n                    var widthType = _this.curTable.style.width.indexOf('%') > -1;\n                    _this.curTable.style.width = widthType ? _this.convertPixelToPercentage(tableWidth + mouseX, widthCompare) + '%'\n                        : tableWidth + mouseX + 'px';\n                    _this.curTable.style.height = tableHeight + mouseY + 'px';\n                    tableReBox.classList.add('e-rbox-select');\n                    tableReBox.style.cssText = 'top: ' + (_this.calcPos(_this.curTable).top + tableHeight - 4) +\n                        'px; left:' + (_this.calcPos(_this.curTable).left + tableWidth - 4) + 'px;';\n                }\n            }\n        });\n    };\n    Table.prototype.findFirstLastColCells = function (table, isFirst) {\n        var resultColumns = [];\n        var rows = table.querySelectorAll('tr');\n        for (var i = 0; i < rows.length; i++) {\n            if (rows[i].closest('table') === table) {\n                var columns = rows[i].querySelectorAll('th, td');\n                resultColumns.push(isFirst ? columns[0] : columns[columns.length - 1]);\n            }\n        }\n        return resultColumns;\n    };\n    Table.prototype.convertPixelToPercentage = function (value, offsetValue) {\n        return (value / offsetValue) * 100;\n    };\n    Table.prototype.cancelResizeAction = function () {\n        EventHandler.remove(this.contentModule.getDocument(), Browser.touchMoveEvent, this.resizing);\n        EventHandler.remove(this.contentModule.getDocument(), Browser.touchEndEvent, this.resizeEnd);\n        this.removeResizeElement();\n    };\n    Table.prototype.resizeEnd = function (e) {\n        this.resizeBtnInit();\n        EventHandler.remove(this.contentModule.getDocument(), Browser.touchMoveEvent, this.resizing);\n        EventHandler.remove(this.contentModule.getDocument(), Browser.touchEndEvent, this.resizeEnd);\n        if (this.contentModule.getEditPanel().querySelector('.e-table-box') &&\n            this.contentModule.getEditPanel().contains(this.contentModule.getEditPanel().querySelector('.e-table-box'))) {\n            if (!Browser.isDevice) {\n                EventHandler.add(this.contentModule.getEditPanel(), 'mouseover', this.resizeHelper, this);\n            }\n            this.removeResizeElement();\n        }\n        if (this.helper && this.contentModule.getEditPanel().contains(this.helper)) {\n            detach(this.helper);\n            this.helper = null;\n        }\n        this.pageX = null;\n        this.pageY = null;\n        this.moveEle = null;\n        var args = { event: e, requestType: 'table' };\n        this.parent.trigger(events.resizeStop, args);\n        this.parent.formatter.saveData();\n    };\n    Table.prototype.resizeBtnInit = function () {\n        return this.resizeBtnStat = { column: false, row: false, tableBox: false };\n    };\n    Table.prototype.addRow = function (selectCell, e, tabkey) {\n        var cmd;\n        if (tabkey) {\n            cmd = {\n                item: { command: 'Table', subCommand: 'InsertRowAfter' }\n            };\n        }\n        var value = {\n            selection: selectCell,\n            subCommand: (tabkey) ? cmd.item.subCommand : e.item.subCommand\n        };\n        this.parent.formatter.process(this.parent, (tabkey) ? cmd : e, e, value);\n    };\n    Table.prototype.addColumn = function (selectCell, e) {\n        this.parent.formatter.process(this.parent, e, e, { selection: selectCell, width: this.parent.tableSettings.width, subCommand: e.item.subCommand });\n    };\n    Table.prototype.removeRowColumn = function (selectCell, e) {\n        this.parent.formatter.process(this.parent, e, e, { selection: selectCell, subCommand: e.item.subCommand });\n        this.hideTableQuickToolbar();\n    };\n    Table.prototype.removeTable = function (selection, args, delKey) {\n        var cmd;\n        if (delKey) {\n            cmd = { item: { command: 'Table', subCommand: 'TableRemove' } };\n        }\n        var value = {\n            selection: selection,\n            subCommand: (delKey) ? cmd.item.subCommand : args.item.subCommand\n        };\n        this.parent.formatter.process(this.parent, (delKey) ? cmd : args, args.originalEvent, value);\n        this.contentModule.getEditPanel().focus();\n        this.removeResizeElement();\n        this.hideTableQuickToolbar();\n    };\n    Table.prototype.renderDlgContent = function (args) {\n        var _this = this;\n        if (Browser.isDevice || this.parent.inlineMode.enable) {\n            this.insertTableDialog(args);\n            return;\n        }\n        if (this.popupObj) {\n            this.popupObj.hide();\n            return;\n        }\n        this.hideTableQuickToolbar();\n        var header = '1X1';\n        var insertbtn = this.l10n.getConstant('inserttablebtn');\n        this.dlgDiv = this.parent.createElement('div', { className: 'e-rte-table-popup' + ' ' + this.parent.cssClass, id: this.rteID + '_table' });\n        this.tblHeader = this.parent.createElement('div', { className: 'e-rte-popup-header' + ' ' + this.parent.cssClass });\n        this.tblHeader.innerHTML = header;\n        this.dlgDiv.appendChild(this.tblHeader);\n        var tableDiv = this.parent.createElement('div', { className: 'e-rte-table-span' + ' ' + this.parent.cssClass });\n        this.drawTable(tableDiv, args);\n        this.dlgDiv.appendChild(tableDiv);\n        this.dlgDiv.appendChild(this.parent.createElement('span', { className: 'e-span-border' + ' ' + this.parent.cssClass }));\n        var btnEle = this.parent.createElement('button', {\n            className: 'e-insert-table-btn' + ' ' + this.parent.cssClass, id: this.rteID + '_insertTable',\n            attrs: { type: 'button', tabindex: '0' }\n        });\n        if (!isNOU(this.parent.getToolbarElement().querySelector('.e-expended-nav'))) {\n            this.parent.getToolbarElement().querySelector('.e-expended-nav').setAttribute('tabindex', '1');\n        }\n        this.dlgDiv.appendChild(btnEle);\n        this.createTableButton = new Button({\n            iconCss: 'e-icons e-create-table', content: insertbtn, cssClass: 'e-flat' + ' ' + this.parent.cssClass,\n            enableRtl: this.parent.enableRtl, locale: this.parent.locale\n        });\n        this.createTableButton.isStringTemplate = true;\n        this.createTableButton.appendTo(btnEle);\n        EventHandler.add(btnEle, 'click', this.insertTableDialog, { self: this, args: args.args, selection: args.selection });\n        this.parent.getToolbar().appendChild(this.dlgDiv);\n        var target = args.args.originalEvent.target;\n        target = target.classList.contains('e-toolbar-item') ? target.firstChild : target.parentElement;\n        this.popupObj = new Popup(this.dlgDiv, {\n            targetType: 'relative',\n            relateTo: target,\n            collision: { X: 'fit', Y: 'none' },\n            offsetY: 8,\n            viewPortElement: this.parent.element,\n            position: { X: 'left', Y: 'bottom' },\n            enableRtl: this.parent.enableRtl,\n            zIndex: 10001,\n            // eslint-disable-next-line\n            close: function (event) {\n                _this.parent.isBlur = false;\n                _this.popupObj.destroy();\n                detach(_this.popupObj.element);\n                _this.popupObj = null;\n            }\n        });\n        addClass([this.popupObj.element], 'e-popup-open');\n        if (!isNOU(this.parent.cssClass)) {\n            addClass([this.popupObj.element], this.parent.cssClass);\n        }\n        this.popupObj.refreshPosition(target);\n    };\n    Table.prototype.docClick = function (e) {\n        var target = e.args.target;\n        // eslint-disable-next-line\n        if (target && target.classList && ((this.popupObj && !closest(target, '[id=' + \"'\" + this.popupObj.element.id + \"'\" + ']') ||\n            (this.editdlgObj && !closest(target, '#' + this.editdlgObj.element.id)))) && !target.classList.contains('e-create-table') &&\n            target.offsetParent && !target.offsetParent.classList.contains('e-rte-backgroundcolor-dropdown')) {\n            if (this.popupObj) {\n                this.popupObj.hide();\n            }\n            if (this.editdlgObj) {\n                this.editdlgObj.hide();\n            }\n            this.parent.isBlur = true;\n            dispatchEvent(this.parent.element, 'focusout');\n        }\n        var closestEle = closest(target, 'td');\n        var isExist = closestEle && this.parent.contentModule.getEditPanel().contains(closestEle) ? true : false;\n        if (target && target.tagName !== 'TD' && target.tagName !== 'TH' && !isExist &&\n            closest(target, '.e-rte-quick-popup') === null && target.offsetParent &&\n            !target.offsetParent.classList.contains('e-quick-dropdown') &&\n            !target.offsetParent.classList.contains('e-rte-backgroundcolor-dropdown') && !closest(target, '.e-rte-dropdown-popup')\n            && !closest(target, '.e-rte-elements')) {\n            removeClass(this.parent.inputElement.querySelectorAll('table td'), classes.CLS_TABLE_SEL);\n            if (!Browser.isIE) {\n                this.hideTableQuickToolbar();\n            }\n        }\n        if (target && target.classList && !target.classList.contains(classes.CLS_TB_COL_RES) &&\n            !target.classList.contains(classes.CLS_TB_ROW_RES) && !target.classList.contains(classes.CLS_TB_BOX_RES)) {\n            this.removeResizeElement();\n        }\n    };\n    Table.prototype.drawTable = function (tableDiv, args) {\n        var rowDiv;\n        var tableCell;\n        for (var row = 0; row < 3; row++) {\n            rowDiv = this.parent.createElement('div', { className: 'e-rte-table-row' + ' ' + this.parent.cssClass, attrs: { 'data-column': '' + row } });\n            for (var col = 0; col < 10; col++) {\n                var display = (row > 2) ? 'none' : 'inline-block';\n                tableCell = this.parent.createElement('div', { className: 'e-rte-tablecell e-default' + ' ' + this.parent.cssClass, attrs: { 'data-cell': '' + col } });\n                rowDiv.appendChild(tableCell);\n                tableCell.style.display = display;\n                if (col === 0 && row === 0) {\n                    addClass([tableCell], 'e-active');\n                }\n                EventHandler.add(tableCell, 'mousemove', this.tableCellSelect, this);\n                EventHandler.add(rowDiv, 'mouseleave', this.tableCellLeave, this);\n                EventHandler.add(tableCell, 'mouseup', this.tableCellClick, { self: this, args: args.args, selection: args.selection });\n            }\n            tableDiv.appendChild(rowDiv);\n        }\n    };\n    Table.prototype.editTable = function (args) {\n        var _this = this;\n        this.createDialog(args);\n        var editContent = this.tableDlgContent(args);\n        var update = this.l10n.getConstant('dialogUpdate');\n        var cancel = this.l10n.getConstant('dialogCancel');\n        var editHeader = this.l10n.getConstant('tableEditHeader');\n        this.editdlgObj.setProperties({\n            height: 'initial', width: '290px', content: editContent, header: editHeader,\n            buttons: [{\n                    click: this.applyProperties.bind(this, args),\n                    buttonModel: { content: update, cssClass: 'e-flat e-size-update' + ' ' + this.parent.cssClass, isPrimary: true }\n                },\n                {\n                    click: function (e) {\n                        _this.cancelDialog(e);\n                    },\n                    buttonModel: { cssClass: 'e-flat e-cancel' + ' ' + this.parent.cssClass, content: cancel }\n                }],\n            cssClass: this.editdlgObj.cssClass + ' e-rte-edit-table-prop-dialog'\n        });\n        this.editdlgObj.element.style.maxHeight = 'none';\n        this.editdlgObj.content.querySelector('input').focus();\n        this.hideTableQuickToolbar();\n    };\n    Table.prototype.insertTableDialog = function (args) {\n        var proxy = (this.self) ? this.self : this;\n        if (proxy.popupObj) {\n            proxy.popupObj.hide();\n        }\n        proxy.createDialog(args);\n        var dlgContent = proxy.tableCellDlgContent();\n        var insert = proxy.l10n.getConstant('dialogInsert');\n        var cancel = proxy.l10n.getConstant('dialogCancel');\n        if (isNullOrUndefined(proxy.editdlgObj)) {\n            return;\n        }\n        proxy.editdlgObj.setProperties({\n            height: 'initial', width: '290px', content: dlgContent,\n            buttons: [{\n                    click: proxy.customTable.bind(this, args),\n                    buttonModel: { content: insert, cssClass: 'e-flat e-insert-table' + ' ' + proxy.parent.cssClass, isPrimary: true }\n                },\n                {\n                    click: function (e) {\n                        proxy.cancelDialog(e);\n                    },\n                    buttonModel: { cssClass: 'e-flat e-cancel' + ' ' + proxy.parent.cssClass, content: cancel }\n                }]\n        });\n        if (!isNOU(proxy.parent.cssClass)) {\n            proxy.editdlgObj.setProperties({ cssClass: proxy.parent.cssClass });\n        }\n        proxy.editdlgObj.element.style.maxHeight = 'none';\n        proxy.editdlgObj.content.querySelector('input').focus();\n    };\n    Table.prototype.tableCellDlgContent = function () {\n        var tableColumn = this.l10n.getConstant('columns');\n        var tableRow = this.l10n.getConstant('rows');\n        var tableWrap = this.parent.createElement('div', { className: 'e-cell-wrap' + ' ' + this.parent.cssClass });\n        var content = '<div class=\"e-rte-field' + ' ' + this.parent.cssClass + '\"><input type=\"text\" '\n            + ' data-role =\"none\" id=\"tableColumn\" class=\"e-table-column' + ' ' + this.parent.cssClass + '\"/></div>'\n            + '<div class=\"e-rte-field' + ' ' + this.parent.cssClass + '\"><input type=\"text\" data-role =\"none\" id=\"tableRow\" class=\"e-table-row' + ' ' + this.parent.cssClass + '\" /></div>';\n        var contentElem = parseHtml(content);\n        tableWrap.appendChild(contentElem);\n        this.columnTextBox = new NumericTextBox({\n            format: 'n0',\n            min: 1,\n            value: 3,\n            placeholder: tableColumn,\n            floatLabelType: 'Auto',\n            max: 50,\n            enableRtl: this.parent.enableRtl, locale: this.parent.locale,\n            cssClass: this.parent.cssClass\n        });\n        this.columnTextBox.isStringTemplate = true;\n        this.columnTextBox.appendTo(tableWrap.querySelector('#tableColumn'));\n        this.rowTextBox = new NumericTextBox({\n            format: 'n0',\n            min: 1,\n            value: 3,\n            placeholder: tableRow,\n            floatLabelType: 'Auto',\n            max: 50,\n            enableRtl: this.parent.enableRtl, locale: this.parent.locale,\n            cssClass: this.parent.cssClass\n        });\n        this.rowTextBox.isStringTemplate = true;\n        this.rowTextBox.appendTo(tableWrap.querySelector('#tableRow'));\n        return tableWrap;\n    };\n    Table.prototype.clearDialogObj = function () {\n        if (this.editdlgObj) {\n            this.editdlgObj.destroy();\n            detach(this.editdlgObj.element);\n            this.editdlgObj = null;\n        }\n    };\n    // eslint-disable-next-line\n    Table.prototype.createDialog = function (args) {\n        var _this = this;\n        if (this.editdlgObj) {\n            this.editdlgObj.hide({ returnValue: true });\n            return;\n        }\n        var tableDialog = this.parent.createElement('div', {\n            className: 'e-rte-edit-table' + ' ' + this.parent.cssClass, id: this.rteID + '_tabledialog'\n        });\n        this.parent.element.appendChild(tableDialog);\n        var insert = this.l10n.getConstant('dialogInsert');\n        var cancel = this.l10n.getConstant('dialogCancel');\n        var header = this.l10n.getConstant('tabledialogHeader');\n        var dialogModel = {\n            header: header,\n            cssClass: classes.CLS_RTE_ELEMENTS + ' ' + this.parent.cssClass,\n            enableRtl: this.parent.enableRtl,\n            locale: this.parent.locale,\n            showCloseIcon: true, closeOnEscape: true, width: (Browser.isDevice) ? '290px' : '340px', height: 'initial',\n            position: { X: 'center', Y: (Browser.isDevice) ? 'center' : 'top' },\n            isModal: Browser.isDevice,\n            buttons: [{\n                    buttonModel: { content: insert, cssClass: 'e-flat e-insert-table' + ' ' + this.parent.cssClass, isPrimary: true }\n                },\n                {\n                    click: function (e) {\n                        _this.cancelDialog(e);\n                    },\n                    buttonModel: { cssClass: 'e-flat e-cancel' + ' ' + this.parent.cssClass, content: cancel }\n                }],\n            target: (Browser.isDevice) ? document.body : this.parent.element,\n            animationSettings: { effect: 'None' },\n            close: function (event) {\n                _this.parent.isBlur = false;\n                _this.editdlgObj.destroy();\n                detach(_this.editdlgObj.element);\n                _this.dialogRenderObj.close(event);\n                _this.editdlgObj = null;\n            }\n        };\n        this.editdlgObj = this.dialogRenderObj.render(dialogModel);\n        this.editdlgObj.appendTo(tableDialog);\n        if (this.quickToolObj && this.quickToolObj.inlineQTBar && document.body.contains(this.quickToolObj.inlineQTBar.element)) {\n            this.quickToolObj.inlineQTBar.hidePopup();\n        }\n    };\n    Table.prototype.customTable = function (args, e) {\n        var proxy = (this.self) ? this.self : this;\n        if (proxy.rowTextBox.value && proxy.columnTextBox.value) {\n            var argument = ((Browser.isDevice || (!isNullOrUndefined(args.args)\n                && !isNullOrUndefined(args.args.originalEvent) &&\n                args.args.originalEvent.action === 'insert-table')\n                || proxy.parent.inlineMode.enable) ? args : this);\n            proxy.tableInsert(proxy.rowTextBox.value, proxy.columnTextBox.value, e, argument);\n        }\n    };\n    // eslint-disable-next-line\n    Table.prototype.cancelDialog = function (e) {\n        this.parent.isBlur = false;\n        this.editdlgObj.hide({ returnValue: true });\n    };\n    // eslint-disable-next-line\n    Table.prototype.applyProperties = function (args, e) {\n        var dialogEle = this.editdlgObj.element;\n        var table = closest(args.selectNode[0], 'table');\n        table.style.width = dialogEle.querySelector('.e-table-width').value + 'px';\n        if (dialogEle.querySelector('.e-cell-padding').value !== '') {\n            var tdElm = table.querySelectorAll('td');\n            for (var i = 0; i < tdElm.length; i++) {\n                var padVal = '';\n                if (tdElm[i].style.padding === '') {\n                    padVal = tdElm[i].getAttribute('style') + ' padding:' +\n                        dialogEle.querySelector('.e-cell-padding').value + 'px;';\n                }\n                else {\n                    tdElm[i].style.padding = dialogEle.querySelector('.e-cell-padding').value + 'px';\n                    padVal = tdElm[i].getAttribute('style');\n                }\n                tdElm[i].setAttribute('style', padVal);\n            }\n        }\n        table.cellSpacing = dialogEle.querySelector('.e-cell-spacing').value;\n        if (!isNOU(table.cellSpacing) || table.cellSpacing !== '0') {\n            addClass([table], classes.CLS_TABLE_BORDER);\n        }\n        else {\n            removeClass([table], classes.CLS_TABLE_BORDER);\n        }\n        this.parent.formatter.saveData();\n        this.editdlgObj.hide({ returnValue: true });\n    };\n    Table.prototype.tableDlgContent = function (e) {\n        var selectNode = e.selectParent[0];\n        var tableWidth = this.l10n.getConstant('tableWidth');\n        var cellPadding = this.l10n.getConstant('cellpadding');\n        var cellSpacing = this.l10n.getConstant('cellspacing');\n        var tableWrap = this.parent.createElement('div', { className: 'e-table-sizewrap' + ' ' + this.parent.cssClass });\n        var widthVal = closest(selectNode, 'table').getClientRects()[0].width;\n        var padVal = closest(selectNode, 'td').style.padding;\n        var brdSpcVal = closest(selectNode, 'table').getAttribute('cellspacing');\n        var content = '<div class=\"e-rte-field' + ' ' + this.parent.cssClass + '\"><input type=\"text\" data-role =\"none\" id=\"tableWidth\" class=\"e-table-width' + ' ' + this.parent.cssClass + '\" '\n            + ' /></div>' + '<div class=\"e-rte-field' + ' ' + this.parent.cssClass + '\"><input type=\"text\" data-role =\"none\" id=\"cellPadding\" class=\"e-cell-padding' + ' ' + this.parent.cssClass + '\" />'\n            + ' </div><div class=\"e-rte-field' + ' ' + this.parent.cssClass + '\"><input type=\"text\" data-role =\"none\" id=\"cellSpacing\" class=\"e-cell-spacing' + ' ' + this.parent.cssClass + '\" /></div>';\n        var contentElem = parseHtml(content);\n        tableWrap.appendChild(contentElem);\n        this.tableWidthNum = new NumericTextBox({\n            format: 'n0',\n            min: 0,\n            value: widthVal,\n            placeholder: tableWidth,\n            floatLabelType: 'Auto',\n            enableRtl: this.parent.enableRtl, locale: this.parent.locale\n        });\n        this.tableWidthNum.isStringTemplate = true;\n        this.tableWidthNum.appendTo(tableWrap.querySelector('#tableWidth'));\n        this.tableCellPadding = new NumericTextBox({\n            format: 'n0',\n            min: 0,\n            // eslint-disable-next-line\n            value: padVal !== '' ? parseInt(padVal, null) : 0,\n            placeholder: cellPadding,\n            floatLabelType: 'Auto',\n            enableRtl: this.parent.enableRtl, locale: this.parent.locale\n        });\n        this.tableCellPadding.isStringTemplate = true;\n        this.tableCellPadding.appendTo(tableWrap.querySelector('#cellPadding'));\n        this.tableCellSpacing = new NumericTextBox({\n            format: 'n0',\n            min: 0,\n            // eslint-disable-next-line\n            value: brdSpcVal !== '' && !isNOU(brdSpcVal) ? parseInt(brdSpcVal, null) : 0,\n            placeholder: cellSpacing,\n            floatLabelType: 'Auto',\n            enableRtl: this.parent.enableRtl, locale: this.parent.locale\n        });\n        this.tableCellSpacing.isStringTemplate = true;\n        this.tableCellSpacing.appendTo(tableWrap.querySelector('#cellSpacing'));\n        return tableWrap;\n    };\n    /**\n     * Destroys the ToolBar.\n     *\n     * @function destroy\n     * @returns {void}\n     * @hidden\n\n     */\n    Table.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {void}\n     */\n    Table.prototype.getModuleName = function () {\n        return 'table';\n    };\n    return Table;\n}());\nexport { Table };\n"],"mappings":"AAAA,SAASA,MAAT,EAAiBC,OAAjB,EAA0BC,OAA1B,EAAmCC,iBAAiB,IAAIC,KAAxD,QAAqE,sBAArE;AACA,SAASD,iBAAT,EAA4BE,YAA5B,EAA0CC,QAA1C,EAAoDC,WAApD,QAAuE,sBAAvE;AACA,SAASC,KAAT,QAAsB,wBAAtB;AACA,SAASC,MAAT,QAAuB,yBAAvB;AACA,OAAO,KAAKC,MAAZ,MAAwB,kBAAxB;AACA,SAASC,UAAT,QAA2B,cAA3B;AACA,SAASC,cAAT,QAA+B,wBAA/B;AACA,OAAO,KAAKC,OAAZ,MAAyB,iBAAzB;AACA,SAASC,aAAT,EAAwBC,SAAxB,EAAmCC,QAAnC,QAAmD,cAAnD;AACA;AACA;AACA;;AACA,IAAIC,KAAK;AAAG;AAAe,YAAY;EACnC,SAASA,KAAT,CAAeC,MAAf,EAAuBC,cAAvB,EAAuC;IACnC,KAAKC,qBAAL,GAA6B,IAA7B;IACA,KAAKC,KAAL,GAAa,IAAb;IACA,KAAKC,KAAL,GAAa,IAAb;IACA,KAAKC,OAAL,GAAe,IAAf;IACA,KAAKC,mBAAL,GAA2B,EAA3B;IACA,KAAKC,iBAAL,GAAyB,CAAzB;IACA,KAAKP,MAAL,GAAcA,MAAd;IACA,KAAKQ,KAAL,GAAaR,MAAM,CAACS,OAAP,CAAeC,EAA5B;IACA,KAAKC,IAAL,GAAYV,cAAc,CAACW,UAAf,CAA0B,WAA1B,CAAZ;IACA,KAAKC,eAAL,GAAuBZ,cAAc,CAACW,UAAf,CAA0B,iBAA1B,CAAvB;IACA,KAAKE,eAAL,GAAuBb,cAAc,CAACW,UAAf,CAA0B,oBAA1B,CAAvB;IACA,KAAKG,gBAAL;EACH;;EACDhB,KAAK,CAACiB,SAAN,CAAgBD,gBAAhB,GAAmC,YAAY;IAC3C,IAAI,KAAKf,MAAL,CAAYiB,WAAhB,EAA6B;MACzB;IACH;;IACD,KAAKjB,MAAL,CAAYkB,EAAZ,CAAe1B,MAAM,CAAC2B,WAAtB,EAAmC,KAAKC,gBAAxC,EAA0D,IAA1D;IACA,KAAKpB,MAAL,CAAYkB,EAAZ,CAAe1B,MAAM,CAAC6B,UAAtB,EAAkC,KAAKC,WAAvC,EAAoD,IAApD;IACA,KAAKtB,MAAL,CAAYkB,EAAZ,CAAe1B,MAAM,CAAC+B,aAAtB,EAAqC,KAAKD,WAA1C,EAAuD,IAAvD;IACA,KAAKtB,MAAL,CAAYkB,EAAZ,CAAe1B,MAAM,CAACgC,eAAtB,EAAuC,KAAKC,UAA5C,EAAwD,IAAxD;IACA,KAAKzB,MAAL,CAAYkB,EAAZ,CAAe1B,MAAM,CAACkC,gBAAtB,EAAwC,KAAKC,WAA7C,EAA0D,IAA1D;IACA,KAAK3B,MAAL,CAAYkB,EAAZ,CAAe1B,MAAM,CAACoC,QAAtB,EAAgC,KAAKA,QAArC,EAA+C,IAA/C;IACA,KAAK5B,MAAL,CAAYkB,EAAZ,CAAe1B,MAAM,CAACqC,aAAtB,EAAqC,KAAKC,oBAA1C,EAAgE,IAAhE;IACA,KAAK9B,MAAL,CAAYkB,EAAZ,CAAe1B,MAAM,CAACuC,cAAtB,EAAsC,KAAKA,cAA3C,EAA2D,IAA3D;IACA,KAAK/B,MAAL,CAAYkB,EAAZ,CAAe1B,MAAM,CAACwC,kBAAtB,EAA0C,KAAKC,eAA/C,EAAgE,IAAhE;IACA,KAAKjC,MAAL,CAAYkB,EAAZ,CAAe1B,MAAM,CAAC0C,cAAtB,EAAsC,KAAKC,cAA3C,EAA2D,IAA3D;IACA,KAAKnC,MAAL,CAAYkB,EAAZ,CAAe1B,MAAM,CAAC4C,OAAtB,EAA+B,KAAKA,OAApC,EAA6C,IAA7C;IACA,KAAKpC,MAAL,CAAYkB,EAAZ,CAAe1B,MAAM,CAAC6C,OAAtB,EAA+B,KAAKC,cAApC,EAAoD,IAApD;IACA,KAAKtC,MAAL,CAAYkB,EAAZ,CAAe1B,MAAM,CAAC+C,YAAtB,EAAoC,KAAKC,WAAzC,EAAsD,IAAtD;IACA,KAAKxC,MAAL,CAAYkB,EAAZ,CAAe1B,MAAM,CAACiD,OAAtB,EAA+B,KAAKA,OAApC,EAA6C,IAA7C;EACH,CAlBD;;EAmBA1C,KAAK,CAACiB,SAAN,CAAgB0B,mBAAhB,GAAsC,YAAY;IAC9C,IAAI,KAAK1C,MAAL,CAAYiB,WAAhB,EAA6B;MACzB;IACH;;IACD,KAAKjB,MAAL,CAAY2C,GAAZ,CAAgBnD,MAAM,CAAC2B,WAAvB,EAAoC,KAAKC,gBAAzC;IACA,KAAKpB,MAAL,CAAY2C,GAAZ,CAAgBnD,MAAM,CAAC6B,UAAvB,EAAmC,KAAKC,WAAxC;IACA,KAAKtB,MAAL,CAAY2C,GAAZ,CAAgBnD,MAAM,CAAC+B,aAAvB,EAAsC,KAAKD,WAA3C;IACA,KAAKtB,MAAL,CAAY2C,GAAZ,CAAgBnD,MAAM,CAACoC,QAAvB,EAAiC,KAAKA,QAAtC;IACA,KAAK5B,MAAL,CAAY2C,GAAZ,CAAgBnD,MAAM,CAACgC,eAAvB,EAAwC,KAAKC,UAA7C;IACA,KAAKzB,MAAL,CAAY2C,GAAZ,CAAgBnD,MAAM,CAACkC,gBAAvB,EAAyC,KAAKC,WAA9C;IACA,KAAK3B,MAAL,CAAY2C,GAAZ,CAAgBnD,MAAM,CAACqC,aAAvB,EAAsC,KAAKC,oBAA3C;IACA,KAAK9B,MAAL,CAAY2C,GAAZ,CAAgBnD,MAAM,CAACuC,cAAvB,EAAuC,KAAKA,cAA5C;IACA,KAAK/B,MAAL,CAAY2C,GAAZ,CAAgBnD,MAAM,CAACwC,kBAAvB,EAA2C,KAAKC,eAAhD;IACA,KAAKjC,MAAL,CAAY2C,GAAZ,CAAgBnD,MAAM,CAAC0C,cAAvB,EAAuC,KAAKC,cAA5C;IACA,KAAKnC,MAAL,CAAY2C,GAAZ,CAAgBnD,MAAM,CAACoD,SAAvB,EAAkC,KAAKC,UAAvC;IACA,KAAK7C,MAAL,CAAY2C,GAAZ,CAAgBnD,MAAM,CAACsD,uBAAvB,EAAgD,KAAKC,UAArD;IACA,KAAK/C,MAAL,CAAY2C,GAAZ,CAAgBnD,MAAM,CAAC4C,OAAvB,EAAgC,KAAKA,OAArC;IACA,KAAKpC,MAAL,CAAY2C,GAAZ,CAAgBnD,MAAM,CAAC6C,OAAvB,EAAgC,KAAKC,cAArC;IACA,KAAKtC,MAAL,CAAY2C,GAAZ,CAAgBnD,MAAM,CAAC+C,YAAvB,EAAqC,KAAKC,WAA1C;IACA,KAAKxC,MAAL,CAAY2C,GAAZ,CAAgBnD,MAAM,CAACiD,OAAvB,EAAgC,KAAKA,OAArC;EACH,CApBD;;EAqBA1C,KAAK,CAACiB,SAAN,CAAgBgC,SAAhB,GAA4B,UAAUC,UAAV,EAAsBC,CAAtB,EAAyB;IACjD,IAAID,UAAU,IAAIC,CAAC,CAACC,QAApB,EAA8B;MAC1B,IAAIlE,iBAAiB,CAACiE,CAAC,CAACE,WAAH,CAArB,EAAsC;QAClCH,UAAU,CAACI,aAAX,CAAyB;UAAEF,QAAQ,EAAE,CAACF,UAAU,CAACE,QAAX,GAAsB,GAAtB,GAA4BD,CAAC,CAACC,QAA/B,EAAyCG,IAAzC;QAAZ,CAAzB;MACH,CAFD,MAGK;QACDL,UAAU,CAACI,aAAX,CAAyB;UAAEF,QAAQ,EAAE,CAACF,UAAU,CAACE,QAAX,CAAoBI,OAApB,CAA4BL,CAAC,CAACE,WAA9B,EAA2C,EAA3C,EAA+CE,IAA/C,KAAwD,GAAxD,GAA8DJ,CAAC,CAACC,QAAjE,EAA2EG,IAA3E;QAAZ,CAAzB;MACH;IACJ;EACJ,CATD;;EAUAvD,KAAK,CAACiB,SAAN,CAAgBwB,WAAhB,GAA8B,UAAUU,CAAV,EAAa;IACvC,IAAI,KAAKM,QAAL,IAAiBN,CAAC,CAACC,QAAvB,EAAiC;MAC7B,IAAIlE,iBAAiB,CAACiE,CAAC,CAACE,WAAH,CAArB,EAAsC;QAClChE,QAAQ,CAAC,CAAC,KAAKoE,QAAL,CAAc/C,OAAf,CAAD,EAA0ByC,CAAC,CAACC,QAA5B,CAAR;MACH,CAFD,MAGK;QACD9D,WAAW,CAAC,CAAC,KAAKmE,QAAL,CAAc/C,OAAf,CAAD,EAA0ByC,CAAC,CAACE,WAA5B,CAAX;QACAhE,QAAQ,CAAC,CAAC,KAAKoE,QAAL,CAAc/C,OAAf,CAAD,EAA0ByC,CAAC,CAACC,QAA5B,CAAR;MACH;IACJ;;IACD,KAAKH,SAAL,CAAe,KAAKS,iBAApB,EAAuCP,CAAvC;IACA,KAAKF,SAAL,CAAe,KAAKU,UAApB,EAAgCR,CAAhC;IACA,IAAIS,iBAAiB,GAAG,CACpB,KAAKC,aADe,EACA,KAAKC,UADL,EACiB,KAAKC,aADtB,EACqC,KAAKC,gBAD1C,EAC4D,KAAKC,gBADjE,CAAxB;;IAGA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGN,iBAAiB,CAACO,MAAtC,EAA8CD,CAAC,EAA/C,EAAmD;MAC/C,KAAKjB,SAAL,CAAeW,iBAAiB,CAACM,CAAD,CAAhC,EAAqCf,CAArC;IACH;EACJ,CAlBD;;EAmBAnD,KAAK,CAACiB,SAAN,CAAgBsB,cAAhB,GAAiC,UAAUY,CAAV,EAAa;IAC1C,IAAIiB,MAAM,GAAGjB,CAAC,CAACkB,IAAF,CAAOD,MAApB;;IACA,IAAInF,OAAO,CAACqF,IAAR,CAAaC,IAAb,KAAsB,SAAtB,IAAmC,CAACpF,KAAK,CAACH,OAAO,CAACoF,MAAD,EAAS,OAAT,CAAR,CAAzC,IAAuEpF,OAAO,CAACoF,MAAD,EAAS,OAAT,CAAP,CAAyBI,OAAzB,KAAqC,OAAhH,EAAyH;MACrH,KAAKvE,MAAL,CAAYwE,aAAZ,CAA0BC,YAA1B,GAAyCC,YAAzC,CAAsD,iBAAtD,EAAyE,MAAzE;IACH;EACJ,CALD;;EAMA3E,KAAK,CAACiB,SAAN,CAAgBM,WAAhB,GAA8B,YAAY;IACtC,IAAIrC,iBAAiB,CAAC,KAAKuF,aAAN,CAArB,EAA2C;MACvC,KAAKA,aAAL,GAAqB,KAAK3D,eAAL,CAAqB8D,WAArB,CAAiClF,UAAU,CAACmF,OAA5C,CAArB;MACA,KAAK5E,MAAL,CAAYkB,EAAZ,CAAe1B,MAAM,CAACsD,uBAAtB,EAA+C,KAAKC,UAApD,EAAgE,IAAhE;MACA,KAAK/C,MAAL,CAAYkB,EAAZ,CAAe1B,MAAM,CAACoD,SAAtB,EAAiC,KAAKC,UAAtC,EAAkD,IAAlD;;MACA,IAAI,KAAK7C,MAAL,CAAY6E,aAAZ,CAA0BC,MAA9B,EAAsC;QAClC3F,YAAY,CAAC4F,GAAb,CAAiB,KAAK/E,MAAL,CAAYwE,aAAZ,CAA0BC,YAA1B,EAAjB,EAA2DzF,OAAO,CAACgG,eAAnE,EAAoF,KAAKC,WAAzF,EAAsG,IAAtG;MACH;;MACD,IAAI,CAACjG,OAAO,CAACkG,QAAT,IAAqB,KAAKlF,MAAL,CAAY6E,aAAZ,CAA0BC,MAAnD,EAA2D;QACvD3F,YAAY,CAAC4F,GAAb,CAAiB,KAAKP,aAAL,CAAmBC,YAAnB,EAAjB,EAAoD,WAApD,EAAiE,KAAKU,YAAtE,EAAoF,IAApF;MACH;IACJ;EACJ,CAZD;;EAaApF,KAAK,CAACiB,SAAN,CAAgBmB,cAAhB,GAAiC,UAAUe,CAAV,EAAa;IAC1C,IAAIkC,IAAI,GAAGlC,CAAC,CAACkC,IAAb;;IACA,IAAI,CAACC,QAAQ,CAACC,IAAT,CAAcC,QAAd,CAAuBF,QAAQ,CAACC,IAAT,CAAcE,aAAd,CAA4B,sBAA5B,CAAvB,CAAD,IAAgFJ,IAAI,CAACK,OAAL,KAAiB,OAArG,EAA8G;MAC1G;IACH;;IACD,IAAIC,KAAK,GAAG,KAAK1F,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCC,aAApC,CAAkDC,QAAlD,CAA2D,KAAK9F,MAAL,CAAYwE,aAAZ,CAA0BuB,WAA1B,EAA3D,CAAZ;IACA,IAAI3B,IAAI,GAAG;MACPA,IAAI,EAAElB,CADC;MAEP8C,SAAS,EAAE,KAAKhG,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCC,aAApC,CAAkDI,IAAlD,CAAuDP,KAAvD,EAA8D,KAAKlB,aAAL,CAAmBuB,WAAnB,EAA9D,CAFJ;MAGPG,YAAY,EAAE,KAAKlG,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCC,aAApC,CAAkDM,uBAAlD,CAA0ET,KAA1E;IAHP,CAAX;;IAKA,QAAQN,IAAI,CAACgB,UAAb;MACI,KAAK,iBAAL;MACA,KAAK,gBAAL;QACI,KAAKC,MAAL,CAAYjC,IAAI,CAAC4B,SAAjB,EAA4B9C,CAA5B;QACA;;MACJ,KAAK,kBAAL;MACA,KAAK,mBAAL;QACI,KAAKoD,SAAL,CAAelC,IAAI,CAAC4B,SAApB,EAA+B9C,CAA/B;QACA;;MACJ,KAAK,cAAL;MACA,KAAK,WAAL;QACI,KAAKqD,eAAL,CAAqBnC,IAAI,CAAC4B,SAA1B,EAAqC9C,CAArC;QACA;;MACJ,KAAK,UAAL;MACA,KAAK,aAAL;MACA,KAAK,aAAL;QACI,KAAKsD,aAAL,CAAmBpC,IAAnB,EAAyBlB,CAAzB;QACA;;MACJ,KAAK,QAAL;MACA,KAAK,WAAL;MACA,KAAK,QAAL;QACI,KAAKuD,WAAL,CAAiBrC,IAAjB,EAAuBgB,IAAI,CAACgB,UAA5B;QACA;;MACJ,KAAK,OAAL;MACA,KAAK,eAAL;MACA,KAAK,iBAAL;QACI,KAAKM,WAAL,CAAiBtC,IAAI,CAAC4B,SAAtB,EAAiC9C,CAAjC;QACA;IA3BR;EA6BH,CAxCD;;EAyCAnD,KAAK,CAACiB,SAAN,CAAgB0F,WAAhB,GAA8B,UAAUC,UAAV,EAAsBzD,CAAtB,EAAyB;IACnD,KAAKlD,MAAL,CAAY2F,SAAZ,CAAsBiB,OAAtB,CAA8B,KAAK5G,MAAnC,EAA2CkD,CAA3C,EAA8CA,CAA9C,EAAiD;MAAE8C,SAAS,EAAEW,UAAb;MAAyBP,UAAU,EAAElD,CAAC,CAACkC,IAAF,CAAOgB;IAA5C,CAAjD;IACA,KAAKS,qBAAL;EACH,CAHD;;EAIA9G,KAAK,CAACiB,SAAN,CAAgBoB,OAAhB,GAA0B,UAAUc,CAAV,EAAa;IACnC,IAAI4D,KAAK,GAAG5D,CAAC,CAACkB,IAAd,CADmC,CAEnC;;IACA,IAAI2C,KAAK,GAAG,IAAZ;;IACA,QAAQD,KAAK,CAACE,MAAd;MACI,KAAK,QAAL;QACI;;MACJ,KAAK,cAAL;QACI,KAAKC,UAAL,CAAgB,IAAhB,EAAsB/D,CAAtB;QACA4D,KAAK,CAACI,cAAN;QACA;IANR;;IAQA,IAAI,CAACjI,iBAAiB,CAAC,KAAKe,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCC,aAArC,CAAlB,IAAyE,KAAKrB,aAA9E,IACGsC,KAAK,CAACK,IAAN,KAAe,MADtB,EAC8B;MAC1B,IAAIzB,KAAK,GAAG,KAAK1F,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCC,aAApC,CAAkDC,QAAlD,CAA2D,KAAK9F,MAAL,CAAYwE,aAAZ,CAA0BuB,WAA1B,EAA3D,CAAZ;MACA,IAAIC,SAAS,GAAG,KAAKhG,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CACZC,aADY,CACEI,IADF,CACOP,KADP,EACc,KAAKlB,aAAL,CAAmBuB,WAAnB,EADd,CAAhB;MAEA,IAAIqB,GAAG,GAAG,KAAKpH,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCC,aAApC,CAAkDM,uBAAlD,CAA0ET,KAA1E,EAAiF,CAAjF,CAAV;MACA0B,GAAG,GAAIA,GAAG,IAAIA,GAAG,CAAC7C,OAAJ,KAAgB,IAAvB,IAA+B6C,GAAG,CAAC7C,OAAJ,KAAgB,IAAhD,GAAwD6C,GAAG,CAACC,aAA5D,GAA4ED,GAAlF;;MACA,IAAKN,KAAK,CAACQ,OAAN,KAAkB,CAAlB,IAAuBR,KAAK,CAACQ,OAAN,KAAkB,EAA1C,IACCR,KAAK,CAACS,OAAN,IAAiBT,KAAK,CAACQ,OAAN,KAAkB,EADxC,EAC6C;QACzC,IAAIF,GAAG,IAAIA,GAAG,CAAC7C,OAAJ,KAAgB,OAA3B,EAAoC;UAChCuC,KAAK,CAACI,cAAN;UACAH,KAAK,CAACS,WAAN,CAAkBxB,SAAlB,EAA6Bc,KAA7B,EAAoC,IAApC;QACH,CAHD,MAIK,IAAIM,GAAG,IAAIA,GAAG,CAACK,gBAAJ,CAAqB,OAArB,EAA8BvD,MAA9B,GAAuC,CAAlD,EAAqD;UACtD,KAAKwD,mBAAL;UACA,KAAKb,qBAAL;QACH;MACJ;;MACD,IAAIO,GAAG,IAAIA,GAAG,CAAC7C,OAAJ,KAAgB,IAAvB,IAA+B6C,GAAG,CAAC7C,OAAJ,KAAgB,IAAnD,EAAyD;QACrD,IAAIoD,SAAS,GAAG5I,OAAO,CAACqI,GAAD,EAAM,IAAN,CAAvB;QACAA,GAAG,GAAG,CAACnI,iBAAiB,CAAC0I,SAAD,CAAlB,IAAiC,KAAK3H,MAAL,CAAY4H,YAAZ,CAAyBrC,QAAzB,CAAkCoC,SAAlC,CAAjC,GAAgFA,SAAhF,GAA4FP,GAAlG;MACH;;MACD,IAAIA,GAAG,KAAKA,GAAG,CAAC7C,OAAJ,KAAgB,IAAhB,IAAwB6C,GAAG,CAAC7C,OAAJ,KAAgB,IAA7C,CAAP,EAA2D;QACvD,QAAQuC,KAAK,CAACQ,OAAd;UACI,KAAK,CAAL;UACA,KAAK,EAAL;UACA,KAAK,EAAL;YACIP,KAAK,CAACc,YAAN,CAAmBf,KAAnB,EAA0Bd,SAA1B,EAAqCoB,GAArC;YACA;;UACJ,KAAK,EAAL;UACA,KAAK,EAAL;YACIL,KAAK,CAACe,oBAAN,CAA2BhB,KAA3B,EAAkCd,SAAlC,EAA6CoB,GAA7C;YACA;QATR;MAWH;IACJ;EACJ,CAhDD;;EAiDArH,KAAK,CAACiB,SAAN,CAAgBiG,UAAhB,GAA6B,UAAUc,UAAV,EAAsB7E,CAAtB,EAAyB;IAClD,IAAI,CAAC6E,UAAL,EAAiB;MACb,KAAK/H,MAAL,CAAYwE,aAAZ,CAA0BC,YAA1B,GAAyCuD,KAAzC;IACH;;IACD,IAAI,KAAKhI,MAAL,CAAYiI,UAAZ,KAA2B,MAA/B,EAAuC;MACnC,IAAIC,UAAU,GAAG,KAAKlI,MAAL,CAAYwE,aAAZ,CAA0BuB,WAA1B,EAAjB;MACA,IAAIL,KAAK,GAAG,KAAK1F,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCC,aAApC,CAAkDC,QAAlD,CAA2DoC,UAA3D,CAAZ;MACA,IAAIlC,SAAS,GAAG,KAAKhG,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCC,aAApC,CAAkDI,IAAlD,CAAuDP,KAAvD,EAA8DwC,UAA9D,CAAhB;MACA,IAAI9D,IAAI,GAAG;QACP+D,aAAa,EAAEjF,CAAC,GAAGA,CAAC,CAACkB,IAAL,GAAY;UAAE4C,MAAM,EAAE;QAAV,CADrB;QAEP5B,IAAI,EAAE;UACFK,OAAO,EAAE,OADP;UAEFW,UAAU,EAAE;QAFV;MAFC,CAAX;MAOA,KAAKgC,iBAAL,CAAuB;QAAEC,IAAI,EAAE,IAAR;QAAcjE,IAAI,EAAEA,IAApB;QAA0B4B,SAAS,EAAEA;MAArC,CAAvB;IACH;EACJ,CAjBD;;EAkBAjG,KAAK,CAACiB,SAAN,CAAgBS,UAAhB,GAA6B,YAAY;IACrC,KAAKwF,UAAL,CAAgB,KAAhB;IACA,KAAKzE,WAAL,CAAiB;MAAEW,QAAQ,EAAE,KAAKnD,MAAL,CAAYmD;IAAxB,CAAjB;EACH,CAHD;;EAIApD,KAAK,CAACiB,SAAN,CAAgBW,WAAhB,GAA8B,YAAY;IACtC,IAAI,KAAK+B,UAAT,EAAqB;MACjB,KAAKA,UAAL,CAAgB4E,IAAhB,CAAqB;QAAEC,WAAW,EAAE;MAAf,CAArB;IACH;EACJ,CAJD;;EAKAxI,KAAK,CAACiB,SAAN,CAAgBiB,eAAhB,GAAkC,UAAUmC,IAAV,EAAgB;IAC9C,IAAIgB,IAAI,GAAGhB,IAAI,CAACA,IAAL,CAAUgB,IAArB;;IACA,QAAQA,IAAI,CAACgB,UAAb;MACI,KAAK,aAAL;QACI,KAAKoC,WAAL,CAAiBpE,IAAI,CAAC4B,SAAtB,EAAiC5B,IAAI,CAACA,IAAtC;QACA;;MACJ,KAAK,aAAL;QACI,KAAKoD,WAAL,CAAiBpD,IAAI,CAAC4B,SAAtB,EAAiC5B,IAAI,CAACA,IAAtC;QACA;;MACJ,KAAK,qBAAL;QACI,KAAKqE,SAAL,CAAerE,IAAf;QACA;IATR;EAWH,CAbD;;EAcArE,KAAK,CAACiB,SAAN,CAAgBwF,aAAhB,GAAgC,UAAUpC,IAAV,EAAgBlB,CAAhB,EAAmB;IAC/C,IAAIwF,KAAK,GAAG3J,OAAO,CAACqF,IAAI,CAAC8B,YAAL,CAAkB,CAAlB,CAAD,EAAuB,IAAvB,CAAP,IAAuCnH,OAAO,CAACqF,IAAI,CAAC8B,YAAL,CAAkB,CAAlB,CAAD,EAAuB,IAAvB,CAA1D;;IACA,IAAIwC,KAAJ,EAAW;MACP,KAAK1I,MAAL,CAAY2F,SAAZ,CAAsBiB,OAAtB,CAA8B,KAAK5G,MAAnC,EAA2CkD,CAA3C,EAA8CA,CAA9C,EAAiD;QAAEyF,SAAS,EAAED,KAAb;QAAoBtC,UAAU,EAAElD,CAAC,CAACkC,IAAF,CAAOgB;MAAvC,CAAjD;IACH;EACJ,CALD;;EAMArG,KAAK,CAACiB,SAAN,CAAgByF,WAAhB,GAA8B,UAAUrC,IAAV,EAAgBqB,OAAhB,EAAyB;IACnD,IAAImD,KAAK,GAAG7J,OAAO,CAACqF,IAAI,CAAC8B,YAAL,CAAkB,CAAlB,CAAD,EAAuB,OAAvB,CAAnB;;IACA,IAAIT,OAAO,KAAK,QAAhB,EAA0B;MACtB;MACC,KAAKzF,MAAL,CAAYS,OAAZ,CAAoBoI,SAApB,CAA8BtD,QAA9B,CAAuC5F,OAAO,CAACmJ,eAA/C,CAAD,GACI,KAAK9I,MAAL,CAAYS,OAAZ,CAAoBoI,SAApB,CAA8BE,MAA9B,CAAqCpJ,OAAO,CAACmJ,eAA7C,CADJ,GACoE,KAAK9I,MAAL,CAAYS,OAAZ,CAAoBoI,SAApB,CAA8B9D,GAA9B,CAAkCpF,OAAO,CAACmJ,eAA1C,CADpE;MAECF,KAAK,CAACC,SAAN,CAAgBtD,QAAhB,CAAyB5F,OAAO,CAACmJ,eAAjC,CAAD,GAAsDF,KAAK,CAACC,SAAN,CAAgBE,MAAhB,CAAuBpJ,OAAO,CAACmJ,eAA/B,CAAtD,GACIF,KAAK,CAACC,SAAN,CAAgB9D,GAAhB,CAAoBpF,OAAO,CAACmJ,eAA5B,CADJ;IAEH;;IACD,IAAIrD,OAAO,KAAK,WAAhB,EAA6B;MACxB,KAAKzF,MAAL,CAAYS,OAAZ,CAAoBoI,SAApB,CAA8BtD,QAA9B,CAAuC5F,OAAO,CAACqJ,cAA/C,CAAD,GACI,KAAKhJ,MAAL,CAAYS,OAAZ,CAAoBoI,SAApB,CAA8BE,MAA9B,CAAqCpJ,OAAO,CAACqJ,cAA7C,CADJ,GACmE,KAAKhJ,MAAL,CAAYS,OAAZ,CAAoBoI,SAApB,CAA8B9D,GAA9B,CAAkCpF,OAAO,CAACqJ,cAA1C,CADnE;MAECJ,KAAK,CAACC,SAAN,CAAgBtD,QAAhB,CAAyB5F,OAAO,CAACqJ,cAAjC,CAAD,GAAqDJ,KAAK,CAACC,SAAN,CAAgBE,MAAhB,CAAuBpJ,OAAO,CAACqJ,cAA/B,CAArD,GACIJ,KAAK,CAACC,SAAN,CAAgB9D,GAAhB,CAAoBpF,OAAO,CAACqJ,cAA5B,CADJ;MAEA;IACH;;IACD,IAAI5E,IAAI,CAACA,IAAL,IAAaA,IAAI,CAACA,IAAL,CAAUgB,IAAV,CAAejC,QAAhC,EAA0C;MACtC,IAAI0F,SAAS,GAAGzE,IAAI,CAACA,IAAL,CAAUgB,IAAV,CAAejC,QAAf,CAAwB8F,KAAxB,CAA8B,GAA9B,CAAhB;;MACA,KAAK,IAAIhF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4E,SAAS,CAAC3E,MAA9B,EAAsCD,CAAC,EAAvC,EAA2C;QACvC,IAAI2E,KAAK,CAACC,SAAN,CAAgBtD,QAAhB,CAAyBsD,SAAS,CAAC5E,CAAD,CAAlC,CAAJ,EAA4C;UACxC2E,KAAK,CAACC,SAAN,CAAgBE,MAAhB,CAAuBF,SAAS,CAAC5E,CAAD,CAAhC;QACH,CAFD,MAGK;UACD2E,KAAK,CAACC,SAAN,CAAgB9D,GAAhB,CAAoB8D,SAAS,CAAC5E,CAAD,CAA7B;QACH;MACJ;IACJ;;IACD,KAAKjE,MAAL,CAAY2F,SAAZ,CAAsBuD,QAAtB;IACA,KAAKlJ,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCC,aAApC,CAAkDsD,OAAlD;EACH,CA7BD;;EA8BApJ,KAAK,CAACiB,SAAN,CAAgBoI,UAAhB,GAA6B,UAAU1D,KAAV,EAAiB;IAC1C,IAAI2D,UAAU,GAAG,KAAKrJ,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoC0D,OAApC,CAA4CD,UAA5C,EAAjB;IACA,IAAIE,KAAK,GAAG,EAAZ;;IACA,KAAK,IAAItF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoF,UAAU,CAACnF,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;MACxC,IAAIoF,UAAU,CAACpF,CAAD,CAAV,CAAcuF,UAAd,CAAyBjF,OAAzB,KAAqC,IAAzC,EAA+C;QAC3CgF,KAAK,CAACE,IAAN,CAAWJ,UAAU,CAACpF,CAAD,CAAV,CAAcuF,UAAzB;MACH,CAFD,MAGK,IAAIH,UAAU,CAACpF,CAAD,CAAV,CAAcM,OAAd,KAA0B,IAA1B,IAAkC8E,UAAU,CAACpF,CAAD,CAAV,CAAcyF,UAAd,CAAyB,CAAzB,EAA4BnF,OAA5B,KAAwC,GAA1E,IACJ8E,UAAU,CAACpF,CAAD,CAAV,CAAcyF,UAAd,CAAyB,CAAzB,EAA4BnF,OAA5B,KAAwC,IAAxC,IACG8E,UAAU,CAACpF,CAAD,CAAV,CAAcyF,UAAd,CAAyB,CAAzB,EAA4BnF,OAA5B,KAAwC,IAF3C,EAEkD;QACnDgF,KAAK,CAACE,IAAN,CAAWJ,UAAU,CAACpF,CAAD,CAArB;MACH;IACJ;;IACD,IAAIsF,KAAK,CAACrF,MAAN,GAAe,CAAf,IAAoBqF,KAAK,CAACrF,MAAN,IAAkBwB,KAAK,CAACiE,WAAN,KAAsB,CAAtB,IAA2BjE,KAAK,CAACkE,SAAN,KAAoB,CAAzF,EAA8F;MAC1F,KAAK1J,qBAAL,GAA6B,IAA7B;MACA,OAAO,IAAP;IACH,CAHD,MAIK;MACD,KAAKA,qBAAL,GAA6B,KAA7B;MACA,OAAO,KAAP;IACH;EACJ,CArBD;;EAsBAH,KAAK,CAACiB,SAAN,CAAgB6G,YAAhB,GAA+B,UAAUf,KAAV,EAAiBd,SAAjB,EAA4BoB,GAA5B,EAAiC;IAC5D,IAAIgC,UAAU,GAAG,KAAKA,UAAL,CAAgBpD,SAAS,CAACN,KAA1B,CAAjB;;IACA,IAAI,CAACoB,KAAK,CAACQ,OAAN,KAAkB,EAAlB,IAAwBR,KAAK,CAACQ,OAAN,KAAkB,EAA3C,KAAkDtB,SAAS,CAACN,KAAV,CAAgBmE,cAAhB,CAA+BC,QAA/B,KAA4C,CAA9F,IACAV,UADJ,EACgB;MACZ;IACH;;IACDtC,KAAK,CAACI,cAAN;IACAE,GAAG,CAACyB,SAAJ,CAAcE,MAAd,CAAqBpJ,OAAO,CAACoK,aAA7B;;IACA,IAAI,CAACjD,KAAK,CAACkD,QAAP,IAAmBlD,KAAK,CAACQ,OAAN,KAAkB,EAAzC,EAA6C;MACzC,IAAI2C,WAAW,GAAI,CAAChL,iBAAiB,CAACmI,GAAG,CAAC8C,WAAL,CAAnB,GAAwC9C,GAAG,CAAC8C,WAA5C,GACb,CAACjL,iBAAiB,CAACF,OAAO,CAACqI,GAAD,EAAM,IAAN,CAAP,CAAmB8C,WAApB,CAAlB,GAAqDnL,OAAO,CAACqI,GAAD,EAAM,IAAN,CAAP,CAAmB8C,WAAnB,CAA+BR,UAA/B,CAA0C,CAA1C,CAArD,GACI,CAACzK,iBAAiB,CAACF,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsB8C,WAAvB,CAAnB,GACKnL,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsB8C,WAAtB,CAAkCC,QAAlC,CAA2CC,WAA3C,OAA6D,IAA9D,GACIrL,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsB8C,WAD1B,GACwC9C,GAF5C,GAEkDA,GAJ1D;;MAKA,IAAIA,GAAG,KAAK6C,WAAR,IAAuB7C,GAAG,CAAC+C,QAAJ,KAAiB,IAA5C,EAAkD;QAC9CF,WAAW,GAAGlL,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsBiD,IAAtB,CAA2B,CAA3B,EAA8BC,KAA9B,CAAoC,CAApC,CAAd;MACH;;MACD,IAAIxD,KAAK,CAACQ,OAAN,KAAkB,EAAlB,IAAwBF,GAAG,KAAK6C,WAApC,EAAiD;QAC7CA,WAAW,GAAGlL,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsB8C,WAApC;MACH;;MACD,IAAID,WAAJ,EAAiB;QACb;QACCA,WAAW,CAACM,WAAZ,CAAwBjH,IAAxB,OAAmC,EAAnC,IAAyCvE,OAAO,CAACkL,WAAD,EAAc,IAAd,CAAjD,GACIjE,SAAS,CAACwE,gBAAV,CAA2B,KAAKhG,aAAL,CAAmBuB,WAAnB,EAA3B,EAA6DkE,WAA7D,CADJ,GAEIjE,SAAS,CAACyE,gBAAV,CAA2B,KAAKjG,aAAL,CAAmBuB,WAAnB,EAA3B,EAA6DkE,WAA7D,EAA0EA,WAA1E,EAAuF,CAAvF,EAA0F,CAA1F,CAFJ;MAGH;;MACD,IAAI7C,GAAG,KAAK6C,WAAR,IAAuBnD,KAAK,CAACQ,OAAN,KAAkB,EAAzC,IAA+C2C,WAAnD,EAAgE;QAC5D7C,GAAG,CAACyB,SAAJ,CAAc9D,GAAd,CAAkBpF,OAAO,CAACoK,aAA1B;QACA,KAAK1D,MAAL,CAAYL,SAAZ,EAAuBc,KAAvB,EAA8B,IAA9B;QACAM,GAAG,CAACyB,SAAJ,CAAcE,MAAd,CAAqBpJ,OAAO,CAACoK,aAA7B;QACAE,WAAW,GAAGA,WAAW,CAAC5C,aAAZ,CAA0B6C,WAA1B,GAAwCD,WAAW,CAAC5C,aAAZ,CAA0B6C,WAA1B,CAAsCQ,UAA9E,GAA2FT,WAAW,CAAC5C,aAAZ,CAA0BqD,UAAnI,CAJ4D,CAK5D;;QACCT,WAAW,CAACM,WAAZ,CAAwBjH,IAAxB,OAAmC,EAAnC,IAAyCvE,OAAO,CAACkL,WAAD,EAAc,IAAd,CAAjD,GACIjE,SAAS,CAACwE,gBAAV,CAA2B,KAAKhG,aAAL,CAAmBuB,WAAnB,EAA3B,EAA6DkE,WAA7D,CADJ,GAEIjE,SAAS,CAACyE,gBAAV,CAA2B,KAAKjG,aAAL,CAAmBuB,WAAnB,EAA3B,EAA6DkE,WAA7D,EAA0EA,WAA1E,EAAuF,CAAvF,EAA0F,CAA1F,CAFJ;MAGH;IACJ,CA5BD,MA6BK;MACD,IAAIU,WAAW,GAAI,CAAC1L,iBAAiB,CAACmI,GAAG,CAACwD,eAAL,CAAnB,GAA4CxD,GAAG,CAACwD,eAAhD,GACb,CAAC3L,iBAAiB,CAACF,OAAO,CAACqI,GAAD,EAAM,IAAN,CAAP,CAAmBwD,eAApB,CAAlB,GACG7L,OAAO,CAACqI,GAAD,EAAM,IAAN,CAAP,CAAmBwD,eAAnB,CAAmClB,UAAnC,CAA8C3K,OAAO,CAACqI,GAAD,EAAM,IAAN,CAAP,CAAmBwD,eAAnB,CAAmClB,UAAnC,CAA8CxF,MAA9C,GAAuD,CAArG,CADH,GAEI,CAACjF,iBAAiB,CAACF,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsBwD,eAAvB,CAAnB,GACK7L,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsBwD,eAAtB,CAAsCT,QAAtC,CAA+CC,WAA/C,OAAiE,IAAlE,GAA0ErL,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsBwD,eAAhG,GACIxD,GAFR,GAEcA,GALtB;;MAMA,IAAIA,GAAG,KAAKuD,WAAR,IAAuBvD,GAAG,CAACyD,SAAJ,KAAkB,CAAzC,IACA9L,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsB0D,KAD1B,EACiC;QAC7B,IAAIC,OAAO,GAAGhM,OAAO,CAACqI,GAAD,EAAM,OAAN,CAArB;QACAuD,WAAW,GAAGI,OAAO,CAACV,IAAR,CAAa,CAAb,EAAgBC,KAAhB,CAAsBS,OAAO,CAACV,IAAR,CAAa,CAAb,EAAgBC,KAAhB,CAAsBpG,MAAtB,GAA+B,CAArD,CAAd;MACH;;MACD,IAAI4C,KAAK,CAACQ,OAAN,KAAkB,EAAlB,IAAwBF,GAAG,KAAKuD,WAApC,EAAiD;QAC7CA,WAAW,GAAG5L,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsBwD,eAApC;MACH;;MACD,IAAID,WAAJ,EAAiB;QACb;QACCA,WAAW,CAACJ,WAAZ,CAAwBjH,IAAxB,OAAmC,EAAnC,IAAyCvE,OAAO,CAAC4L,WAAD,EAAc,IAAd,CAAjD,GACI3E,SAAS,CAACwE,gBAAV,CAA2B,KAAKhG,aAAL,CAAmBuB,WAAnB,EAA3B,EAA6D4E,WAA7D,CADJ,GAEI3E,SAAS,CAACyE,gBAAV,CAA2B,KAAKjG,aAAL,CAAmBuB,WAAnB,EAA3B,EAA6D4E,WAA7D,EAA0EA,WAA1E,EAAuF,CAAvF,EAA0F,CAA1F,CAFJ;MAGH;IACJ;EACJ,CA3DD;;EA4DA5K,KAAK,CAACiB,SAAN,CAAgB8G,oBAAhB,GAAuC,UAAUhB,KAAV,EAAiBd,SAAjB,EAA4BoB,GAA5B,EAAiC;IACpE,IAAI4D,OAAO,GAAGhF,SAAS,CAACN,KAAV,CAAgBmE,cAA9B;;IACA,IAAK/C,KAAK,CAACQ,OAAN,KAAkB,EAAlB,IAAwB0D,OAAO,CAAClB,QAAR,KAAqB,CAA7C,KAAmDkB,OAAO,CAACd,WAAR,IAAuBc,OAAO,CAACd,WAAR,CAAoBC,QAApB,KAAiC,IAAxD,IACpDa,OAAO,CAACxB,UAAR,IAAsBwB,OAAO,CAACxB,UAAR,CAAmBW,QAAnB,KAAgC,IADrD,CAAD,IAECrD,KAAK,CAACQ,OAAN,KAAkB,EAAlB,IAAwB0D,OAAO,CAAClB,QAAR,KAAqB,CAA7C,KAAmDkB,OAAO,CAACJ,eAAR,IAA2BI,OAAO,CAACJ,eAAR,CAAwBT,QAAxB,KAAqC,IAAhE,IAChDa,OAAO,CAACxB,UAAR,IAAsBwB,OAAO,CAACxB,UAAR,CAAmBW,QAAnB,KAAgC,IADzD,CAFL,EAGsE;MAClE;IACH;;IACDrD,KAAK,CAACI,cAAN;IACAE,GAAG,CAACyB,SAAJ,CAAcE,MAAd,CAAqBpJ,OAAO,CAACoK,aAA7B;;IACA,IAAIjD,KAAK,CAACQ,OAAN,KAAkB,EAAtB,EAA0B;MACtBF,GAAG,GAAI,CAACnI,iBAAiB,CAACF,OAAO,CAACqI,GAAD,EAAM,IAAN,CAAP,CAAmB6D,kBAApB,CAAnB,GACFlM,OAAO,CAACqI,GAAD,EAAM,IAAN,CAAP,CAAmB6D,kBAAnB,CAAsCC,QAAtC,CAA+C9D,GAAG,CAACyD,SAAnD,CADE,GAED9L,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsB0D,KAAtB,IAA+B1D,GAAG,CAAC+C,QAAJ,KAAiB,IAAjD,GACIpL,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsBiD,IAAtB,CAA2B,CAA3B,EAA8BC,KAA9B,CAAoClD,GAAG,CAACyD,SAAxC,CADJ,GAEK,CAAC5L,iBAAiB,CAACF,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsB8C,WAAvB,CAAnB,GAA0DnL,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsB8C,WAAhF,GACI9C,GALZ;IAMH,CAPD,MAQK;MACDA,GAAG,GAAI,CAACnI,iBAAiB,CAACF,OAAO,CAACqI,GAAD,EAAM,IAAN,CAAP,CAAmB+D,sBAApB,CAAnB,GACFpM,OAAO,CAACqI,GAAD,EAAM,IAAN,CAAP,CAAmB+D,sBAAnB,CAA0CD,QAA1C,CAAmD9D,GAAG,CAACyD,SAAvD,CADE,GAED9L,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsB0D,KAAtB,IAA+B1D,GAAG,CAAC+C,QAAJ,KAAiB,IAAjD,GACIpL,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsB0D,KAAtB,CAA4BT,IAA5B,CAAiC,CAAjC,EAAoCC,KAApC,CAA0ClD,GAAG,CAACyD,SAA9C,CADJ,GAEK,CAAC5L,iBAAiB,CAACF,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsBwD,eAAvB,CAAnB,GAA8D7L,OAAO,CAACqI,GAAD,EAAM,OAAN,CAAP,CAAsBwD,eAApF,GACIxD,GALZ;IAMH;;IACD,IAAIA,GAAJ,EAAS;MACLpB,SAAS,CAACyE,gBAAV,CAA2B,KAAKjG,aAAL,CAAmBuB,WAAnB,EAA3B,EAA6DqB,GAA7D,EAAkEA,GAAlE,EAAuE,CAAvE,EAA0E,CAA1E;IACH;EACJ,CA7BD;;EA8BArH,KAAK,CAACiB,SAAN,CAAgB+B,UAAhB,GAA6B,UAAUqB,IAAV,EAAgB;IACzC,IAAIsB,KAAK,GAAG,KAAK1F,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCC,aAApC,CAAkDC,QAAlD,CAA2D,KAAKtB,aAAL,CAAmBuB,WAAnB,EAA3D,CAAZ,CADyC,CAEzC;;IACA,IAAIC,SAAS,GAAG,KAAKhG,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCC,aAApC,CAAkDI,IAAlD,CAAuDP,KAAvD,EAA8D,KAAKlB,aAAL,CAAmBuB,WAAnB,EAA9D,CAAhB,CAHyC,CAIzC;;IACA,IAAIqF,aAAa,GAAG,KAAKC,QAAL,CAAc5D,gBAAd,CAA+B,gBAA/B,CAApB;;IACA,KAAK,IAAIxD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmH,aAAa,CAAClH,MAAlC,EAA0CD,CAAC,EAA3C,EAA+C;MAC3CmH,aAAa,CAACnH,CAAD,CAAb,CAAiBqH,KAAjB,CAAuBC,eAAvB,GAAyCnH,IAAI,CAACgB,IAAL,CAAUoG,KAAnD;IACH;;IACD,KAAKxL,MAAL,CAAY2F,SAAZ,CAAsBuD,QAAtB;EACH,CAVD;;EAWAnJ,KAAK,CAACiB,SAAN,CAAgB6F,qBAAhB,GAAwC,YAAY;IAChD,IAAI,KAAK4E,YAAL,IAAqB,KAAKA,YAAL,CAAkBC,UAAvC,IAAqDrG,QAAQ,CAACC,IAAT,CAAcC,QAAd,CAAuB,KAAKkG,YAAL,CAAkBC,UAAlB,CAA6BjL,OAApD,CAAzD,EAAuH;MACnH,KAAKgL,YAAL,CAAkBC,UAAlB,CAA6BC,SAA7B;IACH;EACJ,CAJD;;EAKA5L,KAAK,CAACiB,SAAN,CAAgBwH,WAAhB,GAA8B,UAAUxC,SAAV,EAAqB9C,CAArB,EAAwB;IAClD,KAAKlD,MAAL,CAAY2F,SAAZ,CAAsBiB,OAAtB,CAA8B,KAAK5G,MAAnC,EAA2CkD,CAA3C,EAA8CA,CAAC,CAACiF,aAAhD,EAA+D;MAAEnC,SAAS,EAAEA,SAAb;MAAwBI,UAAU,EAAElD,CAAC,CAACkC,IAAF,CAAOgB;IAA3C,CAA/D;EACH,CAFD;;EAGArG,KAAK,CAACiB,SAAN,CAAgBc,oBAAhB,GAAuC,UAAUoB,CAAV,EAAa;IAChD,IAAI,KAAKlD,MAAL,CAAY4L,QAAZ,IAAwB,CAAC1M,KAAK,CAACH,OAAO,CAACmE,CAAC,CAACkB,IAAF,CAAOD,MAAR,EAAgB,gBAAhB,CAAR,CAAlC,EAA8E;MAC1E;IACH;;IACD,IAAIC,IAAI,GAAGlB,CAAC,CAACkB,IAAb;IACA,IAAIyH,gBAAgB,GAAG,KAAK7L,MAAL,CAAY8L,oBAAZ,CAAiCD,gBAAxD;;IACA,IAAIzH,IAAI,CAAC2H,KAAL,KAAe,CAAf,IAAqBF,gBAAgB,IAAIzH,IAAI,CAAC2H,KAAL,KAAe,CAAxD,IAA+D,CAACF,gBAAD,IAAqBzH,IAAI,CAAC2H,KAAL,KAAe,CAAvG,EAA2G;MACvG;IACH;;IACD,IAAI,KAAK/L,MAAL,CAAYiI,UAAZ,KAA2B,MAA3B,IAAqC,KAAKjI,MAAL,CAAYgM,kBAAjD,IAAuE,KAAKhM,MAAL,CAAYgM,kBAAZ,CAA+BN,UAA1G,EAAsH;MAClH,KAAKD,YAAL,GAAoB,KAAKzL,MAAL,CAAYgM,kBAAhC;MACA,IAAI7H,MAAM,GAAGC,IAAI,CAACD,MAAlB;MACA,KAAKK,aAAL,GAAqB,KAAK3D,eAAL,CAAqB8D,WAArB,CAAiClF,UAAU,CAACmF,OAA5C,CAArB;MACA,IAAIqH,WAAW,GAAG,KAAKR,YAAL,CAAkBC,UAAlB,CAA6BjL,OAA7B,CAAqCoI,SAArC,CAA+CtD,QAA/C,CAAwD,WAAxD,CAAlB;;MACA,IAAI0G,WAAJ,EAAiB;QACb;MACH;;MACD,IAAIvG,KAAK,GAAG,KAAK1F,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCC,aAApC,CAAkDC,QAAlD,CAA2D,KAAKtB,aAAL,CAAmBuB,WAAnB,EAA3D,CAAZ;MACA,IAAImG,YAAY,GAAGnN,OAAO,CAACoF,MAAD,EAAS,OAAT,CAA1B;MACA,IAAIgI,SAAS,GAAG,KAAKnM,MAAL,CAAY8F,QAAZ,GAAuB+D,cAAvB,CAAsCxC,aAAtD;MACA,IAAI+E,OAAO,GAAG,KAAKpM,MAAL,CAAY8F,QAAZ,GAAuBuG,YAAvB,CAAoChF,aAAlD;;MACA,IAAIlD,MAAM,IAAIA,MAAM,CAACgG,QAAP,KAAoB,GAA9B,IAAqChG,MAAM,CAACgG,QAAP,KAAoB,KAAzD,IAAkEgC,SAAS,KAAKC,OAAhF,KAA4FjI,MAAM,CAACgG,QAAP,KAAoB,IAApB,IAA4BhG,MAAM,CAACgG,QAAP,KAAoB,IAAhD,IAC5FhG,MAAM,CAACgG,QAAP,KAAoB,OADwE,IAC5D+B,YAAY,IAAI,KAAKlM,MAAL,CAAYwE,aAAZ,CAA0BC,YAA1B,GAAyCc,QAAzC,CAAkD2G,YAAlD,CADhD,KAEG,EAAExG,KAAK,CAACmE,cAAN,CAAqBC,QAArB,KAAkC,CAAlC,IAAuC,CAACpE,KAAK,CAAC4G,SAAhD,CAFP,EAEmE;QAC/D,IAAIC,OAAO,GAAG,KAAKvM,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCC,aAApC,CAAkDC,QAAlD,CAA2D,KAAKtB,aAAL,CAAmBuB,WAAnB,EAA3D,CAAd;QACA,KAAK/F,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCC,aAApC,CAAkDI,IAAlD,CAAuDsG,OAAvD,EAAgE,KAAK/H,aAAL,CAAmBuB,WAAnB,EAAhE;QACA,KAAK/F,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCC,aAApC,CAAkD2G,KAAlD,CAAwD,KAAKhI,aAAL,CAAmBuB,WAAnB,EAAxD;QACA,IAAI3F,KAAK,GAAI,KAAKJ,MAAL,CAAYyM,cAAZ,CAA2BC,MAA5B,GAAsCC,MAAM,CAACC,WAAP,GAC9C,KAAK5M,MAAL,CAAYS,OAAZ,CAAoBoM,qBAApB,GAA4CC,GADE,GACI1I,IAAI,CAAC2I,OAD/C,GACyD3I,IAAI,CAAChE,KAD1E;QAEA,KAAKqL,YAAL,CAAkBC,UAAlB,CAA6BsB,SAA7B,CAAuC5I,IAAI,CAACjE,KAA5C,EAAmDC,KAAnD,EAA0D+D,MAA1D;QACA,KAAKnE,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCC,aAApC,CAAkDsD,OAAlD;MACH,CAVD,MAWK;QACD,KAAKtC,qBAAL;MACH;IACJ;EACJ,CApCD;;EAqCA9G,KAAK,CAACiB,SAAN,CAAgBiM,eAAhB,GAAkC,UAAU/J,CAAV,EAAa;IAC3C,IAAIiB,MAAM,GAAGjB,CAAC,CAACiB,MAAf;IACA,IAAI+I,GAAG,GAAGC,KAAK,CAACnM,SAAN,CAAgBoM,KAAhB,CAAsBC,IAAtB,CAA2BlJ,MAAM,CAACkD,aAAP,CAAqBA,aAArB,CAAmC6D,QAA9D,EAAwEoC,OAAxE,CAAgFnJ,MAAM,CAACkD,aAAvF,CAAV;IACA,IAAIkG,GAAG,GAAGJ,KAAK,CAACnM,SAAN,CAAgBoM,KAAhB,CAAsBC,IAAtB,CAA2BlJ,MAAM,CAACkD,aAAP,CAAqB6D,QAAhD,EAA0DoC,OAA1D,CAAkEnJ,MAAlE,CAAV;IACA,IAAIqJ,IAAI,GAAG,KAAKC,MAAL,CAAYhG,gBAAZ,CAA6B,kBAA7B,CAAX;IACA0F,KAAK,CAACnM,SAAN,CAAgB0M,OAAhB,CAAwBL,IAAxB,CAA6BG,IAA7B,EAAmC,UAAUpI,IAAV,EAAgB;MAC/C,IAAIuI,WAAW,GAAGR,KAAK,CAACnM,SAAN,CAAgBoM,KAAhB,CAAsBC,IAAtB,CAA2BjI,IAAI,CAACiC,aAAL,CAAmBA,aAAnB,CAAiC6D,QAA5D,EAAsEoC,OAAtE,CAA8ElI,IAAI,CAACiC,aAAnF,CAAlB;MACA,IAAIwD,SAAS,GAAGsC,KAAK,CAACnM,SAAN,CAAgBoM,KAAhB,CAAsBC,IAAtB,CAA2BjI,IAAI,CAACiC,aAAL,CAAmB6D,QAA9C,EAAwDoC,OAAxD,CAAgElI,IAAhE,CAAhB;MACA/F,WAAW,CAAC,CAAC+F,IAAD,CAAD,EAAS,UAAT,CAAX;;MACA,IAAIuI,WAAW,IAAIT,GAAf,IAAsBrC,SAAS,IAAI0C,GAAvC,EAA4C;QACxCnO,QAAQ,CAAC,CAACgG,IAAD,CAAD,EAAS,UAAT,CAAR;MACH;IACJ,CAPD;IAQA,KAAKwI,SAAL,CAAeC,SAAf,GAA4BN,GAAG,GAAG,CAAP,GAAY,GAAZ,IAAmBL,GAAG,GAAG,CAAzB,CAA3B;EACH,CAdD,CA1bmC,CAycnC;;;EACAnN,KAAK,CAACiB,SAAN,CAAgB8M,YAAhB,GAA+B,UAAU5K,CAAV,EAAa;IACxC/D,YAAY,CAAC4J,MAAb,CAAoB,KAAKsC,QAAzB,EAAmC,WAAnC,EAAgD,KAAK0C,SAArD;EACH,CAFD,CA1cmC,CA6cnC;;;EACAhO,KAAK,CAACiB,SAAN,CAAgBgN,cAAhB,GAAiC,UAAU9K,CAAV,EAAa;IAC1C7D,WAAW,CAAC,KAAKoO,MAAL,CAAYhG,gBAAZ,CAA6B,kBAA7B,CAAD,EAAmD,UAAnD,CAAX;IACArI,QAAQ,CAAC,CAAC,KAAKqO,MAAL,CAAYjI,aAAZ,CAA0B,kBAA1B,CAAD,CAAD,EAAkD,UAAlD,CAAR;IACA,KAAKoI,SAAL,CAAeC,SAAf,GAA2B,IAAI,GAAJ,GAAU,CAArC;EACH,CAJD;;EAKA9N,KAAK,CAACiB,SAAN,CAAgBiN,cAAhB,GAAiC,UAAU/K,CAAV,EAAa;IAC1C,IAAIiB,MAAM,GAAGjB,CAAC,CAACiB,MAAf;IACA,IAAI+I,GAAG,GAAGC,KAAK,CAACnM,SAAN,CAAgBoM,KAAhB,CAAsBC,IAAtB,CAA2BlJ,MAAM,CAACkD,aAAP,CAAqBA,aAArB,CAAmC6D,QAA9D,EAAwEoC,OAAxE,CAAgFnJ,MAAM,CAACkD,aAAvF,IAAwG,CAAlH;IACA,IAAIkG,GAAG,GAAGJ,KAAK,CAACnM,SAAN,CAAgBoM,KAAhB,CAAsBC,IAAtB,CAA2BlJ,MAAM,CAACkD,aAAP,CAAqB6D,QAAhD,EAA0DoC,OAA1D,CAAkEnJ,MAAlE,IAA4E,CAAtF;IACA,KAAKkE,IAAL,CAAU6F,WAAV,CAAsBhB,GAAtB,EAA2BK,GAA3B,EAAgCrK,CAAhC,EAAmC,IAAnC;EACH,CALD;;EAMAnD,KAAK,CAACiB,SAAN,CAAgBkN,WAAhB,GAA8B,UAAUhB,GAAV,EAAeK,GAAf,EAAoBrK,CAApB,EAAuBiL,YAAvB,EAAqC;IAC/D,IAAIpH,KAAK,GAAIoH,YAAY,CAAC9F,IAAd,GAAsB8F,YAAY,CAAC9F,IAAnC,GAA0C,IAAtD;IACA,IAAIwB,cAAc,GAAGsE,YAAY,CAACnI,SAAb,CAAuBN,KAAvB,CAA6BmE,cAAlD;;IACA,IAAIA,cAAc,CAACM,QAAf,KAA4B,GAA5B,IAAmCN,cAAc,CAACU,WAAf,CAA2BjH,IAA3B,OAAsC,EAAzE,IAA+E,EAAEuG,cAAc,CAACH,UAAf,CAA0BxF,MAA1B,GAAmC,CAArC,CAAnF,EAA4H;MACxH2F,cAAc,CAACgE,SAAf,GAA2B,QAA3B;IACH;;IACD,IAAIrE,UAAU,GAAGK,cAAc,CAACL,UAAhC;;IACA,IAAIzC,KAAK,CAAC/G,MAAN,CAAaiI,UAAb,KAA4B,MAA5B,KACElB,KAAK,CAAC/G,MAAN,CAAayM,cAAb,CAA4BC,MAA5B,IAAsC,CAAC5M,QAAQ,CAAC0J,UAAU,CAAC4E,aAAX,CAAyB5I,aAAzB,CAAuC,MAAvC,CAAD,EAAiD,OAAjD,CAAhD,IACG;IACC,CAACuB,KAAK,CAAC/G,MAAN,CAAayM,cAAb,CAA4BC,MAA7B,IAAuCxN,KAAK,CAACH,OAAO,CAACyK,UAAD,EAAa,SAAS,GAAT,GAAezC,KAAK,CAACvC,aAAN,CAAoB6J,QAApB,GAA+B3N,EAA9C,GAAmD,GAAnD,GAAyD,GAAtE,CAAR,CAHjD,CAAJ,EAG4I;MACxIqG,KAAK,CAACvC,aAAN,CAAoBC,YAApB,GAAmCuD,KAAnC;MACA,IAAItC,KAAK,GAAGqB,KAAK,CAAC/G,MAAN,CAAa2F,SAAb,CAAuBC,aAAvB,CAAqCC,aAArC,CAAmDC,QAAnD,CAA4DiB,KAAK,CAACvC,aAAN,CAAoBuB,WAApB,EAA5D,CAAZ;MACAoI,YAAY,CAACnI,SAAb,GAAyBe,KAAK,CAAC/G,MAAN,CAAa2F,SAAb,CAAuBC,aAAvB,CAAqCC,aAArC,CAAmDI,IAAnD,CAAwDP,KAAxD,EAA+DqB,KAAK,CAACvC,aAAN,CAAoBuB,WAApB,EAA/D,CAAzB;IACH;;IACD,IAAIyF,KAAK,GAAG;MACRnB,IAAI,EAAE6C,GADE;MACGoB,OAAO,EAAEf,GADZ;MACiBgB,KAAK,EAAE;QAC5BC,QAAQ,EAAEzH,KAAK,CAAC/G,MAAN,CAAa6E,aAAb,CAA2B2J,QADT;QAE5BC,QAAQ,EAAE1H,KAAK,CAAC/G,MAAN,CAAa6E,aAAb,CAA2B4J,QAFT;QAG5BF,KAAK,EAAExH,KAAK,CAAC/G,MAAN,CAAa6E,aAAb,CAA2B0J;MAHN,CADxB;MAMRvI,SAAS,EAAEmI,YAAY,CAACnI;IANhB,CAAZ;;IAQA,IAAIe,KAAK,CAACvD,QAAV,EAAoB;MAChBuD,KAAK,CAACvD,QAAN,CAAe8E,IAAf;IACH;;IACD,IAAIvB,KAAK,CAACrD,UAAV,EAAsB;MAClBqD,KAAK,CAACrD,UAAN,CAAiB4E,IAAjB;IACH;;IACDvB,KAAK,CAAC/G,MAAN,CAAa2F,SAAb,CAAuBiB,OAAvB,CAA+BG,KAAK,CAAC/G,MAArC,EAA6CmO,YAAY,CAAC/J,IAA1D,EAAgE+J,YAAY,CAAC/J,IAAb,CAAkB+D,aAAlF,EAAiGqD,KAAjG;IACAzE,KAAK,CAACvC,aAAN,CAAoBC,YAApB,GAAmCuD,KAAnC;IACAjB,KAAK,CAAC/G,MAAN,CAAakB,EAAb,CAAgB1B,MAAM,CAACoD,SAAvB,EAAkCmE,KAAK,CAAClE,UAAxC,EAAoDkE,KAApD;EACH,CAhCD;;EAiCAhH,KAAK,CAACiB,SAAN,CAAgB6B,UAAhB,GAA6B,UAAUK,CAAV,EAAa;IACtC,IAAIiB,MAAM,GAAGjB,CAAC,CAACkB,IAAF,CAAOD,MAApB;IACA,IAAIuK,MAAM,GAAG3P,OAAO,CAACoF,MAAD,EAAS,OAAT,CAApB;IACAA,MAAM,GAAIA,MAAM,CAACgG,QAAP,KAAoB,IAApB,IAA4BuE,MAA5B,IAAsC,KAAK1O,MAAL,CAAYwE,aAAZ,CAA0BC,YAA1B,GAAyCc,QAAzC,CAAkDmJ,MAAlD,CAAvC,GACLA,MADK,GACIvK,MADb;IAEA9E,WAAW,CAAC,KAAKmF,aAAL,CAAmBC,YAAnB,GAAkCgD,gBAAlC,CAAmD,oBAAnD,CAAD,EAA2E9H,OAAO,CAACoK,aAAnF,CAAX;;IACA,IAAI5F,MAAM,KAAKA,MAAM,CAACI,OAAP,KAAmB,IAAnB,IAA2BJ,MAAM,CAACI,OAAP,KAAmB,IAAnD,CAAV,EAAoE;MAChEnF,QAAQ,CAAC,CAAC+E,MAAD,CAAD,EAAWxE,OAAO,CAACoK,aAAnB,CAAR;MACA,KAAK4E,UAAL,GAAkBxK,MAAlB;MACA,KAAKkH,QAAL,GAAiB,KAAKA,QAAN,GAAkB,KAAKA,QAAvB,GAAkCtM,OAAO,CAACoF,MAAD,EAAS,OAAT,CAAzD;MACAhF,YAAY,CAAC4F,GAAb,CAAiB,KAAKsG,QAAtB,EAAgC,WAAhC,EAA6C,KAAK0C,SAAlD,EAA6D,IAA7D;MACA5O,YAAY,CAAC4F,GAAb,CAAiB,KAAKsG,QAAtB,EAAgC,SAAhC,EAA2C,KAAKyC,YAAhD,EAA8D,IAA9D;MACA,KAAKpG,mBAAL;;MACA,IAAI,KAAKkH,MAAL,IAAe,KAAKpK,aAAL,CAAmBC,YAAnB,GAAkCc,QAAlC,CAA2C,KAAKqJ,MAAhD,CAAnB,EAA4E;QACxE9P,MAAM,CAAC,KAAK8P,MAAN,CAAN;MACH;IACJ;;IACD,IAAI5P,OAAO,CAACqF,IAAR,CAAaC,IAAb,KAAsB,SAAtB,IAAmC,CAACpF,KAAK,CAACH,OAAO,CAACoF,MAAD,EAAS,OAAT,CAAR,CAAzC,IACApF,OAAO,CAACoF,MAAD,EAAS,OAAT,CAAP,CAAyBI,OAAzB,KAAqC,OADzC,EACkD;MAC9C,KAAKvE,MAAL,CAAYwE,aAAZ,CAA0BC,YAA1B,GAAyCC,YAAzC,CAAsD,iBAAtD,EAAyE,OAAzE;IACH;EACJ,CArBD;;EAsBA3E,KAAK,CAACiB,SAAN,CAAgB+M,SAAhB,GAA4B,UAAUjH,KAAV,EAAiB;IACzC,KAAK9G,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCiJ,QAApC,CAA6CC,MAA7C,CAAoD,YAApD,EAAkE;MAAEhI,KAAK,EAAEA,KAAT;MAAgBiI,UAAU,EAAE,CAAC,KAAKJ,UAAN;IAA5B,CAAlE;EACH,CAFD;;EAGA5O,KAAK,CAACiB,SAAN,CAAgBmE,YAAhB,GAA+B,UAAUjC,CAAV,EAAa;IACxC,IAAI,KAAKlD,MAAL,CAAY4L,QAAhB,EAA0B;MACtB;IACH;;IACD,IAAIzH,MAAM,GAAGjB,CAAC,CAACiB,MAAF,IAAYjB,CAAC,CAAC8L,aAAF,CAAgB,CAAhB,EAAmB7K,MAA5C;IACA,IAAI+H,YAAY,GAAGnN,OAAO,CAACoF,MAAD,EAAS,mBAAT,CAA1B;;IACA,IAAI,CAACjF,KAAK,CAAC,KAAKmM,QAAN,CAAN,IAAyB,CAACnM,KAAK,CAACgN,YAAD,CAA/B,IAAiDA,YAAY,KAAK,KAAKb,QAA3E,EAAqF;MACjF,KAAK3D,mBAAL;MACA,KAAKuH,YAAL,CAAkB/L,CAAlB;MACA,KAAKgM,kBAAL;IACH;;IACD,IAAI/K,MAAM,CAACgG,QAAP,KAAoB,OAApB,IAA+BhG,MAAM,CAACgG,QAAP,KAAoB,IAAnD,IAA2DhG,MAAM,CAACgG,QAAP,KAAoB,IAAnF,EAAyF;MACrF,KAAKkB,QAAL,GAAiBa,YAAY,IAAI,KAAKlM,MAAL,CAAYwE,aAAZ,CAA0BC,YAA1B,GAAyCc,QAAzC,CAAkD2G,YAAlD,CAAjB,KACR/H,MAAM,CAACgG,QAAP,KAAoB,IAApB,IAA4BhG,MAAM,CAACgG,QAAP,KAAoB,IADxC,IAEZ+B,YAFY,GAEG/H,MAFnB;MAGA,KAAKuD,mBAAL;MACA,KAAKyH,sBAAL,CAA4B,KAAK9D,QAAjC,EAA2CnI,CAA3C;IACH;EACJ,CAlBD;;EAmBAnD,KAAK,CAACiB,SAAN,CAAgBmO,sBAAhB,GAAyC,UAAUvG,KAAV,EAAiB1F,CAAjB,EAAoB;IACzD,KAAKlD,MAAL,CAAYoP,oBAAZ,CAAiClM,CAAjC;IACA,IAAIoL,OAAO,GAAG1F,KAAK,CAACyB,IAAN,CAAW,KAAKgF,SAAL,CAAezG,KAAf,CAAX,EAAkC0B,KAAhD;IACA,IAAID,IAAI,GAAG,EAAX;;IACA,KAAK,IAAIpG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2E,KAAK,CAACyB,IAAN,CAAWnG,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;MACxCoG,IAAI,CAACZ,IAAL,CAAU0D,KAAK,CAACnM,SAAN,CAAgBoM,KAAhB,CAAsBC,IAAtB,CAA2BzE,KAAK,CAACyB,IAAN,CAAWpG,CAAX,EAAcqG,KAAzC,EAAgD,CAAhD,EAAmD,CAAnD,EAAsD,CAAtD,CAAV;IACH;;IACD,IAAIgF,MAAM,GAAGC,QAAQ,CAACC,gBAAgB,CAAC5G,KAAD,CAAhB,CAAwB0G,MAAzB,EAAiC,EAAjC,CAArB;IACA,IAAIf,KAAK,GAAGgB,QAAQ,CAACC,gBAAgB,CAAC5G,KAAD,CAAhB,CAAwB2F,KAAzB,EAAgC,EAAhC,CAApB;IACA,IAAIkB,GAAG,GAAG,KAAKC,OAAL,CAAa9G,KAAb,CAAV;;IACA,KAAK,IAAI3E,CAAC,GAAG,CAAb,EAAgBqK,OAAO,CAACpK,MAAR,IAAkBD,CAAlC,EAAqCA,CAAC,EAAtC,EAA0C;MACtC,IAAI0L,QAAQ,GAAG,KAAK3P,MAAL,CAAY4P,aAAZ,CAA0B,MAA1B,EAAkC;QAC7CC,KAAK,EAAE;UACH,YAAa5L,CAAD,CAAI6L,QAAJ,EADT;UACyB,gBAAgB,IADzC;UAC+C,mBAAmB;QADlE;MADsC,CAAlC,CAAf;MAKAH,QAAQ,CAAC9G,SAAT,CAAmB9D,GAAnB,CAAuBpF,OAAO,CAACoQ,oBAA/B,EAAqDpQ,OAAO,CAACqQ,cAA7D;;MACA,IAAI1B,OAAO,CAACpK,MAAR,KAAmBD,CAAvB,EAA0B;QACtB0L,QAAQ,CAACrE,KAAT,CAAe2E,OAAf,GAAyB,aAAaX,MAAb,GAAsB,uBAAtB,GAAgDG,GAAG,CAAC3C,GAApD,GACrB,WADqB,IACN2C,GAAG,CAACS,IAAJ,GAAW,KAAKR,OAAL,CAAapB,OAAO,CAACrK,CAAC,GAAG,CAAL,CAApB,EAA6BiM,IAAxC,GAA+C5B,OAAO,CAACrK,CAAC,GAAG,CAAL,CAAP,CAAekM,WADxD,IACuE,KADhG;MAEH,CAHD,MAIK;QACDR,QAAQ,CAACrE,KAAT,CAAe2E,OAAf,GAAyB,aAAaX,MAAb,GAAsB,uBAAtB,GAAgDG,GAAG,CAAC3C,GAApD,GACrB,WADqB,IACN2C,GAAG,CAACS,IAAJ,GAAW,KAAKR,OAAL,CAAapB,OAAO,CAACrK,CAAD,CAApB,EAAyBiM,IAD9B,IACsC,KAD/D;MAEH;;MACD,KAAK1L,aAAL,CAAmBC,YAAnB,GAAkC2L,WAAlC,CAA8CT,QAA9C;IACH;;IACD,KAAK,IAAI1L,CAAC,GAAG,CAAb,EAAgBoG,IAAI,CAACnG,MAAL,GAAcD,CAA9B,EAAiCA,CAAC,EAAlC,EAAsC;MAClC,IAAIoM,QAAQ,GAAG,KAAKrQ,MAAL,CAAY4P,aAAZ,CAA0B,MAA1B,EAAkC;QAC7CC,KAAK,EAAE;UACH,YAAa5L,CAAD,CAAI6L,QAAJ,EADT;UACyB,gBAAgB,IADzC;UAC+C,mBAAmB;QADlE;MADsC,CAAlC,CAAf;MAKAO,QAAQ,CAACxH,SAAT,CAAmB9D,GAAnB,CAAuBpF,OAAO,CAACoQ,oBAA/B,EAAqDpQ,OAAO,CAAC2Q,cAA7D;MACA,IAAIC,UAAU,GAAG,CAACrR,KAAK,CAAC0J,KAAK,CAAC4H,YAAN,CAAmB,aAAnB,CAAD,CAAN,IAA6C5H,KAAK,CAAC4H,YAAN,CAAmB,aAAnB,MAAsC,EAAnF,GACb,CADa,GACT,KAAKd,OAAL,CAAarF,IAAI,CAACpG,CAAD,CAAjB,EAAsBiM,IAD9B;MAEAG,QAAQ,CAAC/E,KAAT,CAAe2E,OAAf,GAAyB,YAAY1B,KAAZ,GAAoB,wBAApB,IACpB,KAAKmB,OAAL,CAAarF,IAAI,CAACpG,CAAD,CAAjB,EAAsB6I,GAAtB,GAA4B2C,GAAG,CAAC3C,GAAhC,GAAsCzC,IAAI,CAACpG,CAAD,CAAJ,CAAQwM,YAA9C,GAA6D,CADzC,IAErB,WAFqB,IAENF,UAAU,GAAGd,GAAG,CAACS,IAFX,IAEmB,KAF5C;MAGA,KAAK1L,aAAL,CAAmBC,YAAnB,GAAkC2L,WAAlC,CAA8CC,QAA9C;IACH;;IACD,IAAIK,UAAU,GAAG,KAAK1Q,MAAL,CAAY4P,aAAZ,CAA0B,MAA1B,EAAkC;MAC/Ce,SAAS,EAAEhR,OAAO,CAACiR,cAAR,GAAyB,GAAzB,GAA+B,KAAK5Q,MAAL,CAAYmD,QADP;MACiB0M,KAAK,EAAE;QACnE,YAAYvB,OAAO,CAACpK,MAAR,CAAe4L,QAAf,EADuD;QAC5B,gBAAgB,IADY;QACN,mBAAmB;MADb;IADxB,CAAlC,CAAjB;IAKAY,UAAU,CAACpF,KAAX,CAAiB2E,OAAjB,GAA2B,WAAWR,GAAG,CAAC3C,GAAJ,GAAUwC,MAAV,GAAmB,CAA9B,IACvB,WADuB,IACRG,GAAG,CAACS,IAAJ,GAAW3B,KAAX,GAAmB,CADX,IACgB,KAD3C;;IAEA,IAAIvP,OAAO,CAACkG,QAAZ,EAAsB;MAClBwL,UAAU,CAAC7H,SAAX,CAAqB9D,GAArB,CAAyB,QAAzB;IACH;;IACD,KAAKP,aAAL,CAAmBC,YAAnB,GAAkC2L,WAAlC,CAA8CM,UAA9C;EACH,CApDD;;EAqDA3Q,KAAK,CAACiB,SAAN,CAAgB0G,mBAAhB,GAAsC,YAAY;IAC9C,IAAItC,IAAI,GAAG,KAAKpF,MAAL,CAAYwE,aAAZ,CAA0BC,YAA1B,GACPgD,gBADO,CACU,+CADV,CAAX;;IAEA,IAAIrC,IAAI,CAAClB,MAAL,GAAc,CAAlB,EAAqB;MACjB,KAAK,IAAID,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmB,IAAI,CAAClB,MAAzB,EAAiCD,CAAC,EAAlC,EAAsC;QAClCnF,MAAM,CAACsG,IAAI,CAACnB,CAAD,CAAL,CAAN;MACH;IACJ;EACJ,CARD;;EASAlE,KAAK,CAACiB,SAAN,CAAgB0O,OAAhB,GAA0B,UAAUmB,IAAV,EAAgB;IACtC,IAAIC,YAAY,GAAG;MACfhE,GAAG,EAAE,CADU;MAEfoD,IAAI,EAAE;IAFS,CAAnB,CADsC,CAKtC;;IACA,IAAIa,MAAM,GAAGF,IAAI,CAAChE,qBAAL,EAAb;IACA,IAAImE,GAAG,GAAGH,IAAI,CAACzC,aAAf;IACA,IAAI6C,YAAY,GAAGJ,IAAI,CAACI,YAAL,IAAqBD,GAAG,CAACE,eAA5C;IACA,IAAIC,aAAa,GAAG,KAApB;;IACA,OAAOF,YAAY,KACdA,YAAY,KAAKD,GAAG,CAAC1L,IAArB,IAA6B2L,YAAY,KAAKD,GAAG,CAACE,eADpC,CAAZ,IAEHD,YAAY,CAAC3F,KAAb,CAAmB8F,QAAnB,KAAgC,QAFpC,EAE8C;MAC1CH,YAAY,GAAGA,YAAY,CAACzH,UAA5B;IACH;;IACD,IAAIyH,YAAY,CAAC9G,QAAb,KAA0B,IAA1B,IAAkC0G,IAAI,CAAC1G,QAAL,KAAkB,OAAxD,EAAiE;MAC7D8G,YAAY,GAAGlS,OAAO,CAACkS,YAAD,EAAe,gBAAf,CAAtB;MACAE,aAAa,GAAG,IAAhB;IACH;;IACD,IAAIF,YAAY,IAAIA,YAAY,KAAKJ,IAAjC,IAAyCI,YAAY,CAACnH,QAAb,KAA0B,CAAvE,EAA0E;MACtE;MACAgH,YAAY,GAAGG,YAAY,CAACpE,qBAAb,EAAf;IACH;;IACD,IAAIsE,aAAJ,EAAmB;MACfA,aAAa,GAAG,KAAhB;MACA,IAAIE,QAAQ,GAAG,KAAKrR,MAAL,CAAY4H,YAAZ,IAA4B,KAAK5H,MAAL,CAAY4H,YAAZ,CAAyB0J,SAAzB,GAAqC,CAAjE,GACV,KAAKtR,MAAL,CAAY4H,YAAZ,CAAyB0J,SAAzB,GAAqCP,MAAM,CAACjE,GAA7C,GAAoDgE,YAAY,CAAChE,GADtD,GAC4DiE,MAAM,CAACjE,GAAP,GAAagE,YAAY,CAAChE,GADrG;MAEA,IAAIyE,SAAS,GAAG,KAAKvR,MAAL,CAAY4H,YAAZ,IAA4B,KAAK5H,MAAL,CAAY4H,YAAZ,CAAyB4J,UAAzB,GAAsC,CAAlE,GACX,KAAKxR,MAAL,CAAY4H,YAAZ,CAAyB4J,UAAzB,GAAsCT,MAAM,CAACb,IAA9C,GAAsDY,YAAY,CAACZ,IADvD,GAC8Da,MAAM,CAACb,IAAP,GAAcY,YAAY,CAACZ,IADzG;MAEA,OAAO;QACHpD,GAAG,EAAEuE,QADF;QAEHnB,IAAI,EAAEqB;MAFH,CAAP;IAIH,CAVD,MAWK;MACD,OAAO;QACHzE,GAAG,EAAE+D,IAAI,CAACY,SADP;QAEHvB,IAAI,EAAEW,IAAI,CAACa;MAFR,CAAP;IAIH;EACJ,CAxCD;;EAyCA3R,KAAK,CAACiB,SAAN,CAAgB2Q,SAAhB,GAA4B,UAAUzO,CAAV,EAAa;IACrC,IAAIA,CAAC,CAAC0O,OAAF,IAAa1O,CAAC,CAAC0O,OAAF,CAAU1N,MAA3B,EAAmC;MAC/B,OAAOhB,CAAC,CAAC0O,OAAF,CAAU,CAAV,EAAazR,KAApB;IACH,CAFD,MAGK;MACD,OAAO+C,CAAC,CAAC/C,KAAT;IACH;EACJ,CAPD;;EAQAJ,KAAK,CAACiB,SAAN,CAAgB6Q,SAAhB,GAA4B,UAAU3O,CAAV,EAAa;IACrC,IAAIA,CAAC,CAAC0O,OAAF,IAAa1O,CAAC,CAAC0O,OAAF,CAAU1N,MAA3B,EAAmC;MAC/B,OAAOhB,CAAC,CAAC0O,OAAF,CAAU,CAAV,EAAaxR,KAApB;IACH,CAFD,MAGK;MACD,OAAO8C,CAAC,CAAC9C,KAAT;IACH;EACJ,CAPD;;EAQAL,KAAK,CAACiB,SAAN,CAAgBiE,WAAhB,GAA8B,UAAU/B,CAAV,EAAa;IACvC,IAAI4O,KAAK,GAAG,IAAZ;;IACA,IAAI,KAAK9R,MAAL,CAAY4L,QAAhB,EAA0B;MACtB;IACH;;IACD,IAAI5M,OAAO,CAACkG,QAAZ,EAAsB;MAClB,KAAKC,YAAL,CAAkBjC,CAAlB;IACH;;IACD,IAAIiB,MAAM,GAAGjB,CAAC,CAACiB,MAAf;;IACA,IAAIA,MAAM,CAAC0E,SAAP,CAAiBtD,QAAjB,CAA0B5F,OAAO,CAACqQ,cAAlC,KACA7L,MAAM,CAAC0E,SAAP,CAAiBtD,QAAjB,CAA0B5F,OAAO,CAAC2Q,cAAlC,CADA,IAEAnM,MAAM,CAAC0E,SAAP,CAAiBtD,QAAjB,CAA0B5F,OAAO,CAACiR,cAAlC,CAFJ,EAEuD;MACnD1N,CAAC,CAACgE,cAAF;MACA,KAAKlH,MAAL,CAAYoP,oBAAZ,CAAiClM,CAAjC;MACA7D,WAAW,CAAC,KAAKgM,QAAL,CAAc5D,gBAAd,CAA+B,OAA/B,CAAD,EAA0C9H,OAAO,CAACoK,aAAlD,CAAX;MACA,KAAK/J,MAAL,CAAY2F,SAAZ,CAAsBC,aAAtB,CAAoCC,aAApC,CAAkD2G,KAAlD,CAAwD,KAAKhI,aAAL,CAAmBuB,WAAnB,EAAxD;MACA,KAAK5F,KAAL,GAAa,KAAKwR,SAAL,CAAezO,CAAf,CAAb;MACA,KAAK9C,KAAL,GAAa,KAAKyR,SAAL,CAAe3O,CAAf,CAAb;MACA,KAAK6O,aAAL;MACA,KAAKlL,qBAAL;;MACA,IAAI1C,MAAM,CAAC0E,SAAP,CAAiBtD,QAAjB,CAA0B5F,OAAO,CAACqQ,cAAlC,CAAJ,EAAuD;QACnD,KAAKgC,aAAL,CAAmBC,MAAnB,GAA4B,IAA5B;;QACA,IAAI1C,QAAQ,CAACpL,MAAM,CAACqM,YAAP,CAAoB,UAApB,CAAD,EAAkC,EAAlC,CAAR,KAAkD,KAAKnF,QAAL,CAAchB,IAAd,CAAmB,KAAKgF,SAAL,CAAe,KAAKhE,QAApB,CAAnB,EAAkDf,KAAlD,CAAwDpG,MAA9G,EAAsH;UAClH,KAAK5D,mBAAL,GAA2B,MAA3B;UACA,KAAK4R,SAAL,GAAiB,KAAK7G,QAAL,CAAchB,IAAd,CAAmB,KAAKgF,SAAL,CAAe,KAAKhE,QAApB,CAAnB,EAAkDf,KAAlD,CAAwDiF,QAAQ,CAACpL,MAAM,CAACqM,YAAP,CAAoB,UAApB,CAAD,EAAkC,EAAlC,CAAR,GAAgD,CAAxG,CAAjB;QACH,CAHD,MAIK;UACD,IAAIjB,QAAQ,CAACpL,MAAM,CAACqM,YAAP,CAAoB,UAApB,CAAD,EAAkC,EAAlC,CAAR,KAAkD,CAAtD,EAAyD;YACrD,KAAKlQ,mBAAL,GAA2B,OAA3B;UACH,CAFD,MAGK;YACD,KAAKA,mBAAL,GAA2B,QAA3B;UACH;;UACD,KAAK4R,SAAL,GAAiB,KAAK7G,QAAL,CAAchB,IAAd,CAAmB,KAAKgF,SAAL,CAAe,KAAKhE,QAApB,CAAnB,EAAkDf,KAAlD,CAAwDiF,QAAQ,CAACpL,MAAM,CAACqM,YAAP,CAAoB,UAApB,CAAD,EAAkC,EAAlC,CAAhE,CAAjB;QACH;;QACD,KAAK2B,QAAL,GAAgB,KAAKD,SAAL,CAAerH,SAA/B;QACA,KAAKxK,OAAL,GAAe6C,CAAC,CAACiB,MAAjB;QACA,KAAKiO,YAAL;MACH;;MACD,IAAIjO,MAAM,CAAC0E,SAAP,CAAiBtD,QAAjB,CAA0B5F,OAAO,CAAC2Q,cAAlC,CAAJ,EAAuD;QACnD,KAAK+B,MAAL,GAAc,KAAKhH,QAAL,CAAchB,IAAd,CAAmBkF,QAAQ,CAACpL,MAAM,CAACqM,YAAP,CAAoB,UAApB,CAAD,EAAkC,EAAlC,CAA3B,CAAd;QACA,KAAKwB,aAAL,CAAmB9E,GAAnB,GAAyB,IAAzB;QACA,KAAKkF,YAAL;MACH;;MACD,IAAIjO,MAAM,CAAC0E,SAAP,CAAiBtD,QAAjB,CAA0B5F,OAAO,CAACiR,cAAlC,CAAJ,EAAuD;QACnD,KAAKoB,aAAL,CAAmBM,QAAnB,GAA8B,IAA9B;MACH;;MACD,IAAItT,OAAO,CAACkG,QAAR,IAAoB,KAAK0J,MAAzB,IAAmC,CAAC,KAAKA,MAAL,CAAY/F,SAAZ,CAAsBtD,QAAtB,CAA+B,UAA/B,CAAxC,EAAoF;QAChF,KAAKqJ,MAAL,CAAY/F,SAAZ,CAAsB9D,GAAtB,CAA0B,UAA1B;QACA5F,YAAY,CAAC4F,GAAb,CAAiBM,QAAjB,EAA2BrG,OAAO,CAACgG,eAAnC,EAAoD,KAAKiK,YAAzD,EAAuE,IAAvE;QACA9P,YAAY,CAAC4F,GAAb,CAAiB,KAAK6J,MAAtB,EAA8B5P,OAAO,CAACgG,eAAtC,EAAuD,KAAKC,WAA5D,EAAyE,IAAzE;MACH,CAJD,MAKK;QACD,IAAIb,IAAI,GAAG;UAAE0C,KAAK,EAAE5D,CAAT;UAAYqP,WAAW,EAAE;QAAzB,CAAX;QACA,KAAKvS,MAAL,CAAYwS,OAAZ,CAAoBhT,MAAM,CAACyF,WAA3B,EAAwCb,IAAxC,EAA8C,UAAUqO,eAAV,EAA2B;UACrE,IAAIA,eAAe,CAACC,MAApB,EAA4B;YACxBZ,KAAK,CAAC5C,kBAAN;UACH;QACJ,CAJD;MAKH;;MACD/P,YAAY,CAAC4F,GAAb,CAAiB,KAAKP,aAAL,CAAmBuB,WAAnB,EAAjB,EAAmD/G,OAAO,CAAC2T,cAA3D,EAA2E,KAAKC,QAAhF,EAA0F,IAA1F;MACAzT,YAAY,CAAC4F,GAAb,CAAiB,KAAKP,aAAL,CAAmBuB,WAAnB,EAAjB,EAAmD/G,OAAO,CAAC6T,aAA3D,EAA0E,KAAKC,SAA/E,EAA0F,IAA1F;IACH;EACJ,CA/DD;;EAgEA/S,KAAK,CAACiB,SAAN,CAAgBiO,YAAhB,GAA+B,UAAU/L,CAAV,EAAa;IACxC,IAAI6P,GAAG,GAAG7P,CAAC,CAACiB,MAAF,CAAS0E,SAAnB;;IACA,IAAI,CAAEkK,GAAG,CAACxN,QAAJ,CAAa,UAAb,CAAF,IAA+B,KAAKqJ,MAAxC,EAAgD;MAC5CzP,YAAY,CAAC4J,MAAb,CAAoB1D,QAApB,EAA8BrG,OAAO,CAACgG,eAAtC,EAAuD,KAAKiK,YAA5D;MACA9P,YAAY,CAAC4J,MAAb,CAAoB,KAAK6F,MAAzB,EAAiC5P,OAAO,CAACgG,eAAzC,EAA0D,KAAKC,WAA/D;;MACA,IAAI,KAAK2J,MAAL,IAAe,KAAKpK,aAAL,CAAmBC,YAAnB,GAAkCc,QAAlC,CAA2C,KAAKqJ,MAAhD,CAAnB,EAA4E;QACxE9P,MAAM,CAAC,KAAK8P,MAAN,CAAN;MACH;;MACD,KAAKzO,KAAL,GAAa,IAAb;MACA,KAAKyO,MAAL,GAAc,IAAd;IACH;EACJ,CAXD;;EAYA7O,KAAK,CAACiB,SAAN,CAAgBoR,YAAhB,GAA+B,YAAY;IACvC,KAAKxD,MAAL,GAAc,KAAK5O,MAAL,CAAY4P,aAAZ,CAA0B,KAA1B,EAAiC;MAC3Ce,SAAS,EAAE,oBAAoB,GAApB,GAA0B,KAAK3Q,MAAL,CAAYmD;IADN,CAAjC,CAAd;;IAGA,IAAInE,OAAO,CAACkG,QAAZ,EAAsB;MAClB,KAAK0J,MAAL,CAAY/F,SAAZ,CAAsB9D,GAAtB,CAA0B,UAA1B;IACH;;IACD,KAAKP,aAAL,CAAmBC,YAAnB,GAAkC2L,WAAlC,CAA8C,KAAKxB,MAAnD;IACA,KAAKoE,eAAL;EACH,CATD;;EAUAjT,KAAK,CAACiB,SAAN,CAAgBgS,eAAhB,GAAkC,YAAY;IAC1C,IAAIvD,GAAG,GAAG,KAAKC,OAAL,CAAa,KAAKrE,QAAlB,CAAV;;IACA,IAAI,KAAK2G,aAAL,CAAmBC,MAAvB,EAA+B;MAC3B,KAAKrD,MAAL,CAAY/F,SAAZ,CAAsB9D,GAAtB,CAA0B,iBAA1B;MACA,KAAK6J,MAAL,CAAYtD,KAAZ,CAAkB2E,OAAlB,GAA4B,aAAaT,gBAAgB,CAAC,KAAKnE,QAAN,CAAhB,CAAgCiE,MAA7C,GAAsD,SAAtD,GACxBG,GAAG,CAAC3C,GADoB,GACd,WADc,IACE2C,GAAG,CAACS,IAAJ,GAAW,KAAKR,OAAL,CAAa,KAAKwC,SAAlB,EAA6BhC,IAAzC,IACxB,KAAK5P,mBAAL,KAA6B,MAA7B,GAAsC,KAAK4R,SAAL,CAAe/B,WAAf,GAA6B,CAAnE,GAAuE,CAD/C,IACoD,CAFrD,IAE0D,KAFtF;IAGH,CALD,MAMK;MACD,KAAKvB,MAAL,CAAY/F,SAAZ,CAAsB9D,GAAtB,CAA0B,cAA1B;MACA,KAAK6J,MAAL,CAAYtD,KAAZ,CAAkB2E,OAAlB,GAA4B,YAAYT,gBAAgB,CAAC,KAAKnE,QAAN,CAAhB,CAAgCkD,KAA5C,GAAoD,SAApD,IACvB,KAAKmB,OAAL,CAAa,KAAK2C,MAAlB,EAA0BvF,GAA1B,GAAgC2C,GAAG,CAAC3C,GAApC,GAA0C,KAAKuF,MAAL,CAAY5B,YAD/B,IAExB,WAFwB,IAET,KAAKf,OAAL,CAAa,KAAK2C,MAAlB,EAA0BnC,IAA1B,GAAiCT,GAAG,CAACS,IAF5B,IAEoC,KAFhE;IAGH;EACJ,CAdD;;EAeAnQ,KAAK,CAACiB,SAAN,CAAgBiS,YAAhB,GAA+B,YAAY;IACvC,IAAIxD,GAAG,GAAG,KAAKC,OAAL,CAAa,KAAKrE,QAAlB,CAAV;;IACA,IAAI,KAAK2G,aAAL,CAAmBC,MAAvB,EAA+B;MAC3B,IAAI/B,IAAI,GAAIT,GAAG,CAACS,IAAJ,GAAW,KAAKR,OAAL,CAAa,KAAKwC,SAAlB,EAA6BhC,IAAzC,IACN,KAAK5P,mBAAL,KAA6B,MAA7B,GAAsC,KAAK4R,SAAL,CAAe/B,WAAf,GAA6B,CAAnE,GAAuE,CADjE,IACsE,CADjF;MAEA,KAAKvB,MAAL,CAAYtD,KAAZ,CAAkB4E,IAAlB,GAAyBA,IAAI,GAAG,IAAhC;IACH,CAJD,MAKK;MACD,IAAIgD,KAAK,GAAG,KAAKxD,OAAL,CAAa,KAAK2C,MAAlB,EAA0BvF,GAA1B,GAAgC2C,GAAG,CAAC3C,GAApC,GAA0C,KAAKuF,MAAL,CAAY5B,YAAlE;MACA,KAAK7B,MAAL,CAAYtD,KAAZ,CAAkBwB,GAAlB,GAAwBoG,KAAK,GAAG,IAAhC;IACH;EACJ,CAXD;;EAYAnT,KAAK,CAACiB,SAAN,CAAgBqO,SAAhB,GAA4B,UAAU5O,OAAV,EAAmB;IAC3C,IAAI0S,GAAG,GAAG,CAAV;IACA,IAAIC,WAAJ;;IACA,KAAK,IAAInP,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGxD,OAAO,CAAC4J,IAAR,CAAanG,MAAjC,EAAyCD,CAAC,EAA1C,EAA8C;MAC1C,IAAIkP,GAAG,GAAG1S,OAAO,CAAC4J,IAAR,CAAapG,CAAb,EAAgBqG,KAAhB,CAAsBpG,MAAhC,EAAwC;QACpCkP,WAAW,GAAGnP,CAAd;QACAkP,GAAG,GAAG1S,OAAO,CAAC4J,IAAR,CAAapG,CAAb,EAAgBqG,KAAhB,CAAsBpG,MAA5B;MACH;IACJ;;IACD,OAAOkP,WAAP;EACH,CAVD;;EAWArT,KAAK,CAACiB,SAAN,CAAgB4R,QAAhB,GAA2B,UAAU1P,CAAV,EAAa;IACpC,IAAI4O,KAAK,GAAG,IAAZ;;IACA,IAAI3R,KAAK,GAAG,KAAKwR,SAAL,CAAezO,CAAf,CAAZ;IACA,IAAI9C,KAAK,GAAG,KAAKyR,SAAL,CAAe3O,CAAf,CAAZ;IACA,IAAImQ,MAAM,GAAI,KAAKrT,MAAL,CAAYsT,SAAb,GAA0B,EAAEnT,KAAK,GAAG,KAAKA,KAAf,CAA1B,GAAmDA,KAAK,GAAG,KAAKA,KAA7E;IACA,IAAIoT,MAAM,GAAI,KAAKvT,MAAL,CAAYsT,SAAb,GAA0B,EAAElT,KAAK,GAAG,KAAKA,KAAf,CAA1B,GAAmDA,KAAK,GAAG,KAAKA,KAA7E;IACA,KAAKD,KAAL,GAAaA,KAAb;IACA,KAAKC,KAAL,GAAaA,KAAb;IACA,IAAIgE,IAAI,GAAG;MAAE0C,KAAK,EAAE5D,CAAT;MAAYqP,WAAW,EAAE;IAAzB,CAAX;IACA,KAAKvS,MAAL,CAAYwS,OAAZ,CAAoBhT,MAAM,CAACgU,QAA3B,EAAqCpP,IAArC,EAA2C,UAAUqP,YAAV,EAAwB;MAC/D,IAAIA,YAAY,CAACf,MAAjB,EAAyB;QACrBZ,KAAK,CAAC5C,kBAAN;MACH,CAFD,MAGK;QACD,IAAIwB,UAAU,GAAGoB,KAAK,CAACtN,aAAN,CAAoBC,YAApB,GAAmCe,aAAnC,CAAiD,cAAjD,CAAjB;;QACA,IAAIkO,UAAU,GAAGnE,QAAQ,CAACC,gBAAgB,CAACsC,KAAK,CAACzG,QAAP,CAAhB,CAAiCkD,KAAlC,EAAyC,EAAzC,CAAzB;QACA,IAAIoF,WAAW,GAAGpE,QAAQ,CAACC,gBAAgB,CAACsC,KAAK,CAACzG,QAAP,CAAhB,CAAiCiE,MAAlC,EAA0C,EAA1C,CAA1B;QACA,IAAIsE,WAAW,GAAG,CAACpE,gBAAgB,CAACsC,KAAK,CAACtN,aAAN,CAAoBC,YAApB,EAAD,CAAhB,CAAqDoP,YAArD,CAAkEC,KAAlE,CAAwE,KAAxE,EAA+EC,IAA/E,CAAoF,EAApF,CAAnB;QACA,IAAIC,QAAQ,GAAGlC,KAAK,CAACtN,aAAN,CAAoBC,YAApB,GAAmC0L,WAAnC,IAAkD2B,KAAK,CAACtN,aAAN,CAAoBC,YAApB,GAAmC0L,WAAnC,GAC7D2B,KAAK,CAACtN,aAAN,CAAoBC,YAApB,GAAmCwP,WADxB,IACuCL,WAAW,GAAG,CADpE;QAEA,IAAIM,YAAY,GAAG,KAAK,CAAxB;;QACA,IAAI,CAAChV,KAAK,CAAC4S,KAAK,CAACzG,QAAN,CAAehE,aAAf,CAA6BtI,OAA7B,CAAqC,OAArC,CAAD,CAAV,EAA2D;UACvD,IAAIoV,SAAS,GAAGrC,KAAK,CAACzG,QAAN,CAAetM,OAAf,CAAuB,IAAvB,CAAhB;;UACA,IAAIqV,YAAY,GAAG,CAAC5E,gBAAgB,CAAC2E,SAAD,CAAhB,CAA4BN,YAA5B,CAAyCC,KAAzC,CAA+C,KAA/C,EAAsDC,IAAtD,CAA2D,EAA3D,CAApB,CAFuD,CAGvD;;UACAG,YAAY,GAAGC,SAAS,CAAChE,WAAV,IAAyBgE,SAAS,CAAChE,WAAV,GAAwBgE,SAAS,CAACF,WAA3D,IAA0EG,YAAY,GAAG,CAAxG;QACH,CALD,MAMK;UACDF,YAAY,GAAGF,QAAf;QACH;;QACD,IAAIlC,KAAK,CAACE,aAAN,CAAoBC,MAAxB,EAAgC;UAC5B,IAAI1D,KAAK,GAAG8F,UAAU,CAACvC,KAAK,CAACI,SAAN,CAAgB/B,WAAhB,CAA4BL,QAA5B,EAAD,CAAtB;UACA,IAAIwE,OAAO,GAAGxC,KAAK,CAACzG,QAAN,CAAehB,IAAf,CAAoB,CAApB,EAAuBC,KAAvB,CAA6B,CAA7B,EAAgCH,QAAhC,KAA6C,IAA7C,GAAoD,CAApD,GAAwD,CAAtE;UACA,IAAIoK,iBAAiB,GAAGF,UAAU,CAACvC,KAAK,CAACzG,QAAN,CAAeC,KAAf,CAAqBiD,KAArB,CAA2BtF,KAA3B,CAAiC,GAAjC,EAAsC,CAAtC,CAAD,CAAlC;UACA,IAAIuL,sBAAsB,GAAGH,UAAU,CAACvC,KAAK,CAACzG,QAAN,CAAehB,IAAf,CAAoBiK,OAApB,EAA6BhK,KAA7B,CAAmCwH,KAAK,CAACK,QAAzC,EAAmD7G,KAAnD,CAAyDiD,KAAzD,CAA+DtF,KAA/D,CAAqE,GAArE,EAA0E,CAA1E,CAAD,CAAvC;;UACA,IAAI6I,KAAK,CAACxR,mBAAN,KAA8B,OAAlC,EAA2C;YACvC+S,MAAM,GAAGA,MAAM,GAAG,IAAlB,CADuC,CACf;;YACxBvB,KAAK,CAACpK,mBAAN,GAFuC,CAGvC;;;YACA,IAAI,CAAE2L,MAAM,KAAK,CAAX,IAAgB,IAAImB,sBAArB,IAAgDnB,MAAM,GAAG,CAA1D,KAAgEkB,iBAAiB,IAAI,GAArF,IAA4FzC,KAAK,CAAC2C,wBAAN,CAA+Bf,UAAU,GAAGL,MAA5C,EAAoDa,YAApD,KAAqE,GAArK,EAA0K;cACtK,IAAIQ,gBAAgB,GAAG5C,KAAK,CAAC6C,qBAAN,CAA4B7C,KAAK,CAACzG,QAAlC,EAA4C,IAA5C,CAAvB;;cACAyG,KAAK,CAACzG,QAAN,CAAeC,KAAf,CAAqBiD,KAArB,GAA6BuD,KAAK,CAAC2C,wBAAN,CAA+Bf,UAAU,GAAGL,MAA5C,EAAoDa,YAApD,IAAoE,GAApE,GAA2E,MAAM,GAAjF,GAAyFpC,KAAK,CAAC2C,wBAAN,CAA+Bf,UAAU,GAAGL,MAA5C,EAAoDa,YAApD,IAAoE,GAA1L;;cACA,IAAIU,eAAe,GAAGL,iBAAiB,GAAGzC,KAAK,CAAC2C,wBAAN,CAA+Bf,UAAU,GAAGL,MAA5C,EAAoDa,YAApD,CAA1C;;cACApC,KAAK,CAACvR,iBAAN,GAA0BuR,KAAK,CAACvR,iBAAN,GAA0BqU,eAApD;cACA9C,KAAK,CAACzG,QAAN,CAAeC,KAAf,CAAqBuJ,UAArB,GAAkC,WAAW/C,KAAK,CAACzG,QAAN,CAAeC,KAAf,CAAqBiD,KAArB,KAA+B,MAA/B,GAAwC,CAAxC,GAA4CuD,KAAK,CAACvR,iBAA7D,IAAkF,IAApH;;cACA,KAAK,IAAI0D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyQ,gBAAgB,CAACxQ,MAArC,EAA6CD,CAAC,EAA9C,EAAkD;gBAC9C6N,KAAK,CAACzG,QAAN,CAAehB,IAAf,CAAoBpG,CAApB,EAAuBqG,KAAvB,CAA6BwH,KAAK,CAACK,QAAnC,EAA6C7G,KAA7C,CAAmDiD,KAAnD,GAA4DiG,sBAAsB,GAAGI,eAA1B,GAA6C,GAAxG;cACH;YACJ;UACJ,CAdD,MAeK,IAAI9C,KAAK,CAACxR,mBAAN,KAA8B,MAAlC,EAA0C;YAC3C+S,MAAM,GAAGA,MAAM,GAAG,IAAlB,CAD2C,CACnB;;YACxBvB,KAAK,CAACpK,mBAAN,GAF2C,CAG3C;;;YACA,IAAI,CAAE2L,MAAM,KAAK,CAAX,IAAgB,IAAImB,sBAArB,IAAgDnB,MAAM,GAAG,CAA1D,KAAgEkB,iBAAiB,IAAI,GAArF,IAA4FzC,KAAK,CAAC2C,wBAAN,CAA+Bf,UAAU,GAAGL,MAA5C,EAAoDa,YAApD,KAAqE,GAArK,EAA0K;cACtK,IAAIY,eAAe,GAAGhD,KAAK,CAAC6C,qBAAN,CAA4B7C,KAAK,CAACzG,QAAlC,EAA4C,KAA5C,CAAtB;;cACAyG,KAAK,CAACzG,QAAN,CAAeC,KAAf,CAAqBiD,KAArB,GAA6BuD,KAAK,CAAC2C,wBAAN,CAA+Bf,UAAU,GAAGL,MAA5C,EAAoDa,YAApD,IAAoE,GAApE,GAA2E,MAAM,GAAjF,GAAyFpC,KAAK,CAAC2C,wBAAN,CAA+Bf,UAAU,GAAGL,MAA5C,EAAoDa,YAApD,IAAoE,GAA1L;;cACA,IAAIU,eAAe,GAAGL,iBAAiB,GAAGzC,KAAK,CAAC2C,wBAAN,CAA+Bf,UAAU,GAAGL,MAA5C,EAAoDa,YAApD,CAA1C;;cACA,KAAK,IAAIjQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6Q,eAAe,CAAC5Q,MAApC,EAA4CD,CAAC,EAA7C,EAAiD;gBAC7C6N,KAAK,CAACzG,QAAN,CAAehB,IAAf,CAAoBpG,CAApB,EAAuBqG,KAAvB,CAA6BwH,KAAK,CAACK,QAAnC,EAA6C7G,KAA7C,CAAmDiD,KAAnD,GAA4DiG,sBAAsB,GAAGI,eAA1B,GAA6C,GAAxG;cACH;YACJ;UACJ,CAZI,MAaA;YACD,IAAIG,QAAQ,GAAGjD,KAAK,CAACzG,QAAN,CAAehB,IAAf,CAAoByH,KAAK,CAACzC,SAAN,CAAgByC,KAAK,CAACzG,QAAtB,CAApB,EAAqDf,KAApE;;YACA,IAAI0K,SAAS,GAAGzG,KAAK,GAAG8E,MAAxB;YACA,IAAI4B,QAAQ,GAAGZ,UAAU,CAACvC,KAAK,CAACI,SAAN,CAAgB/B,WAAhB,CAA4BL,QAA5B,EAAD,CAAV,GACXuE,UAAU,CAACU,QAAQ,CAACjD,KAAK,CAACK,QAAN,GAAiB,CAAlB,CAAR,CAA6BhC,WAA7B,CAAyCL,QAAzC,EAAD,CADd;;YAEA,KAAK,IAAI7L,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6N,KAAK,CAACzG,QAAN,CAAehB,IAAf,CAAoBnG,MAAxC,EAAgDD,CAAC,EAAjD,EAAqD;cACjD,IAAKgR,QAAQ,GAAGD,SAAZ,GAAyB,EAAzB,IAA+BA,SAAS,GAAG,EAA/C,EAAmD;gBAC/C,IAAIE,eAAe,GAAGD,QAAQ,GAAGD,SAAjC;gBACA,IAAIG,aAAa,GAAGH,SAApB;;gBACA,IAAI,CAAC9V,KAAK,CAAC4S,KAAK,CAACzG,QAAN,CAAehB,IAAf,CAAoBpG,CAApB,EAAuBqG,KAAvB,CAA6BwH,KAAK,CAACK,QAAN,GAAiB,CAA9C,CAAD,CAAV,EAA8D;kBAC1DL,KAAK,CAACzG,QAAN,CAAehB,IAAf,CAAoBpG,CAApB,EAAuBqG,KAAvB,CAA6BwH,KAAK,CAACK,QAAN,GAAiB,CAA9C,EAAiD7G,KAAjD,CAAuDiD,KAAvD,GACIuD,KAAK,CAAC2C,wBAAN,CAA+BS,eAA/B,EAAgDxB,UAAhD,IAA8D,GADlE;gBAEH;;gBACD,IAAI,CAACxU,KAAK,CAAC4S,KAAK,CAACzG,QAAN,CAAehB,IAAf,CAAoBpG,CAApB,EAAuBqG,KAAvB,CAA6BwH,KAAK,CAACK,QAAnC,CAAD,CAAV,EAA0D;kBACtDL,KAAK,CAACzG,QAAN,CAAehB,IAAf,CAAoBpG,CAApB,EAAuBqG,KAAvB,CAA6BwH,KAAK,CAACK,QAAnC,EAA6C7G,KAA7C,CAAmDiD,KAAnD,GACIuD,KAAK,CAAC2C,wBAAN,CAA+BU,aAA/B,EAA8CzB,UAA9C,IAA4D,GADhE;gBAEH;cACJ;YACJ;UACJ;;UACD5B,KAAK,CAACmB,YAAN;QACH,CAtDD,MAuDK,IAAInB,KAAK,CAACE,aAAN,CAAoB9E,GAAxB,EAA6B;UAC9B4E,KAAK,CAAC9R,MAAN,CAAaoP,oBAAb,CAAkClM,CAAlC;;UACA,IAAIoM,MAAM,GAAG+E,UAAU,CAACvC,KAAK,CAACO,MAAN,CAAa+C,YAAb,CAA0BtF,QAA1B,EAAD,CAAV,GAAmDyD,MAAhE;;UACA,IAAIjE,MAAM,GAAG,EAAb,EAAiB;YACbwC,KAAK,CAACO,MAAN,CAAa/G,KAAb,CAAmBgE,MAAnB,GAA4BA,MAAM,GAAG,IAArC;UACH;;UACDwC,KAAK,CAACzG,QAAN,CAAeC,KAAf,CAAqBgE,MAArB,GAA8B,EAA9B;;UACA,IAAI,CAACpQ,KAAK,CAACwR,UAAD,CAAV,EAAwB;YACpBA,UAAU,CAACpF,KAAX,CAAiB2E,OAAjB,GAA2B,WAAW6B,KAAK,CAACpC,OAAN,CAAcoC,KAAK,CAACzG,QAApB,EAA8ByB,GAA9B,GAAoC6G,WAApC,GAAkD,CAA7D,IACvB,WADuB,IACR7B,KAAK,CAACpC,OAAN,CAAcoC,KAAK,CAACzG,QAApB,EAA8B6E,IAA9B,GAAqCwD,UAArC,GAAkD,CAD1C,IAC+C,KAD1E;UAEH;;UACD5B,KAAK,CAACmB,YAAN;QACH,CAZI,MAaA,IAAInB,KAAK,CAACE,aAAN,CAAoBM,QAAxB,EAAkC;UACnC,IAAI,CAACtT,OAAO,CAACkG,QAAb,EAAuB;YACnB/F,YAAY,CAAC4J,MAAb,CAAoB+I,KAAK,CAACtN,aAAN,CAAoBC,YAApB,EAApB,EAAwD,WAAxD,EAAqEqN,KAAK,CAAC3M,YAA3E;UACH;;UACD,IAAIkQ,SAAS,GAAGvD,KAAK,CAACzG,QAAN,CAAeC,KAAf,CAAqBiD,KAArB,CAA2BjB,OAA3B,CAAmC,GAAnC,IAA0C,CAAC,CAA3D;UACAwE,KAAK,CAACzG,QAAN,CAAeC,KAAf,CAAqBiD,KAArB,GAA6B8G,SAAS,GAAGvD,KAAK,CAAC2C,wBAAN,CAA+Bf,UAAU,GAAGL,MAA5C,EAAoDa,YAApD,IAAoE,GAAvE,GAChCR,UAAU,GAAGL,MAAb,GAAsB,IAD5B;UAEAvB,KAAK,CAACzG,QAAN,CAAeC,KAAf,CAAqBgE,MAArB,GAA8BqE,WAAW,GAAGJ,MAAd,GAAuB,IAArD;UACA7C,UAAU,CAAC7H,SAAX,CAAqB9D,GAArB,CAAyB,eAAzB;UACA2L,UAAU,CAACpF,KAAX,CAAiB2E,OAAjB,GAA2B,WAAW6B,KAAK,CAACpC,OAAN,CAAcoC,KAAK,CAACzG,QAApB,EAA8ByB,GAA9B,GAAoC6G,WAApC,GAAkD,CAA7D,IACvB,WADuB,IACR7B,KAAK,CAACpC,OAAN,CAAcoC,KAAK,CAACzG,QAApB,EAA8B6E,IAA9B,GAAqCwD,UAArC,GAAkD,CAD1C,IAC+C,KAD1E;QAEH;MACJ;IACJ,CAtGD;EAuGH,CAhHD;;EAiHA3T,KAAK,CAACiB,SAAN,CAAgB2T,qBAAhB,GAAwC,UAAU/L,KAAV,EAAiB0M,OAAjB,EAA0B;IAC9D,IAAIC,aAAa,GAAG,EAApB;IACA,IAAIlL,IAAI,GAAGzB,KAAK,CAACnB,gBAAN,CAAuB,IAAvB,CAAX;;IACA,KAAK,IAAIxD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoG,IAAI,CAACnG,MAAzB,EAAiCD,CAAC,EAAlC,EAAsC;MAClC,IAAIoG,IAAI,CAACpG,CAAD,CAAJ,CAAQlF,OAAR,CAAgB,OAAhB,MAA6B6J,KAAjC,EAAwC;QACpC,IAAI0F,OAAO,GAAGjE,IAAI,CAACpG,CAAD,CAAJ,CAAQwD,gBAAR,CAAyB,QAAzB,CAAd;QACA8N,aAAa,CAAC9L,IAAd,CAAmB6L,OAAO,GAAGhH,OAAO,CAAC,CAAD,CAAV,GAAgBA,OAAO,CAACA,OAAO,CAACpK,MAAR,GAAiB,CAAlB,CAAjD;MACH;IACJ;;IACD,OAAOqR,aAAP;EACH,CAVD;;EAWAxV,KAAK,CAACiB,SAAN,CAAgByT,wBAAhB,GAA2C,UAAUjJ,KAAV,EAAiBgK,WAAjB,EAA8B;IACrE,OAAQhK,KAAK,GAAGgK,WAAT,GAAwB,GAA/B;EACH,CAFD;;EAGAzV,KAAK,CAACiB,SAAN,CAAgBkO,kBAAhB,GAAqC,YAAY;IAC7C/P,YAAY,CAAC4J,MAAb,CAAoB,KAAKvE,aAAL,CAAmBuB,WAAnB,EAApB,EAAsD/G,OAAO,CAAC2T,cAA9D,EAA8E,KAAKC,QAAnF;IACAzT,YAAY,CAAC4J,MAAb,CAAoB,KAAKvE,aAAL,CAAmBuB,WAAnB,EAApB,EAAsD/G,OAAO,CAAC6T,aAA9D,EAA6E,KAAKC,SAAlF;IACA,KAAKpL,mBAAL;EACH,CAJD;;EAKA3H,KAAK,CAACiB,SAAN,CAAgB8R,SAAhB,GAA4B,UAAU5P,CAAV,EAAa;IACrC,KAAK6O,aAAL;IACA5S,YAAY,CAAC4J,MAAb,CAAoB,KAAKvE,aAAL,CAAmBuB,WAAnB,EAApB,EAAsD/G,OAAO,CAAC2T,cAA9D,EAA8E,KAAKC,QAAnF;IACAzT,YAAY,CAAC4J,MAAb,CAAoB,KAAKvE,aAAL,CAAmBuB,WAAnB,EAApB,EAAsD/G,OAAO,CAAC6T,aAA9D,EAA6E,KAAKC,SAAlF;;IACA,IAAI,KAAKtO,aAAL,CAAmBC,YAAnB,GAAkCe,aAAlC,CAAgD,cAAhD,KACA,KAAKhB,aAAL,CAAmBC,YAAnB,GAAkCc,QAAlC,CAA2C,KAAKf,aAAL,CAAmBC,YAAnB,GAAkCe,aAAlC,CAAgD,cAAhD,CAA3C,CADJ,EACiH;MAC7G,IAAI,CAACxG,OAAO,CAACkG,QAAb,EAAuB;QACnB/F,YAAY,CAAC4F,GAAb,CAAiB,KAAKP,aAAL,CAAmBC,YAAnB,EAAjB,EAAoD,WAApD,EAAiE,KAAKU,YAAtE,EAAoF,IAApF;MACH;;MACD,KAAKuC,mBAAL;IACH;;IACD,IAAI,KAAKkH,MAAL,IAAe,KAAKpK,aAAL,CAAmBC,YAAnB,GAAkCc,QAAlC,CAA2C,KAAKqJ,MAAhD,CAAnB,EAA4E;MACxE9P,MAAM,CAAC,KAAK8P,MAAN,CAAN;MACA,KAAKA,MAAL,GAAc,IAAd;IACH;;IACD,KAAKzO,KAAL,GAAa,IAAb;IACA,KAAKC,KAAL,GAAa,IAAb;IACA,KAAKC,OAAL,GAAe,IAAf;IACA,IAAI+D,IAAI,GAAG;MAAE0C,KAAK,EAAE5D,CAAT;MAAYqP,WAAW,EAAE;IAAzB,CAAX;IACA,KAAKvS,MAAL,CAAYwS,OAAZ,CAAoBhT,MAAM,CAACiW,UAA3B,EAAuCrR,IAAvC;IACA,KAAKpE,MAAL,CAAY2F,SAAZ,CAAsBuD,QAAtB;EACH,CArBD;;EAsBAnJ,KAAK,CAACiB,SAAN,CAAgB+Q,aAAhB,GAAgC,YAAY;IACxC,OAAO,KAAKC,aAAL,GAAqB;MAAEC,MAAM,EAAE,KAAV;MAAiB/E,GAAG,EAAE,KAAtB;MAA6BoF,QAAQ,EAAE;IAAvC,CAA5B;EACH,CAFD;;EAGAvS,KAAK,CAACiB,SAAN,CAAgBqF,MAAhB,GAAyB,UAAUM,UAAV,EAAsBzD,CAAtB,EAAyBwS,MAAzB,EAAiC;IACtD,IAAIC,GAAJ;;IACA,IAAID,MAAJ,EAAY;MACRC,GAAG,GAAG;QACFvQ,IAAI,EAAE;UAAEK,OAAO,EAAE,OAAX;UAAoBW,UAAU,EAAE;QAAhC;MADJ,CAAN;IAGH;;IACD,IAAIoF,KAAK,GAAG;MACRxF,SAAS,EAAEW,UADH;MAERP,UAAU,EAAGsP,MAAD,GAAWC,GAAG,CAACvQ,IAAJ,CAASgB,UAApB,GAAiClD,CAAC,CAACkC,IAAF,CAAOgB;IAF5C,CAAZ;IAIA,KAAKpG,MAAL,CAAY2F,SAAZ,CAAsBiB,OAAtB,CAA8B,KAAK5G,MAAnC,EAA4C0V,MAAD,GAAWC,GAAX,GAAiBzS,CAA5D,EAA+DA,CAA/D,EAAkEsI,KAAlE;EACH,CAZD;;EAaAzL,KAAK,CAACiB,SAAN,CAAgBsF,SAAhB,GAA4B,UAAUK,UAAV,EAAsBzD,CAAtB,EAAyB;IACjD,KAAKlD,MAAL,CAAY2F,SAAZ,CAAsBiB,OAAtB,CAA8B,KAAK5G,MAAnC,EAA2CkD,CAA3C,EAA8CA,CAA9C,EAAiD;MAAE8C,SAAS,EAAEW,UAAb;MAAyB4H,KAAK,EAAE,KAAKvO,MAAL,CAAY6E,aAAZ,CAA0B0J,KAA1D;MAAiEnI,UAAU,EAAElD,CAAC,CAACkC,IAAF,CAAOgB;IAApF,CAAjD;EACH,CAFD;;EAGArG,KAAK,CAACiB,SAAN,CAAgBuF,eAAhB,GAAkC,UAAUI,UAAV,EAAsBzD,CAAtB,EAAyB;IACvD,KAAKlD,MAAL,CAAY2F,SAAZ,CAAsBiB,OAAtB,CAA8B,KAAK5G,MAAnC,EAA2CkD,CAA3C,EAA8CA,CAA9C,EAAiD;MAAE8C,SAAS,EAAEW,UAAb;MAAyBP,UAAU,EAAElD,CAAC,CAACkC,IAAF,CAAOgB;IAA5C,CAAjD;IACA,KAAKS,qBAAL;EACH,CAHD;;EAIA9G,KAAK,CAACiB,SAAN,CAAgBwG,WAAhB,GAA8B,UAAUxB,SAAV,EAAqB5B,IAArB,EAA2BwR,MAA3B,EAAmC;IAC7D,IAAID,GAAJ;;IACA,IAAIC,MAAJ,EAAY;MACRD,GAAG,GAAG;QAAEvQ,IAAI,EAAE;UAAEK,OAAO,EAAE,OAAX;UAAoBW,UAAU,EAAE;QAAhC;MAAR,CAAN;IACH;;IACD,IAAIoF,KAAK,GAAG;MACRxF,SAAS,EAAEA,SADH;MAERI,UAAU,EAAGwP,MAAD,GAAWD,GAAG,CAACvQ,IAAJ,CAASgB,UAApB,GAAiChC,IAAI,CAACgB,IAAL,CAAUgB;IAF/C,CAAZ;IAIA,KAAKpG,MAAL,CAAY2F,SAAZ,CAAsBiB,OAAtB,CAA8B,KAAK5G,MAAnC,EAA4C4V,MAAD,GAAWD,GAAX,GAAiBvR,IAA5D,EAAkEA,IAAI,CAAC+D,aAAvE,EAAsFqD,KAAtF;IACA,KAAKhH,aAAL,CAAmBC,YAAnB,GAAkCuD,KAAlC;IACA,KAAKN,mBAAL;IACA,KAAKb,qBAAL;EACH,CAbD;;EAcA9G,KAAK,CAACiB,SAAN,CAAgBI,gBAAhB,GAAmC,UAAUgD,IAAV,EAAgB;IAC/C,IAAI0N,KAAK,GAAG,IAAZ;;IACA,IAAI9S,OAAO,CAACkG,QAAR,IAAoB,KAAKlF,MAAL,CAAY6V,UAAZ,CAAuBnJ,MAA/C,EAAuD;MACnD,KAAKtE,iBAAL,CAAuBhE,IAAvB;MACA;IACH;;IACD,IAAI,KAAKZ,QAAT,EAAmB;MACf,KAAKA,QAAL,CAAc8E,IAAd;MACA;IACH;;IACD,KAAKzB,qBAAL;IACA,IAAIiP,MAAM,GAAG,KAAb;IACA,IAAIC,SAAS,GAAG,KAAKpV,IAAL,CAAUqV,WAAV,CAAsB,gBAAtB,CAAhB;IACA,KAAKvI,MAAL,GAAc,KAAKzN,MAAL,CAAY4P,aAAZ,CAA0B,KAA1B,EAAiC;MAAEe,SAAS,EAAE,sBAAsB,GAAtB,GAA4B,KAAK3Q,MAAL,CAAYmD,QAArD;MAA+DzC,EAAE,EAAE,KAAKF,KAAL,GAAa;IAAhF,CAAjC,CAAd;IACA,KAAKoN,SAAL,GAAiB,KAAK5N,MAAL,CAAY4P,aAAZ,CAA0B,KAA1B,EAAiC;MAAEe,SAAS,EAAE,uBAAuB,GAAvB,GAA6B,KAAK3Q,MAAL,CAAYmD;IAAtD,CAAjC,CAAjB;IACA,KAAKyK,SAAL,CAAeC,SAAf,GAA2BiI,MAA3B;IACA,KAAKrI,MAAL,CAAY2C,WAAZ,CAAwB,KAAKxC,SAA7B;IACA,IAAIqI,QAAQ,GAAG,KAAKjW,MAAL,CAAY4P,aAAZ,CAA0B,KAA1B,EAAiC;MAAEe,SAAS,EAAE,qBAAqB,GAArB,GAA2B,KAAK3Q,MAAL,CAAYmD;IAApD,CAAjC,CAAf;IACA,KAAK+S,SAAL,CAAeD,QAAf,EAAyB7R,IAAzB;IACA,KAAKqJ,MAAL,CAAY2C,WAAZ,CAAwB6F,QAAxB;IACA,KAAKxI,MAAL,CAAY2C,WAAZ,CAAwB,KAAKpQ,MAAL,CAAY4P,aAAZ,CAA0B,MAA1B,EAAkC;MAAEe,SAAS,EAAE,kBAAkB,GAAlB,GAAwB,KAAK3Q,MAAL,CAAYmD;IAAjD,CAAlC,CAAxB;IACA,IAAIgT,MAAM,GAAG,KAAKnW,MAAL,CAAY4P,aAAZ,CAA0B,QAA1B,EAAoC;MAC7Ce,SAAS,EAAE,uBAAuB,GAAvB,GAA6B,KAAK3Q,MAAL,CAAYmD,QADP;MACiBzC,EAAE,EAAE,KAAKF,KAAL,GAAa,cADlC;MAE7CqP,KAAK,EAAE;QAAEuG,IAAI,EAAE,QAAR;QAAkBC,QAAQ,EAAE;MAA5B;IAFsC,CAApC,CAAb;;IAIA,IAAI,CAACnX,KAAK,CAAC,KAAKc,MAAL,CAAYsW,iBAAZ,GAAgC9Q,aAAhC,CAA8C,iBAA9C,CAAD,CAAV,EAA8E;MAC1E,KAAKxF,MAAL,CAAYsW,iBAAZ,GAAgC9Q,aAAhC,CAA8C,iBAA9C,EAAiEd,YAAjE,CAA8E,UAA9E,EAA0F,GAA1F;IACH;;IACD,KAAK+I,MAAL,CAAY2C,WAAZ,CAAwB+F,MAAxB;IACA,KAAK1S,iBAAL,GAAyB,IAAIlE,MAAJ,CAAW;MAChCgX,OAAO,EAAE,wBADuB;MACGC,OAAO,EAAET,SADZ;MACuB5S,QAAQ,EAAE,WAAW,GAAX,GAAiB,KAAKnD,MAAL,CAAYmD,QAD9D;MAEhCmQ,SAAS,EAAE,KAAKtT,MAAL,CAAYsT,SAFS;MAEEmD,MAAM,EAAE,KAAKzW,MAAL,CAAYyW;IAFtB,CAAX,CAAzB;IAIA,KAAKhT,iBAAL,CAAuBiT,gBAAvB,GAA0C,IAA1C;IACA,KAAKjT,iBAAL,CAAuBkT,QAAvB,CAAgCR,MAAhC;IACAhX,YAAY,CAAC4F,GAAb,CAAiBoR,MAAjB,EAAyB,OAAzB,EAAkC,KAAK/N,iBAAvC,EAA0D;MAAEC,IAAI,EAAE,IAAR;MAAcjE,IAAI,EAAEA,IAAI,CAACA,IAAzB;MAA+B4B,SAAS,EAAE5B,IAAI,CAAC4B;IAA/C,CAA1D;IACA,KAAKhG,MAAL,CAAY4W,UAAZ,GAAyBxG,WAAzB,CAAqC,KAAK3C,MAA1C;IACA,IAAItJ,MAAM,GAAGC,IAAI,CAACA,IAAL,CAAU+D,aAAV,CAAwBhE,MAArC;IACAA,MAAM,GAAGA,MAAM,CAAC0E,SAAP,CAAiBtD,QAAjB,CAA0B,gBAA1B,IAA8CpB,MAAM,CAACuG,UAArD,GAAkEvG,MAAM,CAACkD,aAAlF;IACA,KAAK7D,QAAL,GAAgB,IAAIlE,KAAJ,CAAU,KAAKmO,MAAf,EAAuB;MACnCoJ,UAAU,EAAE,UADuB;MAEnCC,QAAQ,EAAE3S,MAFyB;MAGnC4S,SAAS,EAAE;QAAEC,CAAC,EAAE,KAAL;QAAYC,CAAC,EAAE;MAAf,CAHwB;MAInCC,OAAO,EAAE,CAJ0B;MAKnCC,eAAe,EAAE,KAAKnX,MAAL,CAAYS,OALM;MAMnC2Q,QAAQ,EAAE;QAAE4F,CAAC,EAAE,MAAL;QAAaC,CAAC,EAAE;MAAhB,CANyB;MAOnC3D,SAAS,EAAE,KAAKtT,MAAL,CAAYsT,SAPY;MAQnC8D,MAAM,EAAE,KAR2B;MASnC;MACAC,KAAK,EAAE,UAAUvQ,KAAV,EAAiB;QACpBgL,KAAK,CAAC9R,MAAN,CAAasX,MAAb,GAAsB,KAAtB;;QACAxF,KAAK,CAACtO,QAAN,CAAef,OAAf;;QACA3D,MAAM,CAACgT,KAAK,CAACtO,QAAN,CAAe/C,OAAhB,CAAN;QACAqR,KAAK,CAACtO,QAAN,GAAiB,IAAjB;MACH;IAfkC,CAAvB,CAAhB;IAiBApE,QAAQ,CAAC,CAAC,KAAKoE,QAAL,CAAc/C,OAAf,CAAD,EAA0B,cAA1B,CAAR;;IACA,IAAI,CAACvB,KAAK,CAAC,KAAKc,MAAL,CAAYmD,QAAb,CAAV,EAAkC;MAC9B/D,QAAQ,CAAC,CAAC,KAAKoE,QAAL,CAAc/C,OAAf,CAAD,EAA0B,KAAKT,MAAL,CAAYmD,QAAtC,CAAR;IACH;;IACD,KAAKK,QAAL,CAAc+T,eAAd,CAA8BpT,MAA9B;EACH,CA7DD;;EA8DApE,KAAK,CAACiB,SAAN,CAAgBY,QAAhB,GAA2B,UAAUsB,CAAV,EAAa;IACpC,IAAIiB,MAAM,GAAGjB,CAAC,CAACkB,IAAF,CAAOD,MAApB,CADoC,CAEpC;;IACA,IAAIA,MAAM,IAAIA,MAAM,CAAC0E,SAAjB,KAAgC,KAAKrF,QAAL,IAAiB,CAACzE,OAAO,CAACoF,MAAD,EAAS,SAAS,GAAT,GAAe,KAAKX,QAAL,CAAc/C,OAAd,CAAsBC,EAArC,GAA0C,GAA1C,GAAgD,GAAzD,CAAzB,IAC/B,KAAKgD,UAAL,IAAmB,CAAC3E,OAAO,CAACoF,MAAD,EAAS,MAAM,KAAKT,UAAL,CAAgBjD,OAAhB,CAAwBC,EAAvC,CAD5B,KAC6E,CAACyD,MAAM,CAAC0E,SAAP,CAAiBtD,QAAjB,CAA0B,gBAA1B,CAD9E,IAEApB,MAAM,CAAC8M,YAFP,IAEuB,CAAC9M,MAAM,CAAC8M,YAAP,CAAoBpI,SAApB,CAA8BtD,QAA9B,CAAuC,gCAAvC,CAF5B,EAEsG;MAClG,IAAI,KAAK/B,QAAT,EAAmB;QACf,KAAKA,QAAL,CAAc8E,IAAd;MACH;;MACD,IAAI,KAAK5E,UAAT,EAAqB;QACjB,KAAKA,UAAL,CAAgB4E,IAAhB;MACH;;MACD,KAAKtI,MAAL,CAAYsX,MAAZ,GAAqB,IAArB;MACA1X,aAAa,CAAC,KAAKI,MAAL,CAAYS,OAAb,EAAsB,UAAtB,CAAb;IACH;;IACD,IAAI+W,UAAU,GAAGzY,OAAO,CAACoF,MAAD,EAAS,IAAT,CAAxB;IACA,IAAIsT,OAAO,GAAGD,UAAU,IAAI,KAAKxX,MAAL,CAAYwE,aAAZ,CAA0BC,YAA1B,GAAyCc,QAAzC,CAAkDiS,UAAlD,CAAd,GAA8E,IAA9E,GAAqF,KAAnG;;IACA,IAAIrT,MAAM,IAAIA,MAAM,CAACI,OAAP,KAAmB,IAA7B,IAAqCJ,MAAM,CAACI,OAAP,KAAmB,IAAxD,IAAgE,CAACkT,OAAjE,IACA1Y,OAAO,CAACoF,MAAD,EAAS,oBAAT,CAAP,KAA0C,IAD1C,IACkDA,MAAM,CAAC8M,YADzD,IAEA,CAAC9M,MAAM,CAAC8M,YAAP,CAAoBpI,SAApB,CAA8BtD,QAA9B,CAAuC,kBAAvC,CAFD,IAGA,CAACpB,MAAM,CAAC8M,YAAP,CAAoBpI,SAApB,CAA8BtD,QAA9B,CAAuC,gCAAvC,CAHD,IAG6E,CAACxG,OAAO,CAACoF,MAAD,EAAS,uBAAT,CAHrF,IAIG,CAACpF,OAAO,CAACoF,MAAD,EAAS,iBAAT,CAJf,EAI4C;MACxC9E,WAAW,CAAC,KAAKW,MAAL,CAAY4H,YAAZ,CAAyBH,gBAAzB,CAA0C,UAA1C,CAAD,EAAwD9H,OAAO,CAACoK,aAAhE,CAAX;;MACA,IAAI,CAAC/K,OAAO,CAAC0Y,IAAb,EAAmB;QACf,KAAK7Q,qBAAL;MACH;IACJ;;IACD,IAAI1C,MAAM,IAAIA,MAAM,CAAC0E,SAAjB,IAA8B,CAAC1E,MAAM,CAAC0E,SAAP,CAAiBtD,QAAjB,CAA0B5F,OAAO,CAACqQ,cAAlC,CAA/B,IACA,CAAC7L,MAAM,CAAC0E,SAAP,CAAiBtD,QAAjB,CAA0B5F,OAAO,CAAC2Q,cAAlC,CADD,IACsD,CAACnM,MAAM,CAAC0E,SAAP,CAAiBtD,QAAjB,CAA0B5F,OAAO,CAACiR,cAAlC,CAD3D,EAC8G;MAC1G,KAAKlJ,mBAAL;IACH;EACJ,CA/BD;;EAgCA3H,KAAK,CAACiB,SAAN,CAAgBkV,SAAhB,GAA4B,UAAUD,QAAV,EAAoB7R,IAApB,EAA0B;IAClD,IAAIuT,MAAJ;IACA,IAAIhP,SAAJ;;IACA,KAAK,IAAIuE,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAG,CAAxB,EAA2BA,GAAG,EAA9B,EAAkC;MAC9ByK,MAAM,GAAG,KAAK3X,MAAL,CAAY4P,aAAZ,CAA0B,KAA1B,EAAiC;QAAEe,SAAS,EAAE,oBAAoB,GAApB,GAA0B,KAAK3Q,MAAL,CAAYmD,QAAnD;QAA6D0M,KAAK,EAAE;UAAE,eAAe,KAAK3C;QAAtB;MAApE,CAAjC,CAAT;;MACA,KAAK,IAAIK,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAG,EAAxB,EAA4BA,GAAG,EAA/B,EAAmC;QAC/B,IAAIqK,OAAO,GAAI1K,GAAG,GAAG,CAAP,GAAY,MAAZ,GAAqB,cAAnC;QACAvE,SAAS,GAAG,KAAK3I,MAAL,CAAY4P,aAAZ,CAA0B,KAA1B,EAAiC;UAAEe,SAAS,EAAE,8BAA8B,GAA9B,GAAoC,KAAK3Q,MAAL,CAAYmD,QAA7D;UAAuE0M,KAAK,EAAE;YAAE,aAAa,KAAKtC;UAApB;QAA9E,CAAjC,CAAZ;QACAoK,MAAM,CAACvH,WAAP,CAAmBzH,SAAnB;QACAA,SAAS,CAAC2C,KAAV,CAAgBsM,OAAhB,GAA0BA,OAA1B;;QACA,IAAIrK,GAAG,KAAK,CAAR,IAAaL,GAAG,KAAK,CAAzB,EAA4B;UACxB9N,QAAQ,CAAC,CAACuJ,SAAD,CAAD,EAAc,UAAd,CAAR;QACH;;QACDxJ,YAAY,CAAC4F,GAAb,CAAiB4D,SAAjB,EAA4B,WAA5B,EAAyC,KAAKsE,eAA9C,EAA+D,IAA/D;QACA9N,YAAY,CAAC4F,GAAb,CAAiB4S,MAAjB,EAAyB,YAAzB,EAAuC,KAAK3J,cAA5C,EAA4D,IAA5D;QACA7O,YAAY,CAAC4F,GAAb,CAAiB4D,SAAjB,EAA4B,SAA5B,EAAuC,KAAKsF,cAA5C,EAA4D;UAAE5F,IAAI,EAAE,IAAR;UAAcjE,IAAI,EAAEA,IAAI,CAACA,IAAzB;UAA+B4B,SAAS,EAAE5B,IAAI,CAAC4B;QAA/C,CAA5D;MACH;;MACDiQ,QAAQ,CAAC7F,WAAT,CAAqBuH,MAArB;IACH;EACJ,CAnBD;;EAoBA5X,KAAK,CAACiB,SAAN,CAAgByH,SAAhB,GAA4B,UAAUrE,IAAV,EAAgB;IACxC,IAAI0N,KAAK,GAAG,IAAZ;;IACA,KAAK+F,YAAL,CAAkBzT,IAAlB;IACA,IAAI0T,WAAW,GAAG,KAAKC,eAAL,CAAqB3T,IAArB,CAAlB;IACA,IAAI4T,MAAM,GAAG,KAAKrX,IAAL,CAAUqV,WAAV,CAAsB,cAAtB,CAAb;IACA,IAAItD,MAAM,GAAG,KAAK/R,IAAL,CAAUqV,WAAV,CAAsB,cAAtB,CAAb;IACA,IAAIiC,UAAU,GAAG,KAAKtX,IAAL,CAAUqV,WAAV,CAAsB,iBAAtB,CAAjB;IACA,KAAKtS,UAAL,CAAgBL,aAAhB,CAA8B;MAC1BiM,MAAM,EAAE,SADkB;MACPf,KAAK,EAAE,OADA;MACSiI,OAAO,EAAEsB,WADlB;MAC+BhC,MAAM,EAAEmC,UADvC;MAE1BC,OAAO,EAAE,CAAC;QACFC,KAAK,EAAE,KAAKC,eAAL,CAAqBC,IAArB,CAA0B,IAA1B,EAAgCjU,IAAhC,CADL;QAEFkU,WAAW,EAAE;UAAE9B,OAAO,EAAEwB,MAAX;UAAmB7U,QAAQ,EAAE,yBAAyB,GAAzB,GAA+B,KAAKnD,MAAL,CAAYmD,QAAxE;UAAkFoV,SAAS,EAAE;QAA7F;MAFX,CAAD,EAIL;QACIJ,KAAK,EAAE,UAAUjV,CAAV,EAAa;UAChB4O,KAAK,CAAC0G,YAAN,CAAmBtV,CAAnB;QACH,CAHL;QAIIoV,WAAW,EAAE;UAAEnV,QAAQ,EAAE,oBAAoB,GAApB,GAA0B,KAAKnD,MAAL,CAAYmD,QAAlD;UAA4DqT,OAAO,EAAE9D;QAArE;MAJjB,CAJK,CAFiB;MAY1BvP,QAAQ,EAAE,KAAKO,UAAL,CAAgBP,QAAhB,GAA2B;IAZX,CAA9B;IAcA,KAAKO,UAAL,CAAgBjD,OAAhB,CAAwB6K,KAAxB,CAA8BmN,SAA9B,GAA0C,MAA1C;IACA,KAAK/U,UAAL,CAAgB8S,OAAhB,CAAwBhR,aAAxB,CAAsC,OAAtC,EAA+CwC,KAA/C;IACA,KAAKnB,qBAAL;EACH,CAxBD;;EAyBA9G,KAAK,CAACiB,SAAN,CAAgBoH,iBAAhB,GAAoC,UAAUhE,IAAV,EAAgB;IAChD,IAAI2C,KAAK,GAAI,KAAKsB,IAAN,GAAc,KAAKA,IAAnB,GAA0B,IAAtC;;IACA,IAAItB,KAAK,CAACvD,QAAV,EAAoB;MAChBuD,KAAK,CAACvD,QAAN,CAAe8E,IAAf;IACH;;IACDvB,KAAK,CAAC8Q,YAAN,CAAmBzT,IAAnB;IACA,IAAIsU,UAAU,GAAG3R,KAAK,CAAC4R,mBAAN,EAAjB;IACA,IAAIC,MAAM,GAAG7R,KAAK,CAACpG,IAAN,CAAWqV,WAAX,CAAuB,cAAvB,CAAb;IACA,IAAItD,MAAM,GAAG3L,KAAK,CAACpG,IAAN,CAAWqV,WAAX,CAAuB,cAAvB,CAAb;;IACA,IAAI/W,iBAAiB,CAAC8H,KAAK,CAACrD,UAAP,CAArB,EAAyC;MACrC;IACH;;IACDqD,KAAK,CAACrD,UAAN,CAAiBL,aAAjB,CAA+B;MAC3BiM,MAAM,EAAE,SADmB;MACRf,KAAK,EAAE,OADC;MACQiI,OAAO,EAAEkC,UADjB;MAE3BR,OAAO,EAAE,CAAC;QACFC,KAAK,EAAEpR,KAAK,CAAC8R,WAAN,CAAkBR,IAAlB,CAAuB,IAAvB,EAA6BjU,IAA7B,CADL;QAEFkU,WAAW,EAAE;UAAE9B,OAAO,EAAEoC,MAAX;UAAmBzV,QAAQ,EAAE,0BAA0B,GAA1B,GAAgC4D,KAAK,CAAC/G,MAAN,CAAamD,QAA1E;UAAoFoV,SAAS,EAAE;QAA/F;MAFX,CAAD,EAIL;QACIJ,KAAK,EAAE,UAAUjV,CAAV,EAAa;UAChB6D,KAAK,CAACyR,YAAN,CAAmBtV,CAAnB;QACH,CAHL;QAIIoV,WAAW,EAAE;UAAEnV,QAAQ,EAAE,oBAAoB,GAApB,GAA0B4D,KAAK,CAAC/G,MAAN,CAAamD,QAAnD;UAA6DqT,OAAO,EAAE9D;QAAtE;MAJjB,CAJK;IAFkB,CAA/B;;IAaA,IAAI,CAACxT,KAAK,CAAC6H,KAAK,CAAC/G,MAAN,CAAamD,QAAd,CAAV,EAAmC;MAC/B4D,KAAK,CAACrD,UAAN,CAAiBL,aAAjB,CAA+B;QAAEF,QAAQ,EAAE4D,KAAK,CAAC/G,MAAN,CAAamD;MAAzB,CAA/B;IACH;;IACD4D,KAAK,CAACrD,UAAN,CAAiBjD,OAAjB,CAAyB6K,KAAzB,CAA+BmN,SAA/B,GAA2C,MAA3C;IACA1R,KAAK,CAACrD,UAAN,CAAiB8S,OAAjB,CAAyBhR,aAAzB,CAAuC,OAAvC,EAAgDwC,KAAhD;EACH,CA9BD;;EA+BAjI,KAAK,CAACiB,SAAN,CAAgB2X,mBAAhB,GAAsC,YAAY;IAC9C,IAAIG,WAAW,GAAG,KAAKnY,IAAL,CAAUqV,WAAV,CAAsB,SAAtB,CAAlB;IACA,IAAI+C,QAAQ,GAAG,KAAKpY,IAAL,CAAUqV,WAAV,CAAsB,MAAtB,CAAf;IACA,IAAIgD,SAAS,GAAG,KAAKhZ,MAAL,CAAY4P,aAAZ,CAA0B,KAA1B,EAAiC;MAAEe,SAAS,EAAE,gBAAgB,GAAhB,GAAsB,KAAK3Q,MAAL,CAAYmD;IAA/C,CAAjC,CAAhB;IACA,IAAIqT,OAAO,GAAG,4BAA4B,GAA5B,GAAkC,KAAKxW,MAAL,CAAYmD,QAA9C,GAAyD,uBAAzD,GACR,2DADQ,GACsD,GADtD,GAC4D,KAAKnD,MAAL,CAAYmD,QADxE,GACmF,WADnF,GAER,yBAFQ,GAEoB,GAFpB,GAE0B,KAAKnD,MAAL,CAAYmD,QAFtC,GAEiD,yEAFjD,GAE6H,GAF7H,GAEmI,KAAKnD,MAAL,CAAYmD,QAF/I,GAE0J,YAFxK;IAGA,IAAI8V,WAAW,GAAGpZ,SAAS,CAAC2W,OAAD,CAA3B;IACAwC,SAAS,CAAC5I,WAAV,CAAsB6I,WAAtB;IACA,KAAKrV,aAAL,GAAqB,IAAIlE,cAAJ,CAAmB;MACpCwZ,MAAM,EAAE,IAD4B;MAEpCC,GAAG,EAAE,CAF+B;MAGpC3N,KAAK,EAAE,CAH6B;MAIpC4N,WAAW,EAAEN,WAJuB;MAKpCO,cAAc,EAAE,MALoB;MAMpClG,GAAG,EAAE,EAN+B;MAOpCG,SAAS,EAAE,KAAKtT,MAAL,CAAYsT,SAPa;MAOFmD,MAAM,EAAE,KAAKzW,MAAL,CAAYyW,MAPlB;MAQpCtT,QAAQ,EAAE,KAAKnD,MAAL,CAAYmD;IARc,CAAnB,CAArB;IAUA,KAAKS,aAAL,CAAmB8S,gBAAnB,GAAsC,IAAtC;IACA,KAAK9S,aAAL,CAAmB+S,QAAnB,CAA4BqC,SAAS,CAACxT,aAAV,CAAwB,cAAxB,CAA5B;IACA,KAAK3B,UAAL,GAAkB,IAAInE,cAAJ,CAAmB;MACjCwZ,MAAM,EAAE,IADyB;MAEjCC,GAAG,EAAE,CAF4B;MAGjC3N,KAAK,EAAE,CAH0B;MAIjC4N,WAAW,EAAEL,QAJoB;MAKjCM,cAAc,EAAE,MALiB;MAMjClG,GAAG,EAAE,EAN4B;MAOjCG,SAAS,EAAE,KAAKtT,MAAL,CAAYsT,SAPU;MAOCmD,MAAM,EAAE,KAAKzW,MAAL,CAAYyW,MAPrB;MAQjCtT,QAAQ,EAAE,KAAKnD,MAAL,CAAYmD;IARW,CAAnB,CAAlB;IAUA,KAAKU,UAAL,CAAgB6S,gBAAhB,GAAmC,IAAnC;IACA,KAAK7S,UAAL,CAAgB8S,QAAhB,CAAyBqC,SAAS,CAACxT,aAAV,CAAwB,WAAxB,CAAzB;IACA,OAAOwT,SAAP;EACH,CAlCD;;EAmCAjZ,KAAK,CAACiB,SAAN,CAAgBe,cAAhB,GAAiC,YAAY;IACzC,IAAI,KAAK2B,UAAT,EAAqB;MACjB,KAAKA,UAAL,CAAgBjB,OAAhB;MACA3D,MAAM,CAAC,KAAK4E,UAAL,CAAgBjD,OAAjB,CAAN;MACA,KAAKiD,UAAL,GAAkB,IAAlB;IACH;EACJ,CAND,CArqCmC,CA4qCnC;;;EACA3D,KAAK,CAACiB,SAAN,CAAgB6W,YAAhB,GAA+B,UAAUzT,IAAV,EAAgB;IAC3C,IAAI0N,KAAK,GAAG,IAAZ;;IACA,IAAI,KAAKpO,UAAT,EAAqB;MACjB,KAAKA,UAAL,CAAgB4E,IAAhB,CAAqB;QAAEC,WAAW,EAAE;MAAf,CAArB;MACA;IACH;;IACD,IAAI+Q,WAAW,GAAG,KAAKtZ,MAAL,CAAY4P,aAAZ,CAA0B,KAA1B,EAAiC;MAC/Ce,SAAS,EAAE,qBAAqB,GAArB,GAA2B,KAAK3Q,MAAL,CAAYmD,QADH;MACazC,EAAE,EAAE,KAAKF,KAAL,GAAa;IAD9B,CAAjC,CAAlB;IAGA,KAAKR,MAAL,CAAYS,OAAZ,CAAoB2P,WAApB,CAAgCkJ,WAAhC;IACA,IAAIV,MAAM,GAAG,KAAKjY,IAAL,CAAUqV,WAAV,CAAsB,cAAtB,CAAb;IACA,IAAItD,MAAM,GAAG,KAAK/R,IAAL,CAAUqV,WAAV,CAAsB,cAAtB,CAAb;IACA,IAAIF,MAAM,GAAG,KAAKnV,IAAL,CAAUqV,WAAV,CAAsB,mBAAtB,CAAb;IACA,IAAIuD,WAAW,GAAG;MACdzD,MAAM,EAAEA,MADM;MAEd3S,QAAQ,EAAExD,OAAO,CAAC6Z,gBAAR,GAA2B,GAA3B,GAAiC,KAAKxZ,MAAL,CAAYmD,QAFzC;MAGdmQ,SAAS,EAAE,KAAKtT,MAAL,CAAYsT,SAHT;MAIdmD,MAAM,EAAE,KAAKzW,MAAL,CAAYyW,MAJN;MAKdgD,aAAa,EAAE,IALD;MAKOC,aAAa,EAAE,IALtB;MAK4BnL,KAAK,EAAGvP,OAAO,CAACkG,QAAT,GAAqB,OAArB,GAA+B,OALlE;MAK2EoK,MAAM,EAAE,SALnF;MAMd8B,QAAQ,EAAE;QAAE4F,CAAC,EAAE,QAAL;QAAeC,CAAC,EAAGjY,OAAO,CAACkG,QAAT,GAAqB,QAArB,GAAgC;MAAlD,CANI;MAOdyU,OAAO,EAAE3a,OAAO,CAACkG,QAPH;MAQdgT,OAAO,EAAE,CAAC;QACFI,WAAW,EAAE;UAAE9B,OAAO,EAAEoC,MAAX;UAAmBzV,QAAQ,EAAE,0BAA0B,GAA1B,GAAgC,KAAKnD,MAAL,CAAYmD,QAAzE;UAAmFoV,SAAS,EAAE;QAA9F;MADX,CAAD,EAGL;QACIJ,KAAK,EAAE,UAAUjV,CAAV,EAAa;UAChB4O,KAAK,CAAC0G,YAAN,CAAmBtV,CAAnB;QACH,CAHL;QAIIoV,WAAW,EAAE;UAAEnV,QAAQ,EAAE,oBAAoB,GAApB,GAA0B,KAAKnD,MAAL,CAAYmD,QAAlD;UAA4DqT,OAAO,EAAE9D;QAArE;MAJjB,CAHK,CARK;MAiBdvO,MAAM,EAAGnF,OAAO,CAACkG,QAAT,GAAqBG,QAAQ,CAACC,IAA9B,GAAqC,KAAKtF,MAAL,CAAYS,OAjB3C;MAkBdmZ,iBAAiB,EAAE;QAAEC,MAAM,EAAE;MAAV,CAlBL;MAmBdxC,KAAK,EAAE,UAAUvQ,KAAV,EAAiB;QACpBgL,KAAK,CAAC9R,MAAN,CAAasX,MAAb,GAAsB,KAAtB;;QACAxF,KAAK,CAACpO,UAAN,CAAiBjB,OAAjB;;QACA3D,MAAM,CAACgT,KAAK,CAACpO,UAAN,CAAiBjD,OAAlB,CAAN;;QACAqR,KAAK,CAAChR,eAAN,CAAsBuW,KAAtB,CAA4BvQ,KAA5B;;QACAgL,KAAK,CAACpO,UAAN,GAAmB,IAAnB;MACH;IAzBa,CAAlB;IA2BA,KAAKA,UAAL,GAAkB,KAAK5C,eAAL,CAAqBgZ,MAArB,CAA4BP,WAA5B,CAAlB;IACA,KAAK7V,UAAL,CAAgBiT,QAAhB,CAAyB2C,WAAzB;;IACA,IAAI,KAAK7N,YAAL,IAAqB,KAAKA,YAAL,CAAkBsO,WAAvC,IAAsD1U,QAAQ,CAACC,IAAT,CAAcC,QAAd,CAAuB,KAAKkG,YAAL,CAAkBsO,WAAlB,CAA8BtZ,OAArD,CAA1D,EAAyH;MACrH,KAAKgL,YAAL,CAAkBsO,WAAlB,CAA8BpO,SAA9B;IACH;EACJ,CA7CD;;EA8CA5L,KAAK,CAACiB,SAAN,CAAgB6X,WAAhB,GAA8B,UAAUzU,IAAV,EAAgBlB,CAAhB,EAAmB;IAC7C,IAAI6D,KAAK,GAAI,KAAKsB,IAAN,GAAc,KAAKA,IAAnB,GAA0B,IAAtC;;IACA,IAAItB,KAAK,CAAClD,UAAN,CAAiB2H,KAAjB,IAA0BzE,KAAK,CAACnD,aAAN,CAAoB4H,KAAlD,EAAyD;MACrD,IAAIwO,QAAQ,GAAKhb,OAAO,CAACkG,QAAR,IAAqB,CAACjG,iBAAiB,CAACmF,IAAI,CAACA,IAAN,CAAlB,IAC/B,CAACnF,iBAAiB,CAACmF,IAAI,CAACA,IAAL,CAAU+D,aAAX,CADa,IAElC/D,IAAI,CAACA,IAAL,CAAU+D,aAAV,CAAwBnB,MAAxB,KAAmC,cAFtB,IAGVD,KAAK,CAAC/G,MAAN,CAAa6V,UAAb,CAAwBnJ,MAHf,GAGyBtI,IAHzB,GAGgC,IAHhD;MAIA2C,KAAK,CAACmH,WAAN,CAAkBnH,KAAK,CAAClD,UAAN,CAAiB2H,KAAnC,EAA0CzE,KAAK,CAACnD,aAAN,CAAoB4H,KAA9D,EAAqEtI,CAArE,EAAwE8W,QAAxE;IACH;EACJ,CATD,CA3tCmC,CAquCnC;;;EACAja,KAAK,CAACiB,SAAN,CAAgBwX,YAAhB,GAA+B,UAAUtV,CAAV,EAAa;IACxC,KAAKlD,MAAL,CAAYsX,MAAZ,GAAqB,KAArB;IACA,KAAK5T,UAAL,CAAgB4E,IAAhB,CAAqB;MAAEC,WAAW,EAAE;IAAf,CAArB;EACH,CAHD,CAtuCmC,CA0uCnC;;;EACAxI,KAAK,CAACiB,SAAN,CAAgBoX,eAAhB,GAAkC,UAAUhU,IAAV,EAAgBlB,CAAhB,EAAmB;IACjD,IAAI+W,SAAS,GAAG,KAAKvW,UAAL,CAAgBjD,OAAhC;IACA,IAAImI,KAAK,GAAG7J,OAAO,CAACqF,IAAI,CAAC2K,UAAL,CAAgB,CAAhB,CAAD,EAAqB,OAArB,CAAnB;IACAnG,KAAK,CAAC0C,KAAN,CAAYiD,KAAZ,GAAoB0L,SAAS,CAACzU,aAAV,CAAwB,gBAAxB,EAA0CgG,KAA1C,GAAkD,IAAtE;;IACA,IAAIyO,SAAS,CAACzU,aAAV,CAAwB,iBAAxB,EAA2CgG,KAA3C,KAAqD,EAAzD,EAA6D;MACzD,IAAI0O,KAAK,GAAGtR,KAAK,CAACnB,gBAAN,CAAuB,IAAvB,CAAZ;;MACA,KAAK,IAAIxD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiW,KAAK,CAAChW,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;QACnC,IAAIkW,MAAM,GAAG,EAAb;;QACA,IAAID,KAAK,CAACjW,CAAD,CAAL,CAASqH,KAAT,CAAe8O,OAAf,KAA2B,EAA/B,EAAmC;UAC/BD,MAAM,GAAGD,KAAK,CAACjW,CAAD,CAAL,CAASuM,YAAT,CAAsB,OAAtB,IAAiC,WAAjC,GACLyJ,SAAS,CAACzU,aAAV,CAAwB,iBAAxB,EAA2CgG,KADtC,GAC8C,KADvD;QAEH,CAHD,MAIK;UACD0O,KAAK,CAACjW,CAAD,CAAL,CAASqH,KAAT,CAAe8O,OAAf,GAAyBH,SAAS,CAACzU,aAAV,CAAwB,iBAAxB,EAA2CgG,KAA3C,GAAmD,IAA5E;UACA2O,MAAM,GAAGD,KAAK,CAACjW,CAAD,CAAL,CAASuM,YAAT,CAAsB,OAAtB,CAAT;QACH;;QACD0J,KAAK,CAACjW,CAAD,CAAL,CAASS,YAAT,CAAsB,OAAtB,EAA+ByV,MAA/B;MACH;IACJ;;IACDvR,KAAK,CAACyR,WAAN,GAAoBJ,SAAS,CAACzU,aAAV,CAAwB,iBAAxB,EAA2CgG,KAA/D;;IACA,IAAI,CAACtM,KAAK,CAAC0J,KAAK,CAACyR,WAAP,CAAN,IAA6BzR,KAAK,CAACyR,WAAN,KAAsB,GAAvD,EAA4D;MACxDjb,QAAQ,CAAC,CAACwJ,KAAD,CAAD,EAAUjJ,OAAO,CAAC2a,gBAAlB,CAAR;IACH,CAFD,MAGK;MACDjb,WAAW,CAAC,CAACuJ,KAAD,CAAD,EAAUjJ,OAAO,CAAC2a,gBAAlB,CAAX;IACH;;IACD,KAAKta,MAAL,CAAY2F,SAAZ,CAAsBuD,QAAtB;IACA,KAAKxF,UAAL,CAAgB4E,IAAhB,CAAqB;MAAEC,WAAW,EAAE;IAAf,CAArB;EACH,CA5BD;;EA6BAxI,KAAK,CAACiB,SAAN,CAAgB+W,eAAhB,GAAkC,UAAU7U,CAAV,EAAa;IAC3C,IAAI6L,UAAU,GAAG7L,CAAC,CAACgD,YAAF,CAAe,CAAf,CAAjB;IACA,IAAIwN,UAAU,GAAG,KAAK/S,IAAL,CAAUqV,WAAV,CAAsB,YAAtB,CAAjB;IACA,IAAIuE,WAAW,GAAG,KAAK5Z,IAAL,CAAUqV,WAAV,CAAsB,aAAtB,CAAlB;IACA,IAAIqE,WAAW,GAAG,KAAK1Z,IAAL,CAAUqV,WAAV,CAAsB,aAAtB,CAAlB;IACA,IAAIgD,SAAS,GAAG,KAAKhZ,MAAL,CAAY4P,aAAZ,CAA0B,KAA1B,EAAiC;MAAEe,SAAS,EAAE,qBAAqB,GAArB,GAA2B,KAAK3Q,MAAL,CAAYmD;IAApD,CAAjC,CAAhB;IACA,IAAIqX,QAAQ,GAAGzb,OAAO,CAACgQ,UAAD,EAAa,OAAb,CAAP,CAA6B0L,cAA7B,GAA8C,CAA9C,EAAiDlM,KAAhE;IACA,IAAI4L,MAAM,GAAGpb,OAAO,CAACgQ,UAAD,EAAa,IAAb,CAAP,CAA0BzD,KAA1B,CAAgC8O,OAA7C;IACA,IAAIM,SAAS,GAAG3b,OAAO,CAACgQ,UAAD,EAAa,OAAb,CAAP,CAA6ByB,YAA7B,CAA0C,aAA1C,CAAhB;IACA,IAAIgG,OAAO,GAAG,4BAA4B,GAA5B,GAAkC,KAAKxW,MAAL,CAAYmD,QAA9C,GAAyD,6EAAzD,GAAyI,GAAzI,GAA+I,KAAKnD,MAAL,CAAYmD,QAA3J,GAAsK,IAAtK,GACR,WADQ,GACM,yBADN,GACkC,GADlC,GACwC,KAAKnD,MAAL,CAAYmD,QADpD,GAC+D,+EAD/D,GACiJ,GADjJ,GACuJ,KAAKnD,MAAL,CAAYmD,QADnK,GAC8K,MAD9K,GAER,gCAFQ,GAE2B,GAF3B,GAEiC,KAAKnD,MAAL,CAAYmD,QAF7C,GAEwD,+EAFxD,GAE0I,GAF1I,GAEgJ,KAAKnD,MAAL,CAAYmD,QAF5J,GAEuK,YAFrL;IAGA,IAAI8V,WAAW,GAAGpZ,SAAS,CAAC2W,OAAD,CAA3B;IACAwC,SAAS,CAAC5I,WAAV,CAAsB6I,WAAtB;IACA,KAAKnV,aAAL,GAAqB,IAAIpE,cAAJ,CAAmB;MACpCwZ,MAAM,EAAE,IAD4B;MAEpCC,GAAG,EAAE,CAF+B;MAGpC3N,KAAK,EAAEgP,QAH6B;MAIpCpB,WAAW,EAAE1F,UAJuB;MAKpC2F,cAAc,EAAE,MALoB;MAMpC/F,SAAS,EAAE,KAAKtT,MAAL,CAAYsT,SANa;MAMFmD,MAAM,EAAE,KAAKzW,MAAL,CAAYyW;IANlB,CAAnB,CAArB;IAQA,KAAK3S,aAAL,CAAmB4S,gBAAnB,GAAsC,IAAtC;IACA,KAAK5S,aAAL,CAAmB6S,QAAnB,CAA4BqC,SAAS,CAACxT,aAAV,CAAwB,aAAxB,CAA5B;IACA,KAAKzB,gBAAL,GAAwB,IAAIrE,cAAJ,CAAmB;MACvCwZ,MAAM,EAAE,IAD+B;MAEvCC,GAAG,EAAE,CAFkC;MAGvC;MACA3N,KAAK,EAAE2O,MAAM,KAAK,EAAX,GAAgB5K,QAAQ,CAAC4K,MAAD,EAAS,IAAT,CAAxB,GAAyC,CAJT;MAKvCf,WAAW,EAAEmB,WAL0B;MAMvClB,cAAc,EAAE,MANuB;MAOvC/F,SAAS,EAAE,KAAKtT,MAAL,CAAYsT,SAPgB;MAOLmD,MAAM,EAAE,KAAKzW,MAAL,CAAYyW;IAPf,CAAnB,CAAxB;IASA,KAAK1S,gBAAL,CAAsB2S,gBAAtB,GAAyC,IAAzC;IACA,KAAK3S,gBAAL,CAAsB4S,QAAtB,CAA+BqC,SAAS,CAACxT,aAAV,CAAwB,cAAxB,CAA/B;IACA,KAAKxB,gBAAL,GAAwB,IAAItE,cAAJ,CAAmB;MACvCwZ,MAAM,EAAE,IAD+B;MAEvCC,GAAG,EAAE,CAFkC;MAGvC;MACA3N,KAAK,EAAEkP,SAAS,KAAK,EAAd,IAAoB,CAACxb,KAAK,CAACwb,SAAD,CAA1B,GAAwCnL,QAAQ,CAACmL,SAAD,EAAY,IAAZ,CAAhD,GAAoE,CAJpC;MAKvCtB,WAAW,EAAEiB,WAL0B;MAMvChB,cAAc,EAAE,MANuB;MAOvC/F,SAAS,EAAE,KAAKtT,MAAL,CAAYsT,SAPgB;MAOLmD,MAAM,EAAE,KAAKzW,MAAL,CAAYyW;IAPf,CAAnB,CAAxB;IASA,KAAKzS,gBAAL,CAAsB0S,gBAAtB,GAAyC,IAAzC;IACA,KAAK1S,gBAAL,CAAsB2S,QAAtB,CAA+BqC,SAAS,CAACxT,aAAV,CAAwB,cAAxB,CAA/B;IACA,OAAOwT,SAAP;EACH,CA/CD;EAgDA;AACJ;AACA;AACA;AACA;AACA;AACA;;;EAEIjZ,KAAK,CAACiB,SAAN,CAAgByB,OAAhB,GAA0B,YAAY;IAClC,KAAKC,mBAAL;EACH,CAFD;EAGA;AACJ;AACA;AACA;AACA;;;EACI3C,KAAK,CAACiB,SAAN,CAAgB2Z,aAAhB,GAAgC,YAAY;IACxC,OAAO,OAAP;EACH,CAFD;;EAGA,OAAO5a,KAAP;AACH,CA50C0B,EAA3B;;AA60CA,SAASA,KAAT"},"metadata":{},"sourceType":"module"}