{"ast":null,"code":"/* tslint:disable-next-line:max-line-length */\nimport { EventHandler, isNullOrUndefined, extend, classList, addClass, removeClass, Browser, getValue, setValue } from '@syncfusion/ej2-base';\nimport { parentsUntil, getUid, appendChildren, getDatePredicate, getObject, extendObjWithFn, eventPromise, setChecked, clearReactVueTemplates } from '../base/util';\nimport { remove, debounce, Internationalization } from '@syncfusion/ej2-base';\nimport { DataUtil, Query, DataManager, Predicate } from '@syncfusion/ej2-data';\nimport { createCheckBox } from '@syncfusion/ej2-buttons';\nimport * as events from '../base/constant';\nimport { ValueFormatter } from '../services/value-formatter';\nimport { getForeignData } from '../base/util';\nimport { Dialog } from '@syncfusion/ej2-popups';\nimport { Input } from '@syncfusion/ej2-inputs';\nimport { createSpinner, hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nimport { getFilterMenuPostion, toogleCheckbox, createCboxWithWrap, removeAddCboxClasses, getColumnByForeignKeyValue } from '../base/util';\n/**\n * @hidden\n * `CheckBoxFilterBase` module is used to handle filtering action.\n */\n\nvar CheckBoxFilterBase =\n/** @class */\nfunction () {\n  /**\n   * Constructor for checkbox filtering module\n   *\n   * @param {IXLFilter} parent - specifies the IXLFilter\n   * @hidden\n   */\n  function CheckBoxFilterBase(parent) {\n    this.existingPredicate = {};\n    this.foreignKeyQuery = new Query();\n    /** @hidden */\n\n    this.filterState = true;\n    this.values = {};\n    this.renderEmpty = false;\n    this.isCheckboxFilterTemplate = false;\n    this.parent = parent;\n    this.id = this.parent.element.id;\n    this.valueFormatter = new ValueFormatter(this.parent.locale);\n    this.cBoxTrue = createCheckBox(this.parent.createElement, false, {\n      checked: true,\n      label: ' '\n    });\n    this.cBoxFalse = createCheckBox(this.parent.createElement, false, {\n      checked: false,\n      label: ' '\n    });\n    this.cBoxTrue.insertBefore(this.parent.createElement('input', {\n      className: 'e-chk-hidden',\n      attrs: {\n        type: 'checkbox'\n      }\n    }), this.cBoxTrue.firstChild);\n    this.cBoxFalse.insertBefore(this.parent.createElement('input', {\n      className: 'e-chk-hidden',\n      attrs: {\n        'type': 'checkbox'\n      }\n    }), this.cBoxFalse.firstChild);\n    this.cBoxFalse.querySelector('.e-frame').classList.add('e-uncheck');\n\n    if (this.parent.enableRtl) {\n      addClass([this.cBoxTrue, this.cBoxFalse], ['e-rtl']);\n    }\n\n    if (this.parent.cssClass) {\n      addClass([this.cBoxTrue, this.cBoxFalse], [this.parent.cssClass]);\n    }\n  }\n  /**\n   * @returns {void}\n   * @hidden\n   */\n\n\n  CheckBoxFilterBase.prototype.destroy = function () {\n    this.closeDialog();\n  };\n\n  CheckBoxFilterBase.prototype.wireEvents = function () {\n    EventHandler.add(this.dlg, 'click', this.clickHandler, this);\n    EventHandler.add(this.dlg, 'keyup', this.keyupHandler, this);\n    this.searchHandler = debounce(this.searchBoxKeyUp, 200);\n    var elem = this.dialogObj.element.querySelector('.e-searchinput');\n\n    if (elem) {\n      EventHandler.add(elem, 'keyup', this.searchHandler, this);\n    }\n  };\n\n  CheckBoxFilterBase.prototype.unWireEvents = function () {\n    EventHandler.remove(this.dlg, 'click', this.clickHandler);\n    EventHandler.remove(this.dlg, 'keyup', this.keyupHandler);\n    var elem = this.dialogObj.element.querySelector('.e-searchinput');\n\n    if (elem) {\n      EventHandler.remove(elem, 'keyup', this.searchHandler);\n    }\n  };\n\n  CheckBoxFilterBase.prototype.foreignKeyFilter = function (args, fColl, mPredicate) {\n    var _this = this;\n\n    var fPredicate = {};\n    var filterCollection = [];\n    var query = this.foreignKeyQuery.clone();\n    this.options.column.dataSource.executeQuery(query.where(mPredicate)).then(function (e) {\n      _this.options.column.columnData = e.result;\n\n      _this.parent.notify(events.generateQuery, {\n        predicate: fPredicate,\n        column: _this.options.column\n      });\n\n      args.ejpredicate = fPredicate.predicate.predicates;\n      var fpred = fPredicate.predicate.predicates;\n\n      for (var i = 0; i < fpred.length; i++) {\n        filterCollection.push({\n          field: fpred[i].field,\n          predicate: 'or',\n          matchCase: fpred[i].ignoreCase,\n          ignoreAccent: fpred[i].ignoreAccent,\n          operator: fpred[i].operator,\n          value: fpred[i].value,\n          type: _this.options.type\n        });\n      }\n\n      args.filterCollection = filterCollection.length ? filterCollection : fColl.filter(function (col) {\n        return col.field = _this.options.field;\n      });\n\n      _this.options.handler(args);\n    });\n  };\n\n  CheckBoxFilterBase.prototype.foreignFilter = function (args, value) {\n    var operator = this.options.isRemote ? this.options.column.type === 'string' ? 'contains' : 'equal' : this.options.column.type ? 'contains' : 'equal';\n    var initalPredicate = new Predicate(this.options.column.foreignKeyValue, operator, value, true, this.options.ignoreAccent);\n    this.foreignKeyFilter(args, [args.filterCollection], initalPredicate);\n  };\n\n  CheckBoxFilterBase.prototype.searchBoxClick = function (e) {\n    var target = e.target;\n\n    if (target.classList.contains('e-searchclear')) {\n      this.sInput.value = '';\n\n      if (this.isCheckboxFilterTemplate) {\n        this.parent.notify('refreshCheckbox', {\n          event: e\n        });\n      } else {\n        this.refreshCheckboxes();\n      }\n\n      this.updateSearchIcon();\n      this.sInput.focus();\n    }\n  };\n\n  CheckBoxFilterBase.prototype.searchBoxKeyUp = function (e) {\n    if (this.isCheckboxFilterTemplate) {\n      this.parent.notify('refreshCheckbox', {\n        event: e\n      });\n    } else {\n      this.refreshCheckboxes();\n    }\n\n    this.updateSearchIcon();\n  };\n\n  CheckBoxFilterBase.prototype.updateSearchIcon = function () {\n    if (this.sInput.value.length) {\n      classList(this.sIcon, ['e-chkcancel-icon'], ['e-search-icon']);\n    } else {\n      classList(this.sIcon, ['e-search-icon'], ['e-chkcancel-icon']);\n    }\n  };\n  /**\n   * Gets the localized label by locale keyword.\n   *\n   * @param {string} key - Defines localization key\n   * @returns {string} - returns localization label\n   */\n\n\n  CheckBoxFilterBase.prototype.getLocalizedLabel = function (key) {\n    return this.localeObj.getConstant(key);\n  };\n\n  CheckBoxFilterBase.prototype.updateDataSource = function () {\n    var dataSource = this.options.dataSource;\n    var str = 'object';\n\n    if (!(dataSource instanceof DataManager)) {\n      for (var i = 0; i < dataSource.length; i++) {\n        // eslint-disable-next-line valid-typeof\n        if (typeof dataSource !== str) {\n          var obj = {};\n          obj[this.options.field] = dataSource[i];\n          dataSource[i] = obj;\n        }\n      }\n    }\n  };\n\n  CheckBoxFilterBase.prototype.updateModel = function (options) {\n    this.options = options;\n    this.existingPredicate = options.actualPredicate || {};\n    this.options.dataSource = options.dataSource;\n    this.options.dataManager = options.dataManager ? options.dataManager : options.dataSource;\n    this.updateDataSource();\n    this.options.type = options.type;\n    this.options.format = options.format || '';\n    this.options.ignoreAccent = options.ignoreAccent || false;\n    this.options.filteredColumns = options.filteredColumns || this.parent.filterSettings.columns;\n    this.options.query = options.query || new Query();\n    this.options.allowCaseSensitive = options.allowCaseSensitive || false;\n    this.options.uid = options.column.uid;\n    this.options.disableHtmlEncode = options.column.disableHtmlEncode || false;\n    this.values = {};\n    this.localeObj = options.localeObj;\n    this.isFiltered = options.filteredColumns.length;\n  };\n\n  CheckBoxFilterBase.prototype.getAndSetChkElem = function (options) {\n    this.dlg = this.parent.createElement('div', {\n      id: this.id + this.options.type + '_excelDlg',\n      attrs: {\n        uid: this.options.column.uid\n      },\n      className: 'e-checkboxfilter e-filter-popup'\n    });\n    this.sBox = this.parent.createElement('div', {\n      className: 'e-searchcontainer'\n    });\n\n    if (!options.hideSearchbox) {\n      this.sInput = this.parent.createElement('input', {\n        id: this.id + '_SearchBox',\n        className: 'e-searchinput'\n      });\n      this.sIcon = this.parent.createElement('span', {\n        className: 'e-searchclear e-search-icon e-icons e-input-group-icon',\n        attrs: {\n          type: 'text',\n          title: this.getLocalizedLabel('Search')\n        }\n      });\n      this.searchBox = this.parent.createElement('span', {\n        className: 'e-searchbox e-fields'\n      });\n      this.searchBox.appendChild(this.sInput);\n      this.sBox.appendChild(this.searchBox);\n      var inputargs = {\n        element: this.sInput,\n        floatLabelType: 'Never',\n        properties: {\n          placeholder: this.getLocalizedLabel('Search'),\n          cssClass: this.parent.cssClass\n        }\n      };\n      Input.createInput(inputargs, this.parent.createElement);\n      this.searchBox.querySelector('.e-input-group').appendChild(this.sIcon);\n    }\n\n    this.spinner = this.parent.createElement('div', {\n      className: 'e-spinner'\n    }); //for spinner\n\n    this.cBox = this.parent.createElement('div', {\n      id: this.id + this.options.type + '_CheckBoxList',\n      className: 'e-checkboxlist e-fields'\n    });\n    this.spinner.appendChild(this.cBox);\n    this.sBox.appendChild(this.spinner);\n    return this.sBox;\n  };\n\n  CheckBoxFilterBase.prototype.showDialog = function (options) {\n    var args = {\n      requestType: events.filterBeforeOpen,\n      columnName: this.options.field,\n      columnType: this.options.type,\n      cancel: false\n    };\n    var filterModel = 'filterModel';\n    args[filterModel] = this;\n    this.parent.notify(events.cBoxFltrBegin, args);\n\n    if (args.cancel) {\n      options.cancel = args.cancel;\n      return;\n    }\n\n    this.dialogObj = new Dialog({\n      visible: false,\n      content: this.sBox,\n      close: this.closeDialog.bind(this),\n      enableRtl: this.parent.enableRtl,\n      width: !isNullOrUndefined(parentsUntil(options.target, 'e-bigger')) || this.parent.element.classList.contains('e-device') ? 260 : 255,\n      target: this.parent.element,\n      animationSettings: {\n        effect: 'None'\n      },\n      buttons: [{\n        click: this.btnClick.bind(this),\n        buttonModel: {\n          content: this.getLocalizedLabel(this.isExcel ? 'OKButton' : 'FilterButton'),\n          cssClass: this.parent.cssClass ? 'e-primary' + ' ' + this.parent.cssClass : 'e-primary',\n          isPrimary: true\n        }\n      }, {\n        click: this.btnClick.bind(this),\n        buttonModel: {\n          cssClass: this.parent.cssClass ? 'e-flat' + ' ' + this.parent.cssClass : 'e-flat',\n          content: this.getLocalizedLabel(this.isExcel ? 'CancelButton' : 'ClearButton')\n        }\n      }],\n      created: this.dialogCreated.bind(this),\n      open: this.dialogOpen.bind(this),\n      cssClass: this.parent.cssClass ? this.parent.cssClass : ''\n    });\n    var isStringTemplate = 'isStringTemplate';\n    this.dialogObj[isStringTemplate] = true;\n    this.renderResponsiveFilter(options);\n    this.dlg.setAttribute('aria-label', this.getLocalizedLabel('ExcelFilterDialogARIA'));\n\n    if (options.isResponsiveFilter) {\n      var responsiveCnt = document.querySelector('.e-responsive-dialog > .e-dlg-content > .e-mainfilterdiv');\n      responsiveCnt.appendChild(this.dlg);\n    } else {\n      this.parent.element.appendChild(this.dlg);\n    }\n\n    this.dialogObj.appendTo(this.dlg);\n    this.dialogObj.element.style.maxHeight = options.isResponsiveFilter ? 'none' : this.options.height + 'px';\n    this.dialogObj.show();\n    var content = this.dialogObj.element.querySelector('.e-dlg-content');\n    content.appendChild(this.sBox);\n    this.wireEvents();\n    createSpinner({\n      target: this.spinner,\n      cssClass: this.parent.cssClass ? this.parent.cssClass : null\n    }, this.parent.createElement);\n    showSpinner(this.spinner);\n    this.getAllData();\n  };\n\n  CheckBoxFilterBase.prototype.renderResponsiveFilter = function (options) {\n    if (options.isResponsiveFilter) {\n      this.dialogObj.buttons = [{}];\n      this.dialogObj.position = {\n        X: '',\n        Y: ''\n      };\n      this.dialogObj.target = document.querySelector('.e-resfilter > .e-dlg-content > .e-mainfilterdiv');\n      this.dialogObj.width = '100%';\n    }\n  };\n\n  CheckBoxFilterBase.prototype.dialogCreated = function (e) {\n    if (this.options.isResponsiveFilter) {\n      this.dialogObj.element.style.left = '0px';\n    } else {\n      if (!Browser.isDevice) {\n        getFilterMenuPostion(this.options.target, this.dialogObj);\n      } else {\n        this.dialogObj.position = {\n          X: 'center',\n          Y: 'center'\n        };\n      }\n    }\n\n    if (this.options.column.showColumnMenu) {\n      this.parent.notify(events.filterDialogCreated, e);\n    }\n  };\n\n  CheckBoxFilterBase.prototype.openDialog = function (options) {\n    this.updateModel(options);\n    this.getAndSetChkElem(options);\n    this.showDialog(options);\n  };\n\n  CheckBoxFilterBase.prototype.closeDialog = function () {\n    if (this.dialogObj && !this.dialogObj.isDestroyed) {\n      this.isBlanks = false;\n      var filterTemplateCol = this.options.columns.filter(function (col) {\n        return col.getFilterItemTemplate();\n      }); // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n      var registeredTemplate = this.parent.registeredTemplate;\n\n      if (filterTemplateCol.length && !isNullOrUndefined(registeredTemplate) && registeredTemplate.filterItemTemplate) {\n        this.parent.destroyTemplate(['filterItemTemplate']);\n      }\n\n      if ((this.parent.isReact || this.parent.isVue) && this.parent.destroyTemplate !== undefined) {\n        clearReactVueTemplates(this.parent, ['filterItemTemplate']);\n      }\n\n      this.parent.notify(events.filterMenuClose, {\n        field: this.options.field\n      });\n      this.dialogObj.destroy();\n      this.unWireEvents();\n      remove(this.dlg);\n      this.dlg = null;\n      this.parent.notify(events.filterDialogClose, {});\n    }\n  };\n  /**\n   * @param {Column} col - Defines column details\n   * @returns {void}\n   * @hidden\n   */\n\n\n  CheckBoxFilterBase.prototype.clearFilter = function (col) {\n    // eslint-disable-next-line max-len\n    var args = {\n      instance: this,\n      handler: this.clearFilter,\n      cancel: false\n    };\n    this.parent.notify(events.fltrPrevent, args);\n\n    if (args.cancel) {\n      return;\n    }\n\n    this.options.handler({\n      action: 'clear-filter',\n      field: col ? col.field : this.options.field\n    });\n  };\n\n  CheckBoxFilterBase.prototype.btnClick = function (e) {\n    if (this.filterState) {\n      if (e.target.tagName.toLowerCase() === 'input' && e.target.classList.contains('e-searchinput') || e.keyCode === 13) {\n        if (!this.isCheckboxFilterTemplate) {\n          this.fltrBtnHandler();\n        }\n      } else {\n        var text = e.target.firstChild.textContent.toLowerCase();\n\n        if (this.getLocalizedLabel(this.isExcel ? 'OKButton' : 'FilterButton').toLowerCase() === text) {\n          if (!this.isCheckboxFilterTemplate) {\n            this.fltrBtnHandler();\n          }\n        } else if (this.getLocalizedLabel('ClearButton').toLowerCase() === text) {\n          this.clearFilter();\n        }\n      }\n\n      this.closeDialog();\n    } else if (!(e.target.tagName.toLowerCase() === 'input')) {\n      this.clearFilter();\n      this.closeDialog();\n    }\n\n    if (this.options.column.showColumnMenu) {\n      this.parent.notify(events.afterFilterColumnMenuClose, {});\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n\n\n  CheckBoxFilterBase.prototype.fltrBtnHandler = function () {\n    var _this = this;\n\n    var checked = [].slice.call(this.cBox.querySelectorAll('.e-check:not(.e-selectall)'));\n    var check = checked;\n    var optr = 'equal';\n    var ddlValue = this.dialogObj.element.querySelector('.e-dropdownlist');\n\n    if (ddlValue) {\n      this.options.operator = optr = ddlValue.ej2_instances[0].value;\n    }\n\n    this.isMenuNotEqual = this.options.operator === 'notequal';\n    var searchInput;\n\n    if (!this.options.hideSearchbox) {\n      searchInput = this.searchBox.querySelector('.e-searchinput');\n    }\n\n    var caseSen = this.options.allowCaseSensitive;\n    var defaults = {\n      field: this.options.field,\n      predicate: this.isMenuNotEqual ? 'and' : 'or',\n      uid: this.options.uid,\n      operator: optr,\n      type: this.options.type,\n      matchCase: caseSen,\n      ignoreAccent: this.options.ignoreAccent\n    };\n    var isNotEqual = this.itemsCnt !== checked.length && this.itemsCnt - checked.length < checked.length;\n\n    if (isNotEqual && searchInput && searchInput.value === '') {\n      optr = this.isMenuNotEqual ? 'equal' : 'notequal';\n      checked = [].slice.call(this.cBox.querySelectorAll('.e-uncheck:not(.e-selectall)'));\n      defaults.predicate = this.isMenuNotEqual ? 'or' : 'and';\n      defaults.operator = optr;\n    }\n\n    var value;\n    var val;\n    var length;\n    var fObj;\n    var coll = [];\n\n    if (checked.length !== this.itemsCnt || searchInput && searchInput.value && searchInput.value !== '') {\n      for (var i = 0; i < checked.length; i++) {\n        value = this.values[parentsUntil(checked[i], 'e-ftrchk').getAttribute('uid')];\n        fObj = extend({}, {\n          value: value\n        }, defaults);\n\n        if (value && !value.toString().length) {\n          fObj.operator = isNotEqual ? 'notequal' : 'equal';\n        }\n\n        if (value === '' || isNullOrUndefined(value)) {\n          coll = coll.concat(CheckBoxFilterBase.generateNullValuePredicates(defaults));\n        } else {\n          coll.push(fObj);\n        }\n\n        var args = {\n          instance: this,\n          handler: this.fltrBtnHandler,\n          arg1: fObj.field,\n          arg2: fObj.predicate,\n          arg3: fObj.operator,\n          arg4: fObj.matchCase,\n          arg5: fObj.ignoreAccent,\n          arg6: fObj.value,\n          cancel: false\n        };\n        this.parent.notify(events.fltrPrevent, args);\n\n        if (args.cancel) {\n          return;\n        }\n      }\n\n      if (this.options.type === 'date' || this.options.type === 'datetime') {\n        length = check.length - 1;\n        val = this.values[parentsUntil(check[length], 'e-ftrchk').getAttribute('uid')];\n\n        if (isNullOrUndefined(val) && isNotEqual) {\n          coll.push({\n            field: defaults.field,\n            matchCase: defaults.matchCase,\n            operator: 'equal',\n            predicate: 'and',\n            value: null\n          });\n        }\n      }\n\n      this.initiateFilter(coll);\n    } else {\n      var isClearFilter = this.options.filteredColumns.some(function (value) {\n        return _this.options.field === value.field;\n      });\n\n      if (isClearFilter) {\n        this.clearFilter();\n      }\n    }\n  }; // eslint-disable-next-line\n\n  /** @hidden */\n\n\n  CheckBoxFilterBase.generateNullValuePredicates = function (defaults) {\n    var coll = [];\n\n    if (defaults.type === 'string') {\n      coll.push({\n        field: defaults.field,\n        ignoreAccent: defaults.ignoreAccent,\n        matchCase: defaults.matchCase,\n        operator: defaults.operator,\n        predicate: defaults.predicate,\n        value: ''\n      });\n    }\n\n    coll.push({\n      field: defaults.field,\n      matchCase: defaults.matchCase,\n      operator: defaults.operator,\n      predicate: defaults.predicate,\n      value: null\n    });\n    coll.push({\n      field: defaults.field,\n      matchCase: defaults.matchCase,\n      operator: defaults.operator,\n      predicate: defaults.predicate,\n      value: undefined\n    });\n    return coll;\n  }; // eslint-disable-next-line\n\n  /** @hidden */\n\n\n  CheckBoxFilterBase.prototype.initiateFilter = function (fColl) {\n    var firstVal = fColl[0];\n    var predicate;\n\n    if (!isNullOrUndefined(firstVal)) {\n      predicate = firstVal.ejpredicate ? firstVal.ejpredicate : new Predicate(firstVal.field, firstVal.operator, firstVal.value, !firstVal.matchCase, firstVal.ignoreAccent);\n\n      for (var j = 1; j < fColl.length; j++) {\n        predicate = fColl[j].ejpredicate !== undefined ? predicate[fColl[j].predicate](fColl[j].ejpredicate) : predicate[fColl[j].predicate](fColl[j].field, fColl[j].operator, fColl[j].value, !fColl[j].matchCase, fColl[j].ignoreAccent);\n      }\n\n      var args = {\n        action: 'filtering',\n        filterCollection: fColl,\n        field: this.options.field,\n        ejpredicate: Predicate.or(predicate)\n      };\n      this.options.handler(args);\n    }\n  };\n\n  CheckBoxFilterBase.prototype.isForeignColumn = function (col) {\n    return col.isForeignColumn ? col.isForeignColumn() : false;\n  };\n\n  CheckBoxFilterBase.prototype.refreshCheckboxes = function () {\n    var _this = this;\n\n    var val = this.sInput.value;\n    var column = this.options.column;\n    var query = this.isForeignColumn(column) ? this.foreignKeyQuery.clone() : this.options.query.clone();\n    var foreignQuery = this.options.query.clone();\n    var pred = query.queries.filter(function (e) {\n      return e && e.fn === 'onWhere';\n    })[0];\n    query.queries = [];\n    foreignQuery.queries = [];\n    var parsed = this.options.type !== 'string' && parseFloat(val) ? parseFloat(val) : val;\n    var operator = this.options.isRemote ? this.options.type === 'string' ? 'contains' : 'equal' : this.options.type ? 'contains' : 'equal';\n    var matchCase = true;\n    var ignoreAccent = this.options.ignoreAccent;\n    var field = this.isForeignColumn(column) ? column.foreignKeyValue : column.field;\n    parsed = parsed === '' || parsed === undefined ? undefined : parsed;\n    var coll = [];\n    var defaults = {\n      field: field,\n      predicate: 'or',\n      uid: this.options.uid,\n      operator: 'equal',\n      type: this.options.type,\n      matchCase: matchCase,\n      ignoreAccent: ignoreAccent\n    };\n    var predicte;\n    var moduleName = this.options.dataManager.adaptor.getModuleName;\n\n    if (this.options.type === 'boolean') {\n      if (parsed !== undefined && this.getLocalizedLabel('FilterTrue').toLowerCase().indexOf(parsed.toLowerCase()) !== -1) {\n        parsed = 'true';\n      } else if (parsed !== undefined && this.getLocalizedLabel('FilterFalse').toLowerCase().indexOf(parsed.toLowerCase()) !== -1) {\n        parsed = 'false';\n      }\n\n      if (parsed !== undefined && this.getLocalizedLabel('FilterTrue').toLowerCase().indexOf(parsed.toLowerCase()) !== -1 && moduleName) {\n        // eslint-disable-next-line no-constant-condition\n        parsed = moduleName() === 'ODataAdaptor' || 'ODataV4Adaptor' ? true : 'true';\n      } else if (parsed !== undefined && this.getLocalizedLabel('FilterFalse').toLowerCase().indexOf(parsed.toLowerCase()) !== -1 && moduleName) {\n        // eslint-disable-next-line no-constant-condition\n        parsed = moduleName() === 'ODataAdaptor' || 'ODataV4Adaptor' ? false : 'false';\n      }\n\n      operator = 'equal';\n    }\n\n    if ((this.options.type === 'date' || this.options.type === 'datetime') && this.options.format) {\n      var intl = new Internationalization();\n      var format = typeof this.options.format === 'string' ? this.options.format : this.options.format.format;\n\n      if (format) {\n        parsed = intl.parseDate(val, {\n          format: format\n        }) || new Date(val);\n      } else {\n        parsed = new Date(val);\n      }\n    }\n\n    this.addDistinct(query);\n    var args = {\n      requestType: events.filterSearchBegin,\n      filterModel: this,\n      columnName: field,\n      column: column,\n      operator: operator,\n      matchCase: matchCase,\n      ignoreAccent: ignoreAccent,\n      filterChoiceCount: null,\n      query: query,\n      value: parsed\n    };\n    this.parent.trigger(events.actionBegin, args, function (filterargs) {\n      // eslint-disable-next-line no-self-assign\n      filterargs.operator = filterargs.operator;\n      predicte = new Predicate(field, filterargs.operator, parsed, filterargs.matchCase, filterargs.ignoreAccent);\n\n      if (_this.options.type === 'date' || _this.options.type === 'datetime') {\n        operator = 'equal';\n        var filterObj = {\n          field: field,\n          operator: operator,\n          value: parsed,\n          matchCase: matchCase,\n          ignoreAccent: ignoreAccent\n        };\n\n        if (!isNullOrUndefined(parsed)) {\n          predicte = getDatePredicate(filterObj, _this.options.type);\n        }\n      }\n\n      if (val && typeof val === 'string' && _this.isBlanks && _this.getLocalizedLabel('Blanks').toLowerCase().indexOf(val.toLowerCase()) >= 0) {\n        coll = coll.concat(CheckBoxFilterBase.generateNullValuePredicates(defaults));\n        var emptyValPredicte = CheckBoxFilterBase.generatePredicate(coll);\n        emptyValPredicte.predicates.push(predicte);\n        query.where(emptyValPredicte);\n      } else if (val.length) {\n        predicte = !isNullOrUndefined(pred) ? predicte.and(pred.e) : predicte;\n        query.where(predicte);\n      } else if (!isNullOrUndefined(pred)) {\n        query.where(pred.e);\n      }\n\n      filterargs.filterChoiceCount = !isNullOrUndefined(filterargs.filterChoiceCount) ? filterargs.filterChoiceCount : 1000;\n      var fPredicate = {};\n      showSpinner(_this.spinner);\n      _this.renderEmpty = false;\n\n      if (_this.isForeignColumn(column) && val.length) {\n        var colData = 'result' in column.dataSource ? new DataManager(column.dataSource.result) : column.dataSource; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n        colData.executeQuery(query).then(function (e) {\n          var columnData = _this.options.column.columnData;\n          _this.options.column.columnData = e.result;\n\n          _this.parent.notify(events.generateQuery, {\n            predicate: fPredicate,\n            column: column\n          });\n\n          if (fPredicate.predicate.predicates.length) {\n            foreignQuery.where(fPredicate.predicate);\n          } else {\n            _this.renderEmpty = true;\n          }\n\n          _this.options.column.columnData = columnData;\n          foreignQuery.take(filterargs.filterChoiceCount);\n\n          _this.search(filterargs, foreignQuery);\n        });\n      } else {\n        query.take(filterargs.filterChoiceCount);\n\n        _this.search(filterargs, query);\n      }\n    });\n  };\n\n  CheckBoxFilterBase.prototype.search = function (args, query) {\n    if (this.parent.dataSource && 'result' in this.parent.dataSource) {\n      this.filterEvent(args, query);\n    } else {\n      this.processSearch(query);\n    }\n  };\n\n  CheckBoxFilterBase.prototype.getPredicateFromCols = function (columns) {\n    var predicates = CheckBoxFilterBase.getPredicate(columns);\n    var predicateList = [];\n    var fPredicate = {};\n    var isGrid = this.parent.getForeignKeyColumns !== undefined;\n    var foreignColumn = isGrid ? this.parent.getForeignKeyColumns() : [];\n\n    for (var _i = 0, _a = Object.keys(predicates); _i < _a.length; _i++) {\n      var prop = _a[_i];\n      var col = void 0;\n\n      if (isGrid && !this.parent.getColumnByField(prop)) {\n        col = getColumnByForeignKeyValue(prop, foreignColumn);\n      }\n\n      if (col) {\n        this.parent.notify(events.generateQuery, {\n          predicate: fPredicate,\n          column: col\n        });\n\n        if (fPredicate.predicate.predicates.length) {\n          predicateList.push(Predicate.or(fPredicate.predicate.predicates));\n        }\n      } else {\n        predicateList.push(predicates[prop]);\n      }\n    }\n\n    return predicateList.length && Predicate.and(predicateList);\n  };\n\n  CheckBoxFilterBase.prototype.getQuery = function () {\n    return this.parent.getQuery ? this.parent.getQuery().clone() : new Query();\n  };\n\n  CheckBoxFilterBase.prototype.getAllData = function () {\n    var _this = this;\n\n    this.customQuery = false;\n    var query = this.getQuery();\n    query.requiresCount(); //consider take query\n\n    this.addDistinct(query);\n    var args = {\n      requestType: events.filterChoiceRequest,\n      query: query,\n      filterChoiceCount: null\n    };\n    var filterModel = 'filterModel';\n    args[filterModel] = this;\n    this.parent.trigger(events.actionBegin, args, function (args) {\n      args.filterChoiceCount = !isNullOrUndefined(args.filterChoiceCount) ? args.filterChoiceCount : 1000;\n      query.take(args.filterChoiceCount);\n\n      if (!args.query.distincts.length) {\n        _this.customQuery = true;\n\n        _this.queryGenerate(query);\n      }\n\n      if (_this.parent.dataSource && 'result' in _this.parent.dataSource) {\n        _this.filterEvent(args, query);\n      } else {\n        _this.processDataOperation(query, true);\n      }\n    });\n  };\n\n  CheckBoxFilterBase.prototype.addDistinct = function (query) {\n    var filteredColumn = DataUtil.distinct(this.options.filteredColumns, 'field');\n\n    if (filteredColumn.indexOf(this.options.column.field) <= -1) {\n      filteredColumn = filteredColumn.concat(this.options.column.field);\n    }\n\n    query.distinct(filteredColumn);\n    return query;\n  };\n\n  CheckBoxFilterBase.prototype.filterEvent = function (args, query) {\n    var _this = this;\n\n    var defObj = eventPromise(args, query);\n    this.parent.trigger(events.dataStateChange, defObj.state);\n    var def = defObj.deffered;\n    def.promise.then(function (e) {\n      _this.dataSuccess(e);\n    });\n  };\n\n  CheckBoxFilterBase.prototype.processDataOperation = function (query, isInitial) {\n    var _this = this;\n\n    this.options.dataSource = this.options.dataSource instanceof DataManager ? this.options.dataSource : new DataManager(this.options.dataSource);\n    var allPromise = [];\n    var runArray = [];\n\n    if (this.isForeignColumn(this.options.column) && isInitial) {\n      var colData = 'result' in this.options.column.dataSource ? new DataManager(this.options.column.dataSource.result) : this.options.column.dataSource;\n      this.foreignKeyQuery.params = query.params;\n      allPromise.push(colData.executeQuery(this.foreignKeyQuery));\n      runArray.push(function (data) {\n        return _this.foreignKeyData = data;\n      });\n    }\n\n    allPromise.push(this.options.dataSource.executeQuery(query));\n    runArray.push(this.dataSuccess.bind(this));\n    var i = 0;\n    Promise.all(allPromise).then(function (e) {\n      for (var j = 0; j < e.length; j++) {\n        runArray[i++](e[j].result);\n      }\n    });\n  };\n\n  CheckBoxFilterBase.prototype.dataSuccess = function (e) {\n    this.fullData = e;\n    var args1 = {\n      dataSource: this.fullData,\n      executeQuery: true,\n      field: this.options.field\n    };\n    this.parent.notify(events.beforeCheckboxRenderer, args1);\n\n    if (args1.executeQuery) {\n      var query = new Query();\n\n      if (!this.customQuery) {\n        this.queryGenerate(query);\n      } // query.select(this.options.field);\n\n\n      var result = new DataManager(args1.dataSource).executeLocal(query);\n      var col = this.options.column;\n      this.filteredData = CheckBoxFilterBase.getDistinct(result, this.options.field, col, this.foreignKeyData).records || [];\n    }\n\n    var data = args1.executeQuery ? this.filteredData : args1.dataSource;\n    this.processDataSource(null, true, data, args1);\n\n    if (this.sInput) {\n      this.sInput.focus();\n    }\n\n    var args = {\n      requestType: events.filterAfterOpen,\n      columnName: this.options.field,\n      columnType: this.options.type\n    };\n    var filterModel = 'filterModel';\n    args[filterModel] = this;\n    this.parent.notify(events.cBoxFltrComplete, args);\n\n    if (this.isCheckboxFilterTemplate) {\n      hideSpinner(this.spinner);\n    }\n  };\n\n  CheckBoxFilterBase.prototype.queryGenerate = function (query) {\n    if (this.parent.searchSettings && this.parent.searchSettings.key.length) {\n      var sSettings = this.parent.searchSettings;\n      var fields = sSettings.fields.length ? sSettings.fields : this.options.columns.map(function (f) {\n        return f.field;\n      });\n      query.search(sSettings.key, fields, sSettings.operator, sSettings.ignoreCase, sSettings.ignoreAccent);\n    }\n\n    if (this.options.filteredColumns.length) {\n      var cols = [];\n\n      for (var i = 0; i < this.options.filteredColumns.length; i++) {\n        var filterColumn = this.options.filteredColumns[i];\n\n        if (this.options.uid) {\n          filterColumn.uid = filterColumn.uid || this.parent.getColumnByField(filterColumn.field).uid;\n\n          if (filterColumn.uid !== this.options.uid) {\n            cols.push(this.options.filteredColumns[i]);\n          }\n        } else {\n          if (filterColumn.field !== this.options.field) {\n            cols.push(this.options.filteredColumns[i]);\n          }\n        }\n      }\n\n      var predicate = this.getPredicateFromCols(cols);\n\n      if (predicate) {\n        query.where(predicate);\n      }\n    }\n  };\n\n  CheckBoxFilterBase.prototype.processDataSource = function (query, isInitial, dataSource, args) {\n    showSpinner(this.spinner); // query = query ? query : this.options.query.clone();\n    // query.requiresCount();\n    // let result: Object = new DataManager(dataSource as JSON[]).executeLocal(query);\n    // let res: { result: Object[] } = result as { result: Object[] };\n\n    this.updateResult();\n    var args1 = {\n      dataSource: this.fullData,\n      isCheckboxFilterTemplate: false,\n      column: this.options.column,\n      element: this.cBox,\n      type: this.options.type,\n      format: this.options.type,\n      btnObj: this.options.isResponsiveFilter ? null : this.dialogObj.btnObj[0],\n      searchBox: this.searchBox\n    };\n    this.parent.notify(events.beforeCheckboxfilterRenderer, args1);\n    this.isCheckboxFilterTemplate = args1.isCheckboxFilterTemplate;\n\n    if (!this.isCheckboxFilterTemplate) {\n      this.createFilterItems(dataSource, isInitial, args);\n    }\n  };\n\n  CheckBoxFilterBase.prototype.processSearch = function (query) {\n    this.processDataOperation(query);\n  };\n\n  CheckBoxFilterBase.prototype.updateResult = function () {\n    this.result = {};\n    var predicate = this.getPredicateFromCols(this.options.filteredColumns);\n    var query = new Query();\n\n    if (predicate) {\n      query.where(predicate);\n    }\n\n    this.parent.notify(events.beforeCheckboxRendererQuery, {\n      query: query\n    });\n    var result = new DataManager(this.fullData).executeLocal(query);\n\n    for (var _i = 0, result_1 = result; _i < result_1.length; _i++) {\n      var res = result_1[_i];\n      this.result[getObject(this.options.field, res)] = true;\n    }\n  };\n\n  CheckBoxFilterBase.prototype.clickHandler = function (e) {\n    var target = e.target;\n    var elem = parentsUntil(target, 'e-checkbox-wrapper');\n\n    if (parentsUntil(target, 'e-searchbox')) {\n      this.searchBoxClick(e);\n    }\n\n    if (elem && !this.isCheckboxFilterTemplate) {\n      var selectAll = elem.querySelector('.e-selectall');\n\n      if (selectAll) {\n        this.updateAllCBoxes(!selectAll.classList.contains('e-check'));\n      } else {\n        toogleCheckbox(elem.parentElement);\n      }\n\n      this.updateIndeterminatenBtn();\n      elem.querySelector('.e-chk-hidden').focus();\n    }\n\n    this.setFocus(parentsUntil(elem, 'e-ftrchk'));\n  };\n\n  CheckBoxFilterBase.prototype.keyupHandler = function (e) {\n    this.setFocus(parentsUntil(e.target, 'e-ftrchk'));\n  };\n\n  CheckBoxFilterBase.prototype.setFocus = function (elem) {\n    var prevElem = this.dlg.querySelector('.e-chkfocus');\n\n    if (prevElem) {\n      prevElem.classList.remove('e-chkfocus');\n    }\n\n    if (elem) {\n      elem.classList.add('e-chkfocus');\n    }\n  };\n\n  CheckBoxFilterBase.prototype.updateAllCBoxes = function (checked) {\n    var cBoxes = [].slice.call(this.cBox.getElementsByClassName('e-frame'));\n\n    for (var _i = 0, cBoxes_1 = cBoxes; _i < cBoxes_1.length; _i++) {\n      var cBox = cBoxes_1[_i];\n      removeAddCboxClasses(cBox, checked);\n      setChecked(cBox.previousSibling, checked);\n    }\n  };\n\n  CheckBoxFilterBase.prototype.dialogOpen = function () {\n    if (this.parent.element.classList.contains('e-device')) {\n      this.dialogObj.element.querySelector('.e-input-group').classList.remove('e-input-focus');\n\n      if (!this.options.isResponsiveFilter) {\n        this.dialogObj.element.querySelector('.e-btn').focus();\n      }\n    }\n  };\n\n  CheckBoxFilterBase.prototype.createCheckbox = function (value, checked, data) {\n    var elem = checked ? this.cBoxTrue.cloneNode(true) : this.cBoxFalse.cloneNode(true);\n    setChecked(elem.querySelector('input'), checked);\n    var label = elem.querySelector('.e-label');\n    var dummyData = extendObjWithFn({}, data, {\n      column: this.options.column,\n      parent: this.parent\n    });\n    var innerText = this.options.disableHtmlEncode ? 'textContent' : 'innerHTML';\n    label[innerText] = !isNullOrUndefined(value) && value.toString().length ? value : this.getLocalizedLabel('Blanks');\n\n    if (label.innerHTML === this.getLocalizedLabel('Blanks')) {\n      this.isBlanks = true;\n    }\n\n    if (typeof value === 'boolean') {\n      label.innerHTML = value === true ? this.getLocalizedLabel('FilterTrue') : this.getLocalizedLabel('FilterFalse');\n    }\n\n    addClass([label], ['e-checkboxfiltertext']);\n\n    if (this.options.template && data[this.options.column.field] !== this.getLocalizedLabel('SelectAll')) {\n      label.innerHTML = '';\n      var isReactCompiler = this.parent.isReact && this.options.column.filter && typeof this.options.column.filter.itemTemplate !== 'string';\n\n      if (isReactCompiler) {\n        this.options.template(dummyData, this.parent, 'filterItemTemplate', null, null, null, label);\n        this.parent.renderTemplates();\n      } else {\n        appendChildren(label, this.options.template(dummyData, this.parent, 'filterItemTemplate'));\n      }\n    }\n\n    return elem;\n  };\n\n  CheckBoxFilterBase.prototype.updateIndeterminatenBtn = function () {\n    var cnt = this.cBox.children.length - 1;\n    var className = [];\n    var disabled = false;\n    var elem = this.cBox.querySelector('.e-selectall');\n    var selected = this.cBox.querySelectorAll('.e-check:not(.e-selectall)').length;\n    var btn;\n\n    if (!this.options.isResponsiveFilter) {\n      btn = this.dialogObj.btnObj[0];\n      btn.disabled = false;\n    }\n\n    var input = elem.previousSibling;\n    setChecked(input, false);\n    input.indeterminate = false;\n\n    if (cnt === selected) {\n      className = ['e-check'];\n      setChecked(input, true);\n    } else if (selected) {\n      className = ['e-stop'];\n      input.indeterminate = true;\n    } else {\n      className = ['e-uncheck'];\n      disabled = true;\n\n      if (btn) {\n        btn.disabled = true;\n      }\n    }\n\n    if (btn) {\n      this.filterState = !btn.disabled;\n      btn.dataBind();\n    }\n\n    removeClass([elem], ['e-check', 'e-stop', 'e-uncheck']);\n    addClass([elem], className);\n    this.parent.notify(events.refreshCustomFilterOkBtn, {\n      disabled: disabled\n    });\n  };\n\n  CheckBoxFilterBase.prototype.createFilterItems = function (data, isInitial, args1) {\n    var _a;\n\n    var cBoxes = this.parent.createElement('div');\n    var btn;\n    var disabled = false;\n\n    if (!this.options.isResponsiveFilter) {\n      btn = this.dialogObj.btnObj[0];\n    }\n\n    var nullCounter = -1;\n    var key = 'ejValue';\n\n    if (!args1.executeQuery) {\n      key = args1.field;\n    }\n\n    for (var i = 0; i < data.length; i++) {\n      var val = getValue(key, data[i]);\n\n      if (val === '' || isNullOrUndefined(val)) {\n        nullCounter = nullCounter + 1;\n      }\n    }\n\n    this.itemsCnt = nullCounter !== -1 ? data.length - nullCounter : data.length;\n\n    if (data.length && !this.renderEmpty) {\n      var selectAllValue = this.getLocalizedLabel('SelectAll');\n      var innerDiv = this.cBox.querySelector('.e-checkfltrnmdiv');\n\n      if (innerDiv) {\n        innerDiv.classList.remove('e-checkfltrnmdiv');\n      }\n\n      var checkBox = this.createCheckbox(selectAllValue, false, (_a = {}, _a[this.options.field] = selectAllValue, _a));\n\n      if (this.parent.cssClass) {\n        addClass([checkBox], [this.parent.cssClass]);\n      }\n\n      var selectAll = createCboxWithWrap(getUid('cbox'), checkBox, 'e-ftrchk');\n      selectAll.querySelector('.e-frame').classList.add('e-selectall');\n      cBoxes.appendChild(selectAll);\n      var predicate = new Predicate('field', 'equal', this.options.field);\n\n      if (this.options.foreignKeyValue) {\n        predicate = predicate.or('field', 'equal', this.options.foreignKeyValue);\n      }\n\n      var isColFiltered = new DataManager(this.options.filteredColumns).executeLocal(new Query().where(predicate)).length;\n      var isRndere = void 0;\n\n      for (var i = 0; i < data.length; i++) {\n        var uid = getUid('cbox');\n        this.values[uid] = getValue(key, data[i]);\n        var value = getValue(this.options.field, data[i]);\n\n        if (this.options.formatFn) {\n          value = this.valueFormatter.toView(value, this.options.formatFn);\n        }\n\n        var args_1 = {\n          value: value,\n          column: this.options.column,\n          data: data[i]\n        };\n        this.parent.notify(events.filterCboxValue, args_1);\n        value = args_1.value;\n\n        if (value === '' || isNullOrUndefined(value)) {\n          if (isRndere) {\n            continue;\n          }\n\n          isRndere = true;\n        }\n\n        var checkbox = this.createCheckbox(value, this.getCheckedState(isColFiltered, this.values[uid]), getValue('dataObj', data[i]));\n        cBoxes.appendChild(createCboxWithWrap(uid, checkbox, 'e-ftrchk'));\n      }\n\n      this.cBox.innerHTML = '';\n      appendChildren(this.cBox, [].slice.call(cBoxes.children));\n      this.updateIndeterminatenBtn();\n\n      if (btn) {\n        btn.disabled = false;\n      }\n\n      disabled = false;\n    } else {\n      cBoxes.appendChild(this.parent.createElement('span', {\n        innerHTML: this.getLocalizedLabel('NoResult')\n      }));\n      this.cBox.innerHTML = '';\n      this.cBox.appendChild(this.parent.createElement('div', {\n        className: 'e-checkfltrnmdiv'\n      }));\n      appendChildren(this.cBox.children[0], [].slice.call(cBoxes.children));\n\n      if (btn) {\n        btn.disabled = true;\n      }\n\n      disabled = true;\n    }\n\n    if (btn && data.length) {\n      this.filterState = !btn.disabled;\n      btn.dataBind();\n    }\n\n    var args = {\n      requestType: events.filterChoiceRequest,\n      dataSource: this.renderEmpty ? [] : data\n    };\n    var filterModel = 'filterModel';\n    args[filterModel] = this;\n    this.parent.notify(events.cBoxFltrComplete, args);\n    this.parent.notify(events.refreshCustomFilterOkBtn, {\n      disabled: disabled\n    });\n    hideSpinner(this.spinner);\n  };\n\n  CheckBoxFilterBase.prototype.getCheckedState = function (isColFiltered, value) {\n    if (!this.isFiltered || !isColFiltered) {\n      return true;\n    } else {\n      var checkState = this.result[value];\n      return this.options.operator === 'notequal' ? !checkState : checkState;\n    }\n  };\n\n  CheckBoxFilterBase.getDistinct = function (json, field, column, foreignKeyData) {\n    var len = json.length;\n    var result = [];\n    var value;\n    var ejValue = 'ejValue';\n    var lookup = {};\n    var isForeignKey = column && column.isForeignColumn ? column.isForeignColumn() : false;\n\n    while (len--) {\n      value = json[len];\n      value = getObject(field, value); //local remote diff, check with mdu\n\n      if (!(value in lookup)) {\n        var obj = {};\n        obj[ejValue] = value;\n        lookup[value] = true;\n\n        if (isForeignKey) {\n          var foreignDataObj = getForeignData(column, {}, value, foreignKeyData)[0];\n          setValue(events.foreignKeyData, foreignDataObj, json[len]);\n          value = getValue(column.foreignKeyValue, foreignDataObj);\n        }\n\n        setValue(field, isNullOrUndefined(value) ? null : value, obj);\n        setValue('dataObj', json[len], obj);\n        result.push(obj);\n      }\n    }\n\n    return DataUtil.group(DataUtil.sort(result, field, DataUtil.fnAscending), 'ejValue');\n  };\n\n  CheckBoxFilterBase.getPredicate = function (columns) {\n    var cols = DataUtil.distinct(columns, 'field', true) || [];\n    var collection = [];\n    var pred = {};\n\n    for (var i = 0; i < cols.length; i++) {\n      collection = new DataManager(columns).executeLocal(new Query().where('field', 'equal', cols[i].field));\n\n      if (collection.length !== 0) {\n        pred[cols[i].field] = CheckBoxFilterBase.generatePredicate(collection);\n      }\n    }\n\n    return pred;\n  };\n\n  CheckBoxFilterBase.generatePredicate = function (cols) {\n    var len = cols ? cols.length : 0;\n    var predicate;\n    var operate = 'or';\n    var first = CheckBoxFilterBase.updateDateFilter(cols[0]);\n    first.ignoreAccent = !isNullOrUndefined(first.ignoreAccent) ? first.ignoreAccent : false;\n\n    if (first.type === 'date' || first.type === 'datetime') {\n      predicate = getDatePredicate(first, first.type);\n    } else {\n      predicate = first.ejpredicate ? first.ejpredicate : new Predicate(first.field, first.operator, first.value, !CheckBoxFilterBase.getCaseValue(first), first.ignoreAccent);\n    }\n\n    for (var p = 1; p < len; p++) {\n      cols[p] = CheckBoxFilterBase.updateDateFilter(cols[p]);\n\n      if (len > 2 && p > 1 && cols[p].predicate === 'or') {\n        if (cols[p].type === 'date' || cols[p].type === 'datetime') {\n          predicate.predicates.push(getDatePredicate(cols[p], cols[p].type));\n        } else {\n          predicate.predicates.push(new Predicate(cols[p].field, cols[p].operator, cols[p].value, !CheckBoxFilterBase.getCaseValue(cols[p]), cols[p].ignoreAccent));\n        }\n      } else {\n        if (cols[p].type === 'date' || cols[p].type === 'datetime') {\n          if (cols[p].predicate === 'and' && cols[p].operator === 'equal') {\n            predicate = predicate[operate](getDatePredicate(cols[p], cols[p].type), cols[p].type, cols[p].ignoreAccent);\n          } else {\n            predicate = predicate[cols[p].predicate](getDatePredicate(cols[p], cols[p].type), cols[p].type, cols[p].ignoreAccent);\n          }\n        } else {\n          predicate = cols[p].ejpredicate ? predicate[cols[p].predicate](cols[p].ejpredicate) : predicate[cols[p].predicate](cols[p].field, cols[p].operator, cols[p].value, !CheckBoxFilterBase.getCaseValue(cols[p]), cols[p].ignoreAccent);\n        }\n      }\n    }\n\n    return predicate || null;\n  };\n\n  CheckBoxFilterBase.getCaseValue = function (filter) {\n    if (isNullOrUndefined(filter.matchCase)) {\n      if (filter.type === 'string' || isNullOrUndefined(filter.type) && typeof filter.value === 'string') {\n        return false;\n      } else {\n        return true;\n      }\n    } else {\n      return filter.matchCase;\n    }\n  };\n\n  CheckBoxFilterBase.updateDateFilter = function (filter) {\n    if (filter.type === 'date' || filter.type === 'datetime' || filter.value instanceof Date) {\n      filter.type = filter.type || 'date';\n    }\n\n    return filter;\n  };\n\n  return CheckBoxFilterBase;\n}();\n\nexport { CheckBoxFilterBase };","map":{"version":3,"names":["EventHandler","isNullOrUndefined","extend","classList","addClass","removeClass","Browser","getValue","setValue","parentsUntil","getUid","appendChildren","getDatePredicate","getObject","extendObjWithFn","eventPromise","setChecked","clearReactVueTemplates","remove","debounce","Internationalization","DataUtil","Query","DataManager","Predicate","createCheckBox","events","ValueFormatter","getForeignData","Dialog","Input","createSpinner","hideSpinner","showSpinner","getFilterMenuPostion","toogleCheckbox","createCboxWithWrap","removeAddCboxClasses","getColumnByForeignKeyValue","CheckBoxFilterBase","parent","existingPredicate","foreignKeyQuery","filterState","values","renderEmpty","isCheckboxFilterTemplate","id","element","valueFormatter","locale","cBoxTrue","createElement","checked","label","cBoxFalse","insertBefore","className","attrs","type","firstChild","querySelector","add","enableRtl","cssClass","prototype","destroy","closeDialog","wireEvents","dlg","clickHandler","keyupHandler","searchHandler","searchBoxKeyUp","elem","dialogObj","unWireEvents","foreignKeyFilter","args","fColl","mPredicate","_this","fPredicate","filterCollection","query","clone","options","column","dataSource","executeQuery","where","then","e","columnData","result","notify","generateQuery","predicate","ejpredicate","predicates","fpred","i","length","push","field","matchCase","ignoreCase","ignoreAccent","operator","value","filter","col","handler","foreignFilter","isRemote","initalPredicate","foreignKeyValue","searchBoxClick","target","contains","sInput","event","refreshCheckboxes","updateSearchIcon","focus","sIcon","getLocalizedLabel","key","localeObj","getConstant","updateDataSource","str","obj","updateModel","actualPredicate","dataManager","format","filteredColumns","filterSettings","columns","allowCaseSensitive","uid","disableHtmlEncode","isFiltered","getAndSetChkElem","sBox","hideSearchbox","title","searchBox","appendChild","inputargs","floatLabelType","properties","placeholder","createInput","spinner","cBox","showDialog","requestType","filterBeforeOpen","columnName","columnType","cancel","filterModel","cBoxFltrBegin","visible","content","close","bind","width","animationSettings","effect","buttons","click","btnClick","buttonModel","isExcel","isPrimary","created","dialogCreated","open","dialogOpen","isStringTemplate","renderResponsiveFilter","setAttribute","isResponsiveFilter","responsiveCnt","document","appendTo","style","maxHeight","height","show","getAllData","position","X","Y","left","isDevice","showColumnMenu","filterDialogCreated","openDialog","isDestroyed","isBlanks","filterTemplateCol","getFilterItemTemplate","registeredTemplate","filterItemTemplate","destroyTemplate","isReact","isVue","undefined","filterMenuClose","filterDialogClose","clearFilter","instance","fltrPrevent","action","tagName","toLowerCase","keyCode","fltrBtnHandler","text","textContent","afterFilterColumnMenuClose","slice","call","querySelectorAll","check","optr","ddlValue","ej2_instances","isMenuNotEqual","searchInput","caseSen","defaults","isNotEqual","itemsCnt","val","fObj","coll","getAttribute","toString","concat","generateNullValuePredicates","arg1","arg2","arg3","arg4","arg5","arg6","initiateFilter","isClearFilter","some","firstVal","j","or","isForeignColumn","foreignQuery","pred","queries","fn","parsed","parseFloat","predicte","moduleName","adaptor","getModuleName","indexOf","intl","parseDate","Date","addDistinct","filterSearchBegin","filterChoiceCount","trigger","actionBegin","filterargs","filterObj","emptyValPredicte","generatePredicate","and","colData","take","search","filterEvent","processSearch","getPredicateFromCols","getPredicate","predicateList","isGrid","getForeignKeyColumns","foreignColumn","_i","_a","Object","keys","prop","getColumnByField","getQuery","customQuery","requiresCount","filterChoiceRequest","distincts","queryGenerate","processDataOperation","filteredColumn","distinct","defObj","dataStateChange","state","def","deffered","promise","dataSuccess","isInitial","allPromise","runArray","params","data","foreignKeyData","Promise","all","fullData","args1","beforeCheckboxRenderer","executeLocal","filteredData","getDistinct","records","processDataSource","filterAfterOpen","cBoxFltrComplete","searchSettings","sSettings","fields","map","f","cols","filterColumn","updateResult","btnObj","beforeCheckboxfilterRenderer","createFilterItems","beforeCheckboxRendererQuery","result_1","res","selectAll","updateAllCBoxes","parentElement","updateIndeterminatenBtn","setFocus","prevElem","cBoxes","getElementsByClassName","cBoxes_1","previousSibling","createCheckbox","cloneNode","dummyData","innerText","innerHTML","template","isReactCompiler","itemTemplate","renderTemplates","cnt","children","disabled","selected","btn","input","indeterminate","dataBind","refreshCustomFilterOkBtn","nullCounter","selectAllValue","innerDiv","checkBox","isColFiltered","isRndere","formatFn","toView","args_1","filterCboxValue","checkbox","getCheckedState","checkState","json","len","ejValue","lookup","isForeignKey","foreignDataObj","group","sort","fnAscending","collection","operate","first","updateDateFilter","getCaseValue","p"],"sources":["/home/morgan/Desktop/Projets/ENT4/Jwt-Auth-pdf/react-jwt-auth/react-jwt-auth/node_modules/@syncfusion/ej2-grids/src/grid/common/checkbox-filter-base.js"],"sourcesContent":["/* tslint:disable-next-line:max-line-length */\nimport { EventHandler, isNullOrUndefined, extend, classList, addClass, removeClass, Browser, getValue, setValue } from '@syncfusion/ej2-base';\nimport { parentsUntil, getUid, appendChildren, getDatePredicate, getObject, extendObjWithFn, eventPromise, setChecked, clearReactVueTemplates } from '../base/util';\nimport { remove, debounce, Internationalization } from '@syncfusion/ej2-base';\nimport { DataUtil, Query, DataManager, Predicate } from '@syncfusion/ej2-data';\nimport { createCheckBox } from '@syncfusion/ej2-buttons';\nimport * as events from '../base/constant';\nimport { ValueFormatter } from '../services/value-formatter';\nimport { getForeignData } from '../base/util';\nimport { Dialog } from '@syncfusion/ej2-popups';\nimport { Input } from '@syncfusion/ej2-inputs';\nimport { createSpinner, hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nimport { getFilterMenuPostion, toogleCheckbox, createCboxWithWrap, removeAddCboxClasses, getColumnByForeignKeyValue } from '../base/util';\n/**\n * @hidden\n * `CheckBoxFilterBase` module is used to handle filtering action.\n */\nvar CheckBoxFilterBase = /** @class */ (function () {\n    /**\n     * Constructor for checkbox filtering module\n     *\n     * @param {IXLFilter} parent - specifies the IXLFilter\n     * @hidden\n     */\n    function CheckBoxFilterBase(parent) {\n        this.existingPredicate = {};\n        this.foreignKeyQuery = new Query();\n        /** @hidden */\n        this.filterState = true;\n        this.values = {};\n        this.renderEmpty = false;\n        this.isCheckboxFilterTemplate = false;\n        this.parent = parent;\n        this.id = this.parent.element.id;\n        this.valueFormatter = new ValueFormatter(this.parent.locale);\n        this.cBoxTrue = createCheckBox(this.parent.createElement, false, { checked: true, label: ' ' });\n        this.cBoxFalse = createCheckBox(this.parent.createElement, false, { checked: false, label: ' ' });\n        this.cBoxTrue.insertBefore(this.parent.createElement('input', {\n            className: 'e-chk-hidden', attrs: { type: 'checkbox' }\n        }), this.cBoxTrue.firstChild);\n        this.cBoxFalse.insertBefore(this.parent.createElement('input', {\n            className: 'e-chk-hidden', attrs: { 'type': 'checkbox' }\n        }), this.cBoxFalse.firstChild);\n        this.cBoxFalse.querySelector('.e-frame').classList.add('e-uncheck');\n        if (this.parent.enableRtl) {\n            addClass([this.cBoxTrue, this.cBoxFalse], ['e-rtl']);\n        }\n        if (this.parent.cssClass) {\n            addClass([this.cBoxTrue, this.cBoxFalse], [this.parent.cssClass]);\n        }\n    }\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    CheckBoxFilterBase.prototype.destroy = function () {\n        this.closeDialog();\n    };\n    CheckBoxFilterBase.prototype.wireEvents = function () {\n        EventHandler.add(this.dlg, 'click', this.clickHandler, this);\n        EventHandler.add(this.dlg, 'keyup', this.keyupHandler, this);\n        this.searchHandler = debounce(this.searchBoxKeyUp, 200);\n        var elem = this.dialogObj.element.querySelector('.e-searchinput');\n        if (elem) {\n            EventHandler.add(elem, 'keyup', this.searchHandler, this);\n        }\n    };\n    CheckBoxFilterBase.prototype.unWireEvents = function () {\n        EventHandler.remove(this.dlg, 'click', this.clickHandler);\n        EventHandler.remove(this.dlg, 'keyup', this.keyupHandler);\n        var elem = this.dialogObj.element.querySelector('.e-searchinput');\n        if (elem) {\n            EventHandler.remove(elem, 'keyup', this.searchHandler);\n        }\n    };\n    CheckBoxFilterBase.prototype.foreignKeyFilter = function (args, fColl, mPredicate) {\n        var _this = this;\n        var fPredicate = {};\n        var filterCollection = [];\n        var query = this.foreignKeyQuery.clone();\n        this.options.column.dataSource.\n            executeQuery(query.where(mPredicate)).then(function (e) {\n            _this.options.column.columnData = e.result;\n            _this.parent.notify(events.generateQuery, { predicate: fPredicate, column: _this.options.column });\n            args.ejpredicate = fPredicate.predicate.predicates;\n            var fpred = fPredicate.predicate.predicates;\n            for (var i = 0; i < fpred.length; i++) {\n                filterCollection.push({\n                    field: fpred[i].field,\n                    predicate: 'or',\n                    matchCase: fpred[i].ignoreCase,\n                    ignoreAccent: fpred[i].ignoreAccent,\n                    operator: fpred[i].operator,\n                    value: fpred[i].value,\n                    type: _this.options.type\n                });\n            }\n            args.filterCollection = filterCollection.length ? filterCollection :\n                fColl.filter(function (col) { return col.field = _this.options.field; });\n            _this.options.handler(args);\n        });\n    };\n    CheckBoxFilterBase.prototype.foreignFilter = function (args, value) {\n        var operator = this.options.isRemote ?\n            (this.options.column.type === 'string' ? 'contains' : 'equal') : (this.options.column.type ? 'contains' : 'equal');\n        var initalPredicate = new Predicate(this.options.column.foreignKeyValue, operator, value, true, this.options.ignoreAccent);\n        this.foreignKeyFilter(args, [args.filterCollection], initalPredicate);\n    };\n    CheckBoxFilterBase.prototype.searchBoxClick = function (e) {\n        var target = e.target;\n        if (target.classList.contains('e-searchclear')) {\n            this.sInput.value = '';\n            if (this.isCheckboxFilterTemplate) {\n                this.parent.notify('refreshCheckbox', { event: e });\n            }\n            else {\n                this.refreshCheckboxes();\n            }\n            this.updateSearchIcon();\n            this.sInput.focus();\n        }\n    };\n    CheckBoxFilterBase.prototype.searchBoxKeyUp = function (e) {\n        if (this.isCheckboxFilterTemplate) {\n            this.parent.notify('refreshCheckbox', { event: e });\n        }\n        else {\n            this.refreshCheckboxes();\n        }\n        this.updateSearchIcon();\n    };\n    CheckBoxFilterBase.prototype.updateSearchIcon = function () {\n        if (this.sInput.value.length) {\n            classList(this.sIcon, ['e-chkcancel-icon'], ['e-search-icon']);\n        }\n        else {\n            classList(this.sIcon, ['e-search-icon'], ['e-chkcancel-icon']);\n        }\n    };\n    /**\n     * Gets the localized label by locale keyword.\n     *\n     * @param {string} key - Defines localization key\n     * @returns {string} - returns localization label\n     */\n    CheckBoxFilterBase.prototype.getLocalizedLabel = function (key) {\n        return this.localeObj.getConstant(key);\n    };\n    CheckBoxFilterBase.prototype.updateDataSource = function () {\n        var dataSource = this.options.dataSource;\n        var str = 'object';\n        if (!(dataSource instanceof DataManager)) {\n            for (var i = 0; i < dataSource.length; i++) {\n                // eslint-disable-next-line valid-typeof\n                if (typeof dataSource !== str) {\n                    var obj = {};\n                    obj[this.options.field] = dataSource[i];\n                    dataSource[i] = obj;\n                }\n            }\n        }\n    };\n    CheckBoxFilterBase.prototype.updateModel = function (options) {\n        this.options = options;\n        this.existingPredicate = options.actualPredicate || {};\n        this.options.dataSource = options.dataSource;\n        this.options.dataManager = options.dataManager ? options.dataManager : options.dataSource;\n        this.updateDataSource();\n        this.options.type = options.type;\n        this.options.format = options.format || '';\n        this.options.ignoreAccent = options.ignoreAccent || false;\n        this.options.filteredColumns = options.filteredColumns || this.parent.filterSettings.columns;\n        this.options.query = options.query || new Query();\n        this.options.allowCaseSensitive = options.allowCaseSensitive || false;\n        this.options.uid = options.column.uid;\n        this.options.disableHtmlEncode = options.column.disableHtmlEncode || false;\n        this.values = {};\n        this.localeObj = options.localeObj;\n        this.isFiltered = options.filteredColumns.length;\n    };\n    CheckBoxFilterBase.prototype.getAndSetChkElem = function (options) {\n        this.dlg = this.parent.createElement('div', {\n            id: this.id + this.options.type + '_excelDlg',\n            attrs: { uid: this.options.column.uid },\n            className: 'e-checkboxfilter e-filter-popup'\n        });\n        this.sBox = this.parent.createElement('div', { className: 'e-searchcontainer' });\n        if (!options.hideSearchbox) {\n            this.sInput = this.parent.createElement('input', {\n                id: this.id + '_SearchBox',\n                className: 'e-searchinput'\n            });\n            this.sIcon = this.parent.createElement('span', {\n                className: 'e-searchclear e-search-icon e-icons e-input-group-icon', attrs: {\n                    type: 'text', title: this.getLocalizedLabel('Search')\n                }\n            });\n            this.searchBox = this.parent.createElement('span', { className: 'e-searchbox e-fields' });\n            this.searchBox.appendChild(this.sInput);\n            this.sBox.appendChild(this.searchBox);\n            var inputargs = {\n                element: this.sInput, floatLabelType: 'Never', properties: {\n                    placeholder: this.getLocalizedLabel('Search'),\n                    cssClass: this.parent.cssClass\n                }\n            };\n            Input.createInput(inputargs, this.parent.createElement);\n            this.searchBox.querySelector('.e-input-group').appendChild(this.sIcon);\n        }\n        this.spinner = this.parent.createElement('div', { className: 'e-spinner' }); //for spinner\n        this.cBox = this.parent.createElement('div', {\n            id: this.id + this.options.type + '_CheckBoxList',\n            className: 'e-checkboxlist e-fields'\n        });\n        this.spinner.appendChild(this.cBox);\n        this.sBox.appendChild(this.spinner);\n        return this.sBox;\n    };\n    CheckBoxFilterBase.prototype.showDialog = function (options) {\n        var args = {\n            requestType: events.filterBeforeOpen,\n            columnName: this.options.field, columnType: this.options.type, cancel: false\n        };\n        var filterModel = 'filterModel';\n        args[filterModel] = this;\n        this.parent.notify(events.cBoxFltrBegin, args);\n        if (args.cancel) {\n            options.cancel = args.cancel;\n            return;\n        }\n        this.dialogObj = new Dialog({\n            visible: false, content: this.sBox,\n            close: this.closeDialog.bind(this),\n            enableRtl: this.parent.enableRtl,\n            width: (!isNullOrUndefined(parentsUntil(options.target, 'e-bigger')))\n                || this.parent.element.classList.contains('e-device') ? 260 : 255,\n            target: this.parent.element, animationSettings: { effect: 'None' },\n            buttons: [{\n                    click: this.btnClick.bind(this),\n                    buttonModel: {\n                        content: this.getLocalizedLabel(this.isExcel ? 'OKButton' : 'FilterButton'),\n                        cssClass: this.parent.cssClass ? 'e-primary' + ' ' + this.parent.cssClass : 'e-primary',\n                        isPrimary: true\n                    }\n                },\n                {\n                    click: this.btnClick.bind(this),\n                    buttonModel: { cssClass: this.parent.cssClass ? 'e-flat' + ' ' + this.parent.cssClass : 'e-flat',\n                        content: this.getLocalizedLabel(this.isExcel ? 'CancelButton' : 'ClearButton') }\n                }],\n            created: this.dialogCreated.bind(this),\n            open: this.dialogOpen.bind(this),\n            cssClass: this.parent.cssClass ? this.parent.cssClass : ''\n        });\n        var isStringTemplate = 'isStringTemplate';\n        this.dialogObj[isStringTemplate] = true;\n        this.renderResponsiveFilter(options);\n        this.dlg.setAttribute('aria-label', this.getLocalizedLabel('ExcelFilterDialogARIA'));\n        if (options.isResponsiveFilter) {\n            var responsiveCnt = document.querySelector('.e-responsive-dialog > .e-dlg-content > .e-mainfilterdiv');\n            responsiveCnt.appendChild(this.dlg);\n        }\n        else {\n            this.parent.element.appendChild(this.dlg);\n        }\n        this.dialogObj.appendTo(this.dlg);\n        this.dialogObj.element.style.maxHeight = options.isResponsiveFilter ? 'none' : this.options.height + 'px';\n        this.dialogObj.show();\n        var content = this.dialogObj.element.querySelector('.e-dlg-content');\n        content.appendChild(this.sBox);\n        this.wireEvents();\n        createSpinner({ target: this.spinner, cssClass: this.parent.cssClass ? this.parent.cssClass : null }, this.parent.createElement);\n        showSpinner(this.spinner);\n        this.getAllData();\n    };\n    CheckBoxFilterBase.prototype.renderResponsiveFilter = function (options) {\n        if (options.isResponsiveFilter) {\n            this.dialogObj.buttons = [{}];\n            this.dialogObj.position = { X: '', Y: '' };\n            this.dialogObj.target = document.querySelector('.e-resfilter > .e-dlg-content > .e-mainfilterdiv');\n            this.dialogObj.width = '100%';\n        }\n    };\n    CheckBoxFilterBase.prototype.dialogCreated = function (e) {\n        if (this.options.isResponsiveFilter) {\n            this.dialogObj.element.style.left = '0px';\n        }\n        else {\n            if (!Browser.isDevice) {\n                getFilterMenuPostion(this.options.target, this.dialogObj);\n            }\n            else {\n                this.dialogObj.position = { X: 'center', Y: 'center' };\n            }\n        }\n        if (this.options.column.showColumnMenu) {\n            this.parent.notify(events.filterDialogCreated, e);\n        }\n    };\n    CheckBoxFilterBase.prototype.openDialog = function (options) {\n        this.updateModel(options);\n        this.getAndSetChkElem(options);\n        this.showDialog(options);\n    };\n    CheckBoxFilterBase.prototype.closeDialog = function () {\n        if (this.dialogObj && !this.dialogObj.isDestroyed) {\n            this.isBlanks = false;\n            var filterTemplateCol = this.options.columns.filter(function (col) { return col.getFilterItemTemplate(); });\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var registeredTemplate = this.parent.registeredTemplate;\n            if (filterTemplateCol.length && !isNullOrUndefined(registeredTemplate) && registeredTemplate.filterItemTemplate) {\n                this.parent.destroyTemplate(['filterItemTemplate']);\n            }\n            if ((this.parent.isReact || this.parent.isVue) && this.parent.destroyTemplate !== undefined) {\n                clearReactVueTemplates(this.parent, ['filterItemTemplate']);\n            }\n            this.parent.notify(events.filterMenuClose, { field: this.options.field });\n            this.dialogObj.destroy();\n            this.unWireEvents();\n            remove(this.dlg);\n            this.dlg = null;\n            this.parent.notify(events.filterDialogClose, {});\n        }\n    };\n    /**\n     * @param {Column} col - Defines column details\n     * @returns {void}\n     * @hidden\n     */\n    CheckBoxFilterBase.prototype.clearFilter = function (col) {\n        // eslint-disable-next-line max-len\n        var args = { instance: this, handler: this.clearFilter, cancel: false };\n        this.parent.notify(events.fltrPrevent, args);\n        if (args.cancel) {\n            return;\n        }\n        this.options.handler({ action: 'clear-filter', field: col ? col.field : this.options.field });\n    };\n    CheckBoxFilterBase.prototype.btnClick = function (e) {\n        if (this.filterState) {\n            if ((e.target.tagName.toLowerCase() === 'input' && e.target.classList.contains('e-searchinput')) ||\n                e.keyCode === 13) {\n                if (!this.isCheckboxFilterTemplate) {\n                    this.fltrBtnHandler();\n                }\n            }\n            else {\n                var text = e.target.firstChild.textContent.toLowerCase();\n                if (this.getLocalizedLabel(this.isExcel ? 'OKButton' : 'FilterButton').toLowerCase() === text) {\n                    if (!this.isCheckboxFilterTemplate) {\n                        this.fltrBtnHandler();\n                    }\n                }\n                else if (this.getLocalizedLabel('ClearButton').toLowerCase() === text) {\n                    this.clearFilter();\n                }\n            }\n            this.closeDialog();\n        }\n        else if (!(e.target.tagName.toLowerCase() === 'input')) {\n            this.clearFilter();\n            this.closeDialog();\n        }\n        if (this.options.column.showColumnMenu) {\n            this.parent.notify(events.afterFilterColumnMenuClose, {});\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    CheckBoxFilterBase.prototype.fltrBtnHandler = function () {\n        var _this = this;\n        var checked = [].slice.call(this.cBox.querySelectorAll('.e-check:not(.e-selectall)'));\n        var check = checked;\n        var optr = 'equal';\n        var ddlValue = this.dialogObj.element.querySelector('.e-dropdownlist');\n        if (ddlValue) {\n            this.options.operator = optr = ddlValue.ej2_instances[0].value;\n        }\n        this.isMenuNotEqual = this.options.operator === 'notequal';\n        var searchInput;\n        if (!this.options.hideSearchbox) {\n            searchInput = this.searchBox.querySelector('.e-searchinput');\n        }\n        var caseSen = this.options.allowCaseSensitive;\n        var defaults = {\n            field: this.options.field, predicate: this.isMenuNotEqual ? 'and' : 'or', uid: this.options.uid,\n            operator: optr, type: this.options.type, matchCase: caseSen, ignoreAccent: this.options.ignoreAccent\n        };\n        var isNotEqual = this.itemsCnt !== checked.length && this.itemsCnt - checked.length < checked.length;\n        if (isNotEqual && searchInput && searchInput.value === '') {\n            optr = this.isMenuNotEqual ? 'equal' : 'notequal';\n            checked = [].slice.call(this.cBox.querySelectorAll('.e-uncheck:not(.e-selectall)'));\n            defaults.predicate = this.isMenuNotEqual ? 'or' : 'and';\n            defaults.operator = optr;\n        }\n        var value;\n        var val;\n        var length;\n        var fObj;\n        var coll = [];\n        if (checked.length !== this.itemsCnt || (searchInput && searchInput.value && searchInput.value !== '')) {\n            for (var i = 0; i < checked.length; i++) {\n                value = this.values[parentsUntil(checked[i], 'e-ftrchk').getAttribute('uid')];\n                fObj = extend({}, { value: value }, defaults);\n                if (value && !value.toString().length) {\n                    fObj.operator = isNotEqual ? 'notequal' : 'equal';\n                }\n                if (value === '' || isNullOrUndefined(value)) {\n                    coll = coll.concat(CheckBoxFilterBase.generateNullValuePredicates(defaults));\n                }\n                else {\n                    coll.push(fObj);\n                }\n                var args = {\n                    instance: this, handler: this.fltrBtnHandler, arg1: fObj.field, arg2: fObj.predicate, arg3: fObj.operator,\n                    arg4: fObj.matchCase, arg5: fObj.ignoreAccent, arg6: fObj.value, cancel: false\n                };\n                this.parent.notify(events.fltrPrevent, args);\n                if (args.cancel) {\n                    return;\n                }\n            }\n            if (this.options.type === 'date' || this.options.type === 'datetime') {\n                length = check.length - 1;\n                val = this.values[parentsUntil(check[length], 'e-ftrchk').getAttribute('uid')];\n                if (isNullOrUndefined(val) && isNotEqual) {\n                    coll.push({\n                        field: defaults.field, matchCase: defaults.matchCase, operator: 'equal',\n                        predicate: 'and', value: null\n                    });\n                }\n            }\n            this.initiateFilter(coll);\n        }\n        else {\n            var isClearFilter = this.options.filteredColumns.some(function (value) {\n                return _this.options.field === value.field;\n            });\n            if (isClearFilter) {\n                this.clearFilter();\n            }\n        }\n    };\n    // eslint-disable-next-line\n    /** @hidden */\n    CheckBoxFilterBase.generateNullValuePredicates = function (defaults) {\n        var coll = [];\n        if (defaults.type === 'string') {\n            coll.push({\n                field: defaults.field, ignoreAccent: defaults.ignoreAccent, matchCase: defaults.matchCase,\n                operator: defaults.operator, predicate: defaults.predicate, value: ''\n            });\n        }\n        coll.push({\n            field: defaults.field,\n            matchCase: defaults.matchCase, operator: defaults.operator, predicate: defaults.predicate, value: null\n        });\n        coll.push({\n            field: defaults.field, matchCase: defaults.matchCase, operator: defaults.operator,\n            predicate: defaults.predicate, value: undefined\n        });\n        return coll;\n    };\n    // eslint-disable-next-line\n    /** @hidden */\n    CheckBoxFilterBase.prototype.initiateFilter = function (fColl) {\n        var firstVal = fColl[0];\n        var predicate;\n        if (!isNullOrUndefined(firstVal)) {\n            predicate = firstVal.ejpredicate ? firstVal.ejpredicate :\n                new Predicate(firstVal.field, firstVal.operator, firstVal.value, !firstVal.matchCase, firstVal.ignoreAccent);\n            for (var j = 1; j < fColl.length; j++) {\n                predicate = fColl[j].ejpredicate !== undefined ?\n                    predicate[fColl[j].predicate](fColl[j].ejpredicate) :\n                    predicate[fColl[j].predicate](fColl[j].field, fColl[j].operator, fColl[j].value, !fColl[j].matchCase, fColl[j].ignoreAccent);\n            }\n            var args = {\n                action: 'filtering', filterCollection: fColl, field: this.options.field,\n                ejpredicate: Predicate.or(predicate)\n            };\n            this.options.handler(args);\n        }\n    };\n    CheckBoxFilterBase.prototype.isForeignColumn = function (col) {\n        return col.isForeignColumn ? col.isForeignColumn() : false;\n    };\n    CheckBoxFilterBase.prototype.refreshCheckboxes = function () {\n        var _this = this;\n        var val = this.sInput.value;\n        var column = this.options.column;\n        var query = this.isForeignColumn(column) ? this.foreignKeyQuery.clone() : this.options.query.clone();\n        var foreignQuery = this.options.query.clone();\n        var pred = query.queries.filter(function (e) { return e && e.fn === 'onWhere'; })[0];\n        query.queries = [];\n        foreignQuery.queries = [];\n        var parsed = (this.options.type !== 'string' && parseFloat(val)) ? parseFloat(val) : val;\n        var operator = this.options.isRemote ?\n            (this.options.type === 'string' ? 'contains' : 'equal') : (this.options.type ? 'contains' : 'equal');\n        var matchCase = true;\n        var ignoreAccent = this.options.ignoreAccent;\n        var field = this.isForeignColumn(column) ? column.foreignKeyValue : column.field;\n        parsed = (parsed === '' || parsed === undefined) ? undefined : parsed;\n        var coll = [];\n        var defaults = {\n            field: field, predicate: 'or', uid: this.options.uid,\n            operator: 'equal', type: this.options.type, matchCase: matchCase, ignoreAccent: ignoreAccent\n        };\n        var predicte;\n        var moduleName = this.options.dataManager.adaptor.getModuleName;\n        if (this.options.type === 'boolean') {\n            if (parsed !== undefined &&\n                this.getLocalizedLabel('FilterTrue').toLowerCase().indexOf(parsed.toLowerCase()) !== -1) {\n                parsed = 'true';\n            }\n            else if (parsed !== undefined &&\n                this.getLocalizedLabel('FilterFalse').toLowerCase().indexOf(parsed.toLowerCase()) !== -1) {\n                parsed = 'false';\n            }\n            if (parsed !== undefined &&\n                this.getLocalizedLabel('FilterTrue').toLowerCase().indexOf(parsed.toLowerCase()) !== -1 && moduleName) {\n                // eslint-disable-next-line no-constant-condition\n                parsed = (moduleName() === 'ODataAdaptor' || 'ODataV4Adaptor') ? true : 'true';\n            }\n            else if (parsed !== undefined &&\n                this.getLocalizedLabel('FilterFalse').toLowerCase().indexOf(parsed.toLowerCase()) !== -1 && moduleName) {\n                // eslint-disable-next-line no-constant-condition\n                parsed = (moduleName() === 'ODataAdaptor' || 'ODataV4Adaptor') ? false : 'false';\n            }\n            operator = 'equal';\n        }\n        if ((this.options.type === 'date' || this.options.type === 'datetime') && this.options.format) {\n            var intl = new Internationalization();\n            var format = typeof (this.options.format) === 'string' ? this.options.format :\n                this.options.format.format;\n            if (format) {\n                parsed = intl.parseDate(val, { format: format }) || new Date(val);\n            }\n            else {\n                parsed = new Date(val);\n            }\n        }\n        this.addDistinct(query);\n        var args = {\n            requestType: events.filterSearchBegin,\n            filterModel: this, columnName: field, column: column,\n            operator: operator, matchCase: matchCase, ignoreAccent: ignoreAccent, filterChoiceCount: null,\n            query: query, value: parsed\n        };\n        this.parent.trigger(events.actionBegin, args, function (filterargs) {\n            // eslint-disable-next-line no-self-assign\n            filterargs.operator = filterargs.operator;\n            predicte = new Predicate(field, filterargs.operator, parsed, filterargs.matchCase, filterargs.ignoreAccent);\n            if (_this.options.type === 'date' || _this.options.type === 'datetime') {\n                operator = 'equal';\n                var filterObj = {\n                    field: field, operator: operator, value: parsed, matchCase: matchCase,\n                    ignoreAccent: ignoreAccent\n                };\n                if (!isNullOrUndefined(parsed)) {\n                    predicte = getDatePredicate(filterObj, _this.options.type);\n                }\n            }\n            if (val && typeof val === 'string' && _this.isBlanks &&\n                _this.getLocalizedLabel('Blanks').toLowerCase().indexOf(val.toLowerCase()) >= 0) {\n                coll = coll.concat(CheckBoxFilterBase.generateNullValuePredicates(defaults));\n                var emptyValPredicte = CheckBoxFilterBase.generatePredicate(coll);\n                emptyValPredicte.predicates.push(predicte);\n                query.where(emptyValPredicte);\n            }\n            else if (val.length) {\n                predicte = !isNullOrUndefined(pred) ? predicte.and(pred.e) : predicte;\n                query.where(predicte);\n            }\n            else if (!isNullOrUndefined(pred)) {\n                query.where(pred.e);\n            }\n            filterargs.filterChoiceCount = !isNullOrUndefined(filterargs.filterChoiceCount) ? filterargs.filterChoiceCount : 1000;\n            var fPredicate = {};\n            showSpinner(_this.spinner);\n            _this.renderEmpty = false;\n            if (_this.isForeignColumn(column) && val.length) {\n                var colData = ('result' in column.dataSource) ? new DataManager(column.dataSource.result) :\n                    column.dataSource;\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                colData.executeQuery(query).then(function (e) {\n                    var columnData = _this.options.column.columnData;\n                    _this.options.column.columnData = e.result;\n                    _this.parent.notify(events.generateQuery, { predicate: fPredicate, column: column });\n                    if (fPredicate.predicate.predicates.length) {\n                        foreignQuery.where(fPredicate.predicate);\n                    }\n                    else {\n                        _this.renderEmpty = true;\n                    }\n                    _this.options.column.columnData = columnData;\n                    foreignQuery.take(filterargs.filterChoiceCount);\n                    _this.search(filterargs, foreignQuery);\n                });\n            }\n            else {\n                query.take(filterargs.filterChoiceCount);\n                _this.search(filterargs, query);\n            }\n        });\n    };\n    CheckBoxFilterBase.prototype.search = function (args, query) {\n        if (this.parent.dataSource && 'result' in this.parent.dataSource) {\n            this.filterEvent(args, query);\n        }\n        else {\n            this.processSearch(query);\n        }\n    };\n    CheckBoxFilterBase.prototype.getPredicateFromCols = function (columns) {\n        var predicates = CheckBoxFilterBase.getPredicate(columns);\n        var predicateList = [];\n        var fPredicate = {};\n        var isGrid = this.parent.getForeignKeyColumns !== undefined;\n        var foreignColumn = isGrid ? this.parent.getForeignKeyColumns() : [];\n        for (var _i = 0, _a = Object.keys(predicates); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            var col = void 0;\n            if (isGrid && !this.parent.getColumnByField(prop)) {\n                col = getColumnByForeignKeyValue(prop, foreignColumn);\n            }\n            if (col) {\n                this.parent.notify(events.generateQuery, { predicate: fPredicate, column: col });\n                if (fPredicate.predicate.predicates.length) {\n                    predicateList.push(Predicate.or(fPredicate.predicate.predicates));\n                }\n            }\n            else {\n                predicateList.push(predicates[prop]);\n            }\n        }\n        return predicateList.length && Predicate.and(predicateList);\n    };\n    CheckBoxFilterBase.prototype.getQuery = function () {\n        return this.parent.getQuery ? this.parent.getQuery().clone() : new Query();\n    };\n    CheckBoxFilterBase.prototype.getAllData = function () {\n        var _this = this;\n        this.customQuery = false;\n        var query = this.getQuery();\n        query.requiresCount(); //consider take query\n        this.addDistinct(query);\n        var args = {\n            requestType: events.filterChoiceRequest, query: query, filterChoiceCount: null\n        };\n        var filterModel = 'filterModel';\n        args[filterModel] = this;\n        this.parent.trigger(events.actionBegin, args, function (args) {\n            args.filterChoiceCount = !isNullOrUndefined(args.filterChoiceCount) ? args.filterChoiceCount : 1000;\n            query.take(args.filterChoiceCount);\n            if (!args.query.distincts.length) {\n                _this.customQuery = true;\n                _this.queryGenerate(query);\n            }\n            if (_this.parent.dataSource && 'result' in _this.parent.dataSource) {\n                _this.filterEvent(args, query);\n            }\n            else {\n                _this.processDataOperation(query, true);\n            }\n        });\n    };\n    CheckBoxFilterBase.prototype.addDistinct = function (query) {\n        var filteredColumn = DataUtil.distinct(this.options.filteredColumns, 'field');\n        if (filteredColumn.indexOf(this.options.column.field) <= -1) {\n            filteredColumn = filteredColumn.concat(this.options.column.field);\n        }\n        query.distinct(filteredColumn);\n        return query;\n    };\n    CheckBoxFilterBase.prototype.filterEvent = function (args, query) {\n        var _this = this;\n        var defObj = eventPromise(args, query);\n        this.parent.trigger(events.dataStateChange, defObj.state);\n        var def = defObj.deffered;\n        def.promise.then(function (e) {\n            _this.dataSuccess(e);\n        });\n    };\n    CheckBoxFilterBase.prototype.processDataOperation = function (query, isInitial) {\n        var _this = this;\n        this.options.dataSource = this.options.dataSource instanceof DataManager ?\n            this.options.dataSource : new DataManager(this.options.dataSource);\n        var allPromise = [];\n        var runArray = [];\n        if (this.isForeignColumn(this.options.column) && isInitial) {\n            var colData = ('result' in this.options.column.dataSource) ?\n                new DataManager(this.options.column.dataSource.result) :\n                this.options.column.dataSource;\n            this.foreignKeyQuery.params = query.params;\n            allPromise.push(colData.executeQuery(this.foreignKeyQuery));\n            runArray.push(function (data) { return _this.foreignKeyData = data; });\n        }\n        allPromise.push(this.options.dataSource.executeQuery(query));\n        runArray.push(this.dataSuccess.bind(this));\n        var i = 0;\n        Promise.all(allPromise).then(function (e) {\n            for (var j = 0; j < e.length; j++) {\n                runArray[i++](e[j].result);\n            }\n        });\n    };\n    CheckBoxFilterBase.prototype.dataSuccess = function (e) {\n        this.fullData = e;\n        var args1 = { dataSource: this.fullData, executeQuery: true, field: this.options.field };\n        this.parent.notify(events.beforeCheckboxRenderer, args1);\n        if (args1.executeQuery) {\n            var query = new Query();\n            if (!this.customQuery) {\n                this.queryGenerate(query);\n            }\n            // query.select(this.options.field);\n            var result = new DataManager(args1.dataSource).executeLocal(query);\n            var col = this.options.column;\n            this.filteredData = CheckBoxFilterBase.getDistinct(result, this.options.field, col, this.foreignKeyData).records || [];\n        }\n        var data = args1.executeQuery ? this.filteredData : args1.dataSource;\n        this.processDataSource(null, true, data, args1);\n        if (this.sInput) {\n            this.sInput.focus();\n        }\n        var args = {\n            requestType: events.filterAfterOpen,\n            columnName: this.options.field, columnType: this.options.type\n        };\n        var filterModel = 'filterModel';\n        args[filterModel] = this;\n        this.parent.notify(events.cBoxFltrComplete, args);\n        if (this.isCheckboxFilterTemplate) {\n            hideSpinner(this.spinner);\n        }\n    };\n    CheckBoxFilterBase.prototype.queryGenerate = function (query) {\n        if (this.parent.searchSettings && this.parent.searchSettings.key.length) {\n            var sSettings = this.parent.searchSettings;\n            var fields = sSettings.fields.length ? sSettings.fields : this.options.columns.map(function (f) { return f.field; });\n            query.search(sSettings.key, fields, sSettings.operator, sSettings.ignoreCase, sSettings.ignoreAccent);\n        }\n        if ((this.options.filteredColumns.length)) {\n            var cols = [];\n            for (var i = 0; i < this.options.filteredColumns.length; i++) {\n                var filterColumn = this.options.filteredColumns[i];\n                if (this.options.uid) {\n                    filterColumn.uid = filterColumn.uid || this.parent.getColumnByField(filterColumn.field).uid;\n                    if (filterColumn.uid !== this.options.uid) {\n                        cols.push(this.options.filteredColumns[i]);\n                    }\n                }\n                else {\n                    if (filterColumn.field !== this.options.field) {\n                        cols.push(this.options.filteredColumns[i]);\n                    }\n                }\n            }\n            var predicate = this.getPredicateFromCols(cols);\n            if (predicate) {\n                query.where(predicate);\n            }\n        }\n    };\n    CheckBoxFilterBase.prototype.processDataSource = function (query, isInitial, dataSource, args) {\n        showSpinner(this.spinner);\n        // query = query ? query : this.options.query.clone();\n        // query.requiresCount();\n        // let result: Object = new DataManager(dataSource as JSON[]).executeLocal(query);\n        // let res: { result: Object[] } = result as { result: Object[] };\n        this.updateResult();\n        var args1 = { dataSource: this.fullData, isCheckboxFilterTemplate: false, column: this.options.column,\n            element: this.cBox, type: this.options.type, format: this.options.type, btnObj: this.options.isResponsiveFilter ? null :\n                this.dialogObj.btnObj[0], searchBox: this.searchBox };\n        this.parent.notify(events.beforeCheckboxfilterRenderer, args1);\n        this.isCheckboxFilterTemplate = args1.isCheckboxFilterTemplate;\n        if (!this.isCheckboxFilterTemplate) {\n            this.createFilterItems(dataSource, isInitial, args);\n        }\n    };\n    CheckBoxFilterBase.prototype.processSearch = function (query) {\n        this.processDataOperation(query);\n    };\n    CheckBoxFilterBase.prototype.updateResult = function () {\n        this.result = {};\n        var predicate = this.getPredicateFromCols(this.options.filteredColumns);\n        var query = new Query();\n        if (predicate) {\n            query.where(predicate);\n        }\n        this.parent.notify(events.beforeCheckboxRendererQuery, { query: query });\n        var result = new DataManager(this.fullData).executeLocal(query);\n        for (var _i = 0, result_1 = result; _i < result_1.length; _i++) {\n            var res = result_1[_i];\n            this.result[getObject(this.options.field, res)] = true;\n        }\n    };\n    CheckBoxFilterBase.prototype.clickHandler = function (e) {\n        var target = e.target;\n        var elem = parentsUntil(target, 'e-checkbox-wrapper');\n        if (parentsUntil(target, 'e-searchbox')) {\n            this.searchBoxClick(e);\n        }\n        if (elem && !this.isCheckboxFilterTemplate) {\n            var selectAll = elem.querySelector('.e-selectall');\n            if (selectAll) {\n                this.updateAllCBoxes(!selectAll.classList.contains('e-check'));\n            }\n            else {\n                toogleCheckbox(elem.parentElement);\n            }\n            this.updateIndeterminatenBtn();\n            elem.querySelector('.e-chk-hidden').focus();\n        }\n        this.setFocus(parentsUntil(elem, 'e-ftrchk'));\n    };\n    CheckBoxFilterBase.prototype.keyupHandler = function (e) {\n        this.setFocus(parentsUntil(e.target, 'e-ftrchk'));\n    };\n    CheckBoxFilterBase.prototype.setFocus = function (elem) {\n        var prevElem = this.dlg.querySelector('.e-chkfocus');\n        if (prevElem) {\n            prevElem.classList.remove('e-chkfocus');\n        }\n        if (elem) {\n            elem.classList.add('e-chkfocus');\n        }\n    };\n    CheckBoxFilterBase.prototype.updateAllCBoxes = function (checked) {\n        var cBoxes = [].slice.call(this.cBox.getElementsByClassName('e-frame'));\n        for (var _i = 0, cBoxes_1 = cBoxes; _i < cBoxes_1.length; _i++) {\n            var cBox = cBoxes_1[_i];\n            removeAddCboxClasses(cBox, checked);\n            setChecked(cBox.previousSibling, checked);\n        }\n    };\n    CheckBoxFilterBase.prototype.dialogOpen = function () {\n        if (this.parent.element.classList.contains('e-device')) {\n            this.dialogObj.element.querySelector('.e-input-group').classList.remove('e-input-focus');\n            if (!this.options.isResponsiveFilter) {\n                this.dialogObj.element.querySelector('.e-btn').focus();\n            }\n        }\n    };\n    CheckBoxFilterBase.prototype.createCheckbox = function (value, checked, data) {\n        var elem = checked ? this.cBoxTrue.cloneNode(true) :\n            this.cBoxFalse.cloneNode(true);\n        setChecked(elem.querySelector('input'), checked);\n        var label = elem.querySelector('.e-label');\n        var dummyData = extendObjWithFn({}, data, { column: this.options.column, parent: this.parent });\n        var innerText = this.options.disableHtmlEncode ? 'textContent' : 'innerHTML';\n        label[innerText] = !isNullOrUndefined(value) && value.toString().length ? value :\n            this.getLocalizedLabel('Blanks');\n        if (label.innerHTML === this.getLocalizedLabel('Blanks')) {\n            this.isBlanks = true;\n        }\n        if (typeof value === 'boolean') {\n            label.innerHTML = value === true ? this.getLocalizedLabel('FilterTrue') : this.getLocalizedLabel('FilterFalse');\n        }\n        addClass([label], ['e-checkboxfiltertext']);\n        if (this.options.template && data[this.options.column.field] !== this.getLocalizedLabel('SelectAll')) {\n            label.innerHTML = '';\n            var isReactCompiler = this.parent.isReact && this.options.column.filter\n                && typeof (this.options.column.filter.itemTemplate) !== 'string';\n            if (isReactCompiler) {\n                this.options.template(dummyData, this.parent, 'filterItemTemplate', null, null, null, label);\n                this.parent.renderTemplates();\n            }\n            else {\n                appendChildren(label, this.options.template(dummyData, this.parent, 'filterItemTemplate'));\n            }\n        }\n        return elem;\n    };\n    CheckBoxFilterBase.prototype.updateIndeterminatenBtn = function () {\n        var cnt = this.cBox.children.length - 1;\n        var className = [];\n        var disabled = false;\n        var elem = this.cBox.querySelector('.e-selectall');\n        var selected = this.cBox.querySelectorAll('.e-check:not(.e-selectall)').length;\n        var btn;\n        if (!this.options.isResponsiveFilter) {\n            btn = this.dialogObj.btnObj[0];\n            btn.disabled = false;\n        }\n        var input = elem.previousSibling;\n        setChecked(input, false);\n        input.indeterminate = false;\n        if (cnt === selected) {\n            className = ['e-check'];\n            setChecked(input, true);\n        }\n        else if (selected) {\n            className = ['e-stop'];\n            input.indeterminate = true;\n        }\n        else {\n            className = ['e-uncheck'];\n            disabled = true;\n            if (btn) {\n                btn.disabled = true;\n            }\n        }\n        if (btn) {\n            this.filterState = !btn.disabled;\n            btn.dataBind();\n        }\n        removeClass([elem], ['e-check', 'e-stop', 'e-uncheck']);\n        addClass([elem], className);\n        this.parent.notify(events.refreshCustomFilterOkBtn, { disabled: disabled });\n    };\n    CheckBoxFilterBase.prototype.createFilterItems = function (data, isInitial, args1) {\n        var _a;\n        var cBoxes = this.parent.createElement('div');\n        var btn;\n        var disabled = false;\n        if (!this.options.isResponsiveFilter) {\n            btn = this.dialogObj.btnObj[0];\n        }\n        var nullCounter = -1;\n        var key = 'ejValue';\n        if (!args1.executeQuery) {\n            key = args1.field;\n        }\n        for (var i = 0; i < data.length; i++) {\n            var val = getValue(key, data[i]);\n            if (val === '' || isNullOrUndefined(val)) {\n                nullCounter = nullCounter + 1;\n            }\n        }\n        this.itemsCnt = nullCounter !== -1 ? data.length - nullCounter : data.length;\n        if (data.length && !this.renderEmpty) {\n            var selectAllValue = this.getLocalizedLabel('SelectAll');\n            var innerDiv = this.cBox.querySelector('.e-checkfltrnmdiv');\n            if (innerDiv) {\n                innerDiv.classList.remove('e-checkfltrnmdiv');\n            }\n            var checkBox = this.createCheckbox(selectAllValue, false, (_a = {}, _a[this.options.field] = selectAllValue, _a));\n            if (this.parent.cssClass) {\n                addClass([checkBox], [this.parent.cssClass]);\n            }\n            var selectAll = createCboxWithWrap(getUid('cbox'), checkBox, 'e-ftrchk');\n            selectAll.querySelector('.e-frame').classList.add('e-selectall');\n            cBoxes.appendChild(selectAll);\n            var predicate = new Predicate('field', 'equal', this.options.field);\n            if (this.options.foreignKeyValue) {\n                predicate = predicate.or('field', 'equal', this.options.foreignKeyValue);\n            }\n            var isColFiltered = new DataManager(this.options.filteredColumns).executeLocal(new Query().where(predicate)).length;\n            var isRndere = void 0;\n            for (var i = 0; i < data.length; i++) {\n                var uid = getUid('cbox');\n                this.values[uid] = getValue(key, data[i]);\n                var value = getValue(this.options.field, data[i]);\n                if (this.options.formatFn) {\n                    value = this.valueFormatter.toView(value, this.options.formatFn);\n                }\n                var args_1 = { value: value, column: this.options.column, data: data[i] };\n                this.parent.notify(events.filterCboxValue, args_1);\n                value = args_1.value;\n                if ((value === '' || isNullOrUndefined(value))) {\n                    if (isRndere) {\n                        continue;\n                    }\n                    isRndere = true;\n                }\n                var checkbox = this.createCheckbox(value, this.getCheckedState(isColFiltered, this.values[uid]), getValue('dataObj', data[i]));\n                cBoxes.appendChild(createCboxWithWrap(uid, checkbox, 'e-ftrchk'));\n            }\n            this.cBox.innerHTML = '';\n            appendChildren(this.cBox, [].slice.call(cBoxes.children));\n            this.updateIndeterminatenBtn();\n            if (btn) {\n                btn.disabled = false;\n            }\n            disabled = false;\n        }\n        else {\n            cBoxes.appendChild(this.parent.createElement('span', { innerHTML: this.getLocalizedLabel('NoResult') }));\n            this.cBox.innerHTML = '';\n            this.cBox.appendChild(this.parent.createElement('div', { className: 'e-checkfltrnmdiv' }));\n            appendChildren(this.cBox.children[0], [].slice.call(cBoxes.children));\n            if (btn) {\n                btn.disabled = true;\n            }\n            disabled = true;\n        }\n        if (btn && data.length) {\n            this.filterState = !btn.disabled;\n            btn.dataBind();\n        }\n        var args = { requestType: events.filterChoiceRequest, dataSource: this.renderEmpty ? [] : data };\n        var filterModel = 'filterModel';\n        args[filterModel] = this;\n        this.parent.notify(events.cBoxFltrComplete, args);\n        this.parent.notify(events.refreshCustomFilterOkBtn, { disabled: disabled });\n        hideSpinner(this.spinner);\n    };\n    CheckBoxFilterBase.prototype.getCheckedState = function (isColFiltered, value) {\n        if (!this.isFiltered || !isColFiltered) {\n            return true;\n        }\n        else {\n            var checkState = this.result[value];\n            return this.options.operator === 'notequal' ? !checkState : checkState;\n        }\n    };\n    CheckBoxFilterBase.getDistinct = function (json, field, column, foreignKeyData) {\n        var len = json.length;\n        var result = [];\n        var value;\n        var ejValue = 'ejValue';\n        var lookup = {};\n        var isForeignKey = column && column.isForeignColumn ? column.isForeignColumn() : false;\n        while (len--) {\n            value = json[len];\n            value = getObject(field, value); //local remote diff, check with mdu\n            if (!(value in lookup)) {\n                var obj = {};\n                obj[ejValue] = value;\n                lookup[value] = true;\n                if (isForeignKey) {\n                    var foreignDataObj = getForeignData(column, {}, value, foreignKeyData)[0];\n                    setValue(events.foreignKeyData, foreignDataObj, json[len]);\n                    value = getValue(column.foreignKeyValue, foreignDataObj);\n                }\n                setValue(field, isNullOrUndefined(value) ? null : value, obj);\n                setValue('dataObj', json[len], obj);\n                result.push(obj);\n            }\n        }\n        return DataUtil.group(DataUtil.sort(result, field, DataUtil.fnAscending), 'ejValue');\n    };\n    CheckBoxFilterBase.getPredicate = function (columns) {\n        var cols = DataUtil.distinct(columns, 'field', true) || [];\n        var collection = [];\n        var pred = {};\n        for (var i = 0; i < cols.length; i++) {\n            collection = new DataManager(columns).executeLocal(new Query().where('field', 'equal', cols[i].field));\n            if (collection.length !== 0) {\n                pred[cols[i].field] = CheckBoxFilterBase.generatePredicate(collection);\n            }\n        }\n        return pred;\n    };\n    CheckBoxFilterBase.generatePredicate = function (cols) {\n        var len = cols ? cols.length : 0;\n        var predicate;\n        var operate = 'or';\n        var first = CheckBoxFilterBase.updateDateFilter(cols[0]);\n        first.ignoreAccent = !isNullOrUndefined(first.ignoreAccent) ? first.ignoreAccent : false;\n        if (first.type === 'date' || first.type === 'datetime') {\n            predicate = getDatePredicate(first, first.type);\n        }\n        else {\n            predicate = first.ejpredicate ? first.ejpredicate :\n                new Predicate(first.field, first.operator, first.value, !CheckBoxFilterBase.getCaseValue(first), first.ignoreAccent);\n        }\n        for (var p = 1; p < len; p++) {\n            cols[p] = CheckBoxFilterBase.updateDateFilter(cols[p]);\n            if (len > 2 && p > 1 && cols[p].predicate === 'or') {\n                if (cols[p].type === 'date' || cols[p].type === 'datetime') {\n                    predicate.predicates.push(getDatePredicate(cols[p], cols[p].type));\n                }\n                else {\n                    predicate.predicates.push(new Predicate(cols[p].field, cols[p].operator, cols[p].value, !CheckBoxFilterBase.getCaseValue(cols[p]), cols[p].ignoreAccent));\n                }\n            }\n            else {\n                if (cols[p].type === 'date' || cols[p].type === 'datetime') {\n                    if (cols[p].predicate === 'and' && cols[p].operator === 'equal') {\n                        predicate = predicate[operate](getDatePredicate(cols[p], cols[p].type), cols[p].type, cols[p].ignoreAccent);\n                    }\n                    else {\n                        predicate = predicate[(cols[p].predicate)](getDatePredicate(cols[p], cols[p].type), cols[p].type, cols[p].ignoreAccent);\n                    }\n                }\n                else {\n                    predicate = cols[p].ejpredicate ?\n                        predicate[cols[p].predicate](cols[p].ejpredicate) :\n                        predicate[(cols[p].predicate)](cols[p].field, cols[p].operator, cols[p].value, !CheckBoxFilterBase.getCaseValue(cols[p]), cols[p].ignoreAccent);\n                }\n            }\n        }\n        return predicate || null;\n    };\n    CheckBoxFilterBase.getCaseValue = function (filter) {\n        if (isNullOrUndefined(filter.matchCase)) {\n            if (filter.type === 'string' || isNullOrUndefined(filter.type) && typeof (filter.value) === 'string') {\n                return false;\n            }\n            else {\n                return true;\n            }\n        }\n        else {\n            return filter.matchCase;\n        }\n    };\n    CheckBoxFilterBase.updateDateFilter = function (filter) {\n        if ((filter.type === 'date' || filter.type === 'datetime' || filter.value instanceof Date)) {\n            filter.type = filter.type || 'date';\n        }\n        return filter;\n    };\n    return CheckBoxFilterBase;\n}());\nexport { CheckBoxFilterBase };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}